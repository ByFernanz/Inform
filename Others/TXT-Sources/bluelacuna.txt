"Blue Lacuna" by "Aaron A. Reed"

[Blue Lacuna should be compiled with Inform build 5Z71. Note that the Glulx interpreter in the "Game" panel will not properly run this version of the game; to play, you'll have to "Release" the story and use an external interpreter. ]

[All versions of Blue Lacuna and its source code are released under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 license. In summary, you may freely distribute, perform, or create derivative works, but not for commercial purposes without permission from the author. More information is available at http://creativecommons.org/licenses/by-nc-sa/3.0/us/.]

Include Legacy Extensions for Blue Lacuna by Blue Lacuna. [This extension contains snapshots of the following extensions as they existed at the time of Blue Lacuna's release: Smarter Parser by Aaron Reed, Poor Man's Mistype by Aaron Reed, Epistemology by Eric Eve, Remembering by Aaron Reed, Default Messages by David Fisher, Glulx Entry Points by Emily Short, Glulx Text Effects by Emily Short, Flexible Windows by Jon Ingold, Simple Debugger by Michael Hilborn, Plurality by Emily Short, Improved Menus by Aaron Reed (based on Basic Menus by Emily Short), Intelligent Hinting by Aaron Reed, and Numbered Disambiguation Choices by Aaron Reed.]

Volume - Core

Part - Definitions & Setup

The story headline is "An Interactive Novel In Ten Chapters".
The story genre is "Fiction".
The release number is 4.       
The story description is "You have always been different. 

One in a trillion have your gift, your curse: to move between worlds, never settling, always alone. To Wayfare. Yet there are others like you, and something stronger than coincidence binds you together, bumps your lives against each other like charged particles.

Now you feel the Call again, and know another of your kind is in need. But when you arrive there are no answers. Just an old man with fraying sanity and a long-buried secret. A tropical paradise more alive than it seems. And a conflict left unresolved that could change the course of two civilizations forever.  

There are no easy choices, wayfarer. Your decisions will shape the fate of many things. Three worlds. Two lives. And what your own story will become.".                           
                
The story creation year is 2009.             
      
Use fast route-finding.
Use the serial comma.    
Use no scoring.
Use full-length room descriptions.    

Use MAX_PROP_TABLE_SIZE of 3000000.   
Use MAX_SYMBOLS of 100000.  
Use MAX_STATIC_DATA of 100000.
Use MAX_OBJECTS of 6000. 
Use MAX_DICT_ENTRIES of 10000.
Use MAX_ACTIONS of 500.
Use MAX_VERBS of 500.
Use MAX_VERBSPACE of 12000.
Use MAX_STATIC_DATA of 6000000. 
Use MAX_NUM_STATIC_STRINGS of 50000.    
Use MAX_EXPRESSION_NODES of 200.
Use MAX_OBJ_PROP_COUNT of 100.
Use ALLOC_CHUNK_SIZE of 30000. 
Use MAX_ARRAYS of 3000.
Use MAX_ZCODE_SIZE of 100000.
Use MAX_LABELS of 20000.

Release along with cover art, the source text, a website, a file of "Legacy Extensions" called "Legacy Extensions for Blue Lacuna.i7x". 

Your Bedroom is a room. [ So we start in this room.]  
UnRoom is a room.      


Chapter - Intelligent Hinting

Understand the command "solve" as something new. Understand the command "suggest" as something new. [ For this release, we haven't fully enabled IH.]
 
Winning-The-Game requires Homeworld-Sequence, Lacuna-Sequence, Twoworlds-Sequence, Endgame-Sequence.

Extended-hint-mode is a truth state that varies. Extended-hint-mode is true. [ true=Intelligent Hinting includes hints and color. false=bare minimum path to finish the game.]

Homeworld-Sequence is a puzzle. Lacuna-Sequence is a puzzle. Twoworlds-Sequence is a not sequential puzzle. It requires Rebelworld-Sequence, Treeworld-Sequence. Endgame-Sequence is a puzzle. [ Finding-The-Egg is a task. Powering-Both-Devices is a task. Opening-The-Pyramid is a task. Contacting-All-The-Trees is a task.] [ Reaching-Rebelworld is a task. Finishing-Rebelworld is a task. Reaching-Treeworld is a task. Finishing-Treeworld is a task.] Completing-Progue's-Character-Arc is a puzzle.  Finishing-the-Epilogue is a task. Meeting-Progue is a task.    
  
            
   
Chapter - Smarter Parser
 
Table of Extended Smarter Parser Messages (continued)
therule	message
signs of confusion rule	"[as the parser]Look for emphasized object keywords ([o]things[x] you can examine) or emphasized [o]exit[x] keywords (places you can go). Type a single keyword and press enter to advance. If you can't see the emphasis on the keywords, type KEYWORDS. Type LOOK to get a fresh description of your surroundings. Type HELP to get access to more detailed instructions."
unnecessary movement rule	"[as the parser]Usually, you won't need to move within a single location; everything you can see is usually touchable. If you're trying to get somewhere that's not nearby, use emphasized [d]exits[x] keywords to move from one location to another, or type [d]landmark[x] to see a list of areas you can quickly move beween.[as normal]"
asking random questions rule	"[as the parser]You can't ask direct questions to the game. Try typing an emphasized keyword (or LOOK if you don't see any on the screen) or HELP for more instructions.[as normal]"
making assertions rule	"[as the parser]Please rephrase your command by typing just an emphasized keyword, or a verb like LOOK. Type HELP for more info.[as normal]"
starting command with i rule	"[as the parser]Please rephrase your command by typing just an emphasized keyword, or a verb like LOOK. Type HELP for more info.[as normal]"



 
Section - Lacuna Print Rule (in place of Section - The Print Rule in Legacy Extensions for Blue Lacuna by Blue Lacuna)

To print explanation for (why - a rule):    
	if sp-debug is true, say "(smart parser debug: printing message for [why])[command clarification break]"; 
	if there is a therule of why in Table of Extended Smarter Parser Messages:  
		choose row with a therule of why in Table of Extended Smarter Parser Messages;
		say "[as the parser][message entry][as normal]";
	otherwise if there is a therule of why in Table of Smarter Parser Messages: 
		choose row with a therule of why in Table of Smarter Parser Messages; 
		say "[as the parser][message entry][as normal]". 



Chapter - Misc Setup Conditions



The can't act in the dark rule is not listed in any rulebook. The adjust light rule is not listed in any rulebook. The check light in new location rule is not listed in any rulebook. [ We don't use the default light/dark model, so might as well declutter the rulebooks.]    

The examine described devices rule is not listed in any rulebook.   
   
To decide whether parser error is did not make sense in this context:   
      (- (etype == ASKSCOPE_PE) -)                   
          
To say notsurewhatyoumeant:
	if location is regionally in Dreamlands: 
		say "You can't seem to.[run paragraph on]"; [ This is mostly because we tend to flippantly refer to a lot of things in the dreams that aren't actually there.]
	otherwise:  
		if notsure_num is turn count, increase frust_ctr by 1;
		otherwise now frust_ctr is 0;
		say "[if frust_ctr is 2]I seem to be having difficulties understanding you. I apologize! Remember, I'm only likely to understand the emphasized keywords you see in the prose: [o]nouns[x], [d]directions[x], or [t]topics[x]. If a word is not emphasized, it's a good bet I won't understand it. Type keywords alone, or try combining them with basic verbs to do more complex actions. (Type VERBS to see a full list: if a verb is not on the list, it's a good bet I won't understand that, either.)[paragraph break]If you don't see any keywords, try pressing enter by itself, or typing LOOK, to get a fresh description of your surroundings and new keywords to try. You can also type HELP at any time for more detailed instructions[otherwise]Sorry, I'm not sure what you meant. [nearbypersonbit]Try LOOK to reorient yourself to your surroundings, or HELP for more instructions[end if]";
		now notsure_num is turn count.   [ The rule related to this is in the conversation "Not Understanding" section. ]      
  
notsure_num is a number that varies. frust_ctr is a number that varies.

      
To say nearbypersonbit:
	if an idle nonbestial other person is enclosed by location:
		unless tutorial mode is switched on, say "If you were trying to speak to [a random idle nonbestial other person enclosed by location], try typing HELLO first. ";
	otherwise if a nonbestial other person is enclosed by the location:
		say "If you were trying to speak to [a random nonbestial other person enclosed by location], try typing an emphasized keyword from recent dialogue. ".    

 

   



Chapter - Beginning Play

[The functionality here, to ensure the player gets to choose keywords they can see before the game proper begins, was later worked into the Highlighted Keywords extensions.]

When play begins: follow the very-beginning rule. 

This is the very-beginning rule:
	clear the screen;
	if Milestone mode is true or final release mode is true begin;  
	let ready-to-go be false;
	let show-toc be false;
	say "Welcome to [o]Blue Lacuna[x], release [release number].[paragraph break]If no words above were [one of]blue[or]emphasized[stopping], press K now.[paragraph break]Press [t]N[x] to begin from the beginning, [t]R[x] to restore an existing story, or [t]C[x] to show the Table of Contents.";
	while ready-to-go is false begin;
		let k be 0;  
		while k is 0 begin; let k be the chosen letter; end while;
		if k is 82 or k is 114, 	restore the game;  [ restore ]
		if k is 67 or k is 99 begin; now ready-to-go is true; now show-toc is true; end if;  [ table ]
		if k is 75 or k is 107 begin;  
			try setting the keyword style; 
			stop;
		end if;
		if k is 89 or k is 121 begin; [ yes ]
			try setting screen reader mode;  
			say "[paragraph break]Press any key to continue.";
			wait for any key;
			now k is 78;    
		end if;
		if k is 78 or k is 110 begin; [ new ]
			now ready-to-go is true;
		end if;   
	end while;   
	end if;
	if show-toc is true, show table of contents;
	else clear the screen.    
 
To restore the game: (- RESTORE_THE_GAME_R(); -).

To restart the game: (- @restart; -).  
 

  

 

Part - Beta Testing

[ Include Simple Debugger by Michael Hilborn. ]

Section - Milestone mode

Milestone mode is a truth state that varies. Milestone mode is false. Final release mode is a truth state that varies. Final release mode is true. [ These two set up different testing environments. Milestone mode was for frequent releases to testers, and included special prompts to save transcripts and certain testing commands.] 
 
First After reading a command when milestone mode is true (this is the ignore beta-comments rule):
	if the player's command matches the regular expression "^\p" begin;
		speak as the parser "Comment noted."; 
		reject the player's command;  
	end if.

Section - Hacks (not for release)

Include (- [ XTreeSub; print "***In debug mode this conflicts with the test command 'tree'; try typing 'tree9' instead.***^^"; ]; -) instead of "Tree Command" in "Tests.i6t". [ This prevents the tester who haplessly types the highlighted keyword "tree" from being buried in an epic poem's worth of debugging code.]
 

Chapter - Fast Forward

[ A testing command to quickly jump forward through the major sections of the story. The fast-forward rules are defined in each of the individual sections, making adjustments to the game world so that conditions will be the same as if the entire game has been played to this point.]

Fast-forward is an object-based rulebook.   

Section - The Fast Forward Command

Ffing is an action applying to nothing. Understand "ff" as ffing.  
 
Carry out ffing:    
	now yourself is awake;
	if Finishing-the-Prologue is unsolved begin;
		follow the fast-forward rules for Finishing-The-Prologue;
		speak as the parser "BETA: **advanced to Exploring Homeworld**[line break](You make a few key decisions.)"; 
	otherwise if Starting-The-Painting is unsolved; 
		follow the fast-forward rules for Starting-the-Painting;
		speak as the parser "BETA: **advanced to Rume-Conversation**[line break](You learn some things about yourself: that you are a Wayfarer, a traveller between worlds, who tonight feels the Call, a bond between your kind. Though you have toyed with settling down with Rume, who you may be in love with, the Call pulls at you insistently. But if you answer it by painting, you will not be able to return, for a Wayfarer's journey is one way only, and none may go with him.)";	   
	otherwise if Finishing-The-Painting is unsolved; 
		follow the fast-forward rules for Finishing-the-Painting;
		speak as the parser 	"BETA:**advanced to Exploring Lacuna**[line break](After a final conversation with Rume, you have answered the call, and Wayfared to another world through your painting of a curious tree.)"; 
	otherwise if Meeting-Progue is unsolved;
		follow the fast-forward rules for Meeting-Progue;
		speak as the parser "BETA:**met Progue**[line break]You find yourself on a tropical island, deserted save for a half-mad old man named Progue.)[if The-Mysterious-Door is incomplete]yes[else]no"; 
	otherwise if The-Mysterious-Door is unsolved; 	  
		follow the fast-forward rules for The-Mysterious-Door;
		speak as the parser "BETA:**advanced to lava door puzzle solved**[line break](Various signs of former inhabitation abound: an old treehouse with a clockwork head, a non-working ropeway leading to the top of the island's highest mountain, a cabin on a beach. It seems the past residents must have been artists, for there are two beautiful paintings in the cabin-- the work of Wayfarers?-- and a spectacular sculpture on the lip of the island's volcano. A secret door in the cabin inscribed with a cipher finally opens to you after you match the bands of color painted on it to animals and plants around the island used to make the paints.)";  
	otherwise if Getting-To-The-Lawn is unsolved;
		follow the fast-forward rules for Getting-To-The-Lawn;
		speak as the parser "BETA:**advanced to power chairlift puzzle solved**[line break](On the floor of the volcano you discover a boiler, channelling steam power to various points around the island. One of these is the ropeway, which, once powered, takes you to the top of the mountain, where a strange pyramid object awaits.)";
	otherwise if Finding-The-Egg is unsolved;
		follow the fast-forward rules for Finding-The-Egg;
		speak as the parser "BETA:**advanced to Find the Egg puzzle solved**[line break](On the east side of the island is a huge beehive, and various clues have led you to believe the bees are key to discovering some secret deep within the nearby rain forest. After watching the bees inside the hive do their strange dance, you finally manage to decipher its meaning, and follow the bees to a discovery deep within the forest. Meanwhile you have befriended Progue, whose memory is slowly beginning to return to him, and have been having a series of very strange dreams, where two entities both seem to be trying to reach you.)";  
	otherwise if Powering-Both-Devices is unsolved;
		follow the fast-forward rules for Powering-Both-Devices;
		speak as the parser "BETA:**advanced to Power Both puzzle solved (climbing variation)**[line break](To get to the pyramid, which the dreams and Progue are both hinting is somehow important, you must use the ropeway, but when it is powered there isn't enough left over power to run the pyramid, which seems to need an extraordinary amount. Fortunately, you are able to figure out a way to bypass the ropeway and get to the top of the mountain anyway, with the pyramid at full power.)";   
	otherwise if Opening-The-Pyramid is unsolved;
		follow the fast-forward rules for Opening-The-Pyramid;
		speak as the parser "BETA:**advanced to Pyramid Opened puzzle solved**[line break](The symbols on the sides of the pyramid sync up with symbols in an echoing cave beneath your rain forest discovery. After piecing together more clues, you realize the echo cave is some sort of security system enacted by Progue; only people who know his names for things around the island will be able to get in. After working out the puzzle you return to the pyramid and are able to open it.)";   
	otherwise if Contacting-All-The-Trees is unsolved;   
		follow the fast-forward rules for Contacting-All-The-Trees;
		speak as the parser "BETA:**advanced to All Trees Found (tree PW: [tree-password]; rebel PW: [rebel-password])**[line break](The dreams have led to a shocking revelation: one of the groups trying to reach you is actually a race of intelligent, telepathic beings: the trees, who are reliant on a symbiont race of human-like creatures to be their eyes, ears, and hands. Your forest discovery was the crashed ship the trees arrived in on this island; they lived while the symbiont humans died. The other group trying to reach you in dreams is from a mirrored world where the opposite ocurred: the trees died and the humans lived, and, force to think and fend for themselves, have decided they aren't so keen on their former 'masters.' By finding all the trees on the island, you are able to learn the whole story, and set encryption keys that will allow you to communicate in secret with either side (see passwords above). You have also calibrated the seiver device inside the pyramid, and are ready to begin.)";  
	otherwise if Being-In-Rebelworld is unsolved;  
		follow the fast-forward rules for Being-In-Rebelworld;
		speak as the parser "BETA:**advanced to Rebel World**[line break](Setting the seiver for the human symbionts, you activate the link.)"; 		 
	otherwise if Finishing-Rebelworld is unsolved;
		follow the fast-forward rules for Finishing-Rebelworld;
		speak as the parser "BETA:**advanced to Rebel World Completed**[line break](";
	otherwise if Being-In-Treeworld is unsolved; 
		follow the fast-forward rules for Being-In-Treeworld;
		speak as the parser "BETA:**advanced to Treeworld**[line break]("; 
	otherwise if Finishing-Treeworld is unsolved;
		follow the fast-forward rules for Finishing-Treeworld;
		speak as the parser "BETA:**advanced to Treeworld Completed**[line break](";
	otherwise if Completing-Progue's-Character-Arc is unsolved;
		follow the fast-forward rules for Completing-Progue's-Character-Arc; 
		speak as the parser "BETA:**advanced to Final Confrontation resolved**[line break]("; 
	otherwise if Finishing-The-Epilogue is unsolved;
		[ force solve Finishing-The-Epilogue;]
		speak as the parser "BETA:**advanced to Epilogue**[line break](";
	otherwise;
		speak as the parser "**Can't advance past Epilogue!**";
	end if.      

Section - Changing the time rate

[ Changing the time factor is an action out of world applying to one number. Understand "tf [a number]" as changing the time factor. Carry out changing the time factor: change the time factor to the number understood. Report changing the time factor: say "set to [the number understood]."     ]

Section - Teleportation

Teleporting is an action out of world applying to one thing. Understand "teleport [any room]" or "tp [any room]" as  teleporting. Carry out teleporting: move the player to noun.  

Section - Debug Verbs

[ Revealing all is an action out of world applying to nothing. Understand "reveal all" as revealing all. Carry out revealing all: say "Visible things: [list of visible things]." ]



Part - Menus and Help

Understand "help" or "menu" as asking for help. Asking for help is an action out of world.        
  
Carry out asking for help:      
	if topics-window is g-present, shut down the topics-window;
	show table of contents;
	if out-of-line keywords < 3 and an other attentive person is enclosed by location:
		open up the topics-window;
		follow the drawing rule of the topics-window.

After printing the banner text when turn count >= 2: say "Type MENU for more information.".  
    


Chapter - Table of Contents 

To show table of contents:
     change the current menu to the Table of Main Contents;
     carry out the displaying activity;
     clear the screen;
     if Finishing-The-Prologue is complete, try looking.

Table of Main Contents
title		subtable		description	toggle
"PREMENU"		--	"Please select an option from the menu using the arrow keys. Press enter to confirm your choice." 
"Dedication"	--			"[dedicationtext]"	--
"About This Edition"		--	"[abouttext]"			--
""	--	""	-- 
"Basic [wtfinstructions]"	--	"[simplehelptext].[paragraph break]Hit enter or type LOOK from any prompt to get a fresh description of your surroundings. Type SAVE to save your progress through the story; you can pick up where you left off later by typing RESTORE."	--
"Detailed [wtfinstructions]"		Table of Helpy Stuff		--			--
"Verb List"	--	"[otherverbs]."	--
"Adjust Keyword Style"		--	--	keyword setting rule
""	--	""	--
"Tutorial Mode ([if tutorial mode is switched on]ON[else]OFF[end if])"	Table of Tutorial Mode Options	--	
"Stats Mode ([if stats mode is true]ON[else]OFF[end if])"		Table of Stats Mode Options	--
""	--	""	--
"Acknowledgements"	--	"[acknowledgements]"	--
"About the Author"	--	"[authortext]"	--
"Where to Find More Interactive Fiction"		--		"[ifprimer]"	--
"POSTMENU"	--	"Press Q or the ESC key when you are ready to [if turn count <= 1]begin[otherwise]continue[end if]. You may type HELP from any prompt to return to this menu."  
    
To say wtfinstructions: say "Instructions".  [ Oddly, just writing "Instructions" in the menu table causes problems. ]  
 
To say ifprimer: say "An embarrassment of riches exists in the interactive fiction community, where a disproportionally talented group of writers, designers, and programmers have released hundreds of quality interactive stories for free over the past 15 years. The only problem is how to find them.

The Internet Fiction Database (ifdb.tads.org) collects reviews, ratings, and technical info about IF games. If you click 'Search' and then 'Recommended Lists,' you can search through user compilations of favorite games or even create your own.

Baf's Guide to the IF Archive (wurb.com/if) is a similar resource that also allows you to browse games sorted by genre, rating, or awards received. The five-star game list here is an excellent place to find quality games to play.

Emily Short's Reading IF page (emshort.wordpress.com/reading-if) categorizes games by their noteworthiness: games known for great settings, a focus on characterization, or interesting puzzles, for instance.

The Annual IF Comp (ifcomp.org) has been the preeminent venue for new works of short IF for well over a decade; browsing lists of past winners is an excellent way to find high-quality games.".

Table of Helpy Stuff
title		subtable		description	toggle
"More on Verbs"		--	"[commandstext]"	--
"More on Movement"	--	"[movementtext]"	--
"More on Conversation"		--	"[convotext]"	--
"Game Options"		--	"[optionstext]"	--
"What To Do If You Get Stuck"	--	"[hintstext]"	--

This is the keyword setting rule: try setting the keyword style.
 
To say dedicationtext: say "[paragraph break]To Benton, Fievel, and Fitz.". 

To say commandstext: say "In addition to typing emphasized keywords, you can also enter basic commands beginning with verbs to perform more complex actions in the story world. Type things like TOUCH GRASS, CLIMB TREE, OPEN BOX, or PUSH BUTTON in the appropriate situations, and the story will respond to your action. As with keywords, capitalization and punctuation doesnâ€™t matter, and you can usually leave out pronouns like 'the,' but spelling does count.

A few other useful verbs: LOOK (or just pressing enter) will give you a fresh description of your surroundings. WAIT (or Z) will pass a few minutes of time in the story world-- you can also WAIT UNTIL a certain time of day (such as noon, sunset, night, etc.) or WAIT FOR a certain number of hours or minutes. Finally, AGAIN (or G, or pressing the up arrow on most interpreters) will repeat the last command you typed.

[otherverbs].".  
 
To say movementtext: say "Type emphasized direction words to move in that direction or towards that distant piece of scenery. Type EXITS to be reminded of the places you can go from your current location. (Note that there may be concealed exits that require closer examination of nearby objects to uncover.) Early in the story you may find a compass, which will allow you to navigate using cardinal directions instead by typing OPEN COMPASS.

In large open areas, moving one location at a time can become tedious. At any prompt, you can type LANDMARK to see a list of landmarks you've discovered. Typing the name of a landmark will quickly move you to that area, unless it is currently inaccessible or something interrupts you along the way. 

Finally, you can also sometimes FOLLOW someone, or type GO TO a distant piece of scenery to move one area towards it. Type GO BACK to return to the last area you were in.".    

To say convotext: say "Type HELLO to start speaking. [convotext1][paragraph break][convotext2][paragraph break][convotext3]".    

To say convotext1: say "During a conversation, watch for emphasized keywords, which you can type to control the direction of the discussion, and keep your eyes on the small window that appears at the bottom of the screen, which sometimes shows additional words like YES or NO in response to questions. As the discussion moves forward, old emphasized keywords will become irrelevant and disappear, meaning you can no longer bring them up at the moment; you'll always know what you can still talk about by referencing the small window." 

To say convotext2: say "You can also always say NOTHING (sometimes a wise conversational tactic) or GOODBYE when you want to stop talking. In some conversations you can change the SUBJECT; the small window will show a list of available topics." 

To say convotext3: say "During conversation, you can also take physical actions, such as (in order of friendliness) KISS, HUG, PUSH, or ATTACK. You can also simply walk away, though people may find that rude if you don't say GOODBYE first. (Similarly, type HELLO to begin a conversation with someone you aren't speaking with.) You can FOLLOW someone who walks away from you, or SHOUT to get the attention of some characters." [ touch redirects to HUG.] 

Displaying the options text is an action out of world. Understand "options" as displaying the options text. Carry out displaying the options text: say "[optionstext]". To say optionstext: say "You can save your progress in the story by typing SAVE, and return to the same point later by typing RESTORE. You can QUIT to end the story immediately, or RESTART to begin from the beginning. If you want to take back your last move, type UNDO.

To begin a transcript of your game session, type SCRIPT ON; to end it, type SCRIPT OFF. Feel free to send transcripts to aaron@lacunastory.com."     
 
Displaying the hints text is an action out of world. Understand the command "think" as something new. Understand "hint" or "hints" or "think" as displaying the hints text. Carry out displaying the hints text: say "[hintstext]". To say hintstext: say "If you're not sure what to do, [if Homeworld-Sequence is solved]you may just need to keep exploring. The scenery changes with both the time of day, the tides, the weather, and your own actions. Retrace your steps and keep a close eye on the changing descriptions[else]remember you can type LOOK or press enter alone to be reminded of your surroundings[end if]. Make sure you try typing any emphasized [d]direction[x] keywords you haven't explored or [o]objects[x] you haven't examined.

Asking other characters you meet about obstacles is also a good tactic. It also may help to sleep on your problem, particularly in a comfy, shady spot[if puzzle mode and Homeworld-Sequence is solved].

If you're having a particularly difficult time with puzzles, you might consider starting a new game and selecting 'story mode' instead at the end of Chapter One. The puzzles are less complex and less important in story mode[end if].

If you want specific hints, try asking on the newsgroup rec.games.int-fiction or e-mailing the address below.

Finally, if you encounter a bug or problem with the workings of the story, think something is unclear, or have suggestions, the author would love to hear from you. Please write to aaron@lacunastory.com or visit lacunastory.com."

To say simplehelptext: say "In Blue Lacuna, you take the role of a character in the story. As you read, you'll see certain emphasized keywords in the prose. Type any keyword and press enter to interact with the story.[paragraph break]There are three kinds of keywords: type[line break]  -- a [o]noun[x] to examine that thing more closely[line break]  -- an [d]exit[x] to move in that direction[line break]  -- a [t]word[x] recently spoken (if you're talking with someone) to direct the conversation". 

Displaying the about text is an action out of world. Understand "about" as displaying the about text. Carry out displaying the about text: say "[abouttext]". To say abouttext: say "[banner text][line break][list of extension credits]Smarter Parser by Aaron Reed[line break]Poor Man's Mistype by Aaron Reed[line break]Epistemology by Eric Eve[line break]Remembering by Aaron Reed[line break]Default Messages by David Fisher[line break]Flexible Windows by Jon Ingold[line break]Improved Menus by Aaron Reed (based on Basic Menus by Emily Short)[line break]Intelligent Hinting by Aaron Reed[line break]Numbered Disambiguation Choices by Aaron Reed.[paragraph break]The official website for Blue Lacuna is lacunastory.com.[paragraph break]Blue Lacuna was first publicly previewed in April 2008 in the Spring Thing Competition. Release 1 debuted in January 2009.[paragraph break]All versions of Blue Lacuna and its source code are released under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 license. In summary, you may freely distribute, perform, or create derivative works, but not for commercial purposes without permission from the author. More information is available at http://creativecommons.org/licenses/by-nc-sa/3.0/us/. The cover art contains photography by Kevin N. Murphy under the Creative Commons Attribution 2.0 Generic license."

To say acknowledgements: say "First and foremost, I owe a huge debt to those whose shoulders I've stood on, most directly those of the Inform 7 team: Graham Nelson, Emily Short, Andrew Hunter, and David Kinder. In addition to creating the wonderful, free tools that were used to create Blue Lacuna, they also answered an endless series of pesky questions and were generous with advice, bug fixes, and esprit de corps. Find out how to create your own interactive fiction at inform-fiction.org.

In addition, the entire community on the newsgroup rec.arts.int-fiction deserves commendation for their amazing responsiveness, friendliness, and willingness to answer questions no matter how unusual or dubious. Among others are Ron Newcomb, Mike Tarbert, JDC, Andrew Plotkin, vaporware, and Khelwood, but a special thanks to everyone on raif who helped me out with problems over the development of this project.

Many of my close friends took time with me to discuss various aspects of the story's design over the past several years. They know who they are and their insight was tremendously helpful in shaping the final product.

My beta testers were instrumental in finding bugs and tweaking the puzzles, spending countless hours hunched over their interpreters with keen eyes. A million thank-yous to Alexei Othenin-Girard, Basti, Depresiv, Doug Egan, Emily Boegheim, George Oliver, HenryMikel, James Jolley, Jeremy Rishe, Justin Lowmaster, katzy, Lynnutte, Mario Carneiro, Neale, Scott Maddix, Sharon Rishe, Stephanie Camus, and Victor Gijsbers. Any remaining bugs in the story are of course entirely my fault and not theirs.

Finally, Blue Lacuna owes a stylistic debt to the Miller brothers and the creative team at Cyan Worlds, whose Myst and Uru games have been a huge inspiration in my desire to create thought-provoking interactive stories. The ending is never written."   

Displaying the verbs text is an action out of world. Understand "verb" or "verbs" as displaying the verbs text. Carry out displaying the verbs text: speak as the parser "[otherverbs]." 

To say otherverbs: say "Below are some of the most important verbs the story understands:

 LOOK[line break]
TOUCH[line break]
PUSH (and PULL)[line break]
OPEN (and CLOSE)[line break]
WEAR (and TAKE OFF)[line break]
TASTE (or EAT or DRINK)[line break]
TAKE (and DROP)[line break]
CLIMB[line break][ov2]". To say ov2: say " WAIT[line break]
LANDMARK[line break]
SLEEP[line break]
SIT[line break]
LISTEN[line break]
HELLO (and GOODBYE)[line break]
ATTACK[line break]
HUG[line break]
KISS[line break]
FOLLOW (or APPROACH)

Other verbs which may be useful in specific situations include READ, JUMP, GIVE, TURN, SQUEEZE, SMELL, WAKE, SWIM, SHAKE, and PAINT.

Verbs useful for controlling the story itself include UNDO, SAVE, RESTORE, QUIT, RESTART, HELP, KEYWORDS, THINGS, EXITS, and TOPICS". 
 
To say authortext: say "Aaron A. Reed has worked as a travel writer, web monkey, offensive t-shirt designer, graphic artist, 3D animator, filmmaker, and murder mystery producer. His fiction has appeared in 'Fantasy & Science Fiction' magazine, and his interactive fiction has won numerous awards and been taught in new media courses from Australia to Sweden. Blue Lacuna is his first novel. His website may be visited at aaronareed.net."

 


Chapter - God Mode

Understand "god" or "backstage" as god modeing. God modeing is an action out of world.

Carry out god modeing:
	if out-of-line keywords < 3:
		if topics-window is g-present, shut down the topics-window;
	change the current menu to Table of God Options;
	carry out the displaying activity;
	clear the screen;
	if Finishing-The-Prologue is complete, try looking;
	if out-of-line keywords < 3 and an other attentive person is enclosed by location:
		open up the topics-window;
		follow the drawing rule of the topics-window.		
	
Table of God Options
title		subtable		description	toggle
"PREMENU"	--	"From these menus, you can access information on and sometimes change certain variables that Blue Lacuna uses to help tell the story."
"Progue Options"	Table of Progue Options	--	--
"Drama Options"	Table of Drama Options	--	--
"Puzzle Cheats"		Table of Puzzle Options	--	--
 
Table of Progue Options
title		subtable		description	toggle
"PREMENU"	--	"Progue is currently in [location of Progue] and in the [psyche of Progue] psychological state. He is [if Progue is wishing]on his way to [progue-venue] for [end if][animus of Progue]. His activity counter is [activity counter of Progue] (usually he'll pick a new activity at 15)[if an episode is playing]. The current episode is [current episode][end if]." [ Based on his scores, if the endgame began now Progue would fall into the [progue-archetype] archetype.]
"Affinity Score: [affinity of Progue]"	Table of Progue Affinity	--	--
"Submission Score: [submission of Progue]"	Table of Progue Submission	--	--
"Paternalism Score: [paternalism of Progue]"	Table of Progue Paternalism	--	--
"Romance Score: [romance of Progue]"	Table of Progue Romance	--	--

Table of Progue Affinity 
title		subtable		description	toggle
"PREMENU"	--	"Current Affinity: [affinity of Progue] (If this number is above 0, Progue likes you; if below, he doesn't.) After meeting Progue it's not possible to be 0. The maximum and minimum are based on Progue's current psychological state."	--
"Raise Affinity"	--	--	Progue-likes-you rule
"Lower Affinity"	--	--	Progue-dislikes-you rule
"POSTMENU"	--	"Press Q to go back."

This is the Progue-likes-you rule: Progue likes you more, silently. This is the Progue-dislikes-you rule: Progue likes you less, silently.

Table of Progue Submission
title		subtable		description	toggle
"PREMENU"	--	"Current Submission: [submission of Progue] (If this number is above 0, Progue feels submissive towards you; otherwise, he feels dominant towards you.) After meeting Progue it's not possible to be 0. The maximum and minimum are based on Progue's current psychological state."	--
"Raise Submission"	--	--	Progue-more-sub rule
"Lower Submission"	--	--	Progue-less-sub rule
"POSTMENU"	--	"Press Q to go back."

This is the Progue-more-sub rule: Progue is more submissive, silently. This is the Progue-less-sub rule: Progue is less submissive, silently.


Table of Progue Paternalism
title		subtable		description	toggle 
"PREMENU"	--	"Current Paternalism: [paternalism of Progue] (The higher above 0 this number is, the more fatherly Progue feels towards you.) It's not possible to be less than 0. The maximum is based on Progue's current psychological state. Raising this lowers the romance attribute."	--
"Raise Paternalism"	--	--	Progue-more-dad rule
"Lower Paternalism"	--	--	Progue-less-dad rule
"POSTMENU"	--	"Press Q to go back."

This is the Progue-more-dad rule: Progue feels more like a father, silently. This is the Progue-less-dad rule: Progue feels less like a father, silently.

Table of Progue Romance
title		subtable		description	toggle
"PREMENU"	--	"Current Romance: [romance of Progue] (The higher above 0 this number is, the more romantic Progue feels towards you.) Normally, it's not possible to drop this below 0, unless Progue is spurned in this phase, in which it becomes -1. The maximum is based on Progue's current psychological state. Raising this lowers the paternlaism attribute."	--
"Raise Romance"	--	--	Progue-more-love rule
"Lower Romance"	--	--	Progue-less-love rule
"Break Progue's Heart"	--	--	Progue-wayless-love rule
"POSTMENU"	--	"Press Q to go back."

This is the Progue-more-love rule: Progue is aroused, silently. This is the Progue-less-love rule: Progue is losing interest, silently. This is the Progue-wayless-love rule: Progue is heartbroken.

Table of Progue Reset
title		subtable		description	toggle
"PREMENU"	--	"This can sometimes fix Progue if he gets stuck[if an episode is playing]. WARNING: Since an episode is playing ([current episode]) resetting Progue right now may break the drama manager and prevent the game's narrative from continuing."
"Reset Progue"	--	--	Progue-reset rule.

This is the Progue-reset rule:
	if an episode is playing, complete current episode;
	pick a new activity for Progue.

Table of Drama Options
title		subtable		description	toggle
"[if an episode is playing]Current Episode: [current episode][else]No Current Episode"	Table of Episode Status	--	--
"Boredom Meter: [boredom meter][if time for excitement] (Time for excitement)[end if]"	Table of Boredom Status	--	--
"Rume Interest Tracker: [Rume-tracker]"	Table of Rume Tracker	--	--
"Injury Status: [if yourself is hale]Uninjured[else]Injured[end if]"	Table of Injury Status	--	--
"Genders"	Table of Gender Status	--	--
"Time Of Day: [time of day] ([current interval])"	Table of Time Status	--	--
"Chose [if we chose art]Art[else]Love"		Table of Art Love Status	--	--

Table of Episode Status
title		subtable		description	toggle
"PREMENU"	--	"Episodes control the narrative progression of the story, particularly as it relates to Progue. Using this tool to end vital story episodes may cause the narrative to derail: use with caution."
"[if an episode is playing]End Current Episode ([current episode])[else]No  Episode Is Playing"	--	--	end-curr-ep rule

This is the end-curr-ep rule: if an episode is playing, complete current episode.

Table of Boredom Status
title		subtable		description	toggle
"PREMENU"	--	"Boredom Meter: [boredom meter]. As time goes on without any new or exciting events, the boredom meter continually rises. When it gets above [the excitement level], episodes and hint scenes are more likely to be triggered."
"Set Boredom Meter to 0"	--	--	reset-boredom rule
"Set Boredom Meter to [the excitement level]"	--	--	upset-boredom rule

This is the reset-boredom rule: now boredom meter is 0. This is the upset-boredom rule: now boredom meter is excitement level.

Table of Rume Tracker
title		subtable		description	toggle
"PREMENU"	--	"Rume Interest Tracker: [Rume-tracker]. Depending on how much interest you show in Rume, this number rises and falls. If it has reached +10 by the endgame, you'll get the Rume-centric epilogue. (If not, you'll get the Progue-centric epilogue, or, if Progue is dead, the player-centric epilogue.)"
"Miss Rume a Lot"	--	--	miss-rume-lots rule
"Miss Rume a Little"	--	--	miss-rume rule
"Dis Rume a Little"	--	--	dis-rume rule
"Dis Rume a Lot"	--	--	dis-rume-lots rule

This is the miss-rume-lots rule: miss Rume a lot. This is the miss-rume rule: miss Rume. This is the dis-rume rule: dis Rume. This is the dis-rume-lots rule: dis Rume a lot.

Table of Injury Status
title		subtable		description	toggle
"PREMENU"	--	"Injury Status: [if yourself is hale]Uninjured[else]Injured[end if]. It's possible to injury your leg in various ways during the game, which changes Progue's reaction to you and affects the ways you can solve various puzzles."
"Switch to [if yourself is hale]Injured[else]Uninjured[end if]"	--	--	injury-toggle rule

This is the injury-toggle rule: if yourself is hale, now yourself is wounded; else now yourself is hale.

Table of Gender Status
title		subtable		description	toggle
"Player: [if yourself is male]Male (Change to Female[else]Female (Change to Male[end if])"		--	--	player-gender rule
"Rume: [if Rume is male]Male (Change to Female[else]Female (Change to Male[end if])"	--	--	rume-gender rule

This is the player-gender rule: if yourself is male, now yourself is female; else now yourself is male. This is the rume-gender rule: if Rume is male, now Rume is female; else now Rume is male.

Table of Time Status
title		subtable		description	toggle
"PREMENU"	--	"Time of Day: [time of day] ([current interval])[if raining] and raining[end if]. Tide is [tidestatus]."
"Next Interval"	--	--	next-interval rule
"Previous Interval"	--	--	prev-interval rule
"Force Low Tide"	--	--	force-lowtide rule
"Force High Tide"	--	--	force-hightide rule

This is the next-interval rule:
	if current interval is night, let tmpint be dawn;
	else let tmpint be the interval after current interval;
	change the time of day to the time corresponding to tmpint;
	update interval.
	
This is the prev-interval rule:
	if current interval is dawn, let tmpint be night;
	else let tmpint be the interval before current interval;
	change the time of day to the time corresponding to tmpint;
	update interval.

This is the force-lowtide rule: now the tide counter is 590. This is the force-hightide rule: now the tide counter is 20.

Table of Art Love Status
title		subtable		description	toggle
"PREMENU"	--	"Chose [if we chose art]Art[else]Love[end if]. This choice colors certain aspects of gameplay and becomes significant in the endgame."
"Switch to [if we chose art]Love[else]Art[end if]"	--	--	art-love-switch rule

This is the art-love-switch rule:
	if we chose love:
		now pr_love is unspoken;
		now pr_art is spoken;
	else:	
		now pr_art is unspoken;
		now pr_love is spoken.


Table of Puzzle Options
title		subtable		description	toggle
"PREMENU"	--	"WARNING: This is not a hint mode, but a tool that lets you bypass certain puzzles. The next screen assumes you have familiarity with all the puzzles in the game and might contain spoilers if you haven't already completed it once.

Furthermore, these options may cause execution problems if selected at certain moments during the game. Please save your game in progress before selecting anything here."
"Proceed"	Table of Puzzle2 Options	--	--

Table of Puzzle2 Options
title		subtable		description	toggle
"Open Color Door In Shack"	--	--	open-shack-door rule
"Increase Power In Steam System"	--	--	increase-steam rule
"Teleport to Egg in Rain Forest"	--	--	tp-egg rule
"Lower Secret Island Bridge"		--	--	secret-bridge rule
"Open Pyramid"		--	--	open-pyramid rule
"Mark All Trees Contacted (inventory shows passwords)"	--	--	contact-trees rule
"Mark City as Visited"	--	--	city-done rule
"Mark Forest as Visited"		--	--	forest-done rule

This is the open-shack-door rule: now lava tunnel door is open; if the psyche of Progue is ignorance, now the psyche of Progue is denial. This is the increase-steam rule: now the system power is 30. This is the tp-egg rule: move player to Egg Room. This is the secret-bridge rule: now secret rope bridge is open. This is the open-pyramid rule: remove the pyramid from play; move the mind chair to Observatory Exterior; move the mind machinery to Observatory Exterior. This is the contact-trees rule: now every windsigh tree is contacted; change the tree-password to "itchy"; change the rebel-password to "scratchy". This is the city-done rule: now cl_story7 is spoken; now the player is yourself; now the psyche of Progue is fugue. This is the forest-done rule: now gp_outtro is spoken; now the player is yourself; now the psyche of Progue is fugue.   
 
  
Table of Stats Mode Options
title		subtable		description	toggle
"PREMENU"	--	"Stats mode shows you notifications every time significant variables change, such as other characters['] feelings towards you. Turn it on if you want to expose some of the mechanics behind the story.[paragraph break]Stats mode is currently [if stats mode is true]ON[else]OFF[end if]."
"Toggle Stats Mode"	--	--	stats-mode rule

This is the stats-mode rule: if stats mode is true, now stats mode is false; else now stats mode is true.

When play begins: if final release mode is false and milestone mode is false, now stats mode is true.
 
Stats mode is a truth state that varies. 

Table of Tutorial Mode Options
title		subtable		description	toggle
"PREMENU"	--	"The tutorial shows you messages in the earlier parts of the game that help you learn how to interact with the story in Blue Lacuna, and is recommended for both experienced interactive fiction players and those new to the genre.[paragraph break]Tutorial mode is currently [if tutorial mode is switched on]ON[else]OFF[end if]."
"Toggle Tutorial Mode"	--	--	tutorial toggling rule


   



Part - New Kinds & Extending the World Model


Section - Props
   
[ Blue Lacuna ordinarily doesn't allow items to be picked up and carried around. This kind is for objects that are small and light enough that they would be take-able in an ordinary game.]

A prop is a kind of thing. A prop is usually fixed in place and undescribed. Check taking a fixed in place prop: say "You'd rather not carry that around." instead.      
  
Section - Setpieces

[ A setpiece is something too large to carry enclosed by the location.]

A setpiece is a kind of thing. A setpiece is usually fixed in place and undescribed. A setpiece can be perchable or unperchable. A setpiece is usually unperchable. [Things Progue can sit on.] 
   
Section - Set Dressing

[ Set dressing is something that vanishes from the location as soon as the player leaves. This is useful for unimportant objects mentioned in ambient messages, or ephemeral details like footprints.]

A set dressing is a kind of prop. After going (this is the remove set dressing rule): repeat with item running through on-stage set dressings begin; remove item from play; end repeat; continue the action.       
   
Section - Views

[ Views are large objects that can be seen from multiple locations.]

A view is a kind of backdrop. Instead of touching or taking or pushing or pulling or attacking or climbing or entering or tasting or opening a view, say "You are too far from [the noun] to do anything but look."  . asdf787 is a view. [ This prevents a crash during testing situations where all modules containing views are turned off.] 
   
Every view has a room called the base room. The base room of a view is usually UnRoom. [ This is used so we can "approach mountain" and know where to go.]
 
[ Also see Section - Visibility ]   
 

Section - Minor Things

A thing can be major or minor. A thing is usually major.  
 
Every thing has some text called provoke message.  

Instead of doing anything other than examining or remembering or examining by name or following to a minor thing (called target): 
	if the provoke message of target is "", try examining target;
	otherwise say "[provoke message of target][line break]". [ not sure why the extra line break here is needed, but it is...]  

Section - Abstractions

[ Used for non-tangible things.]

An abstraction is a kind of thing. An abstraction is always undescribed and minor.      

Section - Intervals

The interval is a kind of value. The intervals are dawn, sunrise, morning, midmorning, midday, afternoon, evening, sunset, twilight, night, moonrise, high tide, falling uptide, falling downtide, moonset, low tide, rising downtide, and rising uptide. Understand "daybreak" as dawn. Understand "noon" as midday. Understand "dusk" as twilight. Understand "dark" as night.  

Current interval is an interval that varies.

First every turn when location is regionally in Lacuna and we are not landmark-going (this is the deciding which interval is current rule): 
	update interval.
	 
To update interval:   
	if dawn begin; now current interval is dawn;
	otherwise if sunrise; now current interval is sunrise;
	otherwise if morning; now current interval is morning;
	otherwise if midmorning; now current interval is midmorning;
	otherwise if midday; now current interval is midday;
	otherwise if afternoon; now current interval is afternoon;
	otherwise if evening; now current interval is evening;
	otherwise if sunset; now current interval is sunset;
	otherwise if twilight; now current interval is twilight;
	otherwise; now current interval is night;  
	end if.  



Section - Prose Name

Every room has some text called prose name. The prose name of a room (called locale) is usually "NULL".   


Section - Books

Understand the command "read" as something new. Reading is an action applying to one visible thing. Understand "read [something]" as reading. 

Check reading when night and location is not regionally in Dreamlands: say "It's too dark to read right now." instead.

Check reading: if noun is not a book, try examining noun instead.    

A book is a kind of thing. Understand "book" or "books" or "page" or "pages" as a book.

A book can be open or closed. A book can be openable. A book is usually closed. A book is always openable. Does the player mean doing something to an open book: it is likely. Check opening a book (called tome): try reading tome instead. Check closing a book (called tome): now tome is closed; say "You close [the tome] again." instead.  

A book has a number called current page. The current page of a book is usually 0. To say current page of (tome - a book): let n be the current page of tome; choose row n in the contents of tome; say "[desc entry]".

A book has a table-name called contents. The contents of a book is usually Table of No Contents.         
    
Table of No Contents    
desc  
"The page is blank."   

Carry out reading:      
	repeat with tome running through books enclosed by location:
		now tome is closed;
	now noun is open;
	if current page of noun is 0, now current page of noun is 1; 
	say "[if current page of noun is 1]You open [the noun] and study the first page.[paragraph break][end if][current page of noun][paragraph break][if the current page of noun is at most the number of rows in contents of noun - 1]It looks like you could see more if you turn the page[otherwise][The noun] is turned to the last page[end if].".   
   
Check turning a book (called tome): 
	increase the current page of tome by 1;
	if current page of tome is greater than the number of rows in contents of tome begin;   
		now the current page of tome is 0;
		say "You seem to have reached the end of [the tome]. You close it again." instead;
	otherwise; 
		say "You turn the page.";   
		try reading tome instead; 
	end if. 

Section - Posture

player_imperiled is a truth state that varies.

Posture is a kind of value. The postures are reclining, sitting, standing, pacing, imperiled, and restraining. A person has a posture. A person is usually standing. 


 

Section - Elevation
 
An elevation is a kind of value. -1000 feet specifies an elevation. A room has an elevation.     
  
Definition: a room is low if its elevation is 50 feet or less. Definition: a room is uphigh if its elevation is 75 feet or more.        
  
Check going down when the room down from the location is not a room (this is the using elevation to determine which direction is down rule):       
    if an adjacent room is lower than the location begin;      
        head to the lowest adjacent room;  
	 do nothing instead;
    otherwise;  
        say "You can't see any way to go down from here." instead; 
    end if. 

Check going up when the room up from the location is not a room (this is the using elevation to determine which direction is up rule): 
    if an adjacent room is uphigher than the location begin; 
        head to the uphighest adjacent room; 
	 do nothing instead;
    otherwise; 
        say "You can't see any way to go up from here." instead; 
    end if. 

Section - Wakefulness

[ This should probably be deprecated. The proper way to make Progue asleep is to give him the animus "resting." Only yourself needs to be asleep/awake. (I think. Or do we use it for Rume?]

A person is either asleep or awake. A person is usually awake.

Section - In and Out

A room can be indoorsy or outdoorsy. A room is usually outdoorsy. 

Definition: a room is outward: 
    if it is indoorsy and the location is outdoorsy then no; 
    if it is outdoorsy and the location is indoorsy then yes; 
    if the number of rooms adjacent to it is greater than the number of rooms adjacent to the location then yes; 
    otherwise no.

Definition: a room is inward:  
    if it is outdoorsy and the location is indoorsy then no; 
    if it is indoorsy and the location is outdoorsy then yes; 
    if the number of rooms adjacent to it is less than the number of rooms adjacent to the location then yes; 
    otherwise no.  
 
Check going nowhere when the noun is outside: try exiting instead. 

Check exiting when the player is in a room (this is the guessing which way is out rule): 
    if at least one adjacent room is outward begin;  
        head to a random adjacent outward room;  
	do nothing instead;
    otherwise; 
        say "I'm not sure which way you mean. [exits]." instead;  
    end if.

Check going inside when the room inside from the location is not a room and at least one adjacent room is inward (this is the guessing which way is in rule): 
	if more than one adjacent room is inward begin; 
		say "I'm not sure which way you mean. [exits]." instead;
    otherwise; 
        head to a random adjacent inward room; 
	do nothing instead;
    end if. 



Section - Exits

A room has some text called the exits text. The exits text of a room is usually " ".  

Requesting the exits text is an action applying to nothing. Understand "exits" as requesting the exits text. Report requesting the exits text: say "[exits]."    [ We can't make this out of world since it is called by room descriptions, and if an OOW action is called the rest of the action routine no longer runs correctly. --Actually, I'm not sure this is true. Isn't the "to say exits" all that's called?]
  
Definition: a direction is viable if the room it from the location is a room.   

Check going nowhere: say "[goingnowhere]" instead. To say goingnowhere: say "You can't see an exit in that direction. [exits].[actfast]".  
   
To say exits:   
	if the exits text of the location is not " " begin; say "[the exits text of the location]";   
	otherwise;  
		let count of exits be the number of viable directions; 
		if the count of exits is 0, say "You can't see anywhere to go from here";
		if the count of exits is 1, say "From here, the only way out is to [list of viable directions]"; 
		if the count of exits > 1, say "From here, the viable exits are to [list of viable directions]";  
	end if. 

  
Section - Injury  
  
A person can be wounded or hale. A person is usually hale.    [ For the player breaking leg subplot.]


Section - Scrawls

[ These are the secret messages in Progue's language that provide hints and backstory.]

Reading level is a kind of value. The reading levels are uneducated, vowel-knowing, and language-knowing. The player has a reading level. The reading level of the player is uneducated.

A scrawl is a kind of prop. Check taking a scrawl: say "It's just writing." instead. A scrawl has some text called the standard message. A scrawl has some text called the secret message.  show-secret-scrawl is a truth state that varies. A scrawl is either hint-based or story-based. A scrawl is usually hint-based. Understand "copy [a scrawl]" or "write [a scrawl]" as a mistake ("You don't have anything to copy it down with."). Understand "message/letters" as a scrawl.

Check examining a scrawl:
	let full-message be indexed text; 
	if show-secret-scrawl is true: 
		if secret message of noun is "", say "You touch your fingers to the message, but no additional words appear.[paragraph break]";
		else say "As you touch the message, faint glowing letters appear below it, appearing in slow waves of heat diffusion spreading from your hand.[paragraph break]";
		change full-message to "[standard message of noun][secret message of noun]";
	otherwise: 
		change full-message to "[standard message of noun]";
	if reading level of player is uneducated:
		say "The message is written in strange letters that you don't understand.";
	otherwise if reading level of player is vowel-knowing:
		say "You recognize some of the letters from the clockwork head in the treehouse, but the message is still mostly incomprehensible.";
	if reading level of player is not language-knowing:
		if screen reader mode is true:
			say "Though you can't make it out, you see that the message runs from right to left." instead;
		otherwise:
			say line break;
			designify full-message;
		say line break instead;
	otherwise:
		if noun is hint-based: 
			say "From what you learned from the clockwork head in the treehouse, you think you'd be able to [t]translate[x] the message, though it will take some time[one of].[paragraph break][as the parser]Many of the writings you can translate can be seen as hints to nearby puzzles. If you don't want to see any hints related to this part of the island, don't translate the messages just yet.[as normal][or].[stopping]" instead;
		else:
			try translating noun instead.

Check touching a scrawl:
	if night:
		now show-secret-scrawl is true;
		try examining noun instead;
	else:
		say "You rub your fingers along the message, but feel nothing unexpected." instead.
		
After going (this is the reset secret scrawl rule):
	now show-secret-scrawl is false;
	continue the action.

Understand "translate [a scrawl]" as translating. Translating is an action applying to one thing. Rule for supplying a missing noun when translating: let Phil be a random scrawl enclosed by the location; if Phil is not a scrawl, say "There's nothing here to translate." instead; change the noun to Phil.  

Carry out translating: 
	if the reading level of player is language-knowing:
		pass 30 minutes of time;
		say "[one of]Read right to left and phonetically, you are unsurprised to discover you can read the script. In all worlds you've wayfared to, while the writing always changes, the spoken language, strangely, remains the same.[paragraph break][or][stopping]The message reads:[line break]";
		say line break;
		if screen reader mode is false:
			designify standard message of noun;
			say "[paragraph break]Or, the way you're more used to reading it:[paragraph break]";
		say "'[standard message of noun][if show-secret-scrawl is true][i][secret message of noun][r][end if]'.";
	otherwise:
		say "You don't know enough about this language yet to be able to translate it.".


To designify (msg - an indexed text):
	let original be indexed text;
	let coded be indexed text;
	now original is msg;
	let line-length be 35;
	let line-ctr be 0;
	repeat with wd running from 1 to the number of punctuated words in original:
		if line-ctr + 1 + the number of characters in punctuated word number wd in original > line-length:
			let padspaces be indexed text;
			now padspaces is "";
			while line-length - line-ctr > 0:
				now padspaces is " [padspaces]";
				increase line-ctr by 1;
			now coded is "[line break][padspaces][coded]";
			now line-ctr is 0; 
		increase line-ctr by the number of characters in punctuated word number wd in original + 1;
		let tmpword be indexed text;
		let tmpword be punctuated word number wd in original;
		[ Alright, this is admittedly ridiculous and a real man would have just coded this in Inform 6. But this is faster than a more automated I7 version might be.]
		if the number of characters in tmpword is 12:
			now coded is " [character number 12 in tmpword][character number 11 in tmpword][character number 10 in tmpword][character number 9 in tmpword][character number 8 in tmpword][character number 7 in tmpword][character number 6 in tmpword][character number 5 in tmpword][character number 4 in tmpword][character number 3 in tmpword][character number 2 in tmpword][character number 1 in tmpword][coded]";
		else if the number of characters in tmpword is 11:
			now coded is " [character number 11 in tmpword][character number 10 in tmpword][character number 9 in tmpword][character number 8 in tmpword][character number 7 in tmpword][character number 6 in tmpword][character number 5 in tmpword][character number 4 in tmpword][character number 3 in tmpword][character number 2 in tmpword][character number 1 in tmpword][coded]";
		else if the number of characters in tmpword is 10:
			now coded is " [character number 10 in tmpword][character number 9 in tmpword][character number 8 in tmpword][character number 7 in tmpword][character number 6 in tmpword][character number 5 in tmpword][character number 4 in tmpword][character number 3 in tmpword][character number 2 in tmpword][character number 1 in tmpword][coded]";
		else if the number of characters in tmpword is 9:
			now coded is " [character number 9 in tmpword][character number 8 in tmpword][character number 7 in tmpword][character number 6 in tmpword][character number 5 in tmpword][character number 4 in tmpword][character number 3 in tmpword][character number 2 in tmpword][character number 1 in tmpword][coded]";
		else if the number of characters in tmpword is 8:
			now coded is " [character number 8 in tmpword][character number 7 in tmpword][character number 6 in tmpword][character number 5 in tmpword][character number 4 in tmpword][character number 3 in tmpword][character number 2 in tmpword][character number 1 in tmpword][coded]";
		else if the number of characters in tmpword is 7:
			now coded is " [character number 7 in tmpword][character number 6 in tmpword][character number 5 in tmpword][character number 4 in tmpword][character number 3 in tmpword][character number 2 in tmpword][character number 1 in tmpword][coded]";
		else if the number of characters in tmpword is 6:
			now coded is " [character number 6 in tmpword][character number 5 in tmpword][character number 4 in tmpword][character number 3 in tmpword][character number 2 in tmpword][character number 1 in tmpword][coded]";
		else if the number of characters in tmpword is 5:
			now coded is " [character number 5 in tmpword][character number 4 in tmpword][character number 3 in tmpword][character number 2 in tmpword][character number 1 in tmpword][coded]";
		else if the number of characters in tmpword is 4:
			now coded is " [character number 4 in tmpword][character number 3 in tmpword][character number 2 in tmpword][character number 1 in tmpword][coded]";
		else if the number of characters in tmpword is 3:
			now coded is " [character number 3 in tmpword][character number 2 in tmpword][character number 1 in tmpword][coded]";
		else if the number of characters in tmpword is 2:
			now coded is " [character number 2 in tmpword][character number 1 in tmpword][coded]";
		else if the number of characters in tmpword is 1:
			now coded is " [character number 1 in tmpword][coded]";
	let padspaces2 be indexed text;
	while line-length - line-ctr > 0:
		now padspaces2 is " [padspaces2]";
		increase line-ctr by 1;
	now coded is "[padspaces2][coded]"; 
	if the reading level of player is vowel-knowing: [obscure everything except the vowels]
		replace the regular expression "<BCDFGHJKMNPQRSTVWXYZbcdfghjkmnpqrstvwxyz>" in coded with "-";
	otherwise if reading level of player is uneducated:
		replace the regular expression "<ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijiklmnopqrstuvwxyz>" in coded with "-";
	replace the regular expression " (<,?!.>) " in coded with "  \1";
	replace the regular expression " (<[quotation mark][apostrophe]>) " in coded with "  \1";
	say "[fixed letter spacing][coded][variable letter spacing]".

To decide which indexed text is the reverse of (wd - an indexed text):
	let candidate be indexed text;
	repeat with lt running from 1 to the number of characters in wd:
		now candidate is "[character number lt in wd][candidate]";
	decide on candidate.    
 

Section - Passwords

  
The tree-password is indexed text that varies. The tree-password is "not.hing". The rebel-password is indexed text that varies. The rebel-password is "noth.ing". The machinery-password is indexed text that varies. The machinery-password is "no.thing".  To decide whether tree-password is set: if tree-password is not "not.hing", decide yes; decide no. To decide whether rebel-password is set: if rebel-password is not "noth.ing", decide yes; decide no. To decide whether tree-password is unset: if tree-password is set, decide no; decide yes. To decide whether rebel-password is unset: if rebel-password is set, decide no; decide yes. 
 
Defining a password is an action applying to one thing and one topic. Understand "setkey [any thing] [text]" as defining a password.         

Rule for asking which do you mean while defining a password: do nothing; now disambiguation_flag is true. [ If we type a word that matches an object, the parser tries to disambiguate.]
 
Passwords is a thing. [ For debugging. ]  
 
To decide whether (passage - an indexed text) is blank: 
	if passage matches the text "no.thing", decide yes; decide no.  
	
To decide whether (passage - an indexed text) is not blank: if passage is blank, decide no; decide yes.     

[ Check defining a password:     
	if not valid player password, do nothing instead.]   
	 
To decide whether (trial - indexed text) is an invalid password:  
	if passwords is being debugged, say "// Passwords: deciding whether [trial] is an invalid password.";   
	if a meta command matches trial, decide yes;    
	if the number of characters in trial is less than 2 begin;  
		speak as the parser "The word you choose must be more than 1 character."; 
		decide yes;    
	otherwise if the number of characters in trial is greater than 15;
		speak as the parser "The word you choose must have no more than 15 characters.";
		decide yes;
	otherwise if the number of words in trial is greater than 1;
		speak as the parser "You must choose a single word."; 
		decide yes;  
	otherwise if final release mode is false and trial exactly matches the text "tree"; 
		speak as the parser "{Since TREE is a testing command, you can't use that as a password in the beta.}";
		decide yes;  
	end if;
	decide no. 

To decide whether a meta command matches (trial - indexed text) :
	if trial exactly matches the text "undo" or trial exactly matches the text "save" or trial exactly matches the text "restore" or trial exactly matches the text "oops"  or trial exactly matches the text "quit" or trial exactly matches the text "restart":
		decide yes;
	decide no.

[ A procedural rule when defining a password: ignore the basic accessibility rule. ] 



[AAR4]The my-basic-accessibility rule is listed instead of The basic accessibility rule in the action-processing rulebook. This is the my-basic-accessibility rule: if not defining a password and not discussing and not exhausting and not remembering and not examining by name, abide by the basic accessibility rule.

tree1pw is a thing. verjpw is a thing. machpw is a thing.

Carry out defining a password:	
	if passwords is being debugged, say "// Passwords: Carry out defining a password for [noun].";	
	if noun is tree1pw begin;
		change the tree-password to the topic understood;
		rule succeeds;  
	otherwise if noun is Verjpw;   
		change the rebel-password to the topic understood;
		rule succeeds;
	otherwise if noun is machpw;
		change the machinery-password to the topic understood;
		rule succeeds;  
	otherwise; 
		if passwords is being debugged, say "// Passwords: ERROR: invalid password destination specified.";  
	end if.

[ Testers often tried to type their passwords in different contexts, such as the Echo Chamber or while calibrating the seiver, so we go to some lengths to understand the passwords typed alone or after "say." ] 
	
First smarter parser rule (this is the understand passwords rule):
	if input contains the tree-password or input contains the rebel-password:
		now the rejected command is "try#pw";
		rule succeeds.
		
Password-trying is an action applying to nothing. Understand "try#pw" as password-trying. 

Check password-trying:
	if location is Echo Chamber, say "You say the word and it echoes and distorts weirdly through the cave, the strange formations twisting the syllables around into different orders and shapes, but as the sounds slowly die away nothing further seems to happen." instead.
	
Carry out password-trying: 
	say "You speak the word aloud, but nothing happens.".
	
The Smarter Parser trying harder to understand rule is not listed in any rulebook. Before printing a parser error (this is the Blue Lacuna trying harder to understand rule): 
	now the original rejected command is the player's command;
	now the rejected command is the player's command; 
	follow the Smarter Parser rules;
	if the rule succeeded:
		if rejected command is not original rejected command:
			unless rejected command is "try#pw", follow the announcing new command rule;
			now sp reparse flag is true;
	otherwise if the rule failed:
		now suppress parser error is true.
		
	
Section - Visibility

Verynearing relates various views to various rooms. Nearing relates various views to various rooms. Faring relates various views to various rooms. Veryfaring relates various views to various rooms.  

The verb to be very near implies the verynearing relation. The verb to be near implies the nearing relation. The verb to be far from implies the faring relation. The verb to be very far from implies the veryfaring relation.

Check examining a view: 
	if noun is very near the location or noun is near the location or noun is far from the location or noun is very far from the location, continue the action; 
	otherwise say "You don't have a good view of [the noun] from here." instead.   

To say distance of (obj - a view): 
	if obj is very near location, say "quite close by";
	if obj is near location, say "a ways off";
	if obj is far from location, say "off in the distance";
	if obj is very far from location, say "hazy blue with distance".








Part - Commands

Chapter - Meta Commands

Section - Tutorial Mode

Tutorial mode is a device. Tutorial mode is switched on. 

Tutorial-switching is an action out of world applying to nothing. Understand "tutorial" as tutorial-switching. Understand "tutorial [text]" as a mistake ("[as the parser]Type TUTORIAL to toggle tutorial mode on and off[as normal].").

Carry out tutorial-switching:
	if tutorial mode is switched off:
		if location is not regionally in Homeworld:
			speak as the parser "Tutorial mode is no longer available at this stage of the story." instead;
		speak as the parser "Tutorial mode is now on.";
	otherwise:
		speak as the parser "Tutorial mode is now off.";
	follow the tutorial toggling rule.

This is the tutorial toggling rule: if tutorial mode is switched on, now tutorial mode is switched off; else now tutorial mode is switched on.


Section - Requesting the score

Understand the command "score" as something new. Understand the command "notify" as something new.

Understand "score" as requesting the score. 

Check requesting the score:
	say "You've made it to chapter [current chapter in words] (out of ten)";
	if current chapter > 1, say " in [if puzzle mode]puzzle[else]story[end if] mode";
	say ", exploring [the number of explored regions in words] region[s] (out of [the number of regions in words])";
	if met_progue is true:
		say ". You've met [the Progue], who [if affinity of Progue > 0]likes you[else]dislikes you[end if] ([if affinity of Progue > 0]+[end if][affinity of Progue]), [if submission of Progue > 0]feels submissive towards you[else]feels dominant towards you[end if] ([if submission of Progue > 0]+[end if][submission of Progue]), and ";
		if paternalism of Progue > 1:
			say "feels paternal towards you (+[paternalism of Progue])";
		else if romance of Progue > 1:
			say "feels romantic towards you (+[romance of Progue])";
		else if romance of Progue < 0:
			say "feels bitter towards you ([romance of Progue])";
		else:
			say "feels neither particularly paternal (+[paternalism of Progue]) nor romantic (+[romance of Progue]) towards you";
	if current chapter > 1, say ". You've shown [if rume-tracker <= -10]almost no[else if Rume-tracker < 0]a little[else if Rume-tracker < 10]some[else]significant[end if] interest in finding a way back to Rume[if player is wounded], you've injured yourself[end if][if time for excitement], and based on my best guess, I'd say you're a little bored right now[end if]";
	say ". And never forget that at first you chose [if we chose love]love[else]art[end if]." instead.

Definition: a region is explored: if the number of visited rooms regionally in it is at least 1, yes; no.
	
Understand "notify" as switching score notification. Switching score notification is an action out of world applying to nothing. Understand "notify on" or "notify off" as a mistake ("[as the parser]You can simply type NOTIFY to toggle stats mode[as normal].").

Check switching score notification:
	if stats mode is false:
		now stats mode is true;
		say "[as the parser]Stats mode turned on[as normal]." instead;
	else:
		now stats mode is false;
		say "[as the parser]Stats mode turned off[as normal]." instead.


Section - xyzzy

[ A little Easter egg.]

Xyzzying is an action out of world applying to nothing. Understand "xyzzy" as xyzzying. Carry out xyzzying: say "Here are some of the albums that were on constant play during my writing of Blue Lacuna, along with, in some cases, which sequence they helped shape. These albums can perhaps be thought of as the unofficial soundtrack:

Gyorgi Ligeti, Requiem[line break] 
Lisa Gerrard, The Silver Tree -- the Windsigh[line break]
Ryan Miller, Tim Larkin and Jack Wall, soundtracks to the Myst games -- exploring[line break]
Michael Stearns, The Lost World -- the eastern forest[line break]
Colleen, The Golden Morning Breaks -- Phoebe and Lethe[line break]
amiina, Animamina and Kurr -- Phoebe and Lethe[line break]
Kenji Kawai, Ghost In The Shell Soundtrack -- The Great Philosopher[line break]"; say "Robert Rich, Gaudi / Below Zero -- The Heart of the Forest[line break]
Jakob Draminsky HÃ¸jmark, En Landsoldats Dagbog -- Progue's Despair[line break]
Jocelyn Pook, various -- painting[line break]
Jeremy Soule, Game Soundtracks[line break]
Michael Andrews, Donnie Darko Original Score -- Progue's Playfulness[line break]
Aphex Twin, Melodies From Mars -- Progue[line break]
Eluvium, various albums -- the dreams

And other albums which are not tied to particular moments but which nevertheless received heavy play during the writing:

Geinoh Yamashirogumi, Akira Soundtrack / Ecophony Gaia[line break]
[xyzzy2]". To say xyzzy2: say "Brian Tyler, Children of Dune[line break]
Matt Uelmen, Diablo II Soundtrack[line break]
Leon Willet, Dreamfall Soundtrack[line break]
Philip Glass, Koyaanisquatsi[line break]
Paul Ruskay, Homeworld Soundtrack[line break]
Juno Reactor, Labyrinth[line break]
Sigur RÃ³s, various albums[line break]
Lemon Demon[line break]
Vangelis, various albums[line break]
Clint Mansell, The Fountain[line break]
and the entire Jonathan Coulton catalog.". 


Understand "things" as thing-listing. Thing-listing is an action out of world applying to nothing. Carry out thing-listing: say "Nearby [is-are the list of mentionable things]." 


   

 

Chapter - Emphasized Keyword Processing
  
[  
Precedence rules: 

Mistakes always take precedence over non-mistakes.

A more specific grammar line takes precedence:
  "a door" is more specific than "a thing"
  "a robust thing" is more specific than "a thing"
  "a thing" is more specific than "any thing"

Earlier lines of equal specificity take precedence.

Ergo, the following lines are in order of precendence.
]       
   
Understand "[a metalike prop]" as examining by name.    
         
Understand "[a metalike thing]" as examining by name. [ If we need to discuss a thing, add a check rule (see distant-tree3 in Lacuna). ] [This is distinct so that takeable things will be selected before background objects without disambiguation questions. Players can always "x something" to disambiguate as normal.]               
        
Understand "discuss [any metalike beat]" or "[any metalike beat]" as discussing.                 
            
Understand "[any landmarkable room]" or "go [any landmarkable room]" or "go to [any landmarkable room]" or "go back to [any landmarkable room]" as landmark-going. Definition: a room is landmarkable if it is landmarked and it is visited.     

Understand "go to [a direction]" as going. Understand "go in to [something]" as entering. Understand "go down [something]" as entering. Understand "go up [something]" as entering.
       
Understand "[any seen thing]" as remembering. [ See Remembering for definition of seen.]  
   
Understand "examine [an unimplemented door]" or "x [an unimplemented door]" as a mistake ("[as the parser]Most of the time, exits are more useful for moving towards than examining more closely. In this case, there are no further interesting details to be seen.[as normal]").      
      
Definition: a thing is metalike if 1 is 1.    

A door can be either implemented or unimplemented. A door is usually unimplemented.     

Chapter - Synonyms and New Grammar

Understand the command "nothing" as "listen". Understand "say nothing" as listening. 

Understand "look [something]" as examining. 

Understand the command "bring" or "grab" as "take".

Understand the command "see" as "look".

Understand the command "place" as "put".

Understand "wayfarer" as yourself when last beat is silence.  
 
Understand the command "shift" as something new. Understand the command "cover" as something new. 
 
Check taking a person: try touching noun instead.

Check swearing mildly: try swearing obscenely instead.    

Understand "sit [something]" or "sit at [something]" as entering. Does the player mean entering a supporter: it is likely. 

Understand the command "descend" or "ascend" as "climb". 

The can't push what's fixed in place rule is not listed in any rulebook.         

Understand the command "raise" or "lift" as "pull". Understand the command "lower" [or "poke"] as "push". 
 
Understand the command "catch" or "untie" as "take". Understand the command "spin" as "turn".  
 
Understand the command "wave" as something new. Understand the command "shed" as something new. Understand the command "tree" as something new. Understand the command "pay" as something new. Understand the command "buy" as something new.    

Understand "add [something] to [something]" as putting it on.    
 
sleeponing is an action applying to one thing. Understand "sleep on/in [something enterable]" or "rest on/in [something enterable]" or "lie down on/in [something enterable]" or "lay down on/in [something enterable]" or "lay on/in [something enterable]" or "lie on/in [something enterable]" as sleeponing. Check sleeponing: if it is before 5:01 AM or it is after 6:59 PM, try entering noun; try sleeping instead.            
 
Understand the command "light" as something new.       
 
Understand "climb [a direction]" as going. Understand "climb into/in/on/through [something]" as entering.

[ Understand "climb [a direction] [something]" as overly-specific-going. Understand "climb [something] [a direction]" as overly-specific-going (with nouns reversed). Overly-specific-going is an action applying to two things. Carry out overly-specific-going: try going noun instead. ][ Doesn't work because of issues parsing directions.]   
 
Understand "get in" as entering. Rule for supplying a missing noun when entering: if an enterable supporter (called platform) is enclosed by the location begin; change the noun to platform; otherwise if an enterable container (called platform) is enclosed by the location; change the noun to platform; otherwise; speak as the parser "I'm not sure what you wanted to do that to."; end if.  

Understand "get out of/from [something enterable]" or "exit [something enterable]" as specific-exiting.  Specific-exiting is an action applying to one thing. Carry out specific-exiting: try exiting.    

Understand "off" as exiting.
 
Understand "go to bed" or "go to sleep" or "lie down" as sleeping.         
 
Understand the command "cross" as something new. 

Understand "sit down" as entering. Understand "sit down on [something]" as entering.  

[ Understand "drink from [something]" as tasting. ][For some reason, this doesn't work.]

Check looking (this is the differentiate player-requested looks rule):
	let pcmd be indexed text; 
	let pcmd be the player's command;
	if pcmd exactly matches the text "l" or pcmd exactly matches the text "look", now player-looking is true. 
	
Before reading a command (this is the reset player-looking rule): now player-looking is false. player-looking is a truth state that varies.

Understand "extinguish [something]" or "douse [something]" or "blow [something]" as switching off.       
  
Understand the command "fix" as something new.  

Understand the command "short" as something new. Understand the command "long" as something new.     
  
Understand the command "explore" as "go". Understand the command "find" as "examine".  

Understand the command "place" as something new.  



Chapter - Player Commands
     


Section - Wayfaring and Painting

Understand "wayfare" as wayfaring. Wayfaring is an action applying to nothing.    

Check wayfaring: say "You wayfare by painting." instead.   

Vague painting is an action applying to nothing. Understand "paint" or "draw" or "work" or "make" or "finish" as "[paintword]". Understand "[paintword]" or "answer call" or "answer the call" as vague painting. 
  
Painting is an action applying to one thing. Understand "use [lacuna-canvas]" or "use [paintbrushes]" or "[paintword] with [paintbrushes]" or "[paintword] [lacuna-canvas]" or "[paintword] on [lacuna-canvas]" as painting.   
 
Carry out painting: say "[cantpainthere].". Carry out vague painting: say "[cantpainthere].". To say cantpainthere: say "There's nothing here to paint with[if location is regionally in Homeworld]; you must get to your studio[end if]".  

Section - Using

Understand "use [an edible thing]" as eating.   

Understand "use [a wearable thing]" as wearing.

Understand "use [a closed openable container]" as opening. Understand "use [an open openable container]" as closing.

Understand "use [a switched off device]" as switching on. Understand "flip [something]" as switching on. 
 
Understand "use [something]" as using. Using is an action applying to one thing. Carry out using: say "[as the parser]You will have to be more specific about your intentions[as normal]."

Understand "use [a door]" as opening. Understand "use [an open door]" as entering.

Understand "use [something enterable]" as entering.

Section - Leaping and Crossing

Understand "jump in/into/across/over [something]" or "dive in/into [something]" as leaping. Understand "jump off/from [something]" or "jump off/out of [something]" as leaping. Understand "jump on/onto [something]" as entering.

Leaping is an action applying to one thing.  
 
Carry out leaping:
	if noun is not enterable, try jumping instead;
	try entering noun.
	
Understand "cross [something]" or "cross over [something]" as crossing. Understand "cross" as crossing.
 
Crossing is an action applying to one thing.

Carry out crossing: say "That's not something you can cross."


Section - Going Back

The former location is a room that varies.      
  
First carry out going rule (this is the update the former location rule):   
    change the former location to the location.    

Understand "go back" as retreating. Understand "back" or "return" or "retreat" as retreating.   
  
Retreating is an action applying to nothing. 
 
Check retreating when the former location is the location: say "You haven't gone anywhere yet." instead.

Carry out retreating:      
	if former location is an adjacent room, head to former location;
	otherwise say "You can't see an open way back."   


Section - Following
  
Following is an action applying to one thing. Understand "follow [any seen thing]" or "approach [any seen thing]" or "go to/towards/after [any seen thing]" or "go [any seen thing]" or "walk to/towards/after [any seen thing]" or "move to/towards [any seen thing]" as following. 
 
Check following:   
	if noun is off-stage and noun is distant-progue, try following Progue instead;
	if noun is off-stage, say "[as the parser]You can't approach or follow that noun, either because it's not important, no longer relevant, or I misunderstood the noun.[as normal]" instead;
	if noun is a heavenly body, say "Would that you could." instead;
	if noun is distant-rayfish and location is not Ocean Waters:
		let way be the best route from location to Ocean Waters;
		if way is a direction:
			try going way instead;
		else:
			say "[cantfollowmsg]" instead;
	if noun is not a backdrop and noun is enclosed by location, say "But [the noun] [is-are of noun] right here." instead; 
	if noun is an adjacent room, head to noun instead; 
[	if noun is a landmarked room, try wordgoing noun instead;]
	if noun is a view and the base room of noun is not Unroom:
		if base room of noun is location, say "You're already there." instead;
		let way be the best route from location to base room of noun;
		if way is a direction:
			unless the room way from location is base room of noun, say "(moving one area towards that destination)[command clarification break]";
			try going way instead; 
		else:
			say "[cantfollowmsg]" instead;
	if noun is old path: 
		if location is South Beach:  
			try going southeast instead; 
		if location is Sloping Meadow:
			try going west instead;  
		if location is Big Tree:
			try going north instead; 
		try requesting the exits text instead;
	if noun is bridge:
		if location is Volcano Floor, try going northwest instead;
		if location is Sloping Meadow, try going east instead;
		if location is Rockslide, try going southwest instead;
		if location is Jumble, try going southeast instead;
	if ( location is regionally in Homeworld and noun is not regionally in Homeworld ) or ( location is regionally in Lacuna and noun is not regionally in Lacuna ) or ( location is regionally in Rebelworld and noun is not regionally in Rebelworld ) or ( location is regionally in Treeworld and noun is not regionally in Treeworld ) or ( location is regionally in Dreamlands and noun is not regionally in Dreamlands ) , say "You wish you knew how to get there from here." instead;   
	if noun is a person and noun is enclosed by location:
		say "[The noun] [is-are] still here." instead;	
	if noun is a person and location of noun is adjacent to location:
		head to location of noun; 
		do nothing instead;
		[ let way be the best route from location to location of noun;
		if way is a direction, try going way instead;
		else say "[cantfollowmsg]" instead;]
	if noun is a room:
		let way be the best route from location to noun;
		if way is a direction:
			unless the room way from location is location of noun:
				say "(moving one area towards that destination)[command clarification break]";
			try going way instead;
		else: 
			say "[cantfollowmsg]" instead;  
	if noun is off-stage: 
		say "[cantfollowmsg]" instead; 
	let way be the best route from location to location of noun;
	if way is a direction:
		unless the room way from location is location of noun:
			say "(moving one area towards that destination)[command clarification break]";
			if noun is distant-Progue or noun is Progue, move distant-Progue to the room way from location;
		try going way instead;
	say "[cantfollowmsg]" instead.

To say cantfollowmsg: say "You'll have to work out how to get there on your own.[actfast]". 

	  



[ After deciding the scope of the player while following: repeat with locale running through adjacent rooms begin; place locale in scope; end repeat. ]      
  
The my-reach-inside-rooms rule is listed instead of the can't reach inside rooms rule in the reaching inside rulebook. This is the my-reach-inside-rooms rule: if not following and not remembering, abide by the can't reach inside rooms rule.

Carry out following:  
	do nothing.




Section - Navigate by room names

[Speed tests showed that the below method was significantly faster than using Inform's built-in pathfinding, which became very significant when travelling via landmark, where both Progue and the player would be doing this calculation multiple times per move.]

To head to (destination - a room):
	if the room north of location is destination begin; try going north;
	else if the room northeast of location is destination; try going northeast;  
	else if the room east of location is destination; try going east;
	else if the room southeast of location is destination; try going southeast;
	else if the room south of location is destination; try going south;
	else if the room southwest of location is destination; try going southwest;
	else if the room west of location is destination; try going west;
	else if the room northwest of location is destination; try going northwest;		
	else if destination is above location; try going up;
	else if destination is below location; try going down;
	else if the room inside location is destination; try going inside;
	else if the room outside from location is destination; try going outside;
	else; try going north;
	end if.

Rule for clarifying the parser's choice of a room: do nothing instead. 



Section - Type nouns alone to examine them


Examining by name is an action applying to one thing. 

Carry out examining by name: try examining noun.



Section - Going by Landmark

A room can be landmarked or unlandmarked. A room is usually unlandmarked. 
 
A room has some text called the landmark name. The landmark name of a room is usually "null".     

The last landmark turn is a number that varies. The last landmark turn is 0.  [ This number stores the turn count on which we last discovered a new landmark, useful for the drama manager.] 

Understand "landmark" or "landmarks" as landmark-listing. Landmark-listing is an action applying to nothing.
 
we-are-landmark-going is a truth state that varies.
		
First report going to an unvisited landmarked room: say "(new [d]landmark[x] discovered)[command clarification break]"; now last landmark turn is turn count; continue the action.  
 
After reading a command: 
	if the player's command matches "go" or the player's command matches "walk", replace the player's command with "landmark";
	if the player's command matches "lie down" or the player's command matches "lay down" or the player's command matches "go to sleep", replace the player's command with "sleep". 

Definition: a room is unadjacent if it is not the location and it is not adjacent to the location.   

Landmark-going is an action applying to one thing.   
 
Check landmark-going:
	if noun is location, say "You're already here." instead;
	if noun is adjacent to location, head to noun instead.

To decide whether ready to landmark-go: 
	if ( noun is regionally in Homeworld and player is not regionally in Homeworld ) or ( noun is regionally in Lacuna and player is not regionally in Lacuna ) or ( noun is regionally in Rebelworld and player is not regionally in Rebelworld ) or ( noun is regionally in Treeworld and player is not regionally in Treeworld ) begin;
		say "That's in a whole other world[if noun is regionally in Homeworld]... one you can never return to[end if].";
		decide no; 
	end if;  
	if the holder of the player is not a room, try exiting;
	if location is not noun begin;
		say "You head towards ";    
		if the prose name of noun is "NULL", say "[the noun].";
		otherwise say "[the prose name of noun]."; 
	end if;
	truncate travelogue to 0 entries;   
	decide yes.  
 
Travelogue is a list of objects that varies.   

To clean up landmark-go, silently:   
	if we-are-landmark-going is false, stop; [ If this has been set by hand, it's assumed we've done all this already.]
	now we-are-landmark-going is false; 
	remove location from travelogue, if present;
	if not silently:
		if location is not noun, say "(Before you arrive, you were distracted"; 
		if the number of entries in travelogue is at least 1:
			if location is noun, say "On your way, you pass through ";
			otherwise say ", after passing through "; 
			let ctr be 1; 
			repeat with loc running through travelogue:
				say prose name of loc;
				if ctr is ( number of entries in travelogue - 1 ) :
					say " and "; 
				otherwise if ctr < number of entries in travelogue:
					say ", "; 
				increase ctr by 1;
		say "[if location is not noun].)[otherwise if the number of entries in travelogue is at least 1].[end if]";
	say "[line break][bold type][location][roman type][line break][description of location][line break]". [ We do it this way so we don't spend a turn looking, which would prevent us from immediately reacting to something that stopped us.]  
	  
Carry out landmark-going:  
	if ready to landmark-go begin; 
	now we-are-landmark-going is true;
	while location is not noun and we-are-landmark-going is true begin;
		let aim be the best route from the location to noun, using doors; 
		let target be the room aim from location;  
		if aim is not a direction or target is not a room begin;
			say "You can't seem to progress any farther ([aim]).";
			stop; 
		end if;  
    		try silently going aim; 
		if location is not target begin; 
			clean up landmark-go;
			stop;
		otherwise;
			add location to travelogue;
		end if;
		follow the turn sequence rules; [ Why? well, for Progue to move. ]
	end while;  
	clean up landmark-go;
	end if. 


Section - Swimming

 Swimming in is an action applying to one visible thing. Understand "swim in [something]" or "wade in [something]" as swimming in.  
 
Carry out swimming in: say "You don't see a good place to swim here."

Vague swimming is an action applying to nothing. Understand "swim" or "go swimming" as vague swimming.

Carry out vague swimming: say "You don't see a good place to swim here."   
 
Section - Digging

[ This is something people often try, so we implement it. It's also used in the Rebelworld segment. ]

Digging is an action applying to nothing. Understand "dig" as digging. Specific digging is an action applying to one topic. Understand "dig [text]" as specific digging. Check specific digging: try digging instead.  

Carry out digging:
	if location is regionally in Beachfront begin; say "You dig a little in the sand with your hands, down to a cooler layer of wetter beach, but find little of interest.";
	otherwise if location is regionally in Tiderooms or location is regionally in Marshlands; say "It's too wet to dig here."; 
	otherwise if location is Rockslide; say "It's too rocky to dig here.";
	otherwise if location is Hive Room or location is Edge of Ravine or location is Viewpoint or location is regionally in Rain Forest; say "You dig a little through the dirt, but it's not very fun, clean, or effective with just your bare hands.";
	otherwise if location is Sloping Meadow or location is Crater Pond or location is Lawn or location is Observatory Exterior; say "The grass is too hardy to dig through with just your bare hands.";  
	otherwise if location is regionally in Frozen Hell or location is Chasm Edge or location is Rise; say "Through hardened lava rock? Not likely.";  
	otherwise if location is Ledge; say "Through rock? Not likely."; 
	otherwise; say "You don't really have the proper tools or energy to dig here.";
	end if.     
 
Section - Knocking

Knocking is an action applying to one visible thing. Understand "knock [something]" or "knock on [something]" as knocking. Carry out knocking: say "Nothing happens." Vague knocking is an action applying to nothing. Understand "knock" as vague knocking. Carry out vague knocking: speak as the parser "You'll have to specify what you want to knock."  

Section - Taking Shelter From

Taking shelter from is an action applying to one topic. Understand "take shelter [text]" or "hide under [text]" as taking shelter from. Check taking shelter from: try taking shelter in general. Taking shelter in general is an action applying to nothing. Understand "take shelter" or "hide" as taking shelter in general.

Check taking shelter in general (this is the can't take shelter when no reason rule): if weather state is not raining, say "There's nothing you need to take shelter from right now." instead.

Report taking shelter in general:
	if the location contains a setpiece, say "You huddle in the leeward side of [the random setpiece in the location], managing to avoid most of the downpour.";
	otherwise say "You take shelter as best you can from the rain.".
 
Section - Help

Understand "help [someone]" or "save [someone]" as a mistake ("[if noun is Progue and psyche of Progue is emotional]You pull the blankets closer around him and make him as comfortable as you can, but otherwise there's not much else you can do[else if current episode is Water Works][as the parser]You'll have to try something specific[as normal][else]You're not sure how to help [it-them of noun][end if]."). 


Section - Mourning

Understand "cry" or "weep" or "mourn" or "grieve" or "regret" or "repent" or "pray" or "lament" as "[mourning word]". Understand "[mourning word]" or "think of/about Rume" as mourning. Mourning is an action applying to nothing. Understand "[mourning word] [text]" as a mistake ("[mourning-text]").
 
Carry out mourning: say mourning-text.

To say mourning-text:
	if current chapter is 1 begin; 
		say "You feel only the mounting dread of impending loss. The loss itself is not yet real.";    
	otherwise if current chapter <= 3; 
		say "[one of][missRumelots][or][stopping]"; 
		if the player's command includes "cry" or the player's command includes "weep", say "Tears fill your eyes and then trickle down your cheek, slow, wet. ";      
		if the player's command includes "think" or the player's command includes "mourn" or the player's command includes "grieve", say "You sink to your knees and clutch yourself tightly as the pain of your loss rolls through you. ";
		say "Dread finality fills you, tinged with red regret, and you know your loss all over again. Finally, you recover yourself. Rume is gone, and you must move on.";  
	otherwise;
		say "You remember Rume, but the memory is only a dull ache that your consciousness will not, for the moment, allow you to prod."; 
	end if. To say missRumelots: miss Rume a lot.
	 
Section - Shaking

Understand "shake [something]" as shaking. Shaking is an action applying to one thing.  

Carry out shaking: try pushing noun instead.

Section - Tasting
  
[ We make no distinction between eat, drink, and taste, and as tasting does not require the object to be held, we route them all into that action.]

Understand the command "eat" as something new. Understand the command "drink" as something new. Understand "eat [something]" or "drink [something]" as tasting.      Understand the command "lick" as "taste". 


  

Section - Extended Waiting

[ Two forms of waiting which are often tried by players in a game with a day/night system-- waiting for a certain time and waiting for a certain *amount* of time. First some utility functions:]

To decide which time is the time corresponding to (moment - an interval):
	if moment is dawn, decide on 4:01 AM;
	if moment is sunrise, decide on 5:01 AM;
	if moment is morning, decide on 5:10 AM;
	if moment is midmorning, decide on 7:01 AM;
	if moment is midday, decide on 10:31 AM;
	if moment is afternoon, decide on 2:31 PM;
	if moment is evening, decide on 5:31 PM;
	if moment is sunset, decide on 7:01 PM;
	if moment is twilight, decide on 7:20 PM;
	if moment is night, decide on 8:01 PM; 
	decide on 12:01 PM. 

To decide what number is the number of minutes between (starttime - a time) and (endtime - a time):
	[ The math goes wrong if we do this too fast for some reason...]
	let startt be the hours part of starttime;
	if startt > 12, decrease startt by 12;
	now startt is startt * 60;
	if starttime is after 12:59 PM and starttime is before 12:00 AM, now startt is startt + 720;
	increase startt by the minutes part of starttime;
	let endt be the hours part of endtime;
	if endt > 12, decrease endt by 12;
	now endt is endt * 60;
	if endtime is after 12:59 PM and endtime is before 12:00 AM, now endt is endt + 720;
	increase endt by the minutes part of endtime;
	let finalt be endt - startt;
	if finalt < 0, increase finalt by 720;
	decide on finalt.

[ Map a command like "wait till sunset" to waiting for a specific amount of time.]

Understand "wait til/till/until/for [an interval]" as waiting until. Waiting until is an action applying to one interval. 

Check waiting until:
	if location is not regionally in Lacuna, say "[if location is regionally in Dreamlands]You're not sure whether time passes or not[else]There's too much at stake to just wait around right now[end if]." instead.
	
Check waiting until:
	if current interval is the interval understood, say "It's [current interval] now." instead.
	
Check waiting until:
	if the interval understood is low tide or the interval understood is high tide, say "You don't know the tides here well enough to be sure when that might be, but you can try waiting for a certain number of hours, or until a certain time of day." instead.

Carry out waiting until:
	let target time be the time corresponding to the interval understood;
	try waiting for ( 12:01 AM + the number of minutes between the time of day and target time minutes - 1 minute ) instead.
	
[ Now understand waiting for a specific amount of time. Because of the way episodes are triggered, we have to be careful not to skip over things that should be happening at certain times.]

Understand "wait for [a time period]" or "wait [a time period]" as waiting for. Waiting for is an action applying to one time.

Check waiting for:
	if location is not regionally in Lacuna, say "[if location is regionally in Dreamlands]You're not sure whether time passes or not[else]There's too much at stake to just wait around right now[end if]." instead.

Carry out waiting for: 
	if the heavens are being debugged, say "**waiting for [the time understood]**";
	if the time understood > 8 hours, say "You can't just wait around for that long." instead;
	if the time understood < 5 minutes, speak as the parser "In the future, to wait for just a few minutes you can simply type WAIT." instead;
	if current interval is night, say "If you try to wait that long, you're likely to fall asleep. Better find a good spot for that." instead; 
	if an attentive other person is enclosed by location, say "That would be rude to do while you're in the middle of this discussion." instead;
	if an episode is playing, say "You find you are too keyed up just now to wait around." instead;	
	let old-time be the time of day;
	let old-interval be current interval;
	let new-time be the time understood;
	if ambience_on is 1, say "You pace restlessly as the time passes[time-of-day-bit]."; 
	let totaltime be new-time;
	increase totaltime by the time of day;
	if the heavens are being debugged, say "**about to test 'while the time of day [the time of day] < the time of day + new-time ([new-time]) (which is [totaltime]) and an attentive other person is not enclosed by location ([if an attentive other person is not enclosed by location]yes[else]no[end if])'**";
	while the time of day < totaltime and the number of attentive people is 0 begin; 
		if the heavens are being debugged, say "**yes**";
		increase the time of day by new-time; [ This is temporary; we'll set it back and use the proper "pass x minutes" method in a moment.]
		if the heavens are being debugged, say "%[the time of day]%%[current interval]%"; 
		update interval;
		change the time of day to old-time;
		if the heavens are being debugged, say "**about to test whether current interval [current interval] > old-interval [old-interval]";
		if current interval > old-interval or ( current interval is night and current interval < old-interval ) begin; [ if the total amount of waiting time remaining switches us to a new interval, we need to change so that we're only advancing one interval's worth of time. This is because certain events may be triggered by the transition to a certain interval, so we need to give them a change to fire and potentially interrupt the waiting.]
			if the heavens are being debugged, say "**yes**";
			if old-interval is night, let tmptime be the time corresponding to dawn;
			else let tmptime be the time corresponding to the interval after old-interval;
			if the heavens are being debugged, say "**old-time: [old-time]; tmptime: [tmptime]; mins: [the number of minutes between old-time and tmptime]; old-interval: [old-interval]; current interval: [current interval]**";
			pass ( the number of minutes between old-time and tmptime ) minutes of time;
			if old-interval is night, now old-interval is dawn;
			else now old-interval is the interval after old-interval;
			if the heavens are being debugged, say "**decreasing new-time [new-time] by [the number of minutes between old-time and tmptime] minutes --> ";
			decrease new-time by ( the number of minutes between old-time and tmptime ) minutes;
			if the heavens are being debugged, say "[new-time] (-3 mins)**";
			now old-time is the time of day;
		else;
			if the heavens are being debugged, say "**no**";
			decrease new-time by ( the number of minutes between the time of day and totaltime ) minutes;			
			pass ( the number of minutes between the time of day and totaltime ) minutes of time;		
		end if; 
		decrease new-time by 3 minutes;	[ to account for the time that will pass when we follow the turn sequence rules.]
		if the heavens are being debugged, say "**following turn sequence**";
		follow the turn sequence rules;		
		now totaltime is new-time;
		increase totaltime by the time of day;		
		if the heavens are being debugged, say "**about to test 'while the time of day [the time of day] < the time of day + new-time ([new-time]) (which is [totaltime])'**";
	end while;
	if ambience_on is 1, try looking.


Section - Sleeping

A room has some text called the sleep message. The sleep message of a room is usually "".

A person can be either asleep or awake. A person is usually awake. Yourself is awake.          

Yourself has a number called sleep debt. The sleep debt of yourself is 0. 

Every turn when yourself is awake and night and player is regionally in Lacuna and the sleep debt of yourself <= 7 (this is the growing tired rule): 
	if a random chance of 1 in 10 succeeds begin;
		add potential messages from the Table of Sleepy Messages;
		increase the sleep debt of yourself by 1;  
	end if. 
	
Every turn when yourself is awake and night and player is regionally in Lacuna and the sleep debt of yourself > 7 (this is the growing really tired rule): 
	if a random chance of 1 in 8 succeeds begin; 
		add potential messages from the Table of Really Sleepy Messages;
		increase the sleep debt of yourself by 1;
	end if.   
   
Table of Sleepy Messages
freq		start time	end time	text	table		trigger	flag	
guaranteed	--	--	"You stifle a yawn[one of] and rub your eyes... you're getting tired[or]. You're starting to feel pretty tired[in random order]."         
   
Table of Really Sleepy Messages
freq		start time	end time	text	table		trigger	flag	 
guaranteed		--	--	"You blink away haze from your eyes blearily. You aren't sure how much longer you can stay awake."
guaranteed		--	--	"You feel dead on your feet. You really need to get some sleep."
guaranteed		--	--	"You are dead tired. Better find some place to rest."    

The block sleeping rule is not listed in any rulebook. The block waking up rule is not listed in any rulebook. [ Override Inform's normal behavior.]

Sleeptime is a number that varies. Old time factor is a number that varies. Wakeup time is a time that varies. Wakeup time is 5:20 AM.

Check sleeping when location is regionally in Lacuna and it is after 5:00 AM and it is before 7:00 PM (this is the napping rule):
	if already-napped is true:
		say "You can only take so many naps in one day, you know. Might as well make it to sunset." instead;
	otherwise if evening:  
		say "It's close to sunset; you might as well stay up at least till then." instead; 
	otherwise if an episode is playing:
		say "You lay your head down and try to shut your eyes, but you seem to be too keyed up for sleep just now; thoughts and images race through your mind. Finally you stand again, resigned to wakefulness for now." instead;  
	otherwise if Epilogue is happening:
		say "You can't. Not now." instead;
	otherwise: 
		now already-napped is true;  
		if the sleep message of location is not "", say sleep message of location; 
		otherwise say "Yawning, you lie down and settle in for a good nap.";   
		print a section break;
		let old_ambience be ambience_on;
		now ambience_on is 0;
		try waiting for two hours;
		now ambience_on is old_ambience; 
		be more bored with "taking a nap";
		say "[if good place to dream]You drowse lazily, half-aware on occasion of your surroundings, but also half-aware of something else, faint ticklings of premonition or urgent murmurs you can't quite catch, seeping up from some fuller, deeper sleep.[paragraph break][end if]You awaken a few hours later, ";
		if it is after 6:00 PM, say "still feeling sleepy";
		else say "feeling refreshed";
		say ".";
		try looking instead.
	
 already-napped is a truth state that varies. 

Dreams is a thing.
 
Carry out sleeping:  
	let xmins be 0;   
	now wakeup time is a random number from -50 to 20 minutes after 5:00 AM; 
	if the hours part of the time of day < 12, now xmins is ( 60 * -1 * the hours part of time of day ) - 60;  
	otherwise now xmins is ( 23 - the hours part of the time of day ) * 60;
	now xmins is xmins + ( 60 - the minutes part of the time of day ) ;
	now xmins is xmins + ( the hours part of wakeup time * 60 ) ;
	now xmins is xmins + the minutes part of wakeup time;	  
	now sleeptime is xmins;  
	if location encloses a nook (called platform) and player is not enclosed by platform, try entering platform;
	if the sleep message of location is not "", say sleep message of location;
	otherwise say "Yawning, you kick off your shoes and settle in for a good rest."; 
 	if dreams are being debugged, say "// Dreams: time now: [time of day]; sleeptime [sleeptime] minutes, wakeup time: [wakeup time]."; 
	now old time factor is time factor; 
	now time factor is 0;  [ stop time ]
	now the player is asleep.       
 	 
Check waking up (this is the can't wake up if already awake rule): if the player is awake, say "But you're already awake." instead. [ See also the special rules in Lacuna-Dreams that prevent waking up from a dream early.]      
   
pseudo-dream is a number that varies. pseudo-dream is 0.  
 
Carry out waking up: wake up now.      
  
To wake up now:  
	if yourself is awake begin; 
		if dreams are being debugged, say "// Dreams: wake up now: skipping since yourself already awake.";
	otherwise;
		if dreams are being debugged, say "// Dreams: wake up now.";
		if pseudo-dream is 0 begin; [ normally time passes after a dream; if this variable is larger than 0, we don't want it to. ]
			now time factor is sleeptime;  [ this ensures we only have to follow the turn sequence rules once. ] 
			if dreams are being debugged, say "// Dreams: setting time factor to sleeptime ([sleeptime]).";
			follow the turn sequence rules;    
			if dreams are being debugged, say "// Dreams: setting time factor to old time factor ([old time factor]).";
			now time factor is old time factor;  [ restart time ]	
			now the sleep debt of yourself is 0; 
			now wakeup time is 5:00 AM;  
			now already-napped is false;
			if dreams are being debugged, say "// Dreams: advanced time to [time of day].";    
		end if;    
		update interval;
		now yourself is awake; 
	end if.
	       
	  
The list of remembered stuff is a list of objects that varies.    
  
Every thing has some text called dream-text. The dream-text of a thing is usually "".  
 
Every turn when location is regionally in Lacuna and a random chance of 1 in 7 succeeds (this is the brain makes note of memorable things rule):	
	if noun is a thing and noun is enclosed by location begin;  
		if noun is not a person, add noun to the list of remembered stuff, if absent; 
	otherwise; 
		let macguffin be a random other thing enclosed by location;
		if macguffin is a thing begin;
			if macguffin is part of something (called mother), now macguffin is mother; 
			if macguffin is a thing, add macguffin to the list of remembered stuff, if absent;    
		end if; 
	end if;
	let num be number of entries of list of remembered stuff;   
	if num > 25, truncate list of remembered stuff to the last 10 entries;
	let num be number of entries of list of remembered stuff;	  
	if dreams are being debugged and num > 0, say "// Dreams: adding [entry num of list of remembered stuff] to list of remembered stuff.".    
 
The list of convo stuff is a list of objects that varies. [ Understand "lcs" as lcsing. Lcsing is an action out of world applying to nothing. Carry out lcsing: say "[list of convo stuff]". ]

[ Noticing referencable things rule is in Lacuna-Progue.]
	 
Understand "yawn" as a mistake ("You yawn widely, starting to feel the day catching up with you. Maybe you should find a spot to get some [d]sleep[x]."). 

Understand "nap" or "take nap" or "take a nap" as sleeping.


Section - Eyes

Eye opening is an action applying to nothing. Understand "open eyes" or "open my eyes" as eye opening.    

Carry out eye opening: say "Your eyes are already open." [ This command can be synonymous with "wake up" but it mostly exists merely as a logical counterpart to "close eyes," which is used to leave Treeworld. ]

Eye closing is an action applying to nothing. Understand "close eyes" or "close my eyes" or "close the eyes" or "blink" as eye closing.

Check eye closing:
	try sleeping instead. [ See also Lacuna-Lacuna for dealing with other worlds.]

Section - Inventory

The print standard inventory rule is not listed in any rulebook.  
 
Carry out taking inventory: 
	now everything is unmarked for listing; [ Don't ask. Please don't.]
	let pobj be yourself; 
	if player is DrQuick, now pobj is DrQuick;
	if player is Lacunite-Follower, now pobj is Lacunite-Follower; 
	if the number of things enclosed by pobj is 0, say "You are naked." instead;  
	say "You are wearing ";    
	now all things enclosed by pobj are unmarked for listing; 
	now all things worn by pobj are marked for listing;
	if no things are marked for listing:
		say "nothing"; 
	otherwise:  
		list the contents of pobj, as a sentence, listing marked items only;  
	now all things carried by pobj are marked for listing; 
	now all things worn by pobj are unmarked for listing;  
	now pobj is unmarked for listing;
	if at least one thing is marked for listing:
		if Progue is carried:
			say ", and carry Progue on your shoulders"; 
		else:
			say ", and hold "; 
			list the contents of pobj, giving inventory information, as a sentence, including contents, listing marked items only; 
			say " in your hand"; 
	if ( tree-password is set or rebel-password is set ) and location is regionally in Lacuna:
		say ". You are also carrying around ";
		if tree-password is set and rebel-password is set, say "two passwords";
		else say "a password";
		say " in your head: "; 
		if tree-password is set, say "['][tree-password]";
		if tree-password is set and rebel-password is set, say "['] and ";
		if rebel-password is set, say "['][rebel-password]";
		say ".['][line break]";
	else:
		say ".".    

Section - Examining Yourself

Conds is a list of indexed texts that varies.  

Check examining yourself:
	truncate conds to 0 entries;
	let legmsg be indexed text; let legmsg be "Your leg still pains you enough that you won't be doing any jumping or climbing";
	let rainmsg be indexed text; let rainmsg be "You are soaking wet";
	let tire1msg be indexed text; let tire1msg be "You're exhausted";
	let tire2msg be indexed text; let tire2msg be "You could really use a good night's sleep";
	let rumemsg be indexed text; let rumemsg be "The pain of loss is still sharp in your chest";
	let nakedmsg be indexed text; let nakedmsg be "You're naked";  
	let lovemsg be indexed text; let lovemsg be "Something inside you is giddy and flush with excitement";
	let dreammsg be indexed text; let dreammsg be "You're still rubbing the sleep from your eyes"; 
	[imperiled] 
	if the player is wounded, add legmsg to conds;  
	if raining and location is outdoorsy, add rainmsg to conds;
	if sleep debt of yourself > 10 begin; add tire1msg to conds;
	otherwise if sleep debt of yourself > 5; add tire2msg to conds;
	end if; 
	if current chapter <= 3, add rumemsg to conds;
	if homemade outfit is not worn, add nakedmsg to conds;
	if romance of Progue >= 3, add lovemsg to conds; 
	if the number of entries in list of remembered stuff <= 1, add dreammsg to conds;
	let endctr be number of entries in conds;
	repeat with ctr running from 2 to endctr begin;
		now entry ctr of conds is "[entry ctr of conds in lower case]";
	end repeat;  
	if the number of entries in conds is 0, say "You're not sure what to do next";
	say "[conds], but otherwise you're doing all right." instead. 
	
Instead of touching or hugging yourself, try examining yourself.

	


Part - Parser Improvements

 
Section - Numbering disambiguation choices

First before printing the name of something while asking which do you mean: if we are discussing, now disambiguation-busy is true. [ This prevents numbers from being printed before any objects like Progue we ask to describe themselves during a refusal to disambiguate.]


Section - Eliminate inappropriate noun guessing

Vague unlocking is an action applying to one thing. Understand "unlock [something]" as vague unlocking. Carry out vague unlocking: if noun is lockable, say "You don't have a key."; otherwise say "That's not something you can lock." [ Rule for supplying a missing noun when vague unlocking: if a random locked thing is visible, change the noun to a random locked visible thing.]  
 
Vague locking is an action applying to one thing. Understand "lock [something]" as vague locking. Carry out vague locking: if noun is lockable, say "You don't have a key."; otherwise say "That's not something you can lock."    

Rule for supplying a missing noun: if noun part of last-action is visible, change the noun to noun part of last-action; else speak as the parser "You must do that to something specific. Try your command again but with a noun as well.". [ last-action is defined in Drama Manager.]

Rule for supplying a missing second noun: speak as the parser "You'll need to specify what you want to do that with."   

Does the player mean entering a thing which is not enterable: it is very unlikely. 
  
Understand the command "tie" as something new. Understand "tie" as a mistake ("[as the parser]You won't need to 'tie' anything in this story.[as normal]").

[ The following lines prevent Inform from guessing inappropriately if there is only one noun in the location and the player types the verb alone, something the one-word input encourages players to do. ] 

Understand "touch" as touching. Understand "take" as taking. Understand "examine" as examining. Understand "swim" or "wade" as vague swimming. Understand "open" as opening. Understand "close" as closing. Understand "push" as pushing. Understand "pull" as pulling. Understand "eat" as tasting. Understand "drink" as tasting. Understand "taste" as tasting. Understand "read" as reading.


Section - Looking in Directions
      
Check examining a direction (called dir):  
	let rm be the room dir from location;
	if rm is a room, say "[if dir is up]Above you[otherwise if dir is down]Below you[otherwise if dir is inside]Inside[otherwise if dir is outside]Outside[otherwise]To the [dir][end if] is [if rm is visited][prose name of rm][otherwise]an unexplored area[end if]." instead;
	otherwise say "Unnavigable." instead.  

Section - Auto Get Off
 
Check going somewhere (this is the auto get off rule):  
	if player is in something (called the encloser) and the encloser is not a room:
		auto get off encloser;
	else if player is on something (called the encloser) and the encloser is not a room:  
		auto get off encloser.   

To auto get off (encloser - a thing):    
	say "(first leaving [the encloser])[line break]"; 
	silently try exiting.    	 
	 
Does the player mean getting off something not onable: it is very unlikely.

Definition: a thing is onable: 
	if it is a room, no;
	if it supports the player or it contains the player, yes;
	no. 
 



Section - Recognizing Unimplemented Scenery
   
A stuff is a kind of thing. Stuff is always undescribed, fixed in place, and privately-named. The printed name of stuff is usually "scenery". Instead of doing anything to stuff: say "It's just part of the scenery.". Does the player mean doing anything to stuff: it is very unlikely.


Section - Disable "All"


After reading a command (this is the can't use all rule):
	if the player's command includes "all" and final release mode is true begin;
		speak as the parser "For various reasons, use of ALL is not allowed in Blue Lacuna. Please deal with objects one at a time instead.";
		reject the player's command;
	end if. 

Section - Clarifying the Parser's Choices Silently

Rule for clarifying the parser's choice of something: do nothing. [ This tends to produce a confusing and obvious message most of the time; if we need to override with a more specific rule, we can. ]  


Section - Custom Library Error Messages



[ Librarydebug-toggling is an action out of world applying to nothing. Understand "libdebug" as librarydebug-toggling. Carry out librarydebug-toggling: if library message debug is on, change library message debug to off; otherwise change library message debug to on.]       

To say emptylineinit: if the number of initapped things enclosed by location > 0 and final release mode is false, say "[paragraph break][the list of initapped things enclosed by location]". To say emptylineperson: if a described other person is enclosed by location and final release mode is false, say "[paragraph break][a random other person enclosed by the location]".      
 
Table of custom library messages (continued)
Message Id		Message Text
LibMsg <undo succeeded>		"Okay, I've taken back your last move.[as normal][line break]"
LibMsg <empty line>			"[unless location is a flash-room][lookfudge][as normal][bold type][location][roman type][line break][description of location][emptylineinit][the initial appearance of a random initapped thing enclosed by location][emptylineperson][initial appearance of a random other uncarried person enclosed by location][end unless]" [ Hack of the year award.]  
LibMsg <cannot take yourself>	"[as the parser]Sorry, that doesn't make sense to me.[as normal][actfast]"
LibMsg <block burning>	"[if location is regionally in Homeworld]You don't have the heart to burn [that-those of noun][else]There's no fire here to burn [that-those of noun] with[end if].[line break]"
LibMsg <cannot take scenery>	"[as the parser]I'm interpreting that as an attempt to take part of the scenery, which either doesn't make sense or isn't an action I know how to process-- please try rephrasing![as normal][actfast]"
LibMsg <block giving>	"Better keep it, for now.[line break]"
LibMsg <cannot give to yourself>		"You're already holding [that-those of noun].[as normal][line break]"           
LibMsg <cannot enter something already entered>		"I believe you're already on [the main object].[as normal][actfast]"   
LibMsg <report player touching things>	"You feel nothing unexpected.[line break]"  
LibMsg <block swearing obscenely>	"I'm sorry if you're feeling frustrated. You might try typing HELP for an introduction to the commands, or SAVE to record your progress and come back later.[as normal][actfast]"
LibMsg <block climbing>		"You're not sure there's anything to be gained by climbing on [that-those of noun].[as normal][actfast]"     
LibMsg <block jumping>		"Not here.[line break]"
LibMsg <block waving hands>	"You wave, but you're unsure if anyone sees you.[as normal][line break]"   
LibMsg <block attacking>	"[if the main object is a person]Think carefully before you take such a rash action[otherwise]You doubt violence will change much of anything[end if].[line break]"  
LibMsg <block pushing in directions>		"[as the parser]You seem to be trying to push something in a direction, but that's probably trying to be more specific than the story is capable of understanding. Try TAKE to pick up objects, or just mention the object in conversation if you want to show it to someone.[as normal][actfast]"  
LibMsg <cannot pull people>		"Sorry, that doesn't make sense to me. Try again?[as normal][actfast]"
LibMsg <cannot turn people>		"Sorry, that doesn't make sense to me. Try again?[as normal][actfast]"  
LibMsg <cannot talk to absent person>	"[correct conv]"
LibMsg <block kissing>	"[if noun is bestial]You're a little afraid to get your lips near [it-them of noun].[otherwise]Now's not the right time for that[end if].[as normal][actfast]"
LibMsg <report player touching other people>	"[The noun] sh[ies] away from your touch.[line break]" 
LibMsg <block singing>	"[if location is Echo Chamber]The song bounces and echoes around the cave, distorted and twisted in weird ways, some syllables seeming to arrive later and some earlier than the order in which you sang them.[else if player is yourself]You sing quietly, an old song you learned as a child, forgotten for years until surfacing now.[otherwise]Nothing comes to mind.[end if][line break]"
LibMsg <block saying yes>	"[invalidresponse]"
LibMsg <block saying no>	"[invalidresponse]" 
LibMsg <block saying sorry>	"No problem.[as normal]" 
LibMsg <unknown object>	"I couldn't understand that, or the noun you used isn't nearby.[as normal][actfast]"       
LibMsg <command not understood>	"[if final release mode is false]1[end if][as the parser][notsurewhatyoumeant].[as normal]"
LibMsg <number not understood>	"[if final release mode is false]2[end if][as the parser][notsurewhatyoumeant].[as normal]"  
LibMsg <verb cannot have inanimate object>	"[if location is regionally in Dreamlands]There will be time for that later.[else]That's either too far away or not something I expected you to do that to.[actfast][end if]"
LibMsg <cannot push scenery>			"You can't reach it from here.[line break][actfast]"
LibMsg <cannot pull scenery>			"You can't reach it from here.[line break][actfast]" 
LibMsg <cannot turn scenery>			"You can't reach it from here.[line break][actfast]"    
LibMsg <block tasting>	"[as the parser]Apologies, but that isn't  something the story expected you to try eating[as normal].[line break]"        
LibMsg <something more substantial needed>		"[as the parser]For the most part, exit keywords should just be typed alone to move in that direction.[as normal][actfast]"  
LibMsg <command partly understood>	"Sorry, I didn't understand the part after "  
LibMsg <block vaguely going>	"[as the parser]You can move to a new location by typing an emphasized [d]direction[x] keyword. Type LOOK to see nearby keywords again.[as normal]"
LibMsg <cannot take hidden parts>	"[as the parser]You'll have to use direction keywords to follow him from here[if final release mode is false]([the main object] in [the location of the main object])[end if][as normal]."
LibMsg <you have died>	" An End "
LibMsg <you have won>	" An End "

Understand the command "brief" as something new. Understand the command "verbose" as something new. Understand the command "superbrief" as something new. Understand "brief" or "verbose" or "superbrief" as a mistake ("Blue Lacuna uses a nonstandard system for printing room descriptions (which change anyway based on time of day, weather, and game events) so brief and superbrief modes are unfortunately not available.").      

To say invalidresponse: speak as the parser "[if a conversing person is enclosed by location]I don't think [a random conversing person enclosed by location] is looking for an answer to a yes or no question right now[otherwise]You aren't speaking with anyone right now[end if].[line break]"; now acting-fast is true.          

To say actfast: now acting-fast is true; say line break. Acting-fast is a truth state that varies. Before reading a command: now acting-fast is false. First turn sequence rule: if acting-fast is true, rule succeeds. [ This kludge prevents time from passing if the player says yes or no at an inappropriate time during conversation, thus losing their chance to say something correct.] 
 
To say lookfudge: now player-looking is true.

Definition: a thing is initapped: if it is worn, no; if it is held, no; if it is undescribed, no; if it is a person, no; if it is on something, no; if it is in something, no; if it is part of something, no; if its initial appearance is not "", yes; no.

To say trytouching: say "[as normal]"; try touching noun.


Section - Remembering

Understand "find [any seen thing]" as remembering.

Check remembering: if noun is visible, try examining noun instead.
  
[ Blue Lacuna has so many objects that it's not safe to assume the player is referring to something far-off. If they're using a word actually in the printed name of a thing, we'll hazard a guess that the thing is what they mean; otherwise print the standard "unrecognized input" message (since in that case the word the user typed may be an adjective or some other obscure word that in their mind bears little resemblance to our guess. ]
First report remembering: 
	let playerc be indexed text;
	now playerc is the player's command; 
	let candidate be indexed text;
	now candidate is printed name of noun;
	repeat with wd running from 1 to the number of words in candidate:  
		if playerc matches the regular expression "\b[word number wd in candidate]":
			say "If you mean [the noun], ";
			if noun is on-stage and noun is a room, say "the last place you saw [it-them of noun] was [if remembered spot is location]right here[otherwise][remembered spot][end if]." instead; 
			else say "you're not sure where [it-they of noun] ended up." instead;
	say "[as the parser]You used either a verb or a keyword I don't recognize, or at least not in that combination[as normal]." instead.



Section - Room Descriptions

[ This was an early system for dynamic room descriptions that ended up being almost entirely deprecated in the final version.]

Describing is an action applying to one thing.  

To process description table (tab - a table-name) with (r - a number):
	if r is 98, say ", ";
	if r is 99, say ". ";
	if r is at most 97 begin;
		choose row r in tab; 
		say "[text entry]";
	end if.	
	
To do the room description dance with (t1 - a table-name) and (t2 - a table-name):
	repeat through t1 begin;
		if time entry is current interval begin;
			if there is a s1 entry, process description table t2 with s1 entry;
			if there is a s2 entry, process description table t2 with s2 entry;
			if there is a s3 entry, process description table t2 with s3 entry;
			if there is a s4 entry, process description table t2 with s4 entry;
			if there is a s5 entry, process description table t2 with s5 entry;
			if there is a s6 entry, process description table t2 with s6 entry;
			if there is a s7 entry, process description table t2 with s7 entry;
			if there is a s8 entry, process description table t2 with s8 entry;
			if there is a s9 entry, process description table t2 with s9 entry;
			if there is a s10 entry, process description table t2 with s10 entry;
			stop;
		end if;
	end repeat.	

Table of Explanatory Structure
time		s1	s2	s3	s4	s5	s6	s7	s8	s9	s10
an interval	a number		a number		a number		a number		a number		a number		a number		a number		a number		a number




Section - Fallback Actions

Understand the command "search" as something new. Understand "search" or "search [text]" as a mistake ("[as the parser]You won't need to use the verb SEARCH in Blue Lacuna; type HELP to find a list of useful verbs[as normal]."). Understand the command "look under" as something new. Understand the command "look inside" as something new.

After reading a command (this is the replace look under and related search commands with examine rule): if the player's command includes "look under" or the player's command includes "look in" or the player's command includes "look inside" or the player's command includes "look through" or the player's command includes "look behind", replace the matched text with "examine".

After reading a command (this is the left/right hack rule): [ This unfortunate hack is necessary to work around a mysterious bug that appeared at one point, preventing the words "left" or "right" on their own from being understood by the parser.]
	if the player's command includes "left", replace the matched text with "hleft";  
	if the player's command includes "right", replace the matched text with "hright".  

Check rubbing something: try touching the noun instead. Check squeezing a person: try touching the noun instead. Understand the command "clean" as something new. Understand the command "dust" as something new.   
   
Check cutting something: try attacking the noun instead.  
 
Section - Acknowledging out-of-scope objects

Check remembering yourself: try examining player instead.

disambiguation_flag is a truth state that varies.

[Rule for asking which do you mean while remembering (this is the don't disambiguate while remembering rule):
	say "[as the parser]You used either a verb or a keyword I don't recognize, or at least not in that combination[as normal].";
	now disambiguation_flag is true.]






Part - Lacuna Ambience 

Chapter - Ambient Messages

ambience_on is a number that varies. ambience_on is 1.

A room has a table-name called the ambience table. 

A region has a table-name called the ambience table. The ambience table of a region is usually the Table of No ambience. A room has a table-name called the ambience table. The ambience table of a room is usually the Table of No ambience.  

Table of No ambience
value
0

Table of Temp Messages
freq		text		table			trigger	flag
a frequency	text		a table-name	a thing	a number
with 20 blank rows

Table of Potential Messages
freq		text		table			trigger	flag
a frequency	text		a table-name	a thing	a number
with 20 blank rows

The frequency is a kind of value. The plural of frequency is frequencies. The frequencies are guaranteed, frequent, common, uncommon, rare, superrare, uberrare, and singular.  
    
The ACO [ ambience control object] is a thing. Understand "ambience" as the ACO.   
    
To add potential messages from (msg - a table-name), only one:
	if ambience_on is 0, stop;
	if ACO is being debugged, say "// Ambience: add potential messages from [msg][if only one], only one[end if].";
	repeat through msg begin;
		if there is a start time entry begin; 
			if high tide begin;
				if start time entry is high tide, change flag entry to 1;
			otherwise if falling uptide;
				if start time entry is falling uptide, change flag entry to 1;
			otherwise if falling downtide;
				if start time entry is falling downtide, change flag entry to 1; 
			otherwise if low tide;
				if start time entry is low tide, change flag entry to 1;
			otherwise if rising downtide;
				if start time entry is rising downtide, change flag entry to 1;
			otherwise if rising uptide;
				if start time entry is rising uptide, change flag entry to 1;	 
			end if;						
			if there is an end time entry begin;
				if start time entry <= current interval and current interval <= end time entry begin; change flag entry to 1;
				otherwise if start time entry is current interval; change flag entry to 1;
				end if;  
			end if;
		otherwise; 
			change flag entry to 1;
		end if; 
	end repeat;  
	if ACO is being debugged, say "// Ambience: [if there is a flag of 1 in msg]qualifying message(s) found.[otherwise]no qualifying message found.";
	sort msg in random order; 
	repeat with Nvar running from 1 to the number of rows in msg begin;
		if there is a flag in row Nvar of msg and flag in row Nvar of msg is 1 and the number of blank rows in Table of Potential Messages > 0 begin;
			choose a blank row in Table of Potential Messages;
			change freq entry to the freq in row Nvar of msg;
			if there is a text in row Nvar of msg, change text entry to the text in row Nvar of msg; 
			if there is a table in row Nvar of msg, change table entry to the table in row Nvar of msg; 
			if there is a trigger in row Nvar of msg, change trigger entry to the trigger in row Nvar of msg;  
			if only one, let Nvar be the number of rows in msg; 
		end if;        
	end repeat;         
	repeat through msg begin;      
		change flag entry to 0;   
	end repeat.	     	   

To fire one off by frequency from (msg - a table-name), definitely selecting and/or no extra spacing:  
	[ if ambience_on is 0, stop;]
	if ACO is being debugged, say "// Ambience: fire one off by frequency from [msg][if definitely selecting], definitely selecting[end if].";	 
	if the number of filled rows in the Table of Temp Messages is 0 begin; 
		repeat with N running from 1 to the number of filled rows in msg begin; 
			choose a blank row in Table of Temp Messages;
			change freq entry to the freq in row N of msg;
			if there is a text in row N of msg, change text entry to the text in row N of msg;
			if there is a table in row N of msg, change table entry to the table in row N of msg; 
			if there is a trigger in row N of msg, change trigger entry to the trigger in row N of msg;
		end repeat;
	end if; 
	repeat through Table of Temp Messages in freq order begin;
		if freq entry is guaranteed begin;
			change flag entry to 1;
		otherwise if freq entry is frequent;
			if a random chance of 1 in 2 succeeds, change flag entry to 1;
		otherwise if freq entry is common;
			if a random chance of 1 in 4 succeeds, change flag entry to 1;
		otherwise if freq entry is uncommon;
			if a random chance of 1 in 8 succeeds, change flag entry to 1;
		otherwise if freq entry is rare;
			if a random chance of 1 in 16 succeeds, change flag entry to 1;
		otherwise if freq entry is superrare;
			if a random chance of 1 in 32 succeeds, change flag entry to 1;
		otherwise if freq entry is uberrare;
			if a random chance of 1 in 64 succeeds, change flag entry to 1;
		otherwise if freq entry is singular;
			if a random chance of 1 in 128 succeeds, change flag entry to 1;
		end if;
	end repeat;
	if ACO is being debugged, say "// Ambience: [if there is a flag of 1 in Table of Temp Messages]message found.[otherwise]no message selected.";
	let success be 0; 
	if there is a flag of 1 in Table of Temp Messages begin;
		choose row with a flag of 1 in Table of Temp Messages;
		if there is a text entry begin; now success is 1; say "[text entry][unless no extra spacing][paragraph break][end if]"; end if;
		if there is a table entry begin; let xz be table entry; repeat through Table of Temp Messages begin; blank out the whole row; end repeat; now success is 1; fire one off by frequency from xz, definitely selecting; end if; 
		if there is a trigger entry begin; now success is 1; move the trigger entry to location; change trigger entry to seen; end if;
		repeat through Table of Potential Messages begin;
			blank out the whole row;
		end repeat;
		repeat through Table of Temp Messages begin;
			blank out the whole row;
		end repeat; 
	end if;
	if definitely selecting and success is 0 begin;
		if ACO is being debugged, say "// Ambience: definitely selecting, so trying again.";	
		repeat through Table of Temp Messages begin;
			if freq entry is not guaranteed, change freq entry to the frequency before freq entry;
		end repeat;
		fire one off by frequency from Table of Temp Messages, definitely selecting;
	end if.
	
To decide whether okay to be ambient: 
	if the player is regionally in Dreamlands, decide no;
	if location is regionally in Treeworld or location is regionally in Rebelworld, decide yes;
	if yourself is asleep, decide no;  
	if dawn or sunrise or sunset or twilight or last interval is not current interval, decide yes;  
	if something dramatic is up, decide no;	
	if just had excitement, decide no; [ something interesting just happened]
	if we are going or we are landmark-going, decide no;
	if an [ attentive] nonbestial other person is enclosed by the location, decide no;
	if conversation fuse is 0, decide no;	
	decide yes.  
	 
The ambient messages rule is listed last in the every turn rules. Every turn when ambience_on is 1 (this is the ambient messages rule):
	if okay to be ambient begin;    
		if ACO is being debugged, say "// Ambience: running the ambient messages rule (because player is awake and we are not going/examining and no one is nearby).";  
		if ( we are examining or we are examining by name ) and ( a random chance of 1 in 2 succeeds or location is regionally in Rebelworld ) and ( last interval is current interval ) , continue the action;     [ Make it less likely for ambience to distract people in the middle of something. ]
		repeat with area running through region-relevant regions begin;  
			if a random chance of 1 in 2 succeeds and last interval is current interval, add potential messages from the ambience table of area; 
		end repeat; 
		if the ambience table of location is not the Table of No ambience and a random chance of 1 in 2 succeeds and last interval is current interval, add potential messages from the ambience table of location;
		if location is outdoorsy and location is regionally in Lacuna and  location is not Jumble, consider time of day ambience;
		fire one off by frequency from Table of Potential Messages;
	otherwise; 
		if ACO is being debugged, say "// Ambience: ambient messages rule NOT running (because [if player is not awake]player is not awake[end if] / [if we are going]we are going[end if] / [if something dramatic is up]nothing dramatic is up is false[end if] ).";
	end if. 

Definition: a region (called area) is region-relevant if the player is regionally in area and the ambience table of area is not the Table of No Ambience.

The flushing ambient messages rule is listed after the ambient messages rule in the every turn rules. Every turn when we are not landmark-going and ambience_on is 1 (this is the flushing ambient messages rule):
	if ACO is being debugged, say "// Ambience: running the flushing ambient messages rule.";
	repeat through Table of Potential Messages begin;
		blank out the whole row; 
	end repeat;
	repeat through Table of Temp Messages begin;
		blank out the whole row;
	end repeat.    
 


Chapter - Day & Night



The fast time rule is listed instead of the advance time rule in the turn sequence rulebook.   

The tide counter is a number that varies. The tide counter is 200. 

The time factor is a number that varies. The time factor is 3.

This is the fast time rule:    
	increase the turn count by 1;
	change the time of day to time factor minutes after the time of day;
	change the tide counter to the tide counter + time factor;
	if the tide counter is greater than 1100, change the tide counter to the tide counter minus 1100.  



To decide whether moonrise: if the tide counter > 0 and the tide counter < 15 then decide yes; decide no.   

Every turn when we are not landmark-going and location is regionally in Lacuna (this is the adjust the tides rule): 
	if tidein begin; 
		if location is Inside-Manta begin;
			say "It looks like the tide is coming in, and you don't want to be stuck in here until it goes back out. You turn the wheel to pull yourself back up to the beach, and clamber out onto the sand.";
			try going outside;
		end if;
	end if.   

To decide whether moonset: if the tide counter >= 544 and the tide counter < 559 then decide yes; decide no.


To decide whether tideout: if tide counter >= 366 and tide counter < 915, decide yes; decide no.  

To decide whether tidein: if tideout then decide no; decide yes.

To decide whether high tide: if the tide counter >= 0 and the tide counter < 183 then decide yes; decide no.

To decide whether falling uptide: if the tide counter >= 183 and the tide counter < 366 then decide yes; decide no. 

To decide whether falling downtide: if the tide counter >= 366 and the tide counter < 559 then decide yes; decide no.

To decide whether low tide: if the tide counter >= 559 and the tide counter < 732 then decide yes; decide no.

To decide whether rising downtide: if the tide counter >= 732 and the tide counter < 915 then decide yes; decide no.   

To decide whether rising uptide: if the tide counter >= 915 and the tide counter <= 1100 then decide yes; decide no.


To decide whether sunup: if it is after 5:00 AM and it is before 7:16 PM, decide yes; decide no. To decide whether sundown: if it is after 6:59 PM and it is before 5:01 AM, decide yes; decide no.

To decide whether dawn: if it is before 5:01 AM then decide yes; decide no.

To decide whether sunrise: if it is after 5:00 AM and it is before 5:06 AM then decide yes; decide no. 

To decide whether morning: if it is after 5:05 AM and it is before 7:01 AM then decide yes; decide no.  

To decide whether midmorning: if it is after 7:00 AM and it is before 10:31 AM then decide yes; decide no.  

To decide whether midday: if it is after 10:30 AM and it is before 2:31 PM then decide yes; decide no.  

To decide whether afternoon: if it is after 2:30 PM and it is before 5:31 PM then decide yes; decide no.

To decide whether evening: if it is after 5:30 PM and it is before 7:01 PM then decide yes; decide no.

To decide whether sunset: if it is after 7:00 PM and it is before 7:16 PM then decide yes; decide no.

To decide whether twilight: if it is after 7:15 PM and it is before 8:01 PM then decide yes; decide no. 

To decide whether night: if it is after 8:00 PM then decide yes; decide no.

To decide whether day: if night, decide no; decide yes.

To decide whether moonup: if the moon is on-stage, decide yes; decide no. To decide whether moondown: if the moon is on-stage, decide no; decide yes.

To say tidestatus: say "[if high tide]high[otherwise if rising uptide]ris. up[otherwise if rising downtide]ris. dwn[otherwise if low tide]low[otherwise if falling downtide]fall. dwn[otherwise if falling uptide]fall. up[end if]".

Check examining when night and location is indoorsy and noun is not a scrawl and noun is not a heavenly body and noun is not an echo-keyword (this is the most things indoors can't be examined at night rule): say "It's too dark to make out any details." instead.



Last interval is an interval that varies.

To consider time of day ambience, definitely selecting:
	if ( dawn or sunrise or sunset or moonrise or moonset or twilight or night or last interval is not current interval ) or definitely selecting or a random chance of 1 in 4 succeeds begin;
	if current interval is dawn begin;
		if it is before 4:10 AM begin; add potential messages from the Table of Dawn1 ambience;
		otherwise if it is before 4:20 AM; add potential messages from the Table of Dawn2 ambience;
		otherwise if it is before 4:30 AM; add potential messages from the Table of Dawn3 ambience;
		otherwise if it is before 4:40 AM; add potential messages from the Table of Dawn4 ambience;
		otherwise if it is before 4:50 AM; add potential messages from the Table of Dawn5 ambience;
		otherwise if it is before 5:00 AM; add potential messages from the Table of Dawn6 ambience;
		end if;
	otherwise if current interval is sunrise;
		add potential messages from the Table of Sunrise ambience;
	otherwise if current interval is morning;
		if it is before 6:00 AM begin; add potential messages from the Table of Morning1 ambience;
		otherwise; add potential messages from the Table of Morning2 ambience;
		end if;
	otherwise if current interval is midmorning;
		if it is before 8:00 AM begin; add potential messages from the Table of Midmorning1 ambience; 
		otherwise if it is before 9:00 AM; add potential messages from the Table of Midmorning2 ambience;
		otherwise; add potential messages from the Table of Midmorning3 ambience;
		end if;
	otherwise if current interval is midday;
		if it is before 12:30 PM begin; add potential messages from the Table of Midday1 ambience;
		otherwise if it is before 1:00 PM; add potential messages from the Table of Midday2 ambience;
		otherwise; add potential messages from the Table of Midday3 ambience;
		end if;
	otherwise if current interval is afternoon;	 	
		if it is before 4:00 PM begin; add potential messages from the Table of Afternoon1 ambience;
		otherwise; add potential messages from the Table of Afternoon2 ambience; 
		end if;
	otherwise if current interval is evening;
		if it is before 6:15 PM begin; add potential messages from the Table of Evening1 ambience;
		otherwise; add potential messages from the Table of Evening2 ambience;
		end if; 
	otherwise if current interval is sunset; 
		add potential messages from the Table of Sunset ambience;
	otherwise if current interval is twilight;
		if it is before 7:10 PM begin; add potential messages from the Table of Twilight1 ambience;
		otherwise if it is before 7:20 PM; add potential messages from the Table of Twilight2 ambience;
		otherwise if it is before 7:30 PM; add potential messages from the Table of Twilight3 ambience;
		otherwise if it is before 7:40 PM; add potential messages from the Table of Twilight4 ambience;
		otherwise if it is before 7:50 PM; add potential messages from the Table of Twilight5 ambience;
		otherwise if it is before 8:00 PM; add potential messages from the Table of Twilight6 ambience;  
		end if;    
	otherwise;
		if night_notification_trig is 0 or definitely selecting begin; add potential messages from the Table of Night ambience; now night_notification_trig is 1; end if; 
	end if; 
	end if.  

night_notification_trig is a number that varies. Every turn when not night and night_notification_trig is 1: now night_notification_trig is 0. 
	
The last Every turn rule: if current interval is not last interval begin; if ACO is being debugged, say "// Ambience: new interval."; now last interval is current interval; end if.  



Table of Dawn1 ambience
freq		text	table		trigger	flag
frequent		"[one of]The sky to the east is beginning, almost imperceptibly, to lighten[or]You're not quite sure if you're imagining it, but a dull grey fuzz lines the horizon to the east[or]The first hints of light are coloring the horizon to the east[in random order]."

Table of Dawn2 ambience
freq		text	table		trigger	flag
frequent		"[one of]A faint grey light steals over the island, slowly bringing the indistinct darkness into focus[or]Grey light touches the eastern horizon, slowly snuffing the stars out one by one[or]The horizon glows with a dim grey light[in random order]."

Table of Dawn3 ambience
freq		text	table		trigger	flag
frequent		"[one of]The eastern sky is a wash of white just touched with color, casting a shadowless light over everything[or]The galaxy fades above you as the sky slowly turns from black to grey to pink-scrubbed white[or]A dull grey glow lights up your surroundings as the horizon to the east continue to brighten[in random order]."

Table of Dawn4 ambience
freq		text	table		trigger	flag
frequent		"[one of]Streaks of pink and gold strengthen on the eastern horizon, brightening minute by minute[or]The last of the stars wink out as the sky above casts a shadowless light over the island[or]The horizon glows with rich shades of pink and amber, brightening towards white where it meets the ocean[in random order]."

Table of Dawn5 ambience
freq		text	table		trigger	flag
frequent		"[one of]The sky brightens more each minute[or]Scudding wisps of cloud high above glow pink and cream in the sun, which has not yet risen down here[or]Birds flock through the sky in the predawn light, preparing for the coming day[in random order]."  

Table of Dawn6 ambience
freq		text	table		trigger	flag
frequent		"[one of]The top of the mountain glows pink as the first rays of the morning sun hit it[or]The sun touches the rim of the volcano, which burns in the sudden wash of color almost as if on fire[in random order]."

Table of Sunrise ambience
freq		text	table		trigger	flag
guaranteed	"The sun rises over the [if location is Saddle or location is Atop or location is Observatory Exterior or location is Lawn or location is Viewpoint or location is Rim of Volcano or location is Ravine Floor or location is Top of Ravine][else]hidden [end if]ocean to the east." 

Table of Morning1 ambience
freq		text	table		trigger	flag
frequent		"The sun hangs over the eastern horizon, reflecting brilliantly off the waves."

Table of Morning2 ambience
freq		text	table		trigger	flag
frequent		"The sun [one of]burns through the morning mist[or]shifts through whole palettes of color[in random order] as it rises higher in the eastern sky."

Table of Midmorning1 ambience
freq		text	table		trigger	flag
guaranteed		"[one of]The sky slowly loses the colors of dawn and begins to take on the colors of day[or]The morning light gives way to the hot sharp brightness of day[in random order]."

Table of Midmorning2 ambience 
freq		text	table		trigger	flag 
frequent		"[one of]The sun angles down, casting your shadow westward[or]From halfway up the eastern sky, the sun burns down brightly[in random order]."

Table of Midmorning3 ambience
freq		text	table		trigger	flag 
frequent		"The sun [one of]burns down from high in the eastern sky[or]shines above, climbing slowly towards the zenith[in random order]."  
  
Table of Midday1 ambience
freq		text	table		trigger	flag
guaranteed	"[one of]The sun sears the sky above you, almost directly overhead[or]Noonday light beams brightly down on you[in random order]."  

Table of Midday2 ambience 
freq		text	table		trigger	flag
frequent		"[one of]Your shadow has almost disappeared as the sun shines directly above[or]Your hair and neck burn in the heat of the tropical noon[in random order]."

Table of Midday3 ambience 
freq		text	table		trigger	flag
frequent		"[one of]The hot midday sun beats down on your head[or]The sun hovers just west of the zenith, as if unsure whether it wants to start downward[in random order]."
 
Table of Afternoon1 ambience
freq		text	table		trigger	flag
frequent		"[if raining]Rain buckets down in ceaseless torrents.[otherwise if weather state is decided to rain]Quick-moving clouds gather overhead, darkening rapidly.[otherwise][one of]Sunlight angles down on you from above as the light begins to shift to the west[or]The brilliance of midday fades a little into the deeper tones of afternoon[in random order].[end if]"
 
Table of Afternoon2 ambience
freq		text	table		trigger	flag
frequent		"[if raining]Rain buckets down in ceaseless torrents.[otherwise if weather state is decided to rain]Quick-moving clouds gather overhead, darkening rapidly.[otherwise][one of]The afternoon sunlight casts a shadow pointing east[or]Lazy afternoon sunlight tilts golden through the air[in random order].[end if]" 

Table of Evening1 ambience
freq		text	table		trigger	flag
guaranteed	"[one of]Late afternoon gives way to evening as the sun sinks lower in the western sky[or]The sun sinks through the westward sky, slowly burning towards the shades of evening[in random order]."

Table of Evening2 ambience
freq		text	table		trigger	flag
frequent		"[one of]The evening sun hovers just above the westward horizon, causing brilliant dancing reflections to burn on the sea[or]The sun drops quickly towards the horizon, a red-orange ball of flame[in random order]."

Table of Sunset ambience
freq		text	table		trigger	flag
guaranteed	"[if sun over ocean]The [o]sun[x] touches the horizon, sinking slowly into the sea in a fiery red spectacle[else][one of]The colors of the sky begin to darken[or]The colors of the sky hover on the edge of twilight[or]Echoes of daylight still stream through the clouds[cycling][end if]."

To decide whether sun over ocean:
	if exploring Progue's turf or location is regionally in High Altitude or location is Rim of Volcano or location is Volcano Slopes or location is Saddle or location is Atop or location is Rockslide or location is regionally in Chairlift-Ride, decide yes;
	decide no.

Table of Twilight1 ambience
freq		text	table		trigger	flag
frequent		"[one of]The brilliant red-orange glare to the west causes burnished highlights to dance on the ocean waves[or]The sun still strikes the clouds floating out over the ocean to the west, lighting them with a cream-orange glow[or]The hot orange aftermath of the sunset burns brightly on the horizon[in random order]."

Table of Twilight2 ambience
freq		text	table		trigger	flag
frequent		"[one of]Orange fades to reds and violets as the western sky begins to fade[or]The brilliant glow of the sunset continues to fade[in random order]." 

Table of Twilight3 ambience
freq		text	table		trigger	flag
frequent		"The [one of]light[or]twilit sky[or]fading sky[in random order] [one of]grows dim and indistinct[or]loses more and more of its vibrant colors[at random] as the sky [one of]fades to deep indigo[or]darkens[or]falls slowly into night[in random order] above."

Table of Twilight4 ambience
freq		text	table		trigger	flag
frequent		"[one of]A single bright star twinkles above in the grey-blue sky as shapes grow darker and indistinct around you[or]A few stars twinkle faintly above, emissaries of night's rapid approach[or]The sky's blue continues to deepen, allowing a few faint stars to shine through above[in random order]."

Table of Twilight5 ambience
freq		text	table		trigger	flag
frequent		"[one of]The failing light grows weaker by the minute[or]More and more stars appear in the slate-grey sky above as the twilight continues to fade[or]Nightfall is rapidly approaching; more and more stars shine in the deep blueness above[in random order]." 

Table of Twilight6 ambience 
freq		text	table		trigger	flag
frequent		"[one of]Stars come out one by one in the grey sky above, a faint glow from the horizon all that remains of the light[or]The daylight is almost gone, just a hint of brightness remaining on the western horizon[at random]." 

Table of Night ambience
freq		text	table		trigger	flag
guaranteed	"The last of the light has faded from the sky, leaving only a rich black sky studded with millions of stars and a great swirling [o]galaxy[x][if moonup], as well as a pale pink [o]moon[x][end if]."

After waiting (this is the waiting causes time to pass faster rule):
	if time factor is not 1 and yourself is awake and current episode is not Water Works begin;    
		pass 7 minutes of time; 
	end if;     
	continue the action.       
  
To say time-of-day-bit:    
	if night begin; say ", [one of]soft night breezes tickling your hair[or]your feet on the [surface-material] the only sound in the night's stillness[or]moving cautiously in the dim light of the [light-source][or]the deepness of the night swallowing your footsteps[or]moving quietly almost without meaning to in the thick silence of the night[or]only the faint light of the [light-source] above showing your way[in random order]";
	otherwise if dawn; say "[one of], the pre-dawn light smoothing form and motion into secret grey blurs[or] under the brightening sky[or], feeling like a ghost gliding through the silence of daybreak[or], the sound of your steps on the [surface-material] flat and echoless in the early morning's half-light[or], scanning the horizon for signs of sunrise[or], enjoying the shifting panolpy of colors growing in the eastern sky[or], listening to the distant call of gulls anxious for sunlight and circling in the grey-blue sky[in random order]"; 
	otherwise if morning; say ", [one of]the chill air of night still not quite dispelled[or]shivering a bit in the lingering chill of the night air[or]the morning sunlight picking out random details in the scenery in shifting, waving highlights[or]under a sky still warming to day's colors as the sun begins its long climb[or]enjoying the brightening colors of the new day[or]as shafts of newborn sunlight pierce the air[or]warmed by horizontal rays of golden sunlight[or]the clouds above you flaming with hot gold sunlight[in random order]";
	otherwise if midmorning; say ", [one of]already starting to feel warm though it's not yet noon[or]through the swaying shadows of midmorning light[or]the blue sky above you achingly bright and clear[or]squinting up at the fresh-scrubbed sky above you[or]under the slanted rays of the sun rising ever higher in the tropical sky[or]the [surface-material] under your feet warming in the late morning sunlight[or]a few gusts of warming wind swirling listlessly around you[in random order]";
	otherwise if midday; say ", [one of]sweating in the hot sunlight[or]sweltering in the heat[or]warm air gusting around you like blasts from an oven[or]your shadow almost vanished in the noon sun[or]the [surface-material] baking underneath your feet[or]squinting against the brightness of the tropical midday light[or]heat waves shimmering in the distance before you[or]first pausing for a moment to wipe the sweat from your brow[or]enjoying the faint breeze you generate as you move through the still midday air[in random order]";
	otherwise if raining; say ", [one of]slogging through the rapidly dampening [surface-material][or]moving quickly through the rain[or]water trickling down all around you[or]resigned to getting totally soaked in the downpour[or]brushing wet hair from your face[or]dodging pools of water forming on the [surface-material] at your feet[or]shivering as the rainwater soaks through your worn travelling clothes[or]raising a hand to your eyes to shield them from the pouring rain[in random order]";  
	otherwise if afternoon and rained; say ", [one of]stepping around shrinking puddles soaking into the [surface-material][or]the dripping of moisture from the soaked vegetation around you making a gentle chorus[in random order]";
	otherwise if afternoon and cloudy; say ", [one of]through shifting shadows as the scudding clouds hide and reveal the sun[or]shadowed by patches of heavy grey cloud above[or]the heat of the day subdued as racing clouds conceal the sunlight[or]in a sudden patch of afternoon light breaking through the heavy cloudbank[or]through dim shadows in the suddenly cloud-muted light[or]keeping an eye on the storm clouds above[or]eyeing the racing grey clouds above warily[or]trying to decide what the gathering clouds above are going to do[in random order]";
	otherwise if afternoon; say ", [one of]the afternoon light painting everything in lazy tan hues[or]the heat of earlier dulled now by the gentle shift to afternoon[or]the sky above the radiant blue of an afternoon that might last forever[or]hot afternoon breezes gusting through the clean island air[in random order]";
	otherwise if evening or sunset; say ", [one of]the rapidly sinking sun painting everything in regal hues[or]glancing up at the shifting colors in the sky as the sun sinks towards the horizon[or]golden light from the failing sun sending streaks of illumination over the terrain[or]the [surface-material] at your feet sending up waves of heat in memory of the noonday sun[or]a feeling of quiet tranquility soaking the landscape in the light of the sinking sun[or]the evening light saturating the tropical colors everywhere you look[in random order]";
	otherwise if twilight; say ", [one of]through growing shadows as the daylight fades[or]passing through the lull of twilight as night prepares to settle in[or]watching the sky darken from moment to moment as the daylight drains away[or]stepping carefully in the failing light over the [surface-material][or]moving quickly as night's slow arrival continues[or]the fading light seeming to suck the movement and colors from the scenery as it departs[in random order]";
	end if.      
  

Section - Time Travel - Not for release

Time traveling is an action applying to one interval. Understand "tt [interval]" as time traveling. Carry out time traveling: let dest be the interval understood; if dest is dawn, now time of day is 4:10 AM; if dest is sunrise, now time of day is 5:00 AM; if dest is morning, now time of day is 5:10 AM; if dest is midmorning, now time of day is 7:10 AM; if dest is midday, now time of day is 10:40 AM; if dest is afternoon, now time of day is 2:40 PM; if dest is evening, now time of day is 5:40 PM; if dest is sunset, now time of day is 7:01 PM; if dest is twilight, now time of day is 7:16 PM; if dest is night, now time of day is 8:10 PM; say "(time travelled to [dest])"; try looking. Understand "tt" as vague time traveling. Vague time traveling is an action out of world applying to nothing. Carry out vague time traveling: speak as the parser "The valid times are: dawn, sunrise, morning, midmorning, midday, afternoon, evening, sunset, twilight, and night.".

Chapter - The Heavens
     
Outdoors is a region.
 
A heavenly body is a kind of backdrop. A heavenly body is always minor. The provoke message of a heavenly body is usually "Would that you could." First report remembering a heavenly body: say "[The noun] is [if dawn and noun is sun]not yet in[else]no longer in[end if] the sky." instead.      
 
Understand "sky/horizon" as up. Instead of examining up when location is regionally in Outdoors:
	if sunup begin;  
		try examining sun; 
		if moonup, try examining moon;
	otherwise;
		if moonup, try examining moon; 
		otherwise try examining stars;
	end if.    

Every turn when the player is awake and the player is regionally in Lacuna and we are not landmark-going (this is the motions of the heavenly spheres rule):
	if sunup:
		if the heavens are being debugged, say "// The Heavens: placing the daytime heavens in scope.";
		move the sun to Outdoors;
		remove the stars from play;
		remove the galaxy from play;    
	otherwise:
		if the heavens are being debugged, say "// The Heavens: placing the nighttime heavens in scope.";
		remove the sun from play;
		move the stars to Outdoors;
		move the galaxy to Outdoors;    
	if the tide counter > 841 or tide counter < 229:
		remove the moon from play;
		if the heavens are being debugged, say "// The Heavens: removing the moon.";  
	otherwise:
		move the moon to Outdoors;
		if the heavens are being debugged, say "// The Heavens: placing the moon in scope. Tide counter: [tide counter].".

The stars are a heavenly body. [ Can't recognize "star" due to conflict with a beat.]The description is "There must be millions of stars overhead, sparkling above you and lorded over by the great [if galaxy is named]galaxy [o]Capalla[x][otherwise][o]galaxy[x][end if] running through them all."  

The great galaxy is a heavenly body. Understand "Capalla" as galaxy. The description is "Stretching nearly from horizon to horizon, the galaxy[if named][one of] -- Capalla, [the Progue] called it --[or] Capalla[stopping][end if] is rich with a million tiny dots finer than dust grains, streaked through with every shade of orange-tinted silver you can imagine." 

Noticing-The-Galaxy is a scene. Noticing-The-Galaxy begins when galaxy is on-stage and night and location is outdoorsy and location is regionally in Lacuna. Noticing-The-Galaxy ends when Noticing-The-Galaxy begins. When Noticing-The-Galaxy begins: say "Gazing up at the sky, you pause for a moment in wonder. Spanning the horizon is a fantastic sight-- a silver-orange [o]galaxy[x], glimmering in the night like some vision. You've seen countless night skies in your travels, but this certainly counts as one of the most spectacular.".

Phase is a kind of value. The phases are new, sliver, crescent, fat crescent, half, waxing, three quarter, almost full, and fullmoon. 

The moon is a heavenly body.  The moon is in Outdoors. The moon has a phase. The description of the moon is "[if we have not examined the moon]There is almost always a moon, no matter the world. This one[otherwise]The moon[end if] is about the size of your fist held at arm's length, and it glows a ghostly pink, streaked through with shades of orange. Hanging [moon location], it's [long moon description]." 
  
Check remembering the moon: say "The moon is not up right now." instead. 
 
To say moon location:
	if tide counter >= 229 and tide counter < 300, say "just above the eastern horizon";
	if tide counter >= 300 and tide counter < 371, say "low in the eastern sky";
	if tide counter >= 371 and tide counter < 443, say "halfway up the eastern sky";	
	if tide counter >= 443 and tide counter < 514, say "high in the eastern sky";
	if tide counter >= 514 and tide counter < 585, say "almost directly overhead";
	if tide counter >= 585 and tide counter < 657, say "high in the western sky";
	if tide counter >= 657 and tide counter < 728, say "halfway down the western sky";	
	if tide counter >= 728 and tide counter < 800, say "low in the western sky";
	if tide counter >= 800 or tide counter < 229, say "on the edge of the western horizon".

moon_wester is a truth state that varies.

To calculate moon phase:
	[ set sun_time to a number from 0 to 1439 representing the time of day / sun's position in the sky.]
	let sun_time be the hours part of time of day * 60;
	let sun_time be sun_time plus the minutes part of time of day;
	[ set moon_time to the moon's position in the sky on the same scale, losing some accuracy to stay within Inform's 32,768 integer maximum.]
	let tmp be ( tide counter / 10 ) * 144;
	let moon_time be tmp / 11;	
	[ the difference between these is the distance between the two bodies; convert this to 360 degrees (which is 1/4 of 1440) to get the angular distance between the two bodies, which in turn will be the phase of the moon. ]
	let offset be ( sun_time - moon_time ) / 4;
	[ for descriptive purposes, check whether the moon is on the west or east side of the sun. ]
	if offset < 0, now moon_wester is true;
	otherwise now moon_wester is false;
	[ We don't care whether the moon is waxing or waning, so we can simplify to just a number between 0 (new) and 180 (full). ]
	if offset > 180, change offset to offset - 360;
	if offset < -180, change offset to offset + 360;
	if offset < 0, change offset to offset * -1;
	[ now we can decide on the moon's phase. ]
	if offset < 20, now the phase of the moon is new;
	if offset >= 20 and offset < 40, now the phase of the moon is sliver;
	if offset >= 40 and offset < 60, now the phase of the moon is crescent;
	if offset >= 60 and offset < 80, now the phase of the moon is fat crescent; 
	if offset >= 80 and offset < 100, now the phase of the moon is half;
	if offset >= 100 and offset < 120, now the phase of the moon is waxing;  
	if offset >= 120 and offset < 140, now the phase of the moon is three quarter;
	if offset >= 140 and offset < 160, now the phase of the moon is almost full;
	if offset >= 160, now the phase of the moon is fullmoon;
	if the heavens is being debugged, say "// The Heavens: calculate moon phase (sun_time: [sun_time]; moon_time: [moon_time]; offset: [offset]; [the phase of the moon]).". 


To say moon description:
	calculate moon phase;
	if phase of moon is new, say "tiny sliver of a";
	if phase of moon is sliver, say "thin sliver of a";
	if phase of moon is crescent, say "crescent";
	if phase of moon is fat crescent, say "fat crescent";
	if phase of moon is half, say "half";
	if phase of moon is waxing, say "just over half";
	if phase of moon is three quarter, say "three-quarter";
	if phase of moon is almost full, say "almost full";
	if phase of moon is fullmoon, say "full".

To say long moon description:
	calculate moon phase;
	say "[if phase of moon is new]a barely visible splinter [moonclosesunbit][end if][if phase of moon is sliver]a skinny sliver [moonclosesunbit], its edges delicately traced in pink and black[end if][if phase of moon is crescent]a rounded crescent[end if][if phase of moon is fat crescent]a fat crescent, nearly half-full[end if]";
	say "[if phase of moon is half]half full, the dark half faintly visible[end if][if phase of moon is waxing]a little more than half full[end if][if phase of moon is three quarter]three quarters full[end if][if phase of moon is almost full]almost full, the only imperfection a rounded sliver of shadow along one side[end if][if phase of moon is fullmoon]full and bright[end if]". 
	
To say moonclosesunbit:
	if phase of moon is new, say "just ";
	if moon_wester is true begin;
		if midmorning or midday or afternoon, say "west of";
		if evening or sunset, say "below";
		if sunrise or dawn or morning or twilight or night, say "above";
	otherwise;
		if midmorning or midday or afternoon, say "east of";
		if evening or sunset or twilight, say "above";
		if sunrise or morning or dawn or night, say "below";
	end if;
	 say " [if sunset or evening]the blaze of the setting sun[otherwise if sunrise or morning]the bright rising sun[otherwise if sunup]the blaze of the sun[otherwise if dawn or twilight or night]the horizon[otherwise]in the sky[end if]". 
   
The sun is a seen heavenly body. The sun is in Outdoors. The description of the sun is "[if sunrise]The sun creeps over the ocean with yellow gold fire, lighting up a brilliant streak in the waves[otherwise if morning]The morning sun beams brightly down on you, burning away the faint chill of night[otherwise if midmorning]The sun is high in the eastern sky. It's beginning to get hot[otherwise if midday]The sun is directly overhead, bright, and scorching[otherwise if afternoon]High in the western sky, the sun is bright and hot[otherwise if evening]Colors begin to deepen as the sun approaches the western horizon[otherwise if sunset]The sunset over the waves is spectacular[otherwise]The sun has slipped beneath the waves[end if]." Understand "sunrise" and "sunset" as the sun. Understand "flash" or "green flash" as the sun when Progue is idle.

To pass (span - a number) minutes of time: 
	now the time of day is span minutes after the time of day;
	increase the tide counter by span;
	if the tide counter is greater than 1100, change the tide counter to the tide counter minus 1100.
 
The Heavens is a thing. Check object-debugging sun: try object-debugging the heavens instead. Check object-debugging moon: try object-debugging the heavens instead. Check object-debugging galaxy: try object-debugging the heavens instead. Check object-debugging rain clouds: try object-debugging the heavens instead.

To say light-source:  
	if sunup begin; say "sun";
	otherwise;
		if moonup, say "moonlight";
		otherwise say "stars";   
	end if. 
 
To say approximate time: say "[if dawn]Dawn[end if][if sunrise]Sunrise[end if][if morning]Morning[end if][if midmorning]Midmorning[end if][if midday]Midday[end if][aptime2]". To say aptime2: say "[if afternoon]Afternoon[end if][if evening]Evening[end if][if sunset]Sunset[end if][if twilight]Twilight[end if][if night]Night[end if]".



Chapter - Weather

[ This is very simple. Each afternoon there is a certain chance that there
  will be a storm. This lasts the whole afternoon (but only the afternoon)
  and is divided into three phases: gathering clouds, storm, dispersing clouds. ]

Weather status is a kind of value. The weather statuses are undecided, endgame-storm, endgame-dispersing, decided to rain, decided not to rain, gathering clouds, raining, and dispersing clouds. The weather state is a weather status that varies. The last weather state is a weather status that varies. The weather state is undecided. The last weather state is undecided.

Every turn when weather state is undecided and afternoon (this is the deciding on the weather rule):
	if the heavens are being debugged, say "// The Heavens: deciding whether to rain (because weather state is undecided and afternoon)."; 
	if a random chance of 1 in 2 succeeds, now the weather state is decided to rain;  
	otherwise now the weather state is decided not to rain;
	if the heavens are being debugged, say "// The Heavens: decided [if weather state is decided not to rain]not [end if]to rain.".
	
Every turn when the weather state is not decided not to rain and the weather state is not undecided and yourself is awake (this is the rainstorm computations rule):
	if the heavens are being debugged, say "// The Heavens: rainstorm computations rule."; 
	if it is after 3:30 PM and it is before 4:31 PM begin;
		if weather state is not raining begin;
			if the heavens are being debugged, say "// The Heavens: setting weather state to raining."; 
			now weather state is raining;
			move rain clouds to Outdoors; 
			move lightning to Outdoors; 
			if the player is in Outdoors, say "With a crash of thunder, raindrops begin to fall. A moment later you are in a downpour.";
		otherwise if the player is in Outdoors; add potential messages from the Table of Rainstorms, only one;
		end if;
	otherwise if it is after 2:30 PM and it is before 3:31 PM;
		if weather state is not gathering clouds begin;
			if the heavens are being debugged, say "// The Heavens: setting weather state to gathering clouds."; 
			now weather state is gathering clouds;
			if the player is in Outdoors, say "The sky overhead is beginning to fill up with dark [o]clouds[x].";
			move rain clouds to Outdoors;
		otherwise if the player is in Outdoors; add potential messages from the Table of Gathering Clouds, only one; 
		end if; 
	otherwise if it is after 4:30 PM and it is before 5:31 PM;
		if weather state is not dispersing clouds begin;
			if the heavens are being debugged, say "// The Heavens: setting weather state to dispersing clouds."; 
			now weather state is dispersing clouds;
			move rain clouds to Outdoors; move lightning to Outdoors;
			if the player is in Outdoors, say "The rain peters out and the [o]clouds[x] begin to disperse.";
			if a random chance of 1 in 3 succeeds, move rainbow to Outdoors;
		otherwise if the player is in Outdoors; add potential messages from the Table of Dispersing Clouds, only one;
		end if;  
	otherwise if it is after 5:30 PM;
		if the heavens are being debugged, say "// The Heavens: cleaning up rainstorm aftermath & setting weather state to undecided.";   
		remove rain clouds from play; 
		remove lightning from play; 
		remove rainbow from play;
		now weather state is undecided;
		now last weather state is dispersing clouds;  
	end if.

Check listening when weather state is raining: say "The sound of rain falling all around you creates a torrential cacophany." instead. 

Some rain clouds are a backdrop. Understand "dark/cloud/thunderheads/wind/storm" as rain clouds. The description is "[if weather state is gathering clouds]They are flying in rapidly from the east, black and ominous[end if][if weather state is raining]Buckets of warm rain pour down from the black thunderheads above[end if][if weather state is dispersing clouds]The clouds are quickly being carried off westward, revealing a reddish-orange evening sky[end if]." Check smelling rain clouds: say "[if raining or  weather state is dispersing clouds]The smell of wet earth and clean rain is thick in the air[otherwise if weather state is gathering clouds]The expectant smell of approaching rain rides on the breeze[end if]." instead.  

A rainbow is a backdrop. The description is "It arcs triumphantly over the ocean, scintillating wetly in the air as the sun shines past the retreating thunderheads to light it.". 

The flash of lightning is a backdrop. The description is "Only a purple blotch over your vision, now."   
 
Every turn when night (this is the finishing up the weather business rule):
	if the heavens are being debugged, say "// The Heavens: ensuring weather state is undecided (because night)."; 
	now weather state is undecided; 
	now last weather state is undecided.
	
To decide whether rained: if weather state is dispersing clouds or last weather state is dispersing clouds, decide yes; decide no. To decide whether cloudy: if weather state is gathering clouds or weather state is dispersing clouds, decide yes; decide no.
  
To decide whether didnt rain: if rained or raining, decide no; decide yes. 

To decide whether raining: if the weather state is raining, decide yes; decide no. To decide whether not raining: if raining, decide no; decide yes.

Table of Gathering Clouds
freq		start time	end time	text	table		trigger	flag	
frequent	an interval	an interval	"[one of]Heavy rain clouds[or]Dark thunderheads[or]Dark grey clouds[in random order] [one of]are gathering overhead[or]race in, blotting out the sun more and more each minute[or]scud quickly across the sky[or]drag cold shadows across the island, gusts of sweet-smelling wind trailing behind[or]continue to gather above[in random order]." 

Table of Rainstorms
freq		start time	end time	text	table		trigger	flag	
frequent	an interval	an interval	"[one of]Lightning flashes and thunder rumbles as the storm continues[or]Wind and rain buffet you in waves as the storm rages on[or]Sheets of rain dance through the air[or]A sudden flash of lightning somewhere above you glints off the [surface-material], followed moments later by a resounding crack of thunder[or]The rainfall patters on every surface around you[or]The storm continues around you[or]Deep grey thunderheads race through the sky above you as the storm continues[or]Muffled flickers of lightning gutter in the clouds above you as the rain continues[in random order]."
 
Table of Dispersing Clouds
freq		start time	end time	text	table		trigger	flag	
frequent	an interval	an interval	"[if rainbow is on-stage][rainbowmsg][otherwise][one of]The rain clouds[or]The storm clouds[or]The clouds[or]The grey remnants of the storm[in random order] [one of]continue to slowly disperse[or]break up more and more each minute[or]are scattering, letting streaks of blue sky through[or]are dissolving in the late afternoon sunlight[in random order][end if]."
 
To say rainbowmsg: say "A rainbow [one of]floats serenely above the water[or]shines brightly below the clouds[or]hovers gracefully out over the ocean[in random order], [one of]glimmering in the afternoon light[or]the spill of color making the tropical view even more magical[or]an unexpected coda to the rainfall[in random order]". 

The heavens has an interval called saved time. The saved-weather-state is a weather status that varies.

After going from an outdoorsy room to an indoorsy room:
	now the saved time of the heavens is current interval;
	now the saved-weather-state is weather state;
	continue the action.

[ To help keep players aware of the passage of time, we note it when the player steps outdoors after having been indoors for a while. ]

After going from an indoorsy room to an outdoorsy room:
	if former location is Inside-Manta, continue the action; [ If we're leaving the manta, we have to describe that process first, so it doesn't make sense to print the below message.]
	if current interval is not saved time of the heavens or ( afternoon and weather state is not saved-weather-state ) begin;
		say "[one of]As you emerge, you see that[or]Stepping outside, you discover that[at random] [if dawn]the beginnings of daylight flush the sky[otherwise if sunrise or morning]the sun has come up, flooding your eyes with light[otherwise if midmorning]the morning sun has moved higher into the sky, chasing off the long dawn shadows[otherwise if midday]the sun is now high in the sky, beating down from near the zenith[otherwise if afternoon and raining]a rain storm has blown in, waves of wind and water descending on the island in buckets[otherwise if afternoon and weather state is decided not to rain]the sun has moved down in the westward sky, and afternoon light colors everything in shades of burnt gold[otherwise if afternoon]clouds have moved over the sun, hiding the afternoon light in racing streaks of white and grey[otherwise if evening or sunset]the sun has sunken to near the horizon, producing a spectacular display[otherwise if twilight]the sun has set, leaving the island in a fading twilight[otherwise if night]the sun has set and the light has gone, leaving you in the black of night[end if].";
	end if; 
	continue the action. 



 


 

	




	

Part - Conversation System

 [ NOTES:   
	This conversation system is designed for situations in which there is never more than a single NPC in the location at any given time. 
] 

Conversation is a thing. Does the player mean object-debugging conversation: it is likely. [ For debugging ]  
  
Chapter - Instructing the Player

Instead of asking someone to try doing something, try correct conversing. Instead of asking anyone about anything, try correct conversing. Instead of telling anyone about anything, try correct conversing. Instead of answering anyone that anything, try correct conversing. Understand  "ask [text]" or "ask" or "tell" or "say" or "ask about [text]" or "tell about [text]" or "ask [someone] about [text]" or "tell [someone] about [text]" or "show" or "show [text]" as a mistake ("[correct conv]").         
 
Understand the command "ask" as something new. Understand the command "tell" as something new. Understand the command "show" as something new. [Understand the command "give" as something new.] Understand the command "shout" as something new.  

First carry out giving something to somebody: say "You'd better hold on to it.". 

Correct conversing is an action out of world. Carry out correct conversing: say "[correct conv]".

To say correct conv:
	let myinp be indexed text;
	now myinp is the player's command;
	if myinp matches the regular expression "[tree-password]" or myinp matches the regular expression "[rebel-password]":
		say "You speak the word aloud, but nothing happens.";
	else if location is Echo Chamber:
		say "You call it out loud and clear. Instantly, the weird shapes and formations suck your utterance up, twist it around, and send it back to you weirdly changed and deformed to reverberate around the cavern until finally dying down.";
	else:
		say "[as the parser]Tutorial: To speak with people, try using emphasized keywords in their dialogue, a conversation verb, or a simple HELLO to get things started. Type HELP for more details[as normal].".

[ Blue Lacuna responds to four types of physical actions: strong attack (the "attack" verb), weak attack (the "push" verb), weak affection (the "hug" verb), and strong affection (the "kiss" verb). Other interaction verbs are routed into one of these. ] 

Check throwing something at someone (called target): try attacking target instead. 

Check touching someone (called lucky one): if lucky one is an animal, continue the action; otherwise try hugging lucky one instead.	 



Chapter - Definitions  
 
 
Check listening when an other person (called Phil) is enclosed by the location and Phil is attentive: say "You stay quiet." instead.   

Section - Gender Pronouns

To say CHeShe: if a random other nonProgue person enclosed by the location is male, say "He"; otherwise say "She".   
To say heshe: if a random other nonProgue person enclosed by the location is male, say "he"; otherwise say "she". 
To say CHisHer: if a random other nonProgue person enclosed by the location is male, say "His"; otherwise say "Her".
To say hisher: if a random other nonProgue person enclosed by the location is male, say "his"; otherwise say "her". 
To say CHimHer: if a random other nonProgue person enclosed by the location is male, say "Him"; otherwise say "Her".
To say himher: if a random other nonProgue person enclosed by the location is male, say "him"; otherwise say "her". 
To say hishers: if a random other nonProgue person enclosed by the location is male, say "his"; otherwise say "hers". 
  
Definition: a person is nonProgue: if he is Progue, no; yes.

Chapter - Beats and Threads
 
A beat is a kind of thing. A beat has some text called keyword name. [ The basic unit of conversation. ]     
  
highlight topics is a truth state that varies. nicename topics is a truth state that varies. 
   
Rule for printing the name of a beat (called topc) while highlight topics is true:
	[ If Progue is asking a question, we don't want to highlight relevant words since that veers the conversation off topic. Instead, we add it to the list of subjects so the player can return to that idea later. (Note that non-yes/no answers need to be explicitly summoned.]
	if topc is legit and last beat is insistent and topc is not summoned by last beat begin;    
		say "[keyword name of topc]"; 
		if location is not regionally in Dreamlands and topc is not listed in list of convo stuff, add topc at entry 1 in list of convo stuff; 
	[ if this is a topic that we haven't discussed before (or we have and its repeatable and replaced by something), emphasize the word and summon it. ]
	otherwise if topc is legit;      
		say "[t][keyword name of topc][x]";    
		now tempfuse of topc is fuse of topc;  
		if tempfuse of topc > 100, now tempfuse of topc is 5; 	
	[ This must be something that's already been discussed, so don't reveal that it's a topic; just print the word. ] 
	otherwise; 
		say "[keyword name of topc]"; 
	end if;   
	if final release mode is false and keyword name of topc is "", say "**";
	if keyword name of topc is "", say printed name of topc;
	if conversation is being debugged, say "*([printed name of topc]:[tempfuse of topc])". 

Definition: a thing (called topc) is legit: let dis be 0; if last beat is topc, decide no; if topc is spoken, now dis is 1; if dis is 0 or topc is repeatable or topc is replaced by something legit, decide yes; decide no.

Rule for printing the name of a beat (called topic) while nicename topics is true: if keyword name of topic is not "", say keyword name of topic; otherwise say printed name of topic.    
 
A beat has some text called the reaction. [ What is printed when the beat is discussed. ]     
  
A beat has a beat called yes-beat. The yes-beat of a beat is usually silence. A beat has a beat called no-beat. The no-beat of a beat is usually silence. A beat has a beat called maybe-beat. The maybe-beat of a beat is usually silence. A beat has a beat called both-beat. The both-beat of a beat is usually silence. A beat has a beat called neither-beat. The neither-beat of a beat is usually silence. [ Note that these need to be given an explicit keyword name of "yes" or whatever. (Why?)]

A beat has a number called fuse. The fuse of a beat is usually 3. A beat has a number called tempfuse. [ Newly summoned beats expire after a certain number of turns. ]         
  
Definition: a beat is available if its tempfuse > 0. Definition: a beat is unavailable if it is not available. [ An available beat is relevant to speak about at the present moment. ]          
   
A beat is either spoken or unspoken. A beat is usually unspoken. [ This tracks whether we have discussed the beat. We don't use Inform's built in "we have discussed" because it's too inflexible; sometimes we want to pretend we've discussed something when we actually haven't, and a beat might incorrectly be marked as "discussed" by Inform even if it didn't make it through our routines to actually having printed something.]      
  
A beat is either repeatable or unrepeatable. A beat is usually unrepeatable. [ Most beats can only be said once. ]                  
 
A beat is either ephemeral or substantial. A beat is usually substantial. [ Ephemeral beats are for tangents or asides which do not affect the main flow of the conversation, which continues immediately after printing them. ]   
 
A beat is either terminal or interstitial. A beat is usually interstitial. [ A terminal beat marks a possible endpoint of a conversation. ]  

A beat is either verbal or nonverbal. A beat is usually verbal. [ Most beats are spoken aloud, and it thus makes sense for others to be described as "listening" for instance. Some beats either immediately suggest something else or encode a nonverbal response. ]   
  
Importance is a kind of value. The importances are insistent, dogged, or casual. A beat has an importance. The importance of a beat is usually casual.   [ An insistent beat means that the NPC expects an answer, and all other active beats are squelched. A dogged beat is one that keeps the preceeding insistent beat's answers available. ]      
 
A beat is either exciting or average. A beat is usually average. [ Some beats will be brought up by the NPC as soon at the player gives them a chance to get a word in. ]        
   
Affinity-tone is a kind of value. The affinity-tones are affinitive, unaffinitive, and affinity-neutral. A beat has an affinity-tone. The affinity-tone of a beat is usually affinity-neutral. Paternal-tone is a kind of value. The paternal-tones are paternal, unpaternal, and paternal-neutral. A beat has an paternal-tone. The paternal-tone of a beat is usually paternal-neutral. Submissive-tone is a kind of value. The submissive-tones are submissive, unsubmissive, and submissive-neutral. A beat has an submissive-tone. The submissive-tone of a beat is usually submissive-neutral. Romantic-tone is a kind of value. The romantic-tones are romantic, unromantic, and romantic-neutral. A beat has an romantic-tone. The romantic-tone of a beat is usually romantic-neutral. Annoyance-tone is a kind of value. The annoyance-tones are annoying, impressive, and annoying-neutral. A beat has an annoyance-tone. The annoyance-tone of a beat is usually annoying-neutral. [ Beats can change Progue's attitude towards the player. ] 
 
The last beat is a beat that varies. The actual last beat is a beat that varies. The penultimate beat is a beat that varies. [ The next beat is a beat that varies.] Silence is a beat. The last beat is silence. [ The next beat is silence.] The penultimate beat is silence. [ Keeps track of the last thing said, and, sometimes, a queued response for the NPC to say when the player runs out of things to ask. ]     
  
A person has a beat called unavailable-beat. The unavailable-beat of a person is usually silence. [ Sets what the NPC should do if the player tries to refer to a no-longer-relevant beat. ]  

Summoning relates various beat to various beats. The verb to summon (he summons, they summon, he summoned, it is summoned) implies the summoning relation. [ Beats can bring other beats into play by making them available. ]   

Suggesting relates various beats to one beat. The verb to suggest (he suggests, they suggest, he suggested, it is suggested) implies the suggesting relation. [ A throughline should be defined for every beat, which tells the NPC how to continue the conversation if the player is silent. ] 

Replacing relates one beat to various beats. The verb to replace (he replaces, they replace, he replaced, it is replaced) implies the replacing relation. [ An individual beat may only be seen once per game (unless it is repeatable). Replacing explains which beat should be used if the beat requested has already been said. If none is specified, the character will reply with his unavailable-beat. ]
 
Enqueuing relates various beats to one beat. The verb to enqueue (he enqueues, they enqueue, he enqueued, it is enqueued, he is enqueuing) implies the enqueuing relation. [ Some beats move immediately on to a next beat before the player has as chance to react. ]  

Canceling relates various beats to various beats. The verb to cancel (he cancels, they cancel, he canceled, it is canceled) implies the canceling relation. [ Beats can make other beats no longer available, useful for keeping the player from changing their answer to a question. ]  

Referencing relates one thing to various beats. The verb to reference (he references, they reference, he referenced, it is referenced) implies the referencing relation. [ Beats can refer to objects; by using the DISCUSS verb, we can see a list of the most recent objects we've encountered that this NPC has conversation topics for. ] 

A thread is a kind of container. A thread is usually closed, unopenable, and transparent. [ A thread is a group of related beats, representing one conversation. They are tied together via the suggesting and replacing relations. ]

[ A procedural rule (this is the ignoring basic accessibility for beats rule): if we are discussing or exhausting and the noun is a beat, ignore the basic accessibility rule. ][ Beats do not conform to the usual scope rules. ] [ moved to the my-basic-accessibility rule definition.]   

A thread has a beat called the escape clause. The escape clause of a thread is usually default_escape_clause. [ If a conversation stalls out due to bad programming or an unexpected condition, the escape clause contains a way to gracefully end it unexpectedly. Really, this is always a programming problem, but hopefully in the worst case scenario where it appears, keeps the game from appearing broken. ]   

default_escape_clause is a beat with reaction "'I've lost my train of thought,' [the random other person in the location] says. (Error: no conversation beat.)".   
   
[ We never want to have to disambiguate between beats, since they are not named. Thus, we intelligently figure out which one the player is talking about. As long as we never introduce two beats that can be referred to with the same word on the same turn, this should work. ]

[ According to vaporware, "only the best matching rule for each object actually matters." ] 
 
Definition: a thing is sequitous if it is in a random thing that encloses penultimate beat.  

Definition: a beat is potent if its tempfuse is its fuse - 1. 
  
Definition: a beat is relevant if it is available or it is sequitous.
  
[ 
Beats are assumed to have priority in the following order:
	-- In same thread as last beat and summoned by the last beat spoken
	-- Not in same thread as last beat but summoned by last beat spoken
	-- In same thread as last beat and still available
	-- Not in same thread as last beat but available 
	-- Not available. 
	
Unavailable beats are never matched, just return an error message.
]

Does the player mean doing something with a beat (called gambit):
	if gambit is unavailable, it is very unlikely;
	if gambit is not potent and gambit is not sequitous, it is unlikely;
	if gambit is not potent, it is possible;  
	if gambit is not sequitous, it is likely;
	it is very likely.       
  
[ If the player tries to type a beat when not in conversation, or one that would mistakenly produce a disambiguation message, prevent them.]
Rule for asking which do you mean while discussing [ and final release mode is true]: 
	if conversation is being debugged, say "// Conversation: rule for asking which do you mean."; 
	let joe be a random conversing person enclosed by the location;
	if joe is a person and the unavailable-beat of joe is not silence, force discuss the unavailable-beat of joe; 
	otherwise say "[if a dream presence is enclosed by location]You can't see or hear it, but you know somehow it's there[else if an other person is enclosed by location][as the parser]It's no longer a good time to talk about that[as normal][otherwise][as the parser]The noun you used was either misspelled, not something I know about, or not nearby[as normal][end if]."; 
	now disambiguation_flag is true. [ This will override the disambiguation question.]  
      
To extend beats:   
	repeat with item running through available beats:
		increase tempfuse of item by 1.
    
 
Chapter - Commands

Section - Hello and Goodbye
   
A person can be idle, attentive, or bestial. A man is usually idle. A woman is usually idle. An animal is always bestial. Definition: a person is nonbestial if it is not an animal.            
    
Definition: a person is other if it is nonbestial and it is not the player. Definition: a person is conversing if it is other and it is attentive.      
  
Understand "hello/hi/greet/greetings/talk" or "shake hands" or "shake hands with" as "[greeting word]". Greeting is an action applying to one visible thing. Understand "[greeting word] [something]" or "[greeting word] to [something]" or "say [greeting word] to [something]" or "[greeting word]" or "say [greeting word]" as greeting. 
 
Rule for supplying a missing noun when greeting (this is the pick a random person to greet rule):
	let Phil be a random other nonbestial person enclosed by the location; 
	if location is Dream7Nexus:
		say "Who, the [o]tall[x] figure or the [o]short[x] one?" instead;
	else if Phil is not a person:  
		if location is Echo Chamber: 
			say "[echochmmsg]." instead;
		else if location is regionally in Rebelworld and pedestrians are in location:
			vague greet pedestrians; 
			stop the action; 
		else:
			say "There's no one here to greet." instead;
	change the noun to Phil.    

Check greeting (this is the can't greet someone you're talking to rule): if noun is attentive, say "You're already talking to [the noun]." instead.  
   
Check greeting (this is the can't greet animals or things rule):
	if noun is an animal:
		if noun is touchable, try touching noun instead;
		otherwise say "[The noun] makes no response." instead;
	if noun is pedestrians:
		vague greet pedestrians;
		stop the action;
	if noun is not a person:
		say "You give [it-them of noun] a whimsical hello, but receive no response." instead.

Carry out greeting:
	if conversation is being debugged, say "// Conversation: Carry out greeting.";	
	pre-conversation processing.        

To pre-conversation processing: 
	if conversation is being debugged, say "// Conversation: pre-conversation processing.";
	let joe be a random other person enclosed by the location;
	if joe is not a person begin; if conversation is being debugged, say "// Conversation: BUG: no random other person is enclosed by location."; 
	otherwise; 
		now the boredom counter of joe is 0;
		if conversation is being debugged and the number of entries in list of convo stuff > 1, say "// Conversation: making legit entries in list of convo stuff ([list of convo stuff]) available."; 
		if location is regionally in Lacuna begin;
			repeat with item running through list of convo stuff begin; 
				if item is a beat and item is legit, now tempfuse of item is fuse of item; 
			end repeat;
		end if;
	now joe is attentive;     
	end if.       
     
Report greeting: say "You greet [the noun]."         
    
Understand "goodbye/goodby/bye/farewell" or "good bye" as "[farewell word]".   
Saying farewell to is an action applying to one visible thing. Understand "[farewell word] [someone]" or "say [farewell word] to [someone]" or "[farewell word]" or "say [farewell word]" as saying farewell to.  Rule for supplying a missing noun when saying farewell to: let Phil be a random other person enclosed by the location; if Phil is not a person, say "There's no one here to say goodbye to." instead; change the noun to Phil.      
  
[ Check saying farewell to (this is the can't farewell someone you're not talking to rule): if noun is idle, say "You aren't talking to [the noun] right now." instead.  ]

Carry out saying farewell to:      
	if conversation is being debugged, say "// Conversation: Carry out saying farewell to.";	    
	now the boredom counter of noun is 0;
	post-conversation processing.    

To post-conversation processing:	   
	if conversation is being debugged, say "// Conversation: post-conversation processing. Making [list of available beats] unavailable."; 
	now all people are idle;  
	repeat with target running through available beats begin; 
		now tempfuse of target is 0; 
	end repeat; 
[	now the next beat is silence; ]
	now the last beat is silence.      

Report saying farewell to: say "You say goodbye to [the noun]."  

     

Section - Conversation Verbs Defined By Inform
 
[ Saying yes.] Understand "sure" or "yep" or "yup" or "ok" or "ya" or "yeah" or "yah" or "nod" or "agree" or "affirmative" as saying yes. First instead of saying yes: if yes-beat of last beat is not silence begin; try discussing yes-beat of last beat instead; else if yes-beat of actual last beat is not silence; try discussing yes-beat of actual last beat instead; else; continue the action; end if. [ Originally this line was just "Instead" with no else continue, but this broke something.]         
     
[ Saying no.] Understand "no" or "nope" or "nah" or "disagree" or "negative" or "no thanks" as saying no. First instead of saying no: if no-beat of last beat is not silence begin; try discussing no-beat of last beat instead; else if no-beat of actual last beat is not silence; try discussing no-beat of actual last beat instead; else; continue the action; end if.  

[ Saying sorry.] [ Understand "apologize" or "apologise" as saying sorry. ] Understand the command "sorry" as something new. 

[ Kissing. (Used by us as intimate touching, as opposed to comfort touching like hugging. ]
Understand the command "fuck" as something new. Understand the commands "grope" and "caress" and "fuck" and "fondle" as "kiss".  Understand "make out with [someone]" or "make love to [someone]" or "have sex with [someone]" or "sleep with [someone]" as kissing when Rume is enclosed by location. [ The stipulation is largely to prevent the following unintentional response:  

>HAVE
(sex with yourself)
If you think that'll help.]  
  
[ Attacking.]   

Understand the commands "smack" or "choke" or "strangle" or "rape" or "tear" or "rip" or "slap" or "crush" or "stab" as "attack". 

[ We have to be careful because "punch", an existing synonym for attack, is a keyword used in the Confrontation fight. There, we say "instead of attacking Progue".  But "kick" as a verb should also map to attack, so if we made it a synonym we wouldn't be able to tell them apart in the fight; so here we understand the conversation topic as attacking. ]

[ Understand "[fc_kick] [something]" as attacking when fc_kick is not available.] Understand "[fc_kick] [something]" as manual-attacking. Manual-attacking is an action applying to two things. Carry out manual-attacking: try attacking second noun.
 
 Does the player mean attacking a person: it is very likely. 
 
Section - New Conversation Verbs

Saying maybe is an action applying to nothing. Understand "maybe" or "shrug" or "dunno" or "dont know" or "dont care" or "not sure" or "either" or "could be" as saying maybe. Check saying maybe: if an attentive person is not enclosed by the location, say "You're not talking to anyone." Carry out saying maybe: say "Your reply is ignored." Carry out saying maybe when the maybe-beat of last beat is not silence: try discussing maybe-beat of last beat instead.  

Saying neither is an action applying to nothing. Understand "neither" or "none" as saying neither. Carry out saying neither: try saying maybe. Carry out saying neither when the neither-beat of last beat is not silence: try discussing neither-beat of last beat instead.   

Saying both is an action applying to nothing. Understand "either" or "both" as saying both. Carry out saying both: try saying maybe. Carry out saying both when the both-beat of last beat is not silence: try discussing both-beat of last beat instead.  

Thanking is an action applying to one visible thing. Understand "thanks/thank" or "thank you" as "[thanking verb]". Understand "[thanking verb]" or "[thanking verb] [something]" or "say [thanking verb] to [something]" as thanking. Check thanking: if noun is not a person or noun is player, speak as the parser "You can only thank another person." instead. Check thanking: if noun is not attentive, try greeting noun instead. Carry out thanking: say "[if a random conversing person is male]H[otherwise]Sh[end if]e nods at your expression of thanks.". Rule for supplying a missing noun when thanking: let Phil be a random other person enclosed by the location; if Phil is not a person begin; say "There's no one here to thank right now."; otherwise; if conversation is being debugged, say "// Conversation: vague thanking; try thanking [Phil]."; change the noun to Phil; end if. 

Hugging is an action applying to one visible thing. Understand the command "hug" as something new. Understand "hug/console/comfort" as "[hugging verb]". Understand "[hugging verb]" or "[hugging verb] [something]" as hugging. Check hugging (this is the can only hug another person rule): if noun is not a person or noun is player, speak as the parser "You can only hug another person." instead. [ Check hugging (this is the first greet unattentive people rule): if noun is not attentive, try greeting noun instead. ]Check hugging (this is the can't hug animals rule): if noun is an animal, try touching noun instead. Carry out hugging: say "This may not be the best time for that.". Rule for supplying a missing noun when hugging: let Phil be a random other person enclosed by the location; if Phil is not a person begin; say "There's no one here to hug right now."; otherwise; if conversation is being debugged, say "// Conversation: vague hugging; try hugging [Phil]."; change the noun to Phil; end if.  
 
   
 


Section - Discussing

The topics-window is a g-window with type g-text-buffer. The main-window spawns the topics-window. The position of the topics-window is g-placebelow. The scale method of the topics-window is g-fixed-size. The measurement of the topics-window is 3.

Discussing is an action with past participle discussed, applying to one thing. [ Discussing is the conversation verb in this system. ]  

Understand "discuss" as vague discussing. Vague discussing is an action out of world applying to nothing. Understand the command "subject" as "discuss".  

A puzz-unfinished rule: [ This is to help out Intelligent Hinting]
	if temp-act is discussing something and noun part of temp-act is spoken, rule fails. 
	
A puzz-possibility rule:
	if temp-act is discussing something and noun part of temp-act is unavailable, rule fails. 
 
Carry out vague discussing:  
	let joe be a random other conversing person enclosed by location;
	if the number of entries in list of convo stuff is 0 or last beat is insistent begin;     
		if joe is a person, let ua-beat be the unavailable-beat of joe; 
		if joe is Progue and the number of entries in list of convo stuff is 0, now ua-beat is the naughttosay_beat of Progue;
		if ua-beat is a beat begin; 
			if conversation is being debugged, say "// Conversation: force discussing [ua-beat] (because nothing to change subject to (num: [number of entries in list of convo stuff]/[list of convo stuff]) or last beat [last beat] insistent ([if last beat is insistent]yes[otherwise]no[end if]).";    
			now vague-dis-beat is ua-beat;      
			now tempfuse of ua-beat is 0;     
			now vague-dis-hack is true;    
			stop;    
		otherwise;
			speak as the parser "There's no one here to talk to.";
		end if;    
	otherwise;  
		if joe is not a person begin;
			if an other nonbestial person is enclosed by the location, speak as the parser "You're not talking to anyone right now."; otherwise speak as the parser "There's no one here to talk to.";
		otherwise; 
			if Joe is Progue begin; 
				add denial animii to tl; [ let the player ask about what Progue's doing]
			end if; 
			now showing-offtopics is true;
			if topics-window is g-present, follow the drawing rule of topics-window;
			say "What do you want to discuss?"; 
			change the command prompt to ">>";
			repeat with item running through list of convo stuff begin;
				now tempfuse of item is 2;
			end repeat; 
			stop the action;     
		end if; 
	end if.
	
vague-dis-hack is a truth state that varies. vague-dis-beat is a beat that varies. 

Rule for reading a command when vague-dis-hack is true: [ This is unfortunately necessary since "vague discussing" is meta, meaning action rules attached to something we tried to discuss wouldn't fire. ]
	if conversation is being debugged, say "// Conversation: vague-dis-hack (changing command to 'discuss [vague-dis-beat]')."; 
	now vague-dis-hack is false; 
	force discuss vague-dis-beat;
	change the text of the player's command to "do#nothing".
	
Understand "do#nothing" as doingnothing. Doingnothing is an action out of world applying to nothing. Carry out doingnothing: do nothing.

After reading a command while showing-offtopics is true:
	now showing-offtopics is false;	 
	change the command prompt to ">";
	let pcmd be indexed text;
	let pcmd be the player's command;
	if the player's command matches "cancel" begin; 
		replace the player's command with "cancel";
	otherwise if the player's command matches "bye" or the player's command matches "goodbye";
		replace the player's command with "goodbye";
	otherwise;  
		replace the regular expression "^(.*)$" in pcmd with "discuss \1";
		change the text of the player's command to pcmd;
	end if.     
	
Nothing-doing is an action out of world applying to nothing. Understand "cancel" as nothing-doing. Carry out nothing-doing: say "Ok.".

Check discussing (this is the can only discuss things with attentive people rule):  
	if skip_conversing_check is false and no conversing person is enclosed by location:
		if location is regionally in Dreamlands:
			say "You can't focus on that." instead;
		else if an other nonbestial person is enclosed by location:
			speak as the parser "You aren't talking to [a random other nonbestial person enclosed by the location] right now; type HELLO to begin conversing." instead;
		otherwise:
			say "[if final release mode is false]4[end if][as the parser][notsurewhatyoumeant].[as normal]" instead.  [ We need this, since otherwise the game tries to talk when conversations have ended. ] 

Original beat is a beat that varies. Original beat is silence. 

Every turn (this is the reset the discussion recursion brake rule): now original beat is silence.  

To force discuss (target - a beat): 
	if conversation is being debugged, say "// Conversation: making [target] available.";
	now tempfuse of target is fuse of target;
	now skip_conversing_check is true; 
	try discussing target.   
   
skip_conversing_check is a truth state that varies. 
 
Carry out discussing:    
	now skip_conversing_check is false; 
	if conversation is being debugged, say "// Conversation: Carry out discussing ([noun] ([if noun is available]available[otherwise]unavailable[end if]/[if noun is insistent]insistent[otherwise if noun is dogged]dogged[otherwise]casual[end if]/[if noun is ephemeral]ephemeral[otherwise]substantial[end if])).";
[	if next beat is noun, now next beat is silence; ]
	let target be noun;   
	let keep_going be true;
	if target is Silence, do nothing instead;  
	if target is spoken and target is unrepeatable:
		if original beat is target: [ we have recursed back to starting ]
			if conversation is being debugged, say "// Conversation: we have recursed back to starting (because original beat ([original beat]) is target ([target]).";
			if target suggests a beat (called new target):
				force discuss new target;  
			otherwise:
				if target is insistent, now target is casual;
				try exhausting target instead; 
		otherwise:
			if conversation is being debugged, say "// Conversation: target spoken and unrepeatable; setting original beat to target ([target]).";
			if original beat is silence, now original beat is target;  
		if a beat (called new target) replaces target:
			if conversation is being debugged, say "// Conversation: force discussing [new target] (because [target] is spoken and it is unrepeatable).";
			now tempfuse of target is 0; [ make the beat we're skipping unavailable again. ] 
			force discuss new target; [ ok-- has to be force discuss because otherwise it may be unavailable and we'll get rerouted to the unavailable-beat instead. ]
			stop the action;
		otherwise:
			if conversation is being debugged, say "// Conversation: exhausting [target] (because [target] is spoken and it is unrepeatable and no beat replaces [target]).";
			if target is insistent, now target is casual;
			try exhausting target instead;
	let joe be a random conversing person enclosed by the location; 
	if target is unavailable:
		if joe is not a person:
			if conversation is being debugged, say "// Conversation: error-- there are no attentive other people enclosed by the location."; 
		otherwise:
			if conversation is being debugged, say "// Conversation: force discuss [the unavailable-beat of a random attentive other person enclosed by the location] (the unavailable-beat of [a random attentive other person enclosed by the location]) because [target] is unavailable.";
			force discuss the unavailable-beat of joe;
			stop the action;
	if noun is substantial and noun is not dogged:
		now penultimate beat is last beat; 
		now last beat is target;         
	now actual last beat is target; [ stores even an ephemeral beat. ] 
	if reaction of target is not "": 
		now highlight topics is true;   
		now nicename topics is true; 
		if Progue is enclosed by location, adjust Progue's social standing; 
		say "[reaction of target][line break]";  
		now target is spoken; 
		now nicename topics is false;   
		now highlight topics is false;
		if joe is a person, now the boredom counter of joe is 0;  
		now last-spoken-turn is turn count;
		now conversation fuse is 0;         
		follow the reset the discussion recursion brake rule; 
	if conversation is being debugged and target summons at least 1 beat, say "// Conversation: making [list of beats summoned by target] available.";	     
	repeat with arrival running through beats summoned by target:
		now tempfuse of arrival is fuse of arrival; 
	if yes-beat of target is not silence:
		if conversation is being debugged, say "// Conversation: making yes-beat ([yes-beat of target]) of target ([target]) available.";
		now tempfuse of yes-beat of target is fuse of yes-beat of target; 
	if no-beat of target is not silence:
		if conversation is being debugged, say "// Conversation: making no-beat ([no-beat of target]) of target ([target]) available.";	
		now tempfuse of no-beat of target is fuse of no-beat of target;
	if maybe-beat of target is not silence:
		if conversation is being debugged, say "// Conversation: making maybe-beat ([maybe-beat of target]) of target ([target]) available.";	 
		now tempfuse of maybe-beat of target is fuse of maybe-beat of target; 
	if neither-beat of target is not silence:
		if conversation is being debugged, say "// Conversation: making neither-beat ([neither-beat of target]) of target ([target]) available.";	  
		now tempfuse of neither-beat of target is fuse of neither-beat of target;
	if both-beat of target is not silence:
		if conversation is being debugged, say "// Conversation: making both-beat ([both-beat of target]) of target ([target]) available.";	
		now tempfuse of both-beat of target is fuse of both-beat of target;
	[ now tempfuse of target is fuse of target;] [?]
	if conversation is being debugged and the number of beats canceled by target > 0, say "// Conversation: cancelling [list of beats canceled by target].";  
	repeat with leper running through beats canceled by target:
		now tempfuse of leper is 0;  
	if target is dogged: [ If we're trying to get an answer to a question, make sure answers don't expire.] 
		if conversation is being debugged, say "// Conversation: extending [list of available beats] (because [target] is dogged).";   
		repeat with dude running through available beats:
			increase tempfuse of dude by 1; 
	otherwise if target is insistent or penultimate beat is insistent: [ If we're asking a question, kill all previous topics.] [ if we remove reference to penultimate beat here, then insistent questions break. (answers still hang around.)] 
		if conversation is being debugged, say "// Conversation: cancelling [list of nonnow beats] (because target [target] is insistent ([if target is insistent]y[otherwise]n[end if]) or penultimate beat [penultimate beat] is insistent ([if penultimate beat is insistent]y[otherwise]n[end if]). List of available beats: ";
		repeat with leper running through nonnow beats:
			now tempfuse of leper is 0;    
	if target enqueues a beat (called new target) :
		if conversation is being debugged, say "// Conversation: enqueues [new target].";   
		force discuss new target; 
	now nicename topics is false; 
[	if target is unrepeatable begin;
		if conversation is being debugged, say "//Conversation: making [target] unavailable (because its unrepeatable).";
		now tempfuse of target is 0;
		end if; ]
	if conversation is being debugged, say "// Conversation: making [target] unavailable.";
	now tempfuse of target is 0;
	remove target from list of convo stuff, if present.
 
After discussing a terminal beat (this is the trigger post-conversation processing after discussing a terminal beat rule): if conversation is being debugged, say "// Conversation: After discussing a terminal beat (pcp)."; post-conversation processing; continue the action.    

The last every turn rule (this is the look after convos end rule):
	if ( we are discussing a terminal beat or we are saying farewell to someone ) and Finishing-the-Prologue is complete and only-look-once is false and Epilogue is not happening: 
		try looking;  
		now only-look-once is true.   
 
Before reading a command (this is the reset only look once variable rule): now only-look-once is false.
only-look-once is a truth state that varies.
Check looking (this is the only look once rule): if only-look-once is true, do nothing instead; else continue the action.  
After looking (this is the after looking mark only look once as true rule): now only-look-once is true; continue the action. 

Definition: a beat is nonnow if it is available and its tempfuse is not its fuse and its fuse < 100.   
   
  
Section - Exhausting
 
Exhausting is an action applying to one thing. [ Exhausting happens when the NPC has nothing else to say about a given topic. ]  

Carry out exhausting: say "'I have nothing else to say about that,' [the random other person in the location] says." [ NPCs should replace this with a more personable message, preferable randomized. ]
 
After exhausting: 
	if conversation is being debugged, say "// Conversation: After exhausting.";	 
	if last beat suggests anything, try discussing a random beat suggested by last beat.          
     

  

  

Section - Getting Bored 

Getting bored is an action applying to one thing. Before getting bored when Finishing-The-Prologue is complete: if conversation is being debugged, say "// Conversation: before getting bored post-conversation processing [noun]."; post-conversation processing. [ An NPC gets bored if the player has not spoken for several turns. ]      [ we don't use silently saying farewell because that would print a duplicate farewell message.]   
   
Carry out getting bored: say "'Well, I've got to get back to this,' [the random other person in the location] says.".        

A person has a number called the boredom counter. The boredom counter of a person is usually 0.           
    
Section - Not Understanding

[ This is not a verb, as we always cause the conversation to fail at the parser level, not the NPC level. This prevents NPCs from professing ignorance over things the player expects them to know about. ]  

Rule for printing a parser error when parser error is did not make sense in this context and Finishing-The-Prologue is complete:   
	if a conversing person is enclosed by the location begin;
		let myinput be indexed text;  
		let myinput be the player's command;  
		replace the regular expression "discuss " in myinput with "";
		if myinput matches the regular expression "^(examine|x) " begin; say "Normally, you can just type an emphasized topic word alone to bring it up in conversation. If you need to, you can use the verb DISCUSS to differentiate, say, examining a person from asking them about themself." instead;
		otherwise if the number of words in myinput > 1; say "If you're trying to converse, it's best to stick with typing one single emphasized keyword." instead;
		otherwise; say "If you're trying to converse, make sure you're typing an emphasized keyword[one of]. [convohelp][or]. [convohelp][or]. [convohelp][or].[stopping]" instead; 
		end if;
	otherwise; say "[as the parser]You used either a verb or a keyword I don't recognize, at least not in that combination.[run paragraph on][as normal]"; 
	end if. 
	
To say convohelp: say "Type HELP, select 'Detailed Instructions' then 'More on Conversation' for more help interacting with people."



Section - Testing Commands
 
Auditing is an action out of world applying to nothing. Understand "audit" as auditing. Specific-auditing is an action out of world applying to one thing. Understand "audit [any beat]" as specific-auditing.

Check auditing: if a conversing person is not enclosed by the location, say "Nothing to audit.". 

Check specific-auditing: if noun is not a beat, say "You can only audit beats."

Carry out auditing:
	try specific-auditing last beat. 

Carry out specific-auditing:
	now temp-beat-list is { };  
	analyze noun with indentation 0;
	say "[line break]*: Terminal / %: Not in same thread as [noun] / &: suggests nothing / $: spoken.";
	let parent be a random thread enclosing noun;
	let xor be the list of beats in a random thread enclosing noun;
	remove temp-beat-list from xor;
	if the number of entries in xor > 0, say "[line break]Beats outside tree: [xor].";
	truncate xor to 0 entries;
	let xor be the list of keywordless beats in a random thread enclosing noun;
	if the number of entries in xor > 0, say "[line break]Beats w/o keyword names: [xor]".
	
Definition: a beat is printable-keyworded if its keyword name is not "". Definition: a beat is keywordless if its keyword name is "" and something summons it. Definition: a beat is keyworded if it is not keywordless.
 
[	
stop-loop is a number that varies. stop-loop is 0. loop-path is a list of objects that varies. 


To loop search with (parent - a list of objects):
	repeat with item running through parent begin;
		loop process item;
	end repeat.
]
[	
To loop process (item - a beat):
	if item is listed in loop-path begin;
		now stop-loop is 1;
		add item to loop-path;
		say "Endless replace loop found: [loop-path].";
	end if;
	if stop-loop is 1, stop;
	add item to loop-path;
[	if anything is enqueued by item begin;]
[		let Q be a random thing enqueued by item;
		loop process Q;]
[	end if;	]
[	if anything is enqueued by item, loop process a random thing enqueued by item;]
[	loop search with the list of things enqueued by item;]
[	add the list of things enqueued by item to newlist; ]
[	let newlist be the list of things enqueued by item;
	loop search with newlist;
	if the number of entries in newlist > 1 begin;
		now stop-loop is 1;
		say "Error: [item] enqueues more than 1 thing ([newlist]).";
	end if;]
[		now newlist is { };
	add every thing item replaces to newlist;
	loop search with newlist;
	if the number of entries in newlist > 1 begin;
		now stop-loop is 1;
		say "Error: [item] is replaced by more than 1 thing ([newlist]).";
	end if;
	now newlist is { };
	add every thing that item summons to newlist;
	if the number of entries in newlist > 0, loop search with newlist;]
	let N be the number of entries in loop-path;
	remove entry N from loop-path.
]

To say (N - a number) spaces: 
    repeat with index running from 1 to N 
    begin; 
        say " | ";  
    end repeat.

temp-beat-list is a list of objects that varies. 
	
[ [if anything replaces target](replaced by [a random beat that replaces target])[end if]]

To analyze (target - a beat) with indentation (indent - a number), indicating suggestion:
	say ( indent ) spaces;
	say "+ ";
	if indicating suggestion, say "(suggests) [run paragraph on]";
	if target is listed in temp-beat-list begin;
		say "[target][line break]";
		stop;
	end if; 
	while target is not last beat and target is spoken and something replaces target begin;
		say "[d]replacing [target]:[x]";
		now target is a random thing that replaces target;
	end while;
	if target is listed in temp-beat-list begin;
		say "[target][line break]";
		stop;
	end if;
	add target to temp-beat-list, if absent;
	let targettitle be "[target]" in upper case;
	say "[if target is terminal]*[end if][if number of things suggested by target is 0 and number of things enqueued by target is 0 and target is substantial and target is interstitial]&[o][end if][if a random thread enclosing target is not a random thread enclosing noun]%[o][end if][if target is spoken]$[d][end if][targettitle][x]";
	say ": [if target is repeatable](R)[end if][if number of things summoned by target > 0]summons [number of things summoned by target] beats [end if][run paragraph on]";
	let stop_flag be 0;  
	if a beat replaces target begin; 
		let Q be a random beat that replaces target;
		while Q is replaced by a beat and stop_flag is 0 begin;
			let replacer be a random beat that replaces Q;
			if replacer is target or a random beat enqueued by Q is target begin;   
				say "[o]ERROR: infinite replace loop.[x]";
				now stop_flag is 1;
			otherwise; 
				let Q be replacer;
			end if;  
		end while; 
	end if;
	if target is repeatable and target suggests a repeatable beat, say "[o]WARNING: repeatable suggests repeatable[x]";
	let stop_flag be 0; 
	if number of things enqueued by target > 0 begin;
		say " --> "; 
		let newtarget be a random thing enqueued by target;
		if newtarget is not listed in temp-beat-list, analyze newtarget with indentation indent;
		otherwise say "[newtarget][line break]";
	otherwise;    
		say "[line break]";    
	end if; 
	if indent < 10 begin;
		repeat with item running through things summoned by target begin;
			analyze item with indentation ( indent + 1 ) ;
		end repeat;
		if number of things suggested by target > 0 begin;
			analyze a random thing suggested by target with indentation ( indent + 1 ), indicating suggestion;  
		end if;
	otherwise;
		say ( indent + 1) * 4 spaces;
		if number of things summoned by target > 0, say "...[run paragraph on][number of things summoned by target] more[line break]";
	end if.




Chapter - Single Word Conversation


Conversation fuse is a number that varies. Conversation fuse is 0. [ This is reset to 0 each time we talk. Useful to ensure the NPCs don't talk over themselves or too often. ]    

overrule further dialog is a truth state that varies. 

Every turn when a attentive other person is enclosed by location (this is the checking if the NPC has anything else to say rule): 
	if conversation is being debugged, say "// Conversation: checking if the NPC has anything else to say rule (because Every turn when a attentive other person is enclosed by location ([list of attentive other people enclosed by location]). if last beat [last beat] suggests a beat ([a random beat suggested by last beat]) and ( conversation fuse is not 0 ([conversation fuse]) or actual last beat ([actual last beat]) is ephemeral ([if noun is ephemeral]true[otherwise]false[end if]) we'll continue.";
	if the last beat suggests a beat (called new target) and ( conversation fuse is not 0 or actual last beat is alb-qualified ) and overrule further dialog is false begin; 
		 if conversation is being debugged, say "// Conversation: found.";   
		force discuss new target;
	otherwise;
		 if conversation is being debugged, say "// Conversation: conditions not met.";  
		now overrule further dialog is false;
	end if.
	
Definition: a thing is alb-qualified if it is ephemeral and it is casual.	 
  


Chapter - Bookkeeping 
  
The conversation bookkeeping rule is listed after the checking if the NPC has anything else to say rule in the every turn rules.
  
last-spoken-turn is a number that varies.

This is the conversation bookkeeping rule: 
	if conversation is being debugged, say "// Conversation: conversation bookkeeping rule).";	
	if an attentive other person (called target) is enclosed by location begin;  
		if conversation is being debugged, say "// Conversation: CBR found something to do.";
		if conversation fuse is 0 begin; 
			now the boredom counter of target is 0; 
		otherwise;    
			if the number of exciting available beats is 0 begin;
				increase the boredom counter of target by 	1;
			otherwise;    
				let Q be a random exciting available beat;
				if conversation is being debugged, say "// Conversation: force discuss [Q] (because [target] is enclosed by location and [q] is exciting and available)."; 
				force discuss Q;  
			end if;   
		end if;   
		if the boredom counter of target >= 2 begin;
			try getting bored target; 
		end if; 
		if the number of available beats > 0 and actual last beat is not ephemeral and actual last beat is not dogged begin;
			if conversation is being debugged, say "// Conversation: subtracting 1 from tempfuse of [list of available beats].";
			repeat with subtarget running through available beats begin;
				decrease tempfuse of subtarget by 1; 
			end repeat;
		end if;
	otherwise if the number of attentive people > 0;
		post-conversation processing; 
	end if; 
	if conversation is being debugged begin;
		say "// Conversation: available beats are now ";
		repeat with trg running through available beats begin;
			say "[trg]:[tempfuse of trg], ";
		end repeat;
		say "; last beat is [last beat]; penultimate beat is [penultimate beat]; actual last beat is [actual last beat]";
	end if. 
	
The increase convo fuse rule is listed before the checking if the NPC has anything else to say rule in the every turn rules. This is the increase convo fuse rule: if last-spoken-turn is not turn count, increase conversation fuse by 1.


Chapter - Topics Line
	  
Before reading a command when Finishing-The-Prologue is complete (this is the show topics rule):
	if a conversing other person is enclosed by the location or the number of available on-topic beats > 0:
		if conversation is being debugged, say "// Conversation: show topics window because a conversing other person is enclosed by the location ([if a conversing other person is enclosed by the location][a random conversing other person enclosed by the location][else]no[end if]) or the number of available on-topic beats > 0 ([if the number of available on-topic beats > 0][the list of available on-topic beats][else]no[end if]).";
		if out-of-line keywords is 3:
			if player is awake, show topics; 
		otherwise if player is awake:
			if out-of-line keywords is 2, now the measurement of the topics-window is 5;
			otherwise now the measurement of the topics-window is 3;
			if topics-window is g-unpresent, open up topics-window;
			move focus to topics-window, clearing the window;
			show topics; 
			return to main screen; 
	otherwise:
		if topics-window is g-present:
			shut down topics-window;
			try looking. 

The drawing rule of topics-window is the draw topics window rule.
 
[ This ensures that we see the topics even after an undo.]
This is the draw topics window rule:  
	if player is awake:
		if topics-window is g-unpresent, open up topics-window;
		move focus to topics-window, clearing the window;
		show topics; 
		return to main screen.

showing-offtopics is a truth state that varies.

Understand "topics" or "topic" as topic-showing. Topic-showing is an action out of world applying to nothing. [ Provided as a complement to THINGS and EXITS.] 

Carry out topic-showing:
	if an attentive other person is enclosed by the location:
		show topics;
		say paragraph break;
	else:
		say "[as the parser]You're not talking to anyone right now.[as normal]". 

To show topics: 
	now nicename topics is true; 
	truncate toplist to 0 entries;
	if showing-offtopics is false begin;
		add list of available on-topic printable-keyworded beats to toplist;   
		sort toplist in reverse tempfuse order;
	otherwise; 
		add list of convo stuff to toplist;
	end if; 
	let orig be the number of entries in toplist; 
	truncate toplist to 6 entries;	  
	if number of entries in toplist > 0 or a conversing person is enclosed by the location or we are setting the keyword style, say "[if we are setting the keyword style and out-of-line keywords is 3][line break][end if][if out-of-line keywords is 3][end if]Topics: [if we are setting the keyword style]topic, this[otherwise if the number of entries in toplist is 0]listen[otherwise][toplist][end if][if orig > 6] (...)[run paragraph on][end if]"; 
	if we-are-keyword-setting is true begin;
		say "[line break]More information is often displayed here.";
		stop;
	else if out-of-line keywords < 3; say "[line break][if showing-offtopics is true]Or say [t]cancel[x] if you don't want to change the subject[otherwise]You can also say [nothingbit][t]goodbye[x][subjectbit][end if].[run paragraph on]";
	otherwise; say "[one of][line break]You can also say nothing, goodbye, or subject.[or][line break]You can also say nothing, goodbye, or subject.[or][line break][stopping]";
	end if; 
	if screen reader mode is true, say line break;
	now nicename topics is false. 
 
To say nothingbit: if the number of entries in toplist > 0, say "[t]nothing[x][if Progue is not attentive] or[else],[end if] ". 

To say subjectbit: if Progue is attentive and current episode is not Word Day and current episode is not Final Confrontation, say ", or change the [t]subject[x]".
   
Definition: a beat is on-topic if its tempfuse > 0 and its tempfuse < 100.  [ Beats which reference objects or concepts are given a fuse of 9999, meaning they stay relevant until recalled but will not show up in the standard list.]
	
toplist is a list of objects that varies.


Part - Episodes

[This extension was written mainly to be able to create kinds of scenes, functionality which was not yet possible with scenes at the time Blue Lacuna was first being written. Episodes have some advantages over scenes, such as the ability to be scheduled, but on the whole the functionality here is so Blue Lacuna-specific it didn't make sense to turn it into a standalone extension as I did with a lot of other BL-code.]

Chapter - Definitions

An episode is a kind of thing. [An episode is usually privately-named.] [Episode is the scene-equivalent. ]

The current episode is an episode that varies. The current episode is no-episode. The last episode is an episode that varies. The last episode is no-episode. no-episode is an episode. [Only one episode is running at a time.]

An episode is either one-shot or rerunnable. An episode is usually one-shot. [Episodes can either be one-time-only, or repeatable.]

[Episodic frequency is a kind of value. The episodic frequencies are ensured, likely, unlikely, and rare.] An episode has a frequency. An episode is usually common. [Ensured episodes always happen whenever they are considered. The subsequent adjectives define episodes which are decreasingly likely to be selected.]

Episodic type is a kind of value. The episodic types are rendezvous, urgent, serendipitous, or instant. An episode has an episodic type. An episode is usually serendipitous. [Episodic type specifies in general what happens when the episode begins. Rendezvous episodes involve Progue going to a certain place and waiting until the PC appears. Urgent episodes involve Progue tracking down the PC. Serendipitous episodes begin the next time they bump into each other. Instant episodes break the world model and instantly teleport Progue somewhere.]

An episode is either triggered or informal. An episode is usually informal. [Triggered episodes are checked on every turn to see if they go off. Informal episodes are only checked when the scene-daemon runs or it is time for excitement.]

An episode has a time called the expiration date. The expiration date of an episode is usually 23 hours. [Most episodes are not considered to have begun unless Progue begins the relevant conversation while they are current. If this has not happened after a certain amount of time, the episode will become expired. ]

Episodic status is a kind of value. The episodic statuses are successful, completed, failed, expired, running, and unaired. An episode has an episodic status. An episode is usually unaired. [ The state of an episode. The first three are various ways of keeping history on how episodes ended. ]

An episode has a beat called the subchange beat. The subchange beat of an episode is usually episode_subchange. An episode has a beat called the boredom beat. The boredom beat of an episode is usually episode_boredom. An episode has a beat called the bye beat. The bye beat of a episode is usually episode_bye. An episode has a beat called the abruptbye beat. The abruptbye beat is usually episode_abruptbye. [It's easy to forget the various ways a player can interfere with the flow of an episode (trying to change the subject, not speaking, saying goodbye, wandering off, or physically interacting with Progue), so we pre-define a bunch of default responses that should prevent episodes from getting off-track. Episodes can define more specific beats appropriate to the moment, or set one of these to "silence" to allow the normal behavior for the action to fire. NOTE: if we have episodes that prevent player leaving early or whatever, we MUST END THEM BY HAND, transition to a new episode, or change the various beats after a key moment; otherwise the player will never be able to end the conversation.]

An episode has a room called the meeting place. The meeting place of an episode is usually UnRoom. An episode has a beat called the icebreaker. The icebreaker of an episode is usually silence. [Some episodes begin at a certain spot, and most begin with Progue saying a certain beat.]

The episode schedule is a table-name that varies. The episode schedule is usually the Table of Off-Air. [This table lists all the episodes which it is presently okay to run, assuming their conditions are met.]

Table of Off-Air
eptitle
an episode
with 1 blank row

To decide whether an episode is playing:
	if current episode is no-episode, decide no;
	decide yes.

To decide whether no episode is playing:
	if current episode is no-episode, decide yes;
	decide no.

To normalize (ep - an episode):
	now the subchange beat of ep is silence;
	now the boredom beat of ep is silence;
	now the bye beat of ep is silence;
	now the abruptbye beat of ep is silence.



Chapter - Rulebooks

Section - Condition Rules

[Condition rules define when an episode can begin. If a rule fails, it will prevent the episode from running. At least one condition rule must succeed for the episode to be selected.]

Condition rules is an object-based rulebook.

[Rules implied by check episodes rule: only one episode at a time. ]

First condition for a frequent episode (this is the frequent episode rule):
	if a random chance of 1 in 2 succeeds and not time for excitement, rule fails.

First condition for a common episode (this is the common episode rule):
	if a random chance of 3 in 4 succeeds and not time for excitement, rule fails.

First condition for an uncommon episode (this is the uncommon episode rule):
	if a random chance of 5 in 6 succeeds and not time for excitement, rule fails.

First condition for an rare episode (this is the rare episode rule):
	if a random chance of 7 in 8 succeeds and not time for excitement, rule fails.

First condition for an superrare episode (this is the superrare episode rule):
	if a random chance of 15 in 16 succeeds and not time for excitement, rule fails.

First condition for an uberrare episode (this is the uberrare episode rule):
	if a random chance of 31 in 32 succeeds and not time for excitement, rule fails.

First condition for a singular episode (this is the singular episode rule):
	if a random chance of 63 in 64 succeeds and not time for excitement, rule fails.


[First condition for an episode (this is the no sleepwalking Progue rule): if the animus of Progue is resting, rule fails.

First condition for an episode (this is the no new episodes during conversation rule): if Progue is attentive, rule fails.

First condition for an episode (this is the don't overcommit Progue rule): if Progue has pending appointments, rule fails.

]

Section - Commencement Rules

[Commencement rules are run when the episode begins, usually to set things up.]

Commencement rules is an object-based rulebook.

Section - Finishing Rules

[Finishing rules for an episode are checked every turn it is running. If any finishing rule succeeds, the episode is completed.]

Finishing rules is an object-based rulebook.

Section - Completion Rules

[Completion rules are run when an episode is completed, usually to do clean-up.]

Completion rules is an object-based rulebook.


Chapter - Beginning and Ending

To begin (ep - an episode):
	if drama manager is being debugged, say "// Drama manager: beginning [ep].";
	now ep is running;
	now current episode is ep;
	unless an unimportant episode is playing, now last episode is current episode;
	consider the commencement rules for ep;
	the episode expires in the expiration date of ep from now.

To complete (ep - an episode), succeeding, failing:
	if drama manager is being debugged, say "// Drama manager: completing [ep].";
	if ep is running and ep is not expired, now ep is completed;
	if succeeding, now ep is successful;
	if failing, now ep is failed;
	consider the completion rules for ep;
	now current episode is no-episode;
	if ep is expired and icebreaker of ep is not silence and icebreaker of ep is not spoken: 
		now the episodic status of ep is unaired;
		if drama manager is being debugged, say "// Drama manager: [ep] expired without [icebreaker of ep] being spoken; resetting to unaired.";
	otherwise:
		if there is a eptitle of ep in episode schedule and ( icebreaker of ep is not silence and icebreaker of ep is not spoken ):
			if ep is one-shot:
				choose row with a eptitle of ep in episode schedule;
				blank out the whole row;
			sort episode schedule in random order.

At the time when the episode expires:
	if an episode is playing and Progue is idle:
		if drama manager is being debugged, say "// Drama Manager: episode [current episode] expires.";
		now current episode is expired;
		complete current episode;


Chapter - Processing

Every turn when the number of filled rows in episode schedule is at least 1  and current episode is no-episode (this is the check episodes rule):
	[can we modify this to prefer urgent episodes if time for excitement?]
	let casting be false;
	if scene-daemon is true or time for excitement:
		if drama manager is being debugged, say "// Drama manager: [if scene-daemon is true]scene daemon goes off[otherwise]time for excitement[end if], so checking episode schedule carefully."; 
		now casting is true;
		now scene-daemon is false;
		the daemon wakes in one hour from now;
	repeat through episode schedule:
		unless episodic status of eptitle entry is unaired or episodic status of eptitle entry is running or eptitle entry is rerunnable:
			blank out the whole row;
		otherwise if eptitle entry is triggered or casting is true:
			if drama manager is being debugged, say "**considering [eptitle entry]: [run paragraph on]";
			consider the condition rules for eptitle entry;
			if the rule succeeded:
				begin eptitle entry;
				break.

Every turn when an episode is playing (this is the watch for finish conditions rule):
	if drama manager is being debugged, say "// Drama manager: watch for finish conditions rule ([current episode]).";
	consider the finishing rules for current episode;
	if the rule succeeded:
		complete current episode.

Section - Meddling

[By default, we can't do things that would derail the conversation during an episode. By defining the various default beats associated to an episode to silence, we can allow them to take place.]

episode_subchange is a dogged repeatable beat with reaction "'Not now,' he says, 'we're in the middle of this.'".

Check vague discussing when an episode is playing and Progue is attentive and the subchange beat of current episode is not silence (this is the episodes overrule changing subject rule):
	[If there is nothing to discuss, we've broken the conversation; get out.]
	if the number of available unrepeatable beats is 0:
		let esc be the the escape clause of a random thing that encloses last beat;
		if esc is a beat and esc is not default_escape_clause:
			force discuss esc;
			stop the action;
		else:
			force discuss bye_beat of Progue;
			stop the action;
	otherwise:
		let line be the subchange beat of current episode;
		if line is spoken and line is unrepeatable and nothing replaces line:
			now subchange beat of current episode is silence;
		otherwise:
			increase derail_tracker by 1;
			extend beats;
			force discuss line;
			stop the action.

episode_boredom is an ephemeral repeatable beat with reaction "'Well?' he says, 'I'm waiting.'".

First before getting bored when an episode is playing and Progue is attentive and the boredom beat of current episode is not silence (this is the episodes overrule getting bored rule):
	[If there is nothing to discuss, we've broken the conversation; get out.]
	if the number of available unrepeatable beats is 0:
		let esc be the the escape clause of a random thing that encloses last beat;
		if esc is a beat and esc is not default_escape_clause:
			force discuss esc;
			stop the action;
		else:
			force discuss bye_beat of Progue;
			stop the action;
	otherwise:
		let line be the boredom beat of current episode;
		if line is spoken and line is unrepeatable and nothing replaces line:
			now boredom beat of current episode is silence;
		otherwise:
			increase derail_tracker by 1;
			extend beats;
			force discuss line;
			stop the action.

episode_bye is an ephemeral repeatable beat with reaction "'We're not through with this conversation yet,' he says.".

First before saying farewell to Progue when an episode is playing and Progue is attentive and the bye beat of current episode is not silence (this is the episodes overrule goodbye rule):
	[If there is nothing to discuss, we've broken the conversation; get out.]
	if the number of available unrepeatable beats is 0:
		let esc be the the escape clause of a random thing that encloses last beat;
		if esc is a beat and esc is not default_escape_clause:
			force discuss esc;
			stop the action;
		else:
			force discuss bye_beat of Progue;
			stop the action;
	[otherwise, explain why we can't stop talking.]
	let nextbit be the bye beat of current episode;[aar]
	if nextbit is a beat:
		if nextbit is spoken and nextbit is unrepeatable and nothing replaces nextbit:
			now bye beat of current episode is silence;
		otherwise:
			extend beats;
			increase derail_tracker by 1;
			force discuss nextbit;
			stop the action.

episode_abruptbye is an ephemeral repeatable beat with reaction "He grabs your arm. 'Don't go yet,' he says, 'we aren't finished here.'".

First before going or exiting or landmark-going when an episode is playing and Progue is attentive and the abruptbye beat of current episode is not silence (this is the episodes overrule movement rule):
	if we-are-landmark-going is true:
		tidy landmark-go;
		clean up landmark-go;
		now overrule further dialog is true;
		stop the action;
	otherwise:
		let line be the abruptbye beat of current episode;
		if line is spoken and line is unrepeatable and nothing replaces line:
			now abruptbye beat of current episode is silence;
		otherwise:
			increase derail_tracker by 1;
			extend beats;
			force discuss line;
			stop the action.

[If something in the conversation breaks, it can become impossible to end the convo, effectively derailing the entire game. This is always a bug; but to prevent it being a game-breaking bug, we allow the player to get out of the current situation if this occurs.]

derail_tracker is a number that varies. Every turn when Progue is idle and Progue is not enclosed by location: now derail_tracker is 0. 

Every turn when derail_tracker > 6:
	now the bye beat of current episode is silence;
	now the abruptbye beat of current episode is silence;
	now the subchange beat of current episode is silence;
	now the boredom beat of current episode is silence;
	let pthread be a random thing that encloses last beat;
	now derail_tracker is 0;
	if escape clause of pthread is not default_escape_clause and escape clause of pthread is unspoken:
		force discuss escape clause of pthread;
		post-conversation processing;
	else:
		force discuss bye_beat of Progue;
		post-conversation processing.


Chapter - Debugging

Epstatusing is an action out of world applying to nothing. Understand "epstatus" as epstatusing.

Carry out epstatusing:
	repeat through episode schedule:
		say "[if current episode is eptitle entry]**[end if][eptitle entry][line break]";
	say "****[current episode]****[paragraph break]";
	repeat through Table of Progue's Appointment Book:
		say "[date entry] - [event entry]".

Epbeginning is an action out of world applying to one thing. Understand "begin [any episode]" as epbeginning. Carry out epbeginning: say "Beginning [noun]."; begin noun.

Epending is an action out of world applying to nothing. Understand "complete" as epending. Carry out epending: say "Completing [current episode]."; complete current episode.

	
Part - Presentation

Section - Section Breaks 

[ Section breaks are used to indicate that an important transition or passage of time has happened, without a chapter change. ]

To print a section break: 
	reset the boredom meter with "new section or chapter";
	say paragraph break;
	say "*   *   *   *   *   *   *   *";
	say paragraph break.
  
To say section break: print a section break. 

Section - Chapters 

The current chapter is a number that varies. The current chapter is -1.   
 
The last chapter turn is a number that varies. The last chapter turn is -5.
  
To begin chapter (chap - a number):   
	unless current chapter is chap:
		now current chapter is chap;
		unless current chapter is 0, say "[line break]";  
		print a section break; 
		if current chapter is:
			-- 0: say "Prologue";
			-- 1: say "Chapter One";
			-- 2: say "Chapter Two";
			-- 3: say "Chapter Three";
			-- 4: say "Chapter Four";
			-- 5: say "Chapter Five";
			-- 6: say "Chapter Six";
			-- 7: say "Chapter Seven";
			-- 8: say "Chapter Eight";
			-- 9: say "Chapter Nine";
			-- 10: say "Chapter Ten";
			-- 11: say "Epilogue";
		print a section break;
		now last chapter turn is turn count;
		say "[paragraph break]".
	
[ To say chapadv: begin the next chapter.]



Chapter - Emphasized Keywords

out-of-line keywords is a number that varies. out-of-line keywords is 1. [ 1=2 line window, 2=4 line window, 3=Topics line ]

A printing-style is a kind of thing. Some printing-styles are defined by the Table of Lacuna Styles.

Table of Lacuna Styles
printing-style	output-style
object-word		2
direction-word	1
topic-word		3
parser-word		5

Table of User Styles (continued)
style name		fixed width		boldness	relative size	glulx color
special-style-1	proportional-font	bold-weight	0	g-pure-green
special-style-2	proportional-font	bold-weight	0	g-pure-blue
 
Table of Common Color Values (continued)
glulx color value		assigned number   
g-pure-green	3381555  [ green  ]
g-pure-blue		255	  

print-upper-case is a truth state that varies. print-upper-case is false.

The currently printing style is a printing-style that varies. 

we-are-keyword-printing is a truth state that varies. we-are-keyword-printing is false. we-are-parser-speaking is a truth state that varies. we-are-parser-speaking is false.  

To set the text style for (whichstyle - a printing-style):
	now we-are-keyword-printing is true;
	let val be the output-style of whichstyle;
	if val is 1 begin; say first custom style;
	otherwise if val is 2; say second custom style;
	otherwise if val is 3; say bold type;
	otherwise if val is 4; say fixed letter spacing;
	otherwise if val is 5; say italic type;
	[ otherwise if val is 5; say "*";
	otherwise if val is 6; say "_";
	otherwise if val is 7; say "[bracket]";]
	otherwise if val is 8; now print-upper-case is true;
	end if.
	
Before asking which do you mean: now asking-which is true. After asking which do you mean: now asking-which is false. asking-which is a truth state that varies.


Section - Screen Reader Mode

Screen reader mode is a truth state that varies. 

Setting screen reader mode is an action out of world. Understand "screenreader" as setting screen reader mode.
	
Carry out setting screen reader mode:
	if screen reader mode is true begin;
		now screen reader mode is false;
		say "Screen reader mode has been deactivated.";
	otherwise;
		now screen reader mode is true; 
		now out-of-line keywords is 3;
		say "Screen reader mode has been activated. Blue Lacuna uses emphasized keywords to indicate certain words. Your reader software may put a recognizable vocal stress on emphasized words like [o]this[x] one. If it doesn't, you can type the word 'things' from any prompt for a list of nearby objects, or type 'exits' for a list of nearby directions. During conversation, a list of relevant topics will be read automatically. Type keywords to adjust the style of keywords, or type screen reader with no space to toggle this mode on or off.";
	end if.

Section - Print Style Commands

To say o:
	unless asking-which is true or we are remembering, set the text style for object-word; 
	now the currently printing style is object-word.
	
To say t:
	set the text style for topic-word; 
	now the currently printing style is topic-word.  	      
 
To say d: 
	set the text style for direction-word;
	now the currently printing style is direction-word.  	  
	 
To say dc: if dir, say "[d]". To say dr: if not dir, say "[d]".

To say as the parser:
	now we-are-parser-speaking is true;
	if a random chance of 1 in 2 succeeds, be more bored with "parser speaking";
	set the text style for parser-word.
	 
To say as normal:
	now we-are-parser-speaking is false; 
	reset output-styles with parser-word.

To speak as the parser (str - some text): 
	say "[as the parser][str][as normal][line break]". 

Before printing a parser error: say "[as the parser]". After printing a parser error: say "[as normal][line break]". 
 
To say x:
	reset output-styles with currently printing style;
	
To reset output-styles with (whichstyle - a printing-style):
	if we-are-keyword-printing is true begin;
	now we-are-keyword-printing is false;
	let val be the output-style of whichstyle;
[ 	if ( out-of-line keywords > 0 or print-upper-case is true ) and whichstyle is not parser-word begin; say end-word with I6; say end-word-aftermath with I6; print line ( upper buffer limit of I6 ) of I6; end if; ]
	if val is 1 or val is 2 begin; say roman type;
	otherwise if val is 3; say roman type;
	otherwise if val is 4; say variable letter spacing;
	otherwise if val is 5; say roman type;
	[ otherwise if val is 5; say "*";
	otherwise if val is 6; say "_";
	otherwise if val is 7; say "[close bracket]";]
	otherwise if val is 8; now print-upper-case is false;
	end if;
	if we-are-parser-speaking is true, say as the parser;
	end if. 
           
To say i: say "[italic type]". To say r: say "[roman type]". 

To say north: say "[dc]north[x]". To say northeast: say "[dc]northeast[x]". To say east: say "[dc]east[x]". To say southeast: say "[dc]southeast[x]". To say south: say "[dc]south[x]". To say southwest:  say "[dc]southwest[x]". To say west: say "[dc]west[x]". To say northwest: say "[dc]northwest[x]". To say up: say "[d]up[x]". To say down: say "[d]down[x]". To say in: say "[d]in[x]". To say inside: say "[d]inside[x]". To say out: say "[d]out[x]". To say outside: say "[d]outside[x]".  

To say Cnorth: say "[dc]North[x]". To say Cnortheast: say "[dc]Northeast[x]". To say Ceast: say "[dc]East[x]". To say Csoutheast: say "[dc]Southeast[x]". To say Csouth: say "[dc]South[x]". To say Csouthwest: say "[dc]Southwest[x]". To say Cwest: say "[dc]West[x]". To say Cnorthwest: say "[dc]Northwest[x]".

Section - Setting the Keyword Style

Setting the keyword style is an action out of world applying to nothing. Understand "keyword" or "keywords" as setting the keyword style. 

 
Carry out setting the keyword style: 
	let mychar be 1;   
	now we-are-keyword-setting is true;
	while mychar is not 0 begin; 
	clear the screen;  
[	clear saved cache;]
	say "There are three types of emphasized keywords in Blue Lacuna. It is important that your interpreter program correctly displays all three with some form of emphasis. Type a number below to cycle through display options until you find one that displays clearly on your system.[paragraph break]";
	say "1) Emphasized [o]object[x] keywords currently look like [o]this[x].[line break]2) Emphasized [d]exit[x] keywords currently look like [d]this[x].[line break]"; say "3) Emphasized [t]topic[x] keywords currently look like [t]this[x].[paragraph break]";
	say "4) [as the parser]Messages from the parser currently display like this[as normal].[paragraph break]During conversation, topic keywords are normally shown in a small window at the bottom of the screen. If this window or its contents are not clearly visible, press 5 to try an alternate style.[paragraph break]5) Change the style of the topic window to [if out-of-line keywords is 1]a large window[else if out-of-line keywords is 2]display inline before the prompt[else]a small bottom window (default)[end if].";
	if output-style of object-word is 8 or output-style of direction-word is 8 or output-style of topic-word is 8, say "[line break]**A warning: The emphasized keywords are integral to Blue Lacuna's design. It may be difficult or impossible to know how to continue if emphasis is not visible.**[line break]";  
	if ( output-style of object-word is output-style of direction-word ) or ( output-style of object-word is output-style of topic-word ) or ( output-style of direction-word is output-style of topic-word ) , say "[line break]**A warning: it may at times be useful to be able to differentiate between the various kinds of keyword.**[line break]";
	say "[line break]Press 0 when you're finished here.[run paragraph on]";
	if out-of-line keywords < 3, follow the drawing rule of the topics-window; 
	if out-of-line keywords >= 3 begin;
		say line break; generate ool list; if screen reader mode is true, say "Press 0 to begin."; say paragraph break;
	end if;
	now mychar is single-character - 48;
	if mychar is 1 begin; advance style with object-word;
	otherwise if mychar is 2; advance style with direction-word;
	otherwise if mychar is 3; advance style with topic-word;
	otherwise if mychar is 4; advance style with parser-word;
	otherwise if mychar is 5; toggle ool;
	end if;
	end while;
[	clear saved cache; ]
	if topics-window is g-present, shut down topics-window; 
	now we-are-keyword-setting is false;
	if turn count <= 0 begin;
		follow the very-beginning rule;
	otherwise;
		clear the screen;
		if Prologue is happening, say manorwoman2;
		else try looking; 
	end if. 
	  
we-are-keyword-setting is a truth state that varies.

To generate ool list:
	if out-of-line keywords is 3, show topics.

Definition: a thing is mentionable if it is enclosed by location and ( it is a prop or it is a setpiece ) and it is not part of a thing and its printed name is not "".    

To toggle ool:   
	increase out-of-line keywords by 1;    
	if out-of-line keywords > 3, now out-of-line keywords is 1;
	if out-of-line keywords < 3 begin;
		if topics-window is g-present, shut down the topics-window;
		if out-of-line keywords is 2, now the measurement of the topics-window is 5;  
		otherwise now the measurement of the topics-window is 3;
		open up the topics-window;
		follow the drawing rule of the topics-window;
	otherwise;
		shut down the topics-window;
	end if.
	
Before reading a command while out-of-line keywords is 3 and a conversing person is not enclosed by location: [ say "*";] generate ool list. [ After reading a command while out-of-line keywords is 4:] [ say "%";][ clear saved cache.]

To advance style with (styl - a printing-style):
	increase the output-style of styl by 1;
	if the output-style of styl > 8, now the output-style of styl is 1;
	if the output-style of styl > 5, now the output-style of styl is 8.

To decide which number is single-character: (- (VM_KeyChar()) -).



Chapter - Improved Status Line 



showing-offtopics is a truth state that varies.

[To show topics: do nothing.]

Rule for constructing the status line when Finishing-The-Prologue is incomplete or location is regionally in Dreamlands or location is a flash-room: do nothing.    
	
Rule for constructing the status line when Finishing-The-Prologue is complete: 
	center "[if location is regionally in Lacuna]Lacuna[otherwise if The-Path-Of-Love is happening and location is not Old Tumble]Near Home[otherwise if location is regionally in Homeworld]The Tumble[otherwise if location is regionally in Treeworld]The Heart Of Forest[otherwise if location is regionally in Rebelworld]First City[otherwise]Somewhere Else[end if], [approximate time][if raining] Rainstorm[end if]  -  [if current chapter is 0]Prologue[otherwise if current chapter > 10]Epilogue[otherwise]Chapter [current chapter in words][end if]" at row 1;
	rule succeeds.    
	

Part - Inclusions

Volume -  Room Definitions (in Lacuna-Room-Definitions by Blue Lacuna)

Book - Room Definitions

Use authorial modesty.

Outdoors is a region. Beachfront and Tiderooms and North Island and West Forest and Frozen Hell and East Island and Rain Forest and Marshlands and High Altitude and Narrow Ravine and Volcanic Uplands and Secret Island are regions.

Beachfront and Tiderooms and North Island and West Forest and Frozen Hell and Volcanic Uplands and East Island and Rain Forest and Marshlands and High Altitude and Narrow Ravine and Secret Island are in Outdoors. Rim of Volcano and Chasm Edge and Crater Pond and Atop and Tidepools and Hot Springs and Saddle are in Outdoors.

South Beach is south of Center Beach, northwest of Fork, and northeast of Among the Boulders. Among the Boulders is south of Ocean Waters and northeast of Tidepools. Center Beach is west of Hut. Center Beach is south of North Beach. Hut is west of Back Room. North Beach is north of Center Beach. South Beach, Among the Boulders, Center Beach, and North Beach are in Beachfront. Lower Beach is in Outdoors.

Ocean Waters is west of Lower Beach, southwest of Lower Beach, and northwest of Lower Beach. Lower Beach is northwest of South Beach, west of Center Beach, north of Among the Boulders, and southwest of North Beach. Inside-Manta is inside from Lower Beach.

High Altitude is a Region. High Altitude is in Outdoors. Ledge is up from North Marsh. Cliffside is up from Ledge. Lawn is up from Cliffside. Cliffside is down from Lawn. Observatory Exterior is east of Lawn. Ledge, Cliffside, Lawn, and Observatory Exterior are in High Altitude.

Chairlift-Ride is a region in Outdoors. Chair-lift1, Chair-lift2, and Chair-lift3 are in Chairlift-Ride. 

Marshlands is a region. Marshlands is in Outdoors. West-Marsh is a room. East Marsh is east of West-Marsh. North Marsh is northeast of West-Marsh and north of East Marsh. West-Marsh, East Marsh, and North Marsh are in Marshlands.

Stumps is a room in North Island. Stumps is north of Rise. Stumps is southwest of West-Marsh. Stumps is southeast of Chairlift Base.

Rise is northwest of North Beach. Hot Springs is east of Rise. Stumps is north of Rise. Chairlift Base is northwest of Stumps. Rise, Stumps, and Chairlift Base are in North Island.

Jumble and Chasm Floor and Volcano Floor and Steam Vents and Cinder Cone are in Frozen Hell. Ocean Waters is in Tiderooms.

Volcano Slopes and Sloping Meadow are in Volcanic Uplands.

Top of Ravine and Ravine Floor are in Narrow Ravine.

Fork is west of Sloping Meadow and north of Big Tree. The rope ladder is down from Treehouse and up from Big Tree. Volcano Slopes is south of Big Tree. Rim of Volcano is southeast of Volcano Slopes. Fork and Big Tree and Treehouse are in West Forest.

Chasm Floor is southeast of Jumble, and northwest of Volcano Floor. Volcano Floor is northwest of Cinder Cone and northeast of Steam Vents. Steam Vents is west of Cinder Cone. Cinder Cone is north of Volcano Cave and outside from Volcano Cave. 

[These three invisible doors below are necessary to simulate our one complex door, which is essentiall movable between two exits (something the I7 world model doesn't allow.) Doing it this way means we don't have to adjust exits on the fly, which is good since that means pathfinding info can be cached rather than constantly recalculated.]

The chasm-ebridge is a closed unopenable undescribed door. It is privately-named. It is northeast of Chasm Edge and southwest of Rockslide. 

The chasm-wbridge is a open unopenable undescribed door. It is privately-named. It is east of Sloping Meadow and west of Chasm Edge.

The chasm-stairs is a closed unopenable undescribed door. It is privately-named. It is up from Chasm Floor and down from Chasm Edge.

Crater Pond is southeast of Rockslide. Grassy End is northwest of Hive Room. Hive Room is north from Rockslide. Hive Room is south of a room called Edge of Ravine. Hive Interior is up from Hive Room. Ravine Floor is down from Edge of Ravine. Top of Ravine is west of Ravine Floor. Water Cave is west of Top of Ravine and down from Top of Cave. Top of Cave is down from Saddle. Saddle is down from Atop. 

A rainforest-room is a kind of room. Forest1, Forest2, Forest3, Forest4, Forest5, Forest6, Forest7, Forest8, and Forest9 are rainforest-rooms. Forest1 is north of Forest2, west of Forest7 and northwest of Forest6. Forest2 is east of Hive and north of Forest5. Forest3 is southeast of Forest2. Northwest of Forest3 is nowhere. Forest3 is east of Forest5,northwest of Forest4, and west of Forest9. east of Forest3 is nowhere. north of Forest3 is Forest9. Southeast of Forest3 is nowhere. south of Forest3 is Forest4. north of Forest4 is nowhere. Crater Pond is southwest of Forest4. Northeast of Crater Pond is nowhere. Forest4 is southeast of Forest9. east of Forest4 is Forest9. Forest5 is north of Crater Pond. Forest6 is south of Forest7. Southeast of Forest6 is nowhere.  north of Forest1 is Edge of Ravine. Forest8 is south of Viewpoint,northeast of Forest7 and northeast of Forest9. Forest9 is southeast of Forest8.  Forest6 is northwest of Forest9. Southeast of Forest6 is nowhere. south of Forest9 is nowhere.

Backside is down from Egg Room. Egg Room is northeast of Forest3. Egg Interior is inside from Egg Room. Seal Beach is down from Backside.  Prison is north of Overhang. South of Prison is nowhere. Overhang is west of Prison. East of Overhang is nowhere. Mossy Ledge is east of Prison. West of Mossy Ledge is nowhere. Prison is north of Mossy Ledge. Overhang is south of Mossy Ledge. Mossy Ledge is south of Overhang. Echo Chamber is down from Overhang. Backside, Seal Beach, Overhang, Prison and Mossy Ledge are in Secret Island.

Progue's Domain is a region. Hut and Studio and Back Room are in Progue's Domain.

East Island is a region. Rockslide, Hive Room, Hive Interior, Grassy End, Edge of Ravine, and Viewpoint are in East Island.

Lacuna is a region. Outdoors and Progue's Domain and Volcano Cave and Top of Cave and Water Cave and Egg Interior and Inside-Manta and Echo Chamber are in Lacuna.

Studio, Hut, Back Room, Jumble, Treehouse, Volcano Cave, Echo Chamber, Water Cave, Egg Interior, Inside-Manta and Top of Cave are indoorsy.

Center Beach, Chairlift Base, Volcano Floor, Fork, Hive Room, East Marsh, Egg Room, and Overhang are landmarked.

 Homeworld is a region. Rebelworld is a region. Treeworld is a region.

To say surface-material:
	if location is regionally in Beachfront begin; say "sand";
	otherwise if location is regionally in Tiderooms; say "ocean floor";
	otherwise if location is regionally in Marshlands; say "marshy ground";
	otherwise if location is Rockslide; say "loose boulders";
	otherwise if location is Hive Room or location is Edge of Ravine or location is Viewpoint; say "dirt";
	otherwise if location is regionally in Rain Forest; say "forest underbrush";
	otherwise if location is Sloping Meadow or location is Crater Pond or location is Lawn or location is Observatory Exterior; say "grass";
	otherwise if location is regionally in Frozen Hell; say "lava rock";
	otherwise if location is Chasm Edge or location is Rise; say "lava rock";
	otherwise if location is Ledge; say "rock";
	otherwise; say "ground";
	end if.

Definition: a room is landed: if it is Ocean Waters, decide no; decide yes.

Chapter - Elevations

The elevation of Tidepools is 5 feet. The elevation of Among the Boulders is 10 feet. The elevation of North Beach is 12 feet. The elevation of Center Beach is 8 feet. The elevation of Ocean Waters is 0 feet. The elevation of Lower Beach is 2 feet. The elevation of South Beach is 12 feet. The elevation of Rise is 25 feet. The elevation of Hot Springs is 25 feet. The elevation of Stumps is 5 feet. The elevation of Chairlift Base is 11 feet. The elevation of West-Marsh is 4 feet. The elevation of East Marsh is 4 feet. The elevation of North Marsh is 4 feet. The elevation of Ledge is 100 feet. The elevation of Hut is 18 feet. The elevation of Studio is 19 feet. The elevation of Back Room is 19 feet. The elevation of Fork is 25 feet. The elevation of Sloping Meadow is 30 feet. The elevation of Big Tree is 30 feet. The elevation of Volcano Slopes is 30 feet. The elevation of Rim of Volcano is 100 feet. The elevation of Chasm Edge is 35 feet. The elevation of Jumble is 20 feet. The elevation of  Chasm Floor is 20 feet. The elevation of Volcano Floor is 20 feet. The elevation of Steam Vents is 20 feet. The elevation of Cinder Cone is 20 feet. The elevation of Volcano Cave is 15 feet. The elevation of Ravine Floor is 4 feet. The elevation of Top of Ravine is 12 feet. The elevation of Water Cave is 14 feet. The elevation of Top of Cave is 25 feet. The elevation of Saddle is 75 feet. The elevation of Atop is 110 feet. The elevation of Rockslide is 55 feet. The elevation of Hive Room is 45 feet. The elevation of Grassy End is 45 feet. The elevation of Edge of Ravine is 40 feet. The elevation of Viewpoint is 40 feet. The elevation of Crater Pond is 35 feet. The elevation of Treehouse is 35 feet. The elevation of Forest1 is 45 feet. The elevation of Forest2 is 45 feet. The elevation of Forest3 is 45 feet. The elevation of Forest4 is 45 feet. The elevation of Forest5 is 45 feet. The elevation of Forest6 is 45 feet. The elevation of Forest7 is 45 feet. The elevation of  Forest8 is 45 feet. The elevation of Forest9 is 45 feet. The elevation of Egg Room is 35 feet. The elevation of Backside is 22 feet. The elevation of Seal Beach is 15 feet. The elevation of Overhang is 15 feet. The elevation of Prison is 20 feet. The elevation of Mossy Ledge is 15 feet. The elevation of Echo Chamber is 3 feet. The elevation of Cliffside is 150 feet. The elevation of Lawn is 200 feet. The elevation of Observatory Exterior is 200 feet.



Volume - The Tumble (in Lacuna-Homeworld by Blue Lacuna)


Homeworld-Studio is a landmarked room. The landmark name of Homeworld-Studio is "the [d]studio[x]". Understand "studio" as Homeworld-Studio. The prose name of Homeworld-Studio is "your studio". Your Bedroom is a landmarked room. The landmark name of Your bedroom is "your [d]bedroom[x]". 

When play begins: now Homeworld-Studio is visited; change matches to seen; change lacuna-canvas to seen. [ This is all to avoid messages that don't make sense if this is someplace the PC is familiar with; the PC knows where the matches and canvas are and how to get to the studio.] 

First report going to Homeworld-Studio for the first time: say "(new [d]landmark[x] discovered)[command clarification break]"; now last landmark turn is turn count; continue the action. [ Manually trigger this since the Studio is "visited" already. ]

Rule for printing the name of a Homeworldish room (called area) while remembering: say "in [prose name of area]". Definition: a room is Homeworldish: if it is regionally in Homeworld, yes; no.

Carry out landmark-listing when location is regionally in Homeworld:
	if the number of visited landmarked rooms regionally in Homeworld is 0 begin;
		say "No landmarks have been discovered in this area.";
		stop;
	end if;
	say "The landmarks you can go to are: ";
	repeat with locale running through visited landmarked rooms regionally in Homeworld begin;
		say "[line break]  ";
		if the landmark name of locale is not "null", say the landmark name of locale; otherwise say locale;
		if locale is location, say " (you are here)";
	end repeat;
	say line break;
	if tutorial mode is switched on, say tutorial-landmarks2. 

Instead of listening when location is regionally in Homeworld: say "The wind that gusted so cold and fierce around the old timbers when you went to bed has vanished in the depths of night. [if location is Your Bedroom]Muffled sound of the banked fire[otherwise if fireplace is raging]The pops and cracks of the raging fire[otherwise]Faint crackling from the banked fire[end if] and the quiet murmur of the stream intrude only faintly on the silence[tutorial-typeverbs].".

Understand "reject/ignore/resist/fight/itch/scratch/stay" as "[scratch]". Understand "[scratch] call" or "[scratch] here" or "[scratch]" as a mistake ("[if The-Path-Of-Love is happening]Now that Rume is gone, there is nothing left for you here[else]You try to block the Call from your mind, but it whispers endlessly, a bottomless spring that teases, summons, beckons, pulls[end if].") when location is regionally in Homeworld. 

Part - The Prologue

Rule for printing the banner text when turn count < 2: do nothing. 

Before starting the virtual machine: change the left hand status line to ""; change the right hand status line to "".

Prologue is a scene. Prologue begins when play begins.  

Rule for printing the banner text when Prologue is happening and current chapter >= 0: do nothing instead.

Rule for writing a paragraph about Rume when Prologue is happening: do nothing. Rule for printing the name of a room when Prologue is happening: do nothing. Rule for printing room description details when Prologue is happening: do nothing. Every turn when Prologue is happening: ignore the room description body text rule. Every turn when Prologue is happening: ignore the room description paragraphs about objects rule.

The last when play begins (this is the setting up the Prologue rule):
	begin chapter 0;
	change the time of day to 12:37 AM;
	change the time factor to 1;
	now Rume is attentive;
	say "Waves.[paragraph break]Dreams move beneath you, blind colossi revolving through unknowable patterns, but they do not break the surface, not yet or any more. You float in void outside them, cold, memoryless.[paragraph break]Not true. You are a Wayfarer, and will always remember that.[paragraph break][one of][manorwoman1].[paragraph break][as the parser]Tutorial: Type emphasized keywords like MAN or WOMAN to advance the story. Type KEYWORDS if these words do not appear emphasized in the previous paragraph.[run paragraph on][as normal][or][manorwoman2].[stopping]";
	now tempfuse of pr_playermale is 50;
	now tempfuse of pr_playerfemale is 50;
	now tempfuse of pr_neither is 50;
	now last beat is pr_intro;
	now pr_intro is spoken.

P_convo is a thread. 

pr_intro is a beat in p_convo. Understand "man" or "male" as pr_playermale when last beat is pr_intro. Understand "woman" or "female" as pr_playerfemale when last beat is pr_intro. Instead of saying neither or saying both when last beat is pr_intro, force discuss pr_neither.

Pro_track is a number that varies. Pro_track is 1.
	
First instead of doing something other than ffing or discussing or saying both or saying neither when Prologue is happening and turn count >= 1 (this is the only the choice rule):
	say "[one of][or][manorwoman2][stopping]". [ We would just say "anything other than discussing" but that blocks our debug rules. ]

First Instead of getting bored when Prologue is happening (this is the don't get bored during Prologue rule) : do nothing instead. The don't get bored during Prologue rule is listed before the only the choice rule in the instead rules.

Rule for printing a parser error when Prologue is happening and turn count >= 1: say "[as normal][manorwoman2][run paragraph on]".


To say manorwoman1: say "But uneasiness rises within you. Lost, for strange moments you can not even remember if you are [one of][o]man[x] or [o]woman[x][or][o]woman[x] or [o]man[x][at random]".

To say manorwoman2: say "Before anything, you must remember: "; if last beat is pr_intro begin; say "are you [o]male[x] or [o]female[x]"; otherwise if last beat is pr_prologue_2; say "is the one you embrace a [o]man[x] or a [o]woman[x]"; otherwise; say "make [o]love[x] or make [o]art[x]"; end if; say "?".

Instead of saying neither or saying both when last beat is pr_intro or last beat is pr_prologue_2: force discuss pr_neither. Understand "unknown/genderqueer/trans/transgender/intergender" as pr_neither when last beat is pr_intro or last beat is pr_prologue_2. pr_neither is an ephemeral repeatable beat in p_convo with fuse 99 and reaction "You toy with this for long timeless moments, but it seems of all the realities you drift between, in the one you return to now the choice must be one or the other.". 

Before discussing pr_playermale: now player is male; continue the action. Before discussing pr_playerfemale: now player is female; continue the action.

pr_playermale is a beat in p_convo with fuse 99. pr_playermale enqueues pr_prologue_2. pr_playerfemale is a beat in p_convo with fuse 99. pr_playerfemale enqueues pr_prologue_2. 

pr_prologue_2 is a beat in p_convo with fuse 99 and reaction "Relief breaks against you, a deep ocean wave of reassurance. Of course. You are a wayfarer, and a [if player is female]wo[end if]man. The rest can wait till waking.

But already trickles of wake intrude, seeping into you. Warmth and softness, and the arms of another, embracing you. Another wave washes through, this one of dull desire; but again strange vertigo grips you, for you're not even sure if it's a [prpr2].". To say prpr2: say "[one of][o]man[x] or a [o]woman[x][or][o]woman[x] or a [o]man[x][in random order] your waking self holds in [if player is male]his[otherwise]her[end if] arms". pr_prologue_2 summons pr_lovermale, pr_loverfemale. Understand "man" or "male" as pr_lovermale when last beat is pr_prologue_2. Understand "woman" or "female" as pr_loverfemale when last beat is pr_prologue_2.

Before discussing pr_lovermale: now Rume is male; continue the action. Before discussing pr_loverfemale: now Rume is female; continue the action.

pr_lovermale is a beat in p_convo with fuse 99. pr_lovermale enqueues pr_prologue_3. pr_loverfemale is a beat in p_convo with fuse 99. pr_loverfemale enqueues pr_prologue_3.

pr_prologue_3 is a beat in p_convo with fuse 99 and reaction "It seems right the moment you think it, right and real, and you float together over dream seas, rays of light stretching down to blue infinitudes even as pinpricks of reality dissolve them away. Warm furs on bare skin, pine and woodsmoke, stream and fire, and Rume, your [if Rume is female]wo[end if]man, sleeping against you. Home, for now.

For now.

How many worlds have you moved through, wayfarer? Will you ever stop moving?

Rume stirs, the touch of [hisher] [if Rume is female]breast[otherwise]chest[end if] hot against you. You are both half-asleep or half-awake, only together forming a whole being with the promise of something pleasant and instinctual taking shape in its sleepy mind.

But another desire stirs in you, equally compelling. Dawn and sleep are distant now, and a blank canvas waits in your studio below. A sudden ache as strong or stronger as your first impulse thrills you with desire to paint, create, bring life and form to the images coalescing inside you, no matter the consequences. 

Beside you, Rume shifts again, edging closer, blood pulsing faster in [hisher] veins, and you must choose. Do you make [o]art[x], or make [o]love[x]?". pr_prologue_3 summons pr_love, pr_art, pr_both, pr_neither. Understand "love" as pr_love when last beat is pr_prologue_3. Understand "art" as pr_art when last beat is pr_prologue_3. Instead of saying both when last beat is pr_prologue_3, force discuss pr_both. Instead of saying neither when last beat is pr_prologue_3, force discuss pr_neither_choice.

pr_love is a terminal beat in p_convo with fuse 99 and reaction "The physical presence of the [if Rume is female]wo[end if]man beside you, [hisher] tangible power, dissolves away all other desires. You pull [himher] close.

[lovetext]. Worlds you've explored, loves you've known, lives beyond or behind this moment are all forgotten in the freedom of this now, this dim and burning now...

Afterwards. Breaths out of sync, pools of cool sweat beneath each fingertip. And something gradual begins to intrude on your cooling bliss, some delicate itch. And an odd feeling creeps upon you that things are about to change, a sense of waves receding, perhaps forever, something calling them home.

[callingbit].".

pr_art is a terminal beat in p_convo with fuse 99 and reaction "Gently you pull away from Rume, excitement of another kind rising inside you. Already in your mind you are mixing paints, gripping the wood of your brush, aching to bring the unfocused imagery swirling so powerfully in your head to life. Calling another world into being...

[callingbit]."

To say callingbit: say "Calling...

And in a heartbeat you know the feeling, recognize it. The Call.

The Call pulls wayfarers together across time and dimension. Unconscious, unexplained, yet crisp, real. And when a wayfarer hears it, [if player is female]s[end if]he knows another wayfarer is somewhere, somehow in trouble.

But Rume is not a wayfarer. And [heshe] cannot go with you.

You let long moments pass before you open your eyes".

[ pr_both is a terminal beat in p_convo with fuse 99 and reaction "A smile ghosts your lips. There are always alternatives. No world you've found has been black and white. You pull Rume close.

[lovetext]. [bothtext]
But afterwards, breaths out of sync, pools of cool sweat beneath each fingertip, something gradual force begins to intrude on your blissful nothingness; some delicate itch, and an odd feeling that things are about to change, that the waves are receding, perhaps forever, to reveal strange new landscapes, unexplored and dry.

You let a long moment pass, before you open your eyes.".][ I would have liked to have included this option, but it led to painful combinations of possibilities in the Epilogue, for a path that the vast majority would never see.]

To say lovetext: say "Waves. The remnants of dream fuse into this new reality without a seam. You roll together, riding peaks and troughs of infinite blue, gasps and vague portents and hot insights suffused in the power of the moment, in the hot breath in your ear, in the dandelion touches on delicate nerves". 

pr_neither_choice is an ephemeral repeatable beat in p_convo with fuse 99 and reaction "To retreat back into the peace and selflessness of the waves, to turn your back on the choice. Tempting. But these two new desires are both too strong for sleep to prevail.".

pr_both is an ephemeral repeatable beat in p_convo with fuse 99 and reaction "Tempting. You've always been one to reject false choices, to find hidden paths that others can't walk. But you are sleepy and strange now, and know this night you won't catch one without dropping the other. No. This night, this moment, you must choose between them.".

To decide whether we chose love: if pr_love is spoken, decide yes; decide no.

To decide whether we chose art: if pr_art is spoken, decide yes; decide no.

To decide whether we chose both: decide no.

Prologue ends when last beat is silence.

When Prologue ends:
	say section break;
	say banner text;
	now easel is in Homeworld-Studio;
	move the concept of Call to Homeworld;
	if we chose love, miss Rume;
	move the player to the bed, without printing a room description;
	begin chapter 1;
	now Rume is idle.


Part - Tutorial


To say tutorial-objects: if tutorial mode is switched on, say "[one of].[paragraph break][as the parser]Tutorial: Object keywords are [o]things[x] you can examine. Type an object keyword to learn more about that thing[as normal][or][stopping]".

To say tutorial-directions: if tutorial mode is switched on, say "[one of].[paragraph break][as the parser]Tutorial: [d]Exits[x] are the second type of emphasized keywords. Type an exit keyword to move from place to place[as normal][or][stopping]".

To say tutorial-lookreminder: if tutorial mode is switched on, say "[one of].[paragraph break][as the parser]Tutorial: If no keywords are visible, type LOOK or press enter to get a fresh description[as normal][or][stopping]".

To say tutorial-moredetails: if tutorial mode is switched on, say "[one of].[paragraph break][as the parser]Tutorial: Sometimes by examining things more closely, we learn about other objects we may not have noticed at first[as normal][or][stopping]".

To say tutorial-taking: if tutorial mode is switched on, say "[one of].[paragraph break][as the parser]Tutorial: Though you can take this lamp, most of the time you won't need to carry objects around with you. In fact, itâ€™s possible to finish the story without taking or dropping anything[as normal][or][stopping]".

To say tutorial-descriptions: if tutorial mode is switched on and The-Tumble is unvisited, say "[one of][or][or].[paragraph break][as the parser]Tutorial: Descriptions change as you progress through the story. Notice that 'get up' is now emphasized above. Type GET UP[as normal][or][stopping]". 

To say tutorial-consequences: if tutorial mode is switched on, say ".[paragraph break][as the parser]Some actions may have consequences. You won't be allowed to do anything that keeps the story from continuing, but you can alter its path, closing some doors and, perhaps, opening others[as normal]".

To say tutorial-saveundo: if tutorial mode is switched on, say "[one of].[paragraph break][as the parser]Tutorial: You can save your progress in the story by typing SAVE, and return to the same point later by typing RESTORE. If you ever want to 'take back a move,' you can type UNDO[as normal][or][stopping]".

After examining something when tutorial mode is switched on and The-Tumble is visited and Exploring Homeworld is happening: if ex-something is false and noun is not a person begin; now ex-something is true; say "[one of][as the parser]Tutorial: [tutorial-verbbit]You could try [if location is The-Tumble][tutshelfbit]READ BOOKS, TOUCH TRINKETS, or TAKE LAMP[else if location is Your Bedroom][ybnightstandbit]TOUCH MIRROR or DESTROY DRAWING[else if location is Kitchen]OPEN CUPBOARDS, TOUCH TABLE, or DRINK POOL[else]TOUCH FIRE or BURN STUDIES[end if].[as normal][or][stopping]"; end if. ex-something is a truth state that varies. To say tutorial-verbbit: say "[one of]By adding a verb before an object keyword, you can perform actions. [or][stopping]". To say tutshelfbit: if we have not examined tumble-shelves and we are not examining tumble-shelves, say "SHELVES, then ". To say ybnightstandbit: if we have not examined nightstand and we are not examining nightstand, say "NIGHTSTAND, then ".

To say tutorial-typeverbs: if tutorial mode is switched on, say "[one of].[paragraph break][as the parser]Tutorial: You can type HELP to see a list of other verbs the story understands. The help menu also offers more detailed instructions and information about the story[as normal][or][stopping]".

To say tutorial-kitchen: if tutorial mode is switched on, say "[one of].[paragraph break][as the parser]Tutorial: [tutorial-verbbit]Not all verbs require keywords. You might try to SIT, SWIM, or LISTEN[as normal][or][stopping]".

To say tutorial-studio: if tutorial mode is switched on, say "[one of].[paragraph break][as the parser]Tutorial: Type LANDMARK to see a list of important areas you've discovered[as normal][or][stopping]".

To say tutorial-landmarks2: if tutorial mode is switched on, say "[one of][line break][as the parser]Tutorial:  Type one of the listed direction keywords to quickly return to that area.[as normal][or][stopping]".

The last-time-looked is a number that varies. look-ctr is a number that varies. look-ctr is 6.

Every turn when tutorial mode is switched on and location is regionally in Homeworld:
	if we are looking or we are going or we are exiting or we are getting off something or we are landmark-going or we are discussing or player-looking is true, now last-time-looked is turn count;
	if turn count - last-time-looked > look-ctr:
		unless an attentive person is enclosed by location, increase look-ctr by 1;
		now last-time-looked is turn count;
		say "[tutorial-lookreminder2].".

To say tutorial-lookreminder2: if tutorial mode is switched on, say "[as the parser]Tutorial: [one of]I[or]Remember, i[stopping]f you don't see any new keywords on screen, you can type LOOK or press enter[as normal]".

To say tutorial-cellar: if tutorial mode is switched on, say "[one of].[paragraph break][as the parser]Tutorial: Careful observation and problem-solving unlocks new parts of the story. Congratulations on reaching this area[as normal][or][stopping]".

To say tutorial-lastchance: if tutorial mode is switched on, say "[one of].[paragraph break][as the parser]Tutorial: Signs of hesitation often indicate you are about to do something that will change or advance the story. Make sure you really want to proceed, then repeat your command[as normal][or][stopping]".

To say tutorial-conversation: say "[as the parser][one of]Topic keywords are the final type you'll encounter. Type a [t]topic[x] keyword to talk about the subject that word implies[or]A window below the prompt opens during conversations, showing all keywords currently available. Sometimes words appear there that weren't said by another character, like answers to a question[or]Old keywords disappear as the conversation moves on. Keep your eye on the topic window to know what can still be discussed[tutconvodone][stopping][as normal]". tut-convo-done is a truth state that varies. To say tutconvodone: now tut-convo-done is true.

After discussing when Rume-Conversation is happening and tutorial mode is switched on and rc_greet is spoken and tutconvtg is 0 and tut-convo-done is false:
	now tutconvtg is 1;
	say "[as the parser][one of]Tutorial: [tutorial-conversation].[or]Tutorial: [tutorial-conversation].[or]Tutorial: [tutorial-conversation].[or][stopping][as normal]";
	continue the action.

After reading a command: now tutconvtg is 0. tutconvtg is a number that varies. [ Prevents multiple "discuss" actions from triggering multiple tutorial messages.]

To say tutorial-listening: if 1 is 2, say "[line break][as the parser]Tutorial: To let time pass without taking any action, type WAIT or LISTEN, which can often be useful in conversations.[as normal]".

Every turn when Progue is enclosed by location and location is regionally in Lacuna and tutorial mode is switched on and the psyche of Progue is denial and no episode is playing and Progue is idle: say "[one of][as the parser]Tutorial: Type HELLO to start talking to someone, or GOODBYE to stop.[as normal][or][stopping]".

tut3 is a truth state that varies. After discussing when the psyche of Progue is denial and tutorial mode is switched on and current episode is not Word Day and tutconvtg is 0 and tut3 is false and a random other nonbestial person enclosed by the location is attentive and an unimportant episode is playing:
	now tut3 is true;
	now tutconvtg is 1;
	say "[one of][as the parser]Tutorial: In some conversations, you can type SUBJECT to talk about other things you've recently seen or heard about. The topics window will show you the extra keywords.[as normal][or][stopping]";
	continue the action. 

After greeting Progue for at least the third time:
	if the psyche of Progue is denial and tutorial mode is switched on and current episode is not Word Day and tutconvtg is 0:
		now tutconvtg is 1;
		say "[one of][as the parser]Tutorial: You can also perform some actions during conversations. In order from least kind to most, these are ATTACK, PUSH, HUG, and KISS.[as normal][or][stopping]";
	continue the action.

After asking which do you mean: if tutorial mode is switched on and the number of attentive people enclosed by the location is 0 and disambiguation_flag is false, say "[one of][line break][as the parser]Tutorial: If something you type might refer to more than one thing, type a number like 1 or 2 and press enter to confirm your intent, or type a new command instead.[as normal][or][stopping]".

To say tutorial-distantpeople: if tutorial mode is switched on, say "[one of].[paragraph break][as the parser]Tutorial: You can use exit keywords to approach distant people, or the APPROACH verb to move one area closer to them[as normal][or][stopping]".


Part - Exploring The Tumble (Chapter 1)

Exploring Homeworld is a scene. Exploring Homeworld begins when Prologue ends. Exploring Homeworld ends when Rume-Conversation begins.

Chapter - Your Bedroom

Your Bedroom is a room. The bed is an enterable supporter in Your Bedroom. The description of the bed is "Posts and headboard scuffed and worn, the bed was the only piece of furniture here when you found this place. Enormous, and far too large to fit through the doorway, you expect it will remain here long after you do.".

Bedroom-stuff is stuff in Your Bedroom. Understand "long/loft" as Bedroom-stuff when location is Your Bedroom.

Instead of examining yourself when Finishing-The-Prologue is complete and Finishing-The-Painting is unsolved:
	if The-Path-of-Love is happening, say "You're older, slower, and achier now than you were when you first came to the Tumble. But also wiser, calmer, and happier." instead;
	else say "You are the one constant in your life, and even you change. [if mirror is enclosed by location and we have examined mirror]Studying your sleepy eyes, you[otherwise]You[end if] wonder what happened to the terrified [if player is male]boy[otherwise]girl[end if] who first painted [if player is male]his[otherwise]her[end if] way into another world, the brave teenager eager for a life of adventure, the bitter young [if player is female]wo[end if]man first touched by pain. Perhaps they still exist, somewhere in those worlds you left behind, trapped forever in amber." instead.

Instead of sleeping when location is regionally in Homeworld, say "You are too keyed up for sleep: the Call itches at your mind.".

The concept of the Call is a backdrop. The description is "[one of]It is an itch in the mind, a tug on your soul. It means that when next you wayfare, what you paint and where you go will not be entirely up to you. Some other wayfarer is pulling you closer. Someone in need.[paragraph break]You've only felt it once before, at least consciously. When you answered you found a dark, razed world where a lonely little girl was stranded. She had a gift like your own, but didn't understand it, and thought she was crazy for believing in it. You stayed with her a month, helped her survive and learn to want survival, to gain strength to sing to more peaceful worlds.[paragraph break]Yes, you remember now. Her gift was song, fragile with heartache, but the clearest, purest thing you've ever known, or ever will.[paragraph break]Did she call you to her? Did some hidden part of yourself reach through infinities to feel her suffering? Or does some power run through all universes, bringing you together in times of need? You don't know. But now the Call has come again[or]The Call pulls you, an infinitely long string attached to your mind that trembles, tickles, urges you to [d]paint[x] the image you feel forming in your mind, still unclear, though you know it will coalesce the instant your brush touches canvas[stopping].".

Homeworld is a region. Your Bedroom is a room in Homeworld. The printed name is "Loft". The bed is an enterable undescribed supporter in Your Bedroom. The prose name of Your Bedroom is "the loft".

The homeworld-accoutrements are a backdrop with printed name "lodge". They are in Homeworld. Understand "wall/walls/floor/roof/ceiling/beam/beams" as homeworld-accoutrements. The description is "Sturdy wood that has stood for many winters and should stand many more.". Instead of climbing or touching homeworld-accoutrements: say "The wooden beams are cold now, the warmth of day slowly sucked away by the cold night beyond.".

Rume is an undescribed person on the bed. Understand "love/lover/girlfriend/boyfriend/wife/husband" as Rume when location is regionally in Homeworld and Finishing-The-Prologue is complete. Rume is asleep.

Understand "soft" or "warm" as Rume. Rume has a number called awake-examined. The awake-examined of Rume is 0. Instead of burning Rume, try attacking Rume. Check attacking Rume: say "It comes upon you at times, surprising and frightful, in odd dreams or curious moments of the day. You have no conscious desire to hurt Rume, this [if Rume is female]wo[end if]man you've loved maybe more than any other in your life, but still, at times, some cold fury rises within you, some bitterness, some anger. Maybe it's the red core of your gift, jealous, knowing that to choose Rume means abandoning it forever, ceasing to wayfare.[paragraph break]But no. The feeling fades. You have larger realms to wander tonight than pettiness." instead.

Instead of kissing or tasting Rume when Exploring Homeworld is happening, say "[if we chose love or we chose both]Already Rume has drifted back to sleep, but you're[else]Rume drifts in deep sleep, but you're[end if] more awake than you've been in a year. You kiss [hisher] cheek, hand lingering on [hisher] warm shoulder. You'll come back to say goodbye, if... or before."

Instead of hugging or touching Rume when Rume is asleep, say "You wrap your arms around Rume for long moments, feeding off the heat of [hisher] deep sleep, but [if we chose love]now that you've fed one need, the other[else]you've already chosen. The need to paint[end if] grows deeper and deeper inside you. The Call beckons, itches. You must answer.".

Instead of waking Rume when Rume is asleep: say "[CHeShe] [if we chose love or we chose both]has already fallen asleep again[else]still sleeps[end if], so deep and complete that for the moment you can't imagine [himher] awake again[if we chose love or we chose both], a faint smile still lingering on [hisher] lips[otherwise], the twinges of desire from moments ago vanished into dreams when you slipped away[end if]. You'll come back to say goodbye, if... or before.". Instead of greeting Rume when Rume is asleep, try waking Rume.

The description of Rume is "[if Rume is asleep][Rumeasleepdesc][otherwise if the number of spoken terminal beats in RC > 0]Already the shadow of the doorway half-conceals [himher], as if [hisher] reality already begins to fray.[otherwise]Wrapped in light cloth despite the lingering chill, Rume regards you steadily with no hint of sleepiness. Pale blue smoke rises from [hisher] sikar, nearly smoked down.[setRumeflag][end if]".

To say Rumeasleepdesc: say "[CHisHer] features are only just distinct in the dim and flickering firelight. A year. You've known [himher] a year now, and [heshe] looks the same as the day you met, in the dazzling light of a high and snow-scraped cirque. A life spent exploring this alpine world has infused winter into Rume's face; [hisher] nordic cheekbones, bleached hair, and ruddy cheeks hint at coldness, but the warmth of [hisher] touch, [hisher] laugh, [hisher] soul, dominates. There is fire in [hisher] sea-blue eyes, and from the moment you met [himher] it burned in yours too.

Now, three months after this mountain cabin became your shared home, you see other things in Rume's face as well. You know what it looks like in anger, in pride, in guilt. You can imagine now as you never could before how that face will age, the lines along which youth and energy will drain until one day only a dry mask remains, faded and cold. In your life you have seen death, but not aging. Never aging.

But now?

No matter how many final decisions you've made, no matter how many times you've put the question behind you for good, it still lingers. Could you truly give up your gift, the magic heart of your soul, to grow old here with Rume, on this world of kind people but cold and bitter winds? Could you really never know the breeze of another world again, the tang and rush of new reality? You have always been a wayfarer. Who would you be if you let that go?

You look away, at last, as if from the sun. The questions burn too deep[tutorial-lookreminder].".


To say setRumeflag: now the awake-examined of Rume is 1.

The description of Your Bedroom is "[ybeddesc].".

To say ybeddesc:
	if Prologue is happening begin;
		say "[run paragraph on]";
	otherwise;
		say "[if player is not on bed]The bare floorboards at your feet are cold as you stand in the long loft,[else]Firelight trickles through the open doorway into this long loft, seeps deep into[end if] huge wooden beams strung with pine [o]boughs[x] angling above your head";
		if player is on bed, say ". You lie in the warmth of your bed, buffered from the air's winter chill by layers of warm [o]furs[x][one of][or][or], but anxious to [d]get up[x][stopping]";
		say ".[paragraph break][if player is on bed]Next to you[else]In your bed[end if] lies [o]Rume[x], breathing quietly, [if we chose love or we chose both]already asleep again[else]asleep[end if]. Beside [if player is not on bed]your bed[else]you[end if] sits a simple [o]nightstand[x]";
		if player is not on bed, say ".[paragraph break][exits][tutorial-directions]";
		else say "[tutorial-objects]";
		if player is on bed, say "[tutorial-descriptions]";
	end if. 

The exits text of Your Bedroom is "Faint red firelight gutters through the open [dr]doorway[x]". Understand "door/doorway/balcony" as west when location is Your Bedroom. 

Some furs are a prop on the bed. Understand "fur" as furs. The description is "Brown and black, thick with the heavy warmth once needed by creatures who slept through long mountain winters.". Instead of taking furs, say "It's chilly, but Rume snuggles beneath them, and needs them more than you now.". Instead of touching furs, say "The thick furs are soft and warm; without them, nights here would be unbearable.".

Some refracted firelight is a minor setpiece in Your Bedroom. Understand "fire" or "fire light" as refracted firelight. The description is "The remnants of last night's fire down on the lodge's main floor are mostly shadow now, but in the black of night provide just enough light to see by.". 

The simple nightstand is an undescribed supporter in Your Bedroom. The description is "Made simply from unfinished pine, it has the naked functionality and unexpected beauty that marks everything made by Rume's hands. Atop it rests a framed [o]drawing[x] and a small round [o]mirror[x][tutorial-moredetails].". 

A small round mirror is a prop on the nightstand. The description is "The brass stand and edging is adorned with simple repeated patterns like everything the craftsfolk of this mountainous country put hand to. Inside the dark circle you see only your own [o]reflection[x].". Understand "reflection" as yourself. Instead of attacking small round mirror, say "You'd wake Rume.". Check touching small round mirror: say "The mirrored surface is cold and smooth." instead.

The framed drawing is a prop on the nightstand. Understand "sketch/hand/hands" as framed drawing. The description is "Set in a wide frame of grey stone, Rume gave you this pencil sketch some weeks ago. [CHeShe] had rarely drawn before, which to you makes the sketch even more remarkable: [if player is male and Rume is male]two masculine sinewy hands, entwined, but the difference between yours and Rume's clear[otherwise if player is female and Rume is female]two gracefully feminine hands, entwined, but the difference between yours and Rume's clear[otherwise]your graceful artist's hand and Rume's calloused and practical one, entwined[end if]. Though crudely drawn it has as much power in it as anything you have painted, and the intensity of everything Rume creates.[paragraph break]In darker moments, you cannot help but see the strength with which Rume's hand clutches yours in the drawing. In darker moments, you wonder whether your hand is trying to pull away.". Instead of attacking framed drawing, say "It seems a petty thing to do to something given in kindness.". Instead of touching framed drawing, say "The paper is rich and textured, the graphite marks smooth grooves.".

The bathrobe is an undescribed wearable thing in Your Bedroom. The printed name is "simple robe". Understand "robe" as bathrobe. The description is "Simple, but it keeps you warm.". Instead of taking off bathrobe, say "You shiver at the thought. Winter seeps relentless through the walls of the lodge.". Before wearing bathrobe when player is on bed: try exiting instead.  

[ New players often try to get dressed or look for clothes at this point, so we gamely accommodate them with an otherwise undescribed bathrobe object.]
  
Vague dressing is an action applying to nothing. Understand "dress" or "get dressed" or "wear clothes" or "put on clothes" as vague dressing. Check vague dressing: if bathrobe is not worn by the player and homemade outfit is not worn by the player and location is regionally in Homeworld, say "A simple robe waits for you beside your bed." instead. Check vague dressing: if ( yourself wears bathrobe and location is not Old-Tumble-Cellar ) or yourself wears homemade outfit, say "You are already dressed." instead. Carry out vague dressing: try wearing homemade outfit.

Vague undressing is an action applying to nothing. Understand "undress" or "take off clothes" or "get naked" as vague undressing. Carry out vague undressing: repeat with article running through things worn by player begin; try taking off article; end repeat.     

The pine boughs are a setpiece in Your Bedroom. Understand "bough/tree/branch/branches/pine" as pine boughs when location is Your Bedroom. The description is "Arranged gracefully across the slanted ceiling, the pine boughs infuse the room with the scent of the forest outside, while somehow making this mostly empty space seem whole. Rume's work again: undeniably right, but you'd have never thought to do it.". Instead of touching boughs, say "The needles are crisp and still sharp as you raise a hand and run your fingers idly through them, redolent with the tactile essence of the forest.". Instead of taking or pulling boughs, say "This is not the time to redecorate.". Instead of smelling boughs, say "The scent of the fresh pine boughs blends with the muted smells of the old logs of the lodge to produce some comfortable mixture of the wild and civilization.".

The wooden ceiling beams are a setpiece in Your Bedroom. Understand "wood" or "roof" as beams. The description is "The four large beams, cores of once mighty pines, slant upwards above you to create this long angled room. The wood is old but solid, placed long before you came here by some unknown master builder." Instead of touching beams, say "The surface of the wood is smooth and chill. Ancient ripples wend and warp across the rounded surface.".

Report getting off bed: say "Careful not to disturb Rume, you slip out from under the warmth of the furs into the chilly air[if player had not been wearing bathrobe], quickly wrapping a robe around yourself[end if]."; try looking instead. After getting off bed: now the player is wearing the bathrobe; continue the action. First check going up when location is Your Bedroom and player is on bed: try getting off bed instead.

Instead of saying farewell to when location is Your Bedroom, try kissing Rume.

Report going from Your Bedroom to The-Tumble: say "You pass through the open doorway, old floorboards creaking comfortably under your feet, into the light and open space of the rest of the lodge.". 

Chapter - Balcony

The-Tumble is a room in Homeworld. The printed name is "The Tumble, On the Balcony". The-Tumble is west of Your Bedroom. The description of The-Tumble is "[thetumbledesc].". To say thetumbledesc: say "The [o]balcony[x] overlooks the roomy interior of the lodge, running the length of one wall covered in [o]shelves[x]. Beneath your feet, the chattering [o]stream[x] that named this place emerges from its bed under the loft, tumbling down the exposed rock face to the main floor below.[paragraph break][exits].[paragraph break]Only the glow of the fire below is reflected in the black skylights slanting above you. It must still be very early[tutorial-saveundo]". The exits text of The-Tumble is "Stairs parallel the stream's journey [down] to the kitchen, and an open [d]doorway[x] leads back into the dark interior of the loft". Understand "loft" or "doorway" or "bedroom" as east when location is The-Tumble. The prose name of The-Tumble is "the balcony". Understand "kitchen" as down when location is The-Tumble.

Tumble-stuff is stuff in The-Tumble. Understand "roomy/interior/lodge/length" as Tumble-stuff when location is The-Tumble.

Some tumble-shelves are a undescribed supporter in The-Tumble. Understand "shelf/shelves" as tumble-shelves. The printed name is "shelves". The description is "The shelves are still mostly empty, waiting to creak under the weight of years of occupation: a few [o]books[x], some rocks and pine cones and other [o]trinkets[x] of nature[if oil lamp is on tumble-shelves]. An oil [o]lamp[x] rests on one corner[end if][tutorial-moredetails].". Instead of climbing or entering tumble-shelves: say "They wouldn't hold your weight." instead. Check taking tumble-shelves: say "Nailed with firm and sturdy supports to the wall." instead.

Some tumble-books are a prop on tumble-shelves. The printed name is "books". Understand "book/books" as tumble-books. The description is "A few leather-bound journals; smudgy reprints of distant travelers['] tales; fraying tomes with peeling binding on trapper medicine, wilderness cooking, alpine survival.". Instead of reading or opening tumble-books, say "You've spent long hours curled by the fire exploring these volumes, most of which have haunted this old shelf since long before you came here. But now, you're too keyed up to read.". Check touching tumble-books: say "Some have fine leather bindings, but most are cheap and shoddy, rough cardboard covers and itchy twine harsh under your fingertips." instead. Check taking tumble-books: say "You pick up one worn volume, a grey and practical manual on canning preserves and salting meat for winter, and trace your fingers across its age-stained surface. But your mind is too filled with images to focus on words. You return the book to its shelf." instead. Check smelling tumble-books: say "You flip through one yellowing volume, holding it close to your face, and the musty smell of aging paper wafts out at you." instead.

Some trinkets are a prop on tumble-shelves. Understand "pine/cones/cone/rock/rocks" as trinkets. The description is "You toy delicately with the pine cones, smooth or strange stones, and shells or fossils that Rume has brought back from [if Rume is female]her[else]his[end if] wanderings, till your fingers touch one fractured half of a small crude statue, thumb-sized, idols of an ancient people that often turn up near riverbeds and caves here.[paragraph break]Fractured. You remember Rume smashing it against the ground, face twisted in anger. Your first real argument, and so soon. So soon. Maybe you made a mistake in staying. Or [if Rume is female]s[end if]he did.". Check touching trinkets: say "You touch your fingers gently to a delicate pine cone. You and Rume both remember through touch, and as you close your eyes you walk again through the forest outside the thick walls of the Tumble." instead. Check taking trinkets: say "They belong here. And none are made by your hand, so none will go with you, when you leave." instead.

The oil lamp is a portable undescribed prop on the tumble-shelves. Understand "lantern/flame/wick/hood/base/brass/weave/simple/glass" as oil lamp. The description is "The civilization of this alpine world is simpler than some, but graceful elegance permeates the people here, grace you find somehow comforting. This simple lamp is a perfect example, in the dignified curves of its glass hood, the polished sheen of the brass base, even the delicate weave of its wick.". First report taking the oil lamp: say "You pick up the [if lamp is unlit]unlit[otherwise]lit[end if] lamp gently[tutorial-taking]." instead. Instead of touching oil lamp, say "The smooth brass is [if lamp is unlit]cold[otherwise]warm[end if] to the touch, the glass smooth and clean.". Instead of burning the oil lamp: try switching on the oil lamp. Check dropping oil lamp when location is not The-Tumble: say "There isn't a good spot to put it down here." instead. First report dropping the oil lamp: if location is The-Tumble, move oil lamp to tumble-shelves; say "You set it back down on the shelf." instead. Understand "light [the oil lamp]" or "strike [oil lamp]" as switching on. Understand "douse [oil lamp]" or "put out [oil lamp]" as switching off. Instead of switching off oil lamp: say "[if lamp is lit]You douse the flame and the lamplight dies[otherwise]The lamp is not lit[end if]."; now oil lamp is unlit. Instead of switching on oil lamp when matches are not enclosed by location: say "You'll need matches to do that." Instead of switching on oil lamp: say "[if lamp is unlit]You strike a match and light the lamp's wick from the tall yellow flame. Soon the lamp emits a ghost-pale light[otherwise]The lamp is already lit[end if]."; now oil lamp is lit. Instead of attacking oil lamp: remove oil lamp from play; move smashed-lamp to location; say "In sudden rage, you smash the lamp against the ground, watching its delicate glass splinter and crumble, smelling the oil within as it seeps into the floorboards. What use is delicacy, workmanship, reliability to you? Each time you wayfare you must begin again. Always[tutorial-consequences].". The smashed-lamp is a minor setpiece with printed name "smashed lamp". Understand "lamp/smashed/glass/oil/lantern/wreckage" as smashed-lamp when smashed-lamp is on-stage. The description of smashed-lamp is "Only wreckage now, useless.".

The stream is an undescribed backdrop. It is in The-Tumble, Kitchen and Homeworld-Studio. Understand "water" or "tumbling" or "chattering" or "oddity" or "mountains" as stream. The description is "The lodge is built around the stream, its centerpiece and soul, so much so that the old trapper who left it to you named the place the Tumble[if location is The-Tumble]. The ice-cold mountain water flows beneath the loft, then dances its way down the exposed natural rock face separating the upper level from the lower. It pools in a rock pond at the base of the stairs, then flows through a sculpted streambed that bisects the great boards of the main floor. Near the front door it escapes through a drain to continue its journey down the mountain outside your walls[otherwise]. The mountain stream pools near the base of the stairs, then ambles across the floor of the lodge, neatly dividing the studio from the kitchen. Two flattened stones cross over it before it disappears into a bed of loose rock and continues on its way down the mountain[end if].". Instead of touching the stream, say "The water comes from the high plateaus and glacier-carved cirques of the mountains above you, only a trickle this late in the season. You dip your hand into it for a moment and relish its pure, fresh bite, an icy knife of silk." Instead of tasting or taking the stream, say "You cup your hands and scoop up a few mouthfuls of the ice cold mountain water. Shockingly pure cold and clarity runs down your throat to your core, and you feel more awake." Instead of swimming in stream, say "The small pool at the base of the stairs is good for washing up or soaking your feet, but too small for swimming." Understand "wash in stream" or "wash up" or "wash hands" or "wash" or "wash me" or "soak feet" or "soak feet in pool" or "soak feet in stream" or "wash feet" as a mistake ("You wash quickly in the knife-cold water. In a few minutes you are cleaner and more awake.") when location is The-Tumble or location is Homeworld-Studio or location is Kitchen. Understand "soak feet" or "soak feet in pool" as a mistake ("You sit by the side of the stream, dangling your feet in the icy water for a few minutes, but the cold and the growing urge of the Call soon grow too strong to resist.") when location is The-Tumble or location is Homeworld-Studio or location is Kitchen. Instead of crossing or leaping stream when location is Kitchen: try going north. Instead of crossing or leaping stream when location is Homeworld-Studio: try going south. Instead of crossing or leaping stream when location is The-Tumble: say "The stream passes underneath the balcony; you'll have to go [d]down[x] the stairs before you can cross it.".

Instead of jumping when location is The-Tumble, say "Taking the [o]stairs[x] might be an easier way [d]down[x].". Instead of taking the homeworld-stairs, try entering homeworld-stairs.

Instead of entering stream: try swimming in stream.

Instead of jumping when location is Homeworld-Studio or location is Kitchen, try entering stream.

The skylights are an undescribed backdrop. They are in The-Tumble, Homeworld-Studio, and Kitchen. Understand "window" or "windows" or "skylight" or "long" or "slanted" as skylights. The description is "During the day these long, slanted skylights let in sun and beautiful views of pines, mountains, and the long slope down to the valley below. Now only darkness sleeps behind their frosted surface.". Instead of touching or pushing or opening the skylights, say "You cannot reach them."

The balcony is an undescribed backdrop. It is in The-Tumble and Homeworld-Studio. The description is "The balcony runs above and alongside the studio and kitchen, an extension of the loft and separated from it by a simple partition. A wooden railing guards the drop, topped by lacquered branches, gnarled and ancient, and the stairs follow the stream [down] to the ground floor below.".

The wooden railing is an undescribed backdrop. It is in The-Tumble and Homeworld-Studio. Understand "lacquered" or "branches" or "branch" or "gnarled" or "ancient" as railing. The description is "Simple but sturdy.".

The homeworld-stairs are an undescribed backdrop. Understand "flight" or "wooden" or "stair" or "stairs" or "staircase" as homeworld-stairs. They are in The-Tumble and Kitchen. The printed name is "stairs". The description is "The flight of broad wooden stairs curves gently then straightens again as it descends, echoing the natural twist of the exposed rock alongside.". Instead of entering or using or taking or climbing homeworld-stairs: if location is The-Tumble, try going down; otherwise try going up. Instead of touching homeworld-stairs, say "Your feet and Rume's are just the most recent to have further worn the subtle smoothness near the center of each stair."


Chapter - Studio

Homeworld-Studio is a room in Homeworld with printed name "Studio". Understand "studio" as Homeworld-Studio. Kitchen is down from The-Tumble. The description of Homeworld-Studio is "[homestuddesc].". To say homestuddesc: say "Your art has claimed this side of the main floor; paint-spattered canvas twists crumpled underfoot, palettes and buckets and brushes stacked and strewn between them. [if abstract paintings are on-stage]Abstract [o]studies[x] lie in piles where you've abandoned them, except a few Rume has saved and pinned to the wall. [end if]The [o]fire[x] [if fireplace is banked]burns low, painting the interior of the lodge with dull heat and molten glow[otherwise]rages, flooding the room with yellow-orange light, driving away the chill[end if].[paragraph break][easelbit][rumehwbit].[paragraph break][exits][tutorial-studio]". The exits text of Homeworld-Studio is "The solid front [d]door[x] is shut tight against the frigid night air. Opposite the fire, a few flat stones lead [d]across[x] the stream to the kitchen". Understand "kitchen" as south when location is Homeworld-Studio. To say rumehwbit: say "[if Rume-Conversation is happening and Rume is on-stage].[paragraph break][o]Rume[x] stands on the balcony above, smoking and watching you quietly[end if]". [aar]

HStudio-stuff is stuff in Homeworld-Studio. Understand "space/lodge/wooden/spattered/palette/palettes/bucket/buckets/interior/dull/molten/glow" as HStudio-stuff when location is Homeworld-Studio.

The fireplace is an undescribed backdrop. It is in Homeworld-Studio and Kitchen and The-Tumble. Understand "fire" or "flames" or "heap" or "glowing" or "embers" as fireplace. The description is "The fireplace extends on a large, semicircular platform into the lodge[if location is Homeworld-Studio], the wide curving hearth around it strewn with rugs and pairs of drying winter [o]boots[x]. [firedetails]. A bundle of [o]matches[x] rests on the mantel.".  Instead of touching the fireplace, say "You hold your hands out to the [if fireplace is banked]glowing embers[otherwise]hot flames[end if] and feel warmth seep into them." Understand "put out fire" as a mistake ("The fire is all that separates this house from the cold and the dark.").

The fireplace is either banked or raging. The fireplace is banked. Understand "bank up [something]" or "build up [something]" or "stoke [something]" or "make [fireplace]" or "light [fireplace]" or "feed [fireplace]" or "bank [something]" as burning. To say firedetails: say "[if fireplace is banked]The fire has been banked down to a heap of glowing embers, heating even this large space through the long night, and providing a glow bright enough to see by[otherwise]The fire burns hotly, logs blazing in the heat and encircled by swirls of ember[end if]". Instead of burning fireplace: if fireplace is raging begin; say "The fire is already built up into a raging blaze."; otherwise; now fireplace is raging; say "You pull some heavy logs from the stack, open the mesh grating, and position them carefully over the glowing embers. After a few minutes work with the brass poker, you have built the fire into a raging blaze, filling the lodge with light and warmth."; end if. The brass poker is a prop in Homeworld-Studio. Instead of taking the poker, try burning fireplace. [ There's really no point to all this, but it's another way of hinting to players that they can affect the world.]

Some matches are an undescribed prop in Homeworld-Studio. The description is "A small pile of matches and a starting stone.". Understand "match/box/stone/bundle" as matches. Understand "strike [matches]" or "light [matches]" as burning. Instead of burning or switching on matches when lamp is enclosed by location, try switching on lamp. Instead of burning or using matches, say "You strike a match, and watch its tall yellow flame till it burns down to your fingers and vanishes.".  Check touching matches: say "Splintery sticks." instead. Check taking matches: try burning matches instead.

The hearth is a minor setpiece in Homeworld-Studio. The description is "The worn brick is radiating heat."

Some rugs are a minor setpiece in Homeworld-Studio. The description is "Soft and warm."

Some firewood is a prop in Homeworld-Studio. Understand "heaping" or "stack" or "wood" or "logs" or "fire wood" or "stack of firewood" as firewood. The description is "Each of the heavy logs is thick enough to burn for hours, even in your large fireplace.". Instead of taking, burning, putting or using firewood, try burning fireplace.

Some pairs of winter boots are a prop in Homeworld-Studio. Understand "boot" or "shoe" as boots. The description is "Nearly dry and ready for another day breaking snowbanks.". Instead of taking or wearing boots, say "Somewhere inside you prickles a feeling. You won't need them where you're going.". Instead of touching boots, say "Cured and hardened leather, worn smooth at the ankles, and soft otter-skin lining, still damp.". Check smelling boots: say "They'll have to sit a lot longer in front of the fire before you're willing to do that." instead.

The flattened stones are an undescribed backdrop. Understand "stone" as flattened stones. They are in Kitchen and Homeworld-Studio. The description is "Their tops, sheared perfectly flat, rise just above the gurgling surface of the stream." Instead of touching stones, say "Worn smooth." Instead of entering or crossing or leaping or using stones: if location is Kitchen, try going north; otherwise try going south. 

Understand "cross/across" as south when location is Homeworld-Studio. Understand "cross/across" as north when location is Kitchen.

Some abstract paintings are a setpiece in Homeworld-Studio. Understand "studies/pile/piles/few/pinned" as abstract paintings. The description is "Not studies in the sense of a student hoping to learn, but of a master surveying his domain in satisfaction and reflection. For you are a master. There's no ego or pride involved; it's simply true. You couldn't wayfare if you were otherwise.[paragraph break]The studies are as meaningless as muscles twitching before sleep, and you wish Rume wouldn't hang them like this. All they do is remind you that [if Rume is female]s[end if]he doesn't understand, never will. All they remind you of are things you'd rather forget.". Instead of burning abstract paintings: say "Gathering up the loose canvases and sheets of paper, you feed them one by one into the fire. The copper smell of burning paint fills the lodge as the paintings vanish in smoke. Like you have, so many times before."; remove abstract paintings from play. Instead of taking abstract paintings: say "Useless.".

Some paintbrushes are an undescribed prop in Homeworld-Studio. The description of some paintbrushes is "You scarcely notice them, other than as extensions of yourself.". Instead of taking or using the paintbrushes: try painting lacuna-canvas. Understand "brush" or "paint brush" or "brushes" or "paint brushes" or "paintbrush" as paintbrushes. Check painting some paintbrushes: try painting lacuna-canvas instead.                                       

The lacuna-canvas is an undescribed setpiece in Homeworld-Studio with printed name "canvas". Understand "canvas" or "painting" or "tree9/yellow/flower/flowers" or "art" or "drawing" or "picture" as the lacuna-canvas when location is regionally in Homeworld. The lacuna-canvas can be unbegun, mostly finished, almost finished, or finished. The lacuna-canvas is unbegun.        

An easel is an undescribed setpiece. To say easelbit: say "[if lacuna-canvas is unbegun]A wide blank [o]canvas[x] stands on an easel in the center of the studio, space cleared around it like the eye of a storm[otherwise if The-Path-Of-Love is happening]In the center of the room, alone on its easel, your [o]painting[x] waits,  again[otherwise]Your [o]painting[x] of a strange, withered tree is almost complete, almost real[end if]".

The description of the lacuna-canvas is "[lccanvasdesc].". To say lccanvasdesc: if lacuna-canvas is unbegun begin; say "The cream-white canvas is pulled taut as a drum, achingly empty. There's nothing magical about its fibers, of course, no strange alchemical mixture in your paints, no glamor in your simple [o]brushes[x]. You wayfare because of you: the act of painting simply helps your mind, your being to define the world you'll become part of. Each of the billion decisions you make as you paint, of texture, tone, pressure, position, size, helps winnow the spiraling infinitudes down to the single one that becomes your new reality.[paragraph break]The painting itself, the one you leave behind, is merely a painting. But always a masterwork.[paragraph break]As your fingers near canvas, the [o]Call[x] pulls strongly on your mind. The image you must paint burbles in your mind, almost clear"; otherwise if The-Path-Of-Love is happening; say "Its immediacy tingles your pores with cold pinpricks. The morning light streams through the door and seeps into the colors, expands them with vibrant life. But the painting is wrong now. The tree you painted twenty years ago has grown, not on your canvas but on the world it exists, and you see, almost feel it with sudden shocking clarity: branches thickened, new leaves sprouted; the hillside behind has become more overgrown; the wisps of clouds in the sky of your canvas are from a different season than the one that now breathes through the lemon-yellow leaves. You know this all in a sudden shock of gnosis, like an unexpected wave smacking and submerging you. And your fingertips tingle and long to make the tree right. To make it real again.[paragraph break][otextra][pflag1]"; otherwise; say "You've painted a tree. Strange, like nothing that might have come from your own mind. Lemon-yellow leaves surround a withered trunk wrapped in vine; through holes in the branches you can see the sea[pflag1]"; end if. lc_painting_flag is a number that varies. lc_painting_flag is 0. To say pflag1: now lc_painting_flag is 1. Instead of taking the lacuna-canvas, say "The canvas will not move. Only you will." Instead of touching lacuna-canvas, say "[if lacuna-canvas is unbegun][lc-unbegun][otherwise]You rub a miniscule correction into a patch of sky. The wet paint feels electric under your fingertips, like carbonated mud.[end if]". To say lc-unbegun: say "The white surface feels [if we chose love]rough and coarse to you tonight[otherwise]smooth, the texture thrilling, almost erotic in its infinite possibility[end if].". Instead of attacking or burning lacuna-canvas, say "You toy with the thought briefly, like a child on the edge of a cliff getting rushes from vertigo. But you are a wayfarer, and you could no more destroy this canvas than cut off your own thumb.". Instead of smelling lacuna-canvas, say "[if unbegun]It smells clean and fresh[otherwise]The smell of wet paint is intoxicating[end if].".

Check wayfaring when location is Homeworld-Studio: try vague painting instead.

Every turn when lacuna-canvas is almost finished and lacuna-canvas is enclosed by location and a random chance of 1 in 6 succeeds, say "The canvas arcs with potential energy, yearning for [d]paint[x]; only a few more strokes of your brush and it will be complete.". [ People seem to get stuck at the end; this gives a little push.]

Check painting lacuna-canvas: try vague painting instead.

paint-check is a number that varies. First instead of vague painting when lacuna-canvas is enclosed by the location and paint-check is 0: now paint-check is 1; say "You hesitate long moments, fear and excitement trembling your fingertips as they hover just above your brushes. The [o]Call[x] whispers in your mind, teasing, wondering if you are ready to answer it[tutorial-lastchance].".

Instead of vague painting when lacuna-canvas is enclosed by location:
	if lacuna-canvas is unbegun begin;
		now paintbrushes are carried by the player;
		if we chose art or we chose both, say "A queasy tremor of thrill and fear runs within you. Carefully, you [if player holds the oil lamp]set the oil lamp on a shelf, [end if][if fireplace is banked]build up the fire, flooding the room with heat and warm light, and [end if][if the player is not wearing outfit]retrieve your worn, threadbare traveling clothes from the cellar. As you slip into them their touch is like an old lover swum back to you, fighting improbable currents of memory. You [end if]gather palette, brushes, and colors, vague ticklings behind your mind coalescing now into a scene more vivid than the world before you. As you touch brush to canvas, something like ecstasy fills you as its textured white expanse is violated by a shocking streak of lemon-yellow. You realize in a flash that your choice earlier was predestined. You've always chosen art before love, because for you they are merged in one entity, merged but unequal, your muse always winning out in battles with your heart";
		otherwise	say "Awkwardly, you [if player holds the oil lamp]set the oil lamp on a shelf and [end if][if fireplace is banked]struggle to build up the fire, finally producing a blaze that floods the room with heat and light. That done, you [end if][if the player is not wearing outfit]retrieve your threadbare traveling clothes from the cellar and pull them on. You [end if]fumble for palette and brushes, knocking your shins on the easel. The smell of Rume still lingers in the air, clings invisibly to your body, as if your earlier choice of love now thwarts your fingers and intentions with delicate jealousy. A hesitancy seems to cloud your mind; though the Call seems inevitable, some sage part of you knows it is not, that you could abandon it and go back to bed and live out a happy life here in the mountains[if children are possible] until unborn children bury you both behind the garden[end if]. You pause for a long moment before the blank canvas, brush in hand, a droplet of thick lemon-yellow quivering at the tips of bristles. Then, with a sigh, you press the brush against the cloth";
		now the player wears outfit;
		if player holds the oil lamp, move oil lamp to Homeworld-Studio;
		remove bathrobe from play;
		now the fireplace is raging;
		remove the concept of the Call from play;
		say ".[paragraph break]There is none of the deliberate experimentation, the careful decisions that come with your usual work: this time, the scene already exists in your mind's eye, formed by the Call. All you have to do is make it real.[paragraph break]There is no sense of time, but hours must pass.[paragraph break]By the time you force yourself to step back for a moment, to pull away from the [o]painting[x], the intensity of the world you are already half a part of, you are almost finished";
		say "[if we chose love or we chose both]. You can't leave Rume like this; there must be explanations, and pain, and goodbyes. But as you turn to head up the stairs you see [o]Rume[x] already stands[else]. You look up, and notice [o]Rume[x][end if] on the landing above, smoking and watching you silently.[paragraph break]And you know at a glance [if Rume is female]s[end if]he understands. [if Rume is female]She[else]He[end if] cannot come with you.";
		now the lacuna-canvas is mostly finished;
		[ triggers Rume-Conversation ]
	otherwise if lacuna-canvas is mostly finished and The-Path-Of-Love is happening;
		say "There's no reason to wait. You've nothing to pack, no one to say goodbye to, nothing to arrange. [if player does not wear homemade outfit]Pulling your old traveling clothes down from the wall, y[else]Y[end if]ou approach the canvas hesitantly. For long moments you stand there, arranging and rearranging your paints, afraid perhaps to begin. But inevitably, you do.[paragraph break]The paints are supple and clear as ever. You thicken branches, reposition leaves, change the patterns in the sky-- all to make it right again, to make it real. When it's almost finished, and you step back to say your final goodbyes to this world. Only a touch more [d]paint[x] and it will be complete.";
		now lacuna-canvas is almost finished;
	otherwise if lacuna-canvas is mostly finished;
		say "You touch some imperceptible details into the [o]canvas[x], smudging and clarifying and coaxing until-- there-- it is almost done. [paragraph break]A change seems to come over the lodge, perhaps over yourself. You are a brush stroke away from the point of no return; from never seeing this house or the fire or the snow-capped mountains outside again[if Rume is enclosed by location].[paragraph break]From the balcony above, Rume leans forward, hands tight on the rail as if afraid of being torn from it, and you cannot bring [hisher] face into focus. Some electric potential dances in the air, some enormous weight balanced on a tipping point, ready to tumble[end if].";
		now lacuna-canvas is almost finished;		
	otherwise;
		say "You trace a final line on your canvas, and you are somewhere else.[paragraph break]It's smaller than you expected, the tree. But the wrinkled grey-white trunk, the sinuous branches with their gaping holes, are just what you painted, details between the bristles, between the molecules of paint, brought from neural twitchings to physical reality, again.[paragraph break]Turning your head, you take your first breath in this world.";
		now lacuna-canvas is finished;
		[ ends Rume-Conversation ]
	end if.

Report going from The-Tumble to Kitchen: say "You descend the curved staircase silently, following the stream as it tumbles down the slope, touching the polished wood of the banister more for comfort than balance.". Report going from The-Tumble to Your Bedroom: say "You slip quietly back into the bedroom.".

Report going from Homeworld-Studio to Kitchen: say "You step lightly over the flat stones crossing the stream." Report going from Kitchen to Homeworld-Studio: say "You step lightly over the flat stones crossing the stream." Report going from Kitchen to The-Tumble: say "You climb the stairs up to the balcony again."

Chapter - Kitchen

Kitchen is a room in Homeworld. Kitchen is south of Homeworld-Studio. The description of Kitchen is "[kitchendesc].". To say kitchendesc: say "The spacious main floor of the lodge is divided into two halves by the stream running through its center. This side is for practical things: flat countertops and spacious pine [o]cupboards[x] and a clatter of hanging pots, pans, and skewers. Rugged chairs at a small round [o]table[x] overlook the stream's tiny [o]pool[x][rumehwbit].[paragraph break][exits][tutorial-kitchen]". The exits text of Kitchen is "A slanted [d]trapdoor[x] leads to the cellar, opposite the path [d]across[x] the stream, while the staircase curves [up] to the balcony". Understand "across" or "studio" as north when location is Kitchen. The prose name of Kitchen is "the kitchen". 

Kitchen-stuff is stuff in Kitchen. Understand "lodge/halves/center/side/practical/half" as Kitchen-stuff when location is Kitchen.

A slanted trapdoor is down from Kitchen and up from Old-Tumble-Cellar. A slanted trapdoor is a door. It is closed and undescribed. Understand "cellar" as trapdoor. Understand "bring matches to cellar" or "take matches to cellar" as a mistake ("Bare matches would blow out in the drafty air down there."). 

First check opening slanted trapdoor: if Rume is attentive, say "Not while Rume is still talking. You owe [if Rume is male]him[else]her[end if] that, at least." instead; if player is not holding lamp or lamp is unlit, say "You swing the trapdoor open, but the darkness is impenetrable, and a draft of cold air billows up. You carefully latch it shut again." instead.
Check going down in Kitchen when trapdoor is closed: try opening trapdoor; if trapdoor is closed, stop the action.
Instead of examining trapdoor, try going down.
Report going from Kitchen to Old-Tumble-Cellar: say "Holding the lamp steady, you descend carefully into the frigid chill and dark of the cellar.".
Report opening trapdoor: say "You swing the groaning old trapdoor open." instead.

The front door is a setpiece in Homeworld-Studio. The description is "[one of]You swing the heavy oaken door open, pulling swirls of ice-cold air with it, and step out for a moment onto the small porch. [paragraph break]The smell of pines and indistinct snowdrifts peppered with cones and needles surround you. Above the piercing clarity of the stars shine in a cloudless sky. You stare up at them, lungs shivering in the knife-cold air, your companions through this lifelong sojourn of worlds. Not specific stars, not the changing constellations from world to world, but the stars as a whole, ever-present, fused through your life into one metacosmic night sky. [paragraph break]But you're not dressed for cold. Leaving breath crystals quivering in the air, you retreat back into warmth and shut the door[or]There's nothing out there in the cold for you tonight[stopping].". Instead of opening or going or entering or using the front door, try examining the front door. First Instead of exiting when location is Homeworld-Studio: try examining the front door. First instead of going outside when location is Homeworld-Studio: try examining the front door.

Some flat countertops are a setpiece in Kitchen. The description is "Tiny stains, nicks, and grooves speak to the many meals that have been prepared here, stretching back well before you and Rume called this place home."

Some spacious pine cupboards are an undescribed container in Kitchen. They are fixed in place. Understand "cupboard" as cupboards. Instead of opening cupboards, try examining cupboards. The description is "[one of]You swing a cupboard open and the redolent smell of wood and seasonings spills out. The cupboards are full of the minutiae of life on the edge of the alpine wilderness: jars of dried herbs and spice, coarse-woven bags of salt, sugar, and flour, decanters of oil, bins of venison and fish jerky, huge glass jars of pickled vegetables, piled bulbs of garlic.[paragraph break]You are struck suddenly with bitter futility: the months spent gathering together these comforts, the hours wasted sorting and arranging them, preparing for a life and a winter you're about to abandon forever[or]There's nothing you need from the cupboards[stopping]."  Instead of closing cupboards, say "You carefully shut them, well-oiled hinges rotating silently.".

Some supplies are a prop in Kitchen. Understand "jar" or "jars" or "dried" or "herb" or "herbs" or "spice" or "spices" or "herbs and spice" or "coarse" or "woven" or "coarse-woven" or "bag" or "bags" or "salt" or "sugar" or "flour" or "decanter" or "decanters" or "oil" or "bin" or "bins" or "venison" or "fish" or "jerky" or "huge" or "glass" or "pickled" or "vegetables" or "vegetable" or "piled" or "bulb" or "bulbs" or "garlic" or "of" or "food" as supplies when location is regionally in Homeworld. Instead of doing anything to some supplies, say "[makemeal].".

A cookery is a kind of prop. Some hanging pots are a cookery in Kitchen.  Understand "pot" as hanging pots. Some hanging pans are a cookery in Kitchen. Understand "pan" as hanging pans. Some hanging skewers are a cookery in Kitchen. Understand "skewer" as hanging skewers. Understand "profusion" or "profusion of" as pots. Instead of examining a cookery, say "They gleam dully in the glow of the fire, well-worn but spotless. Rume usually cooks, but you find some simple pleasure in the act of cleaning.". Instead of taking or using a cookery, say "[makemeal].".

Understand "food/meal/breakfast/dinner/snack" as "[foodword]". Understand "cook/make/prepare/find" as "[cook]". Understand "[cook]" or "[cook] [foodword]" as a mistake ("[makemeal].") when location is Kitchen. Instead of tasting when location is Kitchen, say "[makemeal].". To say makemeal: say "[one of]Quietly, you prepare one small, final meal in this place, burnished gleams of fire on cutlery and tiny scrapes of glass on stone, metal on metal, pottery on wood somehow taking on strange importance in the chill and silence. You quickly sate what little appetite you have, and when all is cleaned and scrubbed and returned to its proper place, the kitchen seems silent and empty, as if it's already forgotten you[or]You are no longer hungry[stopping]". 

A small round table is a setpiece in Kitchen. The description is "Just large enough for three: Rume, yourself, and the odd trapper or trader who spies the smoke of your fire and feels a need for warmth, food, and companionship.". Check touching small round table: say "The old table is wobbly and stained with the lives of many past occupants, its surface rough and pitted. Rume has talked about building a new one in the spring. But now things have changed." instead. Check entering small round table: try entering rugged chairs instead.

Some rugged chairs are a prop in Kitchen. Understand "chair" as rugged chairs. The description is "These worn chairs, assembled by some previous owner without much eye for craftsmanship, will need to be replaced soon." Instead of entering some chairs, say "You sit for a moment at the old table, but your mind races. Visions and images dance inside you, and you know the moment you touch brush to canvas they will crystallize, coalesce into the scene you must paint-- the world you are Called to.[paragraph break]Restlessness drives you to your feet again[tutorial-typeverbs]." Does the player mean entering some chairs: it is likely.

A small pool is an undescribed backdrop. It is in Kitchen, Homeworld-Studio, and The-Tumble. Understand "tiny" or "pools" as the small pool. The description is "At the base of the small cliff, the stream tumbles into a small pool before continuing across the floor of the lodge." Instead of touching the small pool, try touching the stream. Instead of tasting the small pool, try tasting the stream. Instead of entering or swimming in the small pool, try vague swimming. Does the player mean tasting the stream: it is likely. Instead of vague swimming when small pool is visible: say "The pool is too small and cold for swimming, but on warmer nights it feels good to sit on the curved edge where the wooden floorboards meet its rocky lip, and soak the day's cares from your feet[tutorial-typeverbs]." instead.


Chapter - Cellar

[ This is just a quick bonus area for people who found the matches.]

Old-Tumble-Cellar is a room in Homeworld. "The great pillars of the lodge loom large in this cellar, a cold, empty space now that you and Rume have finally finished cleaning it out. The floor is stained and peppered with browning pine needles and ghosts of rotting foodstuffs left by residents long gone.[paragraph break]Behind the steep stairs back [up] to the Kitchen is a bone-cold rock wall, on which hangs [if homemade outfit is not worn]your traveling [o]clothes[x] and [end if]a mounted grey moose [o]head[x][tutorial-cellar].". The printed name of Old-Tumble-Cellar is "Tumble Cellar". The prose name of Old-Tumble-Cellar is "the cellar".

The grey moose head is a setpiece in Old-Tumble-Cellar. The description is "Its mangy fur is not that attractive; its rack not of a size to impress. But on cold nights when you come down here to stare into its blank dead eyes, you remember what it means to you, hanging on the wall of your home.[paragraph break]Your home.[paragraph break]And in a sudden shattering you live that night again: staggering through the woods while the old trapper died, despite all Rume's care could do; confusion and doubt echoing through you at the thought that here, perhaps, was your chance, your one chance to give up everything you'd shaped your life around, and get back everything you'd given up. As you stared at the dying moose, its blood seeping into the snow, you thought you'd decided. Decided to stay.[paragraph break]But the Call has hit you strong, like a current of cold electricity. Perhaps you never did decide. Perhaps you only put off the choice until another cold and lonely night. And now once again you stare into the eyes of the stiff grey creature and wonder.". Instead of hugging or touching moose head, say "The fur is stiff and ice-cold.". Instead of taking moose head, say "No. It too will remain, once you have gone.".

Report going from Old-Tumble-Cellar to Kitchen: say "Shivering, you climb the steps back into the kitchen, shutting the trapdoor behind you with a heavy groan.".

The homemade outfit is a wearable undescribed thing in Old-Tumble-Cellar. Understand "threadbare" or "traveling" or "clothes" as outfit. The description is "[if The-Path-Of-Love has happened or The-Path-Of-Love is happening]You've passed through several sets of clothes in your years at the Tumble, and always made them yourself, for reasons you could never quite explain[else]Years and worlds ago you stitched these clothes, crude but now comfortable, broken in, one of the few familiar trappings of your schizophrenic life. They come with you, each time you Wayfare, because you made them yourself, with your own hands. And only because of that[end if].". Instead of touching homemade outfit: say "The familiar threads are as comfortable and well-worn as a good pair of boots.".

First report wearing homemade outfit when location is regionally in Homeworld: say "With hands steady on the surface but somehow trembling deep within the bone, you take down the old battered clothes with something like reverence. As you slip into them you can already feel yourself start to let this world go, and the Call itches more deeply, turning your mind to the next world you must paint, the next place to be." instead.

First report taking the homemade outfit when the homemade outfit is not worn:
	try wearing the homemade outfit;
	if homemade outfit is worn, stop the action.

Instead of taking off homemade outfit when location is regionally in Homeworld: say "Now that you wear them again, you can't imagine yourself without them.". 

After wearing homemade outfit: remove bathrobe from play; continue the action.

The printed name of outfit is "traveling clothes". The indefinite article of outfit is "your".
	
Chapter - Conversation with Rume

Rume is a person. 

Rume-Conversation is a scene. Rume-Conversation begins when lacuna-canvas is mostly finished.  

When Rume-Conversation begins:
	now Rume is awake;
	move Rume to Homeworld-Studio;
	now Rume is holding a sikar.

Rume-Conversation ends when lacuna-canvas is finished. 

When Rume-Conversation ends:
	post-conversation processing;
	change the time of day to 10:12 AM;
	remove Rume from play;
	remove the paintbrushes from play;
	remove wooden band from play;
	remove flintlock pistol from play;
	remove dead hare from play;
	remove matches from play;
	if final release mode is true or milestone mode is true, determine gameplay mode;
	begin chapter 2;
	move player to Fork.	

A sikar is a prop.

Instead of greeting Rume when Rume is awake and we have not discussed rc_greet, say "[CHeShe] looks down at you silently, ignoring your acknowledgement.". Instead of kissing or hugging when location is regionally in Homeworld and Rume is awake and we have not discussed rc_greet, say "You move towards the steps, but Rume holds up a hand to stop you.".

 Instead of touching Rume when Rume is awake, try hugging Rume.

RC is a thread.

Every turn when Rume-Conversation is happening and the time since Rume-Conversation began is at least 1 minute and Rume-Conversation is happening and we have not discussed rc_greet: now Rume is attentive; now tempfuse of rc_greet is 5; try discussing rc_greet.

rc_greet is an exciting beat in RC. The reaction is "Rume [if the awake-examined of Rume is 1]examines you in return, thoughtful, [hisher] expression unreadable[otherwise if lc_painting_flag is 1]crosses [hisher] arms and shifts on the landing, drawing your attention from the painting[otherwise]puffs [hisher] sikar, staring at you with an unreadable expression[end if]. [rumegreet2].'". To say rumegreet2: say "'No goodbyes from a [rc_call], then,' [heshe] says in a quiet voice that hangs heavy nonetheless among the wooden rafters, seeping only reluctantly to the level of your ears. 'No scenes, no protests. Yes, I understand. The way of your [rc_kind], I imagine; a quiet departure in dim night, [rc_sneak] away to new dawns in new worlds, fresh and unspoiled.'

[CHeShe] lowers one hand to the railing and grips it calmly, but [hisher] knuckles are white. 'An [rc_easiest] road,' [heshe] adds, 'for the [if player is female]wo[end if]man I thought you were". rc_greet suggests rc_rant.

Understand "kind/people" as rc_kind when last beat is in RC. rc_kind is a dogged beat in RC with keyword name "people" and reaction "Your people.[paragraph break]How can you explain to [himher] that you have no people, no kind, no customs or culture? That each of you is lost, alone in the sea of probability, and the few haphazard moments when two wayfarers meet are the only hope of finding some connection, some meaning...[paragraph break]But Rume's eyes are locked on yours, awaiting a response.". rc_kind suggests rc_rant. 

Understand "easiest/easy/simplest/road" as rc_easiest when last beat is in RC. rc_easiest is an insistent beat in RC with keyword name "easy" and reaction "'Easiest for someone, yes,' Rume muses, [sikar business]watching you. 'But for whom? The one who [t]wayfares[x]? Or the one [if player is male]he[otherwise]she[end if] [t]leaves[x] behind?'". rc_easiest summons rc_easyplayer, rc_easyrume, rc_easyboth, rc_consequences. rc_easiest suggests rc_easynoanswer. rc_consequences replaces rc_easiest. Instead of saying both when last beat is rc_easiest, try discussing rc_easyboth. Instead of saying neither when last beat is rc_easiest, try discussing rc_consequences.

rc_easynoanswer is a beat in RC with reaction "Rume smiles, and how hard it is to see that expression come so forced, so painfully to [hisher] lips. 'I understand,' [heshe] says again, soothingly. 'The way of the world. Water flows downhill, fires spread, the strong are cruel. What poet or fool thinks mankind can escape such inevitability?'". rc_easynoanswer enqueues rc_doimatter.

Understand "wayfarer/wayfares" as rc_easyplayer when last beat is rc_easiest. rc_easyplayer is a beat in RC with keyword name "wayfares" and reaction "Smoke billows from Rume's mouth, vanishing into the wooden beams of the rafters, and [heshe] stares at you for a long, long moment, unblinking.

Finally [HeShe] sighs, aching and long, and breaks the gaze to stare deep into the fire. 'No,' [heshe] murmurs, 'of all things, you have never been a liar. I take comfort in that. I have always had truth from you. That will stay when you go, where lies would not.'". rc_easyplayer enqueues rc_doimatter. 

Understand "left/leaves" as rc_easyrume when last beat is in RC. rc_easyrume is a beat in RC with keyword name "leaves" and reaction "Rume smiles, and how hard it is to see that expression come so forced, so painfully to [hisher] lips. 'So many things you've learned, my love,' [heshe] says in a voice almost a whisper, 'in your lonely sojourn across the worlds. And so many things you have not.'". rc_easyrume enqueues rc_consequences.

rc_easyboth is a dogged beat in RC with keyword name "both" and reaction "'No,' Rume says, 'it is either one or the other. Answer me.'". 

Understand "sneak/sneaking/steal/stealing" as rc_sneak when last beat is in RC. rc_sneak is a beat in RC with keyword name "stealing" and reaction "'Yes,' says Rume, considering, 'that seems to me the right word for it. Why? Does it not agree with you? Its connotations of thievery, of disloyalty, of betrayal, perhaps, seem somehow inappropriate? Apologies. It was the first that came to mind.'". rc_sneak enqueues rc_consequences.

Understand "care" as rc_rant when last beat is in RC. rc_rant is an insistent beat in RC with keyword name "no" and reaction "Rume stares into you, that curious, comforting face pensive, troubled, the silence broken only by the muttering of the fire. 'Somehow I never expected this,' [heshe] murmurs as if to [himher]self, 'and I always believed you, love, your mad stories, even before I first saw you paint. But somehow I always thought you'd stay, that somehow I had the power to...'[paragraph break][CHeShe] breaks off, turning [hisher] head away sharply. When [heshe] speaks again it is with a louder, angrier voice. 'But you knew from the beginning, didn't you. That one day you would leave me behind.'". rc_rant summons rc_rantyes, rc_persuade, rc_rant2. rc_rant suggests rc_rant2. rc_cantgo replaces rc_rant. The maybe-beat of rc_rant is rc_rant2. The no-beat of rc_rant is rc_persuade. The yes-beat of rc_rant is rc_rantyes.

rc_rantyes is a beat in RC with keyword name "yes" and reaction "How can you admit such a thing? How can you say it, even to yourself? And yet there is no need; Rume sees it in your eyes, long before you've found a way to say it with words.". rc_rantyes enqueues rc_lonely. 

rc_lonely is a beat in RC with keyword name "[if last beat is rc_helpless]no[otherwise]maybe" and reaction "'Then I [t]pity[x] you, wayfarer,' [heshe] says sadly, 'always laying down your head in a place that does not quite feel like home, never knowing a [t]friend[x] who grows beyond green shoots into strength and health. A lonely life.'". rc_lonely summons rc_pity, rc_friendship. rc_lonely suggests rc_rant. rc_bitterouttro replaces rc_lonely. rc_lonely cancels rc_bitterouttro, rc_cantgo, rc_helplessyes. After discussing rc_lonely: now rc_rant2 is spoken; continue the action. [ That beat also deals with pity and friendship, so we don't want to see them both in one conversation.]

Understand "pity" as rc_pity when last beat is in RC. rc_pity is an ephemeral beat in RC with keyword name "pity" and reaction "Rume nods. 'Every gift comes with a curse, love. There are peoples for whom the two words are the same. Yours is terrible and great, and though your life brims with excitement, with magic, I would not have it for the world.'".

Understand "friendship/friend/friends" as rc_friendship when last beat is in RC. rc_friendship is an insistent beat in RC with keyword name "friend[if last beat is rc_rant2]s" and reaction "'Where are they now, your friends?' Rume asks, ragged with frustration and anger. 'Those worlds you left behind, do they still exist? Why waste your time in friendship when in one moment you can revoke the past from your life? Why? Do you believe those wasted hours and years were somehow worthwhile?'". rc_friendship summons rc_goodfriends, rc_doimatter. rc_friendship suggests rc_lonely. The yes-beat of rc_friendship is rc_goodfriends. The no-beat of rc_friendship is rc_doimatter.

rc_goodfriends is a beat in RC with keyword name "yes" and reaction "Rume considers this for a long time; you cannot tell what [heshe] is thinking.[paragraph break]'Yes,' [heshe] finally says, 'I suppose they were. For those you leave behind, at least. But for you?'". rc_goodfriends enqueues rc_doimatter.

rc_persuade is a beat in RC with keyword name "no" and reaction "How can you tell [himher], convince [himher] that these past months have not been a ruse? That you've struggled, fought against your nature, wanting more than anything to stay? That if the Call had not come... but it did, [if we chose art]and you responded to it at once, almost without thinking, ready to leave someone you've grown to love in an instant[otherwise]and though you fought against it, fought to stay with this soul you've grown to love, it still pulls you, entices you, in a way you cannot deny[end if]?". rc_persuade enqueues rc_cantgo. 

To decide whether children are possible: if ( yourself is male and Rume is female ) or ( yourself is female and Rume is male ) , decide yes; decide no.

rc_cantgo is a beat in RC with keyword name "yes" and reaction "For a long moment you stare at each other, until Rume breaks the gaze to stare searchingly into the sloping skylights, still black with night, and you know [heshe] is thinking, searching for some way [heshe] can come with you.

And you know there is none. Only a Wayfarer wayfares. Only the things [if player is male]he has created and touches go with him[otherwise]she has created and touches go with her[end if]. And there is no going back.

You've told [himher] before, and [heshe] hasn't forgotten. And at last [heshe] nods, to [himher]self, and pauses for a moment, as if gathering the right words to go on.". rc_cantgo suggests rc_stay. rc_cantgo summons rc_stay. rc_stay replaces rc_cantgo. 

rc_stay is a terminal beat in RC with keyword name "wait" and reaction "Quickly [heshe] tosses something down to you. In midair you realize what, and a weight seems to fall on you so that when you catch it, you're surprised it's so light.[paragraph break]'You say only what you've made with your own hands and touch goes with you when you go,' [heshe] breathes. 'So I give you the [o]bracelet[x] you made for me. If you would truly leave me forever, then wear it, to remember me by.'[paragraph break][CHeShe] steps forward, gripping the railing tightly. 'But there is another way. I cannot go, but you do not have to. Stay. Ignore the Call. If you keep moving on, running away from roots and foundations, this wayfaring will strip all meaning from your life and leave you a cold and lonely shadow. And I do not want that for you.'[paragraph break]'Come [d]up[x] and return the bracelet to me, if you choose to stay,' Rume says, 'or [d]wear[x] it and paint, if you choose to go. Or [d]burn[x] it, I suppose, if you wish for all trace of me to vanish. Choose. I will wait.'". After discussing rc_stay for the first time: now player holds Rume's bracelet; have the parser notice Rume's bracelet; continue the action. rc_resignedouttro replaces rc_stay. 

rc_mustchoose is a repeatable terminal beat in RC with reaction "[if bracelet is not worn by player and bracelet is on-stage]'No, love,' Rume says, 'you must choose. Come [d]up[x] to me to abandon your power and stay with me, or [d]wear[x] the bracelet to remember me by and paint your way into some other world, or [d]burn[x] it and paint and forget me.'[else]Your last conversation with Rume has ended. There is only one path forward now.[end if]".

rc_goup is a beat in RC with keyword name "up" and reaction "You move to the stairs, but Rume pauses, breathing deeply. 'Wait,' [heshe] says, 'think. Know what you give up for me. Believe it in yourself. Tell it to your soul. Then, if that truly is your decision...' [CHeShe] trembles, whispering. 'Then yes, come [t]up[x] to me, and let us start our life together at last.'". rc_goup2 replaces rc_goup.

rc_goup2 is a terminal beat in RC with keyword name "up" and reaction "The vastness of the distance up the stairs seems enormous, each step requiring herculean effort. But they get easier. Each time you lift your foot,  some force within you rips, snaps open, like seed pods bursting at the first breath of spring, or signal flares igniting, light to show the way through storms.[paragraph break]You take the last few steps in a single bound and fall upwards into Rume's arms, floodgates of something you've never felt bursting forth inside you. You hold each other for long minutes, almost too tight to breathe, till finally you slip the bracelet back on [hisher] wrist.[paragraph break][Cheshe] kisses you deeply, then pulls you back into the loft. There are still hours to morning, when your life will finally, finally begin.". After discussing rc_goup2: if topics-window is g-present, shut down topics-window; move player to Old Tumble, without printing a room description; miss Rume a lot.

rc_wontstay is a beat in RC with keyword name "no" and reaction "Some part of you wants with all its heart to stay, but another part, the stronger part, knows it would be a lie.[paragraph break]You cannot stay. You must move forward. Move on. Wayfare. Always.[paragraph break]You slip the bracelet on, and Rume closes [hisher] eyes.". rc_wontstay enqueues rc_rant2. 

rc_rant2 is a beat in RC with keyword name "maybe" and reaction "'How many worlds have you moved through, wayfarer?' Rume sighs. 'How many [t]friends[x] have you sacrificed? Will you ever stop moving? I [t]pity[x] you, alone, always alone.'". rc_rant2 summons rc_pity, rc_friendship. rc_rant2 suggests rc_stay. rc_whycall replaces rc_rant2. rc_rant2 cancels rc_reallystay, rc_wontstay, rc_persuade, rc_rantyes, rc_lonely.

rc_resignedouttro is a terminal repeatable beat in RC with reaction "'Now paint,' [heshe] says, 'you are almost finished. I will stay to watch you go. But our words are finished now. Anything you have left to say, you must say it without them.'[paragraph break][CHeShe] gives you one, last look, the blue of [hisher] eyes piercing even in the gloom. 'Goodbye, wayfarer. May you find what you seek. And know it, when you do.'".

The player wears a wooden band. Understand "twin" as wooden band. The description of wooden band is "The symbol of commitment is always a circle. On some worlds they are rings, tiny bands with homes on varying fingers; elsewhere they are necklaces or circlets. Here they are a little different, signifying more strong fondness than promise, but the exchange still has meaning. Your band was made by Rume, carved from ashwood and polished smooth[rumebandbit].". To say rumebandbit: unless player holds Rume's bracelet or player wears Rume's bracelet or Rume's bracelet is off-stage, say ". [if Rume is male]He[else]She[end if] wears the one you made for [if Rume is male]him[else]her[end if]". Check burning wooden band: remove wooden band from play; dis Rume; say "You set it gently in the fire, and in moments, it is a flaming circle, turning slowly to ash." instead. Check dropping wooden band: say "No need; when you wayfare, it will not come with you, but remain here." instead. Understand "put band on table" as a mistake ("When you wayfare, it will remain here, and any who seek to find it, will.") when location is Old Tumble.

Instead of painting when Rume-Conversation is happening and Rume is attentive, force discuss rc_nopaint.  Instead of examining front door when Rume-Conversation is happening and Rume is attentive, force discuss rc_nopaint.

To say Rumeoutburst: say "[one of]Rume suddenly hurls something concealed in [hisher] hand and you pull back with a start. It smashes against the wood panelling at your feet with a sound that unnaturally loud in the resonant space. Looking down, you see amidst the broken frame the [o]sketch[x], two hands entwined, that Rume made when first you made this place your home.

But when you look up again [heshe] is calm, as if all fury was spent in that single act of destruction[movesketchtoloc][or]Rume suddenly smashes [hisher] hand against the railing, hard. It quivers, but holds[stopping]". To say movesketchtoloc: move framed drawing to location.

rc_nopaint is an insistent beat in RC with reaction "You turn away, but [Rumeoutburst].

'All these months together,' [heshe] says in a level tone, 'and you would turn away from our last conversation? You owe me that, at least, in payment of my time. Tell me, then. Do I matter to you at all? Did I ever?'". rc_nopaint summons rc_rant, rc_bitterouttro, rc_lonely. rc_bitterouttro replaces rc_nopaint. rc_nopaint suggests rc_rant2. The maybe-beat of rc_nopaint is rc_lonely.

rc_nophysical is an ephemeral beat in RC with reaction "You start to walk up the stairs, but Rume's face darkens and [heshe] draws back. 'No, love' that gentle voice says [if we chose love or we chose both]sadly. 'No, not now. I would remember your touch as it was earlier tonight. Not now, splintered, roughened by the tool you would use to cut me from your life forever[otherwise]angrily. 'No, you made a choice already this night, to touch me or your canvas, and we know what you chose[end if].' [CHeShe] straightens. 'We will speak on my terms,' [heshe] says, 'not yours. And I like it up here for now.'". rc_goodbye2 replaces rc_nophysical.

Instead of attacking or pushing when Rume-Conversation is happening and Rume is attentive, force discuss rc_attack.

rc_attack is a terminal beat in RC with reaction "You climb the steps, anger flushing your face, and raise your hand in fury, but before you can strike Rume grabs it and strikes you across the face with [hisher] other. You stumble backwards down the steps and land hard, one leg flaring with pain as it twists beneath you.[paragraph break]Silently Rume returns inside the loft, returning a moment later dressed for cold. Without a word, [heshe] descends the stairs and walks to the door.[paragraph break]'Goodbye, wayfarer,' Rume says quietly, then opens the door and disappears into the night, leaving only a plume of frigid air dancing with crystallized snowflakes.". After discussing rc_attack: remove Rume from play; dis Rume a lot; now the player is wounded.

Instead of saying farewell to when Rume-Conversation is happening and Rume is attentive, force discuss rc_goodbye.

rc_goodbye is an ephemeral beat in RC with reaction "'Yes, well,' Rume says, studying the grain of the railing, 'words are not your gift, are they? Goodbyes and apologies may be all you have left, but I have other words. They are all I can send with you. So keep your words, and listen. Listen to mine.'". rc_goodbye enqueues rc_consequences. rc_goodbye2 replaces rc_goodbye.

Understand "neither" as rc_consequences. rc_consequences is an insistent beat in RC with keyword name "neither" and reaction "'[if we chose art]I felt you pull away from me, tonight,' [heshe] says, drawing a measured breath. 'But I did not dream how far you meant to go. Have I become a burden for you, a chore? Your love for me has died?[otherwise]Just hours ago you were in my arms,' [heshe] says, drawing a measured breath. 'And there was no thought in my mind that before the dawn you might be gone. What happened, my love? Have you lost interest in me, in some poor, awkward soul stuck to one small world for all [hisher] life? Will you seek more exciting lovers in natal worlds, fresh and unburdened by memory?[end if]'[paragraph break]How can you answer such questions? With a simple [t]yes[x] or [t]no[x]? Or do you try to explain the life of a [rc_call] to someone who has never, can never feel it?". rc_consequences summons rc_meananswer, rc_rant, rc_call. The no-beat of rc_consequences is rc_rant. The yes-beat of rc_consequences is rc_meananswer. rc_consequences suggests rc_doimatter. rc_rant replaces rc_consequences. 

rc_goodbye2 is a repeatable ephemeral beat in RC with reaction "'[one of]Stop[or]No[or]Please[in  random order],' Rume says[if a random chance of 1 in 2 succeeds] with a weary tone[end if], '[one of]just let me speak[or]your time is running out[or]there's no point[in random order].'". The unavailable-beat of Rume is rc_goodbye2.

rc_meananswer is a beat in RC with keyword name "yes" and reaction "[Rumeoutburst].". rc_meananswer enqueues rc_doimatter.

Instead of saying sorry when Rume-Conversation is happening, force discuss rc_goodbye.

Understand "call/wayfare/wayfarer" as rc_call when last beat is in RC. rc_call is a beat in RC with keyword name "wayfarer" and reaction "'Yes,' Rume says musingly, [sikar business]'you've told me before. The Call. Such a romantic, fantastic notion. A beacon that pulls your [t]people[x] across worlds, across universes. In times of need,' [heshe] adds reflectively, staring into the empty space in the empty center of the lodge, lost.". rc_call enqueues rc_whycall. rc_call summons rc_kind. 

rc_whycall is an insistent beat in RC with reaction "'But why do you answer it?' [heshe] says suddenly, bluntly. 'This Call. There are those in this world who [t]need[x] you as much. Why? Some sense of [t]duty[x]? The promise of [t]adventure[x]? Or are you simply [t]helpless[x] to resist?'". rc_whycall summons rc_duty, rc_adventure, rc_helpless, rc_need. rc_whycall suggests rc_rant2. rc_rant replaces rc_whycall.

Understand "adventure" as rc_adventure. rc_adventure is a beat in RC with keyword name "adventure" and reaction "Rume closes [hisher] eyes. 'Yes,' [heshe] says, 'what a life it must be. I can see it. Always turning the page to new adventures, new friends; your problems and troubles only ephemeral things, as easy to erase as an hour with a canvas and brush.' [CHisHer] eyes open, slowly. 'Just like a story. But unsatisfying, somehow. Unreal. False.'". rc_adventure enqueues rc_doimatter. 

Understand "duty" as rc_duty. rc_duty is a beat in RC with keyword name "duty" and reaction "Rume studies you for a long moment.[paragraph break]'Yes,' [heshe] says finally, taking a deep breath, 'in a life like yours, the only allegiance a sane [if player is male]man[otherwise]woman[end if] could have is to [if player is male]him[otherwise]her[end if]self, and others like [if player is male]him[otherwise]her[end if].' [CHeShe] nods once, slowly. 'For those around you are mere shadows, destined always to fade away, never to stay, never to be woven into the fabric of your life. Only brushed at intervals from the threads.'". rc_duty enqueues rc_doimatter.

Understand "helpless" as rc_helpless. rc_helpless is an insistent beat in RC with keyword name "helpless" and reaction "Rume looks down at the floor, flexing a bare toe, frowning. 'So unlike you,' [heshe] says, 'or the one I thought you were before tonight. If what you say is true then you are a slave, your free will lost in the eye of a terrible storm, a power you have lost the will to control.'[paragraph break][CHeShe] looks up at you, and adds 'Tell me. Would you give it up if you could?'". The no-beat of rc_helpless is rc_lonely. The maybe-beat of rc_helpless is rc_lonely. The yes-beat of rc_helpless is rc_helplessyes. rc_helpless suggests rc_rant2. rc_resignedouttro replaces rc_helpless. 

rc_helplessyes is a beat in RC with keyword name "yes" and reaction "Rume looks at you sharply. 'So you say,' [heshe] says, 'but deed weighs more than dream.'". rc_helplessyes enqueues rc_cantgo. 

Understand "need" as rc_need. rc_need is a dogged beat in RC with keyword name "need" and reaction "Rume looks away for a moment, as if [heshe] regrets the choice of word, but then looks back into your eyes more firmly. 'Yes,' [heshe] says, 'Perhaps there are those under your own roof who need you. Perhaps they should have told you before this night, but the past is set and fired. Now answer my question.'".

rc_bitterouttro is a terminal beat in RC with keyword name "no" and reaction "Rume's face becomes cold. 'Paint, then,' [heshe] says, waving a hand dismissively. 'Paint your way from here. When you are gone, I shall unbuild this lodge we claimed, log by log, and scatter the stones into the forest, and when the snow melts all that will remain is the stream and the woods. I shall move on as well, and our past will be erased from my life as it will be from yours.'[paragraph break][CHeShe] pulls back into the shadowed frame of the doorway. 'Paint, wayfarer,' [heshe] repeats. 'Even I can see you are not quite finished.'". After discussing rc_bitterouttro: dis Rume; continue the action.

rc_doimatter is an insistent beat in RC with keyword name "no" and reaction "[CHeShe] considers [hisher] next words carefully, forming them in [hisher] head the way you've seen [himher] do so many times before, before finally speaking.[paragraph break]'Tell me, wayfarer,' [heshe] says. 'Do you care for me?'". The yes-beat of rc_doimatter is rc_cantgo. The no-beat of rc_doimatter is rc_bitterouttro. The maybe-beat of rc_doimatter is rc_lonely. rc_rant replaces rc_doimatter. rc_doimatter suggests rc_stay.

To say sikar business: say "[one of]taking another savage pull at the sikar, [or]raising the sikar to [hisher] lips again, [or]putting out the sikar, [or][stopping]".

rc_romanticbye is a terminal beat in RC with reaction "You quickly climb the steps. [if rc_bitterouttro is spoken]Rume pulls back, avoiding your glance, but you come to [himher] and touch your hands to [hishers]. Trembling with rage, impotence, fear, they nonetheless finally grip yours as tight as you grip back[otherwise]Rume stands solid, the firm fierce rock you've depended on this past year, and only as you take [hisher] hands in yours do tears at last seep through. And in that moment as Rume grips you tight you know [heshe] has let you go, has begun to heal, and your own remembered losses well up[end if] and you know what this is, or remember. What it is to lose.[paragraph break]Finally [heshe] kisses you one last time. It seems over far too soon but will linger in memory, for long years.[paragraph break]You look into the deep of Rume's blue eyes, wondering as always what [heshe] sees in yours, and knowing you will never know. Then you turn, and descend the stairs, and take up your brush once again.". rc_romanticbye2 replace rc_romanticbye. After discussing rc_romanticbye: miss Rume; continue the action.

rc_romanticbye2 is a repeatable beat in RC with reaction "You've said your goodbye. Now it's time to go. To wayfare.".

After going when Rume-Conversation is happening and Rume is on-stage and The-Path-Of-Love is not happening: move Rume to location; if we have not discussed rc_stay, now Rume is attentive; continue the action.


Instead of greeting when Rume-Conversation has happened and Rume is idle and location is regionally in Homeworld: force discuss rc_mustchoose. 

Instead of exhausting when Rume-Conversation is happening and Rume is enclosed by location: say "'Please, my love,' Rume says, 'there are other things to say.'".

[ Resolution.]

Touching Rume is making amends. Hugging Rume is making amends. Kissing Rume is making amends.

Instead of saying farewell to or saying sorry when Rume-Conversation is happening and Rume is idle and Rume is on-stage: try kissing Rume.

[ During the conversation, block physical actions with a "not yet" beat.]
Instead of making amends when Rume-Conversation is happening and Rume is attentive (this is the block making amends rule): force discuss rc_nophysical. First check going up when Rume-Conversation is happening and ( Rume is attentive or rc_greet is unspoken ) : try kissing Rume instead.

[ After the convo but before deciding, physical actions produce a "no, you must choose first" message.]
Instead of making amends when Rume-Conversation is happening and Rume is idle and Rume is on-stage and bracelet is not worn by player and bracelet is on-stage and rc_greet is spoken (this is the must choose first rule): force discuss rc_mustchoose. Instead of giving wooden band to Rume when Rume-Conversation is happening and Rume is idle and Rume's bracelet is not worn by player: force discuss rc_mustchoose.

[ After deciding to leave, physical actions trigger a goodbye scene.]
Instead of making amends when Rume-Conversation is happening and Rume is idle and Rume is on-stage and bracelet is worn by player (this is the allow saying farewell rule): force discuss rc_romanticbye. First check going up when Rume-Conversation is happening and Rume is idle and Rume is on-stage and bracelet is worn by player: force discuss rc_romanticbye instead.

[ After Rume has offered to stay, understand going up as accepting this offer. ]
To decide whether choosing destiny: if Rume-Conversation is happening and Rume is idle and Rume is on-stage and bracelet is not worn by player and rc_bitterouttro is not spoken and rc_greet is spoken and ( location is Homeworld-Studio or location is Kitchen ) , decide yes; decide no.
First check going up when choosing destiny: force discuss rc_goup instead. First instead of giving Rume's bracelet to Rume: force discuss rc_goup instead. Check giving paintbrushes to Rume when choosing destiny: force discuss rc_goup instead.

[ Prevent going up at all if things ended badly.]
First check going up when Rume-Conversation has happened and ( Rume is off-stage or rc_bitterouttro is spoken ) and location is regionally in Homeworld: say "There is nothing left for you up there any more." instead.

[ Trying to give the player's band to Rume before the offer fails; afterward it gets Rume points.]
Instead of giving wooden band to Rume when location is Your Bedroom: say "Not now. If there is to be an exchange of gifts, it will be when you both are awake, before you go.".
Instead of giving wooden band to Rume when Rume-Conversation is happening and Rume is idle and Rume's bracelet is worn by player and rc_greet is spoken:
	say "You pull the band Rume made for you, from your wrist and hold it up to [himher].[paragraph break]For a long moment, [heshe] stares at it, as if afraid or unsure.[paragraph break]Then, finally, [heshe] holds out [hisher] hand. Slipping it on, [heshe] runs a finger along the line of your delicately carved wood, then nods, once, and lowers the hand.[paragraph break]'Thank you,' [heshe] says. 'I will remember you, too.'";
	remove wooden band from play;
	miss Rume.

[ Wearing the bracelet signifies moving on.]
After wearing Rume's bracelet for the first time:
	if location is regionally in Homeworld and The-Path-Of-Love is not happening:
		pre-conversation processing;
		force discuss rc_wontstay;
	continue the action.

Report wearing Rume's bracelet for the first time:
	if The-Path-Of-Love is happening or Rume is off-stage or location is regionally in Lacuna, say "You slip the bracelet carefully onto your wrist. Heavier than you expected." instead;
	else do nothing instead.

[ Burning the bracelet is bad mojo.]
Instead of burning Rume's bracelet: say "You toss the bracelet into the fire. Its old, dry wood catches quickly, and it burns bright and hot."; remove Rume's bracelet from play; dis Rume a lot; force discuss rc_bitterouttro.






Part - Stories and Puzzles

To decide whether we guess the player likes puzzles:
	let ctr be 0;
	[ The game never mentions inventory and it is not strictly needed. If we try taking inventory, we're probably an IF vet and more used to puzzles.]
	if we have taken inventory, increase ctr by 1;
	[ The winter boots are not mentioned in the main room description, but in a sub-description. If we examine them, we're probably examining a lot of things, and are more likely to do well with puzzles. ]
	if enough shit was examined, increase ctr by 1;
	[ If we got to the cellar, that means we noticed the matches, used them to light the lamp, and went down into the cellar, indicating we have more than a short term memory and an interest in solving problems. ]
	if Old-Tumble-Cellar is visited, increase ctr by 1;
	if ctr is at least 2, decide yes;
	decide no.

To decide whether enough shit was examined:
	let shitctr be 0;
	if we have examined pairs of winter boots, increase shitctr by 1;
	if we have examined framed drawing, increase shitctr by 1;
	if we have examined trinkets, increase shitctr by 1;
	if we have examined tumble-books, increase shitctr by 1;
	if we have examined pine cupboards, increase shitctr by 1;
	if shitctr is at least 3, decide yes;
	decide no.

To determine gameplay mode: 
	print a section break;
	say "[as the parser]Tutorial: During the first chapter, you [if we have taken inventory]took inventory[else]mostly stuck to commands from the tutorial[end if], [if enough shit was examined]examined many minor scenery items[else]mostly ignored minor scenery items[end if], and [if Old-Tumble-Cellar is visited]solved a basic puzzle[else]mostly left the trapdoor alone[end if]. Based on these actions, you might prefer to continue in ";
	say "[if we guess the player likes puzzles]puzzle mode, which includes more challenging obstacles to overcome in the tradition of adventure games. The other option, story mode, simplifies the puzzles and provides more opportunities to skip them[else]story mode, which simplifies adventure game puzzles and presents more chances to bypass them entirely. The other option, puzzle mode, includes more challenging obstacles to overcome and problems to solve, without altering the story in any way[end if]. However, the choice is up to you.[paragraph break]Would you prefer to continue in [d]story[x] mode or [d]puzzle[x] mode? [as normal]";   
	if story mode is selected begin;
		now drama manager is storied; [ Scenes in various modules are triggered by this change.]
	otherwise;
		now drama manager is puzzled;
	end if.

To decide whether story mode is selected: 
    (- Question('story','S//','un.t','puzzle','P//','un.y') -)

Include (-
[ Question pos1 pos2 pos3 neg1 neg2 neg3 i; 
    for (::) {
if (location ~= nothing && parent(player) ~= nothing) 
DrawStatusLine();
KeyboardPrimitive(buffer, parse); 
        i=parse-->1; 
        if (i==pos1 or pos2 or pos3) rtrue; 
        if (i==neg1 or neg2 or neg3) rfalse; 
        print "Please choose ", (address) pos1, " or ", (address) neg1, ". > "; 
    } 
];
-)


Part - Staying With Rume


The-Path-Of-Love is a scene. The-Path-Of-Love begins when location is Old Tumble. The-Path-Of-Love ends when location is not regionally in Homeworld and location is not a flash-room.

kidismale is a truth state that varies. To say kidsname: if kidismale is true, say "Jurriaan"; otherwise say "Archana".

When The-Path-Of-Love begins:
	print a section break;
	move easel to Old Tumble;
	move paintbrushes to Old Tumble;
	move Rume's bracelet to Old Tumble;
	move lacuna-canvas to Old Tumble;
	now paintbrushes is undescribed;
	remove Rume from play;
	now player wears wooden band;
	remove matches from play;
	remove oil lamp from play;
	post-conversation processing;
	if topics-window is g-present, shut down topics-window;
	say "And time seems to speed up, flowing faster and faster till the leaves and foam that once drifted by becomes a blur and blue";
	process blue flash.


The North Vale is a room in Homeworld. The description is "The trees crowd thick here in this vale that has always been good hunting grounds, nestled between two rocky slopes.[paragraph break][exits].". The exits text of North Vale is "The path back [down] to home is behind you".

A large hare is an animal in the North Vale. "Before you, in a clearing, a large [o]hare[x] grazes unconcernedly on tufts of summer grass[if player holds flintlock pistol][one of]. You raise the worn flintlock pistol to your shoulder carefully[or]. You sight along the flintlock pistol, holding your breath[stopping][end if].". The description is "You'd hoped to see deer this morning, but they seem later than usual in returning to the vale this year. The hare will only provide one good meal, but anything is better than unthawing more greying venison from last season.". After going to The Giant's Table when large hare is on-stage: remove large hare from play; continue the action.

A flintlock pistol is a thing. Understand "gun/rifle" as pistol. The description is "You traded a week's work helping an old farmer build a new house for this pistol, and it has served you well for almost twenty years now.". Understand the command "shoot" as "attack". Instead of attacking the pistol when large hare is in location, try attacking large hare. Instead of attacking the pistol, try attacking dead hare. 

Check attacking large hare: remove large hare from play; move dead hare to location; say "With a deafening explosion, the pistol fires, a good, clean shot. The hare starts, then falls, as you knew it would.[paragraph break]You approach the animal, but it seems your shot is clean. It lies dead, blood spilling over the grass in steamy curtains, merging with the morning dew.[paragraph break]Something about the [o]blood[x] reminds you of something." instead. Instead of doing something other than examining or examining by name or attacking to the large hare, say "You'll scare it off.".

A dead hare is a described thing. "The [o]hare[x] you shot is here.". The description is "When cleaned and dressed, it will make a nice supper.". Report taking dead hare: say "You pick up the hare by the ears." instead. Report dropping dead hare: say "You gently put the carcass down." instead. Instead of attacking dead hare: say "This will be enough meat for now.".

Some hare-blood is part of the dead hare. Understand "blood" as hare-blood. The printed name is "blood". The description is "The sky was blood-red when you left this morning before sunrise, vanishing storm clouds drinking in the dawn light. Rume was standing at the doorway as you left, staring into the east. [if Rume is male]He[else]She[end if] murmured something quietly, and you thought [if Rume is female]s[end if]he said 'Who'd have believed we could stay so long in one place.'[paragraph break]You were so bleary-eyed you were not quite sure you hadn't imagined [if Rume is male]him[else]her[end if] saying it-- sounded more like something you'd say, anyway-- but now that the walk through the brisk morning air and the hunt has wakened you, you're sure [if Rume is female]s[end if]he did say it. Strange. [if Rume is male]He[else]She[end if] has been so [o]strange[x] lately.".

Some hare-strange is part of the dead hare. Understand "strange" as hare-strange. The printed name is "strange". The description is "Winter was lonely and cold this year, your first without [kidsname], and Rume has seemed quieter and more withdrawn than you've seen [if Rume is male]him[else]her[end if] in years. [if Rume is male]He[else]She[end if] spent hours poring over old maps, tracing fingers through the lines of distant mountain ridges and rubbing circles through the white blank spaces of unexplored territory.[paragraph break]When spring finally came, [if Rume is female]s[end if]he threw [if Rume is male]him[else]her[end if]self into spring cleaning, scrubbing floors and washing away the grime as if trying to make the old Tumble look like new. You helped in kind, of course, but were never sure what you both were preparing for, what strange visitor would be arriving that you hoped to impress.".

Report going from North Vale to Giant's Table: say "You walk down through the strangely quiet vale in the midmorning light."

The Giant's Table is a room in Homeworld. It is down from North Vale. The description is "Three narrow canyons meet at this huge flat moss-covered rock. Memories of dozens of picnics drift through the quiet pines surrounding the Table, [kidsname]'s ghost laughter mingling with the tinkling of the stream that leads you home.[paragraph break][exits][one of].[paragraph break]A strange feeling twists within you, as if something is wrong. But everything seems normal. You have walked this valley thousands of times, and nothing is out of place. But still the feeling persists[or][stopping].". The exits text of Giant's Table is "The stream trickles [down] the valley".

The valley stream is a minor backdrop. It is in The Giant's Table, The Child's Dam, and Tumble Exterior. The description is "It's cold.".

Report going from The Giant's Table to The Child's Dam: say "You follow the familiar stream down through steep terraces, following the worn path through the greening pines."

The Child's Dam is a room in Homeworld. It is down from The Giant's Table. The printed name is "[kidsname]'s Dam". The description is "The stream pools into a narrow, deep swimming hole here, an old project of your [if kidismale is true]son[else]daughter[end if]'s that has held up to the elements far longer than [kidhisher] parents ever thought it would. A few wildflowers poke their way out of the new spring grass in the adjacent meadow.[paragraph break][exits][one of].[paragraph break]The feeling of wrongness grows within you, almost a panic, though you still cannot explain why. But then, suddenly, you can. You should see the smoke rising from the Tumble from here, a familiar beacon. But you don't. There is no smoke. The fire is out[or][stopping].". The exits text of The Child's Dam is "The stream continues [down] towards home". Some dam-wildflowers are a minor setpiece in Child's Dam with printed name "wildflowers" and provoke message "You remember picking them with Rume in distant springtimes.". Understand "flower/flowers/wildflowers" as dam-wildflowers when location is Child's Dam.

Report going from The Child's Dam to Tumble Exterior: say "You hurry down the slope, over lichen-encrusted boulders and mouldering pine needles."

Tumble Exterior is a room in Homeworld. It is down from The Child's Dam. The printed name is "Outside the Tumble". The description is "The wooden beams of home rise above you, aging but scrubbed clean, firewood stacked in a neat pile under the eaves and the little bridge over the stream neatly swept. But there is no smoke rising from the rock chimney, no smell of breakfast or sound of Rume singing, and the door is shut tight, rather than open to admit the spring air.[paragraph break][exits].". The exits text of Tumble Exterior is "[one of]Part of you dreads to open that door, but t[or]T[stopping]here is nowhere to go but [inside]".

The fake-tumble-exterior is a setpiece in Tumble Exterior with printed name "Tumble". Understand "home/house/cabin/lodge/tumble" as fake-tumble-exterior. The description is "It has been your home for twenty years. But suddenly, now, it feels like only an empty shell.". instead of entering or going or opening fake-tumble-exterior: try going inside instead.

The tedoor is an undescribed door. Understand "door" as tedoor. The printed name is "door". The tedoor is inside from Tumble Exterior and outside from Old Tumble. Before going inside when location is Tumble Exterior and tedoor is closed: now tedoor is open. Before going outside when location is Old Tumble and tedoor is closed: now tedoor is open.

Report going from Tumble Exterior to Old Tumble: say "[one of]You push the door open and stop dead in your tracks, heartbeat suddenly loud in your ears[or]You step back inside the Tumble[stopping].".

Old Tumble is a room in Homeworld with printed name "Tumble, Main Floor". "It's been a long time since you thought of this room as a studio, but suddenly you remember it as it was that night all those years ago. The fireplace is neatly banked now, ashes scrubbed away, and [kidsname]'s pine animals hang from the ceiling instead of the bare rafters. But one thing is the same.[paragraph break][easelbit][if lc_painting_flag is 1].[paragraph break][otextra][end if].". First check going nowhere when location is Old Tumble: say "Nothing you need or want is elsewhere in the Tumble." instead. Understand "trapdoor" as north when location is Old Tumble.

OldTumbleStuff is stuff in Old Tumble. Understand "chair/chairs/table/fire/fireplace/hearth/boots/kitchen/stream/pool" as OldTumbleStuff when location is Old Tumble. First instead of doing anything to OldTumbleStuff: say "Nothing else matters now.".

To say otextra: say "[one of]Slowly your peripheral vision returns and you take in the rest of the scene, and all that is different. [or][stopping]Rume's boots and winter clothes are gone[if player wears homemade outfit][else], and in their place hang your old traveling [o]clothes[x][end if]. The fireplace is banked, ashes neatly swept away. And on the table is a folded [o]letter[x][if player wears Rume's bracelet][else], and a [o]bracelet[x][end if]".

Some hanging pine animals are a setpiece in Old Tumble. The description is "[kidsname] loved to carve the simple figures that sway above you: beavers, moose, elk, chipmunks. When Rume climbed the ladder to dust them last week, they spun drunkenly through the air, falling dust sparkling in the golden morning light.".

A letter-from-Rume is a prop in Old Tumble with printed name "letter from Rume". Understand "letter" as letter-from-Rume. Instead of taking letter-from-Rume, say "There's no point. They will not go with you when you leave.". Instead of opening or reading letter-from-Rume, try examining letter-from-Rume. The description is "You open it and read, numb.

'A dozen glaciers creep through our mountains,' it begins, 'a hundred passes lead to alpine paths growing less and less familiar each hour. In four days, my love, I will be in unexplored, uncharted territory. Once again.

'I did not have the courage to say goodbye to you. Nor did you have the courage to do the same for me, when first you heard the Call and started this painting. It is not because we are cowards, I think. It is because we know how easy the temptation to follow in contentment would be. But we are not followers. We are not owners of each other, nor can we change who we are. We are explorers, and we must explore. This is hard, and true.

'But exploring takes us to unexpected places.

'You have said yourself, my love, that there are no rules for your kind. What you know you know by experiment and chance. Perhaps-- no, certainly-- you do not know everything. There may be more left to explore in yourself.

'Though you think it impossible, perhaps one day you can find your way back to me.

'Go. Wayfare. Explore. And if you find some way to return-- find me. I will be high in mountains, or crossing distant seas, somewhere under stars. When we meet again we both will be changed, and ready to explore each other anew.

'Rume.'". 

Rume's bracelet is a wearable thing. The description is "Carved from a dark, solid wood, the bracelet was your gift to Rume long ago, the twin of the wooden [if wooden band is enclosed by location][o]band[x][else]band[end if] [if Rume is female]s[end if]he gave to you.". Does the player mean taking Rume's bracelet when The-Path-Of-Love is happening: it is likely. Check dropping Rume's bracelet: say "You don't want to lose it." instead.

Report wearing Rume's bracelet when The-Path-Of-Love is happening: say "You slip it through our hand next to its twin, which you realize with heartbreak will vanish from your hand when you leave-- for Rume made it for you.[paragraph break]But [heshe]'s right. The other will remain." instead.

Instead of landmark-listing when The-Path-Of-Love is happening and location is regionally in Homeworld, say "All the landmarks in your life are behind you."

Check attacking yourself when Tumble Exterior is visited: say "Slowly, you raise the pistol to your head. The Call will not rule you; the life you lead is not a life if it must always be slave to voices beyond your control. And with Rume gone, you have nothing left to live for.[paragraph break]In silence, you pull the trigger."; end the game in death.

Understand "cross" or "across" as north when location is Old Tumble or location is Dream7Nexus or location is Dream1Nexus. 


Part - Blue Flashes

Instead of examining the sun when sunset and location is regionally in Lacuna (this is the Blue Flash rule): process blue flash. 

A flash-room is a kind of room. 

To say blueflashcommandprompt: say "[if location is Blue Flash 1]and you say[else if location is Blue Flash 2]so you[else if location is Blue Flash 3]and you wonder if you should[else if location is Blue Flash 3a]and you tell [himher] that you[else if location is Blue Flash 4] and you[else if location is Blue Flash 5]and it tastes[else if location is Blue Flash 6]and you know [kidsname] is[else if location is Blue Flash 7]and you realize now that decision was[else]so you[end if]: >>".

To process Blue Flash:
	if topics-window is g-present, shut down topics-window;
	if the number of entries in flash list < 1:
		say "You stare towards the sun as it sinks into the ocean, a brilliant ball, but as it sinks into the waves and vanishes, you see nothing further.";
		stop;
	if The-Path-Of-Love is happening:
		if Blue Flash 3a is not listed in flash list and the number of entries in flash list is 7, add Blue Flash 3a at entry 4 in flash list;[ add a scene referencing player's inability to let the painting go.]
		let flash stage be entry 1 of flash list;
		move Rume to flash stage;
		now Rume is idle;
		move player to flash stage, without printing a room description;
		say "[line break][bold type][location][roman type][line break][description of location][line break]";
		change the command prompt to "[blueflashcommandprompt]";
	otherwise if location is indoorsy:
		say "You can't see the sun from in here.";
		stop;
	otherwise if sun over ocean:
		miss Rume;
		say "You stare towards the sun as it sinks into the ocean, a brilliant ball of red and gold, and suddenly, just as the last sliver vanishes into the waves, a surge of intense blue";
		reset the boredom meter with "Blue Flash";
		change saved location to location;
		if The-Path-Of-Love has ended:
			move Rume to location;
			say "[paragraph break][paragraph break]";
			say "[one of][tpl7][or][tpl2][or][tpl3][or][tpl4][or][tpl5][or][tpl6][in random order]";
			say "[paragraph break][paragraph break]";
			remove Rume from play;
			aftersunbit;
		else:
			let flash stage be entry 1 of flash list;
			move Rume to flash stage;
			move player to flash stage, without printing a room description;
			say "[line break][bold type][location][roman type][line break][description of location][line break]";
			change the command prompt to "[blueflashcommandprompt]";
	otherwise:
		say "The sun is hidden from this vantage point; you can't see where it's touching the ocean.".

To say tpl2: say "'There is a bedtime story for mountain children,' Rume murmurs, [hisher] [if Rume is male]strong[else]soft[end if] shoulder cupped in your hand, 'about a pilgrim and the wisest man in the world. The pilgrim wanted to know why the world was the way it was. To each question the wise man would only say, [']Because it is.[']' [CHeShe] breathes against you. 'I have never decided whether to love or hate that story.' And you hold [himher] tighter.".

To say tpl3: say "'What do you see?' asks Rume, as you gaze up at the clouds circling the peak together. 'Do you see shapes behind the clouds? Stories behind the shapes? Worlds behind the stories and luminous truths behind the worlds?' [CHeShe] smiles wryly, touching your eyelids lightly. 'Or do you see only clouds?'".

To say tpl4: say "'Look,' Rume says, holding it out to you, 'Isn't he beautiful?' but [heshe] sees in your eyes that all you can see is a tiny green caterpillar, and [heshe] tries again. 'It was just born from filth and rot and darkness,' [heshe] says as it inches tentatively over [hisher] hand, 'and has a whole life to lead. Then, when it's grown weary and ready to die, it will be reborn to begin all over again.' [CHeShe] sighs. 'And look how happy he is, regardless.'".

To say tpl5: say "'I'd think you would have learned by now,' Rume says, features etched by the frigid winter breeze into smooth contours of wind-channeled surface. 'I am never cold. I feel cold, yes, sometimes so much that it's hard to ignore. Cold could kill my body if I do not protect myself from it. But cold is only one way of perceiving the snow and the winter. Cold is a state of mind.' [CHeShe] smiles, breath crystallizing in the air. 'I am not cold.'".

To say tpl6: say "'Here is home,' Rume says to [kidsname], touching a point on the old map, 'and here is the spur of the mountains, and here the seven glaciers. And beyond, the uplands. And farther...' [CHisHer] hand traces delicate lines towards a smooth and blank section of the map. 'Here we have never been, nor known anyone to go. Imagine that. Only four days away lies the Unknown.' [CHeShe] smiles, hugging your [if kidismale is true]son[else]daughter[end if] close. 'We are such small creatures. I wonder what the world makes of us.'".

To say tpl7: say "Rume carries another heavy pile of firewood inside, framed by the ugly black and green clouds, and must see some fear deep in your face, for [heshe] pauses and touches your hand. 'My love,' [heshe] says, 'there is nothing to worry about. Blizzards are out of our hands, you and I. All we can do is take what comes, no matter how fierce, and survive.'".

Blue Flash 1 is a flash-room with printed name "Ice Shelf Near Home" and description "ice, you call to Rume, but [if Rume is female]s[end if]he knows that, knows to stay on the blue ice, but the mammoth skeleton gleams within the glacier and [if Rume is female]s[end if]he's almost there and suddenly the shelf gives way beneath [himher] and [heshe]'s falling, skidding down the slope and you trip after [himher] snowshoes catching and heart thumping and finally reach [hisher] side". 

Blue Flash 2 is a flash-room with printed name "Outside The Tumble" and description "eyes, [gf2kidbit1], and [if children are possible]the two of you hold [kidhimher] in your arms[otherwise]you can see how scared [kidheshe] is but hungry at last to finally have a home, holding the two of your hands tight[end if], little [kidsname], as the [if children are possible]fat little doctor[otherwise]pompous official[end if] [gffr2]". To say gffr2: say "from town out of breath from the bumpy sleigh ride up [if children are possible]coos reassuringly[else]signs paperwork[end if], and [if children are possible]the baby cries[otherwise if kidismale is true]the boy swallows nervously[otherwise]the girl trembles nervously[end if]".

To say gf2kidbit1:
	if The-Path-Of-Love has not happened:
		if children are possible:
			if a random chance of 1 in 2 succeeds, now kidismale is true;
			otherwise now kidismale is false;
		otherwise:
			if player is male, now kidismale is false;
			otherwise now kidismale is true;
	if player is male and Rume is female:
		say "just like [kidhisher] mother's";
	otherwise if player is female and Rume is male:
		say "just like [kidhisher] father's";
	otherwise if Rume is male:
		say "like Rume's, [kidhisher] adopted father";
	otherwise:
		say "like Rume's, [kidhisher] adopted mother".

To say kidhisher: if kidismale is true, say "his"; otherwise say "her". To say kidheshe: if kidismale is true, say "he"; otherwise say "she". To say kidhimher: if kidismale is true, say "him"; otherwise say "her".

Blue Flash 3 is a flash-room with printed name "The Tumble, [kidsname]'s Room" and description "of the sky fades in the darkling window as night breezes rustle while [kidsname] listens with wide eyes to Rume's bedtime story, tucked in bed under warm furs, and you watch and listen fondly at the way your love weaves the words, [hisher] voice dancing and lilting through the old tale".

Blue Flash 3a is a flash-room with printed name "The Cellar" and description "in the painting, covered in a faint layer of dust now but still potent, powerful, and you wonder why you never destroyed it and you wonder why you keep coming down here and pulling back the dusty burlap and staring at it, and Rume comes down the stairs behind you while [kidsname] recites above and Rume closes the cellar door and puts [hisher] arms around you, the wooden bracelet hard against your stomach, and stares at the painting with you and [heshe] asks if you still hear the Call".

Blue Flash 4 is a flash-room with printed name "Your Bedroom" and description "eyes flash as [heshe] screams at you in fury, each of Rume's words hammering into the ache in your head like nails, each argument rising to the surface and being sucked under again by momentum, like jetsam in a river eddy, again and again, and finally you can't take any more".

Blue Flash 5 is a flash-room with printed name "At Dinner Around The Fire" and description "-green leaves from the garden and Rume's buttered red potatoes and [kidsname]'s fresh meat, and [kidheshe] boasts to the grizzled trapper about the kill again and again, reliving the details of the flushing and the flintlock and the thrill of victory, [kidhisher] first successful hunt, and you take your first bite of the smoked meat".

Blue Flash 6 is a flash-room with printed name "The Garden" and description "eyes blaze as [heshe] tells your child [kidheshe]'s absolutely forbidden, but [kidsname], almost a [if kidismale is true]man[otherwise]woman[end if] now, kicks over a corn stalk savagely and shouts that you don't understand what it's like living up here alone, you're a couple of rooted hermits, you've forgot what adventure even is, and Rume flushes".

Blue Flash 7 is a flash-room with printed name "Your Bedroom" and description "shadows between the pine boughs that Rume still hangs from the rafters through twenty winters now, the old loft room now filled with treasures and mementos and the scuffs and scratches and sweat of a lifetime, and the wind beats against the old timbers of the house where the two of you have spent this past quiet year, alone again, and you remember the night like this those dim and distant years ago when you chose between [if we chose love]love and art and chose love[otherwise]art and love and chose art[end if]".


The flash list is a list of rooms that varies. The flash list is {Blue Flash 1, Blue Flash 2, Blue Flash 3, Blue Flash 4, Blue Flash 5, Blue Flash 6, Blue Flash 7}.


After reading a command when location is a flash-room (this is the Homeworld Blue Flash trickery rule):
	let pcmd be indexed text; 
	let pcmd be the player's command; 
	say line break;
	if location is Blue Flash 1:
		if pcmd matches the regular expression "(all right|alright|allright|ok|hurt|help|alive)":
			say "but Rume is laughing, brushing the snow from [hisher] face and saying yes, I'm fine, I'm fine, ";
		otherwise if pcmd matches the regular expression "(what|how|happen)":
			say "but Rume is laughing, saying nothing happened, nothing happened, just a bit of a tumble, ";
		otherwise if pcmd matches the regular expression "(careful|fall|fell|slip)":
			say "but Rume laughs and says [heshe]'s always exactly as careful as the situation requires, ";
		otherwise if pcmd matches the regular expression "love":
			say "and Rume laughs, kissing you back, says [heshe] loves you too and [heshe]'s alright, all right, ";
		otherwise if pcmd matches the regular expression "why":
			say "but you know why and Rume knows you know; [heshe]'s an explorer, an adventurer to the bone, like you, and you can't stay mad... ";
		otherwise:
			say "but Rume doesn't hear you over [hisher] laughter, whooping and scraping the snow from [hisher] face and saying it's okay, it's okay, I'm fine, ";
		say "and you feel such an intense rush of gratefulness and love and kiss [himher] between [hisher] eyes, so beautiful and blue";
	otherwise if location is Blue Flash 2:
		if pcmd matches the regular expression "(hug|hold|shoulder|kiss)":
			let actionword be 1;
		otherwise if pcmd matches the regular expression "(smile|grin)":
			let actionword be 2;
		otherwise if pcmd matches the regular expression "(say|tell|explain|talk)":
			let actionword be 3;
		otherwise if pcmd matches the regular expression "(rock|shake|nurse|shush)":
			let actionword be 4;
		otherwise if pcmd matches the regular expression "(slap|hit|punch|drop|kick|hurt|smack)":
			let actionword be 9;
		otherwise:
			let actionword be 5;
		if actionword is 9, say "or at least you want to, because life here is hard, and it's a lesson that must be learned quickly";
		else say "and [kidheshe] [if children are possible]smiles and gurgles up at you [otherwise]looks up at you bravely, [end if][if actionword is 1]hugging you back[otherwise if actionword is 2]smiling back[otherwise if actionword is 3]listening gratefully[otherwise if actionword is 4]quieting down again[otherwise]holding your hand tight[end if], and";
		say " you look up into Rume's eyes and reflected there is your joy and terror and trepidation and concern at this new frontier of parenthood, reflected in the blue";
	otherwise if location is Blue Flash 3:
		if pcmd matches the regular expression "(go|leave|exit)":
			say "but no, you'll stay, stay and hear the end of the story";
		otherwise if pcmd matches the regular expression "(stay|listen|intrude|wait)":
			say "and decide you should, stay and hear the end of the story";
		otherwise if pcmd matches the regular expression "(join|tell|help|participate|speak|story|say|talk|act|sing)":
			say "and when Rume pauses for a moment you step forward and add your own pieces to the story, and Rume squeezes your hand fondly and [kidsname] listens to you eagerly";
		otherwise if pcmd matches the regular expression "(kiss|hug|caress|touch)":
			say "and you want to but want to keep from interrupting the flow of the story more, so you wait and let Rume go on";
		otherwise if pcmd matches the regular expression "(stop|interrupt|punish|intervene)":
			say "but decide no, [kidheshe]'s old enough now to hear the real stories, all their terror and wonder and fantasies and realities";
		otherwise:
			say "but no, you'll stay, stay and hear the end of the story";
		say ", and Rume tells and the story lives in the spaces between you three and you're content, at peace here in your home in the blue";
	otherwise if location is Blue Flash 3a:
		if pcmd matches the regular expression "(don't know|dont know|not know|not sure|unsure|can't tell|cant tell)":
			say "and [heshe] hugs you and says if you can't tell doesn't that mean you can't? But you don't know, don't know";
		otherwise if pcmd matches the regular expression "(can't|no|don't|never hear)":
			say "and [heshe] squeezes your arm and asks why you don't burn it then but you can't explain, can't explain how each painting is a part of you, even or especially those left unfinished";
		otherwise:
			say "and there is a long silence before Rume hugs you silently, and you feel [hisher] tears seep into the back of your shirt, and you wish you could destroy the painting but you can't, it would be like burning a part of yourself";
		say ", and Rume asks you to come back upstairs and help [kidsname] with [kidhisher] poem and you roll the burlap back over the canvas and the last color you see is a shade of blue";
	otherwise if location is Blue Flash 4:
		if pcmd matches the regular expression "(hit|strike|attack|slap|punch|kill|strangle|choke|murder|push)":
			say "and Rume stumbles to a halt, holding a hand to [hisher] face and staring at you in shock";
		otherwise if pcmd matches the regular expression "(scream|yell|shout)":
			say "and Rume stops in mid-word, face pale in the lamp light, before sinking to the bed and your throat hurts from the sound";
		otherwise if pcmd matches the regular expression "(give up|give in|concede|cease|stop|let him|let her|sorry)" or pcmd matches the regular expression "(apolog|wait)":
			say "and Rume quiets, thinking, and finally comes to you and holds you, tears wettening your shoulder, and murmuring that it doesn't matter, doesn't matter who's right, doesn't...";
		otherwise if pcmd matches the regular expression "(leave|go|exit|west|out|outside|run|away|walk)":
			say "but [heshe] yells after you telling you to come back this isn't finished but you keep walking down the stairs anyway, the stream barely audible over [hisher] voice";
		otherwise if pcmd matches the regular expression "(cry|weep|tears|sob)":
			say "and Rume stops in mid-word, as if catching, tripping on your tears, and suddenly there are tears in [hisher] eyes too";
		otherwise if pcmd matches the regular expression "(hug|kiss|hold)":
			say "and Rume stops in mid-word, trembling for a long moments before holding you back, tears suddenly seeping into your shoulder";
		otherwise:
			say "and the argument keeps going, ill-fitting circles of words screeching and abrading against each other";
		say ", and you wonder if this is what you stayed for, if you gave up your greatest gift for this, for the tears in Rume's blue";
	otherwise if location is Blue Flash 5:
		if pcmd matches the regular expression "(terrib|aweful|awful|bad|gross|bitter|rancid|nasty|foul)" or pcmd matches the regular expression "(off|disgusting|crap|shit|ash)":
			say "but you keep chewing and smiling because this is [kidsname]'s moment and you see the trapper's eyes go wide as he chews his first bite through his beard but he does the same";
		otherwise if pcmd matches the regular expression "(average|bland|undercooked|normal|typical|unexceptional)":
			say "but you keep chewing and smiling because this is [kidsname]'s moment and across the table the trapper praises it and maybe he's being kind or maybe after weeks in the woods he really does like it";
		otherwise if pcmd matches the regular expression "(great|good|delicious|fantastic|wonderful|flavor|yum|tasty|nice|fine)":
			say "and the trapper says through his bushy beard it's the best venison he's had in months and [kidsname] beams";
		otherwise:
			say "and the trapper thanks you all again for putting him up";
		say " and across the table you catch Rume's glance and the two of you share a secret smile, [hisher] eyes absorbing the crackling fire but still the same blue";		
	otherwise if location is Blue Flash 6:
		if pcmd matches the regular expression "(havent|not|no|false|wrong|lie|impossible|never|isnt|cant)":
			say "because you do remember, you do know, and of course your [if kidismale is true]boy[otherwise]daughter[end if] feels it too, and you can't ask [kidhimher] to stay here with the two of you forever";
		otherwise if pcmd matches the regular expression "(right|yes|true|have|correct)":
			say "but how could [if kidismale is true]he[else]she[end if] be, how, how could a Wayfarer forget";
		otherwise if pcmd matches the regular expression "(growing up|old|grown|grow|almost|man|woman|leave|ready|boy|girl)":
			say "and soon [if kidismale is true]he[else]she[end if] will be leaving, setting out into the world";
		otherwise if pcmd matches the regular expression "(sad|frustrat|lone|alone|angry|bitter|rebel|bad|vent)":
			say "and you wonder again whether you did right to raise [if kidismale is true]him[else]her[end if] in this lonely valley of a lonely world";
		otherwise:
			say "and you don't know what to say";
		say ", and [kidsname] turns and angrily stalks off into the forest, and you look at Rume, [hisher] face more deeply lined than it seemed even this morning, but [hisher] eyes only deepening with age into richer and richer shades of blue";
	otherwise if location is Blue Flash 7:
		if pcmd matches the regular expression "(flawed|unfair|not fair|rigged|stupid)":
			say "because life is not divided into extremes, blacks and whites";
		otherwise if pcmd matches the regular expression "(hard|difficult|not easy|challenging)":
			say "so hard that you still to this day wonder how things might have happened if you had chosen differently";
		otherwise if pcmd matches the regular expression "(irrelevant|inconsequential|unimportant|not important|meaningless|trivial|pointless)":
			say "because even the Call could not change the fact that you'd already made your choice to stay with Rume";
		otherwise if pcmd matches the regular expression "(wrong|incorrect|not|bad|poor)":
			say "[if we chose love]because you should have followed your heart and answered the Call and not left Rume tied to someone flawed and imperfect[otherwise]because losing Rume even then would have scarred you for the rest of your life[end if]";
		otherwise if pcmd matches the regular expression "(right|correct|ok|good|simple|inevitable)":
			say "[if we chose love]because losing Rume even then would have scarred you for the rest of your life[otherwise]that you should have followed your heart and answered the Call and not left Rume tied to someone flawed and imperfect[end if]";
		otherwise:
			say "and you toss and turn";
		say " and Rume sleeps beside you and [if The-Path-Of-Love has happened]in a flash you remember that this is your last night here, your last night before you finally answered the Call and left Rume here alone and suddenly [hisher] eyes fly open and[otherwise]in a flash you realize this never happened, you didn't stay here, this is just a dream, and Rume's eyes suddenly open and[end if] [heshe] looks at you desperately and you try to hold on to the look in those eyes, those beautiful blue";
	change the command prompt to ">";
	if the number of entries in flash list > 0, remove entry 1 from flash list;
	if The-Path-Of-Love is happening:
		if the number of entries in flash list > 0:
			say "[paragraph break]blue";
			process Blue Flash;
		else:
			print a section break;
			say "[paragraph break]...but you shake your head. It was just a dream. You're still here today, and Rume is still at the Tumble, and if you don't make this shot you're going to be eating more of last year's freezer-burned venison again.";
			change the time of day to 9:00 AM;
			now player carries flintlock pistol;
			move player to The North Vale;
	else:
		move player to saved location, without printing a room description;
		say "[line break][bold type][location][roman type][line break]"; 
		aftersunbit;
	reject the player's command.

To aftersunbit:
	say "flash fades, and the sun vanishes below the waves.[paragraph break]";
	pass 16 minutes of time;
	remove the sun from play;
	if The-Path-Of-Love has happened:
		say "[one of]The memory was intense and vivid, and you take a deep breath, shaken. For the color of that flash was precisely the shade of Rume's eyes[or]Again, the memory was as real as the first time you lived it, and the color of the flash the precise shade you remember[stopping].";
	otherwise:
		say "[one of]The vision was intense and vivid, as if from some equally real world where you chose to stay with Rume, rather than answer the Call, and you can't help but grieve. For the color of that flash was precisely the shade of Rume's eyes[or]Again, the vision was so intense you almost can't believe it's not a memory, and the color... the shade is exactly what you remember[stopping].".
	

Part - Intelligent Hinting Support

Homeworld-Sequence requires Finishing-The-Prologue, Exploring-Homeworld, Starting-the-Painting, Conversing-With-Rume, Finishing-the-Painting.

quorking is a puzzle.

Finishing-The-Prologue is a task. The command-sequence is { "man", "woman", "art" }. Definition: Finishing-The-Prologue is complete: if Prologue has ended, yes.

A fast-forward rule for Finishing-The-Prologue:
	now Rume is male;
	now yourself is male;
	now easel is in Homeworld-Studio;
	force discuss pr_art;
	now pr_art is spoken;
	now pro_track is 4.

Exploring-Homeworld is a puzzle. It requires Exploring-Bedroom, Exploring-Kitchen.

Exploring-Bedroom is a task. The venue is Your Bedroom. Requirements for Exploring-Bedroom: do the action of examining nightstand; do the action of examining drawing; do the action of examining pine boughs. Definition: Exploring-Bedroom is complete: if extended-hint-mode is false, yes; if rc_greet is spoken, yes; if location is not regionally in Homeworld, yes; if we have examined pine boughs, yes.

Exploring-Kitchen is a task. The venue is Kitchen. Definition: Exploring-Kitchen is complete: if extended-hint-mode is false, yes; if rc_greet is spoken, yes; if location is not regionally in Homeworld, yes; if Kitchen is visited, yes.

Starting-the-Painting is a task with venue Homeworld-Studio. Requirements for Starting-the-Painting: do the action of painting lacuna-canvas. Definition: Starting-The-Painting is complete: if lacuna-canvas is not unbegun, yes.

A fast-forward rule for Starting-the-Painting:
	move the player to Homeworld-Studio, without printing a room description;
	now the player wears the outfit;
	now the fireplace is raging;
	now the paintbrushes is carried by the player;
	now the lacuna-canvas is mostly finished.

Conversing-With-Rume is a task. Requirements for Conversing-With-Rume: do the action of discussing rc_call; do the action of discussing rc_duty; do the action of discussing rc_cantgo; do the action of waiting; do the action of discussing rc_wontstay; do the action of discussing rc_pity. Definition: Conversing-With-Rume is complete: if extended-hint-mode is false, yes; if location is not regionally in Homeworld, yes; if the number of terminal spoken beats in RC > 0, yes. A red flag rule for Conversing-With-Rume: if Rume is idle, rule fails. 

Finishing-the-Painting is a task with venue Homeworld-Studio. Requirements for Finishing-the-Painting: do the action of painting lacuna-canvas; do the action of painting lacuna-canvas. Definition: Finishing-The-Painting is complete: if lacuna-canvas is finished, yes.

A fast-forward rule for Finishing-the-Painting:
	now lacuna-canvas is finished;
	now last beat is silence.

Volume - The Island of Lacuna (in Lacuna-Lacuna by Blue Lacuna)

Book - General Configuration

Part - Setup & Initialization

Section - Description Helpers

[By sticking [bw of room] before each exit, the player is told which exit they just came from, which helps with geography and navigation.]

To say bw of (rm - a room):
	if former location is rm, say "back ".

To say bwt of (rm - a room):
	if former location is rm, say "back to ".

To decide whether longform:
	if location is unvisited, yes;
	if player-looking is true, yes;
	no.

To say dot: say ".[paragraph break]".

To say room ambience:
	if the ambience table of location is not Table of No ambience:
		fire one off by frequency from the ambience table of location, definitely selecting;
	otherwise:
		let reg be a random region-relevant region;
		if reg is a region:
			fire one off by frequency from the ambience table of reg, definitely selecting;
		otherwise if a random chance of 1 in 2 succeeds:
			fire one off by frequency from Table of Lacuna Weather ambience, definitely selecting;
		otherwise:
			consider time of day ambience;
			if the number of filled rows in Table of Potential Messages > 1:
				fire one off by frequency from Table of Potential Messages, definitely selecting;
			otherwise:
				fire one off by frequency from Table of Lacuna Weather ambience, definitely selecting.

To say time ambience:
	consider time of day ambience;
	if the number of filled rows in Table of Potential Messages > 1:
		fire one off by frequency from Table of Potential Messages, definitely selecting;
	otherwise:
		fire one off by frequency from Table of Lacuna Weather ambience, definitely selecting.
	
Section - Setting up for Story Mode

Activating-Story-Mode is a scene. Activating-Story-Mode begins when story mode and location is regionally in Lacuna. Activating-Story-Mode ends when the time since Activating-Story-Mode began is at least 0 minutes.

When Activating-Story-Mode begins:
	remove turtle button from play;
	remove crab button from play;
	remove seagull button from play;
	remove bee button from play;
	remove spider button from play;
	remove whale button from play;
	remove red wheel from play;
	remove yellow wheel from play;
	remove blue wheel from play;
	move boiler handle to Volcano Floor;
	now boiler handle is part of brick boiler;
	remove etchings from play;
	move alternate-etchings to Observatory Exterior;
	now alternate-etchings is part of pyramid;
	remove sticky wire from play; 
	remove thick cable from play;
	now secret rope bridge is open;
	remove wooden archway from play;
	remove secret-bridge control from play;
	remove mountain scrawl from play; 
	remove bee words from play;
	remove tree words from play.



Part - World Behaviors

First report taking off homemade outfit when location is regionally in Lacuna: say "You slip out of your traveling clothes, enjoying the feel of the warm breeze on your skin." instead. Check dropping homemade outfit: say "Better not. You don't want to lose them." instead. First report wearing homemade outfit when location is regionally in Lacuna: say "You slip back into your clothes." instead.

Check examining by name when location is regionally in Lacuna (this is the default to going towards views in Lacuna rather than examining them rule):
[	if noun is lava flow and location is South Beach, try wordgoing Center Beach instead;
	if noun is lava flow and location is Center Beach, try wordgoing North Beach instead;
	if noun is lava flow and location is North Beach, try wordgoing Rise instead;
	if noun is lava flow and location is Lower Beach, try wordgoing North Beach instead;]
	if noun is nearby beach and location is Lower Beach, try going southeast instead;
	if noun is nearby beach and location is Ocean Waters begin; try going east instead; end if;
	if noun is nearby beach and location is Rise, try going southeast instead;
	if noun is rainforest and location is Crater Pond, try going north instead;
	if noun is rainforest and location is Hive Room, try going east instead;
	if noun is rainforest and location is Viewpoint, try going south instead. 

Section - Landmarks

Carry out landmark-listing when location is regionally in Lacuna:
	say "The landmarks you've discovered are: ";
	repeat with locale running through visited landmarked rooms regionally in Lacuna begin;
		say "[line break]  ";
		if the landmark name of locale is not "null", say the landmark name of locale; otherwise say locale;
		if locale is location, say " (you are here)";
	end repeat;
	say line break.

The landmark name of Center Beach is "the [d]middle[x] of the beach". Understand "middle/cabin" as Center Beach. Check entering lagoon when Center Beach is visited and location is not Center Beach: try landmark-going Center Beach instead. Understand "lagoon" as Center Beach.
The landmark name of Fork is "the [d]clearing[x] where you first arrived". Understand "clearing" as Fork. 
The landmark name of East Marsh is "the [d]marshlands[x]". Understand "marshlands" as East Marsh. 
The landmark name of Chairlift Base is "the ropeway base [d]station[x]". Understand "station" as Chairlift Base. Check entering distant-ropeway when Chairlift Base is visited: try landmark-going Chairlift Base instead. 
The landmark name of Volcano Floor is "the volcano [d]collapse[x] at the boiler". Understand "collapse" as Volcano Floor. Check entering volcano proper when Volcano Floor is visited: try landmark-going Volcano Floor instead.
The landmark name of Hive Room is "the [d]hive[x]".
The landmark name of Egg Room is "the egg [d]ship[x]". Understand "ship" as Egg Room.
The landmark name of Overhang is "the [d]grotto[x] on the secret island". Understand "grotto" as Overhang.
 
Instead of landmark-going when location is regionally in Lacuna: 
	if noun is location, say "You're already here." instead;
	if ready to landmark-go begin;
	now we-are-landmark-going is true;
	unless location is Saddle or location is Atop or location is Top of Cave, now withered vine is closed; [ This prevents going through the ridge, which won't work if the tide is in, but we leave the opposite in so we can get down if we're starting from there. ]
	if noun is not a room, try examining noun instead;
	while location is not noun and we-are-landmark-going is true begin;
[		now wordgoing-flag is true;]
		if location is Ocean Waters, let aim be the best route from the location to noun through visited rooms; 
		otherwise let aim be the best route from the location to noun through landed visited rooms; 
		if aim is a direction, let target be the room aim from location;
		if aim is not a direction or target is not a room begin;
			say "[as the parser]Either you don't know how to get there from here, or something unusual is happening. You'll have to take it one area at a time from here[as normal]."; 
			tidy landmark-go;
			stop; 
		end if; 
		try silently going aim;
		if location is not target or the number of attentive people enclosed by location > 0 begin; 
			clean up landmark-go;
			tidy landmark-go;
			stop;
		otherwise;
			add location to travelogue;
		end if;
		follow the turn sequence rules;
	end while;
	tidy landmark-go;
	clean up landmark-go;
	end if.

To tidy landmark-go: [Lacuna-specific rules after landmark-going.]
	if withered vine is unlocked, now withered vine is open.

Section - Exploring Lacuna

Exploring Lacuna is a recurring scene. Exploring Lacuna begins when the player is regionally in Lacuna and Exploring Lacuna is not happening and Completing-Progue's-Character-Arc is unsolved. When Exploring Lacuna begins: the daemon wakes in one hour from now.    

When Exploring Lacuna begins: now the mind machinery is idling; change time factor to 3; now distant ocean is seen.

 Exploring Lacuna ends when the player is not regionally in Lacuna.

Chapter - General Ambience


Table of Lacuna Weather ambience
freq		text	table		trigger	flag
common	"A gust of wind catches your hair, tousling it this way and that before dying down."
common	"[if day]The sun ducks behind a high, fast moving white cloud for a moment, then returns to its former brilliance[end if][if night and moonup]High clouds cover the face of the moon, but in only moments they have moved on[end if][if night and moondown]Faint patterns of clouds move over the galactic spectacle above, as if the stars are one by one winking out and then returning[end if]."

Table of Lacuna Insect ambience
freq			text	table		trigger	flag
rare		"A small colorful beetle inches its way carefully along the ground near your foot."	--	crimson beetle
rare		"A small dark bug twirls past your head, its wings making a dull, lazy buzz."	--	black bug
rare		"A swarm of tiny winged insects, each no bigger than a pinhead, drifts by with the breeze."	--	swarm-of-midges
superrare		"A tiny spider drifts by on a gust of wind, strands of web catching on a clump of vegetation before it frantically scurries out of sight."	--	tiny spider
rare		"A brown spider with a fat body scuttles through the underbrush."	--	brown spider

An insect is a kind of set dressing. Understand "insect/insects/bug/bugs" as an insect. Check attacking an insect (called buggie):  remove buggie from play; say "[one of]You destroy the tiny [buggie][or]Effortlessly you crush the [buggie][at random]." instead. The description of an insect is usually "Gone already." Check taking an insect: say "You reach out a hand, but the tiny creature evades your grasp and hurries away." instead.

A crimson beetle is an insect. The description is "You bend closer to study it. Tiny gold threads stretch around its carapace, which is otherwise a deep crimson. It halts and quivers anxiously as you make a sudden movement." Check taking the beetle: say "You put your hand in front of it, but it turns and marches in another direction." instead. 

A black bug is an insect. The description is "It is gone almost before you can turn your head to study it more closely."

A swarm-of-midges is an insect. The printed name is "swarm of midges". Understand "swarm/midge/midges" as swarm-of-midges when swarm-of-midges is enclosed by location. The description is "For some reason, these seem to exist on nearly every world." Check taking the swarm-of-midges: say "They are almost as insubstantial as dust." instead.

A tiny spider is an insect.

A brown spider is an insect. The description is "Its legs are covered in tiny hairs, but its fat body is smooth and hairless.". Check attacking a brown spider: remove brown spider from play; say "You squash the brown spider, leaving behind only a leg-strewn smudge." instead. Check taking a brown spider: say "You let the creature crawl over your hands for a minute. Finally the tickling from its hairy legs forces you to put it back down and let it crawl away." instead.





Part - Lacuna Systems

Chapter - Power System

Section - The Pipes

A pipe is a kind of backdrop.  Understand "bamboo" or "pipe" or "piping" or "pipes" or "network" or "paint" as a pipe. A pipe has a number called pressure. Does the player mean turning or adjusting a pipe: it is very unlikely. The description of a pipe is usually "Once coated in now-flaking paint, the pipe, about as wide as your fist, is made from thick pieces of bamboo sealed together with vines coated with sticky tar.". Understand "follow [a pipe]" as a mistake ("[followpipemsg]."). Instead of pushing or pulling a pipe: say "It's firmly anchored in place." Understand "smoke [a pipe]" as a mistake ("It's not that kind of pipe."). Understand "fill [a pipe]" as a mistake ("The pipe is completely sealed; there's no opening."). Check climbing a pipe when location is Chasm Floor or location is Ravine Floor or location is Observatory Exterior: say "The pipe is too [if pressure of noun > 0]hot[else]smooth[end if] to get a grip on." instead.

To say followpipemsg: [These shouldn't have periods appended because ?]
	let item be noun;
	if item is red pipe, say redpipedetailmsg;
	if item is blue pipe, say bluepipedetailmsg;
	if item is yellow pipe, say yellowpipedetailmsg.

Section - The Pressure Gauges

[The pressure gauge at each device shows how much power it needs and how much it is receiving. Since this info is irrelevant in story mode, we omit mentioning it in room descriptions.]

A pressure gauge is a kind of container. Understand "quartz" or "cylinder" or "curious" or "pressure" or "numbered" or "line/lines" or "ring/rings" or "guage" as a pressure gauge. A pressure gauge is usually closed, unopenable, fixed in place and transparent. A pressure gauge has a number called target pressure. A pressure gauge has a pipe called related pipe. The description is "About the height of your hand, this hollow cylinder [connectionbit]. Meticulously carved from a solid piece of quartz, you can see through to the inside, where [if curr_press >= 7 and curr_press <= 30]torrents of steam rush upwards through roiling[otherwise if curr_press >= 1 and curr_press <= 6]steam bubbles up through boiling[otherwise]floats a tiny pool of standing[end if] water.[paragraph break]A series of thirty delicate rings are etched into the quartz; a firm black line marks the point [target pressure of noun in words] ring[s] up from the bottom.[paragraph break][pipe2bit].". To say pipe2bit: say "The [if curr_press >= 7]water dances around[otherwise]water level is currently[end if] [if curr_press is 0]even with the bottom ring[otherwise][curr_press in words] ring[s] up from the bottom[end if]". To say connectionbit: say "connects the [o]pipe[x] to the [if location is Chairlift Base]ropeway [o]mechanism[x][otherwise if location is Observatory Exterior][o]pyramid[x][otherwise][o]mechanism[x][end if]".

The dream-text of a pressure gauge is usually "long hollow tubes of quartz snaking off into the walls". Understand "fill [a pressure gauge]" as a mistake ("The cylinder is completely sealed; to the pipe on the bottom end, and the outflow [o]tube[x] on the other."). Check examining a pressure gauge when night: say "It's too dark to make out any details of the cylinder's appearance." instead. Check attacking a pressure gauge: say "The gauge is carved from solid quartz; without a hammer and chisel, you won't be able to make much of a dent." instead. Check opening a pressure gauge: say "It's a solid piece of transparent quartz, firmly connected on one end to the pipe and on the other to the [if location is Chairlift Base]ropeway mechanism[else if location is Observatory Exterior and pyramid is on-stage]base of the pyramid[else if location is Observatory Exterior]base of the chair[else if location is Chasm Floor or location is Chasm Edge]rock wall[else]boiler[end if]." instead. Check pushing a pressure gauge: say "It's firmly attached to the pipe and the whole thing is solidly anchored." instead.

To say gauge-description: say "[one of]A strange quartz [o]cylinder[x][or]A quartz pressure [o]gauge[x][stopping]".

To decide which number is curr_press: 
	let x be pressure of related pipe of noun;
	if puzzle mode and noun is the ropeway pressure gauge begin;  [ Reduce it by a bit less than half due to leak ]
		if x is 4 begin; now x is 2;
		otherwise if x is 5; now x is 3;
		otherwise if x is 6; now x is 3;
		otherwise if x is 7; now x is 4; 
		otherwise if x is 8; now x is 5;
		otherwise if x is 9; now x is 5;
		otherwise if x is 10; now x is 6;
		otherwise; now x is x / 2; end if;
		if the bucket is not stationary, now x is x - 4; 
	end if;
	decide on x.

An outflow tube is a kind of setpiece. Understand "bamboo" or "tube" or "outflow" or "long" or "vent" as an outflow tube. The description of an outflow tube is usually "The tube [if location is Volcano Floor]emerges from the top of the boiler[otherwise if location is Chasm Edge]pokes up from the ground near the vent[otherwise if location is Chasm Floor]sticks out of the side of the chasm near its top[otherwise if location is Observatory Exterior]pokes up from the ground nearby[otherwise]rises from the top of the mechanism[end if][if location is Volcano Floor][state of current outflow][otherwise][state of pressure of related pipe of noun][end if][otd2].". To say otd2: say "[if puzzle mode and location is Volcano Floor]. [gauge-description] serves as a join between the tube and the [o]boiler[x] itself[otherwise if puzzle mode and location is Observatory Exterior], joined to the pipe by a quartz [o]gauge[x][end if]". An outflow tube has a pipe called related pipe. Check entering an outflow tube: say "The tube is only about as wide as your forearm." instead. The dream-text of an outflow tube is usually "giant tubes of bamboo". Check climbing an outflow tube: say "It's not high or sturdy enough to climb.".


Chapter - The Windsigh Trees

A windsigh tree is a kind of setpiece. Understand "tree" or "curious" or "trunk" or "gnarled" or "root" or "roots" or "windsigh" or "bark" or "tree i painted" or "strange" as a windsigh tree. The printed name of a windsigh tree is usually "[if tree1 is named]a windsigh tree[otherwise if location is Fork]the tree you painted[otherwise][tree_rnd][end if]". Rule for printing the name of a windsigh tree (called subj) while asking which do you mean: say "[if tree1 is named]the windsigh[else]the tree[end if] [if subj is tree1]at the path[else if subj is tree2]with the treehouse[else if subj is tree3]on the ridge[else if subj is tree4]on the cinder cone[else if subj is tree5]in the rain forest[else if subj is tree6]by the Egg[else]at the rockslide[end if]". Understand "tree9" as a windsigh tree.

The description of a windsigh tree is usually "Like the other[if trees found is at most 2] one you saw[otherwise]s you've seen[end if], the tree seems stunted and out of place. [the tree spiel].". To say the tree spiel: say "Spirals of [o]vine[x] sprout from the gnarled trunk and wrap tightly around it before spreading out to knobby branches beginning just above your head. The branches bifurcate until they end in tiny, bare pointed twigs. As the vines spiral around them they sprout hundreds of small lemon-yellow [o]leaves[x]. Even more curious is that dozens of [o]holes[x] seem to have organically grown through the branches, as if they split and reconnected to themselves as the tree was growing; these also continue all the way out to the tiny twigs, shrinking in size as they go". To say tree_rnd: say "tree". Check attacking a windsigh tree: say "[if guessed_trees is true]Some part of you shivers at the thought; so defenseless they are, helpless against anything you could do-- but if you do make such a decision, better to wait until the right moment[otherwise]The trees seem fairly sturdy. Without an axe or something you doubt you could do much damage[end if]." instead. The dream-text of a windsigh tree is usually "[one of]miniature models of twisted, perforated trees[or]buckets of lemon-yellow paint[in random order]".

Check listening when a windsigh tree is enclosed by location: say "As the wind gusts through the dozens of holes in the trunk and branches of the tree, a strange, multi-pitched hum sighs and shivers through the air." instead.

Understand "sleep under [a windsigh tree]" as sleeponing. First check sleeponing: if noun is a windsigh tree, try sleeping instead.

A windsigh tree has a number that varies called order found.

To decide which number is trees found:
	let highest be 0;
	repeat with tmp running through windsigh trees begin;
		if the order found of tmp > highest, now highest is order found of tmp;
	end repeat;
	decide on highest.

To say windsigh phrase of (entity - a thing):
	if the order found of entity is 0 begin; [just now finding it]
		let highest be 0;
		repeat with tmp running through windsigh trees begin;
			if the order found of tmp > highest, now highest is order found of tmp;
		end repeat;
		now order found of entity is highest + 1;
		let ord be order found of entity;
		if tree1 is named, say "[if ord is 2]another tree like the one you painted -- a [o]windsigh[x][otherwise]another [o]windsigh[x] tree[end if]"; 
		otherwise say "[if ord is 1]the [treeword] you painted[otherwise if ord is 2]-- curious -- another [treeword] like the one you painted[otherwise if ord <= 4]another strange, withered [treeword] like the one that brought you here[otherwise if ord is 5]another withered [treeword] -- the fourth? fifth? -- [otherwise]another withered [treeword][end if]";
	otherwise;
		let ord be order found of entity;
		say "the ";
		if entity is tree3, say "huge ";
		if entity is tree6, say "tiny ";
		if entity is tree7, say "hardy ";
		if tree1 is named, say "[o]windsigh[x]";
		otherwise say "withered [o]tree[x]";
	end if;
	
To say treeword: say "[o]tree[x]".

A windsigh tree is either uncontacted or contacted. A windsigh tree is usually uncontacted.

Some lemon-yellow leaves are a backdrop. They are in Fork, Big Tree, Treehouse, Rockslide, Cinder Cone, Forest9, Egg Room, Saddle, and Atop. The printed name of some lemon-yellow leaves is usually "lemon-yellow leaves". Understand "lemon" or "yellow" or "leaf" or "leaves" or "lemon-yellow" or "circular" or "veined" or "flower" or "flowers" or "disc" or "discs" as lemon-yellow leaves. The description of some lemon-yellow leaves is usually "Each flower or leaf is about the size of your thumbnail, perfectly circular, slightly concave, and the color of a deep, almost fluorescent lemon yellow. Subtle veins run through the semi-translucent skin. They sprout from the vines wrapped around the branches, each about a finger width apart[leafhint].". Check touching some lemon-yellow leaves: move yellow-stain to location; say "They are surprisingly firm under your touch, and have the thick, slightly spongy feel of a heavy leaf when you squeeze one. As you pull your finger away, you see it has picked up a slight yellow stain." instead. Check tasting some lemon-yellow leaves: say "You pull one of the small leaves off the vine-- it is surprisingly difficult-- bite it in half and chew. The texture is crunchy, almost like a carrot slice, but the taste bland and indefinable. Some juice trickles down your chin; when you wipe it off, your finger picks up a bright yellow pigment." instead. Instead of pulling or cutting or attacking some lemon-yellow leaves, say "[takeleafbit]". To say takeleafbit: say "You pull one of the small leaves off the vine-- it is surprisingly difficult-- and rub it between your fingers. It has the thick, somewhat spongy feel of a heavy leaf. As you let it drop to the ground, you see that your finger has picked up a slight yellow stain."; move yellow-stain to location. First Check taking lemon-yellow leaves: say "[takeleafbit]" instead.

To say leafhint: if ( time for excitement or story mode ) and Back Room is visited and Jumble is unvisited, say ".[paragraph break]You notice that the leaves are the exact shade of the yellow band painted on the back room door of the cabin on the beach".

A yellow-stain is a set dressing. Understand "stain/finger" as yellow-stain. The printed name is "yellow stain". The description is "The lemon-yellow pigment inside these leaves is strong and vibrant.". Check tasting yellow-stain: say "There is no taste to it." instead. Check touching yellow-stain: say "It rubs off fairly easily." instead. Check taking yellow-stain: say "It's just a slight smudge on your finger.".

Some treevines are a kind of prop. Some treevines are part of every windsigh tree. Some treevines are portable [well, not really, but allows us to print better taking message]. Understand "vine" or "vines" or "tight" or "spirals" or "of" as some treevines. The printed name of treevines is "vines". The description of treevines is "The vines sprout from orifices about the size of your wrist spread out all over the trunk of the tree, and wrap tightly around it in a helix spiraling up, splitting and shrinking in diameter, until each one leaves the trunk to twine out around a branch, sprouting hundreds of small lemon-yellow [o]leaves[x]." Instead of pulling or taking treevines, say "The vines spring from the trunk and are tightly wrapped around it and the branches. They seem to be attached to the tree by thousands of tiny hook-like hairs.". Check climbing a treevines: try climbing a random windsigh tree enclosed by the location instead. Check attacking a treevines: try attacking a random windsigh tree enclosed by the location instead.

Some sinuous branches are a kind of setpiece. Some sinuous branches are part of every windsigh tree. Understand "branch/branches" or "sinuous" or "dozens" as sinuous branches. The description of sinuous branches is usually "The branches spread out in all directions, beginning at about eye level, angled only slightly to the horizontal as they leave the trunk but then curving upwards to eventually become vertical. Every branch is wrapped in vines sprouting the yellow leaves or [o]flowers[x]. The vines even curve around the strange [o]holes[x] that appear at random along the length of each branch.". Check attacking a sinuous branches: try attacking a random windsigh tree enclosed by the location instead. Check climbing a sinuous branches: try climbing a random windsigh tree enclosed by the location instead.

Some tree-holes are a kind of setpiece. Some tree-holes are part of every windsigh tree. Understand "hole/holes" as some tree-holes. The description of tree-holes is usually "They range in size from knobby round gaps nearly as big as your head, in crooks and splits near the trunk, to tiny pinholes trailing along the ends of the smallest branches, and run all the way through the wood, letting you see through to the other side.". Understand "blow on/in/through [tree-holes]" or "blow [tree-holes]" as a mistake ("You blow through a tiny hole along a low hanging branch, and produce a momentary crystal-clear hum."). The printed name of tree-holes is "holes in the tree". Understand "hole/holes" as tree-holes.

Instead of touching sinuous branches, tree-touch. Instead of touching treevines, tree-touch. To tree-touch: if location is Treehouse begin; let bub be Tree2; otherwise if location is Saddle; let bub be Tree3; otherwise; let bub be a random windsigh tree enclosed by the location; end if; try touching bub.

Instead of touching or pushing a windsigh tree:
	if Endgame is happening begin;
		say "You feel the warm thrum of consciousness flow through the tree, but there is no time for dream games now.";
	otherwise if the number of uncontacted windsigh trees is 0;
		say "You place your hand against the side of the tree and at once the familiar thrum runs through you. You slip into dreamspace....";
		now pseudo-dream is 1;
		now old time factor is time factor;
		now time factor is 0;
		now the player is asleep;
	otherwise if mind machinery is calibrated;
		if noun is contacted begin; say "You feel the warm thrum of consciousness flow through the tree, and a teasing touch of familiarity. This one has shared its message with you already. You must find the others to learn more.";
		otherwise;
			say "Finding a spot of bare grayish bark between the spiraling vines, you touch the tree. [one of]A gust of wind kicks a pile of leaves into the air. [or][stopping]The trunk seems warm to the touch, and your fingers feel something else: a miniscule vibration? The faint buzz of an electric current? Suddenly the sensation magnifies, as if caught in some feedback loop, and before you can pull away it completely overwhelms you....";
			[We want to fudge a bit here in case the player has gotten this far without seeing the Tsunami. We need to advance Progue to at least uncertainty (the post-Tsunami psyche) for his dramatic resolution to make sense, and this ensures that we'll get the Tsunami even if we're no longer sleeping.]
			if Tsunami Sequence has happened begin;
				now pseudo-dream is 1;  [normal behavior; pass no time while dreaming]
			else if The Conch Portends is completed;
				change the time of day to 10:30 PM; [to trigger Earthquake]
			else;
				change the time of day to 5:55 PM; [to trigger Tsunami Sequence / The Conch Portends]
			end if;
			now old time factor is time factor;
			now time factor is 0; 
			now the player is asleep;
		end if;
	otherwise;
		say "Finding a spot of bare grayish bark between the spiraling vines, you touch the tree. The trunk seems warm to the touch, and your fingers feel something else: a miniscule vibration? The faint buzz of an electric current? You draw your hand back and rub it curiously.";
	end if. 

Check climbing a windsigh tree (called the climbee) when mind machinery is calibrated and the number of uncontacted windsigh trees > 0: try touching the climbee instead.

Check climbing a windsigh tree when location is not Big Tree and location is not Saddle and location is not Egg and location is not Treehouse:
	if we have not touched noun, try touching the noun; 
	pass 10 minutes of time;
	say "The vines and gnarled branches [if player is wounded]would make for an easy climb if your leg wasn't still tender[else]make it an easy climb[end if][if raining or rained], though they are slippery in the rain[end if]. The tree is not too high, and before long you are standing at a crook in the trunk where it finally splits. Yellow flowers surround you. [if location is Fork or location is Big Tree]You can see that the tree stands on a great forested slope, stretching up to the summit of a volcano and down to a white sand crescent beach[otherwise if location is Cinder Cone]The whole volcano floor stretches out before you: the multitude of steam vents, the great rent in the side of the caldera leading off towards the beach, and the jumble of lava rocks all around[otherwise if location is Forest9]Though you're still below most of the treetops, you can see that you're near the eastern edge of the forest, as the land suddenly drops off not far in that direction[otherwise if location is Rockslide]You can see clearly how the treacherous lava flow neatly bisects the island, forming the cliffs against the beach on its west half and marking the edge of the rain forest on its east half. In the north, the flow merges with a steep arm of the mountain[end if]. [paragraph break]After enjoying the view for a while, you climb back down to solid ground again." instead.

Check climbing tree2: try going up instead. Check climbing tree3: try going up instead.

A nook is a kind of supporter. A nook is usually undescribed and enterable. Understand "nook" as a nook. Check taking a nook: say "It's just a hollow in the ground." instead. The dream-text of a nook is usually "[one of]worn blankets[or]deadwood[in random order]". Check putting something on a nook: say "Better hang on to it; you don't want to lose it." instead.


Chapter - Generic Island Scenery

[To save time iterating through objects in a room, we combine all the default scenery into one object, then use parsing to see which object the player meant. ]

Some background-scenery is a backdrop. It is in Outdoors.

[1]Understand "dense/vegetation/plants/leafy/green/greenery/profusion/ferns/fern" as background-scenery.
[2]Understand "moss/mosses/mossy" as background-scenery.
[3]Understand "earth/ground/carpet/soil/rock/rocks/land/floor" as background-scenery.
[4]Understand "grass/green/tuft/tufts/grasses/grassy" as background-scenery.
[5]Understand "lighting/glow/shadow/shadows/haze/sunlight" as background-scenery.


Does the player mean doing something to background-scenery: it is very unlikely.

[An inelegant but computationally quick way to solve this problem; otherwise we might have to compare dozens of text strings before finding the one we want.]

To decide what number is scenery-referred-to:
	let cmd be indexed text;
	now cmd is the player's command;
	replace the regular expression "\b(the|a|some|my)\b " in cmd with "";
	replace the regular expression "\b(take|x|examine|get|touch|attack|hit|pull|push|enter|go in|climb)\b " in cmd with "";
	if character number 1 in cmd is "c":
		decide on 3; [carpet] 
	else if character number 1 in cmd is "d":
		decide on 1;
	else if character number 1 in cmd is "e":
		decide on 3;
	else if character number 1 in cmd is "f":
		if cmd matches the text "fern", decide on 1;
		decide on 3; [floor]
	else if character number 1 in cmd is "g":
		if cmd matches the text "green", decide on 1;
		if cmd matches the text "ground", decide on 3;
		if cmd matches the text "grass", decide on 4;
		decide on 5; [glow] 
	else if character number 1 in cmd is "h":
		decide on 5; [haze]
	else if character number 1 in cmd is "l":
		if cmd matches the text "leafy", decide on 1;
		if cmd matches the text "land", decide on 3;
		decide on 5; [lighting] 
	else if character number 1 in cmd is "m":
		decide on 2; [moss] 
	else if character number 1 in cmd is "p":
		decide on 1; [plant/plants/profusion] 
	else if character number 1 in cmd is "r":
		decide on 3;  [rock] 
	else if character number 1 in cmd is "s":
		if cmd matches the text "soil", decide on 3;
		decide on 5; [shadow] 
	else if character number 1 in cmd is "t":
		if cmd matches the text "trees", decide on 1;
		decide on 4; [tuft] 
	else if character number 1 in cmd is "v":
		decide on 1; [vegetation] 
	else:
		decide on 1.

To decide which number is first noun word: (- MyNounWord(); -).

Include (-

[ MyNounWord myword nw;
	wn = 1;
	myword = 0;
	nw = -1;
	while (myword ~= -1) {
		myword = NextWordStopped();
		if (NounWord() >= 128) return wn-1;
	}
	return -1;	
];

-).

The printed name of background-scenery is "[bgscnpn]". To say bgscnpn:
	if scenery-referred-to is:
		-- 1: say "vegetation";
		-- 2: say "moss";
		-- 3: say "ground";
		-- 4: say "grass";
		-- 5: say "lighting";
		-- otherwise: say "background scenery".

Instead of touching or taking or pushing or pulling background-scenery:
	if scenery-referred-to is:
		-- 1: say "It feels moist, vibrant, and alive.";
		-- 2: say "It's soft and springy, but also gripping quite tightly to its base.";
		-- 3: say "You feel just [surface-material] beneath your feet.";
		-- 4: say "[if we are taking]You pluck a long pale-green blade and twirl it between your fingers for a reflective moment, before letting it fall back and vanish into the green at your feet.[else]The blades are warm and moist as you run your hand through them.";
		-- 5: say "Would that you could.";
		-- otherwise: continue the action.

Instead of attacking background-scenery:
	if scenery-referred-to is:
		-- 1: say "You couldn't even begin to make a dent in the thick vegetation.";
		-- otherwise: continue the action.

Instead of entering background-scenery:
	if scenery-referred-to is:
		-- 1: say "The vegetation is too dense to make much progress through without a machete.";
		-- 3: say "You sit down on the [surface-material] and rest for a moment, reflecting, but eventually grow restless and rise to your feet again.";
		-- 4: say "You sit down on the grass and rest for a moment, reflecting, but eventually grow restless and rise to your feet again.";
		-- otherwise: continue the action.

The basic-walls are a backdrop. Understand "wall/walls/roof/ceiling" as basic-walls. They are in Hut, Back Room, Studio, Center Beach, Chairlift Base, Jumble, Chasm Edge, Chasm Floor, Volcano Floor, Steam Vents, Cinder Cone, Secret Cave, Egg Interior, Prison, Overhang, Mossy Ledge, Echo Chamber. The printed name is "walls[if location is indoorsy] and roof[end if]". Instead of climbing basic-walls, say "[if location is Steam Vents]The scree here is far too unstable; it looks like it would collapse into a rockslide if you put any weight on it[otherwise if location is regionally in Frozen Hell]The sides of the volcano are alternatively smooth and razor-sharp, and in neither case are they suitable for climbing[otherwise]There's not really a good spot to climb here[end if].". Does the player mean doing anything to basic-walls: it is very unlikely.




Part - Distant Views


Section - The Mountain

The mountain-view is a seen view with base room North Marsh. Understand "mountain/peak/summit" as mountain-view. The printed name is "mountain". It is in East Marsh, North Marsh, Ravine Floor, Top of Ravine, Ledge, Cliffside, Lawn, Observatory Exterior, Chair-lift2, Chair-lift3, Edge of Ravine, Viewpoint, West-Marsh, Stumps, Rise, Chairlift Base, Hive Room, Chair-lift1, Lower Beach, Ocean Waters, South Beach, Among the Boulders, Tidepools, Rim of Volcano. The mountain-view is very near East Marsh and North Marsh and Ravine Floor and Top of Ravine and Ledge and Cliffside and Lawn and Observatory Exterior and Chair-lift2 and Chair-lift3 [anywhere we can't see the whole thing]. The mountain-view is near Edge of Ravine and Viewpoint and West-Marsh and Stumps and Rise and Chairlift Base and Hive Room and Chair-lift1. The mountain-view is far from Lower Beach and Ocean Waters and South Beach. The mountain-view is very far from Among the Boulders and Tidepools and Rim of Volcano. Understand "summit" or "cliff" as the mountain-view when location is not Lawn and location is not Observatory Exterior.

Check examining the mountain-view: 
	if location is Lawn or location is Observatory Exterior begin; say "The summit of the mountain is only a short scramble above you from here";
	otherwise if location is North Marsh; say "The cliff rises straight up out of the marsh in a vertiginous climb to the summit, as if in some past geologic epoch half the mountain split and sunk into the sea. Indeed, a deep [o]crack[x] runs nearly straight up from here, harbinger perhaps of further destruction";
	otherwise;
		say "The mountain is [distance of mountain-view]. It dominates [if dir]the northeastern[otherwise]one[end if] corner of the island, one side a sheer cliff face, the other tumbling treacherously into the sea. The rocky sides [if mountain-view is very near location or mountain-view is near location]seem to be composed of weathered volcanic rock[otherwise]are black and smooth[end if]";
		if the mountain-view is not very far from location, say ".[paragraph break]Perched near the summit is [if night and pyramid has power]a small [o]structure[x], shining with a deep red glow that illuminates the whole summit of the mountaintop[otherwise if night and pressure of the related pipe of the pyramid pressure gauge > 0]a small pyramid structure. A faint red glow pulses from somewhere inside it, disappearing and then reappearing in a slow and steady cycle[otherwise if Lawn is unvisited]some sort of man-made [o]structure[x][else]the [o]pyramid[x][end if]"; 
	end if;
	say "." instead.

First instead of climbing the mountain-view when location is North Marsh: try going up instead. First instead of climbing the mountain-view when location is Lawn: try going down instead. First instead of climbing the mountain-view when location is Observatory Exterior: say "The mountainside drops off a dizzying distance into the sea-swept gorge far below; there is no visible route down from here." instead. First instead of climbing the mountain-view when location is East Marsh: say "The cliff face is smooth and softened with slick moss here, and you cannot get a good enough grip to climb." instead.

To say a sentence about the mountain:
	if we have not examined the mountain-view, say "A large, craggy [o]mountain[x] looms up into the clouds, [distance of mountain-view]";
	otherwise say "The [o]mountain[x], [distance of mountain-view], glowers [if evening or sunset]in the fiery glow of the fading sun[end if][if sunrise]in shadows as the sun rises behind it[end if][if moonup]in a pillowy glow of moonlight[end if]".
	
To say a phrase about the mountain:
	if raining begin;
		say "but mist shrouds the rest of the island";
	otherwise if night; say "and [if we have examined the mountain-view]the great dark shape of the [o]mountain[x][otherwise]a great dark shape[end if]looms over the island"; 
	otherwise; say "[one of]while the [o]mountain[x] rises dramatically over the landscape[or]and, like a titan, the [o]mountain[x] looms over the island[in random order]"; say "[if rained], head shrouded in clouds[end if][if sunrise or morning], its peak catching the morning light[end if][if sunset or twilight], the top of its peak glowing a dull red[end if]";
	end if.

Table of Mountain ambience
freq		text	table	trigger	flag
common	"[if raining]Lightning, then a sudden crash of thunder, roll in jagged echoes off the mountain peak, [distance of mountain-view][otherwise if sunup]Ragged shadows crawl down the sharp slope of the mountain, [distance of mountain-view], as fast-moving clouds cover and hide the sun[otherwise]The mountain, [distance of mountain-view], looms darkly in the night[end if]. "
common	"[if sunrise or morning]Early morning light paints the mountaintop in bright colors, pink and black silhouettes touching the edges of the distant peak[otherwise if midday or afternoon and not raining]The hot sun beats down on the mountain, [distance of mountain-view] and stoically bearing the onslaught[otherwise if evening or sunset]The face of the mountain, [distance of mountain-view], bakes in the light of the setting sun[otherwise if night or dawn or twilight]The mountain looms into the colorless sky, negative space more sensed than seen[otherwise if raining]Clouds, [distance of mountain-view], wreathe the top of the mountain in a grey halo[end if]. " 

Section - The Volcano

The volcano proper is a seen view. The base room is Rim of Volcano. The printed name is "volcano". The volcano proper is in Volcanic Uplands, Beachfront, Tidepools, Lower Beach, Ocean Waters, North Island, High Altitude, Saddle, Atop, Chasm Edge, and Crater Pond. The volcano proper is very near Volcano Slopes and Sloping Meadow and Chasm Edge and Rockslide and Crater Pond. The volcano proper is near Among the Boulders and Center Beach and Lower Beach. The volcano proper is far from North Beach and Tidepools and Rise and Ocean Waters.  The volcano proper is very far from Chairlift Base and Ledge and Cliffside and Lawn and Observatory Exterior and Saddle and Atop.

Understand "slope/slopes" as volcano proper.

Check examining the volcano proper:
	let volcano_pronoun be "[if we have examined the volcano]the[otherwise]a[end if]";
	if volcano is very near location begin; say "The volcano looms above you, wisps of steam rising from above its lip, all the more dramatic as this entire side has crumbled away, blasted out in some epic past eruption, leaving a chasm running across the island towards the far end of the lagoon";
	otherwise if volcano is near location; say "The top of [volcano_pronoun] reddish-brown volcano pokes up over the forested land [if location is in Beachfront and dir]to the southeast[otherwise if dir]to the south[otherwise]at its base[end if]";
	otherwise if volcano is far from location; say "Rising gracefully over [if dir]the south[otherwise if location is not Rise]the far[otherwise]this[end if] end of the island, the reddish-brown slopes of [volcano_pronoun] volcano [if midday]bake hotly in the midday sun[otherwise if sunrise or morning]catch the rays of the morning sunlight[otherwise if sunset or evening]are painted by the dying sunlight[otherwise if night]blot out the stars[otherwise]shimmer in the distant heat haze[end if]. Faint wisps of steam rise from its hidden caldera. One whole side of the volcano seems to have crumbled in some past eruption, spewing forth the long black lava [o]flow[x] that bisects the island and forms the back wall of the lagoon";
	otherwise; say "The distant volcano lords over the south end of the island, the black floor of the inner caldera visible through the crumbled gash in its side";
	end if;
	say "." instead.

First instead of climbing the volcano proper:
	if location is Volcano Slopes:
		try going southeast instead;
	otherwise if location is Rim of Volcano:
		say "The slope down the inside of the volcano is sheer and covered in loose rock; there's no way to climb down it." instead;
	otherwise:
		try following volcano proper instead.

Section - The Lava Flow

The lava flow is a seen view with base room Rise. Understand "ridge" as lava flow. It is in Chasm Floor, Chasm Edge, Jumble, Volcano Floor, Steam Vents, Cinder Cone, Volcano Cave, Rise, Center Beach, North Beach, Stumps, Chairlift Base, Rockslide, Hive Room, Saddle, Edge of Ravine, Rim of Volcano, Among the Boulders, Tidepools, South Beach, Lower Beach, Ocean Waters, Atop, Ledge, CLiffside, Lawn, Observatory Exterior. The lava flow is very near Chasm Floor, Chasm Edge, Jumble, Volcano Floor, Steam Vents, Cinder Cone, Volcano Cave, and Rise. [we're on it.] The lava flow is very near Center Beach, North Beach, South Beach. The lava flow is near Stumps, Chairlift Base, Rockslide, Hive Room, Saddle, and Edge of Ravine. The lava flow is far from Rim of Volcano, Among the Boulders, Tidepools, Lower Beach, Ocean Waters, and Atop. The lava flow is very far from Ledge, Cliffside, Lawn, Observatory Exterior. 

Check examining the lava flow:
	if lava flow is very near location begin; say "The black rock, frozen in mid-tumble, hosts a few tentative green shoots and flowers in its maze of nooks and crannies, but the vegetation has only begun to reclaim it";
	otherwise if lava flow is near location; say "The lava flow [if location is Saddle]runs below[otherwise]rises above[end if] you, black chaos tumbling up towards the volcano in one direction and disappearing into the sea at the north end of the lagoon";
	otherwise if lava flow is far from location; say "Now black and hardened, this lava flow sliced across the island decades or centuries ago, descending from the ruined cone of the volcano to the ocean near the rise";
	otherwise; say "You can clearly see the swath of the lava flow slicing diagonally across the island, from the ruined cone of the volcano to the rise near the ocean";
	end if;
	say "." instead.

First instead of climbing lava flow:
	if location is North Beach or location is Stumps, try going up instead;
	if location is Chasm Edge, try going down instead;
	if lava flow is very near location, say "The flow here is too steep and sharp to climb." instead;
	continue the action.

Section - The Ocean

The distant ocean is a view with base room Ocean Waters. It is in Progue's Domain and West Forest and North Island and Marshlands. It is near Hut and Rise and Stumps and Chairlift Base. It is far from Fork and West-Marsh and North Marsh and East Marsh. It is very far from Rim of Volcano. Understand "wave" or "waves" or "water" or "sea" or "ocean" or "tide" as the distant ocean. The description is "The blue ocean [if night]sparkles with starlight, reflected and broken into millions of shimmering jewels[otherwise if dawn or twilight]beats restlessly in the gray light[otherwise]sparkles brilliantly in the sun[end if].".


Section - The Lagoon

The lagoon is a seen view with base room Center Beach. It is in South Beach, Center Beach, North Beach, Hut, Lower Beach, Ocean Waters, Tidepools, Among the Boulders, Rise, Rim of Volcano, Ledge, Cliffside, Lawn, and Observatory Exterior. Understand "bay/crescent" as lagoon. The lagoon is very near South Beach and Center Beach and North Beach and Hut and Lower Beach and Ocean Waters and Tidepools and Among the Boulders and Rise. The lagoon is very far from Rim of Volcano and Ledge and Cliffside and Lawn and Observatory Exterior. 

Check entering the lagoon when location is Center Beach: try going west instead. Check entering the lagoon when location is South Beach: try going northwest instead. Check entering the lagoon when location is North Beach: try going southwest instead.

The description of lagoon is "[lagoondesc].". To say lagoondesc:
	if lagoon is very near location begin; say "The lagoon undeniably captivates the eye, aesthetically perfect in some indescribable way. Electric blue water far out to sea fades to a creamy neon turquoise as it enters the shallows of the bay, before crashing in long foamy runners of [o]surf[x] on the white sand beach which rims it. At [if location is South Beach or location is Among the Boulders or location is Tidepools]the far[otherwise if location is Rise or location is North Beach]the nearer[otherwise]one[end if] end of the bay, a rocky rise of black lava tumbles across the sand and into the water, forming a sharp boundary and a shocking contrast of color, while the ";
		say "[if location is South Beach]nearer[otherwise if location is North Beach]far[otherwise]other[end if] side is bounded by a lower point filled with tidepools and rounded boulders";
	otherwise; say "The lagoon [if evening or sunset or afternoon]sparkles in the distance as the sun reflects off its cerulean waters[otherwise if midday or midmorning or morning or sunrise]arcs gently in the distance, a jewel of blue and cream[otherwise if twilight or dawn]shimmers subtly in the distance, like a dark blue bruise in the shadowless light[otherwise]in the distance is marked by faintly seen blobs of pale moving light[end if]";
	end if.

To say a sentence about the lagoon:
	if night begin;
		if we have examined the rayfish and the distant-rayfish are on-stage begin; say "The faint pale glows of [the rayfish] dance slowly out in the lagoon";
		otherwise if distant-rayfish are on-stage; say "Pale [o]lights[x] weave and bob through the waters of the lagoon";
		otherwise; say "The lagoon is black and silent in the strange night air";
		end if;
		stop;	end if; 
	if afternoon or midday or midmorning begin;
		say "The ocean [if tidein]stretches to[otherwise]pounds faintly beneath[end if] the western horizon, [if rain clouds are in location]under a grey sky streaked with fast moving [o]clouds[x][end if][if raining] dumping buckets of rain[end if]";
		if rain clouds are not in location, say "[one of]where it meets a vast, unclouded sky, so deep a blue your eyes hurt[or]the [o]lagoon[x] practically glowing as it warms in the sparkling sunlight[in random order]";
	stop;	end if;
	if evening begin;
		if rained begin;
			say "Thunderheads receding westward are lit up like giant floating barges by the sinking sun's rays, which are reflected by the [o]water[x] and the wet, sparkling [o]sand[x]";
		otherwise;
			 say "Reflected sunlight shimmers off the [if tideout]distant [end if][o]tide[x], pointing a straight line towards the sinking sun";
		end if;
		stop;	end if; 
	if sunset begin;
		say "A fantastic tropical sunset dominates the sky, the [if tideout]distant [end if][o]waves[x] westward shimmering magically under deep purples, oranges, and the brilliant yellow gleam of the setting sun";
		stop;	end if;
	if twilight begin;
		say "The sky and the colors of the lagoon are slowly fading in the dimming light";
		stop; end if;
	if dawn or sunrise or morning begin;
		say "[one of]Distant clouds glow yellow-pink over the ocean to the west as the rising sun's rays intersect them, but [if dawn]the land[otherwise]most of the beach[end if] is still in shadow[or]The [o]lagoon[x] stretches before you, blue and beautiful, slowly richening in color as the sky brightens above[in random order]";
		stop;	end if.

Section - The Ropeway

The distant-ropeway is a seen view with base room Chairlift Base. It is in Chairlift Base, Lawn, Stumps, West-Marsh, East Marsh, Rise, North Marsh, Ledge, Cliffside, Saddle, Atop, Rim of Volcano, Viewpoint, South Beach, Among the Boulders, Tidepools. It is very near Chairlift Base and Lawn. It is near Stumps and West-Marsh and East Marsh. It is far from Rise and North Marsh and Ledge and Cliffside. It is very far from Saddle and Atop and Rim of Volcano and Viewpoint and South Beach and Among the Boulders and Tidepools. Understand "ropeway" or "rope" or "ropes" or "cable" or "cables" or "pole" as distant-ropeway. The printed name of distant-ropeway is "ropeway". Instead of entering or climbing distant-ropeway, say "The distance is far too great for you to successfully climb the cables hand-over-hand.". Instead of touching or taking or pushing or pulling distant-ropeway when distant-ropeway is very near location: say "The ropes are solidly attached to the ropeway system.".

Check examining distant-ropeway:
	if distant-ropeway is near location or distant-ropeway is very near location begin; say "The ropes rise from the base station in a double arc, first to a pole rising from a tall boulder in the marsh, then in a dizzying climb to the summit of the mountain[unless location is Lawn or location is Observatory Exterior] high above[end if]";
	otherwise if distant-ropeway is far from location; say "The ropes rise from the base station on one corner of the island to near the top of the mountain across the marsh";
	otherwise; say "The arc of the ropeway line is faintly visible descending from the top of the mountain";
	end if;
	say "." instead.

Section - The Distant Pyramid

The distant-pyramid is a view with base room Observatory Exterior. It is in Lawn, Viewpoint, Saddle, Atop, Stumps, Chairlift Base, Rise, North Beach, Center Beach, South Beach, East Marsh, West-Marsh, and Volcano Floor. It is very near Lawn. It is near Viewpoint, Saddle, and Atop. It is far from Stumps and Chairlift Base and Rise and East Marsh and West-Marsh. It is very far from Volcano Floor. Understand "pyramid" or "torus" or "structure" as distant-pyramid. The printed name is "[if pyramid-seen is true]pyramid[else]structure".

pyramid-seen is a truth state that varies.

Instead of examining distant-pyramid:
	if pyramid is on-stage begin;
		if pyramid-seen is true, manually reference distant-pyramid;
		if noun is very near location begin; say "The pyramid is just a short walk away, tucked in a small mountain cirque.";
		otherwise if Observatory Exterior is visited or pyramid-seen is true; say "The pyramid sits inscrutably atop the mountain[distantpyramiddesc].";
		otherwise if noun is near location and pyramid-seen is true; say "From this vantage point, you have a much better view of the pyramid atop the mountain. Definitely manmade, it seems to be constructed of wood, and surrounded by a strange halo[if sunup] that gleams metallically in the light of the sun[end if][distantpyramiddesc]. It looks from here to be easily reachable from the area near the top of the ropeway. Scale is hard to judge, but you'd guess it is about as tall as you are[if night]. A faint red beam points straight up from the pyramid's apex into the night sky[end if].";
		otherwise; say "[if night]The red glow casts the shape into sharp relief against the blackness behind it: a pyramid, but small, maybe only about as tall as you are. A faint red beam points straight up from its apex into the night sky[else]You can't make out any details from this distance, but it definitely seems like a man-made structure[distantpyramiddesc]. A strange metallic torus surrounds it[end if]."; if night, now pyramid-seen is true;
		end if;
	otherwise;
		manually reference distant-pyramid;
		if noun is very near location begin; say "The machinery is just a short walk away, tucked in a small mountain cirque.";
		otherwise if Observatory Exterior is visited; say "The machinery sits inscrutably atop the mountain[distantpyramiddesc].";
		end if;
	end if.

[Check examining by name the distant-pyramid: if dc_pyramid is available, try discussing dc_pyramid instead.]

To say distantpyramiddesc: say "[if pyramid has power and night]. The whole summit of the mountaintop is lit by the deep ruby glow streaming brightly from [edgeoregg], and a faint crimson beam of luminescence rises into the sky[otherwise if pyramid has power]. A deep ruby glow beams from [edgeoregg][otherwise if pressure of the related pipe of the pyramid pressure gauge > 0 and night]. A faint crimson light cycles slowly on and off[otherwise if pressure of the related pipe of the pyramid pressure gauge > 0]. The mountaintop is weirdly illuminated by a faint crimson glow streaming through [edgeoregg], cycling slowly from light to dark[end if][if pyramid has power], and you can hear even from here a deep, rhythmic thrumming which seems to come from somewhere inside[end if]". To say edgeoregg: if pyramid is on-stage, say "its edges"; otherwise say "the machinery".

Section - The Rain Forest

The rainforest is a seen view with base room Forest1. It is in East Island. It is near Rockslide. It is very near Hive Room, Crater Pond, Edge of Ravine, Egg Room, Backside. Understand "forest" or "rain forest" as the rainforest. The printed name is "rain forest". Check entering the rainforest when location is Hive Room: try going east instead. Check entering the rainforest when location is Crater Pond: try going north instead. Check entering the rainforest: say "The forest is so thick and dense here, you can't see a way to get inside." instead.

Check examining the rainforest:
	if noun is very near location, say "The edges of the forest are only a few steps away." instead;
	otherwise say "The forest looks nearly impenetrable, and fills this whole side of the island." instead.



Book - Lacuna Room Definitions

Part - The Beachfront

The ambience table of Beachfront is Table of Beachfront ambience.

The sleep message of a room in Beachfront is usually "You stretch out on the [surface-material] and drift into an uneasy sleep.".

Check listening when in Beachfront: say "You hear [if night]only [end if]the [if tideout]far-off [end if][if high tide]crashing [end if]sounds of the surf[if day] and the cawing of seagulls[end if]." instead.

Chapter - Beachfront Scenery

The nearby beach is a view with base room Center Beach. It is in Tidepools, Among the Boulders, South Beach, Center Beach, North Beach, Rise, Lower Beach, and Ocean Waters. It is very near Tidepools, Among the Boulders, South Beach, Center Beach, North Beach, Rise, Lower Beach, and Ocean Waters.

Understand "sand/sands" as nearby beach. The description is "[if night or dawn or twilight]Almost glowing in the faint light[otherwise]Startlingly bright[end if], the beach [if location is Among the Boulders]is interrupted here by the patch of boulders[else if location is not North Beach and location is not South Beach and location is not Center Beach and location is not Lower Beach]is interrupted by pebbles and rubbed-smooth stones[else if cleanliness of location is spotless]is smooth and featureless, white curves unblemished by imperfections[otherwise if cleanliness of location is flecked]is dotted with tiny specks of seaweed and shell fragments[otherwise if cleanliness of location is marred]is strewn with clumps of slimy seaweed and other debris from the ocean[otherwise]is a mess of smelly patches of seaweed, fish carcasses, gull feathers, and pieces of bony driftwood[end if].".

Instead of taking or touching nearby beach:
	if rained or raining, say "You scoop up a handful of the wet, almost muddy sand, feeling it ooze in gritty trickles through your fingers."; otherwise say "You let a handful of the [if night or dawn or sunrise or morning]cool[end if][if midmorning or midday or twilight]warm[end if][if afternoon or evening or sunset]scorching hot[end if] sand run through your fingers. So fine they feel almost soft, the grains [if midday or afternoon or evening or sunset]sparkle in the bright sun as they [end if]fall in a thin line back to the beach."

To say a sentence about the nearby beach: 
	if night begin; say "[one of][nearbybeach1][or][nearbybeach2][in random order]"; stop; end if;
	if twilight or dawn begin; say "The stillness of the great crescent [o]beach[x] is magical in the half-light; the whole expanse curving out before you quietly breathtaking"; stop; end if;
	if cleanliness of location is spotless begin; say "[one of]Spotless[or]Pristine[or]Gleaming[at random] white [o]sand[x]";
	otherwise if cleanliness of location is flecked; say "White [o]sand[x] [one of]flecked with bits of seaweed and debris[or]spotted here and there with flecks of weed or fish bones[or]dotted with small bits of refuse and flotsam[at random]";
	otherwise if cleanliness of location is marred; say "[o]Sand[x] [one of]strewn with[or]littered with[or]marred by[at random] [one of]strings of seaweed, stones, and pieces of driftwood[or]jagged broken shells and decomposing seaweed[at random]";
	otherwise; say "[one of]Grimy[or]Dirty[or]Yellowing[at random] [o]sand[x] [one of]covered in[or]smeared with[at random] [one of]stinking seaweed, splintered driftwood, broken shells and gull feathers[or]seagull droppings, rotting seaweed, and splinters of driftwood[at random]";
	end if;
	say " [if midday and cleanliness of location is spotless]almost blinds you as it [end if][one of]curves around the[or]stretches in a great arc around the[in random order] lagoon".
	
To say nearbybeach1: say "The undulating white sand [o]beach[x] [if moonup]silvers in the moonlight, which sparkles faintly on the [otherwise]is dim and indistinct under the stars, the border between ground and sky defined by the sound of the [end if][if tideout]distant waves[end if][if rising uptide or falling uptide]waves, a stone's throw away[end if][if high tide]runners of foamy surf reaching almost to your feet[end if]". To say nearbybeach2: say "[if falling uptide or falling downtide]Damp sand glistens[end if][if high tide]Foamy breakers lap the shore[end if][if low tide or rising downtide or rising uptide]Smooth stretches of sand spread out[end if] [if moonup]ghostly white [end if]before you, [if location is South Beach]dotted with myriad tiny shells and pieces of wood[otherwise]unbroken save for your own footsteps[end if]".

The surf is a backdrop. It is in Lower Beach and Ocean Waters and Tidepools and Among the Boulders and South Beach and Center Beach and North Beach and Edge of Ravine and Ravine Floor. Understand "wave" or "waves" or "water" or "sea" or "ocean" or "tide" as the surf. The description is "[if location is Ocean Waters]The tide swells around you.[otherwise if high tide]The waves are high, perhaps near the high tide mark.[otherwise if falling uptide]The tide seems to be ebbing out, but the waves are still relatively close.[otherwise if falling downtide]The tide is a good distance away, and seems to be ebbing even farther out.[otherwise if low tide]The waves are a long way down, breaking languidly against the wet beach.[otherwise if rising downtide]The waves are a good distance away, but the tide seems to be flowing back in.[otherwise if rising uptide]The surf is relatively close, each wave seeming to crash a little closer.[end if]". Check tasting the surf: say "Salty." instead.

Check swimming in the surf: if location is in Beachfront, try going down instead; otherwise try vague swimming instead. Check vague swimming when location is in Beachfront and player_imperiled is false: try swimming in the surf instead.

Check touching the surf: say "The warm water feels fresh and alive as it swirls over your hand." instead.
  
Some beach debris is a backdrop. They are in South Beach, Center Beach, North beach, Lower Beach. Understand "shell" or "seashell" or "seashells" or "pieces of wood" or "wood" or "tiny" or "shells" or "detritus" or "flecks" or "seaweed" or "stones" as the debris. Instead of doing anything to the debris, say "None of it appears particularly valuable." Does the player mean doing something to beach debris: it is unlikely.

Section - The Konokuk Trees

[The konokuk trees. When play begins, there are no fruits on the ground. During a rainstorm, there is a chance that some will drop. (We have a "tree coconut" and a "ground-coconut" backdrop item that have some of the same qualities.) The player can also climb a tree (if uninjured) to get a coconut, which he then returns to ground to examine; or shake a tree to (at random) make one fall. Progue has a tree-climbing/coconut-eating activity in Supression. The player is not allowed to "take" a coconut. Ground-coconuts randomly have a chance to disappear each night (creatures or Progue eats them.)

None of this really serves any purpose, other than to make the environment more interactive and welcoming.]

Some konokuk trees are a backdrop. They are in North Beach and Rise. Understand "tree9/tree/trunk/trunks" as konokuk trees. The description is "The knobby brown trunks of the [if konokuk trees are named]konokuk [end if]trees curve gently up to a cluster of leafy fronds and hairy brown [o]fruits[x] well above your head.". Check climbing konokuk trees when player is wounded: say "You can't climb anything with your leg in this shape." instead. Check climbing konokuk trees: add some konokuk; say "You grip the leathered trunk of the tree firmly and start shimmying up. It's hard work. Sweat ripples your face and your hands become tender and slippery. But finally you reach the top of the tree, within touching distance of the hairy brown [o]fruits[x]. You manage to knock a few loose, before returning to the ground and picking bits of bark from your roughened hands tenderly." instead. Does the player mean climbing or pushing or shaking some konokuk trees: it is very likely. Check pushing konokuk trees: add some konokuk; say "You grip a trunk and vigorously shake the tree back and forth. After a moment a few of the fruits fall; you hastily step aside as they cannonball into the sand near your feet with loud thunks." instead.

To add some konokuk: if ground-konokuk are not-appearing begin; if location is Rise, now ground-konokuk are R-appearing; otherwise now ground-konokuk are NB-appearing; otherwise; now ground-konokuk are both-appearing; end if; update-konokuk.

To say a sentence about the konokuk trees: say "Tall, swaying [if konokuk trees are named][one of][o]trees[x] -- what [the Progue] called 'konokuk' trees, you remember -- [or][o]konokuk[x] trees[stopping][otherwise][o]trees[x][end if]"; say " rise above you[if midmorning or midday], providing some welcome shade against the tropical sun[otherwise if night], more heard than seen[end if][if not night and ground-konokuk is enclosed by location], their bases strewn with round, brown [o]fruits[x][end if]". Does the player mean doing anything other than climbing to konokuk trees: it is unlikely. 

Some tree-konokuk are a backdrop. They are in North Beach and Rise. Understand "fruit/fruits" or "konokuk" or "coconut" as tree-konokuk. The printed name is "[if konokuk trees are named]konokuk[otherwise]brown fruits[end if] in the tree". The description is "High near the top of the trees, you can see clusters of round brown fruits.". Instead of taking or attacking or pushing or touching or tasting tree-konokuk, say "They're well above your reach.". 

Some ground-konokuk are a setpiece. ground-konokuks can be not-appearing, NB-appearing, R-appearing, or both-appearing. ground-konokuks are not-appearing. Understand "fruit" or "konokuk" or "coconut/sphere/spheres/fruits/hairy/pink/pulp/gooey/liquid/coconuts/konokuks" as ground-konokuk. The printed name is "[if konokuk trees are named]konokuk[otherwise]brown fruits". Does the player mean doing anything to ground-konokuk: it is very likely. The description is "These round hairy spheres[if konokuk trees are named], the fruit of the konokuk tree,[end if] are about the size of your head." The dream-text of ground-konokuk is "[if konokuk trees are named]konokuk[otherwise]coconuts". Check attacking ground-konokuk: say "You crack one of the fruits open with little effort, revealing a firm pink-white pulp and some gooey clear liquid inside.[if Progue is enclosed by location][one of][paragraph break]'That's the way!' [the Progue] says, looking up and nodding approvingly. 'Delicious delicious.'[or][stopping][end if]" instead. Check taking ground-konokuk: say "You heft one of the head-sized fruits in your hands, but decide you can probably do whatever you need to do with it here, rather than carrying it around." instead. Check tasting ground-konokuk: try attacking ground-konokuk; say "The pulp is delicious, with a flavor redolent of peppermint and sea salt, and the liquid is warm and nutty." instead. Check touching a ground-konokuk: say "Covered in coarse, ropy fibers." instead. Some coarse fibers are part of ground-konokuk. Understand "fiber" as fibers. Instead of doing something to coarse fibers, say "You strip a few of the fibers from the husk of one of the fruits. They seem strong and resilient, but it would take days to make anything useful from them, so you let them fall back to the ground.". Check opening ground-konokuk: try attacking ground-konokuk instead.

After going to North Beach: update-konokuk; continue the action. After going to Rise: update-konokuk; continue the action. To update-konokuk: if location is North Beach and ( ground-konokuk are NB-appearing or ground-konokuk are both-appearing ) begin; move ground-konokuk to location; otherwise if location is Rise and ( ground-konokuk are R-appearing or ground-konokuk are both-appearing ) ; move ground-konokuk to location; otherwise; remove ground-konokuk from play; end if.

Every turn when raining and a random chance of 1 in 40 succeeds (this is the rain loosens konokuk rule):
	if ground-konokuk are NB-appearing or ground-konokuk are R-appearing begin; now ground-konokuk are both-appearing;
	otherwise if ground-konokuk are not-appearing; if a random chance of 1 in 2 succeeds, now ground-konokuk are NB-appearing; otherwise now ground-konokuk are R-appearing;
	end if.

Every turn when location was regionally in Dreamlands and a random chance of 1 in 2 succeeds (this is the konokuks fade rule):
	if ground-konokuk are both-appearing begin; if a random chance of 1 in 2 succeeds, now ground-konokuk are R-appearing; otherwise now ground-konokuk are NB-appearing;
	otherwise; now ground-konokuk are not-appearing;
	end if.




Chapter - Beachfront Ambience

Table of Beachfront ambience
freq		start time	end time	text	table		trigger	flag
frequent	high tide	--	--	Table of High Tide ambience	a thing	a number
common	rising uptide	--	--	Table of Tide ambience
common	falling uptide	--	--	Table of Tide ambience
uncommon		--	--	"[one of]A gust of wind blows sand in whirls and eddies along the beach[or]A sudden breeze springs up, sending sand spiraling along the beach[if the location contains a setpiece] and drifting against [the random setpiece in the location][end if][at random]."
common	dawn		twilight	--	Table of Seagull ambience
uncommon		dawn		midmorning	--	Table of Crab ambience
common	evening	twilight	--	Table of Crab ambience
uberrare	dawn		midmorning	"Far out in the lagoon, a great blue-gray mass heaves above the surface-- a whale! With a spurt of air and mist, the creature glides gracefully back beneath the surface."	--	real-whale
common	night		dawn	"[if distant-rayfish are on-stage][rayfishambience][otherwise]The lagoon is black and silent.[end if]"
rare	--	--	"A steady wind blows the smell of the ocean across the beach."

The real-whale is set dressing. Understand "whale" as real-whale. The printed name is "whale". The description is "He's already vanished below the surface, leaving only a distant patch of churning bubbles behind.".

To say rayfishambience:
	if a random chance of 1 in 2 succeeds, say "Out in the lagoon, [if we have examined the rayfish]the glowing blue [rayfish][otherwise]strange pale [o]lights[x][end if] bob and weave under the water.";
	otherwise say "[if we have examined the rayfish]The glowing blue glows of the [rayfish][otherwise]Dozens of ghostly blue [o]lights[x][end if] circle slowly under the waters of the lagoon.".

Table of High Tide ambience
freq		text	table		trigger	flag
common	"A wave slowly breaks up the shallow lagoon, sending an undulating line of foamy water almost to your feet."
common	"Another wave breaks on the beach."
rare	"The loud sound of rushing surf gives you just enough time to dance away as a larger than usual wave surges up the beach."
rare	"[if night]Some seaweed, black and shapeless in the dark,[otherwise]A large clump of seaweed[end if] gyrates at the edge of the tide."
uncommon		"Two waves roll up in quick succession, as if the second is overtaking the first."
uncommon		"The sound of the surf surges around you as another wave breaks."

Table of Tide ambience
freq		text	table		trigger	flag
uncommon		"[one of]Some distance away[or]Farther down the beach[or]At the water's edge a stone's throw away[at random], [one of]a wave rolls in and breaks against the shore.[or]surf crashes against the sand.[or]the steady surge and ebb of surf continues.[or]a wave rolls gently in. You watch the breakpoint as it travels around the lagoon.[or]the surf beats against the sandy shore.[at random]"
rare		"[one of]A large wave rolls in across the lagoon and crashes spectacularly against the beach, the breakers surging to near where you're standing[or]A big wave crashes to shore down at the edge of the beach[at random]."

A small crustacean carapace is set dressing. 

The seaweed is a backdrop in Beachfront. Understand "sea weed" as seaweed. The description is "It's a long clump of seaweed. Green nodules full of air are spaced along its length, along with graceful filaments and tendrils of leaves.". Check taking seaweed: say "You'd rather not carry that around." instead.


A crab is an undescribed animal. The description is "About the size of your hand, this curious creature scuttles sideways along the sand quite nimbly, holding pincers above him and darting eyes on long stalks every way it can." Instead of taking or touching a crab: say "[one of]You reach out your hand for one of the creatures, but it dashes away in a panic before you can grab it, tiny legs pumping furiously[or]You reach down to grab it, but in a snap it nips you with a pincer and darts away. Ouch! You rub your finger gingerly[or]You sidle cautiously towards the crab, then reach down in a flash. You got him! He snaps pincers and waves his legs fiercely as you study his fine carapace and detailed underbelly. Finally, you set him back down. He snaps once more, indignantly, before beating a hasty retreat down the beach[at random]."; remove the crab from play. Check attacking a crab: remove the crab from play; say "You aim a kick at one of the little creatures, but it scuttles out of the way with better reflexes than you gave it credit for, and quickly hurries out of sight." instead. Check tasting a crab: say "You don't really have the right culinary equipment for that." instead. Understand "crabs" as crab.

Every turn when night and distant-rayfish are not enclosed by location and player is awake and Tsunami Sequence is not happening and ( location is in Beachfront or location is Lower Beach or location is Ocean Waters or location is Tidepools or location is Among the Boulders or location is Rise ) : move distant-rayfish to location; move rayfish to Ocean Waters. Every turn when distant-rayfish are on-stage and not night: remove distant-rayfish from play; remove rayfish from play.

Sighting-The-Rayfish is a scene. Sighting-The-Rayfish begins when distant-rayfish are in location. When Sighting-The-Rayfish begins: if we-are-landmark-going is true begin; tidy landmark-go; clean up landmark-go; end if; say "Far out in the lagoon, bobbing and weaving slowly just under the surface of the water, are dozens of pale [o]lights[x], glowing eerily in the [if moonup]moonlight[otherwise]darkness[end if].". Sighting-The-Rayfish ends when Sighting-The-Rayfish begins.

The distant-rayfish are a minor setpiece.  Understand "pale" or "light" or "lights" or "rayfish" or "manta" or "ray" or "rays" or "mantas" as distant-rayfish. The printed name are "distant [if rayfish are named and we have examined rayfish]rayfish[otherwise if we have examined rayfish]manta creatures[otherwise]lights[end if]". The description is "[if we have not examined distant-rayfish and we have not examined rayfish]Spread out all across the lagoon, under the surface of the water, are dozens of faint, pale glows, bobbing and weaving slowly across the bay. From here on the land, you're too far away to tell what they are[otherwise if we have not examined rayfish]The pale lights continue to slowly weave through the waters of the bay, mysterious and silent[otherwise][The rayfish] are only pale glows from here on the beach[end if].". The provoke message of distant-rayfish is "They're too far away, out in the ocean. Maybe if you got closer.". Does the player mean doing anything to the distant-rayfish: it is unlikely. [prefer the real ones.]

The rayfish is an undescribed animal. Understand "pale" or "light" or "lights" or "rayfish" or "manta" or "ray" or "rays" or "mantas" or "glow" or "backs" or "wingtip" or "wingtips" as rayfish. The printed name is "[if named][o]rayfish[x][otherwise][o]manta[x] rays[end if]". After going to Ocean Waters: if night, move the rayfish to the location; continue the action. After going in Ocean Waters: remove the rayfish from play; continue the action. The description is "[if we have not examined rayfish]Your breath catches in your throat as you realize what the lights are: huge, glowing [rayfish] gliding gracefully above the submerged sand at your feet. Their great broad backs give off a faint but steady phosphorescent glow, stronger at their wingtips[otherwise]The ghostly [rayfish] glide silently through the waters of the lagoon, each longer than you are tall[end if]." Instead of touching rayfish: say "Carefully, you reach down into the water as one of the great glowing creatures swims past. Velvet-smooth skin glides across your hand for a moment; then the creature suddenly darts away, leaving behind a cloud of jet-black [o]ink[x]."; move manta ink to the location; rule succeeds. Instead of attacking rayfish: say "You move to strike at one of the great glowing creatures, but instantly it jerks away and accelerates out of range, phosphorescence fading, and leaves behind a cloud of jet-black ink in its wake."; move manta ink to the location; rule succeeds. Understand the command "pet" as "touch".

Some jet-black manta ink is set dressing. Understand "jet" or "black" or "dense" or "cloud" or "pitch" as ink. The description is "The cloud of ink, though rapidly dispersing into the waters of the bay, is dense and seems pitch black[inkhint]." Instead of taking or touching ink, say "You move your hand through the cloud and lift it above the water; some of the black residue clings to your fingers." Check tasting ink: say "It's salty and fishy and warm, and not that tasty." instead. To say inkhint: if ( time for excitement or story mode ) and Back Room is visited and Jumble is unvisited, say ".[paragraph break]You notice that the ink is the precise shade of the black band painted on the back room door of the cabin on the beach".

A giant sea turtle is set dressing. The description of the turtle is "[if location is regionally in Beachfront]Its great rounded shell is mottled brownish-black, and it pulls itself along with powerful front flippers. Shrewd eyes gaze out at the world from a leathery face[otherwise]The turtle manages to seem both graceful and ridiculous as it paddles through the water, just under the surface[end if].". The initial appearance is "A giant sea turtle lumbers around the rounded edge of a boulder and swishes through the sand, taking no notice of you at all." Check taking giant sea turtle: say "He probably weighs a ton!" instead. Instead of touching or hugging giant sea turtle, say "You approach him cautiously and run your hands over his great, mottled shell, still wet with the surf. The turtle pulls his head cautiously back into his shell, but then slowly pokes it out again after a few moments to look at you skeptically.". Instead of attacking or pushing or climbing or entering giant sea turtle: say "You move towards the creature, but it flees with a speed you wouldn't have thought possible on its stubby legs, diving into the ocean and swimming to safety before you can reach it."; remove giant sea turtle from play. Check going when giant sea turtle is enclosed by location: remove giant sea turtle from play.

A seagull is an undescribed minor animal with provoke message "The [one of]bird[or]gull[or]seagull[in random order] [one of]squawks angrily[or]leaps into the air with a raucous call[or]dodges away and flaps its wings angrily[in random order], flapping up in a broad spiral to join its fellows[removeseagullfromplay].". Understand "seagulls" or "gull" or "gulls" or "bird/indigo/beak/beaks" as seagull. The description is "These seem larger and more streamlined than most you've seen, and their long yellow beaks are tipped with a vivid indigo rather than red. But their cries sound just as you'd expect.". To say removeseagullfromplay: remove seagull from play.

Some distant gulls are a minor set dressing. Understand "gull" or "seagull/seagulls" or "bird/birds" as distant gulls. The description is "They flap through the air, more sleek and graceful than most birds of their type, weaving complex patterns as the flock constantly swells and shrinks." The provoke message of distant gulls is "They're too far away."

The cluster of gulls is a backdrop in Beachfront. The description is "Flocks of seagulls and other birds make wide circles around the lagoon, occasionally diving down to snatch something from the warm blue water." Understand "seagulls" as the cluster of gulls.
	
Table of Crab ambience
freq		text	table	trigger	flag
uncommon		"A small orange [o]crab[x] picks its way carefully through the sand."	--	crab
uncommon		"[if tidein]A small crustacean carapace washes up to the beach[otherwise]A small [o]crab[x] picks at an abandoned carapace filling with sand, before losing interest and continuing along his way[end if]."	--	crab
uncommon		"A tiny orange [o]crab[x] freezes motionless as you approach."	--	crab
uncommon		"[if tidein]A wave tumbles a small orange [o]crab[x] end over end. It lies struggling upside down for a moment before righting itself and hurrying up the beach indignantly[otherwise]A little reddish-black [o]crab[x] digs at something in the sand with its front pincers[end if]."	--	crab


Table of Seagull ambience
freq		text	table	trigger	flag
uncommon		"A gull picks at its feathers with its beak before letting out a loud call."	--	seagull
uncommon		"A gull walks carefully along the [surface-material], occasionally poking at something with its indigo-tipped beak."	--	seagull
rare	"Two gulls flap wings and caw fiercely at each other for a moment over a piece of rotting fish, before one snatches it and takes to the air."	--	seagull
		
Table of Seagull Air ambience
freq		text	table	trigger	flag
common	"Gulls cry as they circle overhead, before heading back out to sea."	--	distant gulls
common	"A distant flock of gulls cry raucously as they wing their way along the edge of the coast."	--	distant gulls
rare		"A gull swoops by your head, momentarily startling you out of your wits."	--	distant gulls




Chapter - South Beach


The prose name of South Beach is "the beach near the boulders". Understand "beach" as northwest when location is Fork. South Beach is a room in Beachfront. The printed name of South Beach is "[if dir]South Beach[otherwise]Beach, Near the Path[end if]". The description of South Beach is "[southbeachdesc].". To say southbeachdesc:
	say "[if longform]Stretching out before you is a breathtaking white sand [o]lagoon[x] framed by a cliff of jet-black lava, the glimmering beach forming a languid half-moon curve around a shallow bay of deep, rich blue. The smell of the sea breeze on your face makes you [one of]pause for a moment; it's been a long time since you've seen ocean[or]smile[stopping].[otherwise][A sentence about the nearby beach]. [A sentence about the lagoon].[end if][line break][exits]".

The exits text of South Beach is "[sbex1][approach ocean bit][sbex3]". To say sbex1: say "The beach curves gently [bw of Center Beach][if dir][north] [end if]around the lagoon, [if night]vanishing into [dr]darkness[x][otherwise]stretching towards the distant rocky [dr]rise[x][end if], while disappearing closer at hand [bw of Among the Boulders]into "; say "[if Among the Boulders is visited]the stand of[otherwise]a stand of rounded[end if] [dr]boulders[x][if dir] to the [southwest][end if]. You could also ". To say sbex3: say ", or follow a faint path [bw of Fork][if dir][southeast][otherwise][up][end if] into [if day]dense[otherwise]shadowy[end if] vegetation". Understand "rise" or "darkness" as north when location is South Beach. 

To say approach ocean bit: if tidein and dir begin; say "head [bw of Ocean Waters][waytotide] into the waters of the lagoon"; otherwise if tidein and not dir; say "wade [bw of Ocean Waters][down] into the lagoon"; otherwise if tideout and dir; say "head [bw of Lower Beach][waytotide] down to where the waves are breaking"; otherwise; say "head [bw of Lower Beach][down] to where the waves are breaking"; end if. To say waytotide: say "[if location is South Beach][northwest][otherwise if location is Center Beach][west][otherwise if location is North Beach][southwest][end if]".

Some grassy mounds are a perchable setpiece in South Beach. Understand "grass" or "mound" as some grassy mounds. The description is "The tufts of grass, tentative toes of the forest, fringe its dark interior as they run in irregular clumps along the edge of the sand.". First report touching mounds: say "The blades of grass are pointy on top, but feel soft and springy as you run your hand through them." instead.

Report going from South Beach to Among the Boulders: say "You amble across the sand into rockier terrain[if a random chance of 1 in 3 succeeds][time-of-day-bit][end if].". Report going from South Beach to Center Beach: say "You follow the sweeping curve of the beach about halfway around its edge[if a random chance of 1 in 3 succeeds][time-of-day-bit][end if]." Report going from South Beach to Fork: say "You walk back up the path and return to the [if night]black interior[otherwise if dawn or morning or twilight or sunset]deep shadow[otherwise]shade[end if] of the forest[if Tsunami Sequence has ended], clambering over the soggy remnants of a mossy tree felled by the earthquake[end if]."

Chapter - Center Beach
	
The prose name of Center Beach is "the middle of the beach". Center Beach is a room in Beachfront. Understand "center" as south when location is North Beach. The printed name of Center Beach is "Beach, Near the [if Hut is visited]Abandoned[otherwise]Log[end if] Cabin". The description of Center Beach is "[centerbeachdesc].". To say centerbeachdesc:
	if longform begin; say "The beach widens here in the middle of its sweeping curve around the lagoon, rising in graceful white dunes to the sudden black slope of the old lava [o]flow[x]. Up against the flow is built a log [o]cabin[x], looking long-neglected but still intact";
	otherwise if night; say "The log [o]cabin[x] is barely distinct in the darkness, almost swallowed up by the looming lava [o]flow[x] behind it";
	otherwise if morning or sunrise; say "The long shadow of the lava [o]flow[x] stretches all the way to the water, leaving the ripples of the beach and the [o]cabin[x] in shadowless morning";
	otherwise if midmorning; say "Morning sunlight beams over the top of the lava [o]flow[x], warming the sand and the roof of the [o]cabin[x] in patches";
	otherwise if midday or dawn or twilight; say "[A sentence about the lagoon]";
	otherwise if raining; say "[A sentence about the lagoon]";
	otherwise if afternoon; say "The sand burns hot under your feet in the afternoon light, [if tidein]forcing you closer to the cool damp sand near the waves[otherwise]the tide too far off to cool it[end if], and the black cliff of the lava [o]flow[x] silently absorbs the heat";
	otherwise if evening or sunset; say "The sun sinks slowly towards the waves, which sparkle in brilliant reflections of gold and silver, sending dancing patterns of light over the black lava flow behind the [o]cabin[x]";
	end if;
	say ". [A sentence about the nearby beach][dot][exits]".

The exits text of Center Beach is "The beach stretches away [if dir][bw of North Beach]to the [north] and [bw of South Beach][south][otherwise][bw of South Beach]towards the cluster of [d]boulders[x] or [bwt of North Beach]the rocky [d]rise[x][end if], or you could [extcb]". To say extcb: say "also [approach ocean bit]. The cabin lies [bw of Hut][dr]up[x] the beach[if dir] to the [east][end if]". Understand "boulders/boulder" as south when location is Center Beach. Understand "rise" as north when location is Center Beach. [Understand "cabin" as east when location is Center Beach. ]

The log cabin is a setpiece in Center Beach. Understand "house" or "shack" as cabin. The description is "The small cabin lies well [up] above the high water mark, but stains and crusted salt near its base indicate spring tides have reached it in the past, and give the small building the feel of a place abandoned. The cabin rests flush against the black lava [o]flow[x] behind it.". Check entering the log cabin: try going inside instead. Check attacking the log cabin: say "Despite its ramshackle appearance, upon closer examination the construction is solid and the cabin seems undamaged." instead. The dream-text of log cabin is "felled trees notched for cabin construction".

The cb-rise is a setpiece in Center Beach with printed name "rise".  Understand "flow" as cb-rise. The description is "Now black and hardened, rising to some five or six times your height in steep, sharp angles, this lava flow sliced across the island decades or centuries ago, descending from the ruined cone of the volcano to the ocean near the rise.".

Report going from Center Beach to North Beach: say "You amble along the soft white sand of the beach, working your way [if dir]north [end if]around the edge of the bay." Report going from Center Beach to Hut: say "You clamber up the slipping sand past seaweed and shells at the high-water mark, then onto sturdier ground, before finally arriving at the building[if Hut is unvisited]. First peering cautiously through the doorway, you step inside[otherwise] and stepping inside[end if][if raining], grateful to be out of the rain[end if][if night] the black interior[end if]." Report going from Center Beach to South Beach: say "You walk around the edge of the beach towards some rockier terrain[if dir] near its southern end[end if][if a random chance of 1 in 2 succeeds][time-of-day-bit][end if]."


Chapter - North Beach

The prose name of North Beach is "the beach near the rise". North Beach is a room in Beachfront. The printed name of North Beach is "[if dir]North Beach[otherwise]Beach, Near the Rise[end if]". The description of North Beach is "[nbeachdesc].". To say nbeachdesc:
	if longform begin; say "A huge piece of moss-covered driftwood seems to guard [if tidein]this narrow strip of sand at the end of the beach, between the waves and[otherwise]the end of the beach, dominated by[end if] a rocky rise of hardened black lava that thrusts out into the sea. [one of][A sentence about the lagoon], framed by the rustling of tropical [o]trees[x], their green fronds casting welcome shadows across the sand[or][A sentence about the konokuk trees][at random]";
	otherwise if raining; say "Rain patters noisily on the old piece of driftwood, and runs in dribbles and curtains down the jagged side of the lava flow"; 
	otherwise if afternoon and rained; say "The huge piece of driftwood is dark and dripping with moisture in the aftermath of the storm";
	otherwise if night; say "The weird outlines of the driftwood, grown huge and monstrous in the tropical darkness, tell you you've reached [if former location is Rise]the beach[otherwise]the end of the beach[end if]";
	otherwise if dawn or sunrise or morning; say "The curves and whorls of the driftwood are smoothed into painterly abstraction by the shadowless morning light";
	otherwise; say "[one of][A sentence about the lagoon], while [if konokuk trees are named]the konokuk trees[otherwise]tropical trees[end if] rustle above your head[or][A sentence about the konokuk trees][at random]";
	end if;
	say ". [A sentence about the nearby beach].[paragraph break][exits]".

tsunami-pushed-vine is a truth state that varies.

The exits text of North Beach is "[if dir]To the east and north[otherwise]Opposite the lagoon[end if], [etnb2]". To say etnb2: if night, say "the sky is blotted out by rocky cliffs"; otherwise say "the beach is pinched off by black cliffs"; say ", but near [if tidein]the tide[otherwise]the high water mark[end if] [if Rise is unvisited]you can see a possible[otherwise]is the[end if] [etnb3]". To say etnb3: say "route [bw of Rise][if dir][northwest] [end if]to the top of the [dr]rise[x]. Sand stretches [bw of Center Beach][if dir][south][otherwise]back[end if] "; say "towards the [dr]center[x] of the beach, and you could also [approach ocean bit][etnb4]". To say etnb4: if withered vine is open, say ".[paragraph break]A loose vine hugs the steep slope up to the [dr]saddle[x][if dir] to the [east][end if], stretching up to the big [if tree1 is named]windsigh[otherwise]tree[end if] high above[if tsunami-pushed-vine is true][one of]. It must have been shaken loose from somewhere up above in the quake[or][stopping][end if]". Understand "saddle" as east when location is North Beach and withered vine is open.

Check going east in North Beach when withered vine is closed: say "The cliffs in that direction are impassable." instead.

A huge piece of moss covered driftwood is a perchable setpiece in North Beach. Understand "wood" or "drift wood" or "massive/piece/patch/patches" as driftwood. The description is "The massive piece of wood has been bleached clean and rubbed smooth by countless years in the sea, a giant, misshapen bone thrusting out of the sand. Patches of pale green moss cling to its underside.". First report touching driftwood: say "The wood is smoother than you expected, the bark long since rotted away leaving only hard white curves, bumps and imperfections only rounded echoes now." instead. Instead of pushing or taking driftwood, say "You heave against the edge of the driftwood, but it is firmly buried in the sand, and probably has been for years.". The dream-text of driftwood is "polished pieces of driftwood". Does the player mean entering the driftwood: it is likely. Check entering driftwood: say "You clamber atop the ancient driftwood and rest for a few moments[time-of-day-bit]. The sea-smoothed wood is like [if sunup]warm[otherwise]cool[end if] glass under your hands.[paragraph break]Finally, you climb back down to the beach." instead. Instead of entering withered vine when location is North Beach and withered vine is closed: try entering driftwood instead.

Some black lava cliffs are a setpiece in North Beach. Instead of entering or climbing black lava cliffs, try going east.

Report going from North Beach to Rise: say "You clamber easily over the ancient lava rock, worn smooth by pounding surf, till you stand on top." Report going from North Beach to Center Beach: say "You follow the gentle curve of the white sand beach back around till you near its center[if a random chance of 1 in 2 succeeds][time-of-day-bit][end if]."




Chapter - Among the Boulders

Among the Boulders is a room in Beachfront. The prose name of Among the Boulders is "the stand of rounded boulders".  The description of Among the Boulders is "[atbouldersdesc].". Understand "boulder/boulders" as southwest when location is South Beach. Understand "boulder/boulders" as northeast when location is Tidepools.

To say atbouldersdesc: 
	if longform begin; say "Large mottled boulders rise from the sand here at the end of the beach, rubbed smooth by eons of tides and wind, green lichens clutching their sides. Across the bay, a rocky volcanic rise sticks out into the ocean, forming the lagoon's far boundary; this end is framed by a rocky point beyond the boulders[dot]";
	else if raining; say "Rain smoothly patterns on the great grey boulders, slipping smoothly off their egg-shaped tops[dot]";
	otherwise if rained and ( afternoon or evening ) ; say "The rounded boulders rise warm and wet in the sinking sun, smelling of sea-kissed stone[dot]";
	otherwise if afternoon; say "The rounded edges of the boulders glow warmly in the light of the afternoon sun[dot]";
	otherwise if dawn or twilight; say "The boulders keep a silent vigil in the eerie [if dawn]dawn light[otherwise]twilight[end if], like strange monuments[dot]";
	otherwise if sunrise or morning; say "Pink morning light kisses the tops of the great mottled boulders, casting a jumble of confused shadows over the sandy paths wandering towards the point[dot]";
	otherwise if night; say "The boulders rise from the sand in a confusion of curved shapes, great black eggs blotting out the stars on all sides[dot]";
	otherwise; say "[one of][room ambience][or][if tidein]Waves lap gently against the sides of the rounded boulders, in tune with the calls of the seagulls[else]The boulders stand stoically in the sunlight, their rounded tops faintly reflecting the blue of the sky[end if][dot][at random]";
	end if;
	say "Small green [o]mussels[x] cling to the lower edges of the boulders, [if tidein]wetted by the spray of the surf[otherwise if sunup]baking in the sunlight[otherwise]nearly invisible in the [light-source][end if].[paragraph break][exits]".

To say atb_tide: say "[if tidein]The tide crashes against a bank of low smooth stones running [bw of Ocean Waters]into the ocean[otherwise]A bank of slippery stones stretches [bw of Lower Beach][dr]towards[x] the wet sand[end if][if dir] to the [north][end if]". Understand "towards" as north when location is Among the Boulders and tideout. 

The exits text of Among the Boulders is "Sandy paths wander [bw of Tidepools][if dir][southwest] [end if]towards the rocky [dr]point[x], while the beach opens up [bw of South Beach][if dir]to the [northeast][otherwise]towards the edge of the [d]forest[x][end if]. [atb_tide]". Understand "into" as north when location is Among the Boulders. Understand "point" as southwest when location is Among the Boulders. Understand "forest" as northeast when location is Among the Boulders. Understand "towards" as north when location is Among the Boulders and tidein.

Boulders-stuff is stuff in Among the Boulders. Understand "path/paths/bank" as Boulders-stuff when location is Among the Boulders.

Some small green mussels are a backdrop. They are in Among the Boulders, Tidepools, and Top of Ravine. Understand "mussel/fragment/fragments/shell/shells/whorl/whorls" as mussels. The description is "A bit longer and wider than a fat thumb, they are a deep forest green cut through with striated arcs of lighter shades. Fragments of the shells of their ancestors tumble in the surf, diminishing to gritty green whorls[musselhint].". Check taking mussels: say "The living mussels are gripped tightly to the rocks, but you pick up a green shell fragment tumbling in the surf and turn it in your hands for a moment, admiring the rich coloration, before tossing it back into the foam." instead. Instead of pulling or opening mussels, say "Tiny barnacles clinging to their shells and the slippery sea water prevent you from getting a good grip.". Check tasting mussels: say "You manage to pry one of the mussels off the rock and awkwardly scrape some of the rubbery flesh off the shell. The taste is refreshing but fairly bland; perhaps cooked or with some seasonings they would taste better." instead. Check attacking mussels: say "You take one abandoned mussel shell and smash it against the rock. It shatters into dozens of virescent fragments and wisps of green powder." instead.

To say musselhint: if ( time for excitement or story mode ) and Back Room is visited and Jumble is unvisited, say ".[paragraph break]You notice that the color of the mussel shells is the same shade as the green band of color painted on the door of the cabin on the beach".

The ambience table of Among the Boulders is the Table of Among the Boulders ambience.

Table of Among the Boulders ambience
freq		start time	end time	text	table		trigger	flag
rare	dawn		sunset	--	--	giant sea turtle
uncommon		dawn		twilight	"A [o]crab[x] wends its way between the boulders, either lost or unusually adventurous."	--	crab
rare	dawn		twilight	"A [o]gull[x] flutters in from sea and perches on the exact top of a large, rounded boulder looming above you."	--	seagull

Some great round boulders are a perchable setpiece in Among the Boulders. Understand "mottled" or "boulder" as boulders when location is Among the Boulders. The description is "Rounded monoliths." Instead of climbing or entering great round boulders, say "You give it a good try, but the sides are too wet and slippery. You have no idea how [the Progue] got up there.". Check touching great round boulders: say "The sides are surprisingly smooth, mottled with strange moss and lichens." instead. The dream-text of great round boulders is "crates of egg-shaped rocks". Check taking great round boulders: say "They are huge, and must have been bured in the sand here for eons." instead.

Report going from Among the Boulders to Tidepools: say "You weave through the boulder stand, clambering over a few shorter rocks here and there, and eventually break out onto a wet, rocky point." [Report going from Among the Boulders to South Low Tide:  say "[if tidein]You wade out into the warm water, stepping carefully until the rocky ground gives way to smooth, fine sand[otherwise]You clamber carefully across rocks slick with water and seaweed before reaching the warm fringe of the tide[end if]."] Report going from Among the Boulders to South Beach: say "You leave the boulders behind and walk back to the smooth white sand of the beach."




Chapter - Tidepools

Tidepools is a room. The prose name of Tidepools is "the tidepools".

The description of Tidepools is "[tidepoolsdesc].". To say tidepoolsdesc:
	do the room description dance with Table of Tidepools Structure and Table of Tidepools Description.

Table of Tidepools Structure
time			s1	s2	s3	s4	s5	s6	s7	s8	s9	s10
dawn		3	4	2	99	5	6	99	7	a number	a number
sunrise		3	4	2	99	5	6	99	7
morning		1	4	2	99	5	6	99	7
midmorning	1	4	2	99	5	8	99	7
midday		1	4	2	99	5	8	99	7
afternoon		1	4	2	99	5	8	99	7
evening		9	4	2	99	5	8	99	7
sunset		9	4	2	99	5	6	99	7
twilight		10	4	2	99	5	6	99	7
night			1	4	2	99	7

Table of Tidepools Description
row	text
1	"A rocky point ends here with a cluster of small"
2	"[if tidein]battered and churned by the relentless breaking of waves[end if][if tidein and raining] and rain[end if][if tideout and raining]broken into dancing mirrors by the rain[end if][if tideout and not raining]smooth mirrors of the [light-source] above[end if]"
3	"Morning sunlight just touches this rocky point, strewn with tiny"
4	" [o]pools[x], "
5	"From here the whole lagoon stretches out before you, "
6	"[a phrase about the mountain]"
7	"[paragraph break][exits]"
8	"from [distantcabin] in the center of the beach to the [o]mountain[x] and [o]volcano[x], looming over either end"
9	"The sinking sun sets over this cluster of little"
10	"Under the fading light are a handful of small"

To say distantcabin: if Center Beach is visited or Tidepools is visited, say "the [o]cabin[x]"; otherwise say "a small log [o]cabin[x]". The tp-cabin is a view with base room Hut. It is in Tidepools. It is far from Tidepools, Lower Beach, Ocean Waters, South Beach, North Beach, and Rise. Understand "log/cabin" as tp-cabin when location is Tidepools. The printed name is "distant cabin". The description is "About halfway around the curve of the bay, the cabin is built up flush against the old lava flow which forms the beach's natural back wall.". 

The exits text of Tidepools is "Dry land snakes [if dir][northeast] [end if]back towards the cluster of [dr]boulders[x]. There is no safe place to enter the ocean from here". 

Tp-stuff is stuff in TIdepools. Understand "point/hollow/bowl/foam" as Tp-stuff when location is TIdepools. 

Check sleeping in Tidepools: say "It's too wet and rocky here.[sleepsuggest]" instead.
				
Some tide-pools are a setpiece in Tidepools with printed name "tidepools". Understand "tidepool" or "tidepools" or "tide pool" or "tide pools" or "pool" or "pools" or "series" or "mirror/mirrors" as some tide-pools. The description is "Clinging precariously to every hollow and bowl in the jumbled rock, the pools [if high tide]are churned into constant motion by the tide, their surfaces a mass of blue-white foam[otherwise if tidein]are rimmed with clumps of drying foam, their surfaces disturbed every few minutes by rogue waves[otherwise]are placid windows into a world of tiny darting [o]creatures[x] and surprising shades of color[end if].". The dream-text of tide-pools is "miniature snow-globes filled with tiny anemones and starfish". Instead of entering or swimming in tide-pools, say "The pools are so filled with strange creatures that you're half-afraid and half-reluctant to disturb their miniature world.".

Some tiny creatures are an undescribed animal in Tidepools. Understand "starfish" or "minnow" or "minnows" or "fingers" or "anemone" or "anemones" or "creature" as tiny creatures. The description is "[if night]In this darkness, you can't make out any detail[otherwise]Bright orange starfish, tiny pastel minnows, and bulbous fingers of purple and maroon sea anemones: each tidepool is like a tiny aquarium." Check taking tiny creatures: say "You pick up one of the orange starfish, and watch its thousands of tiny legs wiggle in peristaltic waves and contractions before carefully replacing him." instead.

The ambience table of Tidepools is the Table of Tidepools ambience.

Table of Tidepools ambience
freq		start time	end time	text	table		trigger	flag
frequent	high tide	--		"[one of]With a crash, a wave breaks against the jagged rocks of the point, spraying you with surf and sending foam swirling around your ankles[or]A wave breaks against the rocks, sending a surge of seawater past your feet[or]A wave smashes against the rocky point, sending a wall of spray airborne and half drenching you[or]A wall of water crashes into the rocky point, sending foamy waves surging through the tidepools[at random]."
common	--	--	--	Table of Tide ambience
common	morning		evening	--	Table of Seagull ambience

Report going northeast from Tidepools: say "You step carefully[if tidein] through the crashing surf[end if] back towards the beach[if a random chance of 1 in 2 succeeds][time-of-day-bit],[end if] until you find yourself among the boulders again.". Check vague swimming when location is Tidepools: say "It's too rocky to safely enter the water from this point." instead.



Chapter - Lower Beach

The prose name of Lower Beach is "the shore". The printed name of Lower Beach is "[if tidein]Wading In the Lagoon[else]Lower Beach".

The description of Lower Beach is "[if tideout][lowerbeachdesc].[else][description of Ocean Waters]". To say lowerbeachdesc:
	if raining, say "The soft drumming of rain on wet sand fills your ears with a basso thrum. Curtains of rainwater wash down the saturated beach, the line between sea and land turned into one between salt water and fresh";
	otherwise say "The tide breaks at your feet, sending warm runners of foam [if low tide]to kiss the wet sand by your feet[otherwise]splashing around your ankles[end if]";
	say ". The sand is smooth and damp, sprinkled with a profusion of shells, small stones, and clumps of seaweed. [paragraph break]A huge and beautiful [o]sculpture[x] of a manta ray, carved from some clear crystal, sits on a track running into the waves.[paragraph break][exits]".

LowerBeach-stuff is stuff in Lower Beach. Understand "curtain/curtains/runner/runners/foam" as LowerBeach-stuff when location is Lower Beach.

The exits text of Lower Beach is "You can [if tideout]hike back up[else]wade towards[end if] the beach in one of several directions: [if dir][northeast] [end if]towards the rocky [dr]rise[x], [if dir][east] [end if]towards the log [dr]cabin[x], or [etlb2]". To say etlb2: say "[if dir][southeast] [end if]towards the [dr]beach[x] near the path. You could also wade [if tidein]farther [end if]out into the ocean [dr]waters[x][if dir] to the [west]". Understand "rise" as northeast when location is Lower Beach. Understand "cabin" as east when location is Lower Beach. Understand "beach" as southeast when location is Lower Beach. Understand "waters" as west when location is Lower Beach.

The manta sculpture is a setpiece in Lower Beach. The description is "The sculpture is stunningly beautiful, capturing every curve of the graceful manta creature's flattened form. The clear crystal shimmers in the [light-source], and peering closer you can see that the sculpture is actually hollow. A [o]hatchway[x] on the top provides access to the interior.". Instead of opening or entering the manta sculpture, try going inside. Understand "crystal" as manta sculpture.

Instead of doing anything to the manta sculpture when tidein: say "It's submerged by water right now; you can't access it.".

The hatchway is part of the manta sculpture. The description is "A round wheel on top opens the hatchway, which looks airtight.". Understand "wheel" as hatchway. Instead of opening or turning or entering the hatchway, try going inside.

Report going from Lower Beach to Beachfront: say "You [if tidein]emerge from the shallow water and [end if]hike up the drying beach[if a random chance of 1 in 3 succeeds][time-of-day-bit],[end if] leaving the soft crash of the surf far behind." Report going from Beachfront to Lower Beach: say "You walk down towards the breakers on dampening sand[if a random chance of 1 in 2 succeeds][time-of-day-bit][end if].". 

Report going from Lower Beach to Inside-Manta: say "You turn a wooden wheel on the hatchway, pull it open with a wet sucking noise, and clamber inside. The interior is just tall enough that you can sit up without bumping your head. As you sit, however, the hatchway clangs shut behind you, releasing a hidden catch; and the manta sculpture glides forward down the track, cuts through the breaking waves effortlessly, and descends into a beautiful undersea paradise.".

Check going north in Lower Beach: say "The rocks in that direction are too sharp to clamber ashore." instead. Check sleeping in Lower Beach: say "Not here. When the tide comes back in, you'd be washed away.[sleepsuggest]" instead.

Chapter - Inside-Manta

After going to Inside-Manta: if night, move im-rayfish to Inside-Manta; else remove im-rayfish from play; continue the action. Some im-rayfish are a minor setpiece in Inside-Manta with printed name "rayfish". Understand "rayfish/manta/mantas/ray/rays" as im-rayfish. First check examining im-rayfish: say "The ghostly [rayfish] glide silently through the waters of the lagoon around you, each longer than you are tall. From within the sculpture, you have a strange sense of spatial vertigo, as if you float in deep space while luminous star creatures ripple through infinite black void." instead [this is the avoid the "most things indoors can't be examined at night" rule.]. The provoke message of im-rayfish is "They're in the water on the other side of the crystal.". 

The prose name of Inside-Manta is "inside the manta sculpture". The printed name of Inside-Manta is "Inside the Manta, Under the Waves". The description of Inside-Manta is "[insidemanta-desc]". Inside-Manta is indoorsy. Check sleeping in Inside-Manta: say "That may not be the best idea. You're not really sure how much air there is in here.[sleepsuggest]" instead.

To say insidemanta-desc:
	if night:
		say "Phosphorescent glows drift through the black lagoon around you as the [o]rayfish[x] glide effortlessly through the lagoon[dot]";
	otherwise:
		say "Surrounding you on all sides is a fantastic underwater vista. Brightly colored [o]fish[x] twirl and dart among coral reefs and gently waving plants of red and green. [if sunup]Sunlight[else if moonup]Moonlight[else]Starlight[end if] filters heavily through the waves and the transparent crystal of the sculpture; the facets are so expertly carved you hardly notice it's there[dot]";
	say "The hatchway above leads [outside], though you probably don't want to use it while you're underwater. A large wooden [o]wheel[x] on the floor seems to interface with the track on the ocean floor, which ends beneath you[dot]";
	if Progue is fulfilling and the animus of Progue is swimming:
		say "Above you through the crystal, you can see [the Progue], floating languidly on the surface of the water.";
		move distant-Progue to location;
	else:
		fire one off by frequency from Table of Inside-Manta Ambience, definitely selecting, no extra spacing.

InsideManta-Stuff is stuff in Inside-Manta. Understand "vista/underwater/sides/coral/reef/reefs/plant/plants/waves/crystal/sculpture/facet/facets" as InsideManta-Stuff when location is Inside-Manta.

The manta-apparatus is a minor setpiece in Inside-Manta with printed name "apparatus" and provoke message "The mechanism seems designed to allow one to move the sculpture back up the track to dry land again under one's own power.". Understand "interface/apparatus/track/gear/gears" as manta-apparatus when location is Inside-Manta.

A manta-wheel is a prop in Inside-Manta. Understand "wheel/handle" as manta-wheel. The printed name is "large wooden wheel". The description is "The wheel lies flat against the crystal floor of the manta, through which you can dimly see some gears and the track below. It looks like by gripping the handle you could make a wide stirring motion to turn the wheel.". Check turning manta-wheel: try going outside instead.

Report going from Inside-Manta to Lower Beach: say "Gripping the handle, you begin turning the wheel. The gears below you spin, and you feel the manta slowly pulling back up the track.[paragraph break]It takes a few minutes, but you slowly emerge from the waves until you're resting on the lower beach again, and climb out of the sculpture."

Some fish are a minor backdrop in Inside-Manta. Understand "school/minnow/minnows/eels/goldfish/turtle" as some fish. The description is "[fishdesc]". To say fishdesc: fire one off by frequency from Table of Inside-Manta ambience, definitely selecting, no extra spacing. The provoke message of some fish is "You're completely sealed in here; you can't reach them."
	
The ambience table of Inside-Manta is the Table of Inside-Manta ambience.

Table of Inside-Manta ambience
freq		start time	end time	text	table		trigger	flag
frequent		dawn		twilight	"[one of]Tens of dozens of[or]A few dozen[or]Hundreds of[or]A few[or]A handful of[in random order] [one of]skinny silvery fish[or]tiny crimson minnows[or]lacy black fish[or]goldfish with stripes of cerulean blue[or]bright yellow fish the size of your hand[or]tall and skinny aqua fish like pancakes on end[in random order] [one of]float by[or]slip through the blue[or]swim near you[in random order], [fishfun1]." [plural]
frequent		dawn		twilight		"[one of]A school of[or]A[or]A cluster of[or]A dense grouping of[in random order] [one of]stout, ugly fish with scales like rock[or]bright orange fish covered in spines[or]long silver fish the size of your leg[or]beautiful red fish with long, graceful fins like bridal veils[in random order] [one of]swims past you[or]floats nearby[or]glides past[in random order] [fishadverb1]." [singular]
frequent		dawn		twilight	"A [one of]larger wave[or]wave[or]energetic swell[in random order] [one of]surges by above your head[or]swirls chaotically past the surface above you[at random], [one of]tugging at the green and red fronds on the floor and causing them to bob and sway hypnotically[or]pulling all the fish along in its momentary disruption of the current[or]sending whorls of surf bubbles spiraling down towards you[in random order]."
frequent		dawn		twilight	"A[one of] silver-red fish the size of your arm[or] huge deep blue fish dotted with brown and orange spots[or]n electric green fish with fins four times longer than its body[or] wriggling black eel with midnight blue stripes[in random order] [one of]darts up to the surface, about a body's length above you, to snatch some morsel floating on the swell[or]snatches a smaller fish in its jaws and darts away[or]pokes languidly at a crevice in the coral reef with its mouth[or]snatches some floating morsel out of the water nearby[in random order]."
common	dawn		twilight	"A [one of]fat[or]slender[or]rounded[at random] [one of]purple-black[or]pink[or]white[or]indigo[at random] fish momentarily fights with a [one of]larger[or]smaller[at random] [one of]silver[or]turquoise[or]blue-grey[or]bronze[at random] one over some [one of]disintegrating morsel[or]bit of food[or]edible flotsam[at random] before beating a hasty retreat."
uncommon		dawn		twilight	"A translucent jellyfish swims delicately by, its body glimmering prismatically in the light of the [light-source] slanting through the waves."
uncommon		dawn		twilight	"[one of]A sea turtle swims[or]Two sea turtles swim[at random] above the reef in the distance, kicking stubby legs but somehow managing to seem graceful."
guaranteed		twilight	night	"[one of]Glowing[or]Spectral[or]Luminescent[at random] rayfish [one of]glide effortlessly[or]swim in graceful ripples[or]float serenely[at random] through [one of]the black lagoon[or]the dark waters[or]the darkness outside[at random][if a random chance of 1 in 3 succeeds]. One spooks, ejecting a cloud of jet-black ink before speeding away into the dimness[end if]."

To say fishfun1: say "[one of]dodging first this way, then that[or]drifting lazily in the swells[or]feeding on tiny specks suspended in the water[or]staying close together[or]weaving through sinuous stands of seaweed[or]skimming the surface of the coral reef[or]darting in and out of hiding places in the coral reef[in random order]".

To say fishadverb1: say "[one of]grumpily[or]appraisingly[or]cautiously[or]confidently[or]languidly[or]hungrily[in random order]".

Chapter - Ocean Waters

	
The prose name of Ocean Waters is "the lagoon". The description of Ocean Waters is "[oceanwdesc].". To say oceanwdesc:
	say "[A sentence about the ocean swells]. [A sentence about the lagoon]. [paragraph break][exits]".

The exits text of Ocean Waters is "Short of swimming out to the ocean, the only real places to go are back [if dir][east] [end if]to the [dr]beach[x], or scrambling up towards the rounded [dr]boulders[x][if dir] [south][end if]". Understand "beach" as east when location is Ocean Waters. Understand "boulder/boulders" as south when location is Ocean Waters.

OceanWaters-stuff is stuff in Ocean Waters. Understand "water/ocean/sea/seawater/swell/swells" as OceanWaters-stuff when location is Ocean Waters.

Check sleeping in Ocean Waters: say "With water up to your [waistankles], you'll probably find that rather difficult.[sleepsuggest]" instead.

To say a sentence about the ocean swells:
	if raining begin; say "Rain falls, waves surge around your [waistankles], and thousands of tiny raindrop splashes surround you, ensuring a thorough soaking. At least it's warm water";
	otherwise if night; say "The warm water of the lagoon laps quietly at your [waistankles], [if moonup]reflecting broken sparkles of shimmering silver-pink moonlight up at you[otherwise]faint twinkles of the stars and galaxy above mingling with hints of foam[end if]. Caught between rolling black velvet and the arching black sky, you feel strange and unreal";
	otherwise; say "Warm seawater [if evening or sunset]sparkles brilliantly and [end if][if twilight]still glows under the failing light and [end if]surges about your [waistankles] as you wade through the [if night]blackened [end if]lagoon, the sand like wet velvet under your feet";
	end if.

To say waistankles: say "[if location is Ocean Waters]waist[else]ankles".

Check vague swimming when location is in Tiderooms or location is Lower Beach or location is Beachfront:
		pass 15 minutes of time;
		say "You[if location is in Tiderooms] [otherwise] wade out into the surf and [end if]dive forward[if raining], feeling the liquid contrast between the warmer waters of the lagoon and the cool rain[end if]. ";
		if night, say "The glowing mantas beneath you and the great galaxy [if galaxy is named]Capalla [end if]above make this seem like a dream, but it feels real when your muscles begin to complain.[paragraph break]At one point, you accidentally brush against one of the majestic creatures. It tenses, then squirts a cloud of jet-black [o]ink[x] at you before darting away";
		otherwise say "[one of]Paralleling the shore, you do a few strokes under the [light-source][or]Eagerly, you swim out a bit and then back in, enjoying the scenery[in random order]. [if wounded]You have to swim carefully because of your injured leg, but it still feels good to stretch your muscles[else if not raining]It feels good to stretch your muscles a bit, and the water is warm and refreshing[otherwise]The exercise does you some good, though you are beginning to feel rather waterlogged[end if]";
		if night, move manta ink to the location;
		say ".[paragraph break]After a few laps you [if location is in Tiderooms]stand back up[otherwise]wade back onto shore[end if][if sunup and not raining], the tropical heat quickly baking you dry[end if]." instead.

The ambience table of Tiderooms is the Table of Tiderooms ambience.

Table of Tiderooms ambience
freq		start time	end time	text	table		trigger	flag
common		rising uptide	falling uptide	"A clump of seaweed drifts by, bobbing gently in the surf."
frequent		night		dawn		--	Table of Manta Ray ambience
frequent		dawn		twilight	--	Table of Fish ambience
uncommon		--		--	"A big swell surges past, momentarily wetting you to your chest."
rare		--	--	--	Table of Jellyfish ambience
rare		dawn	twilight	--	Table of Sea Turtle ambience

Table of Fish ambience
freq		text	table		trigger	flag
frequent		"A school of reddish-silver [o]fish[x] dart past your knees."	--	generic-fish
frequent		"A silvery [o]fish[x] shoots by at high speed like some undersea arrow."	--	generic-fish
common	"A corn-yellow [o]puffer[x] fish drifts by, tiny fins straining against its bulky mass and the swirling waters of the lagoon."	--	puffer-fish
common	"A large crimson [o]fish[x] darts in from nowhere to snap up a tiny silver one, as the others in its school scatter in all directions."	--	generic-fish
common	"A long skinny [o]fish[x], its scales a fluorescent green sheen in the [light-source], circles playfully around you a few times before darting off."	--	generic-fish

Table of Jellyfish ambience
freq		text	table	trigger	flag
frequent		"Moving gracefully, a silver-white [o]jellyfish[x] with hundreds of delicate arms trailing behind it jets slowly past you."	--	jellyfish
uncommon		"A large crimson fish darts for a silver-white [o]jellyfish[x], but the jellyfish snares the attacker in its tendrils; after a frantic moment, the fish squirms free and races away."	--	jellyfish

A jellyfish is set dressing. The description is "The translucent creature is almost invisible against the backdrop of the water.". Instead of attacking or taking or tasting or touching jellyfish, say "It jets away when you move too close to it.".

A generic-fish is set dressing. Understand "school/fish/silver/silvery/large/red/skinny/green/fluorescent" as generic-fish. The printed name is "fish". The description is "The fish dart so quickly through the water that you can only catch glimpses.". Instead of attacking or taking or tasting generic-fish, say "You'd be hard pressed to catch any of these creatures with your bare hands.". Check touching generic-fish: say "You hold out a hand, but the fish skitter away." instead.

A puffer-fish is set dressing. Understand "puffer fish" or "puffer" as puffer-fish. The printed name is "puffer fish". The description is "This fat fish has an almost human expression as he struggles to keep up with a school of small silver fish who continually dart away from him.". Instead of attacking or taking or tasting or touching puffer-fish, say "The puffer fish suddenly swells to the size of a balloon, then, when this doesn't scare you off, splashes speedily away.".

Table of Sea Turtle ambience
freq		text	table		trigger	flag
frequent		"A sea [o]turtle[x] swims past you, surprisingly graceful, its scaled legs kicking and shell bobbing along, just touching the surface."

Table of Manta Ray ambience
freq		text	table		trigger	flag
frequent		"A huge glowing [rayfish] swims past you, a great dark ghost."
frequent		"The [rayfish] shimmer and as they glide with grace through the water around you."
common	"A glowing [rayfish] whispers past your feet, momentarily brushing them with silken-smooth wings."

Report going from Ocean Waters: say "You slosh your way towards the shore, push past the breakpoint where the gentle swells tumble over themselves into knee-high waves, and finally step back onto the sand.".

Report going to Ocean Waters: say "You wade out into the surf. The lagoon is shallow enough that you walk quite far before the water climbs past your knees.".

Check going west in Tiderooms: try vague swimming instead.


Part - Progue's Domain

Chapter - Hut

Hut is inside from Center Beach.
	
Check sleeping in Progue's Domain: say "You're not going to sleep very well on these old warped boards.[sleepsuggest]" instead.

The prose name of Hut is "the log cabin". The printed name of Hut is "Abandoned Cabin". The description of Hut is "[hutdesc].". To say hutdesc:
	if longform begin; say "Sand drifts around the open doorway, spilling out in tiny dunes across the wooden floorboards[if Back Room is visited or Studio is visited] disturbed only by your footsteps[otherwise], undisturbed[end if]. Bare, water-stained walls frame a small room, empty and abandoned save for a manta ray [o]skeleton[x] hanging from one wall; some frayed ropes tied to one beam are the only other hint of past furnishings";
	otherwise if raining or dawn or twilight; say "The cabin's front room is gloomy and indistinct in the dim light that filters from outside, [if raining]though the roof provides welcome protection from the storm[otherwise]still as a tomb[end if]";
	otherwise if sunset or evening; say "Evening light floods the room as the setting sun shines through the open doorway";
	otherwise if night; say "[if moonup]Pale pink moonlight angles through the open door of the cabin, but illuminates little beyond the sharp edges of shadow it casts on the weather-beaten floorboards[otherwise]The cabin is black in the moonless night, only the dimmest traces of starlight spilling in through the open doorway";
	otherwise if sunrise or morning; say "Reflected light from the morn-kissed lagoon bounces into the cabin, bringing hints of color to the water-stained floorboards";
	otherwise; say "The white glow of the beach through the open door is brilliant; your eyes struggle to adjust to the dim interior of the cabin instead";
	end if;
	say ".[paragraph break]";
	if Tsunami Sequence has ended begin;
		say "The cube must have been smashed against a wall in the earthquake or tsunami; only fractured remnants remain now. The [o]sketchbook[x], waterlogged and awry, seems nevertheless intact";
	otherwise if cube is Progue-disturbed;
		say "The wooden [o]cube[x] lies upended in the middle of the floor[if cube is closed]. The violence has popped it open, and a worn [o]sketchbook[x] lies half-in, half-out, pages flapping faintly on the floor[otherwise], the [o]sketchbook[x] half-in, half-out, flipped to the page with the tree[end if]";
		now wooden cube is open;
	otherwise;
		say "The room's sole other feature is [if we have examined the wooden cube]the[otherwise]a[end if] [if wooden cube is open]open [end if]wooden [o]box[x][if wooden cube is open and the sketchbook is in cube] (containing [the sketchbook])[otherwise if Hut is unvisited] discarded in a corner[otherwise] lying askew on the floor[end if]";
	end if;
	say ".[paragraph break][exits]".

Hut-stuff is stuff in Hut. Understand "steps/footsteps" as Hut-stuff when location is Hut.

The manta ray skeleton is a setpiece in Hut. The description is "The skeleton, mounted on the wall, makes a large diamond, and must have once belonged to some flat, manta ray creature with rare elegance. Now, bleached and dusty, it only seems to add to the loneliness and neglect of the cabin.". Check touching manta ray skeleton: say "The bone is cold and hard." instead. Check taking manta ray skeleton: say "It's mounted on the wall." instead.

The exits text of Hut is "Two smaller interior doorways lead [ethut_extended]. You can also step back [d]outside[x]". Understand "porch/studio" as north when location is Hut. Understand "storage" or "interior" as east when location is Hut.

To say ethut_extended:
	say "[if dir][north] [end if]to ";
	if Studio is visited, say "the [if sunup]brightly-lit[otherwise if dawn or twilight]dim interior of the[otherwise]dark[end if] [dr]studio[x]";
	otherwise say "a [if sunup]bright[otherwise if dawn or twilight]dim[otherwise]dark[end if] [dr]porch[x]";
	say " or [if dir][east] [end if]to ";
	if Back Room is visited, say "the tiny [dr]storage[x] room";
	otherwise say "a[if sunup] darker[otherwise if dawn or twilight]n indistinct[otherwise] black[end if] [dr]interior[x]".

The hutsand is a prop in Hut. The printed name is "sand". Understand "sand" or "drifts" or "tiny" or "dunes" as hutsand. The description is "Piled to your ankles near the door, the miniature dunes shrink down to the thickness of grains by the far walls[if Back Room is unvisited], utterly smooth and undisturbed-- though perhaps the beach winds would smooth out footsteps in days[otherwise if Jumble is unvisited], disturbed only by your footprints[end if]." The dream-text of hutsand is "buckets of sand".

The hammock remnants are a minor prop in Hut. Understand "strands" or "rope/ropes/hammock" or "rotten/frayed" as remnants. The description is "It looks as if something like a hammock once hung here, but in some past year of flooding the ropes must have weakened and rotted away. The few remaining strands are useless." The provoke message is "Too rotted and weak to be useful for anything.".

Report going from Hut to Center Beach: say "You step back outside into [if raining]the rain[otherwise if sunup]the sunlight[otherwise]the night[end if], walking down the beach in the direction of the surf." Report going from Hut to Studio: say "You duck through the small doorway into a windowed porch." Report going from Hut to Back Room: say "You step through the doorway into a smaller room at the rear of the cabin."

Section - The Cube and the Sketchbook

A wooden cube is an undescribed openable container in Hut. It is closed and fixed in place. The wooden cube is either Progue-disturbed or nonProgue-disturbed. It is nonProgue-disturbed. Understand "box" as wooden cube. The description is "[one of]You blow sand and dust off as you kneel to examine it, brushing years of neglect from its detailed surface. [or][stopping]The box is a perfect cube, each side about the length of your forearm, carved from interlocking pieces of wood which fit together seamlessly without nails or mismatched joins. Intricate [o]carvings[x] cover every surface. Salt crusts the lower third, where the wood is swollen and discolored[if cube is open].[paragraph break]The top of the cube has swung open, revealing a delicate [o]sketchbook[x], seemingly undamaged[end if].". After doing something to wooden cube: now wooden cube is nonProgue-disturbed; continue the action. The dream-text of wooden cube is "wooden cubes, each intricately carved with a scene from your life". Check touching wooden cube: try touching intricate carvings instead.

Check taking the wooden cube: say "The wooden cube is too heavy and bulky to carry around[if sketchbook is in cube], but as you lift it experimentally, you hear something shifting inside[end if]." instead. Check knocking the cube: say "You rap experimentally on the side of the cube, and hear a hollow thunk in response." instead. Instead of pushing or pulling the wooden cube, say "You rock the cube back and forth. It seems lighter than it should be[if sketchbook is in cube], and you can hear something shifting around inside[end if]." Check attacking the wooden cube: say "You throw the cube at one of the walls. It makes a hollow clunk as it impacts but the wood does not give way[if sketchbook is in cube], although you can hear something flopping around inside[end if]." instead. Check opening an open wooden cube: say "The top has already been swung open." instead.

The intricate carvings are part of the wooden cube. The description is "The carvings, impossibly tiny, make up one immense, tropical scene. Splashing dolphins segue seamlessly into beaches littered with shells, tall, graceful palm trees, laughing children, and fanciful animals. You could study these carvings for hours without taking in all the detail.[paragraph break]Along the top of the cube, worked into the design, are five oval [o]indentations[x]." Check touching the carvings: say "The relief is only as deep as a fingernail, but seems to lend the carvings a remarkable sense of depth and dimension. You run your finger along the aging wood, feeling the texture of the grain and the artist's tool." instead.

The cube is either primed or unprimed. The cube is unprimed.

Some oval indentations are part of the wooden cube. Understand "ovals/indentation/five/fifth" as oval indentations. The description is "Four are clustered together in an arc, the fifth farther apart.". Touching or pushing oval indentations is clever-cube-opening. Instead of clever-cube-opening: now cube is primed; try opening the cube. Understand "put hand/finger/fingers in/on [something]" or "place hand/finger/fingers in/on [something]" or "touch hand/finger/fingers to [something]" as touching when location is Hut. 

First check opening the cube when the cube is unprimed: say "You can't see any signs of hinge or latch." instead.

First report opening the cube: say "You slip your fingers into the indentations along the top and push with your other hand. The top rotates open easily, revealing a delicate [o]sketchbook[x]." instead. First report closing the cube: say "You rotate the top back into place, and it catches with a gentle 'snick' sound, forming an almost seamless join." instead. 

The sketchbook is an undescribed book in the wooden cube. The description is "You examine the sketchbook carefully, a beautiful handmade thing, thick paper pressed from some creamy-tan wood, the spiral binding a thin coil of copper-colored metal. On the cover is a handwritten [o]inscription[x]." After examining the sketchbook: try reading the sketchbook. Understand "page" or "notebook" or "drawing" or "book" or "sketch" as the sketchbook. The contents of the sketchbook is the Table of the sketchbook. [Check dropping the sketchbook when location is not Hut: say "You shouldn't leave this just lying around anywhere." instead.] [After dropping the sketchbook: now cube is nonProgue-disturbed; if cube is on-stage begin; move sketchbook to cube; say "You place the sketchbook back inside the wooden cube for safekeeping."; end if.] Instead of taking the sketchbook: say "Better not. Whoever locked it up here must have wanted it safe.". The initial appearance of the sketchbook is "[if location is not Hut]the sketchbook lies crumpled on the ground.[otherwise]A beautiful handmade sketchbook is here.[end if]". The dream-text of sketchbook is "blank sketchbooks". After reading the sketchbook: now cube is nonProgue-disturbed; continue the action.

[First Before going or exiting when player holds sketchbook: try dropping sketchbook.] [First check wordgoing when player holds sketchbook: if cube is on-stage begin; move sketchbook to cube; say "You place the sketchbook back inside the wooden cube for safekeeping."; end if.] [This is necessary because wordgoing is an action out of world.]

The handwritten inscription is a story-based scrawl. It is part of the sketchbook. The standard message is "[']And the maker of life must turn from art, and the maker of art must turn from life.[']". The secret message is " dancers, dancers...".

The notes-and-diagrams are part of the sketchbook. Understand "schematics/notes/calculations/diagrams/diagram" as notes-and-diagrams. The description is "Completely incomprehensible.".

Table of the sketchbook
desc
"The first drawing shows a stunning portrait study of two girls, maybe ten or eleven. Long black hair frames unsmiling but beautiful faces, trapped between the carefree whimsy of childhood and some premature pain that strips it away. At first you take them for twins, though subtle differences of appearance suggest otherwise, because of their nearly identical expressions. Though they look out at you and not each other, some bond strong even for sisters connects them, forged perhaps in loss and strengthened by necessity of reliance, each upon the other."
"A landscape fills the next page, showing the beach outside and the half-constructed cabin against the lava flow. The two girls play in the sand, one building a sand castle while a skittering crab watches, the other brushing her hair with a comb carved to look like two leaping dolphins. Behind them a tall figure chops branches from a felled tree trunk. While the beach and the girls are sharp and finely detailed, the figure is fuzzy and dark, indistinct, drawn with heavy, crude lines. Though just a small part of the scene, his presence throws the rest of the sketch into some sadder, unsettling mood."
"This page shows a rough map of the island. The half-circle of the lagoon on the west side, its north end bounded by the rocky lava flow that swoops up to the volcano in the south, are easily recognizable. The chasm running from the break in the volcano's side to the north end of the beach is marked with a danger sign and six tiny colored lines. A plateau filled with dense rain forest fills the island's east side, interrupted by a ravine that divides it from the looming mountain in the northeast.[paragraph break]A furious scribbled star marks a point deep within the eastern rain forest, with a crude drawing of a bee alongside it."
"Angry scribbles nearly obliterate the next sketch, which shows, in incredible detail, one of the [if tree1 is named]windsigh trees[otherwise]strange twisted trees[end if], every twist of encircling vines and gap in its sinuous branches carefully rendered. The dark and crudely drawn figure from the earlier sketch lies curled up asleep in its roots, and from his head spring dozens of images rising in curves and whorls, a panoply of dreams and ideas hovering above him, twisting through the branches of the tree."
"The next pages are filled with inscrutably dense schematics, notes, and calculations, growing smaller and more obtuse by the page until they devolve into meaningless scribbles. One cluster of diagrams centers around blueprints of a three-sided pyramid structure, connected to some elaborate network of underground machinery."
"You flip past several blank pages before reaching one last sketch on the notebook's final page, which seems to have been done much later than the others. It shows a man sitting watching the sun set over the ocean, his back turned and face invisible, holding the comb with the two leaping dolphins. The sketch is sloppy, almost careless, but still exudes a palpable sense of sadness and regret."



Chapter - Studio

Studio is north of Hut. "[studiodesc].". The printed name of Studio is "Cabin, The Studio". The prose name of Studio is "the studio". To say studiodesc:
	say "High, narrow [o]windows[x] ";
	if night, say "let dim trickles of starlight";
	otherwise say "admit [if twilight or dawn]faint ghost-light[otherwise if sunrise or morning or midmorning]refracted light from the beach[otherwise if raining]moist grey air[otherwise if midday or afternoon]steep slants of daylight[otherwise]angling shafts of gold evening light[end if]";
	say " into [if Studio is unvisited]this small porch, the purpose of which seems instinctively clear to you the moment you enter: it is an artist's[otherwise]the[end if] studio";
	if night:
		say ", its accoutrements vanishing into the darkness.[paragraph break][exits]";
	otherwise:
		say ". The floor is [if wall to wall workbench is dirty]stained with paint and clay, and artisan [o]tools[x] litter the surface of a wall-to-wall workbench, though everything seems to be under a layer of thick dust, as if undisturbed for years[otherwise]swept clean, though ghosts of paint stains still linger, and the wall-to-wall workbench has been scrubbed and unburdened of its old clutter, ready for use again[hutpaints][end if].[paragraph break]On the rough plank walls [if dir]to the east and west[otherwise]on your left and right[end if], exactly opposite each other, hang two spectacular ";
		say "[o]paintings[x].[paragraph break][if Epilogue-Ending-A is happening]And between them, in the center of the room, stands a [o]canvas[x], blank, waiting[else][exits]".

To say hutpaints: 
	if the number of paintpots enclosed by wall to wall workbench > 0, say ". On the bench [is-are] [the list of paintpots enclosed by location]".

A paintpot is a kind of thing. A paintpot is usually undescribed. The description of a paintpot is usually "A simple clay pot with a snug lid, filled with paint.".

A pot of red paint is a paintpot. A pot of yellow paint is a paintpot. A pot of white paint is a paintpot. A pot of black paint is a paintpot. A pot of green paint is a paintpot. A pot of blue paint is a paintpot. 

The exits text of Studio is "The only exit is [dr]back[x] [if dir][south] [end if]to the front room of the cabin".

Studio-stuff is stuff in Studio. Understand "trickles/slants/porch/accoutrements/stain/stains/paint/clay/dust/plank/studio" as Studio-stuff when location is Studio.

Report going from Studio to Hut: say "You return to the larger front room of the cabin."

Check wayfaring when location is Studio: try painting instead.

High narrow windows are a setpiece in Studio. Understand "window/interior" as windows. The description of the high narrow windows is "The roof of the shack extends out beyond the unpaned windows, [if raining]effectively keeping out rain but letting[otherwise]presumably to keep out rain but let[end if] in light. Through the windows you see [if night]only darkness[otherwise if raining]curtains of rain[otherwise if dawn or twilight]only a grey light[otherwise]the beach, and the black lava flow angling away into the distance[end if]." Check entering high narrow windows: say "They are too narrow to squeeze yourself through." instead. Instead of opening or closing high narrow windows: say "There is no glass or shutters on the windows, or at least there aren't any more; they are just rectangular holes in the wall of the cabin.".

A wall to wall workbench is a setpiece in Studio. Understand "bench" or "work bench" as wall to wall workbench. The description is "Just a heavy block of wood, the top planed smooth." The wall to wall workbench is either dirty or clean. The wall to wall workbench is dirty. Understand "clean [wall to wall workbench]" or "clean off [wall to wall workbench]" as a mistake ("[if wall to wall workbench is clean]It's already been cleaned off for you[otherwise]It looks like a long and dirty job that can probably wait till later[end if].") when location is Studio.

Some artisan tools are a minor prop in Studio. Understand "tool" or "clay" or "pot" or "pots" or "paint" or "paints" or "hide" or "hides" or "canvas" or "canvases" or "handmade" or "brush" or "brushes" as the artisan tools. The description is "[if we have not examined the tools]Your heart skips a beat as you realize these are mostly the tools of a painter. Clay pots seem to hold paints of varying shades and consistencies (though long since dried, useless now) and hides scraped smooth to make canvases are strewn around the workbench, along with rotting handmade brushes. It will take some time to put everything in order, but it looks like most of the tools you'll need to move on, when the time comes for that, are here[otherwise]You can take a full inventory later. At the moment you simply take comfort in the knowledge that you will not be stranded here[end if]. ". The dream-text of artisan tools is "clay pots, paintbrushes, mortars and pestle". Check taking artisan tools: say "[if wall to wall workbench is dirty]These tools are a suggestion right now more than a possibility. The paints are dried and useless; the brushes rotting and stale, and you see no blank canvas. But their presence indicates that when the time comes, everything necessary must be here on this island... somewhere[otherwise]Progue has prepped this room for your use, but you still lack a complete set of paints, a brush, and, of course, a canvas[end if]." instead.

Check vague painting when location is Studio: if artisan tools are enclosed by location, try taking artisan tools instead; else say "You'll need a canvas, brush, and paints before you can think about doing that." instead.

The thick dust is a prop in Studio. The description is "It looks as if this room has remained undisturbed for many years. There is a strange, expectant feeling in this place, as if, no matter how briefly, something great once touched it and left a mark for all eternity." Instead of taking or touching the dust, say "The grime and dirt leaves smudges on your fingertips."

Section - The Girls' Paintings

An artwork is a kind of prop. Understand "painting" as an artwork. Instead of doing anything to an artwork when location is Studio and ( night or dawn or twilight ) , say "It's too dark in here now to see the paintings in any detail." Check entering an artwork: try wayfaring instead. First check wayfaring when location is Studio: say "You only wayfare through your own paintings, and then only at the moment you finish creating them. These paintings have no power." instead. Check attacking an artwork: say "They're too beautiful for that." instead. The dream-text of an artwork is usually "carelessly piled paintings, so dusty and faded they are almost indistinguishable from each other".

Definition: an artwork is opposing if it is not the noun.

To say painting_intro:
	if we have not examined Lethe-canvas and we have not examined Phoebe-canvas begin;
		say "You step up to the painting and study it carefully. Immediately, you recognize the work of a Wayfarer. The lines and colors are too exact, too perfect, too beautiful to be anything but";
	otherwise if we have examined noun;
		say "You step up and study the incredible artistry again";
	otherwise;
		say "This painting is obviously the work of a Wayfarer as well. At first you think the same artist crafted this one, but subtle differences in style instill in you a growing belief otherwise"; 
	end if.
	
To say painting_close:
	if we have not examined Lethe-canvas and we have not examined Phoebe-canvas begin;
		say "A rough-hewn wood frame surrounds the painting, in harsh contrast with its elegant beauty. Roughly carved in the lower right is ";
	otherwise if we have examined noun;
		say "Carved into the rough-hewn frame is ";
	otherwise;
		say "This painting, too, is roughly inscribed with ";
	end if;
	say "[paintingnamemsg]".

The painting-word is a minor setpiece in Studio with printed name "word on the painting". Understand "single/word/language" as painting-word. The description is "Carved into the rough-hewn frame is [paintingnamemsg].". The provoke message of painting-word is "Carved into the rough-hewn frame is [paintingnamemsg].".

To say paintingnamemsg: 
	if the reading level of the player is language-knowing begin; say "a name: '[if noun is Lethe-canvas]Lethe[learn-lethe-name][otherwise]Phoebe[learn-phoebe-name][end if]'";
	otherwise if the reading level of the player is vowel-knowing; say "a word in an unfamiliar language, though you recognize [if noun is Phoebe-canvas]some of [end if]the symbols from the clockwork head in the treehouse"; if screen reader mode is false and noun is not painting-word, say ": '[if noun is Lethe-canvas]e--el[otherwise]e-eo--[end if]'";
	otherwise; say "a single word in a language you do not recognize";
	end if.

Lethe is an abstraction. Phoebe is an abstraction. To say learn-lethe-name: now Lethe is named. To say learn-phoebe-name: now Phoebe is named.

Check touching an artwork: say "You close your eyes and run your hand delicately across the hardened paint, feeling through the lacquered bumps and textures the power of the artist. You wonder what world this one wanders in now." instead. Understand "painting" or "paintings" or "wall" or "on the" or "frame" as an artwork.

Lethe-canvas is an artwork in Studio. The printed name is "[if Lethe is named]Lethe's[otherwise]the[end if] storybook [o]village[x] painting". Understand "lethe" or "lethes" or "storybook" or "village" as Lethe-canvas. The description is "[painting_intro]. [paragraph break]A gently rolling hilltop of lemon-yellow and milky-white wildflowers, fantastically profuse, explodes from the surface of this painting. A large gathering of smiling people in simple clothes of brown and crimson pick the flowers, laughing and smiling: children, parents, aunts, grandmothers, all so richly detailed that you can almost hear them laughing and calling out to each other. The smell of dusty dry pigment somehow suggests the first day of spring, and fresh mountain breezes in a sea-blue sky. Beyond the hilltop a storybook village basks in late morning haze, thatched roofs and cobbles ringed by balding mountaintops, rounded and emerald green.[paragraph break][painting_close].". l-painting-details is part of lethe-canvas. Understand "hill/hilltop/flowers/wildflowers/family/people/clothes/children/parents/aunts/grandmothers/roofs/cobbles/mountaintops/haze" as l-painting-details when location is Studio. Instead of doing anything to l-painting-details, say "The detail in the painting is extraordinary, so rich and alive it's as if it bleeds into your other senses.".

Phoebe-canvas is an artwork in Studio. The printed name is "[if Phoebe is named]Phoebe's[otherwise]the[end if] [o]space[x] painting". Understand "phoebe" or "phoebes" or "space" as Phoebe-canvas. The description is "[painting_intro]. [paragraph break]A huge translucent sphere hovers in the center of this painting, miles wide, reflecting in bulbous crescent the golden light of a warm gold and lemon yellow sun. Inside the sphere is a profusion of life: huge, gnarled trees growing in all directions without gravity to guide them; thick, mossy vines wrapped everywhere and stretching like tiny green threads of emerald through moist air; and people dressed in flowing silver-crimson gowns and wide sea-blue wings, gliding between gilded wooden villages high in the branches of the massive trunks. In the distance, more spheres can be seen, floating serenely amidst the jet black backdrop shining with a million milky stars.[paragraph break][painting_close].". p-painting-details is part of phoebe-canvas. Understand "sphere/space/light/sun/profusion/life/trees/vines/threads/gowns/wings/branches/trunks/spheres/stars" as p-painting-details when location is Studio. Instead of doing anything to p-painting-details, say "The detail in the painting is extraordinary, so rich and alive it's as if it bleeds into your other senses.".



Chapter - Back Room

The printed name of Back Room is "Cabin, Back Room". The description of Back Room is "[shackdesc].". The prose name of Back Room is "the back room of the cabin". To say shackdesc:
	if night or dawn or twilight or raining, say "Hardly any light filters into this windowless back room. Shapes are jumbled and indistinct[dot]";
	otherwise say "Only a dim light filters into this windowless back room. [if Back Room is unvisited]The back [o]wall[x] seems unnaturally dark, and as your eyes adjust, you realize it is not wood but the smoothed face of the lava flow[otherwise]The smoothed face of the lava flow forms the back [o]wall[x] of the room[end if]. ";
	say "A wide crack in the smoothed wall [if lava tunnel door is closed]is filled in by cobblestones near the ceiling, and a thick wooden [o]door[x] below[otherwise]leads through the open doorway into darkness[end if].[paragraph break]";
	say "Other than the [if lava tunnel door is open]open [end if][if not dir and lava tunnel door is open][d]door[x][otherwise]door[end if] [if dir and lava tunnel door is open][east] [end if]and a pile of smashed wood [if player holds compass]splinters[else][o]splinters[x][end if]"; say " in a corner, the only notable feature is the [dr]exit[x][if dir] [west][end if] back to the front room"

Does the player mean examining the lava wall: it is likely. [So "lava" means wall.] Understand "jumble/chasm" as east when location is Back Room and lava tunnel door is open. Instead of examining by name lava tunnel door when lava tunnel door is open: if location is Back Room, try going east; else try going west.

The exits text of Back Room is "The [d]exit[x] back [if dir][west] [end if]to the front room and the [if lava tunnel door is closed]imposing closed[otherwise]heavy open[end if] [dr]door[x] [if dir][east] [end if]are the only two exits".

Report going from Back Room to Hut: say "You step back into the cabin's larger front room.".

Section - The compass

Some smashed wood splinters is a prop in Back Room. Understand "pile" or "pile of" as some splinters. The description is "The wood looks like it might once have been a cabinet, smashed in some long-past fury[if compass is not worn by player]. [one of]Amidst the wreckage, however, rests an ornate [o]compass[x] in a brass base, apparently intact[or]An ornate [o]compass[x] lies amidst the wreckage[stopping][end if].". 

Compass directions is a number that varies. Compass directions is 0. The compass is a thing.

After opening the compass: now compass directions is 1; say "You undo the tiny clasp and open the brass lid, revealing the needle under glass.[one of][line break][as the parser]Tutorial: While the compass is open, exits will be described using cardinal directions. You may navigate by typing (for example) GO NORTH, NORTH, or just N.[as normal][or][stopping]".  

After closing the compass: now compass directions is 0; say "You shut the compass carefully, letting the small clasp catch again.[one of][line break][as the parser]Tutorial: Exits will now be described using direction keywords and the [d]landmark[x] system, as before.[as normal][or][stopping]".  

To decide whether dir: if compass directions is 1, decide yes; decide no. To decide whether not dir: if dir, decide no; decide yes.         
 
The compass is a wearable closed undescribed openable container in Back Room. The carrying capacity is 0. The compass is either unmolested, revealed, or extruded. The compass is unmolested. The description is "[if compass is open]Beautifully made, the compass has a long thin needle under glass, the round enclosure set into a brass base delicately inscribed with directions in eight points sweeping around from north to northwest. A matching chain allows the compass to be worn around the neck[otherwise]The compass is closed, its thin brass cover concealing the needle[end if][if compass is revealed or compass is extruded].[paragraph break]A secret compartment has been swung open on the back to reveal a seven-pointed star[end if][if compass is extruded] sticking about a thumb's width out from the surface[end if].". Check opening a closed compass when the compass is not worn: say "(first taking the compass)[command clarification break]"; try taking the compass. After taking the compass: now the player is wearing the compass; say "You retrieve the compass from the wreckage and slip the delicate brass chain around your neck. It is closed, a brass cover hiding the needle itself."; now compass references dc_compass. Instead of dropping or taking off the compass, say "You wouldn't want to just leave this delicate instrument lying around." Does the player mean doing something other than examining, opening, closing, or squeezing the compass: it is unlikely. Check pushing the compass when location is Observatory Exterior: try squeezing the compass instead. The initial appearance of compass is "".

Check squeezing the compass when the compass is unmolested and location is not Observatory Exterior: say "Nothing happens." instead. Instead of squeezing the compass when the compass is revealed or the compass is unmolested: say "You push down on either side of the compass with your thumb and fingers.[paragraph break]With a sharp 'snick,' [if compass is unmolested]a secret compartment on the back swings open, and a [else]the[end if] seven-pointed star on the back pops out, extruding a piece of wood of the same shape and about as long as the last joint of your thumb."; now the compass is extruded.

The star piece is part of the compass. It is privately-named. Understand "star/seven/pointed/seven-pointed/extrusion" or "star piece" as star piece when the compass is revealed or the compass is extruded. The description is "[if compass is revealed]The seven-pointed star seems to be etched into the back of the compass[else]The star has popped out of the body of the compass, forming a jagged cylinder[end if].". Check pushing star piece when compass is revealed: say "You push against the star, but nothing happens." instead. Check pushing star piece: now the compass is revealed; say "You push against the extrusion, feeling a spring resist you. Once you've pushed the star back to the surface of the compass, a tiny snick locks the spring in place again." instead. Check taking star piece: try pushing star piece instead.

Rule for printing the name of the compass while taking inventory: say "compass[if compass is revealed] (with a metal star on the back)[else if compass is extruded] (with an extruded metal star on the back)[end if]".

Section - The Color Door

The lava wall is a setpiece in Back Room. Understand "face/flow/crack/surface" as lava wall. The description is "Nearly vertical here, the lava flow's sharp edges drop smoothed and polished from floor to ceiling, a rippling, deep black surface." Check touching the lava wall: say "Smooth and glasslike, although quite hard." instead. Check pushing the lava wall: say "Solid." instead. Check climbing the lava wall: say "The floor, ceiling, and walls run right up against the lava flow, adjoining it at all points and leaving no gap to climb through." instead. Check attacking the lava wall: say "Hard as rock. Which it is." instead. The dream-text of lava wall is "cobblestones made of black lava rock".

Some cobblestones are a setpiece in Back Room. Understand "stones" or "cobble stones" or "cobbles" as some cobblestones. The description is "They have been shaped to neatly fill a crack bisecting the lava flow, from the top of the door to the roof of the shack, fitting together without any seam.". Instead of pushing or pulling or taking or opening cobblestones, say "The cobblestones, set firmly, do not budge at all.". Check attacking cobblestones: try attacking lava wall instead. The dream-text of cobblestones is "cobblestones made of black lava rock".

The lava tunnel door is east of Back Room and west of Jumble. The lava tunnel door is a closed undescribed implemented door. The description is "[if location is Back Room]Only just your height but wider than a normal door, its wooden surface has been planed smooth to bring out a complex grain. [door_details][otherwise]This side of the wide door crawls with a complex mechanism of clockwork [o]gears[x] and cogs, along with a large horizontal [o]lever[x] which can be pulled outwards[end if]." To say door_details: say "[if lava tunnel door is open]It stands open, and is[otherwise]It is[end if] unpainted except for six small [o]bands[x] of vertical color at about eye level. [paragraph break]At about the height you'd expect to see a doorknob runs a smooth arc of [the number of on-stage lava door buttons in words] small [o]buttons[x], each engraved with a stylized symbol". Check vague knocking when lava tunnel door is visible: try knocking lava tunnel door instead. Check knocking the lava tunnel door: say "You rap your knuckles sharply against the door, feeling the firmness of thick wood, but also a faint resonance and echo of space beyond." instead. Check listening to lava tunnel door: say "You put your ear close to the door as you experimentally press a few buttons. You can distinctly hear the snick of dowels and gears moving each time, but can't discern any difference between the buttons. But after some experimentation you're quite sure the machinery on the other side is storing the sequence of buttons pressed, and presumably the correct pattern will open the door" instead. Check listening to a lava door button: try listening to lava tunnel door instead. Check listening to the arc of buttons: try listening to lava tunnel door instead. The can't go through undescribed doors rule is not listed in any rulebook. The dream-text of lava tunnel door is "crates filled with replacement door buttons".

The six small bands of vertical color are part of the lava tunnel door. The description is "Each band seems to have been painted directly on the wood. From left to right, the colors are [o]red[x], [o]yellow[x], [o]black[x], [o]white[x], [o]blue[x], and [o]green[x]." Understand "colors" or "band of color" as small bands of vertical color. Instead of touching or pushing small bands of vertical color: say "You can feel the slightly different texture of each band of color, painted over the wood of the door."; rule succeeds. Check taking small bands of vertical color: say "They're just painted directly on the door." instead.

A color band is a kind of setpiece. Understand "stripe" as a color band. The red band is a color band. The description is "A deep, rich crimson.". The blue band is a color band. The description is "Deep sea-blue." The white band is a color band. The description is "Milky, with a faint pearlescent shimmer." The yellow band is a color band. The description is "The stripe is a rich, vibrant lemon-yellow.". The black band is a color band. The description is "Jet black." The green band is a color band. The description is "A rich emerald green.". Instead of pushing, taking or touching a color band, say "The bands are painted directly on the door.". 

Instead of opening or pulling or taking the lava tunnel door when the door is closed and location is Back Room and Jumble is unvisited, say "You can't see any obvious way to open it: no knob or handle, just the row of [o]buttons[x] and the bands of [o]color[x].". Instead of vague unlocking the door: say "You don't see any sort of keyhole." instead. 

Check pushing the lava tunnel door:
	if the lava tunnel door is open begin;
		try closing the lava tunnel door instead;
	otherwise;
		say "You brace yourself and shove against the door with your shoulder, but it doesn't even creak, let alone budge." instead;
	end if.

Check attacking the lava tunnel door: say "You take a running start and ram the door with your shoulder, but gain nothing save a bruise. The door is solidly constructed and whatever mechanism holds it fast is sturdily built." instead. Check looking under the lava tunnel door: say "The door is almost flush with the floor and surrounding masonry; you cannot see beyond it." instead.

The arc of small buttons is part of the lava tunnel door. The description is "Each is a circle about the size of one made with a thumb and finger, flush with the door but very slightly convex. Stylized symbols are inlaid into each one. From left to right, the symbols are [if story mode][blist8][blist9][otherwise][blist1][blist2][blist3][end if].". To say blist1: say "[o]whale[x], [if rayfish is named][one of]manta -- no, [o]rayfish[x][or][o]rayfish[x][stopping][otherwise][o]manta[x][end if]". To say blist2: say ", [o]tree[x], [o]turtle[x], [o]crab[x], [o]crystal[x], [o]berry[x], ". To say blist3: say "[o]seagull[x], [o]bee[x], [o]spider[x], [o]mussel[x], [o]snail[x]". To say blist8: say "[o]manta[x], [o]tree[x], [o]crystal[x], ". To say blist9: say "[o]berry[x], [o]mussel[x], [o]snail[x]". Check attacking arc of small buttons: try attacking manta ray button instead.

Check pushing arc of small buttons: say "You'll have to say which one you want to press. There are [number of on-stage lava door buttons in words] buttons: [list of on-stage lava door buttons]." instead. Check attacking arc of small buttons: try attacking berry button instead.

A lava door button is a kind of setpiece. Understand "symbol/symbols" as a lava door button.  Check taking a button: say "The buttons are flush with the door, the seams so tight you could not even get a fingernail in." instead. Check attacking a lava door button: say "You smash the base of your hand against it, but it simply pops back out again." instead. Check touching a lava door button: say "[if noun is manta ray button or noun is windsigh tree button or noun is crystal button or noun is berry button or noun is mussel button or noun is snail button]The slightly concave surface is rubbed smooth[otherwise]The slightly convex surface feels like roughened wood[end if]." instead. [A subtle hint.] Understand "hold [a lava door button]" as a mistake ("Pressing and holding the button seems to produce the same result as merely pressing it.").

Check pushing a lava door button when night: say "It's too dark to make out which button is which." instead. Check pushing a lava door button when lava tunnel door is open: say "With the door open, the buttons don't seem to depress." instead. Check pushing a lava door button when location is Jumble: say "The buttons are on the other side of the closed door." instead.

jumble_scenery is a setpiece in Back Room. The printed name is "fissure". Understand "fissure" as jumble_scenery when location is Back Room and lava tunnel door is open. The description of jumble_scenery is "Through the open doorway you can see a narrow [dr]chasm[x][if dir] to the [east][end if] cutting through the lava rock and heading to the right.".

chasm_scenery is a setpiece in Back Room. Understand "chasm" as chasm_scenery. Check examining chasm_scenery: try going east instead. The printed name is "chasm". 

The whale button is a lava door button. The description is "A fat-bodied whale, one baleful eye peering out.". The manta ray button is a lava door button. Understand "rayfish" as the manta ray button. The description is "[if we have examined rayfish and rayfish is unnamed]A beautiful carving of the glowing manta ray creature in the lagoon[otherwise if we have examined rayfish and rayfish is named]A beautiful carving of Progue's rayfish from the lagoon[otherwise if we have not examined rayfish and rayfish is named]A beautiful manta ray creature you would guess is the one [the Progue] calls a rayfish[otherwise]Some sort of diamond-shaped manta ray creature[end if].". The windsigh tree button is a lava door button. Understand "tree9" as the windsigh tree button. The printed name of windsigh tree button is "[if tree1 is named]windsigh[otherwise]tree[end if] button". The description is "[if tree1 is named]Unmistakably a windsigh tree[otherwise]It's another one of those strange trees like the one you painted[end if].". The turtle button is a lava door button. The description is "A sea turtle, graceful in mid-paddle.". The crab button is a lava door button. The description of the crab button is "A scuttling crab, pincers raised.". The crystal button is a lava door button. The description is "A hexagonal pillar of crystalline mineral.". The berry button is a lava door button. Understand "berries" as berry button. The description is "A bush laden with heavy round berries.". The seagull button is a lava door button. The description is "A seagull in flight.". Understand "gull" as seagull button. The bee button is a lava door button. Understand "bumblebee" as bee button. The description is "A bumblebee, delicate wings spread open." The spider button is a lava door button. The description is "Hairy legs and a fat, smooth body.". The mussel button is a lava door button. The description is "A single oval mussel, its shell lined with tiny ridges." The snail button is a lava door button. The description is "A snail with a large, spiraled shell.".

The lava tunnel door has a list of objects called the rtl combination. The rtl combination of the lava tunnel door is {mussel button, crystal button, snail button, manta ray button, windsigh tree button, berry button}. The lava tunnel door has a list of objects called the ltr combination. The ltr combination of the lava tunnel door is {berry button, windsigh tree button, manta ray button, snail button, crystal button, mussel button}. The lava tunnel door has a list of objects called the setting.

Check object-debugging a lava door button: try object-debugging lava tunnel door instead. Check object-debugging the arc of small buttons: try object-debugging lava tunnel door instead. Check object-debugging a color band: try object-debugging lava tunnel door instead. Check object-debugging the small bands of vertical color: try object-debugging lava tunnel door instead.

Understand "push [things]" as pushing. [This allows players to push multiple buttons at a time, which saves typing.]

First Report pushing a lava door button:
	say "With a gentle snick, the button depresses into the door, then pops back out as you release it.";
	truncate the setting of the lava tunnel door to the last 5 entries;
	add the noun to the setting of the lava tunnel door;
	if lava tunnel door is being debugged, say "// Door: setting is now [the setting of the lava tunnel door].";
	if the setting of the lava tunnel door is ltr combination of the lava door and story mode, reverse the setting of the lava tunnel door; [Can go right-to-left or left-to-right for story people.]
	if the setting of the lava tunnel door is the rtl combination of the lava tunnel door:
		now the lava tunnel door is open; 
		say "[line break]A heavy clunk and wooden grinding sound from behind the door as it swings open, revealing a [o]fissure[x] running into the black lava rock[one of].[section break][or].[stopping]";
		try looking;
	otherwise: [Provide some feedback so people know they're on the right track.]
		if the setting of the lava tunnel door is ltr combination of the lava tunnel door:
			say "[line break]Nothing happens. Odd. You felt sure that was it.";
		otherwise if the setting of the lava tunnel door is close to rtl combination of the lava tunnel door or the setting of the lava tunnel door is close to ltr combination of the lava tunnel door:
			say "[line break]You slam your palm against the door in frustration. You're sure you've almost got it, but still nothing happens.";
		otherwise if the setting of the lava tunnel door is getting close to rtl combination of the lava tunnel door:
			say "[one of][line break]Nothing. You have a feeling you're getting closer, though.[or][stopping]";
	stop the action.

[Detect entering a combination that's only one symbol off, to print a consolation message to the player, but don't trigger this if we're still in the process of entering it.]

To decide whether (subject - a list of objects) is close to (target - a list of objects):
	let tally be 0;
	repeat with ctr running from 1 to number of entries in target begin;
		if the number of entries in subject is at least ctr and entry ctr of subject is entry ctr of target, increase tally by 1;
	end repeat;
	if tally is at least ( the number of entries in target - 1 ) and the number of entries in subject is the number of entries in target, decide yes;
	decide no.

[Detect a combination in progress that is getting close to correct (this is used to make sure Progue is not in the room if the player is about to enter a correct combination).]

To decide whether (subject - a list of objects) is getting close to (target - a list of objects):
	let tally be 0;
	repeat with ctr running from 1 to number of entries in subject begin;
		if entry ctr in subject is listed in target, increase tally by 1;
	end repeat;
	if tally is at least ( the number of entries in target - 2 ) , decide yes;
	decide no.

First Report opening lava tunnel door when location is Back Room: say "You enter the combination into the door. As you press the final button, it swings open with a heavy clunk and wooden grinding, revealing the narrow [dr]chasm[x] behind it." instead.

When play begins: now all lava door buttons are part of the lava tunnel door. When play begins: now all color bands are part of the lava tunnel door.

Report going from Back Room to Jumble: say "You step through the doorway into a confusion of boulders.".

Section - Back Room Cheats (not for release)

The secret button is an undescribed thing in Back Room. Check pushing secret button: try pushing mussel button; try pushing crystal button; try pushing snail button; try pushing manta ray button; try pushing windsigh tree button; try pushing berry button instead.



Part - North Island

North Island is a region.



The ambience table of North Island is Table of North Island ambience.

Table of North Island ambience
freq		start time	end time	text	table		trigger	flag
common	dawn		twilight	--	Table of Seagull Air ambience	distant gulls
rare		--	--		--	Table of Lacuna Insect ambience
rare		--	--		--	Table of Lacuna Weather ambience
rare			--	--		--	Table of Chairlift ambience
rare			--	--		--	Table of Mountain ambience
common	dawn	twilight	--		Table of Snail ambience

Table of Snail ambience
freq		text	table		trigger	flag
common	"A [o]snail[x] with a pearly-white shell inches along [if location is Stumps]a tree stump[otherwise]the ground[end if]."	--	white snail
uncommon	"Two [o]snails[x] with pearl-white shells cross the ground near your feet, leaving milky trails behind."	--	white snail
uncommon	"A [o]seagull[x] swoops down and snatches a [o]snail[x] off [if location is Stumps]a nearby stump[otherwise]the ground[end if], crushing its pearl-white shell in its beak.[summongull]"	--	white snail
uncommon	"A half-crushed snail [o]shell[x], pearly-white, catches a momentary gleam of light in the moss underfoot."		--	white snail
uncommon	"A [o]gull[x] flies in to perch on [if location is Stumps]a nearby stump[otherwise if location is Chairlift Base]the roof of the shack[otherwise]a rocky rise[end if], and begins pecking at a few small milky-white [o]snails[x] half-heartedly.[summongull]"	--	white snail

A white snail is set dressing. Understand "pearly-white" or "pearly" or "white" or "pearl" or "pearl-white" or "shell" or "snails" as a white snail. The description is "[snail description].". Check attacking a white snail: say "You crush the shell beneath your foot, leaving an intense white chalky substance behind." instead. Instead of taking or touching a white snail, say "You pick it up for a moment and study it more closely. [snail description]. Curiosity satisfied, you return it to the ground." To say snail description: say "The shell is a rich, luminous white, faintly iridescent, that seems to almost glow in the [light-source][snailhint]". To say snailhint: if ( time for excitement or story mode ) and Back Room is visited and Jumble is unvisited, say ".[paragraph break]You notice that the snail shell is exactly the shade of the white band painted on the back room door of the cabin on the beach".

To say summongull: move seagull to the location.

Table of Chairlift ambience
freq		text	table		trigger	flag
common	"The cables of the ropeway sway gently in the [if morning]morning [end if][if afternoon]afternoon [end if]breeze[if raining or rained], heavy with rain[end if]."
common	"A gust of wind tugs at the ropeway cable."
common	"The cables of the distant ropeway sigh as a gust of wind pulls them suddenly taut, then releases them again."



Chapter - Rise

The prose name of Rise is "the top of the rise". The printed name of Rise is "On the Old Lava Flow". Rise is a room in North Island. Understand "rise" as northwest when location is North Beach. The description of Rise is "[risedesc].". To say risedesc:
	if longform begin; say "Here is where the lava met the sea, after cutting a long swath across the island. From your position atop the flow you can see both sides of the island: [if former location is North Beach]before you, [Rise-northdesc], and behind [Rise-southdesc][otherwise if former location is Stumps]before you, [Rise-southdesc], and behind [Rise-northdesc][otherwise]to one side, [Rise-northdesc][otherwise][Rise-southdesc]";
	say ". [if Rise is unvisited]You are surprised to see a[otherwise if Chairlift Base is visited]The[otherwise]A[end if] [o]ropeway[x] stretch[if Chairlift Base is visited]ing[otherwise]es[end if] from a meadow high atop the mountain to a small base station near the island's [if dir]northwestern [end if]corner[dot]";
	otherwise if midday; say "The black lava rock bakes under the soles of your feet, the swaying [if konokuk trees are named]konokuk [end if]trees offering little shade[dot]";
	otherwise if evening; say "Black shadows play over black lava in a visual cacophony as the slanting light throws the flow into sharp relief[dot]";
	otherwise if raining or ( afternoon and rained ) ; say "Rain pools in tiny puddles and depressions atop the lava flow[if raining], dribbling off the green fronds above you and pattering loudly on the lava rock[otherwise], slowly evaporating in the warm afternoon light[end if][dot]";
	otherwise if night; say "Your toes stub on hidden protrusions and uneven ripples in the lava, merging seamless and invisible with the black night[if pyramid has power]. In fact, almost the only light comes from a deep red glow beaming from atop the distant mountain, revealing[otherwise if the pressure of the related pipe of the pyramid pressure gauge > 0 ]. A faint red light pulses from atop the distant mountain, illuminating[end if]"; if the pressure of the related pipe of the pyramid pressure gauge > 0, say " [if pyramid-seen is true]the [o]pyramid[x][else]a man-made [o]structure[x][end if]"; say "[dot]";
	otherwise if morning or sunrise; say "The rising light just reaches the lava flow here, pulling the cold shadowed black rock into reluctant hints of relief[dot]";
	otherwise if midmorning; say "The grove of [if konokuk trees are named]konokuk[otherwise]tropical[end if] trees casts swaying shadows over the lava flow, still cool from the night[dot]";
	otherwise; say "[one of][room ambience][or][time ambience][at random]"; 
	end if;
	if fallen trees are in Rise begin; unless Rebelworld-Sequence is solved and Treeworld-Sequence is solved, say "Fallen konokuk trees, felled by the quake or the storm, lay across the top of the rise, partially blocking the way to the hot spring[dot]"; end if;
	say "[exits]".

To say Rise-northdesc:
	say "the land drops off into a marshy swamp that stretches to the edge of [if North Marsh is visited]the[otherwise]a jagged[end if] [o]mountain[x]".

To say Rise-southdesc:
	say "curves the tranquil white crescent of the lagoon, protected by the lava flow as it rises to the shattered side of the distant [o]volcano[x]".

Rise-stuff is stuff in Rise. Understand "swath/side/corner/swamp" as Rise-stuff when location is Rise.

Some fallen trees are a minor setpiece. The description is "They are split near their bases, the white wood splintered and jagged.". The provoke message is "They're too heavy to move, but you can easily clamber over them.".

Check sleeping in Rise: say "The lava rock is too hard and sharp; you'd never be able to get to sleep.[sleepsuggest]" instead.

		
The exits text of Rise is "From here, you could scramble [bw of North Beach][if dir][southeast][otherwise]down[end if] to the [dr]beach[x] or take an easier route [bw of Stumps][if dir][north][otherwise]down the other side of the flow[end if] towards the [dr]edge[x] of the marsh. [exrise_hotspringsbit]". To say exrise_hotspringsbit: if Hot Springs is unvisited, say "You can also hear the sound of a [dr]waterfall[x]"; otherwise say "The hidden [dr]pool[x] lies"; say " [bw of Hot Springs]through some heavy fronds [if dir][east][otherwise]opposite the sea[end if]". Understand "edge" as north when location is Rise. Understand "waterfall" or "pool" as east when location is Rise.

The ambience table of Rise is the Table of Rise ambience.

Table of Rise ambience
freq		start time	end time	text	table		trigger	flag
common	rising uptide		falling uptide	"The surf [one of]beats heavily against the sharp edges of the flow beneath you[or]smashes into the lava flow, sending wisps of spray up above the edge of the flow[or]crashes into the jutting edge of the lava flow, sending clouds of spray up over the edge to moisten your clothes[as decreasingly likely outcomes]."
rare	sunrise	sunset		"A gull lands by a tiny stream trickling out of the overgrowth and drinks deeply, then begins to clean itself." 	--	seagull
rare	sunrise	sunset		"A seagull swoops past your head, flying into the dense vegetation to the side; a miniature vortex of wind pulls and tugs at the heavy fronds."		--	seagull

Report going from Rise to Stumps: say "You follow the path down a slight mossy slope[if raining or rained] slick with rainwater[end if]"; if raining, say " into a misty cloud"; otherwise say "[if a random chance of 1 in 2 succeeds][time-of-day-bit][otherwise], enjoying the unobstructed panorama before you[end if]"; say "." Report going from Rise to Hot Springs: say "You push great leafy fronds out of the way[if raining or rained], shivering as water drips all over you,[otherwise if night], pushing forward into thick blackness,[end if] and after a few moments break into a secluded grove." Report going from Rise to North Beach: say "You pick your way [if night or raining or rained]carefully [end if]down the cluster of [if raining or rained]slippery [end if]boulders, [if night or twilight or dawn]taking care not to twist an ankle in the gloom[otherwise]using handholds to steady yourself[end if], till your feet touch the smooth [if raining or rained]wet [otherwise if midday or afternoon or evening]hot [end if]sand again."



Chapter - Hot Springs

The prose name of Hot Springs is "the hot springs by the waterfall". The printed name of Hot Springs is "Hidden Pool". The description of Hot Springs is "[hotspringdesc].". To say hotspringdesc:
	if longform begin; say "Tucked away in a natural bowl stained with sea-blue hues, hidden from view, this beautiful [o]pool[x] is fed by a clear [o]waterfall[x] cascading down from an overhang above. Steam rises from the almost perfectly circular pool, which looks deep enough for diving but not so deep that the blue-tinted floor is not visible, and leafy green fronds sway gently on all sides, creating a secluded and relaxing ambiance[dot]";
	otherwise if raining; say "The pool is like a private sauna in the rain, as drops patter down to joining the [o]waterfall[x] pattering into the bowl[dot]";
	otherwise if night; say "[if moonup]A single beam of moonlight pierces the secluded grove, lighting up the steam wisping off the surface of the [o]pool[x], which ripples with dancing silver reflections disturbed by the [o]waterfall[x][otherwise]Only the faintest hint of starlight penetrates the grove, faintly reflected off the [o]pool[x] in jagged ripples stirred by the pounding of the [o]waterfall[x][end if][dot]";
	otherwise if dawn or twilight or sunrise; say "The magical stillness of the half-light is broken, but not completely dissipated, by the loud clamor of the [o]waterfall[x] curtaining down into the clear  [o]pool[x] below[dot]";
	otherwise if morning or midmorning or afternoon or evening; say "[if midmorning or afternoon]Only a few angled slants of[otherwise]Hardly any[end if] sunlight penetrates the secluded glade, making the cool [o]waterfall[x] and the clear steamy water of the hot [o]springs[x] a welcome respite from the day's heat[dot]";
	otherwise if midday; say "Sunlight beams down into the glade, turning the [o]waterfall[x] into thousands of tiny sparkling gemstones, and the surface of the round [o]pool[x] beneath to a mirror for the cloudless sky[dot]";
	end if;
	say "A rich vein of crumbling sea-blue [o]crystal[x] runs through the wall behind the waterfall[if midday], sparkling in the sunlight[otherwise if night and moonup], glowing in the moonlight[otherwise], staining the rock face and water of the pool a brilliant indigo[end if].[paragraph break][exits]".

The exits text of Hot Springs is "[et0hs]". To say et0hs: if night, say "The [dr]gap[x] leading back [if dir][west] [end if]to the open is hardly visible, but you think you remember the way"; else say "A [dr]gap[x] in the trees marks the way [if dir][west] [end if]back to the open". Understand "gap" as west when location is Hot Springs.

HotSprings-stuff is stuff in Hot Springs. Understand "beam/steam/sauna/overhang" as HotSprings-stuff when location is Hot Springs.

The waterfall is a setpiece in Hot Springs. The description is "Stretching about twice your height above the surface of the pool, the waterfall cascades over a natural overhang in the rock[if midday or afternoon], sparkling brightly in the sun overhead[end if]. [if night and moonup]The moonlight brings the complex interplay of water and air to life, an animate sculpture in glass. [end if][if evening or sunset]Beams of failing sunlight penetrating the thick vegetation to the [west] light up the water intermittently, tiny rippling lines of red illuminating its silky surface. [end if]Behind and alongside the waterfall, lumpy nodes of sea-blue [o]crystal[x] poke out of the rocky earth.". Check touching the waterfall: say "The water is surprisingly cool, running over your hand in thick wet ribbons smelling faintly of moss and earth." instead. Instead of tasting or taking the waterfall, say "The water thunders down with enough force that you cannot hold any in your hands.". Understand "look behind waterfall" or "go behind waterfall" as a mistake ("The waterfall is fairly small and almost flush with the cliff behind it."). The dream-text of waterfall is "hundreds of chunks of sea-blue crystal".

The sea-blue crystal is a backdrop. It is in Hot Springs, Viewpoint, and Ravine Floor. Understand "rock/wall/blue" as sea-blue crystal. The description is "Some rich vein of a brilliant sea-blue crystal slices diagonally through the rock here, brought up to the surface from unfathomed depths by some past volcanic action. The crystal seems inclined to break along hexagonal lines, producing the effect of crumbled six-sided pillars[if location is Hot Springs]. The pounding action of the waterfall has softened the edges, and in turn stained the whole wall and tinted the pool below a brilliant indigo[end if][if we have not examined the sea-blue crystal and Rume-tracker >= -10].[paragraph break]It's the precise shade of Rume's eyes[end if][crystalhint].". Understand "mineral" as sea-blue crystal. Instead of touching or taking the sea-blue crystal: move green-stain to location; say "You rub your fingers up against the crystal, turned an almost muddy texture, and study with a twinge of sadness the deep blue hues that stain your fingertips." Check attacking sea-blue crystal: say "You smash a fist against the crystal, and a chunk breaks off easily and tumbles [if location is Hot Springs]into the pool[otherwise if location is Viewpoint]into the ravine[otherwise]into the surf, where it is washed away[end if]." instead. The dream-text of sea-blue crystal is "hundreds of chunks of sea-blue crystal". Check tasting sea-blue crystal: say "You touch your tongue to the crystal tentatively, but discern only a flavorless texture of grit." instead.

A green-stain is a set dressing. Understand "stain/finger/deep/green/hues/hue/fingertips/fingertip" as green-stain. The printed name is "green stain". The description is "The color is a deep, rich emerald green.". Check tasting green-stain: say "Chalky, with a complex tang of mineral aftertaste." instead. Check touching green-stain: say "It rubs off fairly easily." instead. Check taking green-stain: say "It's just a slight smudge on your finger." instead.

To say crystalhint: if ( time for excitement or story mode ) and Back Room is visited and Jumble is unvisited, say ". You notice that the crystal is the same hue as the blue band on the back room door of the cabin on the beach".

Understand "dive" or "bathe" as vague swimming.

The large pool is an undescribed enterable open unopenable container in Hot Springs. Understand "spring/springs" as pool. The description is "Tinted with hues of green, the surface of this round pool constantly shifts and dances as the waterfall plunges from a mossy overhang. The pool looks deep enough for diving under the churning falls, but shallows near the far end to a jumble of good sitting rocks a few feet below the surface. The water is hot and steaming, simultaneously warmed by some scalding source below and cooled by the waterfall." Check touching the large pool: say "The water is hot, but not uncomfortably so." instead. Check tasting the large pool: say "[one of]You cautiously sip a bit of water gathered in your hand. It seems all right[or]Bending to your knees, you scoop a few handfuls of the pool water to your mouth and drink deeply. It is exceedingly refreshing, the taste holding a faint hint of some mineral effervescence. After drinking your fill, you rise to your feet again[stopping]." instead. Check taking the large pool: say "You cup two hands together and scoop up some of the hot water, feeling it immediately cool as it trickles through your fingers down your arms and elbows. You let it trickle away and enjoy the cool sensation as your hands dry." instead. Understand "water" or "natural" or "bowl" or "hidden" or "blue" or "cerulean" or "perfectly" or "circular" or "round" or "depression" or "far" or "end" as the large pool. The dream-text of large pool is "hundreds of chunks of sea-blue crystal".

Check vague swimming when location is Hot Springs: try entering the large pool instead. Check swimming in pool: try entering the large pool instead. [Check going when player is in the large pool: try exiting instead. ][BUG]

First report entering the large pool: pass 15 minutes of time; say "With a little thrill of excitement, you dive into the pool. The water is hot, almost too much so for swimming, but feels invigorating and cleansing nonetheless. When you near the cool of the waterfall, you can feel the temperature difference between it and the pool distinctly, invisible eddies of heat transference swirling about your legs.

After a while you retreat to the rocks near the shallow end and relax for a while in the [if evening or sunset or twilight]fading light[else if morning or midmorning]morning air[else if night]cool night air[else if dawn]growing light[else if weather state is decided to rain or rained or raining]cloudy afternoon light[else]tropical sunlight[end if]." instead. 

First report exiting when the player was in the large pool: say "You climb out into the now chilly-seeming air[if sunup], drying off quickly in the warm breeze[otherwise], shivering[end if]." instead.

The ambience table of Hot Springs is the Table of Hot Springs ambience

Table of Hot Springs ambience
freq		start time	end time	text	table		trigger	flag
rare		dawn		twilight	--	Table of Seagull Air ambience	distant gulls
rare		--	--		--	Table of Lacuna Insect ambience
rare		--	--		--	Table of Lacuna Weather ambience
rare		dawn	twilight	--		Table of Snail ambience
uncommon	--	--	"Wind stirs the greenery fringing the pool, causing it to shimmer and dance as it reflects in the emerald water."
uncommon	dawn	twilight	"A gull circles overhead momentarily, eyeing you warily before moving on."	--	seagull
uncommon	night	dawn	"Silver-white [light-source] glimmers on the hexagonal facets of [o]crystal[x] under the waterfall."

Report going from Hot Springs to Rise: say "You push your way back through the greenery to the open area beyond.".

Chapter - Stumps

The prose name of Stumps is "the cluster of tree stumps". The printed name of Stumps is "Among the Stumps". Understand "stumps" as southeast when location is Chairlift Base. Understand "stumps" as southwest when location is West-Marsh. The description of Stumps is "[stumpsdesc].". To say stumpsdesc: 
	if longform begin; say "The remains of what once must have been a small copse of trees on this bit of grassy land overlook the edge of [if Stumps is unvisited]a flat marsh[otherwise]the marsh[end if]. Across the marsh rises [if Stumps is unvisited]a[otherwise]the[end if] sheer cliff, rising to the summit of [if Stumps is unvisited]an imposing[otherwise]the[end if] mountain[dot]";
	otherwise if raining; say "Rain patters off the stumps, seeping into the crumbling wood and staining it a rich, deep red-brown[dot]";
	otherwise if afternoon or evening or sunset; say "Insects drift lazily through the sunbeams over the stumps, washed with the summery rays of the [if evening]evening[else]afternoon[end if] sun[dot]";
	otherwise if dawn or sunrise or morning; say "Dew clings wetly to the twisted, crumbling roots at your feet, and mist dances over the marsh[dot]";
	otherwise if night; say "[if moonup]The stumps are pale circles of rotting bark under the dull moonlight[otherwise]Unseen roots stretch out to trip you every few steps in the darkness[end if][dot]";
	otherwise if midday; say "Humid air blows over the stumps from the marshlands, beginning to broil as the sun beats down[dot]";
	otherwise; say "[one of][room ambience][or][time ambience][at random]";
	end if;
	say "Jutting from the rock near the short drop-off to the sea is a roughly-hewn [o]block[x] of grey stone[dot]";
	if the pressure of the blue pipe > 0 and puzzle mode and Tsunami Sequence is not happening and Epilogue is not happening, say "[if pressure of the blue pipe < 3]Wisps of [o]steam[x] rise[otherwise if pressure of the blue pipe < 5][o]Steam[x] shoots[otherwise if pressure of the blue pipe < 8]Jets of [o]steam[x] shoot[otherwise]With a whistle, a high-pressure curtain of [o]steam[x] torrents[end if] up from a blue pipe off to the side of the path[dot]";
	say "[exits]".

Understand "steam" as blue pipe when location is Stumps.

Understand "swampy" or "swamp" or "marshland" or "terrain" or "marsh" as northeast when location is Stumps.
	
The exits text of Stumps is "Far across the marsh [bw of West-Marsh][if dir]to the [northeast][otherwise][down] a soggy slope[end if] is the sheer cliff face of the mountain. You could also follow the drier stretch [bw of Rise][if dir][south] [end if][etstump2]". To say etstump2: say "[if not dir][up][otherwise]up[end if] the rise or [bw of Chairlift Base][if dir][northwest][otherwise]over[end if] to the tiny [dr]shack[x] at the base of the ropeway". Understand "shack" as northwest when location is Stumps. 

Stumps-stuff is stuff in Stumps. Understand "remains/stretch/dropoff" as Stumps-stuff when location is Stumps. 

Some old tree stumps are a setpiece in Stumps. Understand "stump/root/roots/bark" as tree stumps. The description is "About forty or fifty of the tall, swaying [if konokuk trees are named]konokuk[otherwise]fruit-bearing[end if] trees seem to have been felled some years ago, though moss and vines have since grown over what remains.[paragraph break]Almost hidden by accumulated dirt and vegetation, a blue bamboo [o]pipe[x] runs past a particularly [o]large[x] stump on its way to the ropeway.". The dream-text of old tree stumps is "tree stumps". Does the player mean entering old tree stumps: it is likely.

The old-windsigh-stump is a perchable setpiece in Stumps. The printed name is "particularly large stump". Understand "stump/large/particularly" as old-windsigh-stump. The description is "This stump is larger than the others and set apart a little, and as you examine it more closely, it seems clearly the remnant of another type of tree. Thousands of tiny cavities dot the surface, ranging in size from fist-shaped to the lower limits of your vision to make out.". Check touching old-windsigh-stump: say "You run your hands over the uneven surface of the stump, letting your fingers bounce in and out of the tiny cavities, but feel nothing unusual." instead. The dream-text of old-windsigh-stump is "tree stumps".

The tiny cavities are part of old-windsigh-stump. The description is "The hemispherical holes must have been spheres of empty space inside the tree, of all sizes."

Check entering old tree stumps: say "You perch on the top of a[if raining or rained] wet[end if] stump for a minute, but the rough-hewn wood makes for an uncomfortable seat, and after a moment, you stand again." instead.

A heavy block of uncut stone is a setpiece in Stumps. The description is "The stone seems to be part of a spire that once rose here, of some natural material that erodes more slowly than the surrounding rock. The part jutting up out of the earth has been roughly hacked into a block large enough to stand inside, were it hollow." Instead of taking or pushing heavy block, say "It's not going anywhere.". Check climbing heavy block: say "It's only just your height. You awkwardly hoist yourself up to the semi-flattened top of it and take a look around, but don't gain any new insights, so you lower yourself back to the ground." instead. Check touching heavy block: say "Salt encrusts the seaward side of the stone, from years or decades of high tide spray lashing against it, but the opposite side is smoother and grey, edges rough where human tools shaped it." instead. The dream-text of heavy block is "huge square pillars of roughly chiseled rock". Understand "carve [heavy block]" or "sculpt [heavy block]" or "sculpt" or "carve" or "chisel [heavy block]" as a mistake ("You don't have the tools for that, and wouldn't really know what to do with them if you did.") when location is Stumps.

Noticing-Snail-Shell is a scene. Noticing-Snail-Shell begins when time for excitement and we are going and location is Stumps and Jumble is unvisited. Noticing-Snail-Shell ends when Noticing-Snail-Shell begins.

When Noticing-Snail-Shell begins:
	move white snail to location;
	say "Something crunches underneath your foot. You lift it aside and see you have crushed an old abandoned [o]snail[x], its whorled edges a milky, pearlescent white.".

Report going from Stumps to Chairlift Base: say "Keeping the marsh on your right and a bluff overlooking the sea to your left, you approach a low mound at the corner of the island, topped by the shack.". Report going from Stumps to Rise: say "Climbing back up onto the old lava flow, you once again reach the viewpoint from its top.". Report going northeast from Stumps: say "You walk down a slight slope into boggier terrain, entering a long flat marsh that eventually merges with the ocean off [if dir]to the north[otherwise]in the distance[end if]."



Chapter - Chairlift Base

Chairlift Base is a room in North Island. The printed name of Chairlift Base is "Ropeway Base Station". The prose name of Chairlift Base is "the base of the ropeway". The description of Chairlift Base is "[chairliftbasedesc].".

To say chairliftbasedesc:
	if longform begin; say "On this hump of dry land between the sea on two sides and the marsh on another, a small shack, open on the side towards the [o]mountain[x], shelters the base of [if Chairlift Base is unvisited]some sort of [o]ropeway[x] system[otherwise]the [o]ropeway[x][end if]. A complex mechanism of ropes and pulleys connects"; say " to twin cables which stretch [if dir]east and [end if]up towards the summit of the mountain[dot]";
	otherwise if raining; say "The cables tug and sigh and the [o]ropeway[x] creaks in the storm; you are grateful to slip under the roof of the tiny shack for shelter[dot]";
	otherwise if night; say "The sounds of the sea crash against boulders below you on two sides, past the dropoff that the indistinct ropeway structure perches on[dot]";
	otherwise if dawn or twilight; say "The shack at the corner of the island is still and quiet in the sunless light; not even the cables trailing up towards the mountain sway[dot]";
	otherwise if evening or sunset; say "The ocean off the edge of the dropoff behind the shack glimmers in the evening sunlight as it stretches to the horizon[dot]";
	otherwise if night; say "The details of the mechanism are indistinct within the gloom of the overhang";
	otherwise; say "[one of][room ambience][or]The weather-beaten overhang provides a modicum of shade that covers the workings of the ropeway[dot][or]Wind gusts sadly through the boards of the ropeway shack, causing the cables overhead to dance and the cogwheels to tug restlessly against their brakes[dot][in random order]"; end if;
	say "[if pressure of related pipe of the ropeway pressure gauge > 0][ropewaysteam] from an outlet vent attached to the [o]mechanism[x] below[otherwise]The ropeway [o]mechanism[x] is motionless, no steam flowing from the outlet vent poking through the structure's roof[end if]"; say "[if bucket is enclosed by location][one of]. A large open-topped wooden [o]crate[x], long and narrow, hangs from the cables above, swaying slightly in the breeze[or]. The [o]crate[x] hangs from the cables, swaying gently in the breeze[stopping][end if]";
	say ".[paragraph break][exits]".

The exits text of Chairlift Base is "[if we are requesting the exits text]The moss and rocks around you sloping gently down to small cliffs hugging the ocean seem largely uninteresting, and the marsh near here looks particularly deep and muddy. [end if]The only promising route leads back towards the [dr]stumps[x][if dir] to the [southeast][end if]". 

ChairliftBase-stuff is stuff in Chairlift Base. Understand "hump/sides/cliff/cliffs" as ChairliftBase-stuff when location is Chairlift Base.

Report going from Chairlift Base to Stumps: say "You walk back along the edge of the marsh toward the stumps[time-of-day-bit].". 

Section - The Ropeway

To say ropewayl: say "Ropeway: p:[pressure of related pipe of ropeway pressure gauge]/[target pressure of ropeway pressure gauge]; bkt:[location of bucket][if bucket is ascending] (asc)[otherwise if bucket is descending] (desc)[end if]". 

To say ropewaysteam:
	let Q be the pressure of related pipe of the ropeway pressure gauge;
	if Q < 3 begin; say "Wisps of steam drift";
	otherwise if Q < 6; say "A steady cloud of steam pours";
	otherwise if Q < 12; say "Torrents of steam rise";
	otherwise; say "A geyser of steam erupts";
	end if.

The ropeway-shack is a setpiece in Chairlift Base. The printed name is "shack". Understand "shack" as ropeway-shack. The description is "The small building is open on the side facing the mountain, and crudely shields the ropeway mechanism from the elements.". The dream-text of ropeway-shack is "spare flywheels for the ropeway".

The ropeway mechanism is a setpiece in Chairlift Base. Understand "complex" or "pulley" or "pulleys" or "exquisitely" or "carved" or "wood" or "piston" or "cogwheel" or "cogwheels" or "system" or "counterweight" or "counterweights" or "rope" or "relay" as the ropeway mechanism. The description is "The mechanism is complex yet elegant. [if puzzle mode][gauge-description] marks the spot where a[else]A[end if] faded blue bamboo [o]pipe[x], stretching half-buried in a line towards the [if dir]southeast[otherwise]stumps[end if], joins the main mechanism, which is topped by an outflow [o]tube[x]. An exquisitely carved wood piston drives a system of pulleys, flywheels, and counterweights that connect to two thick [o]cables[x] rising up to the mountain's summit. A large wood [o]lever[x] is the only visible control.". Check attacking ropeway mechanism: say "Better to keep it in working order." instead. The dream-text of ropeway mechanism is "spare flywheels".

The flywheels are part of the bucket. Understand "flywheel" or "wheel" or "wheels" or "brake" or "brakes" as the flywheels. The description is "The wheels, expertly carved from some strong wood, connect the crate's support to the ropes. Each is equipped with a tiny brake, currently [if bucket is in Chairlift Base]engaged[otherwise]disengaged[end if].". Understand the command "disengage" as "unlock". Understand the command "engage" as "lock". Instead of vague unlocking or vague locking the flywheels, say "You don't see any manual way to engage or disengage the brakes on the wheels.". Check attacking flywheels: say "Better to keep it in working order." instead.

The ropeway outlet vent is an outflow tube. The ropeway outlet vent is part of the ropeway mechanism. The related pipe of the ropeway outlet vent is the blue pipe.

The ropeway pressure gauge is a pressure gauge. It is part of the ropeway mechanism. The target pressure is 4. The related pipe is the blue pipe. Does the player mean examining the ropeway mechanism: it is likely. ["ropeway" should default to machinery.]

A ropeway lever is a setpiece in Chairlift Base. Understand "ropeway" or "lever" as ropeway lever. The description of lever is "The lever [if bucket is ascending]is pushed forward[otherwise if bucket is descending]is pulled back[otherwise]stands straight up[end if]. It looks like it can be either pushed forward (towards the mountain) or pulled back." Instead of pushing or pulling the lever when bucket is not stationary, say "You give it a tug, but the lever seems for the moment to be locked into position." Check attacking the ropeway lever: say "You give it a savage kick, to no avail." instead. Instead of switching on or switching off ropeway lever, try examining ropeway lever. The dream-text of ropeway lever is "spare flywheels for the ropeway".

Understand "push forward" or "push [something] forward" as pushing. Understand "pull back/backward/backwards" or "pull [something] back/backward/backwards" as pulling. Rule for supplying a missing noun when pushing and location is Chairlift Base: change noun to ropeway lever. Rule for supplying a missing noun when pulling and location is Chairlift Base: change noun to ropeway lever.

To decide whether the chairlift has power: if puzzle mode and the pressure of the related pipe of the ropeway pressure gauge <= 6, decide no; if pressure of the related pipe of the ropeway pressure gauge < 4, decide no; decide yes. To decide whether the chairlift hasn't power: if the chairlift has power, decide no; decide yes.

Check pushing the ropeway lever: try turning the ropeway lever instead.

Check turning the ropeway lever: 
	if ropeway mechanism is being debugged, say "// Ropeway: blue pipe has pressure of [pressure of the related pipe of the ropeway pressure gauge] / 6 needed.";
	if the chairlift hasn't power begin;
		if ropeway mechanism is being debugged, say "// Ropeway: hasn't power.";
		respond to unpowered ropeway;
		stop the action;
	end if;
	say "You [if player is in bucket]reach out, [end if]push the lever into the forward position and feel something catch. ";
	if bucket is in Lawn begin; say "But immediately a relay snaps shut above you, and nothing further happens other than a momentary surge of steam from the outflow vent.";
	otherwise;
		say "[if pressure of related pipe of ropeway gauge is 6]Steam stops flowing from the outflow vent[otherwise]The volume of steam from the outflow vent drops dramatically[end if] and the ropes, cogwheels, and counterweights around you start to move. [paragraph break]With a groan, the thick main flywheel begins to rotate. The rope moves, and the crate, wheels tightly locked, swings and follows it, picking up speed as it [if player is in bucket]and you move[otherwise]moves[end if] forward out of the station.";
		now bucket is ascending;
		if Lawn is unvisited and player is in bucket begin;
			now ever-used-ropeway is true;
		end if;
		if player is in bucket, reset the boredom meter with "riding ropeway";
	end if;
	stop the action.

ever-used-ropeway is a truth state that varies.
	
Instead of pulling the ropeway lever:
	if the chairlift hasn't power begin;
		respond to unpowered ropeway;
		stop the action;
	end if;
	say "You [if player is in bucket]reach out, [end if]pull the lever into the back position and feel something catch. ";
	if bucket is in Chairlift Base begin; say "But immediately, a relay snaps shut above you, and nothing further happens other than a momentary surge of steam from the outflow vent.";	
	otherwise;
		say "[if pressure of related pipe of ropeway gauge is 6]Steam stops flowing from the outflow pipe[otherwise]The volume of steam from the outflow pipe drops dramatically[end if] and the ropes, cogwheels, and counterweights around you start to move. But moments later a clunk sounds in the machinery above, and everything smoothly comes to a halt again. [paragraph break]From high up on the mountain, you see the crate come over the edge and begin quickly descending, rolling freely down the ropes above it.";
		now bucket is descending;
		rule succeeds;
	end if.

To respond to unpowered ropeway:
	if ropeway mechanism is being debugged, say "// Ropeway: respond to unpowered ropeway.";
	if the pressure of the related pipe of the ropeway pressure gauge is 0 begin; say "You [if player is in bucket]reach out and [end if][if we are turning something]push against[otherwise]pull back on[end if] the lever, but nothing seems to happen, and when you release it, it snaps back up to vertical.";
	otherwise if puzzle mode and the pressure of the related pipe of the ropeway pressure gauge is less than 4; say "You [if player is in bucket]reach out, [end if][if we are turning something]push the lever forward[otherwise]pull the lever back[end if] and feel something catch. Immediately steam stops rising from the outflow vent, and you a hear a hiss and groan as cogwheels start to turn; but almost immediately they grind to a halt again, seemingly lacking the oomph to get going. [paragraph break]Steam begins to rise again from the outflow vent."; 
	otherwise; say "You [if player is in bucket]reach out, [end if][if we are turning something]push the lever forward[otherwise]pull the lever back[end if] and feel something catch. Immediately steam stops rising from the outflow pipe, and you a hear a hiss and groan as cogwheels start to turn. The ropes begin to move above you, but just as everything seems about to kick into gear, the mechanism slowly loses speed and finally grinds to a halt. [paragraph break]Steam begins to rise again from the outflow vent.";
	end if.


Instead of pushing or pulling or turning the bucket:
	if player is in bucket begin; say "You can't push it while you're inside it.";
	otherwise if location is Chairlift Base; say "You give the crate a solid push. It swings heavily back and forth in place, but does not otherwise move. Looking up, you see the wheels connecting it to the ropes seem to be locked.";
	otherwise; say "You give the crate a gentle push. It begins to roll gently forward, the unlocked wheels turning against the taut ropes above."; now the bucket inertia counter is 1;
	end if.

To advance the bucket:
	if bucket is ascending begin;
		if location of bucket is Chairlift Base, move bucket to Chair-lift1;
		otherwise move bucket to the room up from the location of bucket;
	otherwise;
		if location of bucket is Lawn, move bucket to Chair-lift3;
		otherwise move bucket to the room down from the location of bucket;
	end if.
	
Every turn when the bucket is ascending or the bucket is descending (this is the report on ropeway excitement rule):
	if ropeway mechanism is being debugged, say "// Ropeway: report on ropeway excitement rule (bucket in [location of bucket]).";
	if the player is in the bucket begin;
		if bucket is in Lawn begin;
			say "The crate swoops over the edge of the cliff and plummets down the rope.";
			if player is in bucket, reset the boredom meter with "riding ropeway";
		otherwise if bucket is ascending;
			say "You continue [one of]your ascent[or]rising[or]ascending[at random][if a random chance of 1 in 2 succeeds][time-of-day-bit][end if].";
		end if;
	otherwise if the player is in Chairlift Base; 
		if bucket is ascending, say "The ropes above you continue to move through the flywheel, which rotates noisily.";
		otherwise say "[if bucket is in Chair-lift1]The suspended crate sails gracefully into the station[otherwise]The stationary ropes above you vibrate as the crate rolls down them towards you[end if].";
	otherwise if the player is in Lawn;
		say "[if bucket is in Lawn]The crate swoops over the edge of the cliff and plummets down the rope[otherwise if bucket is in Chair-lift2]Far below, you see the crate slow drastically, then stop as it pulls into the base station, swinging crazily back and forth[otherwise]The ropes above you vibrate tautly as the suspended crate flies down the track below you[end if].";
	end if;
	advance the bucket;
	if ropeway mechanism is being debugged, say "// Ropeway: bucket advanced to [location of bucket].";
	if location is Chair-lift1 or location is Chair-lift2 or location is Chair-lift3, try looking;
	if the bucket is in Lawn or the bucket is in Chairlift Base begin;
		if player is enclosed by bucket begin; say "[if bucket is in Lawn]As the crate crests the lip of a sharp mountain ledge, you pass another support pole and flatten out almost completely as you pass just above a wide green lawn.[paragraph break]With a shudder, the ropes above stop moving, but some catch snaps open and the brakes on the car's wheels unlock. You roll forward under the crate's momentum up a gradual slope, slowing until finally coming to a gentle halt against a round wooden bumper[otherwise]The crate continues braking as you fly above the surface of the marsh towards the base station. Just as you think you're about to smash into it, the brakes clunk into place above, arresting your forward motion. The crate sways dramatically forward, then backwards; your stomach will take a bit more time to settle[end if].";
		otherwise if the player is in Chairlift Base; say "[line break][if bucket is in Lawn]Atop the distant mountain, you see the suspended crate crest the edge of the cliff[otherwise if bucket is in Chairlift Base and bucket is descending]The crate sails over the marsh, swooping towards you as half-engaged brakes squeal alarmingly. Just as it arrives at the station, the brakes snap shut, and the crate swings dramatically forward, backward, and finally comes to a stop[end if]. Moments later the lever near you snaps back to upright and a cloud of steam spurts from the outflow vent[if bucket is ascending]. The ropes slow to a halt[end if]."; 
		end if;
		now the bucket is stationary;
		if player is in bucket, try looking;
	end if.

First check going up when location is Chairlift Base: say "You'll have to operate the ropeway mechanism somehow, if you hope to do that." instead. First check going up when location is Lawn: say "You scramble up the pile of loose rocks and boulders to the summit, and stand for a moment in the wind on the island's highest point, enjoying your victory and the [o]view[x]. But the constant wind becomes wearisome before long, so you climb back down to the relative shelter of the lawn." instead.

The bucket is a open unopenable enterable undescribed container in Chairlift Base. It is fixed in place. The printed name is "crate". Understand "large" or "open-topped" or "wooden" or "wood" or "box" or "long" or "narrow" or "crate" or "coffin" or "seat" or "chair" as bucket. The description is "Roughly coffin-shaped, the open crate is scratched and nicked all over the inside, where ghosts of sawdust and grime still linger. A cross-brace near the support pole connecting the crate to the ropes above provides a crude wooden seat." The bucket can be ascending, descending or stationary. The bucket is stationary. Does the player mean entering the bucket: it is likely. Check taking bucket: say "It's attached to the cables overhead." instead. Check opening the bucket: say "There's no top; it's open to the air." instead. Instead of sleeponing bucket, say "It doesn't look very comfortable.[sleepsuggest]". Check climbing bucket: try entering bucket instead. The dream-text of bucket is "spare flywheels for the ropeway".

First report entering bucket: if bucket is in Lawn, increase the bucket inertia counter by 1; say "[one of]The seat is covered with years of accumulated grime, and spiderwebs and birds['] nests thrive near the join where the suspended crate hangs from the rope. You spend a few minutes clearing the detritus away, wondering how long it's been since this equipment was operated.[paragraph break][or][stopping]You grip the central support of the crate and climb unsteadily onto the seat as it rocks slowly beneath you[if location is Chairlift Base]. Once seated, you see that you can easily reach out and manipulate the [o]lever[x][end if]." instead. First report exiting when player was in bucket: say "You rock the crate as you push your legs over the edge onto solid ground again." instead.

The bucket inertia counter is a number that varies.

The check for bucket stranding rule is listed before the report on ropeway excitement rule in the every turn rulebook. Every turn when bucket inertia counter > 0 (this is the check for bucket stranding rule) :
	if ropeway mechanism is being debugged, say "// Ropeway: bucket inertia counter at [bucket inertia counter].";
	if the bucket inertia counter is 1 and player is in bucket, say "The addition of your weight causes the crate to pull loose from its berth. It begins to inch slowly forward as the wheels above start to turn.";
	if the bucket inertia counter is 2 begin; say "The crate picks up speed, the wheels above turning faster and faster as it approaches the edge of the cliff."; end if;
	if the bucket inertia counter is 3 begin;
		if player is not in the bucket and ( the player is wounded or the mountain-spring is pristine ) begin; arrest the bucket;
		otherwise; now the bucket is descending;
		end if;
		now the bucket inertia counter is -1;
	end if;
	increase the bucket inertia counter by 1. 

Before going when location is Lawn and bucket inertia counter > 0 and ( the player is wounded or the mountain-spring is pristine ) : arrest the bucket.

To arrest the bucket: say "Quickly, you grab the crate and arrest its forward motion. If it were to go over the edge without you in it, you'd be stuck up here. You pull it back to its starting position."; now the bucket is stationary; now bucket inertia counter is 0; move bucket to Lawn.

Instead of pulling or taking the bucket when bucket inertia counter > 0 and player is not in the bucket: now the bucket inertia counter is 0; now the bucket is stationary; move bucket to Lawn; say "Grabbing the crate with both hands, you manage to stop its momentum and pull it back up to the end of the line, where it once again rests motionless.". Understand the command "stop" as "take".

Chapter - Ropeway Ride

Check sleeping in Chairlift-Ride: say "But you'll have to dismount in just a minute." instead.

Chair-lift1 is a room with printed name "Gently Rising". "The taut ropes above you jerk forward with a steady power, lifting you slowly above the sinking ground beneath your feet, which drops off into a quagmire as you pass above the edge of the [o]marsh[x].".  

The cl1-marsh is a backdrop. Understand "marsh/swamp/marshlands" as cl1-marsh. The printed name is "view of the marsh". It is in Chair-lift1 and Chair-lift2. The description is "From your elevated vantage point, you can see how the marsh is really just a salty lowlands running across the north end of the island. Waves break gradually and slowly across the boggy expanse till they become undetectable ripples lapping against the sudden upthrust of the black lava flow to your right.".

Chair-lift2 is a room with printed name "Above the Marsh". "[chair-lift2desc].". To say chair-lift2desc: if bucket is ascending, say "The ropeway carries you higher, above the mud and reeds. To your left, the [o]sea[x] breaks unevenly across the fuzzy boundary of the [o]marsh[x], while opposite [windsigh phrase of tree3] rises from a rocky spur of the [o]mountain[x], which looms up ever larger before you.[paragraph break]The car bumps and squeals as it passes a [o]pillar[x] affixed to the top of a spire rising from the marsh, descends for a moment, and then begins rising steeply towards the summit"; otherwise say "The crate's wheels squeal like mad as you continue your breakneck descent, pulling up as the angle of the cable flattens.[paragraph break]You pass the lone support pillar in the center of the marsh with a stomach-churning hump. Something trips a catch in the wheels above, which loudly begin squealing as something abrades them. You grip the support with white knuckles as the car slow downs and throws your weight forward". Chair-lift2 is up from Chair-lift1.

The cl2-sea is a backdrop. It is in Chair-lift1, Chair-lift2 and Chair-lift3. Understand "sea/ocean/waves/water" as cl2-sea. The printed name is "ocean". The description is "The blue whitecapped waves seem to stretch forever off to the northern horizon.". 

The cl2-pillar is a setpiece in Chair-lift2. Understand "pillar" as cl2-pillar. The printed name is "ropeway pillar". The description is "The pillar seems to be a single sturdy log, affixed somehow to the top of a natural rock spire rising from the marsh.".

Chair-lift3 is a room with printed name "[if bucket is descending]Rapid Descent[otherwise]Approaching the Mountain[end if]". "[if bucket is ascending]You rise at a steep angle towards the summit of the [o]mountain[x]. Before you is a sheer [o]cliff[x], marred by one deep crack and numerous ledges and pockmarks[ledgehint]. The angle of the rope above grows steeper and steeper[otherwise]You are flying down the rope, the wheels above spinning madly. The marsh rises to met you at a terrifying rate[end if].". To say ledgehint: if Ledge is unvisited, say ". One [o]ledge[x] in particular stands out, strewn with rubbish and signs of habitation". Chair-lift3 is up from Chair-lift2. Chairlift Base is down from Chair-lift2. Up from Chairlift Base is nowhere. Lawn is up from Chair-lift3.  

The cl3-cliff is a setpiece in Chair-lift3. Understand "cliff/crack/pockmarks" as cl3-cliff. The printed name is "cliff". The description is "The cliff is sheer and steep on this side, and you see from this dizzying height where the lowlands of the marsh fill a negative space that the other half of this mountain must have occupied before some tumultuous geologic event.".

The cl3-ledge is a setpiece in Chair-lift3. Understand "ledge/ledges" as cl3-ledge. The printed name is "ledge". The description is "The great crack running up the side of the cliff bisects the ledge, and as you peer closer you can see someone obviously has spent some time there[if location of Progue is ledge]. In fact, you can see [the Progue] moving around on the ledge when you look closer[end if][if Ledge is unvisited]. It looks like you might be able to climb up the crack from the marsh near the cliff if you were careful about it[end if].".

Instead of jumping or leaping or exiting when location is regionally in Chairlift-Ride, say "Not on your life." First before going when location is regionally in Chairlift-Ride: say "Not on your life." instead. Check going nowhere when location is regionally in Chairlift-Ride: say "You'll have to wait until the car gets where it's going first." instead. Instead landmark-going when location is regionally in Chairlift-Ride (this is the can't landmark go from chairlift rule): say "You'll have to wait until the car gets where it's going first." instead. The can't landmark go from chairlift rule is listed first in the instead rules.

Part - The Marshlands

Check sleeping in Marshlands: say "It's too boggy to sleep anywhere around here.[sleepsuggest]" instead.

To say a sentence about the marshlands: 
	if raining begin; say "There is nothing but mud as the rain thrashes the already soaking marshlands";
	otherwise if rained; say "Hot mist hangs like a physical presence over the soaking marshlands, as if the tiniest disturbance would cause the evaporating moisture to start falling again";
	otherwise;
	if night, say "[one of]Quiet sounds of trickling water and shifting mud seem ominous in the oppressive darkness[or]Vague shapes surround you on all sides, but only the sucking of the mud beneath your feet seems real in the thick black of night[in random order]";
	if dawn, say "A still mist blankets the marsh, lending the muddy patches, tufts of grass, and deeper pools a grey indistinctness, a reluctance to let in the growing light";
	if twilight, say "Even now that the sun has set, curtains of heat still radiate from the mud and grass around you";
	if sunrise or morning, say "[one of]White curtains of mist swirl delicately over the marsh, the cold shadow of the great mountain protecting them from the hidden sun[or]Here in the shadow of the mountain, the marsh is still cool and quiet, tendrils of mist drifting over mud and patches of deeper water[in random order]";
	if midmorning, say "[if location is Marsh]Morning arrives late to the marsh, the mountain's shadow only now reluctantly retreating as the sun crests the ridge, touching muddy patches of grasses and pools of standing water with insistent yellow-gold light[otherwise]Still caught in the mountain's shadow, the marsh here retains hints of the night's chill[end if]";
	if afternoon or midday, say "[one of]The marsh bakes in the [if midday]midday[otherwise]afternoon[end if] sunlight, which lifts steam from momentarily dry patches and turns the standing puddles around you uncomfortably warm[or]Humidity rises in curls of moisture from the swampy ground, adding to the topical heat[in random order]";
	if evening or sunset, say "[one of]Striking shades of [if evening]orange and brown[otherwise]red and purple[end if] paint the marsh as the [if evening]falling[otherwise]setting[end if] sun slants through clumps of grasses and murky pools[or]Insects drift lazily through the vivid evening light, sluggish in the warmth of both sun and steaming marsh[in random order]";
	end if.

Report going from Marshlands to Marshlands: say "[one of]You pick your way carefully through the marsh[or]Hopping from one clump of dry grass to another, you navigate the swampy maze[or]Slowly, you work through the boggy terrain[or]You find a path through the wet salty bog[at random] [one of]towards[or]to[at random] [if location is West-Marsh]the edge of the marsh[otherwise if location is East Marsh]the vicinity of the rocky spire[otherwise]the cliff face[end if][if a random chance of 1 in 2 succeeds][time-of-day-bit][end if].".


The ambience table of Marshlands is Table of Marshlands ambience.

Table of Marshlands ambience
freq		start time	end time	text	table		trigger	flag
common		midmorning	twilight	--	Table of Frog ambience
common		--	--		--	Table of Lacuna Insect ambience
uncommon		--	--		--	Table of Lacuna Weather ambience
uncommon		--	--		--	Table of Chairlift ambience
rare			sunrise	sunset	--	Table of Mountain ambience
common	twilight	night	--	Table of Firefly ambience

Table of Frog ambience
freq		text	table		trigger	flag
common	"Steady croaking sounds on all sides, somehow merging with the wet, bubbling sounds of the marsh into a steady buzz."

A frog is an animal. The description is "The squat round creature, about the size of a child's hand, quivers nervously.".


Chapter - West Marsh

West-Marsh is a room. "[A sentence about the marshlands]. [A sentence about the mountain]. [paragraph break][exits].". The printed name of West-Marsh is "Edge of the Marsh". The prose name of West-Marsh is "the edge of the marshlands". 

The exits text of West-Marsh is "You could return from here to higher ground, the drier area near the tree [dr]stumps[x][if dir] to the [southwest][end if], or slog through more marsh [etwmar2]". To say etwmar2: say "[if dir]to the [east] and [northeast][otherwise]towards a craggy [d]spire[x] or, farther off, the [d]foot[x] of the mountain[end if]". Understand "spire" as east when location is West-Marsh. Understand "foot" as northeast when location is West-Marsh. 

 Report going southwest from West-Marsh: say "You gratefully climb out of the mud and muck of the marsh, emerging amongst the drier ground near the stumps."


Chapter - East Marsh
	
East Marsh is a room. "A lone [o]spire[x] of rock reaches from the muck into the sky, about three times your height. Affixed to its top is a wooden pole, the sole support of the ropeway [o]cable[x] on its long climb up the mountain. [paragraph break][exits]." The printed name of East Marsh is "Marsh, Near the Spire". The prose name of East Marsh is "the marshlands by the spire". Understand "marshlands" as east when location is West-Marsh. Understand "marshlands" as south when location is North Marsh. Understand "stumps" as west when location is East Marsh.

The exits text of East Marsh is "[if dir]To the [north][otherwise]Farther afield[end if], the [dr]foot[x] of the mountain rises abruptly from the muck, while [if dir]to the [west][otherwise]in the opposite direction[end if] the marsh continues towards the [dr]stumps[x]". Understand "foot" as north when location is East Marsh.

The spire is a setpiece in East Marsh. Understand "lone" or "rock" as spire. The description is "A great splinter of rock that must have fallen from the shattered mountain long ago rises at a slightly crooked angle from the marsh like a giant's bony finger.[if sunup][paragraph break]Several faint [o]drawings[x] in chalk, faded to near invisibility, adorn the base of the spire.[end if]". Instead of climbing or entering spire, say "You test some handholds. The knobby rock makes for an easy climb. Quickly, you pull yourself up the short distance to its top.[paragraph break]Supporting yourself on the ropeway pole, you stand up on the precarious top of the spire. From here, you can see how the pole was firmly embedded into a natural crack in the rock, secured with dozens of stone pegs. Squinting, you follow the path of the two cables as they steepen up towards the distant summit of the mountain.[paragraph break]Curiosity satisfied, you return back to the swampy ground.". Instead of climbing or entering spire when player is wounded, say "You're not climbing anything with this leg." The dream-text of spire is "obelisks covered in childish scrawls". 

The faded chalk drawings are part of the spire. Understand "drawing" as faded chalk drawings. The description is "You kneel to study the drawings more closely. The simple subjects suggest the work of a small child, but still show some skill: a rendering of a bulbous frog captures the creature's awkward grace, and another of two dragonflies twirling around each other in flight shows remarkable details in the delicate wings. One large sketch shows two girls holding hands, backs turned, skipping along a beach.[paragraph break]Below the drawings is drawn some [o]writing[x] in a simple, awkward hand.". Check touching faded chalk drawings: say "Wind and rain has almost completely washed the faint drawings away; just the touch of your finger erases the line underneath it." instead. Check taking faded chalk drawings: say "They are drawn directly on the rock." instead.

The chalk writing is a story-based scrawl in East Marsh with standard message "I want to go home. I miss mommy. What's wrong with daddy?".

Chapter - North Marsh

North Marsh is a room. The description of North Marsh is "[A sentence about the marshlands]. But the marsh ends abruptly here at a sheer [o]cliff[x] face, the edge of the imposing mountain. [paragraph break][exits]." The printed name of North Marsh is "Marsh, Near the Cliff". The prose name of North Marsh is "the marshlands". 

The exits text of North Marsh is "The marsh stretches away from the mountain [if dir]to the [south] and [southwest][otherwise]towards the lonely [dr]spire[x] and the distant [dr]stumps[x][end if]". Understand "stumps" as southwest when location is North Marsh. Understand "spire" as south when location is North Marsh.

The weather-worn crack is a backdrop. The crack is in North Marsh, Ledge, Cliffside, and Lawn. 

Check examining the weather-worn crack:
	if location is North Marsh begin; say "About the width of your outstretched hand, the crack runs nearly vertically up the side of the cliff";
	otherwise if location is Ledge; say "[exits text of Ledge]";
	otherwise if location is Cliffside; 
		if the mountain-spring is pristine, say "You can see handholds, but the water coursing down both sides of the crack soaks you and prevents you from getting a solid grip";
		otherwise say "Gripping the crack tightly, every handhold and foothold stands out in sharp relief with clarity enhanced by adrenalin";
	otherwise; say "[if mountain-spring is pristine and pressure of the related pipe of the pyramid pressure gauge >= 5]The tiny spring vanishes into[otherwise]The damp streambed leads to[end if] a narrow crack that drops straight down the face of the mountain towards the marsh far below";
	end if;
	say "." instead.

Understand "reach in/into/inside" as touching.
	
Check entering the crack: say "The crack is too narrow to enter." instead. Check climbing the crack when location is North Marsh: try going up instead. Check climbing the crack when location is Lawn: try going down instead. Check climbing the crack: say "You'll have to specify: [up] or [down]." instead.

First Check going up when location is North Marsh and we have not touched the crack: try touching the crack instead.

First Check going up in North Marsh when player is wounded: say "You're not climbing anything with this leg." instead. 

Instead of touching the weather-worn crack: say "You feel the edge of the crack experimentally for handholds. It wouldn't be easy, but you might be able to climb the crack up, at least a little ways."; rule succeeds. [Currently broken due to a bug in "Default Messages."][still true?]

Understand the command "crack" as something new. 

Report going from North Marsh to Ledge for the second time: say "Flexing your hands, you step anxiously up to the crack, set your first handholds, and begin to climb. The ascent is not easy, but you make quick progress, and before you know it you have followed the crack all the way up to a small ledge, some distance above the marsh below.". Report going from North Marsh to Ledge for the third time: say "The ascent is a little easier this time, old handholds remembered and a few easier ones found. Before long you have hauled yourself up to the ledge once again." Report going from North Marsh to Ledge for at least the fourth time: say "You find your way up the long crack to the ledge with practiced ease.";



Part - High Altitude

Check jumping when location is Lawn or location is Observatory Exterior: say "Better not. It's a long way down." instead.

Check sleeping when location is regionally in High Altitude: say "[if location is Cliffside]Cute.[otherwise]You feel too exposed up here.[sleepsuggest][end if]" instead. 

Chapter - Ledge

The prose name of Ledge is "the mountain ledge". The description of Ledge is "[ledgedesc].". To say ledgedesc: say "No more than a few paces across, this tiny ledge in the cliff face offers a vantage of the marshlands stretching back to the coast, the chairlift cables arcing high above them, and the lagoon, just visible over the edge of the distant lava flow.[paragraph break]"; say "Strewn about the ledge are a variety of [o]nicknacks[x] that, along with a simple [o]bed[x] of palm fronds, make it immediately obvious somebody has made this ledge a sort of home.[paragraph break][exits]". The exits text of Ledge is "The [o]crack[x] goes right through the ledge, bisecting it into two neat halves, before continuing both up and down the slope[if the mountain-spring is pristine and pressure of the related pipe of the pyramid pressure gauge >= 5]. [o]Water[x] [ldgpyrtest] down both sides from somewhere high above, before vanishing into smaller cracks at your feet[end if]". To say ldgpyrtest: say "[if pressure of the related pipe of the pyramid pressure gauge > 17]ripples[otherwise if pressure of the related pipe of the pyramid pressure gauge > 10]trickles[otherwise if pressure of the related pipe of the pyramid pressure gauge >= 5]seeps[end if]".

Progue's nicknacks are a prop in Ledge. The description is "Mostly junk: small piles of sea shells, scattered fish bones and broken crab legs, bits of rope of various sizes woven from coconut husks, and the like[if Progue's pendant is in location]. Buried among the remains, however, you do notice a small [o]pendant[x] on a leather chain[end if].". Understand "knicknacks/knicknacks" as nicknacks.

Progue's pendant is a wearable undescribed thing in Ledge. The description is "Just a small stone on a leather chain that can be worn around the neck. It seems well-worn, as if it has been rubbed nearly to smoothness over years.". After taking Progue's pendant: now player is wearing Progue's pendant; say "You slip the small pendant around your neck.". Instead of dropping or taking off Progue's pendant when location is not Ledge: say "You probably shouldn't leave it lying around just anywhere.". Instead of dropping or taking off Progue's pendant: move Progue's pendant to Ledge; say "You slip off the pendant and return it to the pile of nicknacks.". [Stealing this can trigger a scene with Progue.] Check touching Progue's pendant: say "The stone is warm and smooth." instead.

A bed of palm fronds is a setpiece in Ledge. The description is "The fronds could do with replacing: they are rotting and the smell is most unpleasant. It certainly doesn't look like a very comfortable place to sleep.". Instead of entering or sleeponing bed of palm fronds: say "This is someone else's bed." Check sleeping in Ledge: say "It looks like somebody else has already claimed this spot.[sleepsuggest]" instead. The dream-text of palm fronds is "thousands of dried palm fronds".

[ The chairlift [o]cables[x] rise through the air far away; the point where they reach the mountain's summit is still high above your head. ]

Report going down from Ledge for the first time: say "Nervously, you lower your feet back over the edge, gripping your handholds tightly. It seems to be a long descent, the marsh spinning dizzily far beneath your feet each time you glance down for footholds, but slowly it gets closer and closer. When you finally hop the last few feet down, the muck of the marsh is good to feel beneath your feet.". Report going down from Ledge for the second time: say "With confidence boosted, you manage to pick your way down in about half the time as your first attempt. It's still not an easy climb, but you manage without too much trouble.". Report going down from ledge for at least the third time: say "Handholds and footholds come easily to you, and in no time at all you are back on solid ground again.".

First Instead of going up from Ledge for the first time: say "The [o]crack[x] steepens here[if the mountain-spring is pristine and pressure of the related pipe of the pyramid pressure gauge >= 5] and [o]water[x] [ldgpyrtest] down from somewhere above[end if]. It looks like climbing farther will be more difficult[if mountain-spring is diverted or pressure of the related pipe of the pyramid pressure gauge < 5], but still possible[end if].". 

Report going up from Ledge: say "[if the mountain-spring is pristine and pressure of the related pipe of the pyramid pressure gauge >= 5]You find your initial handholds. [repupled] the slippery stone carefully, you begin to climb.[otherwise]You find your handholds in the angular nooks of the crack and begin to climb.[end if]". To say repupled: say "[if pyramid has power]Hot water courses down your arms and wets your whole body. Gripping[otherwise]Water begins to trickle down your arms and wet your whole body. Shivering, and gripping[end if]".

Chapter - Cliffside

Cliffside is a room. "Breathing heavily, you pause for a moment at a relatively stable foothold, hands clenched tightly [if mountain-spring is pristine and pressure of the related pipe of the pyramid pressure gauge >= 5]on water-slick rock [end if]and muscles quavering. [exits].". The prose name of Cliffside is "the side of the mountain cliff".   The exits text of Cliffside is "The ground is a long way [d]down[x] and the crack continues [d]up[x]". 

Check sleeping in Cliffside: say "Good one.[sleepsuggest]" instead.

cliff-climb-try is a number that varies. cliff-climb-try is 0.

First Instead of going up when location is Cliffside and mountain-spring is pristine and pressure of the related pipe of the pyramid pressure gauge >= 5:
	if current episode is Word Day:
		say "It's probably a better idea to explore a little more before you go climbing dangerous things." instead;
	if the psyche of Progue is emotional or the psyche of Progue is fugue or the psyche of Progue is resolved or Tsunami Sequence is happening:
		say "Perhaps you once could have tried, but by now your body has grown so used to this crack being unclimbable that you can't work up the nerve to do it." instead;
	if an episode is playing:
		say "You try to pick your way farther up, but the hot water coursing down the crack scalds your arms. A fingerhold slips and you hug the side of the mountain in cold panic. You can't work up the nerve for now to try to get any higher." instead;
	increment cliff-climb-try by 1;
	if cliff-climb-try is 1, say "You try to pick your way farther up, but the water coursing down becomes more intense, the stone underneath slicker. You are all too conscious of the distance to the ground, far, far below your feet. Finally, when one hand slips on a slimy hold, you are forced to descend to your previous stopping point, nervous and shaky.";
	if cliff-climb-try is 2:
		say "Carefully, you start up the water-soaked crack again, once again trusting to moss handholds and slicker and slicker footholds. This time, you seem to find them easier. You are just starting to gain some confidence and get a good rhythm going when suddenly, your foot slips off a mossy niche, your wet hands claw at slickness and you fall...";
		begin Tending-to-Wounded-Player.

After going to Ledge: now cliff-climb-try is 0; continue the action. [So we can always come back and try without dying.]

Report going up from Cliffside: say "The climbing gets even tougher. There's one spot where you're desperate for a handhold, and have to make a great reach that makes your muscles groan. But a few body lengths later, thankfully, you reach the top of the crack, and climb gratefully up onto a broad green lawn.".

Report going from Cliffside to Ledge: say "[if Ledge is unvisited]You lower yourself carefully down the cliff, grateful the crack remains so constant. Finally, with relief, you get to a small ledge, and stand up gratefully, rubbing your aching arms[otherwise]You climb back down the crack towards the safety of the ledge below[end if].".

Report going from Lawn to Cliffside: say "[if Cliffside is unvisited]Nervously, you peer over the edge. It's a long way down. As long as the crack continues, you'll have good hand and footholds, but it will be risky.[paragraph break][end if]You lower yourself carefully into the crack, keeping an eye out for holds, and begin descending the face of the mountain.".

Chapter - Lawn

The prose name of Lawn is "the mountain summit". The description of Lawn is "[lawndesc].[checklawnchapter]".

To say lawndesc:
	if raining begin; say "Misty rain whips past your head, the hot summer storm drenching you. The twirling mist hides most features of the summit; the [o]crack[x] and [o]streambed[x] near the edge of the cliff, the top of the ropeway [o]turnaround[x] and the cable vanishing into clouds below, and around the corner, the strange [dr]structure[x]";
	otherwise; say "This wide, rolling lawn of wild grasses rests just underneath the summit of the mountain, and overlooks a tremendous [o]view[x]. Cable swoops up from far below to end here at a simple [o]turnaround[x]. A "; say "[if pressure of the related pipe of the pyramid pressure gauge >= 5][o]spring[x] bubbles[otherwise]dry [o]streambed[x] meanders[end if] from a jumble of boulders halfway up the lawn, arcing lazily through the grass before finally "; say "[if mountain-spring is pristine]vanishing into[otherwise]tumbling into space near[end if] a [o]crack[x] at the cliff's edge";
	end if;
	say ".[paragraph break]The grass rises gently [if dir][east] [end if]towards a strange [dr]structure[x] ahead, half-hidden by the summit's overhang";
	say "[if bucket is enclosed by location].[paragraph break]The [o]crate[x] hangs from the cables, swaying gently in the breeze[end if]".

The exits text of Lawn is "Other than via the ropeway, [if Cliffside is visited]or [down] the crack, [end if]the only other place to go seems to be [if dir][east] [end if]towards the [dr]structure[x] at the meadow's end". Understand "structure" as east when location is Lawn.

Lawn-stuff is stuff in Lawn. Understand "lawn/overhang" as Lawn-stuff when location is Lawn.

First Check landmark-going when location is Lawn or location is Observatory Exterior: say "You'll have to get down from the mountain, first." instead. Check landmark-going when player is in bucket: say "You'll have to get out of the ropeway crate, first." instead.

The lawntop-view is a backdrop. It is in Lawn and Observatory Exterior and Atop and Saddle. Understand "view/island" as lawntop-view. The printed name is "view of the island". The description is "From this high point you have a tremendous view of all the island. You can see how it is structured almost like a dumbbell or figure eight: the mountain [if location is Lawn or location is Observatory Exterior]you stand on [end if]at one corner and the volcano at the other are linked by the black lava flow streaming from the ruined side of the caldera, which runs neatly into [if location is Atop or location is Saddle]the steep spur you stand on[otherwise]a steep spur jutting out from the mountain below you. High atop the spur is the giant windsigh, almost at the geographic center of the island[end if].[paragraph break]The island's west side comprises the marsh, the lagoon, and the light forest on the slopes of the volcano; the east side is mostly filled with a plateau covered with dense rain forest. To the south, the mountain drops off dramatically into a sea-swept ravine, separating it from the rain forest plateau, and to the north and east the mountain slopes down in a more gradual if treacherous fashion to rocky shoreline.".

lawncheck is a number that varies. lawncheck is 0. To say checklawnchapter: if pyramid has power and lawncheck is 0 begin; now lawncheck is 1; end if.

First Instead of going down in Lawn when mountain-spring is pristine and the pressure of the related pipe of the pyramid pressure gauge >= 5: say "Sheer cliffs drop off at the edges of the lawn, and the crack is mossy and wetted by the streambed. Other than using the ropeway, you see no easy way down." First Check going down in Lawn when player is wounded: say "With this leg, you aren't likely to be climbing any time soon." instead.

The lawncliff is a backdrop. It is in Lawn and Observatory Exterior. Understand "cliff/cliffs" as lawncliff. The printed name is "cliff". Instead of climbing or entering lawncliff: try going down.

The ropeway-summit apparatus is a setpiece in Lawn. Understand "wood" or "wooden" or "bumper" or "ropeway/turnaround" as apparatus. The description is "Much simpler than the station below, all you see is a large post supporting a flywheel, where the cable does an about turn and heads back towards the cliff, and a wooden bumper designed to stop and support the crate when it's here.". The dream-text of ropeway-summit apparatus is "spare flywheels". Check entering ropeway-summit apparatus when bucket is enclosed by location: try entering bucket instead.

Report going from Lawn to Observatory Exterior: say "Feeling exposed in the fast-moving breeze of the mountaintop, you cross the lawn and enter a half-shielded cirque.". 

Section - Spring

The mountain-spring is a backdrop. It is in Lawn, Observatory Exterior, Cliffside, and Ledge. It is either pristine or diverted. It is pristine.  Understand "water" or "trickle" or "stream/streambed/spring" or "springbed/mountain" or "spring bed" or "channel" as the mountain-spring. The printed name is "spring".

Instead of examining the mountain-spring:
	let vol be the pressure of the related pipe of the pyramid pressure gauge;
	if location is Lawn begin; say "The [if vol is 0]dry spring bed[otherwise if vol <= 2]damp spring bed[otherwise if vol <= 10]trickling spring[otherwise]gurgling spring[end if] meanders across the lawn haphazardly from the direction of the pyramid through a shallow channel, [if mountain-spring is pristine]past a number of grey [o]boulders[x] which must have tumbled down from the mountain's summit, till it vanishes into a [o]crack[x] in the cliff[otherwise]until a boulder diverts it and sends it running over the grass to plunge off the far side of the cliff in a tiny waterfall that quickly vanishes into mist[end if].";
	otherwise if location is Observatory Exterior; say "[if vol >= 15]The searing hot spring pours forth from[otherwise if vol >= 10]The hot spring trickles from[otherwise if vol >= 5]The warm spring water seeps from[otherwise]The dry streambed originates at[end if] a sodden depression in the grass. Peering closer, you can see a buried bamboo [o]conduit[x], cracked. Following the conduit, you see its end sticking out over the edge of the cliff, where it would drain into the ravine far below, if the crack didn't divert the water[if puzzle mode].[paragraph break]Some [o]words[x] are scrawled onto the pipe near the dropoff[end if].";
	otherwise; say "The water, [if vol >= 22]coming down in hot steaming curtains[otherwise if vol >= 12]while only a trickle and not too cold[end if], is enough to wet the crack completely and form a base for moss and slime to grow."; 
	end if.

Instead of touching or taking the mountain-spring, say "The water is scalding hot to the touch.". Understand "stop [mountain-spring]" or "dam [mountain-spring]" or "divert [mountain-spring]" as a mistake ("The cirque has been swept smooth by wind and rain; you can't see anything nearby you could use to divert the spring.").

The buried bamboo conduit is a setpiece in Observatory Exterior. Understand "break/crack/hole" as conduit. The description is "It looks as if the conduit is meant to drain runoff water from the steam powering some underground mechanism. The break is quite large; perhaps some boulder tumbling from the rocky slope above did it in.". Understand "fix [conduit]" or "repair [conduit]" or "cover [conduit]" as a mistake("The damage is quite extensive. You don't see any way to repair it short of excavating the whole cirque and replacing the pipe, which you don't have the tools to do."). The dream-text of buried bamboo conduit is "stands of bamboo".

Check tasting the mountain-spring: let vol be the pressure of the related pipe of the pyramid pressure gauge; say "[if vol >= 15]The water is scalding hot; you can barely touch it, let alone drink it[otherwise if vol >= 10]The trickle of water is too hot to drink[otherwise if vol >= 5]The water is warm, and has a strange mineral undertaste[otherwise]The spring is not running at the moment[end if]." instead. Instead of taking or touching the mountain-spring, say "You gather a handful of the scalding hot water in your hand, before letting it fall."

An overly energetic boulder is a prop in Lawn. Understand "boulders/jumble" as energetic boulders when location is Lawn. The description is "[if mountain-spring is diverted]Having rolled quite a ways from most of its siblings nearer the summit, this boulder seems content now in its role as temporary traffic director for the spring[otherwise]The boulders lie strewn around the lawn, some huge and old and sunken into the ground, others, the smaller and more recently mobile, resting on top of it[end if].". The dream-text of energetic boulder is "unsteady boulders". Instead of climbing or entering overly energetic boulder, say "Most of the boulders are far too small for that to be useful; they would probably easily shift under your weight.".

Instead of taking or attacking the overly energetic boulder, try pushing the overly energetic boulder. Check pushing the overly energetic boulder when the mountain-spring is diverted: say "You've already pushed a boulder to divert the tiny spring." instead.

First report pushing the overly energetic boulder: now the mountain-spring is diverted; say "You bend down and, with one solid heave, manage to topple one large boulder into the path of the [if the pressure of the related pipe of the pyramid pressure gauge >= 5]stream. The water changes course, running across the lawn to tumble off the cliff in a waterfall that vanishes into the air, rather than trickling into the crack[else]dry streambed. It looks like any water flowing through here now would be diverted away from the crack[end if]."; rule succeeds.



Chapter - Observatory Exterior

The printed name of Observatory Exterior is "[if pyramid is on-stage]Outside the Pyramid[otherwise]At the Machinery[end if]". Understand "lawn" as west when location is Observatory Exterior.

The prose name of Observatory Exterior is "the mountain cirque by the [if pyramid is on-stage]wooden pyramid[else]machinery".

The description of Observatory Exterior is "[observdesc].". To say observdesc:
	let vol be the pressure of the related pipe of the pyramid pressure gauge;
	if vol >= 22, let outvol be vol - 22; otherwise let outvol be vol;
 [pyramid uses 22 units of power if available.]
	if longform begin;
		say "Nestled into this cirque at the foot of the mountain's summit[if raining], sheltered by the slight overhang from the rain, [end if] is [one of]a[or]the[stopping] [pyrstatesummarylong]";
	otherwise;
		say "The [pyrstatesummaryshort], ";
		if sunup, say "gleams in the [Progue-time-of-day] sunlight";
		else say "rests mysteriously in the [light-source]";
	end if;
	say "[dot][if outvol > 20]Torrents of steam gush from a nearby outflow [ventword], rising high into the sky before dissipating[otherwise if outvol > 15]Steady clouds of steam bellow from a nearby outflow [ventword][otherwise if outvol > 3]Steam pillows from a nearby outflow [ventword][otherwise if outvol > 0]Thick tendrils of steam rise up from a nearby outflow [ventword][otherwise]An outflow [ventword] emits only wisps of humid air[end if] "; 
	say "at the base of the [if pyramid is on-stage]pyramid[otherwise if destroyed mind machinery is in location]wreckage[else]machinery";
	if pyramid has power and destroyed mind machinery is not in location begin; say ", and a steady whir and thrum deep in your bones sighs up from somewhere underneath the ground[if pyramid is on-stage]. A brilliant ruby glow spills through its three vertical seams[compasssqueezebit][otherwise]. The [o]egg[x] pulses with an intense ruby glow, so bright you almost can't look into it[end if][if night or dawn or twilight], and a faint column of crimson light rises from it into the sky[end if]";
	otherwise if vol > 0 and destroyed mind machinery is not in location; say ", and a dim crimson glow pulses [if pyramid is on-stage]through the three edges of the pyramid[otherwise]from the [o]egg[x][end if], cycling slowly off and then back to dimness again[if night or dawn or twilight] and casting weird shadows against the walls of the cirque";
	end if;
	say "[dot]A few paces away a [if vol >= 5][o]spring[x] bursts from the ground[otherwise]dry [o]streambed[x] begins[end if], ";
	say "meandering in a shallow channel back towards the lawn[dot]";
	say "[exits]".

To say compasssqueezebit: if puzzle mode, say "; where it hits the mountain cirque behind is projected an [o]image[x]".

Check listening when location is Observatory Exterior: if pyramid has power, say "The noise is subsonic, a deep rumbling coming from somewhere [if pyramid is on-stage]beneath the pyramid[else]beneath the chair[end if]." instead; else say "Wind whips through the mountaintop, whistling faintly through the curvature of the cirque." instead.

[[if raining or rained]; drops of water glisten and run along them like dewdrops on a spiderweb[end if]]

The mountain scrawl is a hint-based scrawl in Observatory Exterior with standard message "Not safe. Locked now. This way you have to know my words to get in." and secret message " Just have to finish Echo Cave work first." Understand "word/words" as mountain scrawl.

The exits text of Observatory Exterior is "The only safe place to go is back[if dir] [west][end if] towards the [dr]lawn[x]".

Observatory-stuff is stuff in Lawn. Understand "cirque/foot/whir/thrum/rod/rods" as Observatory-stuff when location is Observatory Exterior.

The projected image is a setpiece. The description is "The red light spills out from the seam in the side of the pyramid, painting the cliff behind in intense crimson light; but some hidden stencil obscures parts of the light to create a detailed image. It shows a compass that looks remarkably like the one [if player wears compass]around your neck[else]you've seen around the island[end if], held in a hand[squeezehint].". Check going to Observatory Exterior: if pyramid has power and puzzle mode, move projected image to Observatory Exterior; otherwise remove projected image from play; continue the action. To say squeezehint: if compass is extruded, say " that is squeezing it tightly"; else say "[one of] that is squeezing it tightly[or] that squeezes it tightly[or]. The hand is squeezing the compass[stopping]".

The ambience table of Observatory Exterior is Table of Observatory Exterior ambience.

Table of Observatory Exterior ambience
freq		start time	end time	text	table		trigger	flag
common	--		--		"[one of]Wind whips through your hair sharply[or]Birds soar through the air beneath you, catching warm updrafts from the marsh[or]The distant sounds of surf crashing echo up dimly from the ocean far below[in random order]."
frequent		--		--		"[if pyramid has power and player is not enclosed by mind chair][one of]A deep, rhythmic thrum[or]A powerful thrumming vibration[or]An almost electric thrum[in random order] [one of]beneath your feet[or]from somewhere beneath the ground[in random order] [one of]surges underneath your feet[or]fills the air[in random order].[end if]"


Section - The Pyramid

[There are a confusing number of states here to describe. The machinery here can be unpowered, insufficiently powered (in which case it pulses faintly red) or fully powered (in which case it glows a deep red and shoots a beam of light into the sky, visible at night). The pyramid is either concealing the egg (the source of the glow) and the chair, or gone, exposing them. Also, the machinery might be destroyed. ]

To say pyrstatesummarylong:
	if pyramid is in location:
		say "crude wooden [o]pyramid[x] only a head taller than you are, completely encircled by huge metallic hoops tilted like the rings of some strange planet. Hundreds of tiny wire filaments run from points across the rings to a junction at the top of the pyramid";
	otherwise if destroyed mind machinery is in location:
		say "wreckage of the [o]machinery[x], broken glass and twisted filaments and sparking wires";
	otherwise:
		say "reclined [o]chair[x], surrounded by a medley of strange [o]machinery[x]. Hundreds of noodle-thick metal hoops encircle the chair, joined by thousands of wire filaments that converge at a point suspended above it".

To say pyrstatesummaryshort:
	if pyramid is in location:
		say "wooden [o]pyramid[x], surrounded by its halo of [o]hoops[x] and [o]filaments[x]";
	otherwise if destroyed mind machinery is in location:
		say "wreckage of the [o]machinery[x]"; 
	otherwise:
		say "[o]chair[x], surrounded by the medley of strange [o]machinery[x] and the halo of hoops and filaments".

To say ventword: say "[o]vent[x]".

The pyramid is an undescribed setpiece in Observatory Exterior. The description is "The pyramid, despite the bizarre implements surrounding it, seems quite plain, constructed from three pieces of triangular wood, weather-worn but quite solid. Each side of the pyramid is adorned with one of three [o][if puzzle mode]drawings[otherwise]words[end if][x][pyrdesc2]". To say pyrdesc2: say "[if pressure of the related pipe of the pyramid pressure gauge > 0 and pyramid is on-stage], and a red glow streams through minute joins along its edges[otherwise if pressure of the related pipe of the pyramid pressure gauge > 0 and pyramid is on-stage], and a red [o]glow[x] pulses inside the egg hotly[end if][pyrdesc2b]". To say pyrdesc2b: say ". Wire [o]filaments[x] run from the [o]hoops[x] surrounding the [if pyramid is on-stage]pyramid to its apex, where they converge and presumably run to the inside[otherwise]structure to a point suspended above the chair, where they converge and run in a thick bundle into the egg[end if][pyrdesc3]". To say pyrdesc3: if puzzle mode, say ".[paragraph break][gauge-description], near [if pyramid is on-stage]the point of the pyramid nearest the cliff[otherwise]the foot of the chair[end if], rises from the ground, connected to a yellow [o]pipe[x] that snakes off towards the dropoff. A"; else say ".[paragraph break]A yellow [o]pipe[x] snakes towards the dropoff and connects to the base of the [if pyramid is on-stage]pyramid[else]chair[end if]; a"; say " stubby outlet [o]vent[x] [if pressure of the related pipe of the pyramid pressure gauge > 24]emits a steady cloud of steam[otherwise if pressure of the related pipe of the pyramid pressure gauge > 22]emits faint wisps of steam[otherwise]rises from the join[end if].". Does the player mean doing something to the pyramid: it is likely. Instead of doing something to distant-pyramid when location is Observatory Exterior: if pyramid is on-stage, try examining the pyramid; otherwise say "The three sides of the pyramid have vanished into slits in the ground.". The dream-text of pyramid is "tiny wooden pyramids".

The red-glow is part of the pyramid. Understand "red/glow" as red-glow. The printed name is "red glow". The description is "It streams out through the three edges of the pyramid, a knife-edge of crimson brilliance, as if something inside is giving off a tremendous light.".

Check opening the pyramid: say "The edges are far too close together to get a finger or even a fingernail between them, and there are no handles or other places to get a grip anywhere on the surface." instead. Check pushing the pyramid: say "You push against the side of the pyramid." instead. Check attacking the pyramid: say "You take a step back and slam into the side of the pyramid with your shoulder; though you are sure now that the interior is hollow, the wood does not come even close to giving." instead. Check entering the pyramid: try opening the pyramid instead. Check closing the pyramid: say "It seems quite closed already." instead. Check climbing pyramid: say "No point, since it's only as high as your head." instead. Check touching pyramid: say "The wood, though weathered a little, is planed smooth." instead.

To decide whether pyramid has power: if the pressure of the related pipe of the pyramid pressure gauge >= 22, decide yes; decide no.

The track is a setpiece in Observatory Exterior.

The pyramid outlet vent is an outflow tube. The pyramid outlet vent is part of the pyramid. The related pipe of the pyramid outlet vent is the yellow pipe.

The pyramid pressure gauge is a pressure gauge. It is in Observatory Exterior. It is undescribed. The target pressure is 22. The related pipe is the yellow pipe.

The three etchings are part of the pyramid. Understand "drawing" or "drawings" or "konokuk" or "fruits" or "trees" or "square" or "windsigh" or "tree" or "circle" or "galaxy" or "capalla" or "pentagon" or "dot/dots/side/sides" as the etchings. The description is "Each of the three sides of the pyramid bears one of the drawings, along with one, two, or three dots: the first shows [if konokuk trees are named]a konokuk fruit[otherwise]one of the hairy brown sphere-shaped fruits[end if] enclosed by a square, the second shows [if tree1 is named]a windsigh tree[otherwise]one of the ubiquitous twisted trees[end if] surrounded by a circle, and the last shows the night sky's galaxy, [if galaxy is named]Capalla, [end if]surrounded by a pentagon.". Instead of touching or taking the etchings, say "The detailed drawings are done directly on to the sides of the pyramid.". Check pushing the etchings: try pushing the pyramid instead. Understand "say capalla" [or "capalla"] or "say windsigh" [or "windsigh"] or "say konokuk" [or "konokuk"] as a mistake ("You say the word loudly into the air, but there is no response.") when location is Observatory Exterior.

The alternate-etchings are a story-based scrawl. [This is for story mode; a simpler version that bypasses the echo chamber puzzle.] Understand "etchings" or "word/words" as alternate-etchings. The printed name is "words on the pyramid". The standard message is "knock[paragraph break]thrice[paragraph break]clap". 

Some metallic hoops are a setpiece in Observatory Exterior. Understand "huge/hoop/tilted/rings" as metallic hoops. The description is "From up close, you can see hundreds of the hoops, all of similar but not identical positions and dimensions. As a whole, they form one large ephemeral torus, tilted about thirty degrees to the ground, and giving the pyramid a wide berth, like some strange probability cloud bound to an origin by one force and repulsed by another. A forest of wooden rods support the strange structure in place.". Understand "huge" or "torus" or "ephemeral" as the hoops. Check attacking metallic hoops: say "It's probably not a good idea to damage this device until you're sure of what it does." instead. Instead of pushing or pulling or touching metallic hoops, say "[if pressure of the related pipe of the pyramid pressure gauge > 20]You reach out to touch the metallic hoops and--[paragraph break][paragraph break]... slowly, you open your eyes to find yourself flat on your back. Woozily, you stand to your feet, feeling faint tingles still arcing through your body. Where your fingertip brushed the hoop is a narrow black band[otherwise if pressure of the related pipe of the pyramid pressure gauge > 10]You reach out to touch the metallic hoops, then jerk your hand back sharply as a searing electric shock runs through it[otherwise if pressure of the related pipe of the pyramid pressure gauge > 0]You touch one metallic hoop and feel an electric current moving through it[otherwise]You touch your finger to a metal hoop, but feel nothing other than smooth coolness[end if].". The dream-text of metallic hoops is "tiny wooden pyramids".

The wire filaments are a setpiece in Observatory Exterior. Understand "filament/tiny/hundreds/junction" as wire filaments. The description is "Thin as human hair, the filaments stretch like a spiderweb from the apex of the pyramid to thousands of points along the metallic hoops surrounding it.". Check attacking wire filaments: try attacking metallic hoops instead. Check touching wire filaments: say "You touch one tentatively; it is incredibly fine and strung so tight you doubt you could move it without slicing your finger." instead. The dream-text of wire filaments is "tiny wooden pyramids".

Understand "knock thrice" or "knock three times" as thrice-knocking. Thrice-knocking is an action applying to nothing. Check thrice-knocking: if pyramid is off-stage, try vague knocking instead; if location is not Observatory Exterior, say "You knock sharply three times, but nothing happens." instead. Carry out thrice-knocking: say "You rap your knuckles sharply three times against the weathered wood of the pyramid's side." Understand "knock thrice on [something]" or "knock three times on [something]" or "knock on [something] thrice" or "knock on [something] three times" as knocking.

Clapping is an action applying to nothing. Understand "clap" as clapping. Carry out clapping: say "You clap your hands together sharply[if location is Observatory Exterior]. The sound is amplified by the round cirque[otherwise if location is Echo Chamber]. The sound echoes like a gunshot around and around, until slowly fading into silence[end if]."

Check vague knocking when location is Observatory Exterior: try knocking the pyramid instead. Check knocking the pyramid: say "You rap your knuckles sharply against the weathered wood of the pyramid's side. The wood seems thick, but the structure is definitely hollow." instead. 

Pyract1 is a number that varies. Pyract2 is a number that varies. Pyract3 is a number that varies. Pyract4 is a number that varies.

Every turn when the pyramid is on-stage and location is Observatory Exterior:
	now pyract1 is pyract2;
	now pyract2 is pyract3;
	now pyract3 is pyract4;
	if we are clapping begin; now pyract4 is 2;
	otherwise if we are thrice-knocking; now pyract1 is pyract3; now pyract4 is 1; now pyract3 is 1; now pyract2 is 1;
	otherwise if we are vague knocking or knocking the pyramid; now pyract4 is 1;
	otherwise; now pyract4 is 0;
	end if;
	if pyract1 is 1 and pyract2 is 1 and pyract3 is 1 and pyract4 is 2 begin;
		if pyramid has power begin;
			remove the pyramid from play;
			move the mind chair to Observatory Exterior; 
			move the mind machinery to Observatory Exterior;
			say "Something catches with a tiny click, and then, with a deep groaning, the three sides of the pyramid retract and disappear into black slits in the ground, revealing a triangular platform with a mass of [o]machinery[x] and a single wooden [o]chair[x], reclined and padded.";
			print a section break;
			try looking;
		otherwise;
			say "You hear a tiny snick, followed by a dull grinding of wound-down gears. All the steam flowing from the outflow vent immediately stops. The pyramid shutters, but then the noise winds down, and nothing further happens.[paragraph break]Steam begins rising again from the outflow vent.";
		end if;
	end if.

Section - Pyramid Machinery

The mind machinery is a setpiece. The mind machinery can be idling or projecting. The mind machinery is idling. The mind machinery is either calibrated or uncalibrated. The mind machinery is uncalibrated. The mind machinery can be crypted or unencrypted. The mind machinery is unencrypted.  The description is "The complex array of machinery, which seems to extend well beneath the ground, centers around a cylindrical mass that rises from behind the chair. At its top is a large crystalline [o]egg[x], pulsating with a deep red glow and nearly obscured by a frankenstein medley of technology, half delicate alien machinery and half crude wires and handmade stopgaps.[paragraph break]The machinery forms a wide hemispherical berth around the headrest of the [o]chair[x][pyrdesc2]". Understand "cylindrical" or "mass" as mind machinery. The machinery-password is an indexed text that varies. Understand "machine" as mind machinery.

Instead of attacking the mind machinery when Finishing-Treeworld is solved and Finishing-Rebelworld is solved: force discuss machinery_death. Machinery_death is a beat with reaction "The complex of wires and delicate machines would smash easily enough, you're sure. But is that what you really want?". Instead of saying yes when last beat is machinery_death and location is Observatory Exterior, super rampage. Instead of saying no when last beat is machinery_death and location is Observatory Exterior, say "You lower your hands and calm yourself.". Instead of attacking the mind machinery when Finishing-Treeworld is solved and Finishing-Rebelworld is solved and we have discussed machinery_death: super rampage.

To super rampage: remove the mind machinery from play; remove the mind egg from play; move the destroyed mind machinery to Observatory Exterior; change the machinery-password to "un.typable"; say "Blood pumping thickly through your veins, you grab a fistful of cables and yank as hard as you can. Sparks fly as they come loose in your hand like tufts of hair and the deep thrum beneath you groans. Encouraged, you begin smashing and pummeling the machinery with a vigor. A torrent of steam escapes a broken tube; lights and noises die; the thrum below you slows and finally stops.[paragraph break]Finally, panting, you lower your hands. The mindlink machinery lies in ruins.".

The destroyed mind machinery is a setpiece. Understand "mindlink" or "ruins" or "egg" as destroyed mind machinery. The description is "Only bits and pieces remain. The egg lies dark and silent in their midst.". Instead of attacking destroyed mind machinery: say "No more violence is necessary; it's been reduced to rubbish.".

Instead of attacking the mind machinery: say "This is delicate equipment, probably irreplaceable. You don't want to break anything until you're absolutely sure that's the only solution.".

The mind egg is a setpiece. It is part of the mind machinery. The description is "The torso-sized egg is made of some glass-like material that refracts and bends the red glow spilling from inside it in strange ways. Hundreds of tiny veins of sea-blue run through the crystal. Though intact, the surface is marred by blackened scorch marks and streaks of ash melted into the surface. What bits of the interior you can see seem clouded with fractal patterns of impossible complexity; but most of the object's surface is obscured by wires, tubes, and contacts that connect it to the array of machinery surrounding it.". The dream-text of mind egg is "hundreds of glowing red eggs, filled with luminous sparkles of gold and silver". Instead of taking the mind egg: say "It's intricately connected to the machinery underneath it by hundreds of wires and structural rods.". Instead of touching the mind egg: say "The surface is utterly smooth: smoother than marble, smoother than glass, and [if pyramid has power]hot[otherwise if pressure of the related pipe of the pyramid pressure gauge > 10]warm[otherwise if pressure of the related pipe of the pyramid pressure gauge > 0]slightly warm[otherwise]cool[end if] to the touch.". Instead of opening mind egg: say "It seems to be one unbroken solid shape.". Instead of attacking mind egg, try attacking mind machinery. 


Section - The Mind Chair

The mind chair is an undescribed enterable supporter. The printed name is "reclined chair". The description is "Angled back in a reclining position, it is constructed of wood and padded with simple cushions. Above, behind, and below the headrest is a frankenstein array of [o]machinery[x], running into the ground beneath the chair." Does the player mean entering the mind chair: it is likely. Check climbing mind chair: try entering mind chair instead.

After entering the chair:
	say "Heart racing, you carefully sit down on the chair-- then, after a moment, lean back and rest your head on the padded cushion. ";
	if pyramid has power begin;
		move icon-case to chair;
		if the mind machinery is calibrated begin; say "[paragraph break]After a moment of strange mental tingling, a set of transparent icons winks into view, seeming to hover a few feet in front of you. [mindlink summary].";
		otherwise;
			if Mindlink Calibration has ended begin;
				say "[paragraph break]Once again, something appears hovering in your field of vision: [a list of things in icon-case].";
			otherwise;
				say "[paragraph break]At first, nothing happens, but then you feel a faint, quiet tickling somewhere inside your head.[paragraph break]A faint [o]brightness[x] suddenly appears in the center of your field of vision. It seems to float there, regardless of where you look, as if it is somehow being projected on top of it.";
				move the light-icon to icon-case;
			end if;
		end if;
	otherwise;
		say "At first, nothing happens, but then you feel a strange mental tingling, and a fuzzy concept takes shape in your head which slowly resolves into a pair of numbers:[paragraph break][pressure of the related pipe of the pyramid pressure gauge].[paragraph break]22.[paragraph break]Then the tingling fades, and nothing further happens.";
	end if.

After entering the chair when the mind machinery is off-stage: [i.e. destroyed] say "You sit down on the chair, but nothing happens; the machinery is ruined."

After getting off the chair: say "[if icon-case is on-stage]As you move to stand up, the icons instantly disappear. [end if]You rise to your feet."; remove icon-case from play; now counter of light-icon is 0. After getting off the chair when the mind machinery is off-stage: say "You get to your feet."

Instead of looking when player is on the mind chair and icon-case is on-stage, say "Floating in midair before you [if tree icons are in icon-case]is an array of icons. [mindlink summary][otherwise][is-are the list of things in icon-case][end if].[paragraph break]The world outside of the chair is hard to focus on until you [d]stand up[x].".

To say mindlink summary: 
	say "An arc of seven [o]windsigh[x] icons[if the number of contacted windsigh trees is 7], all glowing [color text of yes-icon of mind machinery],[otherwise if the number of contacted windsigh trees is 0], all grey,[otherwise] ([the number of contacted windsigh trees in words] glowing [color text of yes-icon of mind machinery], the [sti_color] dim and grey)[end if] ";
	say "floats below a large [o]globe[x] icon ([if the machinery-password exactly matches the text rebel-password or the machinery-password exactly matches the text tree-password]pulsing [color text of yes-icon of mind machinery][otherwise if the number of contacted windsigh trees is 7]still [color text of no-icon of mind machinery][otherwise]a dull [color text of no-icon of mind machinery][end if])";
	if the number of contacted windsigh trees is 7 begin;
		say ". Above both of these is a stylized lock and [o]key[x]";
		if mind machinery is unencrypted, say ", the latter grey and hovering just to the right of the open lock";
		otherwise say ", the latter engraved with the word '[machinery-password]' and inserted into the lock";
		say ". Finally, floating above the lock is a cloud of thousands and thousands of almost imperceptibly small [o]dots[x][if the machinery-password exactly matches the text rebel-password or the machinery-password exactly matches the text tree-password], all [color text of no-icon of mind machinery] but for a single [color text of yes-icon of mind machinery] speck[otherwise if the machinery-password is blank], all [color text of yes-icon of mind machinery][otherwise], all [color text of no-icon of mind machinery][end if]";
	end if.


To say sti_color: if the number of contacted windsigh trees is 6, say "last"; otherwise say "rest".

A mindlink-icon is a kind of thing. A mindlink-icon is usually undescribed. A mindlink-icon is always minor. Last instead of taking a mindlink-icon: say "Your hands move right through it." [bug2: does this work?]

Test mindlink with "tp observatory exterior / knock thrice / clap / sit / l / head".

Icon-case is a transparent open unopenable undescribed container. It is fixed in place.

The seven tree icons are a mindlink-icon. Understand "windsigh" as the tree icons. The description is "As you focus on the icons you [if the number of contacted windsigh trees is 0]feel a strange, distant pull from somewhere below you on the island[otherwise if the number of contacted windsigh trees is 7]feel a powerful tingling in your mind, and recognize the trees you have found, the seven spread around the island. They are ready[otherwise if guessed_trees is false]feel a powerful tingling in your mind, like the presences from your dreams. Only it's stronger now; and you sense that you no longer need to dream under the trees to speak to the presences-- you must still find the rest, but now you can merely touch them to hear their message[otherwise]feel a powerful tingling in your mind, and recognize the [number of contacted windsigh trees in words] mind[s] you have already found, and the eagerness of the [7 - number of contacted windsigh trees in words] other[s] you have yet to contact. You sense that the calibration has helped them; now, you do not need to be in sleep to speak with them. Merely touching the trunks of the windsigh trees will be enough for the minds to reach you[end if].".

The globe icon is a mindlink-icon.

Instead of examining the globe icon when mind machinery is calibrated: 
	say "You focus on the globe icon";
	if the number of contacted windsigh trees < 7:
		say ". It does not change, but the [the number of uncontacted windsigh trees in words] grey windsigh icon[if the number of uncontacted windsigh trees > 1]s below it flash[otherwise] below it flashes[end if] [color text of no-icon of mind machinery] a few times.";
	otherwise if the machinery-password is blank:
		say ", but immediately all the colored [color text of yes-icon of mind machinery] dots turn [color text of no-icon of mind machinery]. A few random single dots turn [color text of yes-icon of mind machinery], one at a time, before the whole group returns to [color text of yes-icon of mind machinery] again.";
	otherwise if the machinery-password exactly matches the text rebel-password or the machinery-password exactly matches the text tree-password:
		say "-- and an impossibly bright red glow flares into your eyes. You fling your hand up to shield them---";
		if ( Being-In-Rebelworld is unsolved and the machinery-password exactly matches the text rebel-password ) and Lab is unvisited, begin chapter 9;
		if ( Being-In-Treeworld is unsolved and the machinery-password exactly matches the text tree-password ) and Overlook is unvisited, begin chapter 8;
		now the mind machinery is projecting;
	otherwise:
		say ". Nothing happens, except that the cloud of dots and the lock and key icons blink [color text of no-icon of mind machinery] for few moments.".

The key icon is a mindlink-icon.

Instead of examining the key icon when mind machinery is calibrated and the number of contacted windsigh trees >= 7:
	say "As you activate the key, [if the machinery-password is blank]it moves forward into the lock with a mental click. The key begins pulsing with an expectant quiver, and you can feel intuitively that it is waiting to swallow your next utterance[otherwise if the machinery-password exactly matches the text rebel-password or the machinery-password exactly matches the text tree-password]it pulls back out of the lock and the single [color text of yes-icon of mind machinery] dot above becomes just one in a sea of [color text of yes-icon of mind machinery] dots[otherwise]it pulls back out of the lock[end if][if the machinery-password is not blank]. The engraved word, '[machinery-password],' fades away until the key is once again featureless[end if]";
	if the machinery-password is blank begin;
		now the key icon is feeding;
		change the command prompt to ">>";
	otherwise;
		change the machinery-password to "no.thing";
	end if;
	if the machinery-password is not blank, say ", [if the machinery-password exactly matches the text rebel-password or the machinery-password exactly matches the text tree-password]and the single [color text of yes-icon of mind machinery] dot becomes lost as all the [color text of no-icon of mind machinery] others fade to join it in uniform [color text of yes-icon of mind machinery][else]and all the dots fade from [color text of no-icon of mind machinery] to [color text of yes-icon of mind machinery]";
	say ".";


The key icon is either satiated or feeding. The key icon is satiated. 

After reading a command when the key icon is feeding:
	let testtext be indexed text;
	let testtext be the player's command;
	if testtext is an invalid password, reject the player's command;
	otherwise replace the player's command with "setkey machpw [the player's command]".

After defining a password while key icon is feeding:
	change the command prompt to ">";
	now the key icon is satiated;
	now the mind machinery is crypted;
	say "As you visualize the word, you can feel neurons firing in your brain, and sense intuitively somehow that unique pattern, the precise electrical, neurological relationship between your brain and that word -- [machinery-password] -- is being recorded and copied. Slowly, the word becomes etched into the key above[if the machinery-password exactly matches the text rebel-password or the machinery-password exactly matches the text tree-password]. When it is finished, a single dot in the [color text of yes-icon of mind machinery] cloud above retains its color, while all others fade to [color text of no-icon of mind machinery]; the [o]globe[x] icon also lights up [color text of yes-icon of mind machinery][otherwise], as all the tiny dots above wink from [color text of yes-icon of mind machinery] to [color text of no-icon of mind machinery], until they are one solid band of color[end if].".

The tiny dots are a mindlink-icon. The description is "[if the machinery-password exactly matches the text rebel-password or the machinery-password exactly matches the text tree-password]The single [color text of yes-icon of mind machinery] dot and the globe icon seem to pulse together as you activate it, but otherwise nothing happens[otherwise]They are so small they are only barely perceptible as individual points, floating in a loose halo above and around the lock and key... almost in the shape of a galaxy[end if]."

Section - The Calibration Sequence

Mindlink Calibration is a recurring scene. Mindlink Calibration begins when player is on the chair and mind machinery is uncalibrated and pyramid has power. Mindlink Calibration ends when player is not on the chair or mind machinery is calibrated.

The light-icon is a mindlink-icon. Understand "bright/brightness" as light-icon. The printed name of light-icon is "brightness". The light-icon has a number called counter. The counter of light-icon is 0. The description is "It burns bright and intense, hurting your eyes.". Instead of touching or taking or pushing or pulling light-icon, say "You reach out for it but your hands close on nothingness. You can't feel it but your eyes certainly can see it.". Check attacking light-icon: say "You thrash out at the light but your hands go right through it, feeling nothing." instead.

Every turn when the light-icon is in the icon-case and the icon-case is on-stage:
	increase counter of light-icon by 1;
	let C be the counter of light-icon;
	if C is 1 begin; say "The fuzzy [o]brightness[x] grows stronger and more distinct.";
	otherwise if C is 2; say "The [o]brightness[x] gets brighter, shimmering and strengthening in the center of your field of vision.";
	otherwise if C is 3; say "Growing brighter and brighter, the [o]brightness[x] in front of you is becoming intense.";
	otherwise if C is 4; say "The [o]brightness[x] is becoming blinding, searing and bubbling before your eyes painfully.";
	otherwise if C is 5; say "A sun boils before you, radiant [o]brightness[x] burning its way into your retinas; you can hardly stand it.";
	otherwise if C is at least 6; say "The [o]brightness[x] is a supernova; you can't take another second. Finally, involuntarily, you blink..."; try silently eye closing;
	end if.

Instead of eye closing when the light-icon is in the icon-case and the icon-case is on-stage: say "You close your eyes against the intense light and immediately it extinguishes.[paragraph break]Subtle currents of thought touch your mind. A moment of calculation, of consideration...When you open your eyes again, there are two glowing dots, but smaller, dimmer, and less fuzzy. Each [o]dot[x] flits around your field of vision like fireflies."; remove the light-icon from play; move firefly-icons to icon-case.

Instead of eye closing when Mindlink Calibration is happening and light-icon is not in the icon-case: say "You shut your eyes, but can still see the imagery hovering before you. You open them again." instead. Check sleeping when location is Observatory Exterior: say "[if pyramid is not enclosed by location]The chair looks comfortable, but not that comfortable[else]It's too exposed and windy to sleep up here[end if]" instead.

Some firefly-icons are a mindlink-icon. Understand "firefly" or "fireflies" or "dot/dots" as some firefly-icons. The printed name of some firefly-icons is "tiny firefly dot[if multi]s". Some firefly-icons can be either multi or sole. The firefly-icons are multi. The description is "The [if multi]two tiny dots dip and swarm[otherwise]tiny dot dips and swarms[end if] around in front of you, dodging forward and backward, left and right.". Understand "follow [firefly-icons]" as a mistake ("They flit around but seem to stay within a few feet of you.") when location is Observatory Exterior.

Every turn when firefly-icons are in the icon-case and the icon-case is on-stage:
	say "The tiny [if firefly-icons are multi][o]dots[x] bob and weave[otherwise][o]dot[x] bobs and weaves[end if] around in strange, circling patterns.".

Instead of touching or taking some firefly-icons:
	if firefly-icons are multi begin; now firefly-icons are sole; say "You reach out your hand towards one of the tiny dots; as you brush against it, it becomes fixed in place for a moment, then vanishes with a thrilling quiver.";
	otherwise; remove firefly-icons from play; say "You touch the other dot, and it too freezes, then shimmers out of existence.[paragraph break]Another moment of hesitant thought, and then six glowing spheres appear before you, each a different color: [o]red[x], [o]orange[x], [o]yellow[x], [o]green[x], [o]blue[x], [o]violet[x], a spectrum.[paragraph break]A dull nagging sensation floats through your mind, which throws up words that dance around the central concept as it struggles to comprehend: danger, no, negation, closed, locked, unavailable, unready, impermissible."; now every color-icon is in icon-case; remove unassigned light from play; now counter of light-icon is 0;
	end if.

A color-icon is a kind of mindlink-icon. A color-icon has some text called the color text. The red glow is a color-icon. The color text of red glow is "red". The orange glow is a color-icon. The color text of orange glow is "orange". The yellow glow is a color-icon. The color text of yellow glow is "yellow". The green glow is a color-icon. The color text of green glow is "green". The blue glow is a color-icon. The color text of blue glow is "blue". The violet glow is a color-icon. The color text of violet glow is "violet". The unassigned light is an undescribed color-icon. The color text of unassigned light is "unassigned". Does the player mean doing something to the yellow glow: it is likely. [because of the yellow pipe.]

The mind machinery has a color-icon called the no-icon. The mind machinery has a color-icon called the yes-icon. The no-icon of mind machinery is unassigned light. The yes-icon of mind machinery is unassigned light.

Every turn when a color-icon is in the icon-case and the icon-case is on-stage:
	say "The [one of]nebulous[or]vague[or]uncertain[in random order] [one of]feeling[or]sensation[in random order] of [feeling-word] [one of]continues[or]keeps[in random order] [one of]floating through your mind[or]running through your thoughts[or]nagging at your brain[in random order]."

To say feeling-word: say "[if the yes-icon of mind machinery is unassigned light and the no-icon of mind machinery is unassigned light][one of]negation[or]danger[or]unavailability[in random order][otherwise][one of]readiness[or]permissiveness[or]acceptability[in random order][end if]".

Instead of doing something to a color-icon when the yes-icon of mind machinery is unassigned light and the no-icon of mind machinery is unassigned light:
	say "As you focus your attention on the [noun], it suddenly flares along with the intensity of the sensation of negation, and just as suddenly they both disappear.[paragraph break]A new sensation appears: a prickling feeling of readiness, accessibility, openness, okay-ness.";
	now the no-icon of mind machinery is noun;
	remove noun from play.

Instead of doing something to a color-icon when the yes-icon of mind machinery is not unassigned light or the no-icon of mind machinery is not unassigned light:
	now the yes-icon of mind machinery is noun;
	say "You have barely focused on the [noun] when it too suddenly brightens, along with a spike in the feeling of permissibility, of readiness-- then both vanish.[paragraph break]There is a long pause, redolent with concealed calculations.[paragraph break]Then, with a satisfied click of finality, a set of glowing icons appear in front of you. [mindlink summary].";
	repeat with trash running through color-icons begin; remove trash from play; end repeat;
	finish mindlink calibration.


To finish mindlink calibration:
	now mind machinery is calibrated;
	move icon-case to chair;
	remove light-icon from play;
	repeat with trash running through color-icons begin; remove trash from play; end repeat;
	remove firefly-icons from play;
	move the tree icons to icon-case;
	move the globe icon to icon-case;
	move the key icon to icon-case;
	move the tiny dots to icon-case.




Section - Endgame Storm

[To preserve forward momentum in the last few chapters of the story, we create a night time storm that descends on the island during the player's visit to the first of the two endgame worlds. The storm prevents leaving the mountaintop until both worlds are visited.]

endgame-dispersing clouds is a backdrop with printed name "dispersing clouds". Understand "cloud" or "clouds" or "patches" as endgame-dispersing clouds. 
   
To set up the endgame storm:
	say "[line break]The weather has changed in your absence. [unless night]Night has fallen, and b[else]B[end if]lack storm clouds race across the darkened sky, bruised by dull flashes of lightning. Wind whips over the exposed mountain peak, swirling dust and grit into eddies that disappear over the cliff edge into darkness.";
	change the time of day to 10:30 PM;
	now the time factor is 1;
	move storm clouds to Outdoors.

 
To set up the endgame afterstorm:
	begin chapter 10;
	change the time of day to 10:30 PM;
	now the time factor is 1;
	move endgame-dispersing clouds to Outdoors;
	remove storm clouds from play;
	say "The storm seems to be moving by; ever-widening patches of stars shine down from above, and the wind now feels warmer and calmer.".

Some storm clouds are a backdrop. The description is "The black clouds swallow up the sky; flashes of lightning dart constantly between them.". Understand "stormclouds" as storm clouds.

Every turn when storm clouds are on-stage and location is regionally in Lacuna:
	add potential messages from the Table of Endgame Stormage, only one;
	increase estormctr by 1;
	[Sometimes testers would get stuck after the first world because they couldn't remember the password they'd set for the second, and the storm prevented them reaching any trees to dream and remember. The line below was added to prompt players who get stuck here.]
	if estormctr is 10 or ( estormctr > 10 and a random chance of 1 in 6 succeeds ) , say "The two [o]passwords[x] float through your racing mind.".

estormctr is a number that varies. Understand the command "passwords" as "inventory".

Table of Endgame Stormage
freq			text	table		trigger	flag
common	"Lightning flickers menacingly in the sky above."
common	"A few raindrops patter through the air."
common	"Vague patterns shift above as the storm clouds swirl by."
common	"Wind howls and tugs at you heavily."
common	"Swirls and eddies of wind ripple past the exposed summit."

Going down is stormy behavior. Pushing the bucket is stormy behavior. Entering the bucket is stormy behavior. Before stormy behavior when location is regionally in Lacuna and storm clouds are on-stage: say "Until this storm dies down, until the danger of winds and lightning have passed, you're probably safer staying put." instead. Before stormy behavior when location is Lawn and endgame-dispersing clouds are on-stage and sb-warning-flag is false: now sb-warning-flag is true; say "You pause for a moment before you go, getting a strange feeling that you may never return to this spot. If you want to make any changes, now is the time." instead. sb-warning-flag is a truth state that varies.

Part - The Volcano Slopes

Chapter - Volcano Slopes

The prose name of Volcano Slopes is "the slopes of the volcano". The description of Volcano Slopes is "[volslodesc].". To say volslodesc:
	say "The trees fail entirely at this spot, giving way to ";
	if raining begin; say "smooth dark-brown slopes rising into clouds. Rivulets of rainwater run down the unobstructed terrain, vanishing into a waterlogged [o]thicket[x]. A few clusters of berry [o]bushes[x] dot the slopes. [paragraph break][exits]";
	otherwise; say "[if night]the indistinct black slopes of[otherwise]the smooth brown slopes of[end if] [if Volcano Slopes is unvisited]a tall [o]volcano[x], fortunately quiet at the moment[otherwise]the [o]volcano[x][end if]"; say "[if dawn or sunrise], catching the first rays of the morning sunlight above you[otherwise if twilight], growing vague and indistinct as the light dims and the stars begin to come out above it[end if]. "; say "A few clusters of berry [o]bushes[x] [if morning or midmorning]cast long shadows down slope towards impassable [o]thickets[x][otherwise]ease the transition into more barren terrain above, but the undergrowth twists into an impassable thicket down slope[end if]. [paragraph break][exits]";
	end if.

An impassable thicket is a setpiece in Volcano Slopes. Understand "thickets" as thicket. The description is "Below you can hear the sound of the surf beating against cliffs, but the terrain is too steep and too thick with vegetation to be passable.".
	
The exits text of Volcano Slopes is "[if raining][volcanoexit-rain][otherwise][volcanoexit][end if]". To say volcanoexit: say "You could take an easy but long hike [bw of Rim of Volcano]up to the volcano's [dr]rim[x][if dir] [southeast][end if], or return [bw of Big Tree]to the [dr]forest[x][if dir] to the [north][end if]". To say volcanoexit-rain: say "The slopes head [up] into clouds, or you can retreat into the relative shelter of the [dr]forest[x][if dir] [north][end if]". Understand "forest" as north when location is Volcano Slopes.

Report going from Volcano Slopes to Big Tree: say "You pass back into the [if night or twilight or dawn or raining]darkened[otherwise]dimmer[end if] spaces under the trees." Report going from Volcano Slopes to Rim of Volcano: say "The slope is steep but lack of obstacles makes it a relatively easy climb. [if midmorning or midday or afternoon and not raining]Sweltering in the heat of the sun[otherwise if night or dawn or twilight]Moving quickly in the cool air[otherwise]Stopping occasionally to catch your breath[end if], you [if raining]pass through layers of mist of various thickness, rain not falling so much as coalescing out of the air to cling to you[otherwise]rise quickly up the slope until at last you stand atop the volcano, on the lip of the caldera[end if]."; pass 10 minutes of time.

Slopes-stuff is stuff in Volcano Slopes. Understand "undergrowth/barren/terrain/transition" as slopes-stuff when location is Volcano Slopes.

Chapter - Sloping Meadow

The prose name of Sloping Meadow is "the sloping meadow near the chasm". The description of Sloping Meadow is "[slopmeddesc].". To say slopmeddesc:
	if longform begin; say "A [if raining or rained]boggy[otherwise]dense[end if] patch of pale green grass marks the boundary of this long, gently sloping meadow. The slope continues rising through barren brownish-grey terrain to your [if former location is Fork]right[otherwise]left[end if] towards the rim of [if Rim of Volcano is unvisited]a good-sized[otherwise]the[end if] [o]volcano[x], dominating the horizon and venting wisps of steam[dot]";
	otherwise if rained and afternoon; say "Tendrils of mist hover motionlessly over the meadow, as if the rain clouds still cling to the flowers enviously[dot]";
	otherwise if morning or midmorning; say "Birds chirp and small creatures scurry through the verdant meadow[dot]";
	otherwise if afternoon or evening; say "Insects drone lazily in the haze of the afternoon, spinning and twirling over the meadow[dot]";
	otherwise if dawn or twilight; say "A single bird call echoes over the meadow, which is otherwise silent and still in the faint light[dot]";
	otherwise; say "Gentle breezes waft a pleasant smell through the rustling grass of the meadow[dot]";
	end if;
	say "Clusters of [o]wildflowers[x] and bushes bearing heavy, deep red [o]berries[x] dot the meadow.[paragraph break][exits]".

The exits text of Sloping Meadow is "[if meadow-path-open is false]You might be able to find your way through thick[else]You could take the way you cleared [bw of Fork]through the[end if] [dr]forest[x][if dir] to the [west][end if], or [etsm2]". To say etsm2: say "go [bw of Chasm Edge]across the meadow to the [dr]edge[x] of the chasm[if dir] to the [east][end if]".

Understand "forest" as west when location is Sloping Meadow.

SlopingMeadow-stuff is stuff in Sloping Meadow. Understand "boundary/tendrils/mist/birds/creatures/small/insects/haze/bird/breezes/landscape" as slopingmeadow-stuff when location is Sloping Meadow.

Report going from Sloping Meadow to Fork: say "[one of]The vegetation gets thicker and denser. You push wildly overgrown fronds and dense stands of bamboo out of your way, until you finally you break out into a familiar spot[or]You leave the tranquil meadow behind and walk back into the trees, following the way you cleared earlier into the forest[stopping]."; now meadow-path-open is true. meadow-path-open is a truth state that varies. Report going from Sloping Meadow to Chasm Edge: say "The grass slowly thins out, giving way to barren black lava flow in strange ripples and mounds. You [if Chasm Edge is unvisited]stop short at a sudden dropoff[otherwise]eventually come to the dropoff again[end if]."

Some berry-bushes are a backdrop. They are in Sloping Meadow, Volcano Slopes, and Cinder Cone. Understand "berry bush" or "berry bushes" or "bush" or "bushes" or "cluster" or "clusters" as berry-bushes. The printed name is "berry bush[if location is not Cinder Cone]es". The description is "Close to the ground but with many wide, gently arcing branches, the [if location is Sloping Meadow]smattering of bushes[otherwise if location is Volcano Slopes]profusion of bushes[otherwise]lone bush[end if] bears many red [o]berries[x], about as wide as your pinky." Instead of attacking or pulling berry-bushes: say "You grasp one of the bushes and try to uproot it, but cut yourself on a sharp twig and are forced to stop." instead.

Some berries are a backdrop. They are in Sloping Meadow, Volcano Slopes, and Cinder Cone. Understand "berry/ripe/plump/red" as some berries. Does the player mean doing something with the berry-bushes: it is unlikely. [prevents "berry" from needing disambiguation] The description of some berries is "The berries are plump, the ripest ones a deep crimson, and give slightly to your touch. A few are greener and harder, but most seem quite ripe[berryhint]." Instead of tasting some berries, try taking some berries. Instead of taking some berries for the first time: say "You pluck a berry from the closest bush and pop it into your mouth. The flavor is remarkable: an almost fizzy quality gives way to a sweet, tropical taste, and crimson juice stains your fingers red."; move red-stain to location. Instead of taking some berries: say "You collect a few more of the delicious berries and enjoy a small meal of them. When you are finished, your fingers have been stained a deep crimson from the thick red berry juice."; move red-stain to location. Instead of tasting some berries, try taking some berries. [Instead of tasting some berries: say "You pick a berry, study it carefully, then carefully bite off a side. Deep red juice leaks from the berry, staining your fingers; but the flavor is remarkable."; move red-stain to location.] Instead of attacking some berries: say "You squish one of the berries between your fingers, releasing a crimson-red juice that stains your fingers."; move red-stain to location. Understand "lick finger" or "lick fingers" as a mistake ("You lick the juicy flavor from your fingers.") when red-stain is in location. 

A red-stain is a set dressing. Understand "stain/finger/crimson/juice" as red-stain. The printed name is "red stain". The description is "Deep crimson.". Instead of tasting red-stain, say "You lick the last of the juice from your fingers.". Instead of touching red-stain, say "It rubs off fairly easily.". Instead of taking red-stain, say "It's just a slight smudge on your finger.".

To say berryhint: if ( time for excitement or story mode ) and Back Room is visited and Jumble is unvisited, say ".[paragraph break]You notice that the color of the berries matches the red band painted on the door in the cabin on the beach".

Some wildflowers are a backdrop. They are in Sloping Meadow, Crater Pond, Forest2, Edge of Ravine, Grassy End, and Egg Room. Understand "flower" or "flowers" or "meadow" or "clusters" or "cluster" or "of" as wildflowers. The description of wildflowers is "The meadow flowers come in shades of yellow, pink, and blue, and sizes from tiny sunbursts to delicate, hand-sized blossoms. They exude a faint but pleasing fragrance of straw and honey.". Instead of taking some wildflowers, say "You bend down and pluck a single [one of]pink[or]cerulean[or]sky-blue[or]yellow[or]yellow-white[at random] blossom, studying the texture and detail of the petals carefully, before finally letting it fall back to the ground." Instead of smelling wildflowers, say "You inhale deeply, getting faint whiffs of sweet lavender and the subtle tang of sea salt.".

Understand "pick [something]" as taking.

Chapter - Rim of Volcano

To say a sentence about the beach: say "The distant surf [if sunup]glimmers in the light of the sun[otherwise]sparkles under the stars[end if]".

To say a phrase about the beach: say "[if midday]and the glimmering curve of the distant beach reflects the sunlight like a mirror[otherwise if sunset or evening]while the sweeping curve of the beach glows pink in the failing sunlight[otherwise if night]and the white sand of the distant beach glows in the [light-source] as if absorbing it[otherwise]and the distant curve of the lagoon's cyan waters beckons temptingly[end if]".

The prose name of Rim of Volcano is "on the rim of the volcano". Understand "rim" as southeast when location is Volcano Slopes. The description of Rim of Volcano is "[rimvolcdesc].". To say rimvolcdesc: 
	if night or raining begin; say "[if night]Under the [light-source], the tropical landscape stretching before you is like something from a storybook. [A sentence about the mountain], while the crater of the volcano looms below you. [A sentence about the beach][otherwise]Inside a cloud on top of a volcano--it's like being in a dream. Rain falls around the rocky ground here at the lip of the volcano, which curves gently away on both sides and vanishes into the mist. Grey tendrils of cloud reach down to mingle with white puffs of steam coming up from the volcano floor, far below[end if].[paragraph break][exits]";
	otherwise; say "[if dawn]Only the faint sounds of lapping surf break the unnatural early morning quiet[otherwise if sunset]The sunset is spectacular from this unobstructed vantage, an orangey-red fire shimmering on the waves and clouds to the west[otherwise if sunup]You shield your eyes from the glare[time-of-day-bit][otherwise]You stand on the very rim of the volcano[time-of-day-bit][end if], and take in the [if Rim of Volcano is unvisited]whole of the island, trying to get your bearings[otherwise]island vista again[end if]. From "; say "up here on the volcano's rim, it's the most striking features that catch your glance. [one of][a sentence about the mountain], [a phrase about the beach][or][A sentence about the beach], [a phrase about the mountain][at random]. The east half of the island is filled with a dense rain [o]forest[x]. Beneath your feet[if dir] to the east[end if], steep slopes curve down to the volcano's "; say "[if sunrise or morning or evening or sunset]shadowed[otherwise if midmorning or midday or afternoon]sunlit[otherwise]indistinct[end if] [o]caldera[x], [one of]where pockets of steam rise amid jumbled rocks and moss[or]where black lava flow stretches from slope to slope[or]where jumbled rocks cause a confusion of lines and angles[in random order]"; say ". There's no getting down that side; [if dir]back [northwest][otherwise][d]back[x] the way you came[end if] is your only option";
	if sunup, say ".[paragraph break]Surrounding the island on all sides is deep blue ocean flecked with dancing whitecaps, broken only by a distant column of [o]steam[x][if dir] to the south[end if] rising from the water, bent by the winds into a vertical cloud slowly merging into the sky";
	end if;
	if volcano sculpture is on-stage, say ".[paragraph break]Rising from the [if raining or rained]muddy [end if]dirt on the very lip of the crater is a magnificent [o]sculpture[x]".
	
The rv-forest-view is a backdrop. It is in Rim of Volcano. Understand "rain forest" or "forest" as rv-forest-view when location is Rim of Volcano. The printed name is "distant rain forest". The description is "The deep greens of the forest fill their side of the island, from low cliffs running along its eastern boundary to the northern slopes of the volcano. At the forest's northern end, a huge ravine separates it from the mountain.[paragraph break]The forest is a mostly level plateau, except for one [o]depression[x] near its eastern side.".

The rv-forest-depression is a backdrop. It is in Rim of Volcano. Understand "depression/glint" as rv-forest-depression. The printed name is "depression". The description is "The deep, circular depression seems unusual in the otherwise relatively level topography of the forest. A faint metallic glint pokes through the thick vegetation. From this great distance you can't make out any further details, or see what's at the bottom.". 

The exits text of Rim of Volcano is "The only exit is back [d]down[x] the outer slope of the volcano".

The distant column of steam is a backdrop in Rim of Volcano. The description is "About halfway to the horizon, the column of steam must foretell some significant geological event taking place under the waves, perhaps the precursor to the dormant volcano's successor.".

The tree4view is a backdrop in Rim of Volcano. Understand "tree" as tree4view. The description is "It's hard to make out much detail from here, but it looks much like the others you've seen."

Report going from Rim of Volcano to Volcano Slopes: say "Taking one last look around, you head back down the volcano[one of], taking giant steps as you let gravity pull you rapidly down to the edge of the forest[or][time-of-day-bit][at random].". 

Instead of entering or climbing the crater proper when location is Rim of Volcano, say "The inner slope of the volcano is just too steep for you to navigate. You'd likely cause a landslide if you tried."

Section - The Volcano Sculpture

The volcano sculpture is a setpiece in Rim of Volcano. Understand "magnificent/blue/crystal/crystalline/material/man/spiral/arms/feet/mud/statue" as the sculpture. The description is "Perched precariously on the very lip of the crater[if sunset or evening], catching the light of the setting sun,[otherwise if sunrise or morning], sparkling in the light of the rising sun,[end if] is a magnificent abstract sculpture carved from some blue crystalline material, a few heads taller than you. It seems to show a stylized man, twisted into a spiral, both arms stretched to the sky as if he is about to take flight. But his feet are hopelessly mired in the mud, and a distorted expression of pain, frustration, and rage is carved into his long, twisted face as he struggles to free himself. [paragraph break]It's remarkably well-done, the work of a master, even, but a thousand minute signs (and, indeed, the subject matter) tell you it wasn't left behind by a Wayfarer. It's good, but not enough.[paragraph break]Carved in the side of the sculpture is an [o]inscription[x]." The printed name of volcano sculpture is "abstract sculpture". Instead of touching the sculpture, say "Running your fingers over the rock, you feel how what would seem to a casual observer to be almost random blows with chisel, crude and cruel, must in fact have been carefully planned and executed for artistic effect. Whoever carved this piece knew what they were doing.". The dream-text of volcano sculpture is "countless copies of the abstract sculpture at the volcano".

The long inscription is a hint-based scrawl in Rim of Volcano with standard message "Poised on the brink, but never to fall: shadow of being, shade of shades...". The secret message is " oh, let my tumbling down reshape the hillsides.". 

The volcano sculpture can be stable, loosened, or precarious. The volcano sculpture is stable. Instead of attacking or pulling the volcano sculpture, try pushing the volcano sculpture. 
	
First report pushing the volcano sculpture:
	if the sculpture is precarious begin;
		say "With a final shove, the sculpture breaks free in a shower of earth from the edge of the volcano. You step back hastily as a chunk of the crater rim breaks away. The sculpture rolls noisily down the inside of the volcano wall, kicking up loose scree and then larger rocks, until a whole landslide is sliding down to the caldera floor below. [paragraph break]When the dust clears, you can see that the steam vents below have been largely covered by the landslide.";
		remove the sculpture from play;
		remove rotting timbers from play;
		now the system power is 30;
		if boiler handle is on-stage begin;
			now boiler handle is overloaded;
			now pressure of red pipe is target pressure of bridge pressure gauge;
			now pressure of blue pipe is target pressure of ropeway pressure gauge;
			now pressure of yellow pipe is target pressure of pyramid pressure gauge;
		end if;			
	otherwise if sculpture is loosened and player-loosened-it is false;
		say "The sculpture, in such a precarious spot to begin with, seems to have shifted in the earthquake; the dirt around its foundation is cracked and weakened. You push against it and with hardly any force it tips forward to a dangerous angle. One more push and it would probably go over the edge.";
		now the sculpture is precarious;
	otherwise if sculpture is loosened;
		say "Straining, you push against the sculpture again. It loosens even further in the muddy soil now, leaning at a dangerous angle. One more push and it would probably go over the edge.";
		now the sculpture is precarious;
	otherwise if didnt rain;
		say "You give the sculpture a good shove[if sculpture is loosened]. It gives a little[otherwise], but the ground at its base seems dry and firmly packed[end if].";
	otherwise;
		say "Trying to find a spot in the wet, slippery moss to brace yourself, you give the statue a solid shove. You can feel it give a little in the muddy ground, loosening its foundation in the earth.";
		now player-loosened-it is true;
		now the sculpture is loosened;
	end if;
	rule succeeds.

player-loosened-it is a truth state that varies. [The tsunami can make this happen for us, in which case we describe things a little differently.]




Part - The Volcano Floor Region

Chapter - The Chasm and Bridge

Section - The Chasm

The lava chasm is a backdrop. It is in Chasm Edge, Chasm Floor, and Jumble. The description is "Though not particularly large, the chasm is deep and wide enough to present a serious navigational problem. Sheer walls of sharp lava rock form the nearly vertical edges; the floor runs [if dir]northwest to southeast[otherwise]towards a jumble of collapsed lava rock in one direction or the volcano's interior in the other[end if]." Does the player mean climbing the lava chasm: it is likely. Instead of entering the lava chasm when location is Chasm Edge and Chasm Edge is westsided and bridge is raised, try entering chasm-ebridge. Instead of entering the lava chasm when location is Chasm Edge and Chasm Edge is eastsided and bridge is raised, try entering chasm-wbridge. Instead of entering the lava chasm when location is Chasm Edge and Chasm Edge is eastsided and bridge is lowered, try going down. Instead of entering the lava chasm when location is Chasm Edge, try going down. Instead of entering the lava chasm when location is Chasm Floor, try going up. Instead of climbing the lava chasm when location is Chasm Edge, try going down. Instead of climbing the lava chasm, try going up. Instead of entering the lava chasm when location is Chasm Floor and bridge is lowered, try going up. Instead of touching the lava chasm, say "The edges of the chasm are composed of sheer walls of razor-sharp lava rock." Instead of crossing lava chasm, try entering lava chasm. Understand "across" as northeast when location is Chasm Edge and Chasm Edge is westsided. Understand "across" as west when location is Chasm Edge and Chasm Edge is eastsided.

Understand "rockslide" as northeast when location is Chasm Edge. Understand "meadow" as west when location is Chasm Edge. Understand "edge" as east when location is Sloping Meadow. Understand "edge" as southwest when location is Rockslide. Understand "meadow" as east when location is Fork.

chasm-jump-try is a number that varies. chasm-jump-try is 0.  

Instead of leaping when location is chasm edge, try jumping.

Instead of jumping when location is Chasm Edge:
	if South Beach is unvisited or current episode is Word Day:
		say "It's probably a better idea to explore a little more before you go leaping off of things.";
	else if player is wounded:
		say "It would be too far to jump even if your leg was in perfect shape."; 
	else if the psyche of Progue is emotional or the psyche of Progue is fugue or the psyche of Progue is resolved or Tsunami Sequence is happening:
		say "Perhaps you once could have tried, but by now your body has grown so used to this chasm being impassable that you can't work up the nerve to do it.";
	else if an episode is playing:
		say "You can't work up the nerve just now.";
	else:
		increment chasm-jump-try by 1;
		if chasm-jump-try is 1:
			say "You eye the distance carefully but judge it to be too far. You could try with a running start, but the distance is vast, and the ground is far below.";
		otherwise if chasm-jump-try is 2:
			say "You take a few steps back and a deep breath, then sprint forward before you can think about what you're doing. You shove off the edge of the chasm as hard as you can, and for a brief moment you almost think-- but then you're falling, falling towards the lava rocks below...";
			begin Tending-to-Wounded-Player.

After going in Chasm Edge: now chasm-jump-try is 0; continue the action.


Section - The Bridge/Stairs


The bridge is a backdrop. It is in Chasm Edge and Chasm Floor. The description is "The [if bridge is lowered]stairs are[otherwise]bridge is[end if] made from a series of wooden planks held into shape by taut ropes at foot and hand height[if location is Chasm Edge and Chasm Edge is westsided and bridge is lowered]. They rise from the floor of the chasm below you to its far side, making them inaccessible from here[end if]." Understand "stairs/staircase/plank/planks" as the bridge. The bridge can be raised or lowered. The bridge is raised. Instead of pulling the bridge when the bridge is raised, say "The bridge is already raised." Instead of pushing the bridge when the bridge is lowered, say "The bridge (or staircase, now) is already down." Instead of pulling or pushing the bridge when location is Chasm Edge and Chasm Edge is westsided, say "You can't see any way to do that from here." The printed name of bridge is "plank [if bridge is raised]bridge[otherwise]staircase[end if]". Instead of entering or crossing the bridge, try entering the chasm. Does the player mean doing something to the bridge: it is likely. Instead of climbing the bridge, try entering the bridge. Instead of touching, pulling, taking, or pushing bridge: say "[if Chasm Edge is westsided and bridge is lowered]You can't reach it from here[otherwise]The planks that form it are held tight by guide ropes[end if].".

Instead of leaping bridge, try entering bridge. Check using bridge: try entering bridge instead.

The posts are a backdrop. They are in Chasm Edge and Chasm Floor. Understand "post" or "hole" or "holes" as posts. The description is "The two posts rise to about waist height. They seem featureless except for a pair of notched holes [if bridge is lowered]on either side[otherwise]which the bridge has snapped into[end if].".

Instead of climbing basic-walls when location is Chasm Edge or location is Chasm Floor: try entering the chasm. Instead of climbing crater proper: say "The walls of the volcano are too crumbly and unstable to climb.".

The bridge ropes are a backdrop. Understand "guide/rope/ropes/taut/handrail/handrails/rail/rails" as bridge ropes. They are in Chasm Edge and Chasm Floor. The description is "The ropes hold the structure together[if bridge has been raised], allow for it to transform between bridge and staircase,[end if] and provide handrails.". Instead of pulling, taking, touching or pushing the ropes, say "[if Chasm Edge is westsided and bridge is lowered and location is Chasm Edge]You can't reach them from here[otherwise]The ropes are held taut by some unseen mechanism[end if].". Instead of entering bridge ropes, try entering bridge. Instead of climbing bridge ropes, say "[if Chasm Edge is westsided and bridge is lowered and location is Chasm Edge]The ropes, like the stairs, run from the floor of the chasm to the opposite side; you can't reach them from here.[otherwise]Easier to just use the [bridgeorstairs].". To say bridgeorstairs: if bridge is lowered, say "stairs"; otherwise say "bridge".

Instead of going northeast when location is Chasm Edge, try entering chasm-ebridge. Instead of going west when location is Chasm Edge, try entering chasm-wbridge. Instead of going up when location is Chasm Floor, try entering chasm-stairs. Instead of going down when location is Chasm Edge, try entering chasm-stairs.

First Instead of entering chasm-stairs when location is Chasm Floor and bridge is raised: say "The wooden planks of the bridge are quite a ways above you, and the walls of the chasm are razor-sharp. You don't see any other way up." First Instead of entering  chasm-stairs when location is Chasm Edge and bridge is raised: say "The bridge currently leads across the chasm, the walls of which are too sharp to risk climbing." First instead of entering chasm-ebridge when location is Chasm Edge and Chasm Edge is westsided and bridge is lowered: say "The rough staircase rises from the chasm floor to its far side-- you see no way to access it from here." First Instead of entering chasm-wbridge when location is Chasm Edge and Chasm Edge is eastsided and bridge is lowered: say "The bridge is currently lowered, providing access to the chasm floor but none to its far side." First instead of entering chasm-stairs when location is Chasm Edge and bridge is lowered and Chasm Edge is westsided: say "The rough staircase rises from the chasm floor to its far side-- you see no way to access it from here, and the walls are razor-sharp." 

Check jumping when location is Chasm Floor and bridge is raised: say "You jump, hands stretched out above you, but you still can't reach the swaying planks of the bridge." instead.

Chasm Edge is either westsided or eastsided. Chasm Edge is westsided.

Before going from Sloping Meadow to Chasm Edge: now Chasm Edge is westsided; adjust chasm bridges; continue the action. Before going from Chasm Edge to Sloping Meadow: now cross-bridge-bit is true; now Chasm Edge is westsided; adjust chasm bridges; continue the action.

Before going from Rockslide to Chasm Edge: now Chasm Edge is eastsided; adjust chasm bridges; continue the action.

Before going from Chasm Floor to Chasm Edge: now Chasm Edge is eastsided; adjust chasm bridges; continue the action.  Before going to Chasm Floor: adjust chasm bridges; continue the action. Before going to Rockslide: adjust chasm bridges; continue the action. Before going to Sloping Meadow: adjust chasm bridges; continue the action. Before going from Chasm Edge to Rockslide when Chasm Edge is westsided: now cross-bridge-bit is true. cross-bridge-bit is a truth state that varies.

To adjust chasm bridges:
	if bridge is being debugged, say "// adjust chasm bridges.";
	if bridge is lowered and ( Chasm Edge is eastsided or location is regionally in Frozen Hell or location is regionally in Progue's Domain ) :
		now chasm-stairs is open;
	else:
		now chasm-stairs is closed;
	if bridge is lowered and Chasm Edge is westsided:
		now chasm-ebridge is closed;
	else:
		now chasm-ebridge is open;
	if bridge is lowered and Chasm Edge is eastsided:
		now chasm-wbridge is closed;
		now chasm-ebridge is open;
	else:
		now chasm-wbridge is open.	

Instead of entering chasm-wbridge when chasm-wbridge is closed: say "The stairs are lowered; you can't get to the west side of the chasm.". Instead of entering chasm-ebridge when chasm-ebridge is closed: say ""

Report going from Chasm Edge to Rockslide: say "You [if cross-bridge-bit is true]cross the plank bridge, using the vine handrails for support, and [end if]clamber up onto a field of shifting boulders kissed with green moss and cyan lichens, until you arrive at a viewpoint."; now cross-bridge-bit is false. Report going from Chasm Edge to Sloping Meadow: say "You [if cross-bridge-bit is true]cross over the plank bridge, using the vine handrails for support, and [end if]curve around the slope of the volcano to the grassy meadow[if a random chance of 2 in 3 succeeds][time-of-day-bit][end if]."; now cross-bridge-bit is false. Report going from Chasm Floor to Chasm Edge: say "You climb the steep plank steps, holding to the taut vine handrails for support, and finally step on to the mossy lava flow at the chasm edge." Report going from Chasm Edge to Chasm Floor: say "You hold the taut vine handrails carefully as you step down the steep plank steps to the smooth floor of the chasm beneath."

To decide whether bridge has power: if the pressure of the related pipe of the bridge pressure gauge is at least the target pressure of the bridge pressure gauge, decide yes; decide no.

Definition: a thing is farsided:
	if it is the bridge-control and Chasm Edge is westsided and location is Chasm Edge, decide yes;
	if it is the bridge outlet vent and Chasm Edge is westsided and location is Chasm Edge, decide yes;
	decide no.
	
First Instead of doing anything other than examining or examining by name to a farsided thing: 
	if bridge is raised begin;
		if Chasm Edge is westsided, now Chasm Edge is eastsided;
		otherwise now Chasm Edge is westsided;
		say "(first crossing the bridge)[command clarification break]";
		continue the action;
	otherwise;
		say "You can't reach that from this side of the chasm.";
	end if.

To say bridge state:
	if bridge is raised, say "[if location is Chasm Floor]Well above your head[otherwise]At your feet[end if], a plank [o]bridge[x] crosses the chasm";
	otherwise say "A plank [o]staircase[x] with vine handrails[if location is Chasm Floor] rises [up] from here to the chasm's east side[otherwise if Chasm Edge is eastsided] heads down to the floor of the chasm beneath you[otherwise], inaccessible from here, connects the far side of the chasm to its floor[end if]"; 
	let vol be pressure of the related pipe of the bridge pressure gauge;
	if vol > 0, say ", near [if vol > 20]a high-pressure pillar of steam rising[otherwise if vol > 15]gushing torrents of steam rising[otherwise if vol > 10]clouds of steam rising[otherwise if vol > 5]steam puffing[otherwise if vol > 0]tendrils of steam wafting[end if] from an outlet vent [if location is Chasm Floor]in the chasm wall above your head[else]in the ground[end if]";
	if location is Chasm Edge and Chasm Edge is eastsided begin; say ". A red [o]handle[x] extrudes from a smoothed tree trunk poking up from a hole in the ground";
	otherwise if location is Chasm Floor and Volcano Floor is visited [this is a bit of a cheat, but designed to keep the player from messing with the handle and ruining the red pipe reveal when the adjust the boiler] ; say ". Nearby, a [o]mechanism[x] is visible through a rough window in the chasm wall, connected to a red [o]pipe[x] snaking along the chasm floor, one of several";
	end if.

The distant-bridge is minor scenery in Volcano Floor with printed name "[if bridge is raised]bridge[else]staircase[end if] in the chasm". Understand "bridge/stairs/stair/staircase/plank" as distant-bridge. The description is "[if bridge is raised]The distant bridge spans the chasm[else]The distant stairs rise from the floor of the chasm to its eastern side[end if].". The provoke message is "You need to move back towards the [d]chasm[x] to be close enough to interact with it.". Check following distant-bridge: try following bridge instead.


Section - The Bridge Control

[A tree trunk accessible from both the east top and bottom of the chasm provides an explanation for how the power system works, and allows the player to control the bridge.]

Every turn: if bridge is being debugged, say "**h: [bridge-height of bridge-control] / [if bridge is raised]raised[else]lowered[end if] / [if bridge has power]powered[else]not powered[end if] / [if bridge-control is locked]locked[else]unlocked[end if] / Chasm Edge is [if Chasm Edge is eastsided]eastsided[else]westsided[end if]**".

The bridge-control is a setpiece in Chasm Edge. It has a number called bridge-height. The bridge-height of the bridge-control is -1. It is either locked or unlocked. It is locked. It can be lockable. It is lockable. The description is "[bridge-control-desc].". Understand "tree trunk" or "trunk" or "heavy" or "log" or "pole" or "handle/handles" or "mechanism" as bridge-control. The printed name is "heavy tree trunk". The dream-text of bridge-control is "logs with handles on either end". After going to Chasm Edge: move bridge-control to location; continue the action. After going to Chasm Floor: move bridge-control to location; continue the action. Check touching bridge-control: say "Just plain wood, painted red." instead. Check attacking bridge-control: say "It's solid, sturdy wood; you couldn't do much damage to it without an axe." instead. Instead of vague locking bridge-control, try turning bridge-control. Instead of vague unlocking bridge-control, try turning bridge-control. Instead of vague locking bridge: try turning bridge-control. Instead of vague unlocking bridge: try turning bridge-control.

To say bridge-control-desc:
	say "A heavy tree trunk [if bridge-control is unlocked and bridge has power and bridge-height of bridge-control > 0]rises[else if bridge-control is unlocked and bridge has power]sinks[else]sticks[end if] ";
	if location is Chasm Edge, say "[if bridge-control is unlocked and bridge has power and bridge-height of bridge-control > 0]up from[else if bridge-control is unlocked and bridge has power]down into[else]out of[end if] a hole in the ground near the edge";
	else say "[if bridge-control is unlocked and bridge has power and bridge-height of bridge-control > 0]up into[else if bridge-control is unlocked and bridge has power]down from[else]down from the top of[end if] a man-made hollow in the side of the chasm wall";
	say ". A [o]handle[x] [if location is Chasm Edge]at its top[else]protruding from the side[end if] looks designed to turn it; currently, the handle is [if bridge-control is locked]parallel to the chasm edge[otherwise]at right angles to the chasm edge[end if]";
	say ". Near the chasm is an outflow [o]vent[x][if the pressure of the related pipe of the bridge pressure gauge is 1 and bridge-control is unlocked], emitting nothing[otherwise if the bridge has power and bridge is unlocked], venting steam[end if][if puzzle mode], and a pressure [o]gauge[x][end if]".

Instead of turning bridge-control:
	say "[if bridge has power]You twist the handle and the trunk rotates easily[else]Your grasp the handles and strain, and the trunk slowly rotates[end if] until the handles are [if bridge-control is locked]parallel to the chasm edge[else]at right angles to the chasm edge[end if]. As you do, you feel something [if bridge-control is locked]scrape open[else]lock into place[end if]";
	if bridge-control is locked, now bridge-control is unlocked; else now bridge-control is locked;
	if bridge has power and bridge-control is unlocked, say ". The steam from the outflow vent [if pressure of the related pipe of the bridge pressure gauge is 1]stops flowing[else]decreases a little[end if] and the trunk starts moving";
	if bridge has power and bridge-control is locked, say ". The steam from the outflow vent [if pressure of the related pipe of the bridge pressure gauge is 1]starts wisping out again[else]increases a little[end if] and the trunk stops moving";
	say ".".

Instead of pushing bridge-control:
	if bridge is raised and Chasm Edge is westsided and location is Chasm Edge, say "(first crossing the bridge)[command clarification break]";
	if bridge is lowered and Chasm Edge is westsided, say "You can't reach it from this side of the chasm." instead;
	if bridge-control is locked, say "You push on the handle, but the log does not budge." instead;
	if bridge-height of bridge-control > 0, say "You push against the handle, managing to keep the log stationary for a moment, but pressure starts to build beneath you and finally you're forced to let it go." instead;
	if bridge-height of bridge-control is 0, say "The trunk has sunk almost to the level of the ground; you can't seem to push it any farther down." instead;
	say "You push down on the handle, but the trunk seems to be descending on a pillar of steam, and you can't appreciably make it move faster.".

Instead of pulling bridge-control:
	if bridge is raised and Chasm Edge is westsided and location is Chasm Edge, say "(first crossing the bridge)[command clarification break]";
	if bridge is lowered and Chasm Edge is westsided, say "You can't reach it from this side of the chasm." instead;
	if bridge-control is locked, say "You pull on the handle, but the log does not budge." instead;
	if bridge-height of bridge-control > 0, say "You pull against the handle, but the trunk seems to be rising on a pillar of steam, and you can't lift its massive bulk any faster." instead;
	if bridge-height of bridge-control is 0, say "You pull the handle, but nothing happens. Straining, you pull harder, and at the end of your strength feel the log lift up a tiny amount, but then collapse again when you loosen your grip. It feels as if you are pulling the full weight of the trunk." instead;
	say "You pull against the handle, but the weight of the trunk is just too great; it continues slowly descending on a bed of steam.".

Check taking bridge-control: say "The trunk seems to be attached to some apparatus buried in the ground." instead.
	
[The log sinks gently on a cushion of steam, even when the power's been disabled.]
Every turn when bridge-control is unlocked and bridge-height of bridge-control < 0:
	increase bridge-height of bridge-control by 1;
	if player is in Chasm Edge or player is in Chasm Floor, say "The tree [o]trunk[x] [if location is Chasm Edge and Chasm Edge is westsided]on the far side of the chasm[otherwise if location is Chasm Edge and Chasm Edge is eastsided]near your feet[otherwise if location is Chasm Floor]in the window[end if] [if bridge-height of bridge-control is -3]begins[otherwise]continues[end if] to sink[if bridge-height of bridge-control is 0], finally coming to a stop[grndbit] with a hiss of steam[end if].". To say grndbit: if location is Chasm Edge, say " at ground level".[aar]

[When there's power, the log slowly rises again after sinking.]
Every turn when bridge-control is unlocked and bridge-height of bridge-control > 0 and bridge has power and current episode is not Earthquake and current episode is not Water Works:
	increase bridge-height of bridge-control by 1;
	if player is in Chasm Edge or player is in Chasm Floor, say "The tree [o]trunk[x] [if location is Chasm Edge and Chasm Edge is westsided]on the far side of the chasm[otherwise if location is Chasm Edge and Chasm Edge is eastsided]near your feet[otherwise if location is Chasm Floor]in the window[end if] [if bridge-height of bridge-control is 2]begins[otherwise]continues[end if] to rise[if bridge-height of bridge-control is 5], finally coming to a stop[waistbit] with a hiss of steam[end if].". To say waistbit: if location is Chasm Edge, say " at waist-height".

[When the log has sunk completely, the bridge lowers.]
Every turn when bridge-height of bridge-control is 0 and bridge is raised and bridge-control is unlocked:
	if ambience_on is 1 and player is in Chasm Edge or player is in Chasm Floor or player is in Volcano Floor or player is in Sloping Meadow or player is in Rockslide, say "[if location is not Chasm Floor and location is not Chasm Edge]Off at the chasm you see the bridge lower[else]With creaking sighs, rope whirs through pulleys and the bridge lowers[end if] itself, until finally the last plank snaps into place[if location is Chasm Edge] at the bottom of the ravine[otherwise if location is Chasm Floor] at your feet[end if] and it has become a [o]staircase[x].";
	now the bridge is lowered;
	adjust chasm bridges;
	now bridge-height of bridge-control is 1.

[When the log has risen completely, the bridge rises.]
Every turn when bridge-height of bridge-control is at least 5 and bridge is lowered and bridge-control is unlocked:
	if ambience_on is 1 and player is in Chasm Edge or player is in Chasm Floor or player is in Volcano Floor or player is in Sloping Meadow or player is in Rockslide, say "[if location is not Chasm Floor and location is not Chasm Edge]Off by the chasm you see the staircase raise[else]With creaking sighs, rope whirs through pulleys and the staircase raises[end if] itself, until finally the last plank snaps into place[if location is Chasm Edge] across from you[otherwise if location is Chasm Floor] above your head[end if] and it has become a [o]bridge[x] across the chasm.";
	now the bridge is raised;
	adjust chasm bridges;
	now bridge-height of bridge-control is -4.

The bridge outlet vent is an outflow tube. The bridge outlet vent is part of the bridge-control. The related pipe of the bridge outlet vent is the red pipe.

The bridge pressure gauge is a pressure gauge. The bridge pressure gauge is part of the bridge-control. The target pressure is 1. The related pipe is the red pipe.


Chapter - The Boiler

The brick boiler is a setpiece in Volcano Floor. The description is "Made of wood, it's really just a squat, rectangular box, hot to the touch, directly above the sealed-off steam vent. Three bamboo [o]pipes[x] stick out of one side, snaking their way back down the floor of the [dr]chasm[x][if dir] to the [northwest][end if][bb2].". To say bb2: say "[if puzzle mode], and where each exits the boiler is a small wooden [o]wheel[x]. Each pipe and wheel set is coated with a layer of matching dry, flaking paint: red, blue, and yellow[otherwise]; red, blue, and yellow, they are topped by a wooden [o]handle[x] currently [bh-desc][end if]. Finally, a vertical "; say "[o]tube[x][state of current outflow] is joined to the top of the wood structure via a strange quartz [o][boiler pressure gauge][x].[paragraph break]Painted onto the side of the boiler is a short [o]message[x]". Instead of attacking brick boiler: say "The brick construction is quite sturdy, and you see no way to damage it without tools.". Instead of touching brick boiler: say "The bricks are searing hot to the touch.". The dream-text of brick boiler is "steaming bricks".

The boiler-message is a hint-based scrawl in Volcano Floor with standard message "As long as west chasm stays blocked, should be sufficient power for all." and secret message " could always cause rockslide on western slope to divert more steam". Understand "message" as boiler-message. The printed name is "the message on the boiler".

The system power is a number that varies. The system power is 24. [ Covering the other vent will raise this to 30. ]

The boiler pressure gauge is part of the boiler. Understand "quartz" or "cylinder" or "curious" as the boiler pressure gauge. It is a closed unopenable transparent container. The description is "Only about as tall as your hand, this hollow cylinder seems to have been meticulously carved from a solid piece of quartz, allowing you to see through to the inside. It connects the [o]boiler[x] to an outflow [o]tube[x]. [if current outflow >= 7 and current outflow <= 30]Torrents of steam rush upwards through roiling[otherwise if current outflow >= 1 and current outflow <= 6]Steam bubbles up through boiling[otherwise]All you can see is a tiny pool of standing[end if] water inside the pipe. A series of delicate vertical rings are etched into the quartz, numbered from zero to thirty. 

The [if current outflow is greater than 7]water dances around the number[otherwise]water level is at the number[end if] [current outflow in words]." Does the player mean doing something to the boiler pressure gauge: it is unlikely. [keeps "boiler" from referring to this.] The printed name of boiler pressure gauge is "gauge". 

The boiler outlet is an outflow tube. The boiler outlet is part of the boiler. 

Section - Boiler Pipes

The red pipe is a pipe. It is in Volcano Floor and Chasm Floor. The pressure of the red pipe is 0.

The blue pipe is a pipe. It is in Volcano Floor, Chasm Floor, Jumble, Stumps, and Chairlift Base. The pressure of the blue pipe is 0.

The yellow pipe is a pipe. It is in Volcano Floor, Chasm Floor, Chasm Edge, Edge of Ravine, Ravine Floor, and Observatory Exterior. The pressure of the yellow pipe is 22. 

Noticing-The-Pipe-Crack is a scene. Noticing-The-Pipe-Crack begins when location is Stumps and pressure of the blue pipe > 0 and puzzle mode and we-are-landmark-going is true. Noticing-The-Pipe-Crack ends when Noticing-The-Pipe-Crack begins. When Noticing-The-Pipe-Crack begins: tidy landmark-go; clean up landmark-go. [Since players tend to miss this clue, we'll stop them if they're landmark-going past it.]

First report examining a pipe (called item):
	if item is blue pipe, say "[bluepipedetailmsg].";
	if item is yellow pipe, say "[yellowpipedetailmsg].";
	if item is red pipe, say "[redpipedetailmsg].".

To say bluepipedetailmsg: [Should end without periods because "first report examining a pipe" prints them.]
	if location is Stumps begin;
		if the pressure of the blue pipe is at least 1 and puzzle mode begin;
			say "Underneath the line of moss is an overgrown bamboo pipe half-buried in the ground, flecks of blue paint still clinging to it, coming from the [dr]shack[x] but disappearing into the jumbled lava rock [up] the rise. The steam seems to be venting from a small crack that runs almost an entire body length through this section of the pipe";
			move pipe crack to Stumps;
		otherwise; say "A line of moss, barely noticeable unless you look for it, reveals where the half-buried blue pipe runs between the stumps, coming from the [dr]shack[x] but disappearing into the jumbled lava rock [up] the rise";
		end if;
	otherwise;
		if location is Chasm Floor, say "The blue pipe follows the chasm from the volcano [dr]caldera[x] and vanishes into the [dr]jumble[x] of rocks at its far end";
		if location is Chairlift Base, say "The blue pipe, arriving from the direction of the [dr]stumps[x], emerges from the ground running parallel to it, then twists up ninety degrees at the shack and connects to the ropeway mechanism[if puzzle mode] via a transparent quartz [o]gauge[x][end if]";
		if location is Volcano Floor, say "The blue pipe snakes off from the boiler towards the [dr]chasm[x]";
		if location is Jumble, say "The blue pipe comes from the more open [dr]terrain[x] near the stairs and vanishes into a confusion of boulders";
	end if.

The pipe crack is a set dressing. Understand "small" as pipe crack. The description is "It looks as if some past impact smashed into the pipe at this exposed spot, sending a long crack down in either direction from the point of impact.". Understand "fix [pipe crack]" or "repair [pipe crack]" or "fix [blue pipe]" or "repair [blue pipe]" as a mistake ("You can't see any way to do so. The high-pressure steam would just burrow straight through any soil you dumped on it, and there isn't even much of that to go around near here."). Instead of attacking the blue pipe, say "That would just make things worse.". Instead of attacking the pipe crack, try attacking the blue pipe.
	
To say redpipedetailmsg:
	if location is Volcano Floor, say "The red pipe snakes off from the boiler towards the [dr]chasm[x]";
	otherwise say "The red pipe comes in from the volcano [dr]caldera[x], bends up to follow the wall, and then disappears into the rock by the mechanism[if puzzle mode]. [gauge-description] marks the join[end if]".
	
To say yellowpipedetailmsg:
	if location is Volcano Floor, say "The yellow pipe snakes off from the boiler towards the [dr]chasm[x]";
	if location is Chasm Floor, say "The yellow pipe arrives from the volcano [dr]caldera[x], then turns ninety degrees and heads straight [up] the side of the ravine, vanishing over the [if dir]eastern [end if]edge";
	if location is Chasm Edge, say "The yellow pipe comes from [down] inside the ravine and vanishes into a cliff near the base of the rockslide";
	if location is Edge of Ravine, say "The yellow pipe emerges from the ground some ways back towards the beehive, then follows the edge of the cliff and plunges straight [down] the side of the ravine";
	if location is Ravine Floor, say "The yellow pipe comes from [up] above, crosses the ravine at about the height of the seventh rung, and then starts running up the side of the mountain, eventually vanishing into a crack";
	if location is Observatory Exterior, say "The yellow pipe snakes up over the side of the mountain and runs into the ground near the [if pyramid is in Observatory Exterior]pyramid[otherwise]chair[end if][if puzzle mode]. Some [o]words[x] are scrawled on its side[end if]".
	
Instead of touching a pipe, say "The [noun] is [if pressure of the noun > 10]scalding hot to the touch and vibrating slightly[otherwise if pressure of the noun > 4]hot to the touch[otherwise if pressure of the noun > 0]warm to the touch[otherwise]cool to the touch[end if]." Instead of listening to a pipe, say "[The noun] [if pressure of the noun > 10]emits an audible roar of white noise[otherwise if pressure of the noun > 4]makes a faint whooshing noise if you put your ear near it[otherwise]is silent[end if]." Instead of taking a pipe: say "The pipe runs parallel to the ground and is embedded into it; you can't pick it up. "; try touching noun.


Section - Boiler Handle (Story Mode)

The boiler handle is a setpiece. [This only exists if we are in story mode; its a simplification of the system. Rather than having to give each element the correct amount of power, we just turn the handle towards the system we want to power.] The boiler handle has a pipe called pipe-position. The pipe-position of the boiler handle is the yellow pipe. The boiler handle can be functional or overloaded. The boiler handle is functional. The description of boiler handle is "It's a rounded length of wood that [if functional]can be turned to point to any of the three pipes, red, yellow, or blue[otherwise]could once be turned to point at any of the three pipes, but now just flops, uselessly[end if].". To say bh-desc: say "[if boiler handle is functional]turned to the [pipe-position of boiler handle][otherwise]tilted at an odd angle; all three pipes are now steaming hot to the touch and hissing[end if]".

Instead of pushing or turning the boiler handle when boiler handle is functional: 
	now saved-pyramid-power is pressure of yellow pipe;
	now saved-bridge-power is pressure of red pipe;
	now pressure of blue pipe is 0;
	now pressure of red pipe is 0;
	now pressure of yellow pipe is 0;
	if pipe-position of boiler handle is yellow pipe begin;
		now pipe-position of boiler handle is red pipe;
		now pressure of red pipe is target pressure of bridge pressure gauge;
	otherwise if pipe-position of boiler handle is red pipe;
		now pipe-position of boiler handle is blue pipe;
		now pressure of blue pipe is target pressure of ropeway pressure gauge;
	otherwise if pipe-position of boiler handle is blue pipe;
		now pipe-position of boiler handle is yellow pipe;
		now pressure of yellow pipe is target pressure of pyramid pressure gauge;
	end if;
	say "You turn the handle so it points towards the [pipe-position of boiler handle].[paragraph break]The pipes groan, and the outflow [o]tube[x] changes[state of current outflow].";
	if the psyche of Progue is resolved or Progue is dead, pipechangeending;
	say pyramidupdate;
	say bridgeupdate.

Instead of pushing or turning the boiler handle: say "Some great pressure seems to have broken something loose underneath the handle; it just turns freely now, without feeling as if it's connected to anything, letting steam flow fully into all three pipes.".

Section - Boiler Wheels (Puzzle Mode)

A wheel is a kind of setpiece. Understand "wheel/wheels" or "number" as a wheel. The description of a wheel is usually "The [noun], marked by now-flaking gritty paint, is exquisitely carved and smoothed from some local wood. Between it and the corresponding pipe, scratched into the wood, [if noun is red wheel]is a single horizontal line[otherwise if noun is blue wheel]are four horizontal lines[otherwise]are twenty-two tiny horizontal lines[end if].". The red wheel is a wheel in Volcano Floor. The blue wheel is a wheel in Volcano Floor. The yellow wheel is a wheel in Volcano Floor. Instead of pushing a wheel, try turning noun. Does the player mean turning a wheel: it is likely. Does the player mean examining a pipe when location is Volcano Floor: it is unlikely. Understand "b" as blue wheel when location is Volcano Floor. Understand "r" as red wheel when location is Volcano Floor. Understand "y" as yellow wheel when location is Volcano Floor. Understand "w" as a wheel when location is Volcano Floor. Does the player mean adjusting a wheel: it is very likely. Instead of adjusting the red pipe when location is Volcano Floor: try adjusting the red wheel. Instead of adjusting the yellow pipe when location is Volcano Floor: try adjusting the yellow wheel. Instead of adjusting the blue pipe when location is Volcano Floor: try adjusting the blue wheel.

Instead of turning a wheel: say "It looks like you can turn it either left or right, and multiple revolutions in either direction.

[as the parser]You can type TURN RED WHEEL 3 RIGHT, for example. For convenience, you could abbreviate this to T RED 3 R[as normal].".

left is a thing. right is a thing. Understand "l" as left. Understand "r" as right.

Adjusting is an action applying to one thing and one topic. Understand "turn [something] [text]" as adjusting when location is Volcano Floor. Understand "t [something] [text]" as adjusting when location is Volcano Floor. Does the player mean adjusting a wheel: it is very likely.

The third noun is a thing which varies. Blankblank is a thing. The num noun is a number that varies.

Check adjusting:
	let temp be the noun;
	change the num noun to -1;
	if the topic understood includes "[number]" begin; change the num noun to the number understood; end if;
	if the player's command includes "hleft/l" begin; change the third noun to left; end if;
	if the player's command includes "hright/r" begin; change the third noun to right; end if;
	if third noun is not left and third noun is not right begin; say "(left)[line break]"; change the third noun to left; end if;
	if num noun is -1, now num noun is 1;
	change the noun to temp.

To say absolute value of (xnum - a number):
	if xnum < 0, now xnum is xnum * -1;
	say "[xnum in words]".
	
Check adjusting:
	if noun is not a wheel, try turning noun instead.
[	if the second noun is not a number or the third noun is not a handedness, try turning noun instead;]
[	if the second noun is not a number, try turning noun instead;]

To say boilerupdate:
	say ".[paragraph break]You glance at the tube[state of current outflow] now";
	if saved-pyramid-power is 0 and pressure of the yellow pipe > 0, say ". The yellow pipe hisses and begins to heat up";
	if saved-pyramid-power > 0 and pressure of the yellow pipe is 0, say ". The yellow pipe ticks and pops as it starts cooling down";
	if saved-ropeway-power is 0 and pressure of the blue pipe > 0, say ". The blue pipe hisses and begins to heat up";
	if saved-ropeway-power > 0 and pressure of the blue pipe is 0, say ". The blue pipe ticks and pops as it starts cooling down";
	if saved-stairs-power is 0 and pressure of the red pipe > 0, say ". The red pipe hisses and begins to heat up";
	if saved-stairs-power > 0 and pressure of the red pipe is 0, say ". The red pipe ticks and pops as it starts cooling down".


Carry out adjusting:
	now saved-pyramid-power is pressure of yellow pipe;
	now saved-ropeway-power is pressure of blue pipe;
	now saved-bridge-power is pressure of red pipe;
	now saved-stairs-power is pressure of red pipe;
	let rotations be num noun;
	if rotations is 0, try touching the noun instead;
	if third noun is left, now rotations is rotations * -1;
	[say "r: [rotations]";]
	if noun is red wheel, let recipient be red pipe;
	if noun is blue wheel, let recipient be blue pipe;
	if noun is yellow wheel, let recipient be yellow pipe;
	[say "***pressure of recipient: [pressure of recipient], current outflow: [current outflow]***"; ]
	if pressure of recipient + rotations < 0: [too far]
		if pressure of recipient is 0, say "You can't seem to turn [the noun] any farther to the left";
		otherwise say "As you turn the [the noun], the volume of steam from the outflow [o]tube[x] steadily increases. However, you only manage to turn it [pressure of recipient in words] time[s] to the left before it will no longer go any farther";
		now pressure of recipient is 0;
	else if pressure of recipient + rotations is 0: [exactly 0]
		say "As you turn the [the noun], the volume of steam from the outflow [o]tube[x] steadily increases. At the end of your last turn is a firm resistance";
		now pressure of recipient is 0;
	else if current outflow - rotations < 0: [using more power than avail.]
		if current outflow is 0, say "Attempts to turn [the noun] farther right produce only a loose, wobbly feeling, as if it's no longer catching on anything";
		otherwise say "You turn [the noun] to the right, causing the volume of steam from the outflow [o]tube[x] to steadily decrease, but after [current outflow in words] revolution[s] the wheel becomes loose and wobbly, as if it's no longer catching on anything";
		now pressure of recipient is pressure of recipient + current outflow;
	else if current outflow - rotations is 0: [exactly everything]
		say "You turn [the noun] [current outflow in words] time[s] to the right. As you stop, the last wisp of steam vanishes from the outflow [o]tube[x] above you";
		now pressure of recipient is pressure of recipient + current outflow;
	else: [ not hitting any boundaries ]
		say "You turn [the noun] [absolute value of rotations] time[s] to the [third noun]. As you do so, the water level inside the [o]gauge[x] slowly [if rotations > 0]drops[otherwise]rises[end if]";
		if current outflow > 0, say " and the steam venting from the outflow [o]tube[x] above you [if rotations > 0]decreases in quantity and pressure[otherwise]increases in volume and speed[end if]";
		otherwise say ", and steam begins to flow from the outflow [o]tube[x] above you";
		now pressure of recipient is pressure of recipient + rotations;
	say "[boilerupdate].";
	if the psyche of Progue is resolved or Progue is dead, pipechangeending;
	say pyramidupdate;
	say bridgeupdate;
	if brick boiler is being debugged, say powersystemstatus.

Does the player mean object-debugging the brick boiler: it is very likely. Instead of object-debugging a pipe, try object-debugging the brick boiler. Instead of object-debugging a wheel, try object-debugging the brick boiler. Instead of object-debugging a pressure gauge, try object-debugging the brick boiler.

Check adjusting when the brick boiler is being debugged: say "[powersystemstatus]"; continue the action. 

To say powersystemstatus: say "// Power system: Blue pipe (ropeway) at [pressure of blue pipe] of [target pressure of ropeway pressure gauge]; Red pipe (bridge) at [pressure of red pipe] of [target pressure of bridge pressure gauge]; Yellow pipe (pyramid) at [pressure of yellow pipe] of [target pressure of pyramid pressure gauge]; Total boiler output at [system power - current outflow] of [system power].". 

To decide what number is the current outflow: [say "([system power]-[pressure of red pipe]r-[pressure of blue pipe]b-[pressure of yellow pipe]y)";] let val1 be system power - pressure of red pipe; let val2 be val1 - pressure of blue pipe; let val3 be val2 - pressure of yellow pipe; decide on val3. 
	
Check pipesetting: if second noun is not a pipe, say "You can only turn it to point to one of the three pipes: red, yellow, and blue." Carry out pipesetting: if second noun is red pipe, now pipe-position of boiler handle is yellow pipe; if second noun is yellow pipe, now pipe-position of boiler handle is blue pipe; if second noun is blue pipe, now pipe-position of boiler handle is red pipe; try pushing boiler handle. Understand "turn [boiler handle] to [a pipe]" or "set [boiler handle] to [a pipe]" as pipesetting. Pipesetting is an action applying to two things. 
						

Section - Boiler Feedback

To say bridgeupdate:
	if saved-bridge-power is 0 and pressure of red pipe > 0 and Rockslide is unvisited, say "[line break]By the chasm, the [if bridge is raised]bridge[else]staircase[end if] shudders once, then subsides.".

saved-pyramid-power is a number that varies. saved-ropeway-power is a number that varies. saved-stairs-power is a number that varies. saved-bridge-power is a number that varies. s-m-pyr-test is a truth state that varies.

To say pyramidupdate:
	if story mode and s-m-pyr-test is false and pressure of red pipe > 0: [To simplify the discovery process in story mode, we pretend the bridge has been "jammed" and the first time power is sent to it, it unlocks and falls. This explains how it can have been up, not falling, and unlocked, a state it normally can't be in.]
		now s-m-pyr-test is true;
		now bridge-control is unlocked;
	let yP be pressure of the yellow pipe;
	let tP be target pressure of the pyramid pressure gauge;
	let sP be saved-pyramid-power;
	if sP is 0 and yP is at least tP: [none to full]
		say "[line break]A deep, subsonic rumbling booms through the ground, resolving into a steady, faint thrum. From atop the distant mountain[mtnex], the [o][distant-pyramid][x] lights up with a [if night]brilliant[else]faint[end if] ruby glow that spills from its seams, sending a faint pink beam straight up into the sky[one of], as if given off by something inside[or][stopping][if night], lighting up the distant mountain summit[end if].";
	else if sP is 0 and yP is at least 1: [none to some]
		say "[line break]From atop the distant mountain[mtnex], the [o][distant-pyramid][x] begins to slowly pulse with a reddish glow, cycling gradually from dimness to full strength[if night], like a beacon in the darkness[end if].";
	else if sP is at least tP and yP is at least 1 and yP is less than tP: [full to some] 
		say "[line break]Some subsonic thrumming beneath your feet you'd hardly been aware of dies away. On the distant mountain[mtnex], the [o][distant-pyramid][x] loses its ruby glow, and instead starts cycling gradually from dimness to crimson and back again.";
	else if sP is at least tP and yP is 0: [full to none]
		say "[line break]Some subsonic thrumming beneath your feet you'd hardly been aware of dies away. On the distant mountain[mtnex], the [o][distant-pyramid][x] loses its ruby glow, which fades away along with the noise completely.";
	else if sP is at least 1 and sP is less than tP and yP is at least tP: [some to full]
		say "[line break]A faint subsonic thrumming ripples through the ground. On the distant mountain[mtnex], the pulsing light coming from the [o][distant-pyramid][x]'s seams suddenly brightens to a [if night]brilliant[else]strong[end if] and constant ruby glow[if night], and a faint pink beam points upward from it into the sky[end if].";
	else if sP is at least 1 and yP is 0: [some to none]
		say "[line break]On the distant mountain[mtnex], the cycling glow from the seams of the [o][distant-pyramid][x] dies away completely.".
	
To say mtnex: say "[one of], whose top you can just see poking above the jumbled end of the chasm[or], whose top pokes above the jumble[or][stopping]".

To say state of (outf - a number): 
	if outf is 0, say ", its outlet vent emitting nothing";
	if outf >= 1 and outf <= 3, say ", venting faint wisps of steam";
	if outf >= 4 and outf <= 7, say ", trickling steady tendrils of steam";
	if outf >= 8 and outf <= 11, say ", emitting clouds of steam";
	if outf >= 12 and outf <= 15, say ", billowing out fast-moving clouds of steam";
	if outf >= 16 and outf <= 19, say ", surging with clouds of expanding steam";	
	if outf >= 20 and outf <= 23, say ", gushing a huge torrent of steam";
	if outf >= 24 and outf <= 27, say ", exploding with a solid column of steam that surges high into the sky";
	if outf >= 28 and outf <= 30, say ", whistling like a kettle and exploding with a solid column of steam that surges high into the sky".
	

Chapter - Jumble

The prose name of Jumble is "the jumble of lava rock". Understand "jumble" as northwest when location is Chasm Floor. The description of Jumble is "[jumbledesc].". To say jumbledesc:
	if night begin; say "It is pitch black.[paragraph break]";
	otherwise;
		say "You stand amidst a confusing jumble of black lava boulders, almost a cave. [if dawn or twilight or sunrise or sunset]Only the faintest light filters down from the jagged crack of sky visible above[otherwise if morning or evening]Light hits the side of the fissure, painting the confusion of rockfall in refracted, fuzzy hues[otherwise if midmorning or afternoon]Light creeps down one side of the fissure, causing an almost painful contrast between the sunlit tips of rock and the shadowed rubble beneath them[otherwise]The sun bridges the jagged crack of sky above, illuminating the bottom of the crack with harsh midday light[end if].[paragraph break]";
	end if;
	say "[exits]"

Check going up when location is regionally in Frozen Hell and location is not Chasm Floor: try climbing basic-walls instead.

The exits text of Jumble is "[jumble_door], while more open [dr]terrain[x][if dir] [southeast][end if] is reachable once you disentangle yourself from the boulders here". Understand "terrain" as southeast when location is Jumble. Understand "room" as lava tunnel door.

To say jumble_door: if lava tunnel door is open, say "An open [d]door[x] covered with cogs and [o]gears[x] leads [if dir][west][otherwise]to the back room of the cabin"; otherwise say "A boarded-over crack in the lava surrounds a closed [o]door[x][if dir] [west][end if] covered with cogs and [o]gears[x]". Understand "shack" as west when location is Jumble. Does the player mean opening a direction: it is very unlikely. Does the player mean closing a direction: it is very unlikely.

The clockwork gears are a setpiece in Jumble. Understand "cogs" or "mechanism" or "relay" or "key" or "notched" or "catch" or "counterweight" as gears. The description is "Studying the mechanism closer in the dim light, you can see how each button is connected to a relay which advances a long narrow key along a notched path, the correct sequence finally tripping a catch which releases the [o]lever[x] and swings a counterweight free. The craftsmanship is very fine."

The lava lever is a setpiece in Jumble. The description is "The lever is connected to a counterweight; pulling it will cause the weight to drop and the door to swing open." Instead of pulling the lever when the lava tunnel door is open, say "The lever is already extended to its full length." Instead of pulling the lever: try opening the lava tunnel door. After opening the lava tunnel door when location is Jumble: say "You pull the lever, which chunks a bolt out of place and releases a counterweight that swings the heavy door slowly open.". After closing the lava tunnel door: say "[if location is Jumble]You push against the heavy door. As it becomes flush with the wall, the lever is pushed back against its surface and the counterweight is raised, until both are locked in place with a tiny clunk[otherwise]You pull heavily on the handle and the door swings to. As it becomes flush with the wall, you feel something clunk fully into place behind it and the door is again closed and locked[end if].".
	
Report going from Jumble to Chasm Floor: say "Picking your way carefully through the sharp and unstable lava rock, the ceiling gradually opens up above you, until you emerge into the bottom of an open chasm leading straight into the volcano." Report going from Jumble to Back Room: say "You step through the door into the interior of the cabin."


Chapter - Chasm Floor

Understand "caldera" as southeast when location is Chasm Floor. Understand "chasm" as northwest when location is Volcano Floor. Chasm Floor is a room. "[if dawn or sunrise or morning]Tendrils of mist swirl lazily above the hardened surface of the lava flow beneath your feet[otherwise if evening or sunset or twilight]Shadows swallow the hardened black lava flow beneath your feet, and you catch your toe on the odd protrusion made nearly invisible in the refracted light[otherwise if night]The black lava flow beneath your feet is nearly invisible under the stars[otherwise]Hardened black lava swirls like waves caught mid-surge beneath your feet[end if][if midday or midmorning], reflecting the blue sky above with buffed black highlights[otherwise if afternoon], radiating heat but not light with a near-physical presence[end if].[paragraph break][bridge state].[paragraph break][exits].". The prose name of Chasm Floor is "the floor of the chasm". 

The exits text of Chasm Floor is "The frozen river winds through a twisted mass of collapsed rockfall, widening [if dir]to the [southeast] [end if]as it approaches the volcano's riven [dr]caldera[x]. [etcmf2]". To say etcmf2: say "[if dir]To the [northwest][otherwise]In the opposite direction[end if] it disappears into a [dr]jumble[x] of cracks and collapsed rockfall[if we are requesting the exits text and bridge is lowered]. A plank staircase rises [up] the side of the chasm[end if]".

Report going from Chasm Floor to Volcano Floor: say "You hike along the steadily widening chasm, past huge fallen boulders and sheets of rock, until you enter the floor of the volcano itself." Report going from Chasm Floor to Jumble: say "You walk back into the crowded cluster of boulders, a labyrinth of broken boulders and lava rock, finally coming to the niche outside the door."

Chasmfloor-stuff is stuff in Chasm Floor. Understand "tendrils/surface/protrusion/waves/highlights/frozen/river/rockfall" as chasmfloor-stuff when location is Chasm Floor.

Chapter - Chasm Edge

The prose name of Chasm Edge is "the edge of the chasm". The description of Chasm Edge is "[chasmedgedesc].". To say chasmedgedesc:
	if longform begin; say "You are standing on [if dir and Chasm Edge is eastsided]the east[otherwise if dir and Chasm Edge is westsided]the west[otherwise]one[end if] side of a large lava [o]chasm[x]. To [if former location is Sloping Meadow]your right[otherwise if former location is Rockslide]your left[otherwise]one side[end if], the chasm widens and merges with the shattered caldera of the [o]volcano[x], while opposite it disappears into a collapsed jumble of rockfall[if Chasm Edge is eastsided]. Across the chasm is a meadow on the slopes of the volcano[end if][dot]";
	otherwise if dawn or twilight; say "The black floor of the [o]chasm[x] below is indistinct in the [if dawn]early[otherwise]darkling[end if] light[dot]"; 
	otherwise if morning; say "A few birds flit warily over the dark interior of the [o]chasm[x], still in shadow[dot]";
	otherwise if midmorning; say "The late morning sun slants lazily over the rippled lava, lighting up [if Chasm Edge is eastsided]the far[otherwise]this[end if] wall of the [o]chasm[x][dot]";
	otherwise if midday; say "The [o]chasm[x] looks less deep in the midday light, which shines down on the black lava rock of its uneven floor[dot]";
	otherwise if afternoon or evening or sunset; say "Radiated heat rises from the black lava [o]chasm[x], hot after a day's soak in the tropical sun[dot]";
	otherwise if night; say "You step cautiously near the edge of the [o]chasm[x], though even in the faint light you make out the knife edge of the dropoff, black on black[dot]";
	end if;
	say "[bridge state].[paragraph break][exits]". 

The exits text of Chasm Edge is "From this side of the chasm, [thissidebit][if bridge is lowered and Chasm Edge is eastsided], or take the stairs [down] into the chasm[otherwise if bridge is raised][bridgeraisedbit][end if]". To say thissidebit: if Chasm Edge is westsided and dir begin; say "the sloping meadow stretches [bw of Sloping Meadow]off to the [west]"; otherwise if Chasm Edge is westsided and not dir; say "the sloping [d]meadow[x] stretches [bw of Sloping Meadow]towards the forest"; otherwise if Chasm Edge is eastsided and dir; say "you can make your way [bw of Rockslide]towards [if Rockslide is visited]the[else]a[end if] rockslide to the [northeast]"; otherwise; say "you can scramble [bw of Rockslide]up towards [if Rockslide is visited]the[else]a[end if] [d]rockslide[x]"; end if. To say bridgeraisedbit: if Chasm Edge is westsided begin; say ", or cross the bridge [bw of Rockslide]towards [if Rockslide is visited]the[else]a[end if] [dr]rockslide[x][if dir] to the [northeast][end if]"; otherwise; say ", or cross the bridge and head [bw of Sloping Meadow]to the [dr]meadow[x][if dir] to the [west][end if]"; end if.

ChasmEdge-stuff is stuff in Chasm Edge. Understand "jumble/rockfall/caldera" as ChasmEdge-stuff when location is Chasm Edge.


Chapter - Volcano Floor


Understand "cone" as southeast when location is Volcano Floor. The prose name of Volcano Floor is "the floor of the volcano". The description of Volcano Floor is "[volcanofloordesc].". To say volcanofloordesc:
	if night, say "A circle of stars above your head marks the rim of the volcano as you look up from inside. [if moonup]Moonlight illuminates an unearthly landscape of steam vents and lava, but most details[otherwise]Details of the volcano floor[end if] are swallowed up by the blackness; all you are sure of is the path back to the [dr]chasm[x][if dir] [northwest][end if]";
	otherwise say "[if midmorning]Sunlight streams over the wall of the crater, rising[otherwise if afternoon and not raining]The sun hovers just above the crater wall, which rises[otherwise]The crater walls rise[end if] all around, but here you stand at the epicenter of some awesome past eruption. The explosion shattered this side of the volcano, sending lava coursing through the chasm[descVolFloor2]". To say descVolFloor2: say " towards the beach and leaving the ground a jumbled mess of [o]cracks[x] and holes, many of which still vent steam. [paragraph break]Nearby[state of current outflow], a wooden [o]boiler[x] straddles a boarded-over vent in the lava, connected to a network of bamboo [o]pipes[x].[paragraph break][exits]". 

VolcanoFloor-stuff is stuff in Volcano Floor. Understand "circle/rim/unearthly/landscape/details/blackness/epicenter/eruption/explosion/side" as VolcanoFloor-stuff when location is Volcano Floor. 
	
The exits text of Volcano Floor is "The [dr]chasm[x][if dir] [northwest][end if] leaves the caldera; notable features within it across the black plain[if dawn or sunrise or morning], still cool in the morning shade,[otherwise if midday or afternoon], reflecting waves of heat,[otherwise if evening or sunset or twilight], still radiating heat,[end if] are [if volcano sculpture is on-stage]a particularly dense [dr]cluster[x] of steam vents[otherwise]a recent [dr]landslide[x][end if][vfex2]". To say vfex2: say "[if dir] [southwest][end if][if sunrise or morning] under a rocky bluff lit up by the rising sun[otherwise if afternoon or evening or sunset], hidden in the shadow of the crater wall,[end if] and a small cinder [dr]cone[x][if dir] [southeast][end if][if evening or sunset] underneath one brightly lit rim of the volcano[otherwise if sunrise or morning or midmorning], hidden in the shadow of the crater wall[end if]". The printed name of Volcano Floor is "Inside the Caldera, At the Collapse". Understand "landslide" or "cluster" as southwest when location is Volcano Floor.

Report going northwest from Volcano Floor: say "You pass out of the caldera and pick your way down into the badlands of the chasm." Report going southeast from Volcano Floor: say "You follow the edge of the caldera wall clockwise, working your way around towards the cinder cone until you stand at its base." Report going southwest from Volcano Floor: say "You walk around the edge of the caldera [if dir]towards the [west] side[otherwise]counterclockwise[end if]"; if volcano sculpture is off-stage, say " towards the new landslide."; otherwise say ", aiming for a point under [if Rim of Volcano is visited]the abstract sculpture[otherwise]something shiny and pointed[end if] on the volcano's rim. You pass more and more steam vents, until you finally arrive in the middle of a dense cluster of them.". 

Some shallow puddles are described set dressing. The initial appearance is "Some shallow puddles of seawater still bake here and there across the caldera floor, remnants of the tsunami's flooding.". The description is "The puddles are hot to the touch and are quickly evaporating in the heat of the sun.". Instead of touching shallow puddles, say "The water is hot.". Instead of tasting shallow puddles, say "Salty.".

A jumbled mess of cracks is a setpiece in Volcano Floor. Understand "hole/holes/crack" as jumbled mess when location is Volcano Floor. The description of mess is "The ground has the strange, uneven look of land that was liquid not so long ago-- years? centuries? eons? Tiny puffs of steam rise here and there, though without nearly the ferocity of the [dr]cluster[x] of vents across the caldera floor." Instead of leaping jumbled mess of cracks, say "Not unless you'd like to be boiled alive.".

The boarded over steam vent is a setpiece in Volcano Floor. Understand "boarded-over" or "sealed-off" or "sealed" as the boarded over steam vent. The description is "This sizable rent in the caldera floor has been completely sealed with carefully carved, interlocking pieces of wood, which would serve to route any rising steam into the [o]boiler[x] at its center.". Instead of opening the boarded over steam vent, say "The boards fit quite tightly, and do not seem to conceal any trapdoors or other movable parts.". Instead of leaping or attacking boarded over steam vent, say "You jump heavily on the boards, but they are quite solid and do not give.". Instead of touching boarded over steam vent, say "The wood is too hot to touch for more than a moment.". The dream-text of boarded over steam vent is "steaming bricks".




Chapter - Steam Vents

The prose name of Steam Vents is "the volcano floor near the steam vents". The description of Steam Vents is "[steamventsdesc].". To say steamventsdesc:
	if volcano sculpture is on-stage begin;
		say "Hot [o]steam[x] swirls around you in waves and curtains from hundreds of [o]holes[x] in the lava, ranging from tiny mouse-holes to chasms big enough to drop a house into. The steam has given an army of grass, mosses and ferns the toehold they need to start to reclaim the lava flow. Loose [o]scree[x] runs up the steep slope of the caldera wall towards ";
		if sunrise or morning or evening or sunset begin;
			say "[distant-sculpture] high above catching the rays of the unseen sun";
		otherwise if midmorning or midday;
			say "[distant-sculpture] high above reflecting the rays of the sun";
		otherwise;
			say "[distant-sculpture] high above";
		end if;
		say " on the rim of the volcano";		
	otherwise;
		say "The landslide has almost completely covered this area with smooth, unsteady sand littered with boulders and lava rock. While a few trickles of [o]steam[x] still push up through the newly disturbed ground, it seems as if the volcano must have found another place to vent its energy";
	end if;
	if volcano sculpture is on-stage, say ".[paragraph break]Splintered, rotting [o]timbers[x] poke out of one nearby chasm, steam swelling their blackened sides";
	say ".[paragraph break][exits]".

Instead of whistling when location is Steam Vents: let atd be indexed text; let atd be the player's command; say "You [atd in lower case] as loud as you can. A few pieces of scree on the slope before you quiver and sand trickles down the slope as the echoes die away, bouncing around the inside of the caldera."

Some rotting timbers are a setpiece in Steam Vents. The description is "It looks as if these boards once sealed this steam vent like the one near the boiler, but some dramatic event, perhaps a boulder tumbling down the interior of the caldera, smashed through the timbers and sent most of them tumbling into the bottomless abyss below. The few warped and twisted boards clinging to the chasm now are useless.". Instead of taking timbers, say "They are beyond repair.". Understand "vent/vents/abyss/board/boards/chasm" as rotting timbers when location is Steam Vents. Understand "block/cover" as "[block]". Understand "[block] vents" as a mistake ("You don't see any materials nearby you could use to do that.") when location is Steam Vents. Check pushing timbers: say "You manage to shove a few more of the rotting board fragments into the steam vent. They go tumbling and clattering down into the heat and blackness." instead. Check pulling timbers: try taking timbers instead. Understand "fix [timbers]" or "repair [timbers]" as a mistake ("Only a few fragments of the original boards remain. You would need lumber and tools to seal this steam vent again.") when location is Steam Vents. Understand "push [timbers] in/into/to chasm/vent/vents" as pushing when location is Steam Vents.

SteamVents-stuff is stuff in Steam Vents. Understand "waves/curtains/army/ray/rays/sand/boulders/trickle/trickles" as SteamVents-stuff when location is Steam Vents.

Check going up when location is Steam Vents: try climbing loose scree instead. 
	
The printed name of Steam Vents is "Inside the Caldera, At the [if volcano sculpture is on-stage]Steam Vents[otherwise]Landslide[end if]". The exits text of Steam Vents is "Elsewhere in the caldera is the [dr]rift[x] [if dir]to the [northeast] [end if]and the cinder [dr]cone[x][if dir] to the [east][end if]". Understand "rift" as northeast when location is Steam Vents.

Report going northeast from Steam Vents: say "You follow the curve of the caldera back around towards the great rift in the wall." Report going east from Steam Vents: say "You follow the curve of the caldera [if dir]along its southern edge [end if]to the base of the cinder cone."

The distant-sculpture is a backdrop in Steam Vents. The printed name is "[if Rim of Volcano is visited]the abstract [o]sculpture[x][otherwise]something [o]shiny[x] and tall[end if]". Understand "sculpture/shiny/tall" as distant-sculpture. The description is "It's well above your head, and you can't see any details from this distance.".

Some steam-vents are a setpiece in Steam Vents. Understand "steam" or "vent" or "vents" or "hole" or "holes" or "hundreds" or "of" or "tiny" or "mouse-hole" or "mouse-holes" or "chasm" or "chasms" as steam-vents. The printed name of steam-vents is "steam vents". The description is "[if volcano sculpture is on-stage]The steam billows continuously from vents of all sizes, so no matter where you stand you're always getting hit by a blast of wet, superheated air. Fortunately there's no smell of sulfur: the clouds of steam are nearly odorless, perhaps even a little sweet[otherwise]Just a few trickles of steam, now[end if]." Instead of touching or taking some steam-vents, try touching steam-itself. Instead of smelling some steam-vents, try smelling steam-itself. Instead of entering steam-vents, say "Sounds like a good way to get baked alive.".

Some loose scree is a setpiece in Steam Vents. Understand "slope" as loose scree. The description is "Millions of tiny black rocks, filled with holes where superheated air bubbled through them, run up the slopes of the caldera at a precarious angle.". Instead of touching or taking scree, say "The aeration has made the rocks surprisingly light." Instead of entering or climbing scree, say "The crater wall quickly steepens-- you wouldn't be able to progress very far without starting an avalanche." Instead of pushing or attacking scree: say "You push against one of the larger rocks in the scree, and immediately a tiny avalanche of pebbles and silt whispers down the slope, coming to rest long seconds later." instead. 

The steam-itself is a backdrop. It is in Steam Vents, Volcano Floor, Chairlift Base, Chasm Floor, Chasm Edge, and Observatory Exterior. The description is "White, wispy, ephemeral." Instead of touching or taking steam-itself: say "The hot, moist air billows over your hand, which feels suddenly cool when you pull it away.". Instead of smelling or tasting steam-itself, say "The steam is almost completely odorless." Understand "steam" or "wisp" or "wisps" as steam-itself. Instead of examining steam-itself when an outflow tube (called source) is enclosed by location: try examining source instead.

Understand "cluster" as west when location is Cinder Cone. Understand "cone" as east when location is Steam Vents. 


Chapter - Cinder Cone

The prose name of Cinder Cone is "the volcano floor near the cinder cone". The printed name of Cinder Cone is "Inside the Caldera, At the Cinder Cone". The description of  Cinder Cone is "[cinderconedesc].". To say cinderconedesc: say "Like a miniature of the volcano proper, the shallow slopes of this brownish-grey cinder [o]cone[x] rise to a summit two or three times your height. Adorning the top of the cone is [windsigh phrase of tree4], branches stretched more vertical than the others as if reaching its way out of the shadowy caldera. [paragraph break]A sandy [o]ledge[x] lies just below the summit of the cinder cone, near a scraggly lone berry [o]bush[x]"; say "[if Tsunami Sequence has ended].[paragraph break]Faint trickles of steam rise from the top of the cinder cone[one of]. You try to remember if they were there before today[or][stopping][end if].[paragraph break][exits]". The exits text of Cinder Cone is "Between the cone and the crater wall is a collapsed [o]sinkhole[x] that [if Volcano Cave is unvisited]seems to lead[otherwise]leads[end if] [d]down[x] into a small cave. [ccex2]". To say ccex2: say "Elsewhere in the caldera is a [dr]cluster[x] of steam vents[if dir] [west][end if] and the chasm [dr]entrance[x][if dir] [northwest][end if]". Understand "entrance" as northwest when location is Cinder Cone.

CinderCone-stuff is stuff in Cinder Cone. Understand "slope/slopes" as CinderCone-stuff when location is Cinder Cone.

The cone proper is an enterable undescribed supporter in Cinder Cone. Understand "miniature/summit" as cone proper. The description is "This small cone marks the brief time, perhaps only weeks, when the volcanic energies of the island were concentrated beneath this one particular point." Understand "cinder" as cone proper. The printed name of cone proper is "cinder cone". Instead of going up in Cinder Cone, try entering cone proper. Instead of climbing cone proper, try entering cone proper. Instead of going down in Cinder Cone when player is on cone proper, try getting off cone proper. After entering the cone proper: say "You walk up the short distance to the tiny summit, providing a panoramic overview of the hellish caldera floor." After getting off the cone proper: say "You walk back down to the caldera floor." The dream-text of cone proper is "miniature science-fair volcanos".

Report going from Cinder Cone to Volcano Floor: say "You follow the curve of the caldera around back to the chasm entrance." Report going from Cinder Cone to Steam Vents: say "You follow the curve of the inner caldera wall into the area of thick steam vents." Report going from Cinder Cone to Volcano Cave: say "You climb down into the collapsed area and approach the cave entrance, which seems to be a half-crumbled lava tube. [if raining]Grateful for some shelter from the downpour[otherwise]Blinking[end if], you step inside into darkness."

The sinkhole is a setpiece in Cinder Cone. Instead of entering or climbing or leaping the sinkhole, try going down. The description is "The sinkhole is almost a mirror of the cinder cone, but concave instead of convex. You can see what looks like a cave entrance [down] at the bottom.".

The crater proper is a backdrop. It is in Volcano Floor, Cinder Cone, Chasm Floor, Rim of Volcano, and Steam Vents. Understand "volcano/wall/walls" as the crater proper. Understand "caldera/rim" as crater proper when location is Rim of Volcano. The description is "[if location is Volcano Floor or location is Cinder Cone or location is Steam Vents]The caldera walls encircle you, except for the shattered gap leading into the chasm[otherwise if location is Chasm Floor]Through the collapsed wall where the chasm meets the crater walls lies the interior, the floor of the caldera[otherwise]The view across the crater rim and down to the smooth black floor of the caldera is fantastic. Wisps of steam rise from points across the floor, mostly concentrated at a point beneath you, while across from here is a small cinder cone[end if].". Instead of leaping the crater proper, say "That would kill you.".

tree4 is a windsigh tree in Cinder Cone.  

The tree4-nook is a nook in Cinder Cone. The printed name is "ledge". Understand "ledge" as tree4-nook. The description is "The flat ledge is just large enough for you to lie down on."  Instead of touching tree4-nook, say "The sand is soft and dry.". First report entering tree4-nook: say "You stretch out on the sandy ledge, wriggling around to get comfortable, and look up. The walls of the caldera form a distant rim around the edges of your peripheral vision." instead. First report getting off when player was on tree4-nook: say "Reluctantly, you rise to your feet again." instead. The sleep message of Cinder Cone is "Surprisingly comfortable on the sandy bed, you drift off into sleep."

The ambience table of Cinder Cone is Table of Cinder Cone ambience.

Table of Cinder Cone ambience
freq		start time	end time	text	table		trigger	flag
common	--		--		--	Table of Windsigh ambience
common	--		--		--	Table of Frozen Hell ambience.

Table of Frozen Hell ambience
freq		start time	end time	text	table		trigger	flag
guaranteed	--		--		"[one of]Wind scours the black floor of the caldera[or]High above the caldera, some black bird circles endlessly on the hot updrafts rising from its steam vents[or]A breath of wind pulls the steam rising from the vents across the caldera into stretched shapes[in random order]."

Chapter - Volcano Cave

The prose name of Volcano Cave is "the cave in the volcano caldera". The description of Volcano Cave is "[volcanocavedesc].". To say volcanocavedesc:
	if night begin; say "It's even darker in here than outside; the black lava swallows any ambient light, surrounding you with featureless blackness. The exit [d]back[x] outside is all you can see";
	otherwise;
		if we are going, say "Your eyes struggle to adjust to the dimmer light. After a moment you start to make out detail. ";
		say "This small tube only goes back a short distance before a collapsed ceiling cuts it off. [exits].[paragraph break]Drawn on the wall are a myriad of overlapping [o]sketches[x]";
	end if.
	
The exits text of Volcano Cave is "The only way out is [if dir]back [up][otherwise][d]back[x][end if] the way you came; the bright daylight that direction reveals only boulders in the sunken pit". Report going from Volcano Cave to Cinder Cone: if night begin; say "You emerge into the light of the [light-source] again."; otherwise if raining; say "You reluctantly step out into the downpour once again."; otherwise; say "Blinking[if midmorning or midday or afternoon] and shielding your eyes[end if], you emerge into the [if sunrise or morning or evening or sunset]bright[otherwise if afternoon or midday or midmorning]intensely bright[end if] light of the sun and climb back out of the collapsed pit."; end if.

The series of sketches is a setpiece in Volcano Cave. Understand "myriad" or "overlapping" or "sketch/tree9/trees" as the series. The description is "There must be a hundred of these simple rock-on-rock drawings along the cave wall. Most of them are countless variations of the [if tree1 is named]windsigh trees[otherwise]ubiquitous withered trees[end if], often overlapping each other multiple times. Though the quality varies from stick figures to quite sophisticated drawings, you would guess they are the work of a single young artist-- or perhaps two-- over time. [paragraph break]Three drawings in particular catch your eye: a crude drawing of two [o]girls[x], a [o]landscape[x] scene, and a complex [o]study[x].". The dream-text of series of sketches is "loose-leaf sheets of paper covered in meaningless scribbles".

The crude drawing of two girls is a setpiece in Volcano Cave. The description is "Though the drawing is basic, the scene is still quite clear: two young girls, holding hands, sneaking through a secret door into a volcano while a larger man, face in hands, seems to be crying, oblivious.". The dream-text of crude drawing is "loose-leaf sheets of paper covered in meaningless scribbles".

The ropeway drawing is a setpiece in Volcano Cave. Understand "landscape" as ropeway drawing. The description is "More sophisticated than the first, this drawing quite clearly shows the island's northern mountain, rising above the marsh. The large man is climbing it, with a thick cable strapped to his back, covered in sweat with a crazed look in his eye. Papers covered in scribbles are falling from him, piling up in stylized mounds on the ground beneath. On the other side of [if Edge of Ravine is unvisited]a great rift[otherwise]the ravine at the forest's edge[end if], drawn very small, are the two girls, watching, backs to the viewer. [paragraph break]Several of the ubiquitous tree drawings overlap this image." The dream-text of ropeway drawing is "loose-leaf sheets of paper covered in meaningless scribbles".

The final drawing is a setpiece in Volcano Cave. Understand "study" as final drawing. The description is "The last drawing is astonishingly good for chalk marks on an uneven surface; better perhaps than you might have believed possible in this medium. Again, something within you tingles; you are sure this is the work of a wayfarer, though not a piece that has been used to travel.[paragraph break]The drawing shows two glowing portals, the light almost swallowing the female figures-- a few years older now, with long black hair stretching down to their waists-- in the act of stepping inside them. One is gone already, only a foot remaining; the other is about to enter. In the center is the broken man, outlined by a portal that does not glow, turning to grab the woman's hand with a terrible look of sadness and desperation on his face. He realizes it is already too late.[paragraph break]At the bottom of the image are two [o]lines[x] of text in a neat, controlled hand.".

The cave-lines are a story-based scrawl in Volcano Cave. Understand "line/lines/text/writing" as cave-lines. The printed name is "two lines of writing". The standard message of cave-lines is "Goodbye, father. May you find your peace again. Lethe.". 

The dream-text of final drawing is "loose-leaf sheets of paper covered in meaningless scribbles".

 Instead of touching a setpiece in Volcano Cave, say "You touch the drawings delicately, imprinting a ghost line of white chalk on your fingertips.".

Part - The West Forest Region

West Forest is a region. Fork, Big Tree, and Treehouse are in West Forest. The ambience table of West Forest is Table of West Forest ambience.

Table of West Forest ambience
freq		start time	end time	text	table		trigger	flag
frequent		--		--		"The distant sounds of surf break faintly through the muffling vegetation."
frequent		morning		evening	"Birds twitter and small creatures scatter through the underbrush."
frequent		morning		evening	"Seagulls circle lazily above your head, their cries echoing faintly through the forest."		--	distant gulls
common	twilight	night	--	Table of Firefly ambience

A stand of bamboo is a backdrop. It is in Fork, Sloping Meadow, Volcano Slopes, and South Beach. The description of a stand of bamboo is "Tall and cylindrical, about as thick as your arm, the bamboo seems to grow in clusters and sways gently in the breeze. The tallest of the bamboo reaches three times your height." Instead of taking the stand of bamboo, say "The bamboo seems to be firmly rooted into the ground." Instead of touching the stand of bamboo, say "The bamboo plant is hard, like solid wood." Instead of pushing or pulling or attacking the stand of bamboo, say "You could probably push some of these over without too much difficulty, but it would take time, effort, and skill to do anything further." Instead of tasting the stand of bamboo, say "You've lived on worlds where they eat bamboo, but this variety seems to be too hard for that." Instead of climbing the stand of bamboo, say "You wrap your hands around a bamboo plant and try to pull yourself up, but it immediately begins to bend under your weight and you give up." 

Some leafy fronds are a backdrop. Fronds are in Fork, Big Tree, Volcano Slopes, and Sloping Meadow. The description of fronds is "All manner of leafy green plants grow out of the mossy earth."

The old path is a seen backdrop. The old path is in Fork, South Beach, Big Tree, and Sloping Meadow. The description of the old path is "The forest has mostly reclaimed it, but you can see where a path was once cut through the trees here: moss-covered stumps and repositioned boulders mark a gently curving line through the vegetation. The path connects the [dr]beach[x] with the [dr]forest[x].".



Table of Windsigh ambience
freq		start time	end time	text	table		trigger	flag
guaranteed		--	--	"[one of]An eerie, multi-tonal hum suddenly swells in time with the wind. Startled, you peer around warily for its source, before finally realizing it comes from wind gusting through the strange holes in [windsigh phrase of a random windsigh tree in location][or][windsighnoise][stopping]."

To say windsighnoise: if location is Egg Room, say "A [one of]high-pitched whine[or]whistle[in random order] whispers through the young windsigh, [one of]an octave higher than the others[or]its tiny holes pushing the tone nearly into the ultrasonic[in random order]"; otherwise say "[one of]Wind gusts through the holes in[or]A whisper of wind funnels through the holes in[or]A sudden blast of wind whips through the holes in[or]Gentle waves of wind channel through the holes in[in random order] [if location is Atop or location is Treehouse]the tree[otherwise][windsigh phrase of a random windsigh tree in location][end if], [one of]the strange multi-tonal song echoing around [the prose name of location][or]overlapping frequencies humming in strange, alien harmonies[or]a soothing, multi-tonal hum[in random order]". 

Chapter - Treehouse

The prose name of Treehouse is "the treehouse". The description of Treehouse is "[treehdesc].". To say treehdesc:
	if longform begin; say "This child-sized house was obviously built with love-- the detailed [o]etchings[x] of flowers along the length of the doorjamb, if nothing else, speak to that-- but the child for whom it was constructed must now be long grown. Greenery overruns every surface, vines and leaves blurring the lines of cut boards and straight railings. The tree has grown, too, tilting the floor and setting the shelves and windows subtly askew[dot]";
	otherwise if night; say "Vines and leaves [if moonup]ride the moonlight piercing the treehouse, like green foam on a frozen wave[otherwise]crawl from the night into the black interior of the treehouse[end if], and the man-made lines and flat surfaces under the greenery almost vanish into indistinctness, as if you stand in some natural hollow in the tree around you[dot]";
	otherwise if raining; say "You are glad to have refuge from the rain under the still-solid eaves; you watch waves of the downpour move through the forest around you[dot]";
	otherwise if sunrise or morning or midmorning; say "Birds take flight as you [if we are going]step inside the treehouse[else]stir[end if], shaking and twirling the vines and leaves as they glow in the warm morning light[dot]";
	otherwise if midday or afternoon; say "Things are cool and quiet in the shade of the treehouse; the vines and overgrowth spill eagerly through the windows as if trying to escape from the heat of the day[dot]";
	otherwise if evening or sunset; say "Sunlight slants into the treehouse, filtered by thousands of lemon-yellow leaves that shimmer faintly in the wind and cast the interior into a warm golden glow[dot]";
	otherwise; say "A lone bird calls from somewhere high in the tree above, like a ghost-cry breaking slowly over the treehouse's indistinct, abandoned interior[dot]";
	end if;
	if Tsunami Sequence has ended, say "One support of the wooden shelf has been shaken loose, and it swings sad and loose; the clockwork [o]head[x] lies near the [o]hammock[x], both seemingly undamaged";
	otherwise say "A small wooden shelf attached to the trunk [if clockwork head is not on shelf]sits gathering dust[otherwise]supports the clockwork [o]head[x][end if], just above a [o][tree2-hammock][x] neatly hung in one corner[if clockwork head is not on shelf]. Something [o]round[x] and wooden lies in a dusty corner underneath it, forgotten[end if]";	
	say ".[paragraph break][exits]".

The printed name of Treehouse is "Inside the Treehouse". The exits text of Treehouse is "The only exit from the one-room treehouse is [down] the rope ladder you came in on".

Report going from Treehouse: say "You grip the leaf-covered lintel and lower yourself onto the rope ladder, quickly descending six or seven rungs to the ground below.".

Instead of climbing or going up in Treehouse, say "You're already up in this tree." Instead of exiting in Treehouse when player is not enclosed by tree2-hammock, try going down.

Check going to Treehouse: move tree2 to Treehouse. Check going to Big Tree: move tree2 to Big Tree.

The detailed etchings are a setpiece in Treehouse. Understand "etching/carving/carvings" as etchings. The description is "Years of rain have softened the carvings, but even so they remain a marvel of craftsmanship. The detail is such that it is hard to tell where the real leaves and vines end and the carvings begin.". Instead of touching detailed etchings, say "You run your hands delicately over the intricate carvings. The craftsmanship is remarkable for so simple a thing.".

The greenery is a setpiece in Treehouse. The description is "Vines and creepers stretch up from both the forest floor below, and the [o]tree[x] itself, encircling the outside and inside walls as if slowly embracing it as part of itself.".

The tree2-hammock is an enterable undescribed container in Treehouse. It is not openable and open. The printed name of tree2-hammock is "hammock". Understand "hammock" as the tree2-hammock. The description is "The carefully twined ropes that make up this hammock must be spaced in a way disagreeable to the otherwise ubiquitous vines, as they have not progressed too far along it. It's tied between the treehouse railing and a thick main branch of the tree, and still seems to be in good shape." Instead of taking the tree2-hammock, say "It's anchored with ropes long since past the time they could be untied." First report entering the tree2-hammock: say "[one of]The hammock is covered with a layer of settled dirt and twisted vines, but after a few minutes of untangling and brushing, you find it still looks surprisingly intact. You sit down gingerly, but the hammock supports your weight just fine[or]You sit on the hammock, the ropes creaking and stretching taut beneath your weight[stopping]. It is surprisingly comfortable." instead. First report getting off when player was on tree2-hammock: say "You stand to your feet again, ducking your head slightly to avoid scraping the roof." instead. Instead of pushing tree2-hammock: say "It rocks gently back and forth.". The dream-text of tree2-hammock is "rolled hammocks". The sleep message of Treehouse is "Stretching out in the comfortable hammock, you soon find yourself drifting into a deep, bottomless sleep.".

A wooden shelf is an undescribed supporter in Treehouse. The description is "The simple shelf, [if Tsunami Sequence has ended]swaying loose from its one remaining support[otherwise]slightly out of plumb[end if], [if shelf supports something]supports [a list of things on the shelf][otherwise]is covered in a faint sheen of dust[end if].". Understand "fix shelf" as a mistake ("You'd like to, but you don't have any of the tools you need.") when location is Treehouse and Tsunami Sequence has ended. Check putting something on wooden shelf: say "At the angle it's slanted out, you doubt anything would stay there." instead.

Treehouse-stuff is stuff in Treehouse. Understand "window/windows" as Treehouse-stuff when location is Treehouse.  Instead of leaping treehouse-stuff: if player is hale begin; say "Standing hunched awkwardly in the tiny doorway, you leap forward with a little thrill and land awkwardly but unhurt on your feet."; move player to Big Tree; otherwise; say "Not with your injured leg."; end if.

Section - The Clockwork Head

The clockwork head is a prop in Treehouse. "[if we have examined the clockwork head]The clockwork head rests on a shelf[otherwise]Something round and wooden lies in a dusty corner, forgotten[end if]." Understand "round" or "wooden" or "something" or "dusty" or "corner" or "smooth" or "carving" or "sculpture" or "skull" as the clockwork head. The description is "[if we have not examined the clockwork head]You reach down, pick up the smooth wooden object -- it's surprisingly heavy -- and turn it around to discover that it's a richly detailed carving of a human head. You place it on a shelf and examine it more carefully. [paragraph break][end if]The head[if we have examined Progue], which bears a passing resemblance to [the Progue],[end if] is expertly carved from some richly-grained wood. [cwhead2].". After examining clockwork head for the first time: move clockwork head to shelf. To say cwhead2: say "Within the eye sockets are two wooden [o]spheres[x][eye description]. [cwhead3]". [To say cwhead3: say "A large wooden key on the back [if we have not switched on the clockwork head]looks like it [end if][cwhead4]". ] To say cwhead3: say "A large wooden [o]key[x] on the back looks like it [cwhead4]". [To say cwhead4: say "can be wound[if we have switched on the clockwork head] to activate some internal mechanism[end if][cwhead5]".] To say cwhead4: say "can be wound to activate some internal mechanism[cwhead5]".  To say cwhead5: say ". Visible joins at [if left ear is part of the clockwork head]each [o]ear[x] indicate they can be turned to rotate the eyes[otherwise]the head's right [o]ear[x] would seem to indicate it can be moved somehow; the left ear, however, is missing[end if]". Rule for printing the name of the clockwork head while listing contents: say "clockwork [o]head[x]".  Instead of attacking the clockwork head: say "You smash it against the side of the treehouse, but other than both surfaces acquiring scuffs and dents, not much else results.". The dream-text of clockwork head is "crates of spare wooden eyes, ears, mouths, and clockwork gears". Instead of pushing the clockwork head: say "You shake it back and forth, but it seems quite solid inside, and all the pieces and gizmos well-attached.". Instead of vague locking or vague unlocking the clockwork head: try turning the large wooden key instead.  Check opening the clockwork head: say "The workmanship is so fine, you see no sign of any seams." instead.

The eyes are part of the clockwork head. Understand "eye" or "hright eye" or "hleft eye" or "sphere" or "spheres/gear/gears/dowel/dowels/socket/mechanism/sockets" as the eyes. The description is "Each eye seems to be an independent sphere within the head; you can see inside the mechanism just enough to see a series of dowels and tiny wooden gears inside. Within the sockets are the two wooden spheres[eye description]." Instead of turning or pushing eyes, say "You don't seem to be able to make the eyes move directly; hidden cogs resist you.".

The eye-symbols are part of the eyes. Understand "symbol/symbols" as eye-symbols. The printed name is "symbols". The description is "Delicately inscribed, they are in some strange language you've never before seen, with graceful curls and arcs.".

The wooden mouth is part of the clockwork head. The description is "While delicately carved, the mouth seems only able to move up and down, incapable of more precise articulation. Inside you can dimly see something round and concave, partially concealing a complex mechanism of many tiny wooden gears and cogs." Instead of opening  or closing wooden mouth: say "You cannot get your fingers in far enough to make it move, and it feels as if the mechanism inside grips it tight, at any rate.".

To say eye description:
	if the reading level of the player is language-knowing begin; 
		say " inscribed with the symbols for '[head consonant][head vowel]'";
	otherwise if the reading level of the player is vowel-knowing;
		say " inscribed with symbols; the left (on the head's right) shows one of the vowels, while the other symbol must be [if left ear is part of the clockwork head]a consonant[else]an 'L'[end if]";
	otherwise;
		say " inscribed with two strange symbols";
	end if.

Instead of touching or taking the clockwork head when we have not examined the clockwork head: try examining the clockwork head. Instead of taking the clockwork head: say "It's surprisingly heavy, and would be difficult to take down the ladder with you. You may as well leave it here." Instead of touching the clockwork head, say "The detail in the sculpture is remarkable, the wood oiled smooth and warm to your touch." Instead of wearing clockwork head: say "It's solid wood; not something you can wear.".

The clockwork head has a number that varies called consonant. The clockwork head has a number that varies called vowel. The consonant of the clockwork head is 7. The vowel of the clockwork head is 3.

To say head consonant:
	let x be the consonant of the clockwork head;
	choose row x in Table of Head Consonants;
	say sound entry.

To say head vowel:
	let x be the vowel of the clockwork head;
	choose row x in Table of Head Vowels;
	say sound entry.

Table of Head Consonants
sound
"B"
"K"
"D"
"F"
"H"
"J"
"L"
"M"
"N"
"P"
"Kw"
"R"
"S"
"Sh"
"Ch"
"T"
"V"
"W"
"Y"
"Z"

Table of Head Vowels
sound
"ah"
"eh"
"ih"
"oh"
"oo"
"uh"
"aay"
"ee"
"y"

A head ear is a kind of thing. Understand "seam" as a head ear. The description of a head ear is usually "The ear is a remarkable carving, all smooth curves and fine detail[if noun is part of the clockwork head]. Where is it joined to the head is a visible seam[one of], as if the ear can be moved somehow[or], where the ear turns to change the symbol on the adjacent eye[stopping][end if].". Instead of pulling a head ear (called earmo): if earmo is part of clockwork head, say "This one seems stuck fast to the head.".

Instead of turning or pushing a head ear: 
	if noun is part of the clockwork head begin;
		say "The ear rotates as you twist it, and the head's [if noun is right ear]right[otherwise]left[end if] eye moves with it, clunking into place centered on another curious symbol. You quickly rotate the ear backwards and forwards and see that there are [if noun is right ear][the number of rows in Table of Head Vowels][otherwise][the number of rows in Table of Head Consonants][end if] unique symbols it can be set to, before returning it to its original position (number [if noun is right ear][vowel of the clockwork head][otherwise][consonant of the clockwork head][end if]).";
		say line break;
		speak as the parser "Try typing SET [if left ear is part of clockwork head]LEFT [end if]EAR TO 5, for example, to move the ear more precisely.";
	otherwise;
		say "The ear is not connected to anything yet.";
	end if.
	
The right ear is a head ear. Understand "hright" as the right ear. The right ear is part of the clockwork head.

The left ear is a head ear. Understand "hleft" as the left ear. The initial appearance of left ear is "Lying on the beach, strewn about with other churned up wreckage and debris, is a small wooden [o]ear[x].". After taking left ear: remove missing-left-ear from play; continue the action. 

The missing-left-ear is an undescribed prop in Treehouse. Understand "hleft ear" or "hleft" as missing-left-ear. Instead of doing anything to missing-left-ear: say "You don't see it anywhere.". 

Instead of using the left ear in Treehouse, try inserting left ear into clockwork head. Instead of putting the left ear on the clockwork head, try inserting left ear into clockwork head. Instead of tying left ear to clockwork head, try inserting left ear into clockwork head. Understand the commands "join" or "reconnect" or "connect" or "reattach" as "attach". Does the player mean tying the left ear to the clockwork head: it is very likely. Does the player mean inserting the left ear into the clockwork head: it is very likely. Understand "push [a head ear] in/into/to [the clockwork head]" as inserting it into. Understand "fix [the clockwork head]" or "repair [the clockwork head]" as using. Instead of using the clockwork head when left ear is held, try inserting left ear into clockwork head.

Instead of inserting left ear into clockwork head:
	move left ear to Treehouse;
	now left ear is part of the clockwork head;
	say "You carefully line the ear up along the head's left side and push gently. The dowel slides into place and catches with a satisfying snick.".

Understand "set [a head ear] to [number]" as headsetting when location is Treehouse or location is Dream-BigTree. Understand "turn [a head ear] to [number]" as headsetting when location is Treehouse or location is Dream-BigTree. Understand "set to [number]" or "set ear" as a mistake ("[as the parser]You need to be explicit: try SET EAR TO 5, for example.") when location is Treehouse or location is Dream-BigTree.

Headsetting is an action with past participle headset, applying to one thing and one number.

Carry out headsetting:
	if noun is the right ear, let q be the number of rows in Table of Head Vowels;
	otherwise let q be the number of rows in Table of Head Consonants;
	if the number understood < 1 or the number understood > q begin; say "There are only [q] possible positions [the noun] can be set to.";
	otherwise if check-right-ear or check-left-ear; say "[The noun] is already set to that symbol.";
	otherwise;
		if the noun is right ear, now the vowel of clockwork head is the number understood;
		otherwise now the consonant of clockwork head is the number understood;
		say "[The noun] turns under your hand, catching at each number, until the head's [if noun is right ear]right[otherwise]left[end if] eye shows the proper symbol.";
	end if.	

To decide whether check-right-ear: if the number understood is the vowel of the clockwork head and the noun is the right ear, decide yes; decide no. To decide whether check-left-ear: if the number understood is the consonant of the clockwork head and the noun is the left ear, decide yes; decide no. Does the player mean doing something to the right ear: it is likely. Does the player mean doing something to the left ear: it is likely.

The large wooden key is part of the clockwork head. Understand "handle" as large wooden key. Instead of turning the clockwork head, try turning the large wooden key. Understand the command "wind" as "turn". The description of large wooden key is "It looks like it winds some mechanism inside the head if you turn it.". Instead of taking or pulling large wooden key, say "It is firmly attached to the mechanism. It looks designed to be turned to wind something inside.".

Head-vowels-learned is a list of numbers that varies. Head-consonants-learned is a list of numbers that varies.

Instead of pulling large wooden key: say "You tug at the key, but it seems firmly attached to the back of the head, useful only for turning.".

Instead of turning or pushing the large wooden key:
	say "You wind the large handle several times, then release it. Whirs and thunks come from inside the head. The wooden mouth opens and closes slightly and lets out a mechanical exhalation that, while crude, is clearly distinguishable as a sound: '[head consonant][head vowel]. [head consonant][head vowel]. [head consonant][head vowel].' Then, wound down, the mouth stops moving and the sound fizzles out.";
	add the vowel of the clockwork head to head-vowels-learned, if absent;
	add the consonant of the clockwork head to head-consonants-learned, if absent;
	if the number of entries in head-consonants-learned is 3 and the reading level of the player is not language-knowing begin;
		say "[line break]Working systematically, you move through each symbol and slowly begin to match the symbols to the sounds. Years of practice learning unfamiliar scripts have made this an easy game. Within a few hours you feel you've gotten a basic mastery of the symbols, and could sound out, if slowly, something simple written in this script.";
		now the reading level of the player is language-knowing;
		[pass 120 minutes of time;]
	end if;
	if the number of entries in head-vowels-learned is 3 and the reading level of the player is uneducated begin;
		say "[line break]One at a time, you move through all the symbols around the right ear. Each one, it would seem, is a different vowel sound; the [if left ear is not part of clockwork head]missing [end if]left ear must be used to change the beginning of the sound to something other than 'L.'";
		[pass 60 minutes of time;]
		if the reading level of the player is uneducated, now the reading level of the player is vowel-knowing;
	end if;
	rule succeeds.

[An unfortunate side effect of Smarter Parser is that if the player types a command related to the head that isn't recognized, it might print an awkward message about how the player doesn't need to refer to body parts. Avoid this.]

The don't act stupid head rule is listed before the stripping body parts rule in the Smarter Parser rules. A smarter parser rule (this is the don't act stupid head rule):
	if location is Treehouse and stripping "(head|eye|eyes|ear|ears|nose)" is fruitful:
		change rejected command to "[word number 1 in rejected command] clockwork".



Chapter - Fork

The prose name of Fork is "the overgrown path". The description of Fork is "[forkdesc].". To say forkdesc: 
	if longform begin; say "Smells of damp earth and a profusion of greenery encircle this half-clearing amidst light forest. Trees encrusted with moss rise from a carpet of grassy, leaf-strewn earth, along with tall stands of bamboo and explosions of delicate fronds[dot]";
	otherwise if sunrise or morning; say "Shafts of sunlight kiss the treetops of the tiny clearing amid a profusion of greenery[dot]";
	otherwise if midmorning or midday; say "Spears of light penetrate the forest, yellow-gold spotlights on the greenery around you, which sways gently in the breeze[dot]"; 
	otherwise if afternoon; say "[if raining]Water dribbles down the fronds and bamboo stands around you, catching in tiny pools of leaves or sinking into the moss and turning it a deep, full green. The smell of rain and wet earth is thick in the air[otherwise if weather state is gathering clouds]Delicate fronds and bamboo sway in the gathering breeze, under the swiftly gathering clouds above[otherwise if rained]Heavy drops of water patter to the mossy earth all around you, pooling in hollows and cupped leaves that hang heavily under the weight[otherwise]The swaying greenery around you seems almost lazy in the warmth of the afternoon light[end if][dot]";
	otherwise if evening or sunset; say "The sinking sun sends tiny spears of [if evening]orange[otherwise]red[end if] light through the holes in [windsigh phrase of tree1], and lights up its thousand lemon-yellow leaves like paper lanterns[dot]";
	otherwise if dawn or twilight; say "Indistinct, shadowless light paints the foliage shades of greenish-grey, softened even further by its gentle swaying in unfelt breezes[dot]";
	otherwise if night; say "[if moonup]Silver shafts touch swaying fronds and tall bamboo patches in this half-clearing, but the deeper forest is hidden in darkness[otherwise]You can smell and hear the foliage around you more than you can see it: the smell of cool earth and growing things, and the sounds of leaf rubbing against leaf[end if][dot]";
	end if;
	say "The clearing is dominated by [windsigh phrase of tree1], vine-wrapped trunk rising from gnarled roots, lemon-yellow leaves springing from sinuous branches. At the base of the tree, a leaf-lined [o]nook[x] curls invitingly between two gnarled roots.[paragraph break][exits]".

Fork-stuff is stuff in Fork. Understand "dew" as Fork-stuff when location is Fork.

The exits text of Fork is "Though long overgrown with moss and concealed by huge fallen leaves, a path was once cut through the vegetation, connecting [if South Beach has not been visited]what looks like a [dr]beach[x] through the trees[otherwise]the [dr]beach[x][end if][if dir] to the [northwest][end if] with [exFork2]". To say exFork2: say "the deeper [dr]forest[x][if dir] to the [south][end if][exFork3]". To say exFork3: if meadow-path-open is true, say ". The way you cleared back to the [dr]meadow[x][if dir] [east] of here[end if] is also open".

The printed name of Fork is "Overgrown Path". Understand "beach" or "blue" as northwest when location is Fork. Understand "deeper" or "forest" as south when location is Fork. 

Check going from Fork to Sloping Meadow when meadow-path-open is false: say "The vegetation is so thick in that direction, you can't see a way through." instead. 

Report going to South Beach from Fork: say "You follow the overgrown path down a slight slope[if sunup] towards a bright open area[end if], picking your way over fallen trees and slippery earth, and finally emerge from the trees on some grassy mounds at the edge of a beach." Report going to Sloping Meadow from Fork: say "Picking your way carefully through the dense vegetation, you climb a bit before the trees begin to thin out and you finally find yourself in a more open area." Report going to Big Tree from Fork: say "Making slow progress, you venture deeper into the forest along the nearly-vanished path, ducking under vines and walking through knee-deep clusters of fallen leaves and dense ground cover[if sunup]. The ground slopes up to your left and down to your right, but you stay relatively level[end if].".

Tree1 is a windsigh tree in Fork. The description of tree1 is "[if tree1 is named]This is the windsigh you painted, which brought you here to begin with[otherwise]It certainly is a curious tree[end if]. [the tree spiel]. [paragraph break]The tree is nothing like the surrounding vegetation, and seems stunted somehow-- though you can't say what creates that impression, with nothing to compare it to.". The printed name of tree1 is "[if tree1 is named]a [o]windsigh[x] tree[otherwise]the strange [o]tree[x] you painted[end if]".

The tree1-nook is a nook in Fork. The printed name is "nook". The description is "It looks like a soft place to curl up in for a nap."  Instead of touching tree1-nook, say "The leaves feel soft and dry.". First report entering tree1-nook: say "You lie down on the bed of leaves, comfortably anchored between the two tree roots, and rest comfortably on your back, looking up into the sea of dancing lemon-yellow leaves above you." instead. First report getting off when player was on tree1-nook: say "Reluctantly, you rise to your feet again." instead. The sleep message of Fork is "Lulled by the rustling of the leaves above and the quiet sigh of the tree, you drift into a deep, bottomless sleep."

The ambience table of Fork is Table of Fork ambience.

Table of Fork ambience
freq		start time	end time	text	table		trigger	flag
common	--		--		--	Table of Windsigh ambience



Chapter - Big Tree

The printed name of Big Tree is "Big Tree, Beneath the Treehouse".

treehouse-in-rain is a truth state that varies.

The prose name of Big Tree is "underneath the treehouse". The description of Big Tree is "[bigtreedesc].". To say bigtreedesc:
	if raining begin; say "[one of][if we are going]As you approach[otherwise]As you step around[end if] the treehouse in the rain, studying its strange curves and patches, you suddenly stop in your tracks. The rain has altered the color and texture of its components, and as it falls and curves around the wooden rafters and beams it accentuates certain details and hides others. You take a step to the left and suddenly you see it.[paragraph break]The treehouse is an achingly beautiful sculpture of a woman's face, drawn and haggard as in the last stages of some long illness which nevertheless cannot hide the charm of her appearance or character. Rain curves around the bulge in the wall that is her cheekbone, trails down the vines of her hair, and glistens in the specks of quartz that are the highlights in her eyes. But only when the light is flattened by overcast clouds, only when the rain soaks into the wood and turns it the hues of her face, and only standing just at the right spot, is she here[or]Rain drizzles through the leaves of [windsigh phrase of tree2] above, dripping in streams off the roof of the sinuous [o]treehouse[x], where the face of the sad, haggard woman once again looks out at you[stopping][dot]"; now treehouse-in-rain is true;	
	otherwise if longform; say "Before you stands [windsigh phrase of tree2], larger than the first one and different in another notable way: a small strange [o]treehouse[x], all curves and strange extrusions, is built in its lower branches, overgrown with moss and vegetation, vines running up and down the sagging rope ladder leading to its covered interior. The ground drops off [if dir]to the west[otherwise]behind the tree[end if], but opposite the forest slopes gently upwards[dot]";
	otherwise if night; say "The forest is thick and black here, the vague shape of the treehouse and vegetation above blocking out the [light-source][dot]";
	otherwise if afternoon and rained; say "Raindrops glisten on the ladder to the [o]treehouse[x], and drip in quiet intervals from the leaves of [windsigh phrase of tree2][dot]";
	otherwise if dawn or twilight; say "Before you, [windsigh phrase of tree2] and its crumbling, undulating [o]treehouse[x] are still in the shadowless grey light[dot]";
	otherwise if morning or midmorning; say "Morning sunlight streams through the curved windows of the [o]treehouse[x], the lemon-yellow leaves of [windsigh phrase of tree2] casting burnt copper shadows on its warped boards[dot]";
	otherwise if midday; say "The angled roof of the wavy [o]treehouse[x] shades the indistinct interior from the beating sun, which sparkles the shimmering leaves of [windsigh phrase of tree2] into amber[dot]";
	otherwise if evening or sunset; say "Silhouetted in the sinking sun's dazzling light, [windsigh phrase of tree2] and its abandoned, warped [o]treehouse[x] wearily await the night[dot]";
	otherwise; say "The curving waves of the [o]treehouse[x], overgrown with moss and vegetation, rests gently in the branches of [windsigh phrase of tree2] above[dot]";
	end if;
	say "[exits]".

The exits text of Big Tree is "The rotting rope ladder leads [up] through the open doorway of the treehouse. The way [bw of Fork][if dir][north] [end if]to the [dr]path[x] is open, and [etbt2]". To say etbt2: say "[if not dir]opposite that [end if]the forest [if Volcano Slopes is unvisited]seems to give[else]gives[end if] way to open [dr]terrain[x] [bw of Volcano Slopes][if dir]to the [south][else]the way you came[end if]". Understand "terrain" as south when location is Big Tree. Understand "path" as north when location is Big Tree.

Report going from Big Tree to Treehouse: say "[if Treehouse has not been visited]You put your hands on the rope ladder, testing your weight gently on rungs woven from vines that look dangerously rotted, but surprisingly the ladder holds your weight easily. [end if]You climb the rope ladder awkwardly[if player is wounded], wincing as you bend your tender leg in unfortunate directions,[end if] and hoist yourself up into the small interior." Report going from Big Tree to Fork: say "Cutting back along the route you found earlier, you wade through the forest undergrowth[if a random chance of 1 in 2 succeeds][time-of-day-bit][end if]." Report going from Big Tree to Volcano Slopes: say "The ground begins to slope up as you push towards the edge of the forest[if a random chance of 1 in 2 succeeds][time-of-day-bit][end if]. Finally, you break through the edge of the trees into a [if sunup]brighter, [end if]more open space."

Tree2 is a windsigh tree in Big Tree. 

The rope ladder is an open implemented door. It is not openable and undescribed. Understand "rotting" as ladder. Instead of climbing rope ladder, try entering rope ladder. The description is "The ladder, expertly weaved long ago from now-brown strands of vine, seems to have suffered years of neglect and exposure to the elements. Fresh vines and moss creep up the sides and along the rungs, and one side has sagged further under the weight." Instead of taking or pulling the rope ladder, say "Ancient knots bind it to the treehouse, and newer strands of green further connect it to ground and tree alike.". The dream-text of rope ladder is "coiled rope ladders".

The treehouse-scenery is a setpiece in Big Tree. The printed name is "treehouse". Understand "treehouse/house/window/windows/interior/doorway/roof" as treehouse-scenery when location is Big Tree. The description is "[if raining]You marvel once again at the incredibly artistry that turns the chaotic design of the treehouse into perfect order under the shadowless light of clouds and the glistening touch of the rain[otherwise]The treehouse is tall and all organic curves and lumps, not a straight line to be seen. The windows are skinny ovals of differing sizes; the roof slopes up here, extrudes outwards there, and is thatched in each spot with wildly differing material. Despite the obvious work that went into its construction, it now seems overgrown and long abandoned, eerie somehow through the negative presence of absent children[end if].". Instead of entering treehouse-scenery, try going up. Instead of attacking treehouse-scenery, say "It seems dilapidated enough already.".

The ambience table of Big Tree is Table of Big Tree ambience.

Table of Big Tree ambience
freq		start time	end time	text	table		trigger	flag
common	--		--		--	Table of Windsigh ambience
uncommon	--		--		"[one of]The rope ladder sways gently in the breeze[or]A small red-grey creature scampers along the roof of the treehouse, peering cautiously down at you for a moment before vanishing into the branches[or]The treehouse creaks as the wind shifts the branches around it[in random order]."




Part - The East Island Region

The ambience table of East Island is Table of Nearby Rain Forest ambience.

The forest-view is a backdrop. It is in East Island and Rain Forest.

To say a sentence about the rain forest:
	if Rockslide is unvisited, say "The view ahead is dominated by a plateau covered in dense rain [o]forest[x], [a phrase about the rain forest]";
	otherwise say "[one of]The rain [o]forest[x] dominates the view, [a phrase about the rain forest][or]The rain [o]forest[x], [a phrase about the rain forest], stretches across this side of the island[at random]".

To say a phrase about the rain forest:
	say "[if raining]green-wet giants disappearing into fog[otherwise if rained]dripping and steaming like some great living creature[otherwise if twilight]slowly vanishing into the arms of the encroaching darkness[otherwise if dawn]silent and still under the half-lit sky[otherwise][patrf2][end if]".

To say patrf2: say "[one of]its interior only a haze of shadows and bird cries from here[or]guarded by great old trees strewn with vines and ferns[in random order]".

Report going from East Island to Rain Forest: say "[one of]You step into the dim rain forest, brushing aside vines and spider webs[or]You step into the dark, moist greenness of the rain forest interior[at random]."

Chapter - The Bees

The dancer bee is an undescribed animal in Hive Interior. Understand "single" or "lone/lead" as dancer bee. The description is "[if the hive bees are watching or hive bees are collecting]The bee performs his strange little dance carefully, with a precision doubtless refined by eons of evolution[otherwise]The dancer bee has vanished back into the rest of the swarm[end if]." Does the player mean doing something to the dancer bee: it is likely.

The swarm of bees are an animal in Hive Interior. Understand "bee" or "handful/red/stripe/stripes/wing/wings" as the swarm of bees. The description is "The bees are unnervingly large, about the size of your fist, with alternating red and cream stripes and fat wings. As you look closer, though, you see they don't appear to have stingers, and at any rate are paying you no attention at all.". Instead of attacking the swarm of bees, say "That probably isn't the smartest idea." Instead of taking or touching the swarm of bees, say "You put your hand near one of the fat creatures. Obligingly, it climbs onto it, quivering its wings every few moments, and does a few complete circuits, before flying off disappointed.". Instead of remembering swarm of bees: say "The main body of the swarm is no longer in sight.". After going to Jumble for the first time: now swarm of bees is seen; continue the action. [So that we can "Remember" them even if we haven't yet examined them.]

The initial appearance of the swarm of bees is "[if not raining and not night][swarmdesc].[end if]".

Instead of object-debugging swarm of bees, try object-debugging beehive. Instead of object-debugging dancer bee, try object-debugging beehive. Instead of object-debugging hive bees, try object-debugging beehive.

To say swarmdesc:
	if location is Hive Room or location is Hive Interior, say "A slowly steady stream of [o]bees[x] flies in and out of the hive through its [o]skylight[x] [if location is Hive Interior]just above your head[otherwise]high above[end if]";
	otherwise say "A swarm of [o]bees[x] mills about the flowers here, delicately gathering nectar".

First report remembering when noun is the swarm of bees: say "They have already vanished from sight." instead.

The bee target is a room that varies. The bee target is Hive Room. The bee dance tracker is a number that varies. The bee dance tracker is 0.

Every turn when the hive bees are asleep and the player is awake and the player is in Lacuna and sunup (this is the wake up the bees rule): now the hive bees are awake; if beehive is being debugged, say "// Bees: waking up.".

After waiting when location is Hive Interior (this is the watching the bees isn't as boring as all that rule): now the time of day is 7 minutes before the time of day; continue the action.

Every turn when the player is awake and the hive bees are awake and the player is in Lacuna and we are not landmark-going (this is the bee plan rule):
	if beehive is being debugged, say "// Bees: follow the bee plan rule.";
	if night begin;
		remove swarm of bees from play;
		now hive bees are asleep;
		stop;
	otherwise if sunset or twilight;
		if swarm of bees are in Hive Interior begin; now hive bees are asleep; if beehive is being debugged, say "// Bees: going to sleep."; stop;
		otherwise; [ tell them it's time to go home ]
			if beehive is being debugged, say "// Bees: heading home because sundown.";
			now hive bees are collecting;
			now counter of hive bees is 99; 
		end if;
	end if;
	increase the counter of the hive bees by 1; 
	if hive bees are hesitating and the counter of the hive bees is at least 2 and a random chance of 2 in 3 succeeds begin; [bees need to pick a plan]
		if beehive is being debugged, say "// Bees: starting to watch (because hive bees are hesitation and counter of hive bees is at least 2 ([counter of the hive bees]) and a random chance of 2 in 3 succeeded).";
		now hive bees are watching;
		if there is a selected of 0 in Table of Bee Dance Recipes begin;
			sort Table of Bee Dance Recipes in selected order;
		otherwise;
			repeat through the Table of Bee Dance Recipes begin; change selected entry to 0; end repeat;
			sort the Table of Bee Dance Recipes in random order;
		end if;	
		choose row 1 in Table of Bee Dance Recipes;
		if beehive is being debugged, say "// Bees: chose [dest entry] as next destination.";
		change the selected entry to 1;		
		now bee target is dest entry;
		now the counter of the hive bees is 0;
	otherwise if hive bees are watching or hive bees are collecting and counter of hive bees < 24; [dancer bee shows his stuff]
		choose row 1 in the Table of Bee Dance Recipes;
		let dancex be 99;
		increase the bee dance tracker by 1;
		let z be the bee dance tracker;
		if z is 1, now dancex is 8;
		if z is 2 and there is a move1 entry, now dancex is move1 entry;
		if z is 3 and there is a move2 entry, now dancex is move2 entry;
		if z is 4 and there is a move3 entry, now dancex is move3 entry;
		if dancex >= 1 and dancex <= 9 begin;
			[now bee dance tracker is 0;]
			if location is Hive Interior begin;
				choose row dancex in the Table of Bee Dances;
				say "[dance move entry].";
				[If this is the last move of the dance, jigger things so we'll see the bees fly off immediately.]
				choose row 1 in the Table of Bee Dance Recipes;
				unless there is a move2 entry begin;
					if z is 2 begin; say line break; now bee dance tracker is 0; end if;
				end unless;
				unless there is a move3 entry begin;
					if z is 3 begin; say line break; now bee dance tracker is 0; end if;
				end unless;
				if z is 4 begin; say line break; now bee dance tracker is 0; end if;
			end if;
		otherwise;
			now bee dance tracker is 0;
			if counter of hive bees > 15, now counter of hive bees is 30;
		end if;
	end if;
	if hive bees are collecting and counter of hive bees is 24 and location is Hive Interior begin;
		say "The empty space disappears in a flash, the dancer bee disappearing back into the crowd.";
	end if;
	if ( hive bees are watching or hive bees are collecting ) and bee dance tracker is 0 and counter of hive bees > 1 and counter of hive bees <= 30 begin;
		if hive bees are watching begin;
			if beehive is being debugged, say "// Bees: starting collecting.";
			now hive bees are collecting;
			now the counter of the hive bees is 0;
		end if;
		if location is in East Island or location is Forest2 or location is Chasm Edge or location is Sloping Meadow or location is Crater Pond or location is Forest3 or location is Egg Room or location is Grassy End, process bee movement; [saves computation time]
		move swarm of bees to bee target; 
	otherwise if hive bees are collecting and the counter of the hive bees >= 25 and ( the counter of the hive bees > 30 or a random chance of 1 in 3 succeeds ) ;
		if beehive is being debugged, say "// Bees: starting hesitating.";
		now hive bees are hesitating;
		now bee dance tracker is 0;
		now the counter of the hive bees is 0;
		if location is in East Island or location is Forest2 or location is Chasm Edge or location is Sloping Meadow or location is Crater Pond or location is Forest3 or location is Egg Room or location is Grassy End, process bee movement; [saves computation time] 
		remove swarm of bees from play;		
		now bee target is Hive Interior;
	end if;
	if beehive is being debugged, say "// Bees: status: swarm in [location of swarm of bees]; counter is [counter of hive bees].".

Table of Bee Dances
num	dance move
1		"[describe dancer] walks a line, holding its wings straight up"
2		"[describe dancer] walks a counter-clockwise circle, holding its wings flat against its body"
3		"[describe dancer] walks a counter-clockwise circle, holding its wings angled downwards"
4		"[describe dancer] walks a counter-clockwise circle, holding its wings angled up"
5		"[describe dancer] walks a line, holding its wings straight down"
6		"[describe dancer] walks a clockwise circle, holding its wings angled down"
7		"[describe dancer] walks a clockwise circle, holding its wings flat against its body"
8		"[one of]The bees milling about the inside of the hive draw back around a single [o]dancer[x] bee, seemingly identical to the rest, in the center of an empty circle. The lone bee quivers in anticipation[or]The bees again make a wide circle around a single [o]dancer[x], who stands still, preparing to dance[stopping]"
9		"[describe dancer] walks a clockwise circle, holdings its wings angled up"

To say describe dancer: say "[one of]The bees have all left a wide empty gap around one [o]dancer[x] bee, seemingly identical to all the rest, who[or][describe dancer2][stopping]". To say describe dancer2: say "The [o]dancer[x] bee".

Table of Bee Dance Recipes
dest					move1		move2		move3		selected
Sloping Meadow		5			6			7			0
Crater Pond			5			3			--			0
Forest2				2			--			--			0
Edge of Ravine		1			--			--			0
Egg Room			2			3			4			0
Grassy End			9			--			--			0



To say lpbmbit: say "[if bees are hesitating and location is Hive Interior], climb industriously through the hole in the ceiling of the beehive, and spread out to all the honeycombs[otherwise if bees are hesitating], and climb industriously into the hive[otherwise if location is Hive Interior]. Meanwhile, others and new arrivals continue milling in a wide circle around the [o]dancer[x] bee, who quivers expectantly[end if]". To say lpbmbit2: say "[if dir]to[otherwise]towards[end if] [if hive bees are hesitating and dir]north[otherwise if hive bees are hesitating and not dir]the chute[otherwise if bee target is Crater Pond and dir]southeast[otherwise if bee target is Crater Pond and not dir]the meadow[otherwise if bee target is Sloping Meadow and dir]southwest[otherwise if bee target is Sloping Meadow and not dir]the chasm[end if]".

To say southorrockslide: say "[if dir]south[otherwise]rockslide[end if]". To say eastorrainforest: say "[if dir]east[otherwise]rain forest[end if]". To say northwestorgap: say "[if dir]northwest[otherwise]gap in the lava flow[end if]".

To say beesl: say "bees ([if hive bees are asleep]asl[otherwise]aw[end if]): [if hive bees are dormant]dormant[otherwise if hive bees are hesitating]hesitating[otherwise if hive bees are watching]watching[otherwise if hive bees are collecting]collecting[end if]; bdt:[bee dance tracker]; c:[counter of hive bees]; swrm:[location of swarm of bees]; targ:[bee target]".
		
To process bee movement:
	[ if this routine is running, there's a possibility we may witness some bee movement. 
	If we're in the Hive Room, deal with that.
	If the bees are returning to the Hive, deal with that.
	If we're in the location the bees are arriving in, deal with that.
	Otherwise, determine if our location is along the flight path of bees.
		If so, print a description mentioning where they're coming from and going to.]
	if ambience_on is 0, stop; [ Don't print bee descriptions while the player is napping.]
	if beehive is being debugged, say "// Bees: process bee movement.";
	if location is Hive Interior or location is Hive Room begin; [ If we're in the Hive Room, deal with that.]
		say "[if location is Hive Interior and swarm of bees is in location]The dancer bee stops its strange dance. A number of bees immediately take flight and fly off towards the[otherwise if swarm of bees is in location]A [o]swarm[x] of bees in the hive take wing and fly out the hole in the top. They do a graceful arc in the air and zoom off towards the[otherwise if hive bees are collecting]A [o]handful[x] of bees emerge from the hive and fly off towards the[otherwise]A [o]swarm[x] of bees arrives from the[end if] "; say "[if bee target is Sloping Meadow or bee target is Crater Pond][southorrockslide][otherwise if bee target is Forest2 or bee target is Egg Room][eastorrainforest][otherwise if bee target is Grassy End][northwestorgap][otherwise if dir]north[otherwise]edge of the ravine[end if][lpbmbit].";
	otherwise if swarm of bees is in location; [If the bees are returning to the Hive]
		if hive bees are collecting begin; say "A few new [o]bees[x] arrive and land gracefully on empty flowers, while others depart and fly off ";
		otherwise; say "[one of]One by one, the [o]swarm[x] of bees rise from their flowers and fly off[or]First in ones and twos, and then all at once, the [o]swarm[x] of bees lift off from their flowers and fly off[at random] "; [move bee-ghost to location;] end if;
		say "[if dir]to[otherwise]towards[end if] [bee exit desc].";
	otherwise if location is bee target; [If we're in the location the bees are arriving in.]
		if hive bees are collecting, say "A [o]handful[x] of bees trickle in from ";
		otherwise say "A [o]swarm[x] of bees arrives from ";
		say "[bee exit desc]";
		say ", and settle gracefully on the wildflowers.";
	otherwise; [Otherwise, determine if our location is along the flight path of bees.]
		if ( location is Chasm Edge and bee target is Sloping Meadow ) or ( location is Rockslide and bee target is Sloping Meadow ) or ( location is Rockslide and bee target is Crater Pond ) or ( location is Forest2 and bee target is Egg Room ) or ( location is Forest3 and bee target is Egg Room ) , say "From somewhere overhead you hear the vague drone of bees zipping through the air.";
	end if.



To say bee exit desc: 	say "[if location is Egg Room]the way out of the crater[otherwise if location is Crater Pond and dir]the northwest[otherwise if location is Crater Pond]the rockslide[otherwise if location is Sloping Meadow and dir]the east[otherwise if location is Sloping Meadow]the chasm[otherwise if location is Grassy End]the hive[end if][bedesc2]". To say bedesc2: say "[if location is Forest2 and dir]the west[otherwise if location is Forest2]the edge of the forest[otherwise if location is Edge of Ravine and dir]the south[otherwise if location is Edge of Ravine]the hive[otherwise if location is Grassy End and dir] to the southeast[end if]".

To say random bee noun: say "[if hive bees are collecting][beefewnoun][otherwise][beeswarmnoun][end if]". To say beeswarmnoun: say "[one of]A [o]swarm[x] of bulbous red bees[or]With a chest-vibrating zoom, a [o]swarm[x] of bees[or]A [o]swarm[x] of huge red bees, lazily dipping and swaying,[at random]". To say beefewnoun: say "[one of]A small group of huge red [o]bees[x][or]A pair of oversized [o]bees[x][or]A cluster of melon-sized [o]bees[x][at random]".

To say random bee verb: say "[one of]comes flying through the air[or]flies past[or]flies by[or]zips through[or]passes through[at random]".


Section - Following the Bees

[Since following the bees is an important puzzle, we want to respond to any possible attempts to follow them. The swarm is off-stage when the bees are not "at" a certain location; in this case, if the player is not near the Hive, we can simply move them one room towards it. The behavior is identical if the swarm is on-stage and the player is in its location. If the swarm is on-stage and we're near the hive, we also move one room towards their location, but after that we can only print a message like "You can't tell where the bees went from here." (Since otherwise they could just follow the swarm straight to the Egg without having to solve the puzzle.) If the player tries to follow bees when none of the above conditions are true (maybe because of the ambient message about a swarm of bees passing overhead, gently refuse. ]

[
Who are we following?
Near hive & swarm onstage: swarm.
Near Hive & swarm offstage: hive bees.
Near swarm & swarm onstage: hive bees.
Near neither and swarm onstage: "not sure."
Near neither and swarm offstage: hive bees.
]

Does the player mean following swarm of bees: it is likely. Instead of following hive bees, try following swarm of bees.

First check following swarm of bees:
	let target be UnRoom;
	if swarm of bees is off-stage:
		if location is Hive Interior or location is Hive Room, say "The bees seem to have climbed inside the hive." instead;
		if location is not regionally in Lacuna, say "You're not sure where they went." instead;
		now target is Hive Room;
	else:
		if location is Hive Interior:
			say "(first getting off the beehive)[command clarification break]";
			move player to Hive Room, without printing a room description;
		if location is Hive Room:
			say "You head off in the direction the bees went[if location of swarm of bees is not adjacent to Hive Room], but you've already lost sight of them[end if].";
			now target is location of swarm of bees;
		else if location is location of swarm of bees:
			say "You head off in the direction the bees flew[if location of swarm of bees is not adjacent to Hive Room], but you've already lost sight of them[end if].";
			now target is Hive Room;
		else:
			say "You're not sure where the bees went from here." instead;
	if target is UnRoom, say "You're not sure where the bees went from here." instead;
	let way be the best route from location to target;
	if way is a direction, try going way instead;
	else say "You're not sure how to get there from here." instead.


Chapter - Rockslide

The prose name of Rockslide is "the boulder pile". Understand "pond" as southeast when location is Rockslide. The printed name of Rockslide is "Boulder Pile".

The description of Rockslide is "[rockslidedesc].". To say rockslidedesc:
	if longform begin; say "Moss and soil glue together this field of tumbled boulders, the crumbling end of a long arm of the island's northern mountain. Here at the one flat spot in the ancient rockslide you can see the whole eastern half of the island, almost entirely covered in impenetrable rain forest[dot]";
	otherwise if raining; say "Stepping carefully on the rain-slicked rock, you pause atop the boulder field to survey the mist-shrouded view of the rain forest[dot]";
	otherwise if night; say "Dim boulders loom on all sides in the [if moonup]moonlit[otherwise]shadowless[end if] night, and you step carefully over the treacherous hill[dot]";
	otherwise if sunrise or morning; say "Moss and tufts of grass drink in the morning light, in patches of dirt that have settled on the boulder field to start the long process of reclamation[dot]";
	otherwise if evening or sunset; say "The boulder field and the rain forest ahead lie in evening shadows, quiet under the coloring sky[dot]";
	otherwise if twilight; say "Small rodents scurry from your footsteps in the failing light to secret hiding places beneath the boulders[dot]";
	otherwise; say "[one of]You stand unsteadily atop a lichen-draped boulder, surveying the view[or]The boulders sigh as wind gusts gently over the rockslide, slipping smoothly between the cracks and hole[or]The boulders bake in the light of the sun, casting dark and sharp-edged shadows on the thousands of tiny caves and hollows beneath them[in random order]. [A sentence about the rain forest][dot]";
	end if;
	say "Clinging tenaciously to a rocky boulder is [windsigh phrase of tree7], a mossy [o]hollow[x] cradled in its roots.[paragraph break][exits]".

The exits text of Rockslide is "The boulder field descends [bw of Hive Room]into a wide [dr]chute[x] running [if dir][north] [end if]along the edge of the rain forest. You could also make a trickier descent [bw of Crater Pond][if dir][southeast] [end if]to a small [etrs2]". To say etrs2: say "[dr]pond[x], or return [if dir][southwest] [otherwise if former location is Chasm Edge]back the way you came [end if]towards the chasm's [dr]edge[x]". Understand "chute" as north when location is Rockslide.

Rockslide-stuff is stuff in Rockslide. Understand "boulder/boulders/patch/patches/rockslide/field" as Rockslide-stuff when location is Rockslide.

Instead of going down in Rockslide, say "From this vantage point, there are several ways down; you'll have to specify. [exits]." Report going to Chasm Edge from Rockslide: say "[descendtheboulders][if a random chance of 1 in 2 succeeds][time-of-day-bit],[end if] until you come to the edge of the chasm once again." Report going to Hive Room from Rockslide: say "[rockslideposttsum][descendtheboulders] till you enter the chute. Picking up speed, you follow the narrow swath of flat ground between the jagged rift on your left and the rain forest on your right." Report going from Rockslide to Crater Pond: say "[rockslideposttsum][descendtheboulders], and finally reach the bottom.". 

To say descendtheboulders: say "[if raining]You place your feet extremely carefully on the rain-slicked boulders[otherwise if night]Moving slowly, more by feel than sight, you work your way down the boulder field[otherwise][one of]You carefully work through the boulder field[or]Hopping lightly from one boulder to the next, you descend the boulder field[or]Descending carefully down the steep slope of the boulder field, flinching every time a boulder moves under your feet, you finally make it to more stable ground[in random order][end if]".

To say rockslideposttsum: if Tsunami Sequence has ended, say "[one of]Stepping forward, your ankle suddenly twists under you as a boulder shifts. Stumbling forward onto another boulder with a surge of adrenaline, you twist aside as the massive rock you first landed on rolls and tumbles down the pile, picking up a few other smaller rocks as it goes. It seems the slide hasn't quite restabilized itself after the earthquake yet.[paragraph break][or][stopping]".

tree7 is a windsigh tree in Rockslide.

The tree7-nook is a nook in Rockslide. The printed name is "mossy hollow". Understand "mossy/hollow" as tree7-nook. The description is "The hollow would be the one flat and stable place to lie down here in the midst of the rockslide."  Instead of touching tree7-nook, say "The moss is soft and dry.". First report entering tree7-nook: say "You lie down in the mossy hollow. It's a little short for you to fully stretch out, but you feel snug and surprisingly secure cradled in its arms." instead. First report getting off when player was on tree7-nook: say "You extract yourself from the mossy hollow, stretching sore muscles." instead. The sleep message of Rockslide is "Lulled by the rustling of the leaves above and the quiet sigh of the tree, you drift into a deep, bottomless sleep."


The ambience table of Rockslide is Table of Rockslide ambience.

Table of Rockslide ambience
freq		start time	end time	text	table		trigger	flag
frequent		evening		twilight		"[one of]A tiny chirp echoes from somewhere in the rock pile, as some small creature scurries away under cover[or]Tiny peeps and the scrabbling of small creatures come from somewhere under the rock pile[or]A little mouse-like creature scampers up to a nearby boulder, watching you intently for a moment, before diving back into a tiny hole in the rock[in random order]."		--	mouse	--
common	--		--		--	Table of Windsigh ambience

A mouse is a set dressing. Understand "creature/creatures" as mouse. The description is "The little mouse-like creature has already vanished back into the dark labyrinth beneath the boulder pile."


Chapter - Grassy End

Report going from Hive Room to Grassy End: say "Slipping into the narrow crack in the lava, you pass back into a secluded circular amphitheater surrounded by sheer black rock walls.". Report going from Grassy End to Hive Room: say "You slip back through the crack[if a random chance of 1 in 2 succeeds][time-of-day-bit][end if].". 

The description of Grassy End is "[graenddesc].". To say graenddesc:
	if longform begin; say "Tufts of grass and a profusion of flowers carpet the floor of this circular amphitheater, perhaps the remnants of a lava tube with a long-collapsed ceiling[dot]";
	otherwise if evening or morning; say "The ground is in shadow, and the narrow strip of sunlight striking the lava above seeps straight into the black rock, leaving everything painted in a weird half-light, and a strange sensation of isolation[dot]";
	otherwise if afternoon or midmorning; say "Sunlight angles down tentatively, lighting up one lava wall which paints the bowl in weak refracted light[dot]";
	otherwise if midday; say "The ground is lit up by the sun, shining straight down into the sheltered bowl[dot]";
	otherwise if sunrise or sunset or dawn or twilight; say "Everything is dim and indistinct, only a faint light creeping down the black lava walls to reach the ground at your feet[dot]";
	otherwise; say "A circle of stars above you only barely illuminate the ground, and the black walls are formless and indistinct[dot]";
	end if;
	say "[if night]The dark grass at your feet whispers with[else]Crude chalk [o]markings[x], so faint as to be nearly invisible, cover one wall near[end if] a bed of [o]wildflowers[x].[paragraph break][exits]".

The exits text of Grassy End is "The only way out is [dr]back[x][if dir] [southeast][end if] towards the hive". The prose name of Grassy End is "the grassy dead end".

GrassyEnd-stuff is stuff in Grassy End. Understand "amphitheater/remnants/lava/tube/ceiling/strip/bowl/circle" as GrassyEnd-stuff when location is Grassy End.

The bee hint drawing is a setpiece in Grassy End. The printed name is "crude chalk markings". Understand "marking/markings/marks/crude/chalk/faded/circle/arrow" as bee hint drawing. The description is "Largest are two symbols: a three-quarter circle with an arrow indicating a clockwise direction, and another arrow, angling upwards. Next to these is drawn a compass rose[if puzzle mode]. Underneath are scrawled some [o]words[x][end if].".

The bee words are a hint-based scrawl in Grassy End with standard message "the dancer showed me where to go. made The Discovery by following them into the forest." and secret message " clockwise is west, angled up is north". Understand "text/scrawl/scrawls/writing" as bee words.



Chapter - Hive Room

The printed name of Hive Room is "At the Hive". Understand "rockslide" as south when location is Hive Room.

The prose name of Hive Room is "the giant beehive". The description of Hive Room is "[hiveroomdesc].". To say hiveroomdesc:
	if longform begin; say "At a wide spot in the thin border zone between the rain forest and the jagged rift rises a massive organic mound, a [sayhive] several times your height: grayish-pink and almost whimsical in its curved irregularities. It makes a distinctive landmark at the halfway point of the long narrow chute between the rockslide and [if Edge of Ravine is visited]the edge of the ravine[otherwise]a sudden dropoff farther ahead[end if][dot]";
	otherwise if raining; say "Raindrops drizzle and stream down the weird curves of the [sayhive] sedately, though now the design of the skylights becomes more clear, as none of the water drips into the interior[dot]";
	otherwise if rained and afternoon; say "The [sayhive] glistens wetly in the misty afternoon light, its light exterior soaked to a deep, textured brown[dot]";
	otherwise if afternoon; say "The whimsical curves of the [sayhive] are already in the dark shadow of the lava flow, except for a grey-gold tuft near the skylights at its top[dot]";
	otherwise if morning; say "The vicinity of the [sayhive] stirs with busy activity in the golden light, as if the bees are eager to get to work[dot]";
	otherwise if twilight or dawn; say "The [sayhive] is still and silent in the faint half-light, strangely alien without the drone of its daytime workers[dot]";
	otherwise if night; say "The [sayhive] seems strange and mysterious in the darkness, curves and shapes turned to unpredictable angles and disturbing lines[dot]";
	otherwise; say "The [sayhive] rises above you, several times your height, a grayish-pink whimsical structure of curves and ridges[dot]";
	end if;
	say "[exits]". To say sayhive: say "[o]beehive[x]".

The exits text of Hive Room is "The edge of the rain [dr]forest[x] [bw of Forest2][if dir][east] [end if]continues [bw of Edge of Ravine][ethr2]". To say ethr2: say "[if dir][north] and [bw of Rockslide][south][otherwise]toward a [dr]dropoff[x] or [bwt of Rockslide]the [dr]rockslide[x][end if], "; say "and a small [dr]gap[x] in the lava flow [if dir][bw of Grassy End][northwest] [end if]also looks passable[if Hive Interior is visited]. You could also climb [up] the beehive itself[end if]". Understand "gap" as northwest when location is Hive Room. Understand "dropoff" as north when location is Hive Room. Understand "forest" as east when location is Hive Room.

HiveRoom-stuff is stuff in Hive Room. Understand "spot/border/zone/rift" as HiveRoom-stuff when location is Hive Room.

Report going from Hive Room to Rockslide: say "You climb back up onto the boulder field, stepping carefully as the odd rock shifts under your weight.". Report going from Hive Room to Edge of Ravine: say "You follow the grassy path downhill, keeping the edge of the lava flow on your left and the rain forest on your right, till you come to a sudden dropoff.".

The ambience table of Hive Room is Table of Hive Room ambience.

Table of Hive Room ambience
freq		start time	end time	text	table		trigger	flag
frequent		morning		evening		--	Table of Beehive ambience


Table of Beehive ambience
freq		start time	end time	text	table		trigger	flag
common	--	--	"[one of]A faint drone sounds steadily from the interior of the hive[or]A bee circles lazily around the hive before returning to the interior through a wide window[or]Bees crawl in and out of the wide windows running around the hive's exterior[in random order], well above your head."

Instead of listening when beehive is enclosed by location or swarm is enclosed by location, say "[if night]The bees are silent in the darkness of night[otherwise]The gentle drone of the bees makes the [Progue-time-of-day] light somehow seem thicker and heavier[end if].".

The beehive is a backdrop. It is in Hive Room and Hive Interior. Understand "hive" or "massive" or "organic" or "mound" or "grayish-pink" or "grayish" or "pink" or "whimsical" or "curved" or "irregularity" or "irregularities" or "textured" or "wall" or "walls" or "dome" or "top" or "side" or "sides" or "walls of hive" or "wall of hive" as beehive. The description is "Rising well above your head, the curved and textured walls ripple and fold [one of]vertically[or]like a ladder[stopping] before eventually curving in to form a dome, though the top seems to be broken by several large [o]skylights[x]. A number of other small gaps and windows pepper the upper sides of the hive, allowing you obscured glimpses of the interior[if time for excitement].[paragraph break]It looks like you could easily climb the walls of the beehive[end if].". Instead of climbing or entering the beehive, try going up. Instead of touching the beehive, say "The walls of the hive are as strong as cement, surprising since their texture seems light and airy.". Does the player mean climbing or entering the beehive: it is very likely. The dream-text of the beehive is "honeycombs". Instead of attacking the beehive, say "You slam a hand against the wall of the hive, but it's as solid as rock.".

Instead of searching the beehive: say "The holes in the wall of the hive are all higher than your head, so you can't see in very well from here.".

Report going from Hive Room to Hive Interior: say "The numerous ripples and swirls of the textured hive made for good hand and footholds[if we have not touched the beehive], and the papery-grey surface is hard as a rock[end if]. You climb [if player is wounded]laboriously, keeping your weight on the good leg,[else]easily[end if] up to the level of the windows.". Report going from Hive Interior to Hive Room: say "Carefully, you climb back down to ground level.". 

The beehive-windows are part of the beehive. The printed name is "hive windows". Understand "beehive windows" or "window" or "windows" or "hole" or "holes" or "largest" or "skylight/skylights" as the beehive-windows. The description of the beehive-windows is "[if location is Hive Interior]From here, you can easily see through the opening into the interior of the hive.[otherwise]Of irregular sizes and intervals around the upper third of the hive, the largest of these windows provides a good view of the textured ceiling of the dome, from this angle.[end if]". Instead of entering or climbing the beehive-windows, say "[if location is Hive Interior]The windows aren't big enough to easily squeeze through, but you can see through them fine[otherwise]The windows are well above your head[end if]." Instead of searching the beehive-windows when location is Hive Room, say "All you can see from here is the ceiling of the dome.". Instead of touching beehive-windows: say "[if location is Hive Interior]They are just organic openings running around the top of the hive[otherwise]You can't reach them from down here[end if]."

Discovering-Hive-Is-Climbable is a scene. Discovering-Hive-Is-Climbable begins when Hive Interior is unvisited and the player is in Hive Room for at least the fourth time. When Discovering-Hive-Is-Climbable begins: say "You catch movement out the corner of your eye, and turn just in time to see a cat-sized creature with brown fur and and long tail clamber frantically down the rippled side of the beehive and dash into the protection of the rain forest. You are surprised that the walls of the hive supported its weight.". Discovering-Hive-Is-Climbable ends when Discovering-Hive-Is-Climbable begins.

Chapter - Hive Interior

The printed name of Hive Interior is "At the Hive, Peering Inside". Check sleeping when location is Hive Interior: say "Clinging to the side of the beehive? Not likely." instead.

The prose name of Hive Interior is "on the giant beehive". The description of Hive Interior is "[beeintdesc].".

To say beeintdesc:
	say "Clutching the sides of the beehive, you peer curiously inside. The inside walls are thick with hexagonal honeycombs[if morning or midmorning or afternoon or evening], glowing with a creamy golden sheen where snatches of slanting sunlight falls through the windows to touch them[end if][dot]";
	say "[if night]The bees huddle in clusters around the hive, quivering on occasion but clearly asleep[otherwise if hive bees are collecting]A sparse smattering of bees mill around the honeycombs[otherwise if hive bees are dormant]Bees, wings and heads tucked in, cover every surface, hardly moving except for an occasional faint twitch[otherwise if hive bees are watching]Bees mill around the walls, most watching one [o]dancer[x] bee who moves in strange but regular patterns[otherwise]Hundreds of bees mill around over the interior surface of the hive[end if]. The only way to go from here is back [down]".

Instead of going up in Hive Interior, say "You're less confident of the ceiling's ability to support your weight." Instead of entering the beehive when location is Hive Interior, say "The windows are big enough to see through, and big enough for the bees to enter, but not you.". 

Some hive bees are an undescribed animal in Hive Room.  Understand "stream/hundreds" as hive bees. The hive bees can be dormant, hesitating, watching, or collecting. The hive bees are hesitating. The hive bees have a number that varies called counter. The counter of the hive bees is 0. After going to Hive Interior: move hive bees to location; continue the action. After going to Hive Room: move hive bees to location; continue the action. The description of hive bees is "[if location is Hive Room]You can faintly see, through the elevated [o]windows[x] in the hive, bees milling about inside[else]Bees swarm around the honeycombs on the inside of the hive[end if].". [The hive bees represent the bees that are always present in the hive. They can only be seen/interacted with from the Hive Interior and Hive Room locations.]

The honey is a minor prop in Hive Interior with provoke message "You carefully break off an abandoned corner of honeycomb, dripping with thick, creamy honey, and pop it into your mouth. The taste is overwhelmingly sweet: not just sugary, but with hints of fruit and mint, too. Fortunately, the bees do not seem to mind.". The indefinite article is "some". Understand "honeycomb/honeycombs/hexagonal/cream/creamy/golden" or "honey comb" as honey. 

Instead of going nowhere when location is Hive Interior: say "(first getting down from the beehive)"; move player to Hive Room, without printing a room description; try going noun.




Chapter - Edge of Ravine

The printed name of Edge of Ravine is "At the Dropoff". The prose name of Edge of Ravine is "at the dropoff to the great ravine". The description of Edge of Ravine is "[edgeravdesc].". To say edgeravdesc: say "At your feet a carpet of [o]wildflowers[x] suddenly drops off into a sheer ravine, a [if dawn or sunrise]mist-shrouded[otherwise]narrow[end if] inlet that sharply divides this side of the island from the equally sheer slopes of the mountain peak [if dir]to the north[otherwise]across (and up) from here[end if]. "; say "[if night]Waves crash somewhere below you[otherwise][A sentence about the gorge waves][end if][if sunup]. Above the far end of the gorge opposite the sea, on a narrow spur of the mountain running straight into the lava flow, rises [windsigh phrase of tree3], the largest you've seen, branches reaching high into the sky[end if].[paragraph break][exits]".

The ravine proper is a backdrop. It is in Edge of Ravine, Ravine Floor, Top of Ravine, Saddle, Atop, Viewpoint. Understand "inlet/gorge/mouth" as ravine proper. The printed name is "ravine". The description is "The ravine's sheer sides drop into a gorge swallowed by seawater.". Instead of leaping the ravine proper, say "It's much too far across and too far down for that.". Instead of entering the ravine proper, try climbing ravine-ladder.

The exits text of Edge of Ravine is "A rope [o]ladder[x] descends [down] a dizzying drop to the bottom of the ravine. The rain forest runs nearly to the cliff edge, but a short walk[if dir] [south][end if] would take you back to the [dr]beehive[x]". Understand "beehive" as south when location is Edge of Ravine. 

To say a sentence about the gorge waves:
	if high tide, say "Huge swells break through the gorge far below you";
	if falling uptide or rising uptide, say "Waves crash up the gorge spectacularly";
	if falling downtide or rising downtide, say "Waves smash dramatically into boulders at the distant mouth of the gorge";
	if low tide, say "The bottom of the gorge is a bed of gravel";
	if night begin; say ", dimly visible in the [light-source] that filters down into the depths";
	otherwise;	
		if high tide, say ", the bottom hidden by a maelstrom of churned [foam bit] foam, now flowing up the gorge, now sinking back";
		if falling uptide or rising uptide, say ", sending runners of [foam bit] foam dancing past and then slinking back repeatedly";
		if falling downtide or rising downtide, say ", sending runners of [foam bit] foam almost halfway up the gorge to the ground far below you";
		if low tide, say ", slicked with seaweed and pools of water, but safe for the moment from the distant smash of the waves far down by the gorge's mouth";
	end if.
	
To say foam bit: if sunrise or morning begin; say "sun-kissed"; otherwise if afternoon or evening or sunset; say "shadowed"; otherwise if dawn or twilight; say "ghostly grey"; otherwise; say "cream-white"; end if.

The ravine-ladder is a backdrop. It is in Edge of Ravine and Ravine Floor. The description is "Woven from tough vines reinforced with some fibrous material; the rungs are planks of wood.". Instead of pulling or taking the ravine-ladder, say "The ladder does not hang free, but seems to be attached periodically to anchor points as it runs [if location is Ravine Floor]up[otherwise]down[end if] the wall of the ravine.". Instead of climbing or entering or using ravine-ladder when location is Edge of Ravine, try going down. Instead of climbing or entering or using ravine-ladder when location is Ravine Floor, try going up. Understand "ladder" or "ravine ladder" as ravine-ladder. The printed name is "ravine ladder".

Instead of going down in Edge of Ravine when tidein, say "You descend the ladder carefully, clutching the rungs slicked with sea breeze tightly, but after only a dozen rungs down you can see it's a lost cause; the waves are still crashing through the gorge below you, and if you made it to the bottom you'd be swept out to sea.[paragraph break]You climb back up the ladder to the edge of the ravine again.". Report going from Edge of Ravine to Ravine Floor: say "You descend the ladder [if player is wounded]one rung at a time, favoring your uninjured leg[else]carefully[end if], "; say "[if afternoon]passing into shadow after only a dozen rungs, [otherwise if evening or sunset]passing into shadow almost immediately, [end if]clutching rungs slicked with sea breeze and encrusted with years of brine. [if Ravine Floor is unvisited]It's a lot farther than you thought. [end if][if night]The darkness hides the distance to the ground, which is probably just as well. [end if][if sunrise or morning]The early morning light shines right up the ravine, letting you see just how far you are from the bottom-- something of a mixed blessing. [end if]Finally[if Ravine Floor is unvisited], after counting sixty-seven rungs,[end if] you step onto the wet gravel bed of the ravine floor[if Ravine Floor is unvisited] and massage your fingers, looking around with interest[end if]." Report going from Edge of Ravine to Hive Room: say "You walk back up the clear swath between forest and lava flow, until you arrive again at the bee hive."

The distant-tree3 is a view with base room Saddle. It is in Top of Ravine, North Beach, Rise, Chair-lift1, Chair-lift2, Chair-lift3, Chairlift Base, Stumps, Lawn, Observatory Exterior, Ravine Floor, Edge of Ravine. It is near Top of Ravine, North Beach, Rise. It is far from Chair-lift1, Chair-lift2, Chair-lift3, Chairlift Base, Stumps, Lawn, Observatory Exterior, Ravine Floor, Edge of Ravine. The printed name is "distant [tree3]". Understand "tree/tree9/windsigh" as distant-tree3. The description is "The tree straddles a steep ridge that angles down from the mountain and eventually collapses into the lava flow, neatly dividing the eastern side of the island from the west half. [if location is Chair-lift2 or location is Chair-lift3]Below you and to your right[otherwise]Far above you[end if], the distant tree is taller and larger than the others you've seen, presumably because of its all-day exposure to sunlight, but it still seems stunted somehow.". Does the player mean doing something to distant-tree3: it is unlikely. [There may be closer trees in the room we're in.] 

The ambience table of Edge of Ravine is Table of Edge Ravine ambience.

Table of Edge Ravine ambience
freq		start time	end time	text	table		trigger	flag
common		--		--	--	Table of Ravine ambience

Table of Ravine ambience
freq		start time	end time	text	table		trigger	flag
common	rising uptide		falling uptide	"[one of]A great wave thunders[or]Waves crash[or]The tide surges[in random order] through the ravine below, [one of]smashing its way in a series of foam explosions[or]tumbling in an ever-rising white foamy jumble[in random order] [one of]past the boulders far below your feet[or]up the channel towards its rocky top[in random order] before retreating again."
uncommon	falling downtide	rising downtide	"[one of]Waves break[or]Water smashes[or]The sea crashes[or]The ocean slams[or]Swells slap[in random order] [one of]noisily[or]fiercely[in random order] [one of]against the base of the ravine[or]far down near the bottom of the ravine[or]at the jumble of boulders near the ravine's bottom point[in random order], but [one of]only a few small runners of foam penetrate the channel[or], but only showers of foam make it past the breakwater[or], a reminder of low tide's temporary nature[in random order]."


Chapter - Viewpoint

The prose name of Viewpoint is "the viewpoint of the mountain from the rain forest". The description of Viewpoint is "[viewpointdesc].[paragraph break]A vein of sea-blue [o]crystal[x] breaks the surface here.". To say viewpointdesc: say "This small ledge of cleared grassy space is surrounded by forest, except for the sides that drop off into the sea. Below you is the mouth of [if Viewpoint is unvisited and Edge of Ravine is unvisited]a[otherwise]the[end if] ravine[if dir] running west[end if], while infinite blue ocean stretches to the horizon[if dir] eastwards[end if][if sunup], where a faint [o]smudge[x] is just visible against the blue[end if]. [exits]. "; say "[paragraph break]From this ledge you are far enough around the mountain to see where the path on the distant summit leads. Tucked in a sheltered cirque on the mountain's backside is a tiny [o]pyramid[x] surrounded by a great curved ring. You can't make out many details from this far off". The exits text of Viewpoint is "The rain [dr]forest[x] looms [if dir]to the [south][otherwise]behind you[end if]". Understand "forest" as south when location is Viewpoint. 

The distant cliffs are a backdrop in Viewpoint. Understand "smudge" as distant cliffs. The description is "Squinting into the haze, the smudge slowly resolves itself into a far-off outcrop of cliffs, the extremity of some distant landmass just poking over the horizon.".

Viewpoint-stuff is stuff in Viewpoint. Understand "ledge/sides" as Viewpoint-stuff when location is Viewpoint.

The ambience table of Viewpoint is Table of Viewpoint ambience.

Table of Viewpoint ambience
freq		start time	end time	text	table		trigger	flag
common		--		--	--	Table of Ravine ambience


Chapter - Crater Pond

The printed name of Crater Pond is "Hidden [if Tsunami Sequence has ended]Geyser[else]Pond". The description of Crater Pond is "[craterponddesc].". To say craterponddesc: say "Tucked between the slopes of the volcano, the base of the boulder field, and the wet green arms of the rain forest, this small depression [if Tsunami Sequence has ended]is filled with fiercely bubbling water that churns and roils while emitting a rich, loamy odor[else]has filled with rainwater to make a tiny [o]pond[x], dotted with water lilies and reeds[end if]. [o]Wildflowers[x] dot the moist banks of the water.[paragraph break][exits]". The exits text of Crater Pond is "The [dr]forest[x] is dense, but you [if dir]could enter it through a gap to the [north][otherwise]do see one way in[end if]; you could also scramble back [dr]up[x] the rockslide[if dir] to the [northwest][end if]". Understand "forest" as north when location is Crater Pond. The prose name of Crater Pond is "the hidden pond".

Viewpoint-stuff is stuff in Viewpoint. Understand "ledge/sides" as Viewpoint-stuff when location is Viewpoint.

The small pond is a setpiece in Crater Pond. Understand "water/pool/geyser" as small pond when location is Crater Pond. The description is "The pond is only three or four times as wide as you are tall. [if Tsunami Sequence has ended]Milky bubbles roil up from some newly-opened crack far below, and the surface steams copiously[else]It reflects the slopes of the volcano above serenely[end if].". Instead of vague swimming when location is Crater Pond, try swimming in the small pond. Instead of entering or leaping small pond, try swimming in small pond. Instead of swimming in the small pond, say "[if Tsunami Sequence has ended]The water is scalding hot to the touch; you'd be boiled alive[otherwise]You dip your toes in the water, causing the small blue birds to scatter into the air. It is lukewarm; the bottom is a soft carpet of thick wet moss on uneven boulders. Your steps stir up clouds of silt that billow in slow-motion through the pool water.[paragraph break]The pond isn't big enough for actual swimming, but you spend a while cooling off before finally returning to dry land again[end if].". Instead of tasting or taking the small pond, say "[if Tsunami Sequence has ended]You reach out your hand to touch the water, but jerk it back instantly; it is boiling hot[otherwise]You cup a handful of the pond water and try it. It has a silty aftertaste and a slightly unpleasant tang, but at least it quenches your thirst[end if].". Instead of touching the small pond, say "The water is lukewarm.". Instead of touching the small pond when Tsunami Sequence has ended, try taking the small pond. The dream-text of small pond is "great piles of silver-blue bird feathers".

The water lilies are a prop in Crater Pond.

Report going from Crater Pond to Rockslide: say "You scramble back up the boulder field to the saddle.". Report going from Crater Pond to Rain Forest: say "You leave the pond behind for the dark interior of the rain forest.".

The ambience table of Crater Pond is Table of Crater Pond ambience.

Table of Crater Pond ambience
freq		start time	end time	text	table		trigger	flag
common		morning		evening		"[one of]Small silver-blue [o]birds[x] bob serenely on the pond[or]A small silver-blue [o]bird[x] ducks its head under the water to nibble at something[or]A movement from you suddenly startles the silver-blue [o]birds[x] on the pond, most of which take flight in a splash and frantic flapping of wings[or]Some silver-blue [o]birds[x] fly in over the rain forest and land on the surface of the pond[in random order]."	--	pond-birds
common	twilight	night	--	Table of Firefly ambience

Table of Geyser Ambience
freq		start time	end time	text	table		trigger	flag
uncommon	--	--	"With only the briefest of warnings, a huge geyser of boiling water jets up from the pond, reaching six or seven times your height into the air and sending scaling hot steam billowing through the air. You hastily take a few steps back, but after only a few moments, the jet of water shrinks, and after a few more moments the pond has returned to its former gently percolating state."

Table of Firefly ambience
freq		start time	end time	text	table		trigger	flag
guaranteed	--	--	"[one of]Fireflies[or]Tiny golden lights[or]Glowing fireflies[in random order] [one of]dance[or]bob and weave[or]sway[in random order] through the [one of]warm night air[or]tropical evening[at random], [one of]magical[or]tracing delicate patterns of phosphorescence through the air[or]emitting a faint glow[or]winking on and off[in random order]."	--	fireflies.

Some fireflies are set dressing. Understand "fire flies" or "flies" or "firefly" or "golden/light/lights" as some fireflies. The description is "Small, glowing creatures winking in and out of sight.". Instead of taking some fireflies, say "You capture one in your hand; it gives off a faint blue-white glow shining through your fingers till you release it.".


Some pond-birds are an undescribed animal in Crater Pond. Understand "silver" or "blue" or "silver-blue" or "bird/birds" as some pond-birds. The printed name is "silver-blue birds". The description is "The birds are like little balls of feathers, about the size of child's fist. Silvery underbellies fade to bright sky-blue on the tops of their heads, and long, skinny orange beaks protrude from their somehow wise-looking faces.". Instead of taking or touching or attacking some pond-birds, say "At your movement, the birds take flight in a sudden frantic splash, zipping off over the rain forest.". 

 
Part - The Rain Forest Region

Rain Forest is a region. Forest1, Forest2, Forest3, Forest4, Forest5, Forest6, Forest7, Forest8, Forest9, and Egg Room are in Rain Forest. The printed name of a rainforest-room is usually "In the Rain Forest". 

The ambience table of Rain Forest is Table of Rain Forest ambience.

Table of Rain Forest ambience
freq		start time	end time	text	table		trigger	flag
common		dawn	sunset	--	Table of Rain Forest Insect ambience
common		twilight	night		--	Table of Rain Forest Night ambience
common		dawn	sunset	--	Table of Rain Forest Creature ambience
uncommon	--	--	"[if night][nightforest][otherwise][one of][timeofdayrelatedforestamb][or][nottimeofdayrelatedforest][at random][end if]."

Finding-A-Boar is a recurring scene. Finding-A-Boar begins when location is regionally in Rain Forest and location is not Egg Room and ( dawn or sunrise or sunset or twilight ) and a random chance of 1 in 30 succeeds. Every turn during Finding-A-Boar: if wild-boar is not enclosed by location , remove wild-boar from play. Finding-A-Boar ends when wild-boar is off-stage.

When Finding-A-Boar begins: say "Suddenly, in a clearing before you, you spot a wild [o]boar[x], snuffling through the undergrowth."; move wild-boar to location.

A wild-boar is an animal. The printed name is "wild boar". Understand "wild/boar" as wild-boar. The description is "The creature is much larger than you expected, with long tusks and ugly, mud-brown skin.". Instead of attacking wild-boar, say "That's probably not a good idea without some kind of weapon.".

Every turn when wild-boar is in location, say "[boardesc]". To say boardesc: say "[one of]The [o]boar[x] snuffles its hairy snout through the underbrush, searching for grubs[or]Cracking twigs under its cloven feet, the [o]boar[x] moves slowly through the clearing, sniffing for prey[or]Flicking flies off its backside with its long matted tail, the [o]boar[x] makes tired wheezes as it ambles through the clearing[or]The [o]boar[x] stops suddenly, sniffing something in the air, then returns to foraging[in random order].".

Table of Rain Forest Insect ambience
freq		start time	end time	text
frequent		--	--	"[one of]A blue-bellied spider weaves a delicate web in a nearby tree[or]A skinny centipede crawls through the fallen leaves near your feet, its countless legs twirling[or]A trio of yellow-blue butterflies flit by, vanishing quickly into the depths of the forest[or]A jet-black slug crawls slowly up a nearby tree trunk, ancient and buried in moss[or]Struggling with her wriggling prey, a blue-bellied spider works tirelessly to wrap a small black fly in silken webbing[or]A pair of small snails inch slowly along a fallen tree trunk[in random order]." 
frequent		--	--	"[one of]A buzz of flies hovers over the tiny corpse of a dead rodent[or]Black beetles scurry away into the decaying leaves, disturbed by your footsteps[or]A pair of small winged insects, black but for brilliant red dots on their heads, fly by in a complex, whirling mating dance[or]Hundreds of tiny blue ants carry fragments of leaves and twigs industriously into a myriad of holes at the base of the tree roots[or]A line of tiny blue ants crawls industriously down a mouldering fallen tree trunk[or]With a metallic buzzing, some beetle-like insect zips from tree to tree overhead[or]A lone red and cream striped bee zips quickly through the trees, dodging and weaving past a hundred obstacles with ease[in random order]."
rare		--	--	"[one of]With a sudden swoop, a bird swoops down from the canopy to snatch a wriggling centipede from a nearby boulder, vanishing again in a heartbeat into the forest[or]With a sudden jerk, you slap your hand to your head and brush away a blue-bellied spider, which skitters hastily away into the underbrush[in random order]."

[[or]A buzz of flies hovers over the tiny corpse of a dead rodent[or]Black beetles scurry away into the decaying leaves, disturbed by your footsteps[or]A pair of small winged insects, black but for brilliant red dots on their heads, fly by in a complex, whirling mating dance[or]Hundreds of tiny blue ants carry fragments of leaves and twigs industriously into a myriad of holes at the base of the tree roots[or]A line of tiny blue ants crawls industriously down a mouldering fallen tree trunk[or]With a metallic buzzing, some beetle-like insect zips from tree to tree overhead[or]A lone red and cream striped bee zips quickly through the trees, dodging and weaving past a hundred obstacles with ease]

Table of Rain Forest Creature ambience
freq		start time	end time	text
frequent	--	--	"[one of]A steady chorus of bird calls soaks through the rain forest from high in the sunlit canopy above[or]Above you, four or five small squirrel-like creatures deftly leap from branch to branch, on their way to some important destination[or]A pair of birds chase each other through the hanging moss and branches in a sudden flutter of wings[or]A small black squirrel creature watches you guardedly from a high branch, then scampers away[or]A flock of small blue birds descend on a nearby tree, and sit there grooming themselves and chirping loudly[in random order]."

Table of Rain Forest Night ambience
freq		start time	end time	text
frequent	--	--	"[one of]Something sticky and tickling brushes at your face; clawing it away in a momentary panic, you realize it was a spider's web[or]A branch snaps loudly, somewhere close by and you freeze for a long moment, but hear nothing further[or]Something unseen scurries away from you in the darkness[or]An unseen animal calls out somewhere nearby in the forest[in random order]."



The exits text of a rainforest-room is usually "[if night]In the blackness, you stumble with every step, and can barely make out possible routes. [otherwise if twilight]The light is rapidly failing, and ways through the forest are growing harder to see. [otherwise if dawn]It's still quite dim, but you can make out a few possible routes. [end if][Forest Exit Routine]". 

To say Forest Exit Routine:
	if location is Forest1, say "[Forest1Exits]";
	if location is Forest2, say "[Forest2Exits]";
	if location is Forest3, say "[Forest3Exits]";
	if location is Forest4, say "[Forest4Exits]";
	if location is Forest5, say "[Forest5Exits]";
	if location is Forest6, say "[Forest6Exits]";
	if location is Forest7, say "[Forest7Exits]";
	if location is Forest8, say "[Forest8Exits]";
	if location is Forest9, say "[Forest9Exits]".

Table of Nearby Rain Forest ambience
freq		start time	end time	text	table		trigger	flag
uncommon	dawn	twilight		"[if night][nightforest][otherwise][one of][timeofdayrelatedforestamb][or][nottimeofdayrelatedforest][at random][end if]."

To say nightforest: say "[one of]A tiny crash echoes from somewhere inside the rainforest, a tiny creature falling prey to some nocturnal predator[or]The rain forest is eerily quiet, like some slumbering beast, huge, humid, and black[or][if moonup]The moon breaks through a cloud and gives momentary form to the edge of the rain forest, details painted in its stark silver-pink light[otherwise]The stars glimmer brightly above the indistinct edge of the rainforest, but penetrate its black interior not at all[end if][in random order]".

To say nottimeofdayrelatedforest: say "[one of]A strange animal cry echoes from somewhere inside the rainforest, muffled and distorted, as if only barely escaping the thick carpet of moss-covered trees[or]A muffled crash sounds faintly from within the rainforest, perhaps some long-dead tree finally giving way to gravity's pull[or]A bird call sounds sharply from some tree on the edge of the rain forest, repeating several times with clockwork regularity before falling silent[or]A gust of wind makes the green tide of the rain forest shimmer and breathe, swaying and waving the humid air[in random order]".

To say timeofdayrelatedforestamb:
	if dawn begin; say "[one of]Shapes gradually begin to coalesce out of the dimness of the rain forest: trees, ferns, boulders, and vines coming into being[or]The rain forest is utterly still in the growing light, as if even the wind has yet to wake up[in random order]";
	otherwise if morning or sunrise or midmorning; say "[one of]The morning light burnishes the tops of the forest trees, but you sense the deep interior is still cold and unlit[or]A whispering susurrus of sound trickles out of the rainforest, the noise of a million leaves rubbing against each other, a million beetles scurrying[in random order]";
	otherwise if midday; say "[one of]The rain forest bakes in the midday sun, waves of steam rising from its dark, hot interior[or]A faint breath of air stirs the trees of the rain forest teasingly, but then vanishes, like a heat mirage under the baking sun[in random order]";
	otherwise if afternoon; say "[if raining][one of]The rain forest soaks in the falling moisture like a huge green sponge[or]Channels of water run down huge fronds or rivets in tree trunks at the edge of the rain forest[in random order][otherwise if weather state is decided to rain or rained][one of]Wind whips the fringe of the rain forest, great dark leaves quivering under the scudding clouds[or]Bird cries echo through the rain forest as clouds race by overhead[in random order][otherwise][one of]The dense vegetation of the rain forest burns gold and chartreuse in the afternoon light[or]Birds circle lazily over the rain forest, drinking in the sun's slanting rays[in random order][end if]";
	otherwise if evening or sunset; say "[one of]The rain forest lies quiet in the shadow of the lava flow[or]Birds chirp restlessly from atop some tree in the rain forest, anxious for the long shadow of the lava flow to give way to night[in random order]";
	otherwise if twilight; say "[one of]Insects buzz quietly in strange syncopations and harmonies within the depths of the rain forest[or]The rain forest shimmers under a faint wind and the fading sky, settling in for another long night[in random order]";
	end if.
	

To say a sentence about the forest profusion:
	if night begin; say "The interior of the rain forest is almost pitch black in the night; strange undefined shapes and sourceless noises surround you on all sides";
	otherwise; say "[if a random chance of 2 in 3 succeeds and not raining][forestprofusiongen][otherwise][forestprofusiontod][end if]";
	end if.

To say forestprofusiongen: say "[one of]Living things grow on every side, on top of and overtaking each other like a closet too full of unneeded things[or]Light filters warily through the forest canopy high above, filtered green by countless huge leaves and shadowed by dozens of moss-encrusted branches[or]The living forest surrounds you on every side, a verdant chaos of leaves, branches, trunks, moss, and vines of all shapes and sizes[or]Damp air mists through the rain forest, perceptible only in fits[or]Greenery clusters in on all sides, and daylight descends only in timid shafts to touch the odd lucky branch or twist of root[or]Waves of humid air buffet you gently, soaking in smells of earth and vegetation from the huge trees and endless mossy roots that press in on every side[in random order]".

To say forestprofusiontod:
	if dawn or twilight begin; say "[one of]Only the faintest light filters through the canopy to the floor of the rainforest, painting it in dull half-shades and shadows[or]The forest seems half asleep in the faint light, and you tread quietly, as if fearful of waking it up[or]Indistinct shapes and dimensionless forms loom up on all sides in the dim light[in random order]";
	otherwise if sunrise or morning; say "[one of]Wisps of mist hover strangely in the rain forest, like lost cloud children hiding from the punishment of sunlight[or]Bright light turns the canopy far overhead to glowing greens and golds, but only reflected light, shadowless and strange, makes it to the forest floor[in random order]";
	otherwise if raining; say "[one of]Water spatters noisily on the canopy overhead, gurgling down to your level along tree trunks, sudden showers, and huge, endless tear drops[or]The muddy ground sucks at your feet as you slog through the rain forest, stepping carefully over slimed boulders and mouldering deadwood[or]The rain has turned the forest to shades of deep soaked green, slimy earth browns, and rich crinkled blacks[or]Wet leaves slap at your face and water-swelled logs catch at your feet, but you finally manage to stop and catch your breath[or]The humid air is made so thick by the rainfall you are almost afraid to breathe, lest you drown amidst the mud puddles and shivering palm fronds[or]As rain penetrates the canopy and drizzles down to the rain forest floor, you can almost feel the great, twisting tree roots drink it in, the carpet of fallen leaves dissolving gradually into dirt[in random order]";
	otherwise if rained; say "[one of]Water drips continuously from the canopy far above, as the muddy ground struggles to drink in the afternoon's rain[or]The forest steams in the aftermath of the rain, wisps of moisture dancing restlessly through the ancient gnarled trunks and moss-draped vines[or]Rivulets of water trickle into mud puddles, as the rain forest quietly absorbs the rain shower's output[in random order]";
	otherwise if midmorning or midday or afternoon; say "[one of]The rain forest is a symphony of life, heat, moisture, and movement, pressing in on you from all sides oppressively[or]The afternoon heat hangs oppressively in the rain forest, water beading like sweat on moss-swamped trees and twisted, fallen branches[or]The rain forest is hot and heavy in the midday sun, shielding you from its direct light but baking nonetheless in its own moist fire[or]A hot wind gusts through the rain forest, creaking branches, shimmering fronds, and sending a scudding whirl of dead leaves past your feet[in random order]";
	otherwise if evening or sunset; say "[one of]Insects hum and chirp restlessly in the rain forest evening, settling invisibly on high branches and blending imperceptibly into the trunks of ancient, gnarled trees[or]The rain forest is dim and sleepy in the muffled evening light[in random order]";
	end if.

Chapter - Rain Forest Rooms

Section - Forest1

The prose name of Forest1 is "the rain forest". The description of Forest1 is "[forest1desc].". To say forest1desc: say "[if milestone mode is false and final release mode is false](1)[end if][A sentence about the forest profusion]. Clusters of deep-green fronds spring out in concentric circles from tiny buds here on a gentle slope. [paragraph break][exits]". To say Forest1Exits: say "Passable routes depart through a wooden [dr]archway[x][if dir] to the [east][end if], [if dir][southeast] [end if]into a fern-clogged [dr]valley[x], towards a distant [dr]brightness[x][if dir] [north][end if], or "; say "[if dir][south] [end if][dr]between[x] two great hoary tree trunks". Understand "passing" or "between" as south when location is Forest1. Understand "fern-clogged" or "clogged" or "valley" as southeast when location is Forest1. Understand "archway" or "branches" as east when location is Forest1. Understand "brightness" as north when location is Forest1. Report going from Forest1 to Forest7: say "You pass underneath the natural archway of intertwined tree branches." Report going from Forest1 to Forest6: say "You walk carefully down the narrow valley, trees and brambles climbing higher on either side.". Report going from Forest1 to Forest2: say "You pass between the two huge trunks and enter another part of the forest." Report going from Forest1 to Edge of Ravine: say "[one of]Keeping your eyes fixed on the light, you tread carefully over the slippery ground, but not carefully enough: suddenly your foot slips and you slide and stumble down an embankment onto a wide ledge, shaken but unbruised[or]You remember the embankment here this time, and jump off it past the muddy slope that will prevent you from returning this way[stopping].". 

Some clusters of deep-green fronds are a setpiece in Forest1. 

Section - Forest2

The prose name of Forest2 is "the rain forest". The description of Forest2 is "[Forest2desc].". To say Forest2desc: say "[if milestone mode is false and final release mode is false](2)[end if][A sentence about the forest profusion]. Some of the lower ground vegetation here gives way to goliath trees, trunks like pillars carpeted with what seems a thousand years of furry green moss, watching over a bed of delicate [o]wildflowers[x]. [paragraph break][exits]". To say Forest2Exits: say "A faint droning and brighter [if dir]spot [bw of Hive Room]to the [west][otherwise][dr]spot[x] [bw of Hive Room]through some stands of bamboo[end if] may mark the edge of the forest, while other passable routes "; if dir, say "head [bw of Forest1][north], [bw of Forest3][southeast], and [bw of Forest5][south]"; otherwise say "pass [bw of Forest1][dr]between[x] two huge trunks, [bw of Forest3]down an uneven [dr]slope[x], or [bw of Forest5]into a dimmer [dr]hollow[x]". Understand "spot" as west when location is Forest2. Understand "between" as north when location is Forest2. Understand "slope" as southeast when location is Forest2. Understand "hollow" as south when location is Forest2. Report going from Forest2 to Forest1: say "You pass between the two huge trunks and enter another part of the forest." Report going from Forest2 to Forest3: say "[one of]You step carefully down the scree-covered slope, but [if raining or rained]the wet mud bank gives way beneath you[else]a hidden branch catches your foot[end if], and you slide down ungracefully in a tumble of loose rock and rotting vegetation-- it will be quite impossible to go back up[or]You travel down the scree-covered slope more carefully this time, but there's no way you'll be able to climb back up[stopping].". Report going from Forest2 to Forest5: say "You pick your way down a mild slope into the hollow.".

The tree-bee-hint is a described setpiece in Forest2. "One of the huge tree trunks near the edge of the forest is marked with a fading [o]carving[x].". The printed name is "carving". Understand "carving/carvings/drawing/arrow" as tree-bee-hint. The description is "[one of]You pull some moss away from the carving in the tree trunk and study it more closely. It[or]The carving[stopping] shows a crude drawing of a bee, with an arrow pointing from the [if dir]west[otherwise]direction of the droning sound[end if] and angling down towards the bed of wildflowers. A second arrow from the hive points deeper into the forest and is followed by a question mark[if puzzle mode]. Below are carved a few [o]words[x] in a strange script[end if].". Check following tree-bee-hint: say "It's not entirely clear which way the arrow points from here." instead.

The tree words are a hint-based scrawl in Forest2 with standard message "three steps: east, ?, ?" and secret message " third is northeast".

Section - Forest5

The prose name of Forest5 is "the rain forest". The description of Forest5 is "[Forest5desc].". To say Forest5desc: say "[if milestone mode is false and final release mode is false](5)[end if][A sentence about the forest profusion]. [if raining or rained]Trickles of water clogged with leaves and twigs come to rest in this marshy hollow, bounded by thick muddy[otherwise]Innumerable bits of decaying debris, from twigs and leaves to tiny bird bones and snail shells, collect at this low hollow bounded by thick[end if] tree roots twisting their way up to trunks that begin well above your head. [paragraph break][exits]". To say Forest5Exits: say "A [dr]gap[x] of grey [if dir]to the [south] [end if][if former location is Crater Pond]indicates[otherwise]must indicate[end if] an escape from the rain forest, while a crumbling [dr]slope[x] [if dir][north] [end if][f5e2]". To say f5e2: say "or the [dr]swath[x] cleared [if dir][dc]east [x][end if]by a newly-fallen giant lead deeper in". Understand "gap" as south when location is Forest5. Understand "slope" as north when location is Forest5. Understand "swath" as east when location is Forest5. Report going from Forest5 to Forest3: say "You walk along the top of the crumbling tree trunk towards a tiny clearing near the edge of a dropoff.". Report going from Forest5 to Forest2: say "You walk carefully up a slight slope towards a lighter area near a cluster of wildflowers.". Report going from Forest5 to Crater Pond: say "You slip through the gap in the trees and escape the oppressive interior of the rainforest.".

Section - Forest3

The prose name of Forest3 is "the rain forest". The description of Forest3 is "[Forest3desc].". To say Forest3desc: say "[if milestone mode is false and final release mode is false](3)[end if][A sentence about the forest profusion]. The ground gives way here in a sudden dropoff, nearly disguised by sinuous silver-green branches twining up from trees on the steep slope. [paragraph break][exits]". To say Forest3Exits: say "The edge of the dropoff runs [if dir][north] or [south][otherwise]towards a [dr]clearing[x] one way or through curtains of [dr]vines[x] in the other[end if], while the fractured top of a mighty tree long-fallen "; say "[if dir]runs [west][otherwise]clears a [dr]route[x] away from the edge[end if][if Egg Room is visited]. The hidden route [down] to the Egg is also nearby[otherwise if story mode]. An almost invisible gap shows a way [down] into a hidden hollow[end if]". Report going from Forest3 to Forest4: say "You make your way along the edge of the dropoff, curving slightly[if dir] [southeast][end if], feeling the ground harden and given way from moss to lichen beneath your feet.". Report going from Forest3 to Forest9: say "Following the curving edge of the dropoff, you work past curtains of vines and great, drooping leaves as tall as you towards an even more densely vegetated area.". Report going from Forest3 to Forest5: say "Leaping nimbly to the top of the decaying trunk, you walk along the soft moss slowly reclaiming it through the forest.". Understand "clearing" as north when location is Forest3. Understand "vines" as south when location is Forest3. Understand "route" as west when location is Forest3.

The sudden dropoff is a setpiece in Forest3. The description is "Dense vegetation prevents you from seeing much of anything other than the sudden drop[if Egg Room is unvisited]; you certainly can't see a way down[end if].". Instead of entering sudden dropoff when Egg Room is unvisited: say "You can't see any way down.". Instead of entering sudden dropoff: try going northeast.

Before going nowhere when location is regionally in Rain Forest: increase dumb-luck-counter by 5. dumb-luck-counter is a number that varies. Every turn when dumb-luck-counter > 0: decrease dumb-luck-counter by 1. [This prevents a brute force attempt to find the Egg by going every direction from every forest room. Our in-game explanation can be that after a while the player gets tired and doesn't notice the exit. ]

Instead of going from Forest3 to Egg Room when dumb-luck-counter > 15, say goingnowhere.

Report going from Forest3 to Egg Room: say "[if Egg Room is unvisited and puzzle mode]Lining up the compass carefully, you take a bearing along the precise direction of northeast-- and suddenly feel a surge of excitement. Through a gap you could barely squeeze through in the silver-green branches you spot a massive fallen tree trunk that slopes steeply down into a hidden hollow.[paragraph break]Squeezing between the gap, you walk carefully down the steep trunk of a fallen windsigh to the hidden hollow.[section break][otherwise if Egg Room is unvisited]Squeezing between the gap, you walk carefully down the steep trunk of a fallen windsigh to the hidden hollow, and what you see makes you stop short in astonishment.[section break][otherwise]Squeezing between the gap, you walk carefully down the steep trunk of a fallen windsigh to the crater with the crashed egg ship.[end if]". Report going from Egg Room to Forest3: say "You step up onto the rotting windsigh trunk, made spongy by rain and time, and walk the steep angle back up through the gap into the rain forest.".

Section - Forest4

The prose name of Forest4 is "the rain forest". The description of Forest4 is "[forest4desc].". To say forest4desc: say "[if milestone mode is false and final release mode is false](4)[end if][A sentence about the forest profusion]. Great slabs of sloughed-off rock, a giant's skipping stones, tilt the ground here to strange angles, surfaces covered in countless tones of green-blue lichen and broken by clusters of ferns and skinny tree trunks. [paragraph break][exits]". To say Forest4Exits: say "The dropoff curves around [if dir][northwest] or [east][otherwise]into [dr]denser[x] forest or through a thick [dr]cluster[x] of short, stubby palms[end if]. The faint sounds of trickling water force their way through an impenetrable-looking [dr]wall[x] of bamboo[if dir] to the [southwest][end if]". Report going from Forest4 to Forest3: say "You keep the dropoff on your right side as you work your way away from the rocky ground[if dir], curving around to the north[end if].". Report going from Forest4 to Forest9: say "The palms have bark like armor and are densely clustered, making your progress slow. The dropoff curves in a gentle arc as you work your way through the grove, until you have almost turned around again[if dir] to the northwest[end if]. Eventually the palms lose their footing to even denser vegetation and you pause to catch your breath.". Report going from Forest4 to Crater Pond: say "Taking a deep breath, you plunge into the bamboo and are almost immediately completely lost and disoriented. The barely-yielding turtle green stalks surround you and give almost no headway. After an interminable amount of pushing, squeezing, and grunting, you finally push your way out into [if day]daylight[otherwise]open air[end if] and gasp for breath.". Understand "denser" as northwest when location is Forest4. Understand "cluster" as east when location is Forest4. Understand "wall" as southwest when location is Forest4.  [Instead of examining by name basic-walls when location is Forest4: try wordgoing Crater Pond.]

Section - Forest6

The prose name of Forest6 is "the rain forest". The description of Forest6 is "[forest6desc].". To say forest6desc: say "[if milestone mode is false and final release mode is false](6)[end if][A sentence about the forest profusion]. Bulbous red-orange fruits grow from spindly trees, weird curves and patterns etching their shiny skin. [paragraph break][exits]". To say Forest6Exits: say "A narrow leaf-choked [dr]valley[x] climbs [if dir][northwest][otherwise]upwards[end if], adjacent to a passable [dr]badlands[x] of tree roots[if dir] to the [north][end if]; the rain forest in all other directions looks impassable". Report going from Forest6 to Forest7: say "You find the tree roots make easy hand and footholds, plentiful but unsteady, as you clamber over the arboreal maelstrom, feeling like a child in some madman's playground given explosive life. Eventually a green tide of mossy soil rises up to recover the roots and once again you stand on solid ground." Report going from Forest6 to Forest1: say "Keeping out of the marshy bottom, you step carefully up the tiny ravine towards its top, wishing dearly for a machete as you go.". Understand "valley" as northwest when location is Forest6. Understand "badlands" as north when location is Forest6. 

Some bulbous fruits are a prop in Forest6. Understand "fruit/red-orange/seed/seeds/strands" as bulbous fruits. The description is "About the size of a newborn, the fruits are elongated spheres striped with ridges, their skin a brilliant red-orange, shocking against the mostly pale greens of the rain forest.". Instead of taking bulbous fruits, say "You try to pull one from the tree, but they are attached to the branches with thick, ropey stems; perhaps they are not yet ripe.". Instead of attacking bulbous fruits, say "You find a small rock and bash it against the side of the fruit. The tough skin gives way, and dense brown ropey strands thick with seeds oozes out.". First Check tasting bulbous fruits: try attacking bulbous fruits; say "The thick seeds seem to be the most edible, so you pop one in your mouth and chew. The flavor is dark and bitter at first, but a warming, tantalizing aftertaste lingers after." instead. Instead of touching bulbous fruits: say "The skin feels hard and thick, but gives a little under your touch, like an overripe pumpkin.".

Section - Forest7

The prose name of Forest7 is "the rain forest". The description of Forest7 is "[forest7desc].". To say forest7desc: say "[if milestone mode is false and final release mode is false](7)[end if][A sentence about the forest profusion]. The verdant terrain, faintly convex, hosts a rambling cluster of grey-brown trees with snake-like roots half-out of the ground. [paragraph break][exits]". To say Forest7Exits: say "From here, you could [dr]clamber[x] down a gauntlet of tree roots[if dir] to the [south][end if], pass through a natural wooden [dr]archway[x][if dir] [west][end if], [f7e2]". To say f7e2: say "or investigate a [dr]gurgling[x] sound[if dir] [northeast][end if]". Report going from Forest7 to Forest8: say "[if Forest8 is unvisited]Curiously, you push aside masses of feather-light ferns, heading[otherwise]Lifting the masses of ferns aside, you head[end if] in the direction of [if Forest8 is unvisited]the strange sound[otherwise]the mud pots[end if].". Report going from Forest7 to Forest6: say "Proceeding with caution, you half walk, half lower yourself through the tangled mess of tree roots until you stand on relatively flat ground again." Report going from Forest7 to Forest1: say "You pass under a natural arch of wood, two great branches of vine-wrapped trees growing into and around each other, and enter another part of the forest." Understand "clamber" as south when location is Forest7. Understand "archway" as west when location is Forest7. Understand "gurgling" as northeast when location is Forest7.

Section - Forest8

The prose name of Forest8 is "the rain forest". The description of Forest8 is "[forest8desc].". To say forest8desc: say "[if milestone mode is false and final release mode is false](8)[end if][A sentence about the forest profusion]. Fist-sized bubbles splatter noisily from a half dozen oval puddles of creamy gray mud, tucked into miniature craters choked with vines and tiny leafed creepers. A faint smell of sulfur mists the air, clinging heavily to damp tree trunks. [paragraph break][exits]". To say Forest8Exits: say "Faint sounds of surf whisper through willowy [dr]fronds[x][if dir] to the [north][end if], while[if not dir] in the opposite direction[end if] dots of [dr]color[x][f8e2]". To say f8e2: say "[if dir] [dc]southwest[x][end if] and [dr]spears[x] of sharp leaf[if dir] [southeast][end if] both draw your eye". Report going from Forest8 to Viewpoint: say "You follow the familiar sound of the surf through the greenery, and eventually emerge from the forest to a stunning viewpoint.". Report going from Forest8 to Forest9: say "Passing by clusters of strange green-black leaves that spear straight up and then gently fan out far above your head, you curve around the most easy path before arriving at the edge of a dropoff.". Report going from Forest8 to Forest7: say "You shove aside a limitless supply of huge bowed ferns, leaving the bubbling mud pits behind as you advance into another part of the forest.". Understand "fronds" as north when location is Forest8. Understand "color" as southwest when location is Forest8. Understand "spears" as southeast when location is Forest8.

Some oval puddles of mud are a setpiece in Forest8. Understand "puddle/creamy/gray/craters/sulfur/bubble/bubbles" as mud. The description is "A few of the puddles gurgle sloppily as fumes of gas rise through their muddy depths; the others steam silently, warm to scalding hot.". Instead of touching or taking or tasting mud, say "The mud in the puddles is near boiling; you draw your hand back hastily.". Instead of entering or swimming in puddles, say "Unfortunately, they're far too small (and hot) for that." 

Section - Forest9

The prose name of Forest9 is "the rain forest". The description of Forest9 is "[forest9desc].". To say forest9desc: say "[if milestone mode is false and final release mode is false](9)[end if]Vines, tree trunks, and fallen leaves so glut this spot it almost seems you are indoors, trapped in some shifting vegetable prison, but at the center of the green maelstrom the lesser plants make way for [windsigh phrase of tree5], the only one you've seen in the forest, rising mysteriously from the damp mossy earth.[paragraph break]A large, flat-topped [o]boulder[x] near the tree is topped by a bed of deep, springy moss.[paragraph break][exits]". To say Forest9Exits: say "You can escape towards strange bubbling [dr]sounds[x][if dir] to the [northeast][end if], follow the edge of the dropoff [F9ex2]". To say F9ex2: say "[if dir][southeast] or [west][otherwise]through a [dr]grove[x] of armored palms or in the [dr]opposite[x] direction[end if], or bushwhack through a wall of [dr]shrubs[x][if dir] [northwest][end if]". Report going from Forest9 to Forest8: say "Passing by clusters of strange green-black leaves that spear straight up and then gently fan out far above your head, you curve around the most easy path before stepping into wisps of sulfury mist." Report going from Forest9 to Forest6: say "Bravely, you push into the wall of shrubs and immediately decide you've made a mistake: hundreds of tiny rough leaves and sticks scratch you on every exposed surface. Attempts to back up make matters even worse, so instead you make a desperate push forward and pop out into a grove of curious fruits." Report going from Forest9 to Forest3: say "You follow the dropoff, curving gently, into another part of the forest." Report going from Forest9 to Forest4: say "The densely clustered palms provide only one real route past their stunted trunks, as you work gradually around the dropoff, keeping it to your right as you curve around. Eventually the ground hardens up and you find yourself in a less crowded part of the forest.". Understand "sounds" as northeast when location is Forest9. Understand "grove" as southeast when location is Forest9. Understand "opposite" as west when location is Forest9. Understand "shrub/shrubs" as northwest when location is Forest9. 

Tree5 is a windsigh tree in Forest9.

The tree5-nook is a nook in Forest9. The printed name is "boulder". Understand "boulder/moss" as tree5-nook when location is Forest9. The description is "The mossy top of the boulder looks like an inviting place to lie down for a minute."  Instead of touching tree5-nook, say "The moss is not damp at all, and soft as fur under your fingertips.". First report entering tree5-nook: say "Easily lifting yourself up to the top of the boulder, you stretch out on the soft moss." instead. First report getting off when player was on tree5-nook: say "Reluctantly, you push your feet off the edge of the mossy boulder and return your feet to the rain forest soil." instead. The sleep message of Forest9 is "As you close your eyes, the sounds of the rain forest seem to fade away until all you can hear is the rustling of the windsigh's lemon-yellow leaves, and the sighing tones of air moving through its perforated branches. Slowly, even these fade as you drift into sleep."

The ambience table of Forest9 is Table of Forest9 ambience.

Table of Forest9 ambience
freq		start time	end time	text	table		trigger	flag
common	--		--		--	Table of Windsigh ambience




Chapter - Egg Room

The prose name of Egg Room is "the crashed egg ship". The description of Egg Room is "[eggroomdesc].". To say eggroomdesc: say "Rising from the ground of this hidden [if we have examined the egg-proper]crater[otherwise]hollow[end if], walled in by dense jungle on all sides, is a massive rounded shape[if afternoon] lit by a single shaft of sunlight[otherwise if night and moonup] made ominous by the indistinct and filtered moonlight[end if]. Dense encrusted jungle growth fails to hide that the shape underneath is perfectly smooth and rounded, like a giant-sized [o]egg[x] with one end smashed and crumbling. [eggdesc2]". To say eggdesc2: say "A few paces from the egg is a rough-hewn [o]workbench[x] growing out of a carpet of wildflowers, nearly swallowed up by the jungle and [windsigh phrase of tree6] that seems to grow from its center, roots twining down table legs to the ground.[paragraph break]Near the workbench is a grassy [o]mound[x], relatively free from forest debris.[paragraph break][exits]". The printed name of Egg Room is "The Egg". The exits text of Egg Room is "Dim shapes beckon from the [inside] of the egg. The trunk of the fallen tree leads back [up] out of the crater, while you sense open space [down] a steep slope leading to a crack in the crater wall".

Eggroom-stuff is stuff in Egg room. Understand "crater/hollow/walled/jungle/shaft/growth/legs/crack" as Eggroom-stuff when location is Egg room.

Report going from Egg Room to Egg Interior: say "[if Egg Interior is unvisited]Hesitantly, y[otherwise]Y[end if]ou step inside the [if night]black[otherwise if twilight or dawn]indistinct[otherwise]shadowed[end if] interior of the Egg.".

The egg-proper is a setpiece in Egg Room. The printed name is "egg". Understand "shape" or "massive" or "rounded" or "giant-sized" or "giant" or "end" or "smashed" or "crumbling" or "egg" as egg-proper. The description is "[one of]As you study the position of the egg against the surrounding topography, something becomes chillingly clear: you stand within a crater, and this egg-shaped object was its cause[or]The position of the egg relative to the surrounding topography makes it clear that this great shape fell from the sky long years ago[stopping]. Despite what must have been a tremendous impact, the egg is mostly intact: the bottom is crushed, and a great crack has opened up providing access to the [d]inside[x], but otherwise the lines of the moss-encrusted shape are unbroken.". Instead of attacking egg-proper: say "Underneath the moss, dirt, and vegetation, the metallic surface seems terribly solid and uncorroded.". The dream-text of egg-proper is "cartons of eggs". Instead of entering egg-proper: try going inside. Check climbing egg-proper: say "The vines and vegetation half-dragging the egg back into the forest make easy hand and footholds. You quickly clamber up to the top of the egg, but find nothing underneath the muck of fallen leaves and soil other than a smooth, unbroken surface.[paragraph break]After a thorough search, you return to the ground.".

The rough-hewn workbench is an undescribed supporter in Egg Room. Understand "bench" or "table" as rough-hewn workbench. The description is "Obviously assembled hastily and with no eye for craftsmanship, the workbench rests half-concealed under a tangling mass of jungle overgrowth[if eggvines are off-stage]; although you've cleared the top to reveal [a list of things on the rough-hewn workbench][otherwise]; thick [o]vines[x] and moss have completely overrun its surface[end if].". The dream-text of workbench is "delicate stacks of painted eggs". 

Some eggvines are a prop in Egg Room. The printed name of eggvines is "vines". Understand "vines" or "moss" as eggvines. The description of eggvines is "The vines have completely overrun the surface of the workbench." Instead of taking or pulling or pushing or attacking eggvines for the first time: say "You pull one of the vines. It clings tightly to the wood, but slowly strips away, revealing a weathered strip of wood beneath. It looks like with a bit of work, you could remove the vines from the bench." Before taking or pulling or pushing or attacking eggvines: remove the eggvines from play; say "Working systematically, you begin stripping the vines and growth from the table. The forest has encroached on the workbench to an unbelievable extent, but after a few minutes of solid work, you've managed to uncover the surface. [paragraph break]On the workbench are [a list of things on the workbench]." instead. Instead of looking under eggvines, say "Some irregular lumps in the undergrowth do seem to hint there may be something under there." Instead of rubbing the rough-hewn workbench, try pulling the eggvines.   Understand "remove vines from [workbench]" as rubbing when location is Egg Room.

A cluster of seed pods is a prop on the rough-hewn workbench. Understand "pod" as cluster of seed pods. The description is "Spread around the young [if tree1 is named][o]windsigh[x][otherwise][o]tree[x], another of those like the one you painted[end if], which seems to grow out of the table itself, half-buried in dirt, are a handful of tiny, pointed seed pods unlike any others you've seen on the island. Light in weight and colored a rich yellow-brown, the size of a small fruit, the seed is filled with a myriad of tiny holes running straight through its roughly spherical shape.". Rule for printing the name of cluster of seed pods while listing contents: say "cluster of [o]seed[x] pods". Understand "plant [cluster of seed pods]" or "bury [cluster of seed pods]" as a mistake ("Carefully, you dig a small hole in the ground and bury the seed in it, covering the hole back up and patting it firmly."). Instead of attacking cluster of seed pods: say "The pods are hard and the tines sharp, but you manage to crush one under the base of your hand against the workbench.". The dream-text of cluster of seed pods is "thousands of pointed seed pods".

A silver tube is a prop on the rough-hewn workbench. The description is "Wiping a layer of grime from the tube, you see that underneath its surface is a lustrous, metallic silver. The tube is hollow and open at one end; as you tip it another seed cone rolls out.". Rule for printing the name of silver tube while listing contents: say "silver [o]tube[x]".

[The fallen windsigh tree is a setpiece in Egg Room. The description is "Though stripped of its vines and yellow flowers, you've seen enough windsigh by now to recognize this trunk as one of them. It has been many years since this one fell; rainfall, termites, and rot have made the trunk spongy and are starting to meld its shape into the land beneath it. It's still solid enough, however, to walk [up] its length back to the rain forest.".]

tree6 is a windsigh tree in Egg Room. Understand "young" as tree6. The printed name of tree6 is "young [if tree1 is named]windsigh[x] [end if]tree". The description is "This young [if tree1 is named]windsigh[otherwise]tree[end if], only about twice your height[if tree1 is unnamed] but recognizably the same as the other twisted trees you've seen[end if], seems to be growing straight out of the workbench, long spindly roots twined around the table legs to plunge into the soil below, lemon-yellow leaves poking brightly from its vine-wrapped branches.". Instead of climbing tree6, say "The tree is too young to climb without damaging it.".

The tree6-nook is a nook in Egg Room. The printed name is "grassy mound". Understand "grassy/mound/grass" as tree6-nook. The description is "The mound looks like a good spot to curl up on."  Instead of touching tree6-nook, say "The grass is soft and dry.". First report entering tree6-nook: say "You stretch out on the grassy mound. The warm grass collapses into a nest beneath your body, and the blades tickle your nose until you shift into a better position." instead. First report getting off when player was on tree6-nook: say "You step up off the grassy mound." instead. The sleep message of Egg Room is "Lulled by the rustling of the leaves above and the quiet sigh of the tree, you drift into a deep, bottomless sleep."

A circle of quartz is a prop on the workbench. Understand "glass" or "lens" or "magnifying" or "shape" or "convex" as circle of quartz. The description is "Cleaning the dirt and moss from this hefty piece of translucent rock, the size of a large dinner plate, you see it has been expertly carved into a convex shape that allows it to act as a simple magnifying lens.". Rule for printing the name of a circle of quartz while listing contents: say "circle of [o]quartz[x]". Instead of taking circle of quartz: say "It's too heavy to carry it around, and encrusted with enough dirt and grime to not function very well as a magnifier any more, regardless." Understand "look through [circle]" or "look in [circle]" as a mistake ("Peering through the quartz, you can see how it has been shaped to magnify things. You study the various objects on the workbench for a few moments, but learn nothing useful.").

The ambience table of Egg Room is Table of Egg Room ambience.

Table of Egg Room ambience
freq		start time	end time	text	table		trigger	flag
common	--		--		--	Table of Windsigh ambience


Chapter - Egg Interior

The description of Egg Interior is "Though it seems the rounded walls of the interior were excavated some years ago, the jungle has crept back in already, sending tendrils of vines around the shadowy contents: a line of vertical [o]cylinders[x], transparent, cracked; a gutted bank of [o]controls[x] leaking wires and foam; and an etched [o]design[x] on the curved inner wall, almost entirely covered now in vines. [paragraph break][exits]." The exits text of Egg Interior is "[if night]A shaft of faint [light-source] slices in from the forest [dr]outside[x][otherwise]Daylight streams in through the [dr]gash[x] in the side of the egg providing [eteibit]". To say eteibit: say "[if dir]a way [out][otherwise]egress[end if]". Understand "gash" as outside when location is Egg Interior. The prose name of Egg Interior is "inside the Egg". 

EggInterior-stuff is stuff in Egg Interior. Understand "jungle/contents" as EggInterior-stuff when location is Egg Interior.

Check sleeping in Egg Interior: say "It's too cramped and creepy in here; but you saw a spot just outside.[sleepsuggest]" instead.

The transparent cylinders are an undescribed transparent container in Egg Interior. They are closed and unopenable and fixed in place. Understand "cylinder" as cylinders. The description is "There are twelve, each large enough to hold a person, smooth and transparent. Cracks, some long and sharp-edged and others explosions of fracture points, mar each cylinder's surface[if we have not examined the transparent cylinders], so that it takes you a long moment to realize that the crumpled white shapes inside are human [o]skeletons[x][otherwise], half-concealing the crumpled [o]skeletons[x] within[end if].". Instead of opening the transparent cylinders, say "They seem to have no clasp or handle that you can find, and the dusty controls along the side as dead and unresponsive as their occupants." Instead of attacking transparent cylinders: say "You smash one of the fractured cylinders as hard as you can with an elbow, but even though it is already fractured and weakened, you do not even cause the fracture lines to lengthen.". Instead of taking cylinders, say "They seem to be joined seamlessly to the curving walls of the Egg.".

The human skeletons are a setpiece in the transparent cylinders. Understand "skeleton" or "corpse" or "human" or "body" as human skeletons. The description is "[if we have not examined the skeletons]No-- not human. As you draw nearer, you see at once any number of subtle differences. A slightly rounder skull, wider spacing between the eyes, different numbers of knuckles or arrangement of joints. But the similarities vastly outnumber the differences, and you have no doubt that if these twelve were alive you would recognize a kinship in them, and they in you.[paragraph break][otherwise]Though not quite human, the skeletons are close enough to it that you find yourself chilled. [end if]Each lies crumpled in a heap against the padded rear walls of a cylinder, the muscles that held their shape together long since turned to dust.". Instead of taking or touching or pushing or pulling the human skeletons, say "The glass is cracked, but still intact, preventing you from reaching inside the transparent chambers.".

The gutted bank of controls is a setpiece in Egg Interior. Understand "control/wire/wires/foam/gaping/hole" as gutted bank of controls. The description is "Protruding in a seamless, graceful curve from the end of the tilted egg smashed into the ground, the console is mostly ruined; blackened and melted slag suggest complex machinery now destroyed. One part of the bank has been forcibly pulled back and exposed, leaving a gaping hole amidst the ruined components inside.". Instead of searching controls, say "Whatever was once in here is gone now.". Instead of pushing or pulling or touching or using controls, say "Curiously, the controls seem to be entirely within the 'shell' of the egg; nothing protrudes into the interior other than the warped and destroyed debris breaking through the crushed walls. Regardless, there is nothing which looks operable any more.". Instead of taking controls, say "The remaining material seems either melted or embedded into the shell of the egg.".

The egg-mural is a setpiece in Egg Interior. Understand "design/etching/symbol" as egg-mural. The printed name of egg-mural is "mural". The description is "[if we have not examined egg-mural]You pull away a few trailing vines for a better look. [end if]The etching, covering one rounded interior wall of the Egg, has the look of something burned into metal, although the wall is perfectly smooth. It shows an iconic, stylized symbol, simultaneously simple yet rich with detail, depicting a [o]man[x] with arms outstretched, intertwined in the roots of a great windsigh [o]tree[x].". Instead of taking or touching or pushing egg-mural, say "Other than the accumulated jungle grime, the surface of the mural is perfectly smooth.".

The human-in-the-mural is part of the egg-mural. The printed name is "figure in the mural". Understand "man" or "figure" or "part" or "arms" as the human-in-the-mural. The description is "Most striking about the figure, other than the tree roots twining around his body, sometimes hard to tell apart from muscle and sinew, is the head, depicted as a perfect oval, featureless, radiating light. The head makes a geometrical pattern with two other ovals: the human's smaller navel below, and a larger hole in the windsigh's trunk the same distance above.[paragraph break]In fact, the way the image is drawn, the head could just as easily be a smooth gap in the roots of the tree.".

The tree-in-the-mural is part of the egg-mural. The printed name is "tree part of the mural". Understand "tree/tree9" or "part" or "windsigh" as the tree-in-the-mural. The description is "The windsigh in this drawing is different than the ones you've seen on the island: taller and stronger. Now your vague intuition of stuntedness is borne out, as the tree in this etching is obviously in its prime in a way the ones here are clearly not.".

Report going from Egg Interior to Egg Room: say "You step back outside into the crater.".

Part - The Secret Island

Chapter - Backside

Report going from Egg Room to Backside: say "You push through vegetation blocking a gully leading out of one eroded side of the crater[if a random chance of 1 in 2 succeeds][time-of-day-bit][end if]. The ground quickly drops off and descends at a sharp angle towards the sound of the surf, not far below.". Report going from Backside to Seal Beach: say "You scramble down the last of the canyon to firmer footing on a rocky ledge.". Report going from Backside to Egg Room: say "You clamber up the last steep slope of the gully and climb back into the crater.".

The prose name of Backside is "the steep canyon behind the egg ship". The description of Backside is "[backsidedesc].". To say backsidedesc: say "Descending at a rate that requires both hands and feet to navigate, this debris-choked stream bed, dry at the moment, tumbles down the cliffs that make up this side of the island. Below, waves beat heavily against the cliff. [paragraph break][exits]". The exits text of Backside is "The gully continues [down] or [up]". The printed name of Backside is "Narrow Gully".

Backside-stuff is stuff in Backside. Understand "gully/side/crater/angle/bed/stream/cliffs/cliff" as Backside-stuff when location is Backside.

Instead of sleeping in Backside, say "It's too steep here for that.[sleepsuggest]".


Chapter - Seal Beach

The prose name of Seal Beach is "the seal beach". The description of Seal Beach is "[sealbeachdesc].". To say sealbeachdesc:
	say "The canyon abruptly drops off here to a short, rocky beach covered in speckled brown [o]seals[x], grunting and shuffling lazily. A waterfall cascades off the cliff from the dense wall of rain forest above, vanishing into the wet stones in the hidden alcove. Across what looks to be a deep and turbulent channel of seawater rises a tiny domed island like a balding head, lush green trees sprouting from its upper slopes[dot]";
	say "A rope [o]bridge[x] spans the channel to the small island[if puzzle mode], but it starts from a rocky boulder a stone's throw away; even though a narrow wooden [o]archway[x] on the ledge you stand on seems to be a gateway to it, you see no way to get across to the bridge. A [o]pillar[x] rises from the ground near the archway[end if][dot]";
	say "[exits]".

The exits text of Seal Beach is "[etsealbeach]". To say etsealbeach: if secret rope bridge is open, say "The dry streambed leads [bw of Backside][up] towards the plateau, or you could head [dr]across[x] the bridge[if dir] to the [northeast][end if] [bw of Overhang]towards the tiny island"; otherwise say "The dry streambed leading [bw of Backside][up] is the only place you can really get to at the moment". Understand "across" as northeast when secret rope bridge is open and location is Seal Beach.

Some mottled seals are an undescribed animal in Seal Beach. The description is "The seals bask noisily on the small beach, packed in so tight you almost cannot see the rocky sand beneath them.". Understand "seal" as some seals.

The seal-waterfall is a setpiece in Seal Beach with printed name "waterfall". Understand "waterfall" as seal-waterfall.

The tiny domed island is scenery in Seal Beach with description "Lush green vegetation clings to the top of the tiny island as if it were the only spot of land in the world.".

A rocky boulder is minor scenery in Seal Beach with description "The sheer, algae-slicked sides of the boulder rise from the turbulent channel, unconnected to either the main island, and joined to the smaller domed island by the bridge.".

Check vague swimming when location is Seal Beach: say "Swift currents seem to be moving through the deep passage between here and the domed island, and foam laps angrily against sharp rocks. This is not a good place to swim." instead.

Section - Rope Bridge and Pillar

The secret rope bridge is an undescribed door. It is northeast of Seal Beach and southwest of Overhang. The secret rope bridge is unopenable and closed and not lockable. The description is "The long rope bridge arcs gently over the peaky, deep blue waves crashing against each other in the channel below, some three or four times your height above them, before reaching what looks like a grotto on the small island.". Instead of crossing the secret rope bridge, try entering the secret rope bridge. Instead of entering the secret rope bridge when secret rope bridge is closed, say "You can't get to the start of the bridge from here; it runs from the secret island to the top of a freestanding boulder a good distance from your ledge above the beach.". Instead of going northeast in Seal Beach when secret rope bridge is closed, try entering the secret rope bridge.

Instead of jumping when location is Seal Beach, say "On this tiny ledge, you have no way to get a running start or even a good solid push-off point-- you'd never make it.".

Instead of going down in Seal Beach: say "There's not a good way to scramble down to the beach from here, and even if you could, there'd hardly be a place to stand, and you'd disturb the seals. Or, judging by their size, they might well disturb you instead.".

The secret-bridge control is an open unopenable undescribed container in Seal Beach with printed name "pillar". It is fixed in place. Understand "pillar/indentation/jagged/hole" as secret-bridge control. The description is "It rises to about waist height and is featureless, except for a circular indentation on its flat top. In one half of the indentation is a jagged hole, in the shape of a seven-pointed star.". Instead of inserting the compass into the secret-bridge control when the compass is unmolested or the compass is revealed: say "The compass fits in the indentation perfectly[if compass is revealed], and the star shape lines up with the hole in the indentation,[end if] but no matter how you push, prod, twist, or align it, nothing seems to happen. You pick it back up and put it around your neck again.". Instead of inserting the compass into the secret-bridge control: now secret rope bridge is open; say "The extruded star shape and the compass fit perfectly in the indentations atop the pillar. As you drop it into place, a catch releases, and the wooden archway falls forward and slams down on the first plank of the rope bridge, allowing you to reach it and go [dr]across[x][if dir] [northeast][end if] to the other side.". Instead of putting something (called dongle) on the secret-bridge control: try inserting dongle into secret-bridge control. [Understand "lay/place/press" as "[press]".] Understand "lay [something] in/inside/into/to/on [something]" as inserting it into. Understand "place [something] in/inside/into/to/on [something]" as inserting it into. Understand "press [something] in/inside/into/to/on [something]" as inserting it into.

Instead of inserting something into secret-bridge control, say "That doesn't go there.". Instead of touching secret-bridge control, say "The pillar is just a simple wooden pole, slick with sea spray; the indentation on top is about the size of a pocketwatch.". Instead of pushing secret-bridge control, say "You push down on the indentation, but it is just a shape scooped out of the wood. Your finger is too large to fit in the seven-pointed hole in the bottom.". Instead of attacking secret-bridge control, say "The pillar seems firmly secured, and does not give to a good kick.".

The wooden archway is a setpiece in Seal Beach. The description is "[if secret rope bridge is closed]The narrow wooden archway is really just two vertical planks, joined at the top with a rounded connector[else]The archway has collapsed, forming two planks spanning the gap between you and the start of the rope bridge[end if].". Instead of pushing or pulling the wooden archway when secret rope bridge is closed: say "It seems a little wobbly, but something firmly resists your moving it very far.". Instead of pushing or pulling the wooden archway: say "You can't get any leverage to lift it back up.". Check entering archway: if secret rope bridge is open, try entering secret rope bridge instead; else say "The archway leads only to a sheer dropoff, with sharp rocks and a hungry sea below. A gap too far to jump stands between here and the boulder where the bridge begins." instead.

Report going from Seal Beach to Overhang: say "You walk across the long creaking plank bridge, swaying in the turbulence of the breeze and your footsteps, clutching the scratchy vine rails tightly, till you step under a rocky overhang at the island on the far side.". Report going from Seal Beach to Backside: say "You climb back up into the narrow canyon towards the rainforest above.".


Chapter - Overhang

The printed name of Overhang is "Open Grotto". The prose name of Overhang is "the grotto on the secret island". The description of Overhang is "[overhangdesc].".

To say overhangdesc:
	say "The side of the smaller island has eroded away here to make a long cave, open to the air all along the outer wall[dot]";	
	if lumpy moss-covered mound is on-stage, say "A lumpy moss-covered [o]mound[x] rests near the dropoff to the sea, green toes poking out over the edge[dot]";
	if mound of abandoned sculptures is on-stage, say "The [o]mound[x] of abandoned sculptures rests near the dropoff to the sea, kissed in grime and the moist salt spray[dot]";
	say "[exits]".

The exits text of Overhang is "The long cave continues [bw of Mossy Ledge][if dir][south] [end if][dr]around[x] the island's curve, or opposite shrinks to a narrow scramble [bw of Prison][up]. [if puzzle mode]Some rough-hewn stairs lead [bw of Echo Chamber][down] towards the ocean[else]There seems to be no way down to the ocean[end if][etovh2]". To say etovh2: say ", which the rope bridge [dr]crosses[x] [bw of Seal Beach][if dir]to the [southwest][else]over[end if]". Understand "around" as south when location is Overhang. Understand "crosses" as southwest when location is Overhang.

Instead of going down in Overhang when story mode, say "You don't see any way down to the ocean from here.".

The lumpy moss-covered mound is a setpiece in Overhang. Understand "moss/mossy/moss/covered" as moss-covered mound. The description is "Covered in a blanket of damp green moss, the mound is very irregular in shape, as if grown over a pile of differently sized stones with odd protrusions and curves.[paragraph break]Poking out from the edge of the moss at the base of the pile, something [o]crystalline[x] glints greenly and catches your eye.". Instead of pulling or taking or pushing the moss-covered mound: say "You pull away the moss and find more abandoned sculptures, sifting through them in wonder and sadness.[paragraph break]There are hundreds of them, carved from stone, crystal, wood, and bone. There are rough-hewn faces, fantastic animals half-formed, abandoned crude shapes perhaps the beginnings of mountains or clouds. There is a wooden violin, its neck rich with achingly intricate detail but its body an unsmoothed block; a breathtaking quartz tornado, stunning in its outline but the details of its facets not quite right; an old woman's smiling face emerging from a block of something like granite, every wrinkle and line etched with care, but unable somehow to free more than the left side of her face from the stone. None of them are finished. Many are cracked or shattered, or bear scars where furious blows with knife or chisel mar their artistry.[paragraph break]Finally, you step back, leaving the pile of sculptures where it rests, and can't shake a vaguely horrified feeling, as if you've just found a mass grave."; move mound of abandoned sculptures to Overhang; remove lumpy moss-covered mound from play.

The mound of abandoned sculptures is a setpiece. Understand "sculpture" as mound of abandoned sculptures. The description is "The pile of sculptures, balanced just shy of the dropoff to the ocean, seems sad and ghostly in the misty air.". Instead of pushing mound of abandoned sculptures: say "You push against the side of the mound with your shoulders, spreading out your arms, and it collapses with a chorus of groans and tinkles and scrapes, each piece plummeting in spins and whorls to the surf below and disappearing. You keep pushing until every one has fallen off the edge, and only chalky ghosts of sawdust and crushed stone remain."; remove mound of abandoned sculptures from play; remove songbird sculpture from play.

The songbird sculpture is a prop in Overhang. Understand "crystalline/bird" as songbird sculpture. The description is "You pull a piece of the moss away to get a better look. Underneath is part of a blue crystal sculpture of a songbird in flight-- but unfinished, the wings still crudely shapen, one roughly broken off. The rest is buried under the moss." Instead of taking the songbird sculpture, say "[if lumpy moss-covered mound is on-stage]The moss is in the way[else]It seems to belong here, somehow[end if]." Instead of pulling the songbird sculpture, try taking the songbird sculpture.

Report going from Overhang to Prison: say "Ducking your head, you clamber up the quickly tilting floor and around a tight curve to squeeze through a crack into a small chamber near the top of the island.". Report going from Overhang to Mossy Ledge: say "You follow the open grotto around the curve of the tiny island till you reach its ending on the side facing the open sea.". Report going from Overhang to Echo Chamber: say "You take a steep path near where the bridge connects, picking your way down to a cave nearer to sea level, which you slip cautiously inside."

Chapter - Prison

The prose name of Prison is "the prison". The description of Prison is "[prisondesc].". To say prisondesc:
	say "This round cave is open to the sky at the ceiling. The ground is covered with crumbled rock and rubble[dot]";
	say "Against one wall of the chamber is a crude [o]cage[x] constructed of bamboo bars and a simple wooden door. [if night and moonup]The wall opposite is alight with a long glowing [o]scrawl[x] of writing[else]On the top of the wall opposite is a [o]scrawl[x] of writing, with a huge empty space underneath[end if][dot]";
	say "[exits]".

The exits text of Prison is "A [dr]crack[x] leads [bw of Overhang][if dir][west] and [end if]down to the grotto, or you could stoop [bw of Mossy Ledge]into [one of]a[or]the[stopping] narrow [dr]tunnel[x][if dir] to the [east][end if]". Understand "crack" as west when location is Prison. Understand "tunnel" as east when location is Prison.

Report going from Prison to Overhang: say "You squeeze through the crack and then step carefully down a broken passage to the open grotto below.". Report going from Prison to Mossy Ledge: say "You duck awkwardly through the entrance, but it quickly opens up to a narrow path running down and around the outside of the island. You follow it carefully around until you reach the grotto again.".

The bamboo cage is an enterable transparent undescribed container in Prison. It is fixed in place. The description is "The bamboo runs into holes chiseled in the floor and wall, making the bars bow outward slightly and then curve back in to form the cell's ceiling. Some stone manacles and some dirty straw are all you can see inside[if the psyche of Progue is at least uncertainty].[paragraph break]The door to the cage is open, swinging loosely in the still air[end if].". Understand "door" as the bamboo cage. Instead of closing or opening bamboo cage, say "The door swings loosely, without a latch or any way to keep it shut.". 

Some stone manacles are a prop in the bamboo cage. The description is "Crude and heavy.". Instead of taking stone manacles, say "They are attached to the wall. Curiously, however, you note that were your hands put in them, it would be perfectly possible to take them out again.". Check entering manacles: say "You slip your hands inside the manacles, but feel nothing unexpected, so you easily remove them again." instead. Understand "put hand/hands in/into [manacles]" as entering when location is Prison.

Some dirty straw is a prop in the bamboo cage.

Report entering the bamboo cage: say "You open the door and step inside. Something about it seems odd, but you can't put your finger on it." instead. Report exiting when player was enclosed by the bamboo cage: say "You step through the door again. As you do so, you notice that it has no lock." instead.

The prison scrawl is a story-based scrawl in Prison. The standard message is "Everything I am is taken from me but". The secret message is " my soul, and it lies broken and bleeding on the verge of verges. It is here, in this cage.

Angry. It wants to hurt me. I do not want it to live, but I cannot kill it. It is all I have left.

I will come here to tend it, mayhaps once a year or so. Bring it food and water. Talk to it, laugh with it, cry with it.

Make sure it is not getting too well.

It will stay here, a prisoner, so it will not ask me to feel remorse, so it will not ask me to make decisions, so it will not ask me to remember those I have lost, so it will not judge, belittle, hate, hurt, harm me. It will stay here alone, with the rest of my failings.

Because if it escapes, it will try to kill me. And I don't want death to come at its hands.".


Chapter - Mossy Ledge

The prose name of Mossy Ledge is "the grotto near the cave paintings". The printed name of Mossy Ledge is "Grotto, At the Cave Paintings". The description of Mossy Ledge is "[mossyledgedesc].". To say mossyledgedesc:
	say "The grotto is slightly less open on this end, the floor rising at the edge of the dropoff and the ceiling dropping columns of stone, but plenty of [if night]star[end if]light still streams in to to illuminate the space, which feels more dusty and abandoned than the other side. Blackened scorch marks on the floor and ceiling speak to ancient fires[dot]";
	say "The back wall of the grotto is covered in ancient [o]paintings[x], faded but still clearly visible[dot]";
	say "[exits]".

The exits text of Mossy Ledge is "The grotto curves [bw of Overhang][if dir][south] [end if]towards its [dr]far[x] end, while a narrow [dr]ledge[x] breaks out of the overhang to follow the curve of the island [bw of Prison]around up[if dir] and [north][end if]". Understand "far" as south when location is Mossy Ledge. Understand "ledge" as north when location is Mossy Ledge.

Report going from Mossy Ledge to Overhang: say "You walk back along the uneven ground of the grotto, curving around to the landward side of the island again.". Report going from Mossy Ledge to Prison: say "You follow the path, really just a convenient crack in the rock, out from under the overhang and steeply up around the curve of the island. Finally it ends at a natural tunnel, which you duck into and take a few awkward steps before standing in another chamber.".

Some cave paintings are a setpiece in Mossy Ledge. Understand "painting/drawing/drawings" as cave paintings. The description is "The paintings seem ancient, far older than anything you've seen that Progue created, or even any of the remnants of the Egg. They are crude and sometimes difficult to decipher.[paragraph break]The largest quite clearly shows the seals you saw on the beach, drawn in crude red lines, alongside two boats containing bare-chested males with spears. Another drawing seems to show one of the figures dressing a killed seal next to a fire.[paragraph break]Other drawings are more obscure; there are certain symbols which are repeated multiple times, sometimes even overlapping, but nothing that seems like written language. The only other scene you can make out shows a few of the tiny boats surrounded by clusters of irregular shapes, some with lines drawn between them. One of them almost seems familiar: a broken-backed crescent with two peaks at the top and bottom.". Instead of taking or touching cave paintings, say "They're drawn directly on the rock.".

The scorched remnants of fires are a minor setpiece in Mossy Ledge. The description is "The ash has long since blown away, leaving only blackened marks on the rock."


Chapter - Echo Chamber

[This area is not accessible in story mode, since it's part of the puzzle to open the pyramid that is simplified in that mode.]

Report going from Echo Chamber to Overhang: say "You leave the dim interior of the cave and scramble back up the narrow path.".

The prose name of Echo Chamber is "the echo cave". The description of Echo Chamber is "[echochamdesc].". To say echochamdesc: say "[if sunup]L[otherwise]Faint starl[end if]ight streams from [if dir][outside][otherwise]the [d]mouth[x] of the cave[end if] into this large, rounded chamber, its low ceiling dripping with seawater. Echoes and whispered reverberations fill the space, and you feel the thunder of the surf beneath you; waves must be surging through smaller caves and channels beneath this one. The strange noises seems to be shaped and amplified by dozens of strange [o]formations[x] along and inside the walls, shaped in ways too regular to be "; say "natural[if puzzle mode].[paragraph break]A large [o]message[x] written in soot covers part of the wall near the exit, next to a drawing of a pyramid[end if]". The exits text of Echo Chamber is "A smattering of green [o]mussels[x] clings to the rock near the mouth of the cave, the only exit, sloping [up]". Understand "mouth" as up when location is Echo Chamber.

The soot-pyramid-drawing is a minor setpiece in Echo Chamber with printed name "drawing of a pyramid". Understand "drawing/pyramid" as soot-pyramid-drawing. The description is "The crude drawing shows a three-dimensional pyramid with light streaming from its edges.".

The echo message is a hint-based scrawl in Echo Chamber with standard message "Word Morphosis Chamber: Experiment in Sculpted Echoes." and secret message " Try konokuk, capalla, or windsigh."

Instead of listening when location is Echo Chamber: say "Weird echoes and reverberations bounce around the interior of the chamber, shaped and amplified by the strange formations.". Instead of whistling when location is Echo Chamber: let atd be indexed text; let atd be the player's command; say "You [atd in lower case] as loud as you can. Immediately you clap your hands to your ears; the sound reverberates crashingly around the tiny chamber, seemingly to be amplified and distorted by the fluted formations and resonance chambers around you, and it's as if hundreds of other people just outside your ears are all making the same noise.[paragraph break]Finally the echoes fade away, leaving only the hollow whispers of the surf moving through hidden tunnels below your feet.". To say echochmmsg: say "Your words echo and bounce strangely around the inside of the chamber, twisted and distorted by the strange fluted formations into a thousand whispers that almost sound at times like other words. Only slowly do the echoes die away". Understand "echo" as a mistake ("[echochmmsg].") when location is Echo Chamber.

EchoChamber-stuff is stuff in Echo Chamber. Understand "canyon/plateau/cave/chamber/ceiling/seawater/caves/channels" as EchoChamber-stuff when location is Echo Chamber.

Instead of sleeping in Echo Chamber: say "It's too wet and drippy in here to sleep. [sleepsuggest]".

The strange formations are a setpiece in Echo Chamber. Understand "formation" or "dozens" as strange formations. The description is "Smooth and curved, with fluted edges and rounded tunnels, these look almost like wind-carved features but are too carefully shaped and molded to be natural. Most are carved directly into the natural cavern wall; some are tunnel openings of various sizes. There are even a few large holes in the floor which seem to open into carefully shaped resonance chambers below your feet, where the crashing surf gurgles and drains.". Instead of touching formations, say "They are mostly smooth, arcing through strange contortions and swirls, usually with openings on one or both ends indicating they are hollow, like some huge strange musical instrument.".

The shapes are a described setpiece in Echo Chamber. "Drawn in chalk at various positions across the floor are six [o]shapes[x], large enough to stand in." The description is "The shapes, each about the diameter of your outstretched arm, are roughly drawn of a white, flaky substance, and spread out across the floor in no obvious pattern or reasoning. There is a [o]triangle[x], a [o]square[x], a [o]circle[x], a [o]rectangle[x], a [o]pentagon[x], and a [o]hexagon[x].".

An echo-shape is a kind of supporter. Understand "shape" as an echo-shape. An echo-shape is always undescribed and enterable. The triangle shape is an echo-shape in Echo Chamber. The square shape is an echo-shape in Echo Chamber. The circle shape is an echo-shape in Echo Chamber. The rectangle shape is an echo-shape in Echo Chamber. The pentagon shape is an echo-shape in Echo Chamber. The hexagon shape is an echo-shape in Echo Chamber. The description of an echo-shape is usually "Drawn roughly on the ground with some sort of chalky substance.". Instead of taking an echo-shape, say "It's just a drawing on the ground."

Understand "step on/in/into [an enterable thing]" or "stand on/in [an enterable thing]" as entering. First report entering an echo-shape: say "[one of]As you move to [the noun] the shufflings of your feet make weird, suggestive echoes that dance around the cavernous chamber[or]Echoes dance around the chamber as you move[stopping]. You step inside [the noun]." instead. 

An echo-keyword is a kind of thing. An echo-keyword is always undescribed. Understand "say [an echo-keyword]" or "shout [an echo-keyword]" as examining when location is Echo Chamber. An echo-keyword is either pending or uncovered. An echo-keyword is usually pending.

Understand "shout [text]" as echo-speaking when location is Echo Chamber. Echo-speaking is an action applying to one topic. Carry out echo-speaking: say "You call it out loud and clear. Instantly, the weird shapes and formations suck your utterance up, twist it around, and send it back to you weirdly changed and deformed to reverberate around the cavern until finally dying down.".

The knock-keyword is an echo-keyword in Echo Chamber. Understand "konokuk" as knock-keyword. The description of knock-keyword is "You call out the word. [if player is on the square shape][echo-text]'knock,' [echo-text2][otherwise][echo-text-bad][end if].".

The thrice-keyword is an echo-keyword in Echo Chamber. Understand "windsigh" as thrice-keyword. The description of thrice-keyword is "You call out the word. [if player is on the circle shape][echo-text]'thrice,' [echo-text2][otherwise][echo-text-bad][end if].".

The clap-keyword is an echo-keyword in Echo Chamber. Understand "capalla" as clap-keyword. The description of clap-keyword is "You call out the word. [if player is on the pentagon shape][echo-text]'clap,' [echo-text2][otherwise][echo-text-bad][end if].". 

To say echo-text: say "The weird shapes and formations suck your utterance up, twisting the sounds around before bouncing back what sounds to you like a single clear word: ". To say echo-text2: say "which echoes and bounces around the chamber before finally fading into indistinguishable murmurs". To say echo-text-bad: say "It bounces and echoes off the walls, and at times you think you can make out hints of something almost comprehensible, but too soon the echoes fade away into murmurs".


The ambience table of Echo Chamber is Table of Echo Chamber ambience.

Table of Echo Chamber ambience
freq		start time	end time	text	table		trigger	flag
common	--	--	"[one of]A drop of water falls from the ceiling into a pool, creating a bizarre, reverberating echo that bounces around inside the strange formations, dying only slowly and reluctantly[or]The shuffling of your feet produces strange stuttering echoes that bounce around the cave weirdly[or]The surf thunders through the openings under your feet, creating a great rush of noise that bounces and echoes strangely through the cave[in random order]."


Part - Ravine Floor and Cave

Instead of sleeping in Narrow Ravine, say "When the tide comes in, you'll be smashed to pieces. Not a good idea.[sleepsuggest]".

Chapter - Ravine Floor

Understand "top" as west when location is Ravine Floor. The prose name of Ravine Floor is "the floor of the great ravine". The description of Ravine Floor is "[ravfloordesc].". To say ravfloordesc:
	say "Surrounded by sheer cliffs on both sides, [if sunrise or morning]the wet surfaces of the ravine sparkle and glow in the brilliant morning light shining straight down its length and reflecting off the ocean[otherwise if night]the ravine is lit by only a narrow causeway of stars high above[otherwise if dawn]the ravine is chilly in the predawn glow, though the brightening glow over the ocean visible at its mouth is breathtaking[otherwise if twilight]the ravine already feels dark even though the failing light above is still strong[otherwise]the floor of the ravine is shadowed and chilly[end if]. [if falling downtide or rising uptide]Waves smash angrily against the barricade of boulders down at the mouth of the inlet, before charging raucously up its length over a channel of smooth stones that roll and grind together with a tremendous racket[otherwise]Distant waves beat against the cluster of boulders at the mouth of the inlet, but only rarely surge over to disturb the peace of standing pools of water here and there[end if][dot]";
	say "Near an outgrowth of blue [o]crystal[x] in the wall is a yellow [o]pipe[x][dot]";
	if time-for-shark-scene is true begin; now time-for-shark-scene is false; move beached shark to location; move tidepool-mud to location; say "Flopping helplessly in the remnants of a long-drained tidepool is a blue-grey [o]shark[x], almost as big as you[dot]"; end if;
	say "[exits]".

The exits text of Ravine Floor is "The rope ladder climbs back [up] towards the forested plateau; the surf is too threatening to venture farther[if dir] east[end if] down the ravine, but[if dir] [west][end if] towards the [dr]top[x] looks passable".

RavineFloor-stuff is stuff in Ravine Floor. Understand "cliff/cliffs/surface/surfaces/causeway/barricade/boulders/channel/stone/stones/cluster/pools/plateau" as RavineFloor-stuff when location is Ravine Floor.

Every turn when location is regionally in Narrow Ravine and tidein (this is the escaping the rising tide rule):
	say "A breaker surges past your feet, momentarily throwing you off balance. The tide is rapidly coming in. Hurriedly, you [if location is Top of Ravine]follow the ravine back down to the rope ladder[otherwise]clasp the rungs of the rope ladder[end if] and haul yourself back up to safety.";
	move the player to Edge of Ravine.

Report going from Ravine Floor to Top of Ravine: say "[if rising downtide or falling downtide]Picking your way carefully over the foam-slick stones[otherwise]Walking around drying clumps of seaweed and brine-encrusted stones[end if], you travel up the ravine as it narrows towards its end.". Report going from Ravine Floor to Edge of Ravine: say "You climb the ladder easily up the few dozen rungs till you stand again on the forested plateau.".

Section - Shark Rescue

[This is a post-tsunami scene that just adds a bit of diversion for the player.]

time-for-shark-scene is a truth state that varies.

The beached shark is set dressing. The description is "The creature's sleek skin is drying out now, and it still flops vigorously but with fading strength. It must have been thrown up here by the tsunami, or maybe just got confused by the strange tides and ended up stranded here. It rolls a baleful eye at you desperately.". Instead of taking beached shark, say "It's far too big for that, probably heavier than you are.". Instead of touching or hugging beached shark, say "Its skin is smooth as velvet where it is still wet, but feels like dry parchment and starting to flake in the places where the moisture is gone. You can feel its heart racing.". Instead of pushing or pulling beached shark when tidepool-mud is on-stage, say "You reach around the back half of the creature and push, but it's no use; the tidepool is blocked by a [o]clog[x] of mud and debris.". Instead of greeting beached shark, say "You try to murmur some words of comfort to the trapped creature, but it just snaps its jaws weakly at you and you take a hasty step back.". Instead of pushing or pulling beached shark: say "Getting a firm grip, you heave against the shark's bulk. It twists its flippers and snaps its jaw frantically, not understanding, but the panicky motions help break it free. With one final heave, it breaks forward out of the muck with a surge of water, sliding forward towards the water at the end of the ravine.[paragraph break]You follow it down until it reaches a much larger pool at the base of the wall of boulders currently keeping the surf out, where it quickly submerges and stays quiet and still. You have no idea whether he'll survive, but when the tide comes back in, it should wash him back out to sea.[paragraph break]You return up the ravine to the vicinity of the ladder, wiping the strange smells of sharkskin on your hands off on your pants."; remove beached shark from play. Instead of attacking beached shark, say "You hardly have a suitable weapon for that.".

Some tidepool-mud is set dressing. Understand "mud/clog/debris/leaves/rocks" as tidepool-mud. The printed name is "a dam of mud and debris". The description is "The end of the pool facing the slope down to the distant waves is clogged with a dam of mud, leaves, and rocks.". Instead of taking or pushing or pulling or attacking some tidepool-mud: say "Careful to keep your hands clear of the shark's razor jaw, you clear the worst of the mud and debris away. A gush of warm water surges out of the opening and down the shallow slope towards the ocean."; remove tidepool-mud from play.

Chapter - Top of Ravine

The prose name of Top of Ravine is "the top of the great ravine by the pool". The description of Top of Ravine is "[topravdesc].". To say topravdesc: say "The ravine pinches off here at a boulder-strewn [o]slope[x]; craning your head back, you can make out [windsigh phrase of tree3] high above at its summit. A [o]bowl[x] at the base of the slope, probably scooped out from the churning action of the high tide surf breaking and rebounding against this point, is filled with seawater and lined with small green [o]mussels[x]. [paragraph break][exits]". The exits text of Top of Ravine is "The rope [dr]ladder[x] halfway [if dir]down the ravine to the [east][otherwise]down the ravine[end if] stands out as the only obvious means of escape from this sheer canyon[if Water Cave is visited], other than the [d]tunnel[x] underneath the water[else]; but you also notice a strange [o]shadow[x] under the water of the bowl[end if]". Understand "ladder" as down when location is Top of Ravine.


The boulder-strewn slope is a setpiece in Top of Ravine. Understand "base" as boulder-strewn slope. The description is "The slope is mostly loose scree dotted with the occasional boulder, steepening as it approaches [windsigh phrase of tree3] on its top." Instead of climbing the boulder-strewn slope, try going up. Instead of going up in Top of Ravine, say "The slope at the top end is too loose and crumbly to climb, while the cliffs on either side of you are too steep and undercut to make climbing them an option." 

The ravine cave mouth is a setpiece in Top of Ravine. Understand "shadow/shadows" or "tunnel" as ravine cave mouth. The description is "[if Water Cave is visited]Under the surface you can see the [d]tunnel[x] to the underwater cave[otherwise]Peering closer through the foamy surface, you see what looks like an underwater [d]tunnel[x], wide enough to walk down with only a little hunching were it above the water level[end if].". Instead of entering ravine cave mouth, try going west. Understand "tunnel" as west when location is Top of Ravine.


The oversized tidepool is an undescribed setpiece in Top of Ravine. Understand "bowl" or "tide" or "pool" or "water/seawater" as tidepool. The description is "The lip on the seaward side is craggy lava rock, but the floor some two body lengths down is smooth and sandy. Pillowy clumps of foam still clinging to the sides of the pool are a reminder of the brutal pounding this place must receive at high tide.[paragraph break]Underneath the windswept surface of the water, you can make out [if Water Cave is visited]the[otherwise]what looks like a flooded[end if] [dr]tunnel[x][if dir] heading [west][end if].". Instead of touching oversized tidepool, say "The languid seawater has been heated by the sun.". Instead of vague swimming in Top of Ravine, try going west. Instead of swimming in oversized tidepool: try going west. Instead of entering oversized tidepool: try going west. The dream-text of oversized tidepool is "tanks filled with seawater". 

 Instead of going to Water Cave when night, say "In the darkness, you'd be certain to drown down there. Better wait until morning.". 

Understand "tunnel" or "enter tunnel" or "go tunnel" as west when location is Top of Ravine.

Report going from Top of Ravine to Water Cave:
	now breath count is 4; say "After preparing yourself, you dive into the water, surprisingly chilly, and surface near the center, treading water-- the sandy bottom is below the reach of your feet.[paragraph break]Taking a deep breath, you dive beneath the surface, force your eyes open against the briny water, and swim into the darkness of the rocky tunnel mouth. The tunnel slopes steeply downwards for a short distance before leveling out again.".


Chapter - Water Cave

The prose name of Water Cave is "the underwater cave". The description of Water Cave is "[watercavedesc].". To say watercavedesc: say "The tunnel sides are smooth and regular, though the top vanishes into a gloomy labyrinth of jumbled boulders and false ceilings. [exits]". The exits text of Water Cave is "Any one of the dark routes [up] above could be worth exploring, though the [dr]glow[x] from the tunnel mouth[if dir] [east][end if] is more appealing". Understand "glow" as east when location is Water Cave. 

Instead of sleeping in Water Cave, say "Good one.[sleepsuggest]". Instead of vague swimming in Water Cave, try going up.

Breath count is a number that varies. Breath count is 4. Every turn when location is not Water Cave and breath count is not 4: now breath count is 4.

Every turn when location is Water Cave:
	if breath count is 4, say "You let a small clump of spent air bubbles out from your mouth, which rise into the blackness above.";
	if breath count is 3, say "Already you feel a faint urge to breathe. You focus on moving calmly and efficiently.";
	if breath count is 2, say "The urge to breathe is growing stronger. You won't have much longer before you'll have to retreat.";
	decrement breath count by 1.

Every turn when location is Water Cave and breath count is 0:
	say "Your air is almost gone; your lungs flex involuntarily. Kicking powerfully, you swim back down the tunnel, up the steep bend and out into the tidepool, breaking the surface and gasping air gratefully.";
	move the player to Top of Ravine.

Instead of going up from Water Cave for the first time, say "You swim up one promising slope only to dead end at a cluster of mossy rocks. Awkwardly, you push yourself back down to the open space below.". Instead of going up from Water Cave for the second time, say "You swim around a protruding boulder to try again, but a smooth ceiling of rock again frustrates you and you return below.".

Report going from Water Cave to Top of Cave:
	if Top of Cave is unvisited, say "[if breath count < 2]In desperation, y[otherwise]Y[end if]ou swim into a small opening near the back of the cave and thrill to see the silvery underside of a surface! Kicking powerfully, you break the surface and climb gratefully onto a slick boulder.";
	otherwise say "You find again the small opening near the back of the cave, swim up to the surface, and climb up out of the water.".

 Report going from Water Cave to Top of Ravine: say "You kick back through the tunnel, up the steep bend and out into the tidepool, where you break the surface and climb out into the chilly air again.";


Chapter - Top of Cave

The prose name of Top of Cave is "the top of the underwater cave". The description of Top of Cave is "[topcavedesc].". To say topcavedesc: say "A small pool of seawater marks the bottom of this irregular shaft, rising haphazardly [up] towards a circle of [if night]stars[otherwise]sky[end if] high above. Twisted tree [o]roots[x], some thick, others just tips, break through the walls everywhere, even reaching to the edge of the pool [down] by your feet". The exits text of Top of Cave is "The pool lies [down] beneath your feet, while [up] above rises the shaft".

TopOfCave-stuff is stuff in Top of Cave. Understand "shaft/circle/edge" as TopOfCave-stuff when location is Top of Cave. 

Instead of sleeping in Top of Cave, say "It's too cramped and bumpy here to lie down, much less fall asleep.[sleepsuggest]".

Some tree roots are a setpiece in Top of Cave. Understand "twisted" as tree roots. The description is "The roots are [if night]black, only vague shadows in the dimness[otherwise if dawn or twilight]grey ghosts in the faint light that trickles down from above[otherwise]pale white and smooth, twisting strange contortions through the air before plunging into the rocky soil of the shaft's walls once again.". Instead of climbing or entering the tree roots, try going up. Instead of touching tree roots, say "You feel a faint, almost electrical tingling, but nothing more.". The dream-text of tree roots is "shadowy snarls of huge twisted tree roots".

The small pool of seawater is a setpiece in Top of Cave. The description is "[if rising uptide or falling uptide]The water sloshes rhythmically against the tree roots, rising and falling sometimes several feet at a time[otherwise if high tide]The surface of the pool is a frothy maelstrom, sometimes sucked more than a body length down before exploding upwards to splash you with seawater[otherwise]The surface of the pool is calm, and undisturbed; below, you can see the subsurface cave you swam in through[end if].". Instead of vague swimming in Top of Cave: try going down. Instead of swimming in or entering small pool of seawater, try going down.

Instead of going down in Top of Cave when tidein, say "Judging by the way the surface of the pool is moving, the tide must be in and the cave below must be a roiling mess of strong currents and tidal forces. You'll have to find another way out.". Instead of going down in Top of Cave when current episode is Earthquake or current episode is Water Works: say "The water is doing strange things; you could drown or be smashed to pieces. Better not.".

Report going from Top of Cave to Saddle: say "The roots provide easy handholds and footholds for your ascent, though you must sometimes twist your body awkwardly in the small space to get past them. You climb easily to the top of the shaft and emerge [if night]into the silvery night[otherwise]blinking into light[end if].[if Saddle is unvisited][section break][end if]". Report going from Top of Cave to Water Cave: say "Contorting awkwardly in the small space, you dive into the pool of seawater and kick your way down to the watery cave below.".

Chapter - Saddle

The prose name of Saddle is "on the saddle at the base of the huge windsigh". The printed name of Saddle is "On the Saddle". The description of Saddle is "[withindesc].". To say withindesc: say "On this narrow edge of land between the cliffs of the mountain[if dir] to the north[end if] and the badlands of the lava flow opposite is [windsigh phrase of tree3], the tallest you've seen, rising high into the tropical air. [if dir]To the west[otherwise]Opposite the ravine[end if], the land descends sharply to one end of the lagoon: you spot your tracks in the sand and the huge piece of driftwood below.[paragraph break]At your feet, "; say "[if withered vine is open]a loose vine descends to the [dr]beach[x] below[wvinit_bit][otherwise]a loose [o]vine[x], though still connected to its tree, lies unwrapped and loose in a twisted pile[tsunvinehint], browning towards its end[end if]. A tangle of other vines forms a soft [o]bed[x] near the tree's base. [exits]". The exits text of Saddle is "The natural tunnel [if former location is Top of Cave]back [end if][down] seems the only [if withered vine is open]other[else]sensible[end if] way to go". Understand "beach" as west when location is Saddle and withered vine is open.

Check jumping when location is Saddle or location is Atop: say "It's a long way down." instead.

Saddle-stuff is stuff in Saddle. Understand "edge/cliff/cliffs/badlands/tracks/driftwood/perch/tunnel" as Saddle-stuff when location is Saddle.

The withered vine is an undescribed door. It is closed, locked, not lockable, and unopenable. Understand "loose" as withered vine. It is west of Saddle and east of North Beach. Understand "tie [withered vine] to me/myself/waist" or "attach [withered vine] to me/myself/waist" as a mistake ("The vine is far too long to use for swinging, but [if open]you could climb it[otherwise]it might reach to the beach on the west side if you pushed it off the edge[end if]."). The dream-text of  withered vine is "looping coils of vine". Instead of examining by name tree3's treevines when location is Saddle, try examining withered vine. Instead of climbing withered vine, try entering withered vine. Instead of entering withered vine when withered vine is closed and location is Saddle, say "Interesting. Perhaps if you pushed the vine over the edge, it would reach far enough down towards the beach that you'd be able to climb it.". Understand "climb down [something]" or "climb [something] down" as climbing when location is Saddle. First Instead of taking withered vine: say "You lift a section of the long vine. Despite its withered appearance, it still seems quite strong.". Instead of going west in Saddle when withered vine is closed, say "The vine is in a long, loose coil, but perhaps if you pushed it over the edge, you'd be able to climb down to the beach.". Understand "uncoil [something]" as pushing when location is Saddle. Check attacking withered vine: say "It's probably more useful to leave it attached." instead. After examining withered vine: have the parser notice withered vine.

The description of withered vine is "[if location is North Beach]The vine rises up the cliff towards the windsigh on the saddle up above.[else if withered vine is open]The vine, still attached firmly to the tree, dangles over the side of the saddle and stretches in a line down to the beach below.[else]The vine still seems firmly attached to the tree near its base, but disease or age seem to have weakened its grip, and it lies in a long, tangled coil amidst the tree roots.[end if]".  To say tsunvinehint: if Tsunami Sequence has ended, say ", balanced precariously close to the edge of the dropoff to the beach".   To say wvinit_bit: say "[if dir] and to the [west][end if]". Does the player mean doing something with withered vine: it is very likely. First check dropping withered vine: try pushing withered vine instead. Does the player mean doing something with something part of tree3: it is unlikely. 

Understand "push [something] to/over/off edge/cliff/saddle/dropoff" as pushing when location is Saddle. Instead of using or pushing withered vine when withered vine is closed and location is Saddle: now withered vine is open; now withered vine is unlocked; say "Untangling the vine, you push it off the edge of the saddle towards the beach of the lagoon, and are delighted to see that it reaches nearly to the sand below." Instead of using or pushing withered vine when withered vine is open: say "The vine is already serving as a crude rope to the sands of the beach below.". Instead of taking or pulling withered vine when withered vine is open: say "It seems more useful to leave the vine the way it is, in case you need easy access to this spot in the future.". Instead of pulling withered vine when withered vine is closed, say "One end is firmly attached to the massive windsigh, while the other flops free at the end of a long coil."

Report going from Saddle to North Beach: say "Gripping the vine carefully, keeping your [if player is wounded]good foot[else]feet[end if] to the slope, you half walk, half lower yourself down the vine one step at a time, before finally dropping onto the smooth beach sand below."; pass 5 minutes of time. Report going from North Beach to Saddle: say "Stretching to grip a thick enough portion of the vine to support your weight, you painfully hoist yourself up high enough to where you can support some of your weight on the steep slope, and pull yourself slowly up to the top of the narrow ridge."; pass 10 minutes of time.

Tree3 is a windsigh tree in Saddle. The description is "This tree is the largest you've seen on the island, and from this vantage point it's clear why: the yellow leaves are in full sunshine every day from morn to night. [if location is Saddle or location is Atop]The smooth curves of the vines winding around the trunk would make for easy handholds and footholds[otherwise]It straddles a narrow saddle of land connecting the mountain with the lava flow[end if].".

The tree3-nook is a nook in Saddle. The printed name is "bed". Understand "bed" as tree3-nook. The description is "Perhaps the size of the tree means that more vines than usual have slumped and coiled near the base, but one particular set looks like it would be a soft place to sleep."  Instead of touching tree3-nook, say "The vines are springy and soft.". First report entering tree3-nook: say "You climb over one vine as wide as your torso and lie down on the coils. It takes you a moment of fiddling to get comfortable, but the springy vines mold to your back and after a few moments you feel very relaxed." instead. First report getting off when player was on tree3-nook: say "Reluctantly, you rise to your feet again." instead. The sleep message of Saddle is "Lulled by the rustling of the leaves above and the quiet sigh of the tree, you drift into a deep, bottomless sleep."

Instead of climbing or entering tree3, try going up. Report going from Saddle to Atop: say "Clutching the easy handholds offered by the spiraling vines, you begin a[if player is wounded] difficult[else]n easy[end if] ascent of the tree. Almost immediately the sense of vertigo is tremendous: balanced upon the knife edge of the ridge, the ground quickly becomes the far-below floor of the ravine on one side and the beach on the other. You look up instead, and before much longer arrive at a good standing spot where the main trunk finally splits into two wide branches."; pass 10 minutes of time. 

The ambience table of Saddle is Table of Saddle-Room ambience.

Table of Saddle-Room ambience
freq		start time	end time	text	table		trigger	flag
common	--		--		--	Table of Windsigh ambience
uncommon	--	--	--	Table of Lacuna Insect ambience
uncommon	--	--	--	Table of Seagull Air ambience


Chapter - Atop

The prose name of Atop is "atop the huge windsigh on the saddle". The printed name of Atop is "Atop the Highest Tree". The description of Atop is "[atopdesc].". To say atopdesc: say "Wind whips through your hair as you balance near the top of the tree, surrounded by branches splitting all around you until they become tiny twigs. The view of the island around you is tremendous, and above, the [if evening or sunset]yellows and pinks of the evening sky are vivid and stunning[otherwise if twilight]fading purples of the tropical sky make your fingers twitch for a brush[otherwise if dawn or sunrise]sky is scoured clean with the pastel colors of morning[otherwise]sun shines whitely down from a deep, blue sky[end if]. [exits][if night].[paragraph break]Above you, the [o]stars[x] shine bright and strong, twinkling only a little in the still night air[end if]". The exits text of Atop is "The narrow ridge [down] beneath your feet seems almost like another world".

Atop-stuff is stuff in Atop. Understand "twig/twigs/view/island" as Atop-stuff when location is Atop.

Instead of sleeping in Atop, say "Up here, you feel a bit too precarious for sleep, but perhaps down by the base of the tree you'd be able to drift off.[sleepsuggest]".

Report going down from Atop: say "Half reluctant and half grateful to reach ground again, you lower yourself down the trunk of the tree until you again stand on the knife-thin ridge.".

Check going to Atop: move tree3 to Atop. Check going to Saddle: move tree3 to Saddle.

The ambience table of Atop is Table of Atop ambience.

Table of Atop ambience
freq		start time	end time	text	table		trigger	flag
common	--		--		--	Table of Windsigh ambience
uncommon	--	--	--	Table of Lacuna Insect ambience
uncommon	--	--	--	Table of Seagull Air ambience


Book - Intelligent Hinting

A fast-forward rule for Finishing-the-Painting:
	move the player to Fork.

Lacuna-Sequence requires Meeting-Progue, The-Mysterious-Door, Getting-To-The-Lawn, Finding-the-Egg, Powering-Both-Devices, Opening-the-Pyramid, and Contacting-All-The-Trees.

Section - Meeting Progue

Meeting-Progue is a task. Definition: Meeting-Progue is complete: if Progue is attentive, yes; if Word Day is successful, yes.

Section - The Mysterious Door

The-Mysterious-Door is a puzzle. It requires Finding-The-Door, Door-Hints, Door-Action.

Finding-The-Door is a task. The venue is Back Room. Definition: Finding-The-Door is complete: if extended-hint-mode is false, yes; if Jumble is visited, yes; if Back Room is visited, yes.

Door-Hints is a not sequential puzzle. It requires Noticing-The-Colors, Finding-the-Berries, Finding-the-Tree-Leaves, Finding-the-Manta-Ink, Finding-the-Snails, Finding-the-Mussels, Finding-the-Somenium, and Learning-That-P-Writes-Right-To-Left.

Noticing-The-Colors is a task. Requirements for Noticing-The-Colors: do the action of examining small bands of vertical color. Definition: Noticing-The-Colors is complete: if extended-hint-mode is false, yes; if Jumble is visited, yes; if we have examined small bands of vertical color, yes. The apropos-list of Noticing-The-Colors is {lava tunnel door, lava wall, cobblestones, arc of small buttons}. 

Finding-the-Berries is a task. The venue is Sloping Meadow. Requirements for Finding-the-Berries: do the action of examining some berries. Definition: Finding-the-Berries is complete: if extended-hint-mode is false, yes; if Jumble is visited, yes; if we have examined some berries, yes. The apropos-list of Finding-the-Berries is {berry-bushes}.

Finding-the-Tree-Leaves is a task. The venue is Fork. Requirements for Finding-the-Tree-Leaves: do the action of examining lemon-yellow leaves. Definition: Finding-the-Tree-Leaves is complete: if extended-hint-mode is false, yes; if Jumble is visited, yes; if we have examined  lemon-yellow leaves, yes. The apropos-list of Finding-the-Tree-Leaves is {Tree1, Tree2}. 

Finding-the-Manta-Ink is a puzzle. It requires Waiting-Till-Night, Noticing-Ink.

Waiting-Till-Night is a reversible task. The venue is Center Beach. The command-sequence is {"wait till night"}. A red flag rule for Waiting-Till-Night: if not night, rule fails. Definition: Waiting-Till-Night is complete: if night, yes; if we have examined manta ink, yes; if extended-hint-mode is false, yes; if Jumble is visited, yes; no.

Noticing-Ink is a task. The venue is Ocean Waters. Requirements for Noticing-Ink: do the action of examining the rayfish; do the action of touching the rayfish; do the action of examining manta ink. Definition: Noticing-Ink is complete: if extended-hint-mode is false, yes; if Jumble is visited, yes; if we have examined manta ink, yes. The apropos-list of Noticing-Ink is {distant-rayfish}.

Finding-the-Snails is a task. The venue is Stumps. Requirements for Finding-the-Snails: do the action of examining white snail. Definition: Finding-the-Snails is complete: if extended-hint-mode is false, yes; if Jumble is visited, yes; if we have examined white snail, yes. The apropos-list of Finding-the-Snails is {Rise, Chairlift Base}.

Finding-the-Mussels is a task. The venue is Among the Boulders. Requirements for Finding-the-Mussels: do the action of examining some small blue mussels. Definition: Finding-the-Mussels is complete: if extended-hint-mode is false, yes; if Jumble is visited, yes; if we have examined small blue mussels, yes. The apropos-list of Finding-the-Mussels is {Tidepools}.

Finding-the-Somenium is a task. The venue is Hot Springs. Requirements for Finding-the-Somenium: do the action of examining sea-blue crystal. Definition: Finding-the-Somenium is complete: if extended-hint-mode is false, yes; if Jumble is visited, yes; if we have examined sea-blue crystal, yes.

Learning-That-P-Writes-Right-To-Left is a puzzle. It requires Opening-Cube, Reading-Inscription.

Opening-Cube is a reversible task. The venue is Hut. Requirements for Opening-Cube: do the action of examining cube; do the action of examining intricate carvings; do the action of examining oval indentations; do the action of touching oval indentations. Definition: Opening-Cube is complete: if extended-hint-mode is false, yes; if cube is open, yes; if we have examined handwritten inscription, yes; if Jumble is visited, yes; otherwise no.

Reading-Inscription is a task. The venue is Hut. Requirements for Reading-Inscription: do the action of examining sketchbook; do the action of examining handwritten inscription. Definition: Reading-Inscription is complete: if extended-hint-mode is false, yes; if Jumble is visited, yes; if we have examined handwritten inscription, yes.



Door-Action is a reversible task. The venue is Back Room. Requirements for The-Mysterious-Door: do the action of pushing crystal button; do the action of pushing mussel button; do the action of pushing snail button; do the action of pushing manta ray button; do the action of pushing windsigh tree button; do the action of pushing berry button. Definition: Door-Action is complete: if Jumble is visited, yes; if lava tunnel door is open, yes; no.


A fast-forward rule for The-Mysterious-Door:
	move the player to Back Room, without printing a room description; 
	try silently examining some smashed wood splinters;
	now the player is wearing the compass;
	now the compass is open;
	now lava tunnel door is open; 
	move the player to Jumble.


Section - Getting To The Lawn

[
Getting-To-The-Lawn is a puzzle. Getting-To-The-Lawn requires Finding The Power System, Finding The Ropeway, Manipulating The Power System, Noticing The Pipes, and Testing The Ropeway.

After exiting when location is Lawn: now everything required by Getting-To-The-Lawn is met; continue the action.

After going to Volcano Floor for the first time: solve Finding The Power System; continue the action.

After going to Chairlift Base for the first time: solve Finding The Ropeway; continue the action.

After adjusting the blue wheel for the first time: solve Manipulating The Power System; continue the action.

After examining blue pipe for the first time: solve Noticing The Pipes; continue the action.

After pushing ropeway lever for the first time: solve Testing The Ropeway; continue the action.

Doing something to the ropeway mechanism is PTR-solving. Doing something to the ropeway outlet vent is PTR-solving. Doing something to the ropeway pressure gauge is PTR-solving. Doing something to ropeway lever is PTR-solving. Doing something to bucket is PTR-solving. Doing something to boarded over steam vent is PTR-solving. Doing something to brick boiler is PTR-solving. Doing something to boiler pressure gauge is PTR-solving. Doing something to a pipe is PTR-solving. Doing something to a wheel is PTR-solving. Doing something to boiler outlet is PTR-solving.

After PTR-solving: fiddle with Getting-To-The-Lawn; continue the action.


]

Getting-To-The-Lawn is a puzzle. It requires Setting-Power-To-Chairlift, Summoning-Chairlift, Riding-Chairlift, Pushing-Boulder.

Setting-Power-To-Chairlift is a reversible task. The venue is Volcano Floor. The command-sequence of Setting-Power-To-Chairlift is { "turn yellow wheel 30 left", "turn red wheel 30 left", "turn blue wheel 30 right" }. Definition: Setting-Power-To-Chairlift is complete: if the mountain-spring is diverted, yes; if chairlift has power, yes; otherwise no. 

Summoning-Chairlift is a reversible task. The venue is Chairlift Base. Requirements for Summoning-Chairlift: do the action of pulling ropeway lever. Definition: Summoning-Chairlift is complete: if mountain-spring is diverted, yes; if player is in bucket and bucket is not in Chairlift Base, yes; if location is regionally in High Altitude, yes; if bucket is in Chairlift Base, yes; otherwise no.

Riding-Chairlift is a reversible task. The venue is Chairlift Base. Requirements for Riding-Chairlift: do the action of entering bucket; do the action of pushing ropeway lever. A red flag rule for Riding-Chairlift: if bucket is not in Chairlift Base, rule fails. Definition: Riding-Chairlift is complete: if player is in Lawn, yes; if player is enclosed by bucket and bucket is in Lawn, yes; if mountain-spring is diverted, yes; no.

Pushing-Boulder is a task. The venue is Lawn. Requirements for Pushing-Boulder: do the action of pushing overly energetic boulder. Definition: Pushing-Boulder is complete: if location is not Lawn or location is not Observatory Exterior, yes; if mountain-spring is diverted, yes. A red flag rule for Pushing-Boulder: if location is not Lawn, rule fails.


A fast-forward rule for Getting-To-The-Lawn:
	move bucket to Lawn;
	now the pressure of blue pipe is 7;
	now the pressure of yellow pipe is 10;
	now the pressure of red pipe is 1;
	move the player to Lawn.



Section - Finding The Egg

[Finding-The-Egg is a puzzle. Finding-The-Egg requires Hearing About The Forest Secret, Locating The Hive, Noticing The Bees, Observing The Dancer Bee, Exploring The Rain Forest, Claiming The Compass, Finding Most Of The Flowers, and Going That Funky Direction.

After going to Egg Room for the first time: now everything required by Finding-The-Egg is met; continue the action.

After reading the sketchbook for the third time: solve Hearing About The Forest Secret.

After going to Hive Room for the first time: solve Locating The Hive; continue the action.

Doing something to the hive bees is beenoticing. Doing something to the swarm of bees is beenoticing. After beenoticing for the first time: solve Noticing The Bees; continue the action.

After doing something to the dancer bee for the first time: solve Observing The Dancer Bee; continue the action.

After going to Forest3 for the first time: solve Exploring The Rain Forest; continue the action.

After taking the compass for the first time: solve Claiming The Compass; continue the action.

After going to Edge of Ravine when Crater Pond is visited: solve Finding Most Of The Flowers; continue the action.

Doing something to the hive bees is FTE-solving. Doing something to the swarm of bees is FTE-solving. Doing something to the dancer bee is FTE-solving. Doing something to the beehive is FTE-solving. Waiting in Hive Room is FTE-solving. Climbing the beehive is FTE-solving. Doing something to the wildflowers is FTE-solving. 

After FTE-solving: fiddle with Finding-The-Egg; continue the action.]

Finding-The-Egg is a puzzle. Finding-The-Egg requires [Noticing-Forest-Secret, Locating-Hive, Noticing-Dancer, Exploring-Rain-Forest,] Claiming-The-Compass, [Finding-Most-Flowers,] and Locating-Egg.

Claiming-The-Compass is a task. The venue is Back Room. Requirements for Claiming-The-Compass: do the action of examining smashed wood splinters; do the action of taking compass; do the action of opening compass. Definition: Claiming-The-Compass is complete: if compass is worn and compass is open, yes.

Locating-Egg is a task. The venue is Egg Room. Definition: Locating-Egg is complete: if Egg Room is visited, yes.

A fast-forward rule for Finding-The-Egg:
	now Chasm Edge is eastsided;
	adjust chasm bridges;
	move bucket to Chairlift Base;
	move player to Egg Room.

Section - Powering Both Devices

[Powering-Both-Devices is a puzzle. Powering-Both-Devices requires Noticing P Sculpture, Observing Rainfall, Shoving P Sculpture Once, Destroying P Sculpture, Observing Higher Power Levels, Finding The Crack, Trying To Climb Through Water, Reaching The Lawn, Noticing The Mountain Stream, Diverting The Mountain Stream, and Reaching Powered Pyramid.

After going to Observatory Exterior when pyramid has power: now everything required by Powering-Both-Devices is met; continue the action.

After going to Rim of Volcano for the first time: solve Noticing P Sculpture; continue the action.

After doing something to rain clouds for the first time: solve Observing Rainfall; continue the action.

After pushing volcano sculpture for the first time: solve Shoving P Sculpture Once; continue the action.

After doing something when volcano sculpture is off-stage: solve Destroying P Sculpture; continue the action.

Doing something to a pressure gauge is DSTPGing. Doing something to boiler pressure gauge is DSTPGing.

After DSTPGing when volcano sculpture is off-stage: solve Observing Higher Power Levels; continue the action.

After going to North Marsh for the first time: solve Finding The Crack; continue the action. 

After doing something when Cliffside is visited: solve Trying To Climb Through Water; continue the action.

After exiting when location is Lawn: solve Reaching The Lawn; continue the action.

After doing something to the mountain-spring: solve Noticing The Mountain Stream; continue the action.

After pushing the overly energetic boulder for the first time: solve Diverting The Mountain Stream; continue the action.

Doing something to the ropeway mechanism is PBD-solving. Doing something to the ropeway outlet vent is PBD-solving. Doing something to the ropeway pressure gauge is PBD-solving. Doing something to ropeway lever is PBD-solving. Doing something to bucket is PBD-solving. Doing something to boarded over steam vent is PBD-solving. Doing something to brick boiler is PBD-solving. Doing something to boiler pressure gauge is PBD-solving. Doing something to a pipe is PBD-solving. Doing something to a wheel is PBD-solving. Doing something to boiler outlet is PBD-solving. Doing something to volcano sculpture is PBD-solving. Doing something to the weather-worn crack is PBD-solving. Doing something to the mountain-spring is PBD-solving. Doing something to overly energetic boulder is PBD-solving.

After PBD-solving: fiddle with Powering-Both-Devices; continue the action.]

Powering-Both-Devices is a puzzle. It requires [Noticing P Sculpture, Observing Rainfall, Shoving P Sculpture Once, Destroying P Sculpture, Observing Higher Power Levels, Finding The Crack, Trying To Climb Through Water, Reaching The Lawn, Noticing The Mountain Stream, Diverting The Mountain Stream, and] Powering-Pyramid and Reaching-Powered-Pyramid.

Powering-Pyramid is a reversible task. The venue is Volcano Floor. The command-sequence of Powering-Pyramid is { "turn blue wheel 30 left", "turn red wheel 30 left", "turn yellow wheel 30 right" }. Definition: Powering-Pyramid is complete: if pyramid has power, yes; otherwise no. 

Reaching-Powered-Pyramid is a task. The venue is Observatory Exterior. Definition: Reaching-Powered-Pyramid is complete: if location is Observatory Exterior and pyramid has power, yes.

A fast-forward rule for Powering-Both-Devices:
	now Chasm Edge is westsided;
	adjust chasm bridges;
	now the mountain-spring is diverted;
	now the pressure of blue pipe is 7;
	move bucket to Lawn;
	now the pressure of yellow pipe is 22;
	move the player to Observatory Exterior.






Section - Opening The Pyramid

[Opening-The-Pyramid is a puzzle. Opening-The-Pyramid requires Noticing The Pyramid Symbols, Finding The Echo Chamber, Voicing The Right Words, Slouching In A Shape, Getting All Echo Hints, and Jumping Through The Hoops.

After entering the mind chair for the first time: now everything required by Opening-The-Pyramid is met; continue the action.

After doing something to the etchings for the first time: solve Noticing The Pyramid Symbols; continue the action.

After going to Echo Chamber for the first time: solve Finding The Echo Chamber; continue the action.

After entering an echo-shape: solve Slouching In A Shape; continue the action.

After going when every echo-keyword is uncovered and Getting All Echo Hints is unsolved: solve Getting All Echo Hints; continue the action.

Doing something to the pyramid is OTP-solving. Doing something to the etchings is OTP-solving. Doing something to the wire filaments is OTP-solving. Doing something to the metallic hoops is OTP-solving. Doing something to the yellow pipe is OTP-solving. Doing something to the yellow wheel is OTP-solving. Doing something in Echo Chamber is OTP-solving. Doing something to a ground-konokuk is OTP-solving. Doing something to the great galaxy is OTP-solving. 

After OTP-solving: fiddle with Opening-The-Pyramid; continue the action.]



Opening-The-Pyramid is a puzzle. It requires Jumping-Pyramid-Hoops.

Jumping-Pyramid-Hoops is a task. Requirements for Jumping-Pyramid-Hoops: do the action of thrice-knocking; do the action of clapping. Definition: Jumping-Pyramid-Hoops is complete: if pyramid is off-stage, yes.

A fast-forward rule for Opening-The-Pyramid:
	now wall to wall workbench is clean;
	remove the pyramid from play;
	move the mind chair to Observatory Exterior; 
	move the mind machinery to Observatory Exterior;
	move the player to Observatory Exterior.



Section - Contacting All The Trees

Contacting-All-The-Trees is a puzzle. It requires Calibrating-Machinery, Contacting-Trees, Prepping-Departure.

Calibrating-Machinery is a task with venue Observatory Exterior. Requirements for Calibrating-Machinery: do the action of entering mind chair; do the action of eye closing; do the action of touching firefly-icons; do the action of touching firefly-icons; do the action of touching red glow; do the action of touching green glow. Definition: Calibrating-Machinery is complete: if mind machinery is calibrated, yes. 

Contacting-Trees is a not sequential puzzle. It requires Contacting-Fork-Tree, Contacting-Treehouse-Tree, Contacting-Rockslide-Tree, Contacting-Caldera-Tree, Contacting-Egg-Tree, Contacting-Forest-Tree, Contacting-Saddle-Tree.

Contacting-Fork-Tree is a task with venue Fork. Requirements for Contacting-Fork-Tree: do the action of touching Tree1. Definition: Contacting-Fork-Tree is complete: if tree1 is contacted, yes.

Contacting-Treehouse-Tree is a task with venue Big Tree. Requirements for Contacting-Treehouse-Tree: do the action of touching Tree2. Definition: Contacting-Treehouse-Tree is complete: if tree2 is contacted, yes.

Contacting-Saddle-Tree is a puzzle. It requires Getting-To-Ravine-Bottom, Pushing-Vine, Touching-Tree3. 

Getting-To-Ravine-Bottom is a reversible task. The venue is Edge of Ravine. The command-sequence is { "down", "wait for two hours" }. Definition: Getting-To-Ravine-Bottom is complete: if tree3 is contacted, yes; if withered vine is open, yes; if location is regionally in Narrow Ravine or location is Top of Cave or location is Water Cave or location is Saddle or location is Atop, yes; no.

Pushing-Vine is a task with venue Saddle. Requirements for Pushing-Vine: do the action of pushing withered vine. Definition: Pushing-Vine is complete: if tree3 is contacted, yes; if withered vine is open, yes. 

Touching-Tree3 is a task with venue Saddle. Requirements for Touching-Tree3: do the action of touching Tree3. Definition: Touching-Tree3 is complete: if tree3 is contacted, yes.

Contacting-Caldera-Tree is a task with venue Cinder Cone. Requirements for Contacting-Caldera-Tree: do the action of touching Tree4. Definition: Contacting-Caldera-Tree is complete: if tree4 is contacted, yes.

Contacting-Forest-Tree is a task with venue Forest9. Requirements for Contacting-Forest-Tree: do the action of touching Tree5. Definition: Contacting-Forest-Tree is complete: if tree5 is contacted, yes.

Contacting-Egg-Tree is a task with venue Egg Room. Requirements for Contacting-Egg-Tree: do the action of touching Tree6. Definition: Contacting-Egg-Tree is complete: if tree6 is contacted, yes.

Contacting-Rockslide-Tree is a task with venue Rockslide. Requirements for Contacting-Rockslide-Tree: do the action of touching Tree7. Definition: Contacting-Rockslide-Tree is complete: if tree7 is contacted, yes.

Prepping-Departure is a task with venue Observatory Exterior. Requirements for Prepping-Departure: do the action of entering mind chair. Definition: Prepping-Departure is complete: if icon-case is open, yes.

A fast-forward rule for Contacting-All-The-Trees:
	now tree1 is contacted; now tree2 is contacted;
	now tree3 is contacted; now tree4 is contacted;
	now tree5 is contacted; now tree6 is contacted;
	now tree7 is contacted;
	if tree-password is blank, now tree-password is "swordfish";
	if rebel-password is blank, now rebel-password is "sesame";
	now withered vine is open;
	now icon-case is open;
	finish mindlink calibration;
	move the player to Observatory Exterior.


[
Contacting-All-The-Trees is a puzzle. Contacting-All-The-Trees requires Reaching The Ravine Bottom, Reaching The Highest Tree, Finding The Rain Forest One, Finding The Volcano One, Completing All The Dreams, and Not Being A Password Dumbass.

After going to Ravine Floor for the first time: solve Reaching The Ravine Bottom; continue the action.

After going to Saddle for the first time: solve Reaching The Highest Tree; continue the action.

After going to Forest9 for the first time: solve Finding The Rain Forest One; continue the action.

After going to Cinder Cone for the first time: solve Finding The Volcano One; continue the action.

After defining a password when the rebel-password is not the tree-password: solve Not Being A Password Dumbass; continue the action. After defining a password when the rebel-password is the tree-password: now Not Being A Password Dumbass is unmet; continue the action.

Doing something to a windsigh tree is CATT-solving. Doing something in Observatory Exterior when pyramid is off-stage is CATT-solving. Doing something in Water Cave is CATT-solving. Doing something in Top of Ravine is CATT-solving.

After CATT-solving: fiddle with Contacting-All-The-Trees; continue the action.

]


[
FF-Reaching-Rebelworld-Lacuna is a scene. FF-Reaching-Rebelworld-Lacuna begins when Reaching-Rebelworld is force solved. FF-Reaching-Rebelworld-Lacuna ends when 1 is 1.

When FF-Reaching-Rebelworld-Lacuna begins:
	now machinery-password is the rebel-password;
	now the mind machinery is projecting.

FF-Finishing-Rebelworld-Lacuna is a scene. FF-Finishing-Rebelworld-Lacuna begins when Finishing-Rebelworld is force solved. FF-Finishing-Rebelworld-Lacuna ends when 1 is 1.

When FF-Finishing-Rebelworld-Lacuna begins:
	now machinery-password is the rebel-password;
	now the mind machinery is idling.

FF-Reaching-Treeworld-Lacuna is a scene. FF-Reaching-Treeworld-Lacuna begins when Reaching-Treeworld is force solved. FF-Reaching-Treeworld-Lacuna ends when 1 is 1.

When FF-Reaching-Treeworld-Lacuna begins:
	now machinery-password is the tree-password;
	now the mind machinery is projecting.

FF-Finishing-Treeworld-Lacuna is a scene. FF-Finishing-Treeworld-Lacuna begins when Finishing-Treeworld is force solved. FF-Finishing-Treeworld-Lacuna ends when 1 is 1.

When FF-Finishing-Treeworld-Lacuna begins:
	now machinery-password is the tree-password;
	change the time of day to 9:00 PM;
	now the mind machinery is idling.

FF-Completing-Progue's-Character-Arc-Lacuna is a scene. FF-Completing-Progue's-Character-Arc-Lacuna begins when Completing-Progue's-Character-Arc is force solved. FF-Completing-Progue's-Character-Arc-Lacuna ends when 1 is 1.

When FF-Completing-Progue's-Character-Arc-Lacuna begins:
	say "Enter 1 for Rume epilogue (like Rume), 2 for Lethe epilogue (like Progue), or 3 for Dr. Quick epilogue (loner)> ";
	let inp be single-character - 48;
	if inp is 1, now Rume-tracker is 10;
	if inp is 2 begin; now Rume-tracker is 0; now affinity of Progue is 5; end if;
	if inp is 3 begin; now Rume-tracker is 0; now affinity of Progue is 0; end if;
	now ep-trigger is true.

FF-Finishing-The-Epilogue-Lacuna is a scene. FF-Finishing-The-Epilogue-Lacuna begins when Finishing-The-Epilogue is force solved. FF-Finishing-The-Epilogue-Lacuna ends when 1 is 1.

When FF-Finishing-The-Epilogue-Lacuna begins:
	now ep-trigger is true.]


Volume - Progue's Behavior (in Lacuna-Progue by Blue Lacuna)

 

Book - Progue Core

Part - Testing (Not For Release)

Understand "ptrack" as ptracking. Ptracking is an action out of world applying to nothing.

Carry out ptracking:
	if progue-window is g-present, shut down progue-window;
	otherwise open up progue-window.

The progue-window is a g-window with type g-text-buffer. The main-window spawns the progue-window. The position of the progue-window is g-placeabove. The scale method of progue-window is g-fixed-size. The measurement of the progue-window is 5.

Before reading a command when progue-window is g-present: 
	move focus to progue-window, clearing the window;
	say "PROGUE - [psyche of Progue] - [animus of Progue] (prior: [prior animus of Progue]) [if Progue is wishing]wishing -- progue-venue [progue-venue][else]fulfilling[end if] / [activity counter of Progue] - [if Progue is attentive]attentive[otherwise]idle[end if]  - in [location of Progue][line break]";
	say "aff: [affinity of Progue] ; pat: [paternalism of Progue] ; sub: [submission of Progue] ; rom: [romance of Progue] / disposition: [disposition of Progue] / archetype: ";
	say progue-archetype;
	say line break;
	say "last beat: [last beat][if last beat is insistent] (insistent)[end if] ; alb: [actual last beat] ; con. fuse: [conversation fuse] ; boredom: [boredom counter of Progue][line break]";
	say "curr. ep: [current episode] / curr thread: [current_thread of Progue]";
	return to main screen.

To say progue-archetype:
	if neurotic dad begin; say "neurotic dad";
	else if father knows best; say "father knows best";
	else if bitter dad; say "bitter dad";
	else if disciplinarian; say "disciplinarian";
	else if friend; say "friend";
	else if toady; say "toady";
	else if lover; say "lover";
	else if twitterpated; say "twitterpated";
	else if enemy; say "enemy";
	else if slave; say "slave";
	else if shattered lover; say "shattered lover";
	else if bitter lover; say "bitter lover";
	else; say "no match";
	end if.


Understand "pstatus" as pstatusing. Pstatusing is an action out of world applying to nothing.

Carry out pstatusing:
	say "*** [The Progue] status ***[line break]";
	say "location: [location of Progue][line break]";
	say "1) psyche: [psyche of Progue][line break]";
	say "2) affinity: [affinity of Progue][line break]";
	say "3) paternalism: [paternalism of Progue][line break]";
	say "4) submission: [submission of Progue][line break]";
	say "5) romance: [romance of Progue][line break]";
	say "disposition: [disposition of Progue][line break]";
	say "boredom: [boredom counter of Progue][line break]";
	say "animus: 6) [animus of Progue] 7)([if Progue is wishing]wishing[otherwise]fulfilling[end if], activity counter: [activity counter of Progue]; progue-venue: [progue-venue]; prior: [prior animus of Progue])[line break]";
	if next animus of Progue is not null-endeavour, say "next animus: [next animus of Progue][line break]";
	say "[if Progue is idle]idle[otherwise]attentive[end if][line break]";
	say "[if Progue is annoyed]annoyed[otherwise]not annoyed[end if] / [if Progue is friendly]friendly[otherwise]not friendly[end if][line break]";
	say "last beat: [last beat] ".

Understand "pgod" as pgodding. pgodding is an action out of world applying to nothing. 

Carry out pgodding:
	let inp be 1;
	while inp is not 0 begin;
		clear the screen;
		try pstatusing;
		now inp is single-character - 48;
		say inp;
		if inp is 1, now the psyche of Progue is the psychological state after the psyche of Progue;
		if inp is 2 begin;
			say "Num? ";
			now affinity of Progue is ( single-character - 48 ) ;
		end if;
		if inp is 3 begin;
			say "Num? ";
			now paternalism of Progue is ( single-character - 48 ) ;
		end if;
		if inp is 4 begin;
			say "Num? ";
			now submission of Progue is ( single-character - 48 ) ;
		end if;
		if inp is 5 begin;
			say "Num? ";
			now romance of Progue is ( single-character - 48 ) ;
		end if;
		if inp is 6 begin;
			let tempan be the endeavour after the animus of Progue;
			Progue starts tempan;
		end if;
		if inp is 7 begin;
			if Progue is wishing, now Progue is fulfilling; otherwise now Progue is wishing;
		end if;
	end while.

Does the player mean object-debugging Progue: it is very likely.


Part - Definitions


Chapter - Setup

Progue is a man.  

met_progue is a truth state that varies.

Understand "strange" or "man" or "figure" or "progues" or "progue's" as Progue. Progue is improper-named. The indefinite article of Progue is "[if met_progue is false]a[otherwise if improper-named]the". The printed name of Progue is "[printed_name_progue]".

A thing can be either named or unnamed. A thing is usually unnamed.  

Chapter - Psyche (Long Term Emotions)

[ Psyche is used to trigger specific conversations, and controls what activities Progue might engage in (see Animus) and how extreme the various relationship values can get. ]

Psychological state is a kind of value. The psychological states are ignorance, denial, fear, suppression, uncertainty, emotional, fugue, and resolved.  

Progue has a psychological state called psyche. The psyche of Progue is ignorance.   



Chapter - Attitudes (Long Term Feelings for Player)

Progue has a number that varies called affinity. The affinity of Progue is 0. [ This represents how much Progue likes the player, and can range from -8 (hatred) to 8 (best friends). ]

Progue has a number that varies called submission. The submission of Progue is 0. [ This represents how submissive Progue is in the relationship from the player's perspective, ranging from -8 (alpha male) to 8 (Gollum). ]

Progue has a number that varies called paternalism. The paternalism of Progue is 0. [ This represents how much Progue thinks of the player as a surrogate child figure, ranging from 0 (not at all) to 8 (very much so). ]

Progue has a number that varies called romance. The romance of Progue is 0. [ This models whether Progue has any romantic feelings towards the player, ranging from 0 to 8. However, if trust is violated and Progue becomes a jilted lover, romance is changed to -1 and can never again rise, and affinity is multiplied by -1. ]

[ It's too easy to get Progue irrevocably down some path early on, so we cap the min and max values of the attributes for each stage, which we can think of as corresponding to the growing seriousness of Progue's feelings towards you, the longer he knows you. ]

To decide what number is the psyche-adjusted (num - a number):
	if num > 2 and ( the psyche of Progue is ignorance or the psyche of Progue is denial or the psyche of Progue is fear ) , decide on 2;
	if num > 4 and the psyche of Progue is suppression, decide on 4;
	if num > 6 and the psyche of Progue is uncertainty, decide on 6;
	if num > 8, decide on 8;
	if num < -2 and ( the psyche of Progue is ignorance or the psyche of Progue is denial or the psyche of Progue is fear ) , decide on -2;
	if num < -4 and the psyche of Progue is suppression, decide on -4;
	if num < -6 and the psyche of Progue is uncertainty, decide on -6;
	if num < -8, decide on -8;
	decide on num.

To Progue likes you more, silently:
	increase the affinity of Progue by 1;
	now the affinity of Progue is the psyche-adjusted affinity of Progue;
	if the affinity of Progue is 0, now the affinity of Progue is 1; [ 0 is the initial state; once we've pushed him in one direction, he will always have an opinion one way or the other. ]
	report on Progue's social standing for 1. 

To Progue likes you less, silently:
	decrease the affinity of Progue by 1;
	now the affinity of Progue is the psyche-adjusted affinity of Progue;
	if the affinity of Progue is 0, now the affinity of Progue is -1;
	if romance of Progue > 3 and affinity of Progue < 0:
		now affinity of Progue is romance of Progue * -1;
		now romance of Progue is -1;
		if Progue is enclosed by location, say "A look of betrayal and hurt comes over [the Progue]'s face, and you know whatever you had is over.";
	report on Progue's social standing for 2.

To Progue feels more like a father, silently:
	unless the romance of Progue > 3 or the romance of Progue < 0 begin; [ If we've had a love scene with Progue, he's never going to feel like a father figure. Oedipal relationships are too tricky to model with integers. ]
		increase the paternalism of Progue by 1;
		now the paternalism of Progue is the psyche-adjusted paternalism of Progue;
		if the paternalism of Progue is 0, now the paternalism of Progue is 1;
		report on Progue's social standing for 3;
		if romance of Progue > 0, Progue is losing interest; [ As the feeling of paternalism rises, potential romantic attraction fades. ]
	otherwise;
		if Progue is being debugged, say "// Progue: does not feel more paternalism because romance is [romance of Progue]).[as normal][line break]";
	end unless.

To Progue feels less like a father, silently:
	decrease the paternalism of Progue by 1;
	now the paternalism of Progue is the psyche-adjusted paternalism of Progue;
	if the paternalism of Progue < 0, now the paternalism of Progue is 0;
	report on Progue's social standing for 4.

To Progue is more submissive, silently:
	increase the submission of Progue by 1;
	now the submission of Progue is the psyche-adjusted submission of Progue;
	if the submission of Progue is 0, now the submission of Progue is 1;
	report on Progue's social standing for 5.

To Progue is less submissive, silently:
	decrease the submission of Progue by 1;
	now the submission of Progue is the psyche-adjusted submission of Progue;
	if the submission of Progue is 0, now the submission of Progue is -1;
	report on Progue's social standing for 6.

To Progue is aroused, silently:
	if the romance of Progue >= 0 begin;
		increase the romance of Progue by 1;
		now the romance of Progue is the psyche-adjusted romance of Progue;
		report on Progue's social standing for 7;
		if romance of Progue is 1 or romance of Progue is 3 or romance of Progue is 5, Progue likes you more;
		if submission of Progue >= 2 and ( romance of Progue is 2 or romance of Progue is 4 or romance of Progue is 6 ) , Progue is more submissive;
		if paternalism of Progue > 0, Progue feels less like a father; [ As the feeling of romance rises, paternal feelings fade. ]
		if romance of Progue >= 3, dis Rume;
	otherwise;
		if Progue is being debugged, say "// Progue: does not feel more romance because romance is [romance of Progue]).";
	end if.

To Progue is losing interest, silently:
	decrease the romance of Progue by 1;
	now the romance of Progue is the psyche-adjusted romance of Progue;
	if the romance of Progue < 0, now the romance of Progue is 0;
	report on Progue's social standing for 8.

To Progue is heartbroken:
	now the affinity of Progue is 0;
	Progue likes you less.


[ Various beats can be things like "submissive" or "paternal" to easily adjust the various relationship values when that beat is spoken. ]

To adjust Progue's social standing:
	let target be noun;
	if Progue is being debugged, say "// Progue: adjust Progue's social standing.";
	if target is affinitive, Progue likes you more;
	if target is unaffinitive, Progue likes you less;
	if target is paternal, Progue feels more like a father;
	if target is unpaternal, Progue feels less like a father;
	if target is submissive, Progue is more submissive;
	if target is unsubmissive, Progue is less submissive;
	if target is romantic, Progue is aroused;
	if target is unromantic, Progue is losing interest;
	if target is annoying, annoy Progue;
	if target is impressive, impress Progue;
	continue the action.

[ This is done this way so that if a beat has multiple score changes, each of them get reported. ]

To report on Progue's social standing for (scode - a number):
	if Progue is being debugged or stats mode is true:
		say "[as the parser]([The Progue] [if scode is 1]likes you more: affinity[else if scode is 2]likes you less: affinity[else if scode is 3]feels more fatherly: paternalism[else if scode is 4]feels less fatherly: paternalism[else if scode is 5]feels more submissive: submission[else if scode is 6]feels more dominant: submission[else if scode is 7]feels more romantic: romance[else if scode is 8]feels less romantic: romance[else if scode is 9]is more annoyed: disposition[else if scode is 10]is more impressed: disposition[end if] now ";
		let tarnum be 99;
		if scode is 1 or scode is 2, now tarnum is affinity of Progue;
		if scode is 3 or scode is 4, now tarnum is paternalism of Progue;
		if scode is 5 or scode is 6, now tarnum is submission of Progue;
		if scode is 7 or scode is 8, now tarnum is romance of Progue;
		if scode is 9 or scode is 10, now tarnum is disposition of Progue;
		unless tarnum is 99:
			say "[if tarnum > 0]+[end if][tarnum]).[as normal][line break]".

Section - Attitude Business


[ "attitude-business" is a say statement that can be inserted after a comma and space outside of quotes in Progue dialog. It adds a clause to the sentence that gives hints as to how Progue feels about you. ]
	
To say attitude-business:
	if the psyche of Progue is denial begin; [Early on, Progue's feelings may only be temporary; we don't want to push the player towards thinking Progue is particularly friendly/unfriendly/etc until they have a chance to develop a bit of a history.]
		say "[animus-business]";
	otherwise if ( romance of Progue > 1 or romance of Progue < -1 ) and a random chance of 1 in 2 succeeds;
		if romance of Progue >= 5 begin; say "[one of]rubbing a hand up and down your back[or]kissing your cheek[or]eyeing you suggestively[in random order]";
		otherwise if romance of Progue >= 3; say "[one of]flashing a mad, flirtatious grin in your direction[or]tousling your hair playfully[or]touching his hand to yours for a brief moment[in random order]";
		otherwise if romance of Progue >= 1; say "[one of]poking you playfully in the side[or]giving you a surreptitious wink[or]smiling wryly at you[in random order]";
		otherwise if romance of Progue < -1; say "[one of]pointedly looking away[or]apparently trying hard to keep his tone civil[or]using a nasty, sarcastic tone[in random order]";
		end if;
	otherwise if paternalism of Progue >= 2 and a random chance of 1 in 2 succeeds;
		if affinity of Progue > 0 begin;
			if paternalism of Progue >= 4 begin; say "[one of]in a fatherly tone[or]putting a strong hand on your shoulder[in random order]";
			otherwise; say "[one of]regarding you fondly[or]tapping you on the knee[or]seeming to find quiet reassurance in your company[in random order]"; end if;
		otherwise;
			if paternalism of Progue >= 4 begin; say "[one of]conveying [if affinity of Progue < -3]strong[otherwise]faint[end if] disapproval with his body language[or]frowning disapprovingly at you[in random order]";
			otherwise; say "[one of]sternly[or]in a stern tone[or]shooting you a look of mild disapproval[in random order]"; end if;
		end if;
	otherwise if ( submission of Progue >= 2 or submission of Progue <= -2 ) and a random chance of 1 in 2 succeeds;
		if submission of Progue >= 4 begin; say "[one of]watching nervously for your reaction[or]moving quickly aside as you lean forward[or]hesitantly, as if afraid of your reaction[or]with an embarrassed laugh[in random order]";
		otherwise if submission of Progue >= 2; say "[one of]glancing surreptitiously at your reaction[or]a bit hesitantly[or]awkwardly[or]drawing back a little[in random order]";
		otherwise if submission of Progue <= -3; say "[one of]enjoying your reaction[or]watching with interest to see your reaction[or]loudly[or]holding your gaze[in random order]";
		otherwise; say "[one of]confident and commandingly[or]without waiting for a reply[or]clapping you roughly on the back[or]stepping forward a little[in random order]";
		end if; 
	otherwise;
		if affinity of Progue >= 4 begin; say "[one of]touching his hand warmly to your shoulder[or]regarding you fondly[or]smiling broadly at you[in random order]";
		otherwise if affinity of Progue >= 2; say "[one of]smiling a little[or]giving you a cautious smile[or]nodding at you[in random order]";
		otherwise if affinity of Progue < 2; say "[one of]cautiously glancing in your direction[or]weighing your reaction[or]watching you intently[in random order]";
		otherwise if affinity of Progue <= -2 and affinity of Progue > -5; say "[one of]avoiding your eyes[or]after an awkward silence[or]a bit distantly[or]studiously avoiding your glance[in random order]";
		otherwise; say "[one of]making sure to keep his distance from you[or]with harsh sarcasm[or]coldly[or]in an unfriendly tone[in random order]";
		end if;
	end if.


Chapter - Archetypes

[ Near the end of the game, we can take the various relationship values and classify Progue into one of a dozen or so archetypes, which represent a best-guess characterization of Progue based on his relationship with the player. For example, high paternalism but low submission and affinity result in the Disciplinarian, a disapproving father figure who is constantly trying to correct the behavior of the player. The archetypes are mainly used in the Confrontation and Epilogue sequences. ]














To decide whether father knows best: if submission of Progue <= -1 and paternalism of Progue > 1 and affinity of Progue > 0, decide yes; decide no.

To decide whether bitter dad: if submission of Progue >= 1 and paternalism of Progue > 1 and affinity of Progue < 0, decide yes; decide no.

To decide whether disciplinarian: if submission of Progue <= -1 and paternalism of Progue > 1 and affinity of Progue < 0, decide yes; decide no.

To decide whether neurotic dad: if submission of Progue >= 1 and paternalism of Progue > 1 and affinity of Progue > 0, decide yes; decide no.

To decide whether friend: if submission of Progue < 0 and paternalism of Progue <= 1 and affinity of Progue > 0 and romance of Progue < 4, decide yes; decide no.

To decide whether toady: if submission of Progue > 1 and paternalism of Progue <= 1 and affinity of Progue > 0 and romance of Progue < 4, decide yes; decide no.

To decide whether lover: if submission of Progue < 0 and paternalism of Progue <= 1 and affinity of Progue > 0 and romance of Progue >= 4, decide yes; decide no.

To decide whether twitterpated: if submission of Progue > 0 and paternalism of Progue <= 1 and affinity of Progue > 0 and romance of Progue >= 4, decide yes; decide no.
To decide whether enemy: if submission of Progue < 0 and paternalism of Progue <= 1 and affinity of Progue < -1 and romance of Progue < 4, decide yes; decide no.
To decide whether slave: if submission of Progue > 0 and paternalism of Progue <= 1 and affinity of Progue < -1 and romance of Progue < 4, decide yes; decide no.
To decide whether bitter lover: if submission of Progue < 0 and paternalism of Progue <= 1 and affinity of Progue < 0 and romance of Progue < 0, decide yes; decide no.
To decide whether shattered lover: if submission of Progue > 0 and paternalism of Progue <= 1 and affinity of Progue < 0 and romance of Progue < 0, decide yes; decide no.

Section - Archetype Message

[ This prints a dramatic clause based on Progue's archetype. This should only be used in the confrontation, since some of the drama levels wouldn't make sense in a normal conversation.]

To say archetype message:
	if neurotic dad:
		say "[one of]hurriedly interrupting you in a consoling tone[or]making anxious placating motions with his hands[or]smiling nervously while trying to seem tall and inspiring[in random order]";
	else if father knows best:
		say "[one of]giving you a chiding look[or]confident in his lecturing[or]fully expecting you to listen[in random order]";
	else if bitter dad:
		say "[one of]speaking quickly as if sure you plan to interrupt him[or]waving a desperate finger at you as if in weak admonishment[or]trying and failing to adopt a stern, paternal tone[in random order]";
	else if disciplinarian:
		say "[one of]cutting you off with a stern glare[or]grabbing your arm as if expecting you to run away[or]rooting you to the spot with an angry, commandeering gaze[in random order]";
	else if toady:
		say "[one of]grabbing your sleeve in an almost pathetically eager attempt to secure your attention[or]eyes wide with pleading, begging you to hear his say[or]clutching your hand fawningly[in random order]";
	else if lover:
		say "[one of]closing his hands around yours[or]putting his hands on your shoulders[or]stepping close to you[in random order]";
	else if twitterpated:
		say "[one of]falling to his knees and clutching your hand desperately[or]taking your head in his hands and looking into your eyes with pleading[or]hugging you fiercely for a moment before breaking away and staring into your eyes[in random order]";
	else if enemy:
		say "[one of]regarding you cooly[or]folding his arms as he watches you warily[or]tones clipped as he speaks with forced over-politeness[in random order]";
	else if slave or shattered lover:
		say "[one of]falling to the ground and groveling at your ankles[or]sniveling and only glancing up at your eyes in furtive intervals[or]wringing his hands and looking up at you with desperate pleading in his eyes[in random order]";
	else if bitter lover:
		say "[one of]looking at you with barely concealed contempt[or]dark lines around red-rimmed eyes telegraphing his hatred[or]cold fury making his movements short and clipped[in random order]";
	else:
		say "[one of]body tense but tone calling on your easy familiarity[or]making eye contact to impress upon you how important this is to him[or]touching a hand to your arm for a moment as if invoking your friendship[in random order]".


Chapter - Disposition (Short Term Feelings for Player)

[ During an individual conversation, the player might take annoying actions like not responding, repeating the same topic, or just choosing dialog options that piss off Progue. Disposition represents a way we can keep track of how Progue feels about the player *just for the duration of the current conversation*, without affecting the relationship variables, so Progue can get annoyed at the player but still remember a lasting friendship.

However, if we *do* piss off Progue to a high degree (or impress him inordinately) after the conversation is over we'll adjust Progue's affinity. Too many extremely annoying conversations and he really will start to dislike you. ]

Progue has a number called disposition. Definition: a person is friendly if its disposition is 2 or more. Definition: a person is annoyed if its disposition is -2 or less. The disposition of Progue is 0. 

Before greeting Progue (this is the reset Progue's disposition rule):
	now the disposition of Progue is 1;
	if Progue is being debugged, say "// Progue: disposition set to 1 (After greeting Progue).";
	continue the action.

Every turn when Progue is not enclosed by location and the disposition of Progue is not 0 (this is the process Progue's disposition rule):
	if Progue is being debugged, say "// Progue: processing disposition (because Progue is not enclosed by location and disposition of Progue is not 0).";
	now the disposition of Progue is 0.

To annoy Progue:
	decrease disposition of Progue by 3;
	report on Progue's social standing for 9.

To impress Progue:
	increase disposition of Progue by 3;
	report on Progue's social standing for 10.


Chapter - Animus (Long Term Movements)

[ Animus represents what Progue is doing in the medium-term, a series of activities which he will decide upon, prepare for, and then carry out. Each psyche has an allowed list of animuses which Progue randomly selects from after he has been working at one for a while.

Sometimes Progue is engaged in conversation, or in the middle of an episode. There is no animus that specifies these two conditions, so care must be taken to account for them if necessary. ]

Endeavour is a kind of value. The endeavours are null-endeavour, ruminating, resting, fishing, mending, hand-standing, frog-catching, spying, hiding, swimming, conch-blowing, player-seeking, convalescing, beach-combing, hottubbing, cleaning, paint-making, loitering, scrapbooking, stoicising.

Progue has an endeavour called animus. The animus of Progue is ruminating. Progue has an endeavour called prior animus. The prior animus of Progue is resting. Progue has an endeavour called next animus. The next animus of Progue is null-endeavour.

Progue's animus table is a table-name that varies. Progue's animus table is Table of Progue Default. 

Progue is either fulfilling or wishing. Progue is fulfilling. [ When Progue is wishing, he has decided to do something new, but is still in the goal-seeking stage; he hasn't started doing it yet. ]

progue-venue is a room that varies.  progue-venue is UnRoom. [ progue-venue stores the location Progue has decided to do a new activity at.]

Table of Progue Ignorance Endeavours
pick
beach-combing

Table of Progue Denial Endeavours
pick
mending
fishing
beach-combing
beach-combing
frog-catching
hand-standing
swimming

Table of Progue Fear Endeavours
pick
spying
spying
spying
hiding
hiding

Table of Progue Suppression Endeavours
pick
ruminating
fishing
mending
hottubbing
swimming
beach-combing
with 4 blank rows

Table of Progue Uncertainty Endeavours
pick
ruminating
beach-combing
cleaning
scrapbooking
with 2 blank rows

Table of Progue Emotional Endeavours
pick
resting
convalescing

Table of Progue Fugue Endeavours
pick
hiding

Section - Describing Progue's Animus

[ These are like printed names for each animus.]

To say Progue-animus:
	let anim be animus of Progue;
	if Progue is wishing begin; say "going somewhere";
	otherwise if anim is ruminating; say "thinking";
	otherwise if anim is scrapbooking; say "sifting through old things";
	otherwise if anim is resting; say "sleeping";
	otherwise if anim is fishing; say "fishing";
	otherwise if anim is mending; say "stitching";
	otherwise if anim is hand-standing; say "hand-standing";
	otherwise if the anim is cleaning; say "cleaning the studio";
	otherwise if the anim is paint-making; say "mixing paints";
	otherwise if anim is frog-catching; say "creeping slowly through the marsh";
	otherwise if anim is spying; say "behaving mysteriously";
	otherwise if anim is hiding; say "hiding";
	otherwise if anim is swimming; say "swimming";
	otherwise if anim is conch-blowing; say "[if we have not discussed tcp_greeting]holding some large object in his hands[otherwise]scrutinizing the conch";
	otherwise if anim is player-seeking or anim is loitering; say "hesitating";
	otherwise if anim is convalescing; say "resting";
	otherwise if anim is beach-combing; say "cleaning the beach";
	otherwise if anim is hottubbing; say "relaxing";
	otherwise; say animus of Progue;
	end if.


[ Describe Progue getting back to what he was doing. In certain cases, we want to avoid saying the animus if it would sound awkward in that context; print a more generic message in that case. ]

To say Progue-resumes:
	if the animus of Progue is hand-standing:
		say "And he suddenly falls forward flat on his face; at the last moment pushing forward with his hands until he's once again balancing on them";
	else if the animus of Progue is resting:
		say "He [if affinity of Progue < 0]grumpily [end if]lies back down on the [surface-material] and closes his eyes";
	else if the animus of Progue is swimming:
		say "He kicks a few strokes away from you and stretches out his arms, bobbing lazily in the swell";
	else if the animus of Progue is player-seeking or animus of Progue is loitering or animus of Progue is spying or animus of Progue is hiding or Progue is wishing:
		say "He [if affinity of Progue >= 0][one of]nods to you[or]waves farewell[or]turns away, glancing at the sky appraisingly[or]looks around vaguely, as if trying to remember what he was doing[in random order][else][one of]turns away angrily[or]pointedly turns his back on you[or]nods curtly to you[at random][end if]";
	else:
		say "He [if affinity of Progue >= 0][one of]goes back to[or]resumes[or]continues[or]turns his attention back to[or]goes on[in random order][else][one of]angrily goes back to[or]turns away with a frown and resumes[or]nods curtly to you and continues[at random][end if] [Progue-animus]";
		if romance of Progue > 1 and a random chance of 1 in 2 succeeds:
			say "[one of] with a wink[or], poking you playfully[or], smiling flirtatiously[in random order]";
		else if paternalism of Progue > 1 and a random chance of 1 in 2 succeeds:
			say "[if affinity of Progue > 0][one of], regarding you fondly[or] with a fatherly smile[at random][else][one of], shaking his head at you disapprovingly[or] with a stern glance in your direction[at random][end if]";
		else if submission of Progue > 1 and a random chance of 1 in 2 succeeds:
			say "[if affinity of Progue > 0][one of], stepping graciously out of your way[or], first catching your glance to make sure you approve[at random][else][one of], fidgeting nervously in your presence[or], grimacing nervously[or], taking a few nervous steps back[in random order][end if]";
		else if submission of Progue < -1 and a random chance of 1 in 2 succeeds:
			say "[if affinity of Progue > 0][one of] and whistling cheerfully[or] and cheerfully ignoring you[or] without waiting for any response[in random order][else][one of] and pointedly ignoring you[or] with a dismissive glance in your direction[or], seemingly dismissing you for now[in random order][end if]".
 


[ "animus-business" is a say tag which can be included after a comma and space to add some color to conversations related to what Progue is doing. ]

To say animus-business:
	if Progue is wishing begin; say "[one of]shifting anxiously from foot to foot[or]glancing past you towards his destination[or]tapping one foot rhythmically on the [surface-material][or]drumming his fingers against his thigh[or]a bit impatiently[or]scratching one foot with the other[in random order]";
	otherwise if the animus of Progue is fishing; say "[one of]twitching the line absently with his finger[or]pulling in the line and casting it out again[or]snapping the fishing pole reflexively[or]resetting his grip on the fishing pole[in random order]";
	otherwise if the animus of Progue is beach-combing; say "[one of]flexing his toes in the spotless sand beneath him[or]running a finger idly along a broken shell[or]frowning at a speck of seaweed near your foot[or]brushing a piece of green weed from his shirt[in random order]";
	otherwise if the animus of Progue is mending; say "[one of]tapping the rounded top of the needle absently[or]running his hands across the rags in his lap[or]fingering a hole in the cloth[or]scratching the garments in his lap[in random order]";
	otherwise if the animus of Progue is hand-standing; say "[one of]flexing his wrists back and forth[or]poking at a scratch on his palm[or]pinching his knuckles one by one[or]flexing his toes as if he'd prefer they were back in the air[in random order]";
	otherwise if the animus of Progue is cleaning; say "[one of]wiping dust from the workbench with a bit of rag[or]stacking old pots of paint[or]pulling up a vine that's crept through the window[or]frowning at a spot of spilled paint on the workbench[in random order]";
	otherwise if the animus of Progue is paint-making; say "[one of]stirring a pot of paint vigorously[or]wiping a droplet of paint from his forehead[or]scraping some paint from the sides of a pot[or]studying the consistency of the paint in a nearby pot with a frown[in random order]";
	otherwise if the animus of Progue is hottubbing; say "[one of]flicking the water absently with his fingers[or]sinking down till the water reaches his chin[or]kicking his legs languidly in the water[or]tickling water from an ear with one finger[or]pulling up his knees till they just poke out of the water[or]ducking his head half-under the water for a moment to blow little bubbles before resurfacing[in random order]";
	otherwise if the animus of Progue is swimming; say "[one of]floating serenely[or]opening one eye to squint balefully at you[or]scissoring his arms gently at his sides[or]bobbing gently on a swell[in random order]";
	otherwise if the animus of Progue is frog-catching; say "[if caught-frog is true][one of]rocking his frog-cage hands gently back and forth[or]peering at his caught frog[or]holding his frog close to his body[in random order][otherwise][one of]peering under an overhanging rock[or]making patterns in the mud with one bare toe[or]slapping a mosquito[or]brushing some wet grass from his knees[or]keeping one eye trained on a patch of rustling weeds[or]wiping his brow in the humid marsh air[or]tilting his head at a half-heard distant croak[in random order][end if]";
	otherwise; say "[one of]scratching his elbow[or]flexing a tanned foot appraisingly[or][attitude-business][or]shuffling his feet over the [surface-material][in random order]";
	end if.

Part - Description











Section - Printed Name

spotted-progue is a truth state that varies.

To say printed_name_progue:
	if spotted-Progue is false begin;
		now spotted-Progue is true;
		say "distant [o]figure[x] dressed in rags";
	otherwise if Progue is idle and already-highlighted-progue < 2 and ( Progue is enclosed by location or distant-progue is enclosed by location ) ; [It's not that we want to highlight it twice, but printing routines are actually run twice each time they are called, the first to print the name to an internal memory buffer.]
		say "[if met_progue is false][o]figure[x][otherwise if improper-named]strange [o]man[x][otherwise][o]Progue[x]";
		increase already-highlighted-progue by 1;
	otherwise;
		say "[if met_progue is false]figure[otherwise if improper-named]strange man[otherwise]Progue";
[	otherwise;
		say "He";]
	end if.

already-highlighted-progue is a number that varies. already-highlighted-progue is 0. Before reading a command (this is the reset Progue highlighting variable rule): now already-highlighted-progue is 0.

Section - Initial Appearance

The initial appearance of Progue is "[initialapp-Progue]".

Before writing a paragraph about Progue when Progue is wishing (this is the don't describe Progue when he's about to move rule): now Progue is mentioned. [Since we'll be describing him moving anyway, omit printing an initial appearance.]

To say initialapp-Progue:
	repeat through Table of Progue's Initial Appearance:
		[say "**[episode entry] (curr is [current episode]: [if current episode is episode entry]Y[else]N[end if])**[line break]";]
		if there is an episode entry and current episode is episode entry:
			say desc entry;
			stop;
	repeat through Table of Progue's Initial Appearance:
		if there is an animus entry and animus entry is the animus of Progue:
			say desc entry;
			stop;
	say "[The Progue] is here[if Progue is being debugged] ([animus of Progue])[end if].".

Table of Progue's Initial Appearance
animus		episode		desc
fishing		an episode		"[The Progue] is here, trolling the shallows near the beach with a fishing line."
ruminating	--			"[if the psyche of Progue is resolved]Progue stands nearby, trembling, tired, but somehow also suffused with real peace[else][The Progue], perched on [Progue's perch], seems deep in thought[end if]."
scrapbooking	--		"Progue sits on the ledge, rummaging listlessly through his pile of possessions."
mending	--			"[The Progue] is sitting on [Progue's perch], mending his tattered clothes with a needle and thread."
hand-standing	--		"[The Progue] is walking carefully across the [surface-material] on his hands, a look of upside-down concentration on his face."
cleaning		--			"Progue is scrubbing the surface of the workbench, whistling cheerfully."
paint-making	--		"Progue, surrounded by baskets, pots, konokuk leaves, and crude tools, is cheerfully mixing paints."
frog-catching	--		"[The Progue] is here, [if caught-frog is true]kneeling on the ground with a small green frog cradled in his hands[mf2l][otherwise]crawling through the marsh, eyes pinned on the ground[end if]."
swimming	--			"[The Progue] is a few swells away, bobbing lazily as he floats on his back, eyes closed."
beach-combing	--		"[The Progue] is here, walking carefully up and down the beach and studying the sand critically. His arms are full of bits of wood, seaweed, and broken shells."
resting		--			"Lying on the [surface-material] is [the Progue], [if the psyche of progue is emotional]covered in blankets and sleeping uneasily[otherwise]sound asleep[end if]."
convalescing		--	"Progue sits up weakly back against the wall, watching you as you enter."
loitering			--	"[The Progue] [if we are going or we are landmark-going]looks up eagerly as you approach[else]stands nearby, [proguedeciding][end if]."
player-seeking	--	"[The Progue] [if we are going or we are landmark-going]looks up as you approach[else]stands nearby, [proguedeciding][end if]."
hottubbing	--	"[The Progue] relaxes on the edge of the pool, flexing shriveled toes just under the surface."
stoicising	--	"Progue is nearby, solemn, lost within his own thoughts."

To say mf2l: move frog to Progue. 

To say proguedeciding: say "[one of]peering intently at a fingernail[or]idly stretching[or]momentarily distracted by one patchwork-covered sleeve[or]tapping a finger thoughtfully against his nose[in random order]".

Section - Description

The description of Progue is "[description-Progue]". 

To say description-Progue:
	if Progue is wishing:
		if an unimportant episode is playing, say "He looks like he's on his way somewhere.";
		else say "He's engrossed in the conversation.";
		stop;
	repeat through Table of Progue's Description:
		if there is an episode entry and current episode is episode entry:
			say "[desc entry]";
			unless the animus of Progue is resting or the psyche of Progue is emotional:	
				if ( an episode is playing and current episode is serendipitous ) or no episode is playing, say "[paragraph break][Progue-mood-summary]";
			stop;
	repeat through Table of Progue's Description:
		if there is an animus entry and animus entry is the animus of Progue:
			say "[desc entry]";
			unless the animus of Progue is resting or the psyche of Progue is emotional:
				if ( an episode is playing and current episode is serendipitous ) or no episode is playing, say "[paragraph break][Progue-mood-summary]";
			stop;
	say "He is a tall and spindly figure whose age has been clouded by castaway years to become unsure and irrelevant, bleached hair and bushy eyebrows lifting a contented face scrubbed clean by sea breeze and sunlight. He wears pants that were once white, and a shirt that was once blue but now falls in grey threadbare tatters and streams from bony arms and scratched elbows, a dancer's costume twirling alike with the breeze and his jittery movements. These seem focused in his large, rough hands, as if they house some sleeping power that swells joints and sharpens sinews in constant, futile struggle to escape.".

Table of Progue's Description
animus		episode		desc
ruminating	--			"[The Progue] sits on [Progue's perch], seemingly lost in thought."
resting		--			"[if the psyche of Progue is emotional]His skin is pale and clammy, and his breathing labored. He does not look well[otherwise]Sleeping deeply, he seems at first glance the picture of a shipwreck victim: faded and torn rags akimbo on bony joints, long hair touched with grey, matted and thinning, and a sun-worn face.[paragraph break]Even in rest, however, there is some vague power in his figure, some animus that decrepitude has yet to touch[end if]."
fishing		--			"[The Progue] trolls the shallows along the lagoon with a crude line, eyes focused intently on the tiny shapes darting through the water near his ankles."
swimming	--			"Bobbling like a tan cork on the waves, [the Progue] floats serenely, eyes shut, a faint smile on his face."
mending	--			"[The Progue], perched on [Progue's perch], mends his clothes with a needle and thread."
hand-standing	--		"He seems to be utterly enjoying himself."
cleaning		--			"He has made good headway already, throwing everything hopelessly corroded or damaged into a pile and sorting and ordering what's left, while scrubbing the years of dirt and neglect from the workbench."
paint-making	--		"Dotted with specks of color and drenched in sweat, he nevertheless seems cheerful as he mixes the crushed ingredients you brought him in a large pot."
frog-catching	--		"Crawling through the marsh heedless of the muck and grime, [the Progue] is focused intently on [if caught-frog is true]the small frog caught in the cage of his hands[otherwise]the ground, moving his attention slowly from one clump of grass and rocks to another[end if]."
beach-combing	--		"He seems intent on his task, which seems to be nothing less than keeping the entire beach immaculately spotless."
hottubbing	--			"[The Progue] seems to enjoy the hot, swirling waters of the spring."
convalescing		--	"His skin is pale, and he looks incredibly weak. You are not sure he is going to survive."
stoicising	--	"Some inner strength has returned. He looks down at his hands and rubs his fingertips together, and the faintest touch of a smile reaches his lips."

[ Examining Progue reveals information about his internal state.]

To say Progue-mood-summary:
	say "He ";
	if submission of Progue is 8 begin; say "practically grovels, flinching at your every sudden move, but";
	otherwise if submission of Progue >= 6; say "rubs his hands nervously, watching your every move for cues, and";
	otherwise if submission of Progue >= 4; say "stands back a few feet from you respectfully and";
	otherwise if submission of Progue >= 2; say "seems hesitant and ready to defer to you, but";
	otherwise if submission of Progue >= -1; say "seems a bit out of sorts around you, and";
	otherwise if submission of Progue >= -3; say "seems to know what he is doing, and";
	otherwise if submission of Progue >= -5; say "seems confident and in command of the situation, and";
	otherwise if submission of Progue >= -7; say "commands a wide arc of personal space, and";
	otherwise if submission of Progue is -8; say "seems to tower over you commandingly and";
	end if;
	say " [one of]regards[or]fixes[in random order] you with ";
	if romance of Progue > 0 begin;
		if romance of Progue is 1, say "a wink";
		if romance of Progue is 2, say "a cocky smirk";
		if romance of Progue is 3, say "a knowing smile and raised eyebrow";
		if romance of Progue is 4, say "a flirtatious smile";
		if romance of Progue >= 5, say "a contented, twitterpated smile";
		if romance of Progue < -1, say "a dirty, hateful glance";
	otherwise;
		if affinity of Progue is 8, say "the trusting smile of a lifelong friend";
		if affinity of Progue is 7, say "a trusting smile that reaches his eyes";
		if affinity of Progue is 6, say "genuine friendliness";
		if affinity of Progue is 5, say "a sparkling grin";
		if affinity of Progue is 4, say "a friendly smile";
		if affinity of Progue is 3, say "a guarded smile";
		if affinity of Progue is 2, say "an amused smirk";
		if affinity of Progue is 1, say "one corner of his mouth lifted";
		if affinity of Progue is 0, say "an indifferent expression";
		if affinity of Progue is -1, say "a raised eyebrow";
		if affinity of Progue is -2, say "a look of annoyance";
		if affinity of Progue is -3, say "a frown";
		if affinity of Progue is -4, say "narrowed eyes";
		if affinity of Progue is -5, say "unconcealed anger";
		if affinity of Progue is -6, say "contempt";
		if affinity of Progue is -7, say "a look of hatred";
		if affinity of Progue is -8, say "a look of total hatred";
	end if;
	if paternalism of Progue > 1 begin;
		if paternalism of Progue is 8 begin; say ", ";
		otherwise if paternalism of Progue >= 6; say ", like ";
		otherwise if paternalism of Progue >= 4; say ", almost like ";
		otherwise; say ", reminding you a bit of ";
		end if;
		say "a";
		if affinity of Progue > 4 begin; say " proud father";
		otherwise if affinity of Progue >= 0; say " father figure";
		otherwise if affinity of Progue >= -5; say " disappointed father";
		otherwise; say "n angry father";
		end if;
	end if;
	say ".";
	continue the action.


Section - Distant Description

[ We often describe Progue at a distance; when we do, we move this object into scope, which lets the player examine Progue. We can set him to be "out-of-sight" to indicate that he has just left visibility.]

Distant-progue is minor set dressing. The printed name of distant-Progue is "[the Progue]". Understand "figure/form/man/Progue" as distant-Progue. The provoke message of distant-Progue is "He's not nearby."

Check following distant-progue: try following Progue instead. Does the player mean following Progue: it is likely. 

Rule for supplying a missing noun when saying farewell to and distant-Progue is in location: say "He's already out of earshot." instead.

Distant-progue can be in-sight or out-of-sight. Distant-progue is in-sight. Every turn when distant-progue is out-of-sight and distant-progue is off-stage: now distant-progue is in-sight. [ This object can be used both when we're seeing Progue at a distance, and when Progue has just vanished from our sight, in which case the "out-of-sight" flag is used. ]

The description of distant-Progue is "[if out-of-sight]He is no longer in sight.[otherwise if the psyche of Progue is resolved]He raises a single hand to you silence.[otherwise if current episode is Rayfish Suicide]He's not moving.[otherwise if current episode is Word Day]The figure stands atop one of the rounded boulders and shouts at the surf.[otherwise if Progue is wishing][The Progue] seems to be on his way somewhere.[otherwise][The Progue], off near [prose name of location of Progue], seems to be [Progue-animus].[end if]".

Understand "[greeting word]" or "say [greeting word]" or "[greeting word] [distant-Progue]" as a mistake ("[if current episode is Word Day]The figure seems completely oblivious to your attempts to gain his attention; maybe if you got closer to the [d]boulders[x] he could see you better[otherwise]You're too far away to easily attract his attention; maybe if you made some noise or got closer[end if].") when distant-Progue is enclosed by location. 

First Instead of waking or kissing or touching or hugging or pushing or attacking distant-Progue: say "He's too far away." instead.

First report remembering Progue:
	say "The last time you saw him, [the Progue] was [if remembered spot is location]right here[otherwise if remembered spot is unvisited]heading towards an area you haven't explored[otherwise]at [the prose name of remembered spot][end if]." instead.



Part - Progue's Behavior

Chapter - Movement & Occupations

Section - Progue's Motivation Rule

[ When Progue is fulfilling (i.e. doing something), we don't have much to do; he just keeps doing it until his activity counter runs over. When he's wishing, we follow the Progue's motivation rule, which deals with choosing a new activity, determining where it should be done, moving Progue there, beginning the new activity, and describing any part of this process that should happen to be visible to the player. ]

Every turn when Progue is wishing and Progue is idle and the player is regionally in Lacuna and Progue is on-stage and the psyche of Progue is not fugue and the psyche of Progue is not resolved (this is the trigger Progue's motivation rule):
	if Progue is being debugged, say "// Progue: trigger Progue's motivation rule (because Progue is wishing and Progue is idle and etc.).";
	follow the Progue's motivation rule.

This is the Progue's motivation rule: 	
	if Progue is being debugged, say "// Progue: motivation rule (animus: [Progue-animus]).";
	if animus of Progue is player-seeking, now progue-venue is location of player;
	if progue-venue is UnRoom begin;  [ we need to pick a place to go ] 
		now progue-venue is location;
		let counter be 0;
		while progue-venue is location and counter < 5 begin;
			select a progue-venue for Progue;
			increase counter by 1;
		end while;
		if Progue is being debugged begin;
			if counter >= 5, say "// Progue: trying to pick a fresh progue-venue but keep selecting present location ([location of Progue]); giving up.";
			otherwise say "// Progue: picked a fresh progue-venue for Progue ([progue-venue]).";
		end if;
	end if;
	if progue-venue is not the location of Progue begin;  [ we've been assigned a place to go but we aren't there ]
		if progue-venue is Lower Beach and tidein, now progue-venue is North Beach;
		if progue-venue is off limits to Progue begin;
			do nothing; [ stays put]
		otherwise if exploring Progue's turf;
			let aim be the Lacuna route from the location of Progue to progue-venue; 
			if aim is not a direction begin;
				if Progue is being debugged, say "// Progue ERROR: [aim] is not a direction. ";
				do nothing instead;
			end if;
			if the room aim from the location of Progue is not a room begin;
				if Progue is being debugged, say "// Progue ERROR: the room [aim] from the location of Progue ([location of Progue]) is not a room.";
				do nothing instead;
			end if;
			if the room aim from the location of Progue is off limits to Progue begin;
				if Progue is being debugged, say "// Progue (in [location of Progue]) hesitates instead of going [aim] to reach destination [progue-venue].";
				do nothing instead;
			end if;
			if Progue is being debugged, say "// Progue (in [location of Progue]) tries going [aim] to reach destination [progue-venue].";
			let frmrl be location of Progue;
			move Progue to the room aim from frmrl;
			describe Progue moving from frmrl to the location of Progue;
			if distant-Progue is in location of Progue, remove distant-Progue from play; [ so if Progue arrives somewhere, we get rid of the far off version of him. ]
		otherwise;  [ not nearby  ]
			if Progue is being debugged, say "// Progue (in [location of Progue]) teleports to [progue-venue] (because not exploring Progue's turf).";
			move Progue to progue-venue;
		end if;
	otherwise; [ we've arrived and are ready to go. ]
		if Progue is being debugged, say "// Progue: arrived at progue-venue ([progue-venue]); setting to fulfilling.";
		now Progue is fulfilling;
		if the animus of Progue is ruminating begin;
			if Progue is enclosed by location and dont_describe_progue is false, say "[The Progue] sits on [Progue's perch], puts his chin in his hands, and stares into the distance moodily.";
			now Progue's animus table is Table of Progue Ruminating;
		otherwise if the animus of Progue is scrapbooking;
			if Progue is enclosed by location and dont_describe_progue is false, say "Progue sits down and begins rummaging through his strange assembly of possessions in a listless, sad manner.";
			now Progue's animus table is Table of Progue Scrapbooking;
		otherwise if the animus of Progue is resting;
			if Progue is enclosed by location and dont_describe_progue is false, say "[The Progue] [if psyche of Progue is emotional]drifts off into an uneasy, labored sleep[otherwise]falls lightly to the ground, curls up, and shuts his eyes tightly[end if].";
			now Progue's animus table is Table of Progue Sleeping;
			now the animus of Progue is resting;
		otherwise if the animus of Progue is fishing;
			if Progue is enclosed by location and dont_describe_progue is false, say "[The Progue] wades into the surf, fiddles for a few moments with his fishing pole, then casts it into the water.";
			now Progue's animus table is Table of Progue Fishing;
		otherwise if the animus of Progue is mending;
			if Progue is enclosed by location and dont_describe_progue is false, say "[The Progue] perches on [Progue's perch], pulls out a bone needle and a bundle of brown fibers, and begins mending his patchy pants.";
			now Progue's animus table is Table of Progue Mending;
		otherwise if the animus of Progue is hand-standing;
			if Progue is enclosed by location and dont_describe_progue is false, say "[The Progue] flexes his hands, then dives forward onto the [surface-material] and ends up standing on them, tanned feet flailing in midair.";
			now Progue's animus table is Table of Progue Hand-Standing;
		otherwise if the animus of Progue is paint-making;
			if Progue is enclosed by location and dont_describe_progue is false, say "Progue takes the basket out, grabs some implements, a few pots filled with various other materials, and begins to mix.";
			now Progue's animus table is Table of Progue Paint-Making;
		otherwise if the animus of Progue is cleaning;
			if Progue is enclosed by location and dont_describe_progue is false, say "Progue studies the mess on the workbench sadly, then rolls up his sleeves and gets to work cleaning it off.";
			mark workbench cleaned;
			now Progue's animus table is Table of Progue Cleaning;
		otherwise if the animus of Progue is frog-catching;
			if Progue is enclosed by location and dont_describe_progue is false, say "[The Progue] crouches on his knees in the muck and begins slowly waddling around, peering in clumps of grass, under rocks, and letting a quiet, low whistle out from between his teeth.";
			now Progue's animus table is Table of Progue Frog-Catching;
		otherwise if the animus of Progue is conch-blowing;
			if Progue is enclosed by location and dont_describe_progue is false, say "Progue spies something on the ground and bends down. He digs a little in the sand and pulls up an enormous conch shell. Grinning, he cleans the wet sand from it and admires it.";
			now Progue's animus table is Table of Progue Conch-Blowing;
		otherwise if the animus of Progue is hiding;
			now Progue's animus table is Table of Progue Hiding;
		otherwise if the animus of Progue is swimming;
			if Progue is enclosed by location and dont_describe_progue is false, say "[The Progue] swims up to within a few swells of you, then kicks back and floats on the surface of the water, hands folded behind his head.";
			now Progue's animus table is Table of Progue Swimming;
		otherwise if the animus of Progue is beach-combing;
			if Progue is enclosed by location and dont_describe_progue is false, say "[The Progue] begins gathering up pieces of seaweed, shells, and other debris, cupping them in his hands.";
			now Progue's animus table is Table of Progue Beach-Combing;
		otherwise if the animus of Progue is hottubbing;
			if Progue is enclosed by location and dont_describe_progue is false, say "[The Progue] [one of]cannonballs into the water with a little whoop[or]dives lithely into the center of the pool[in random order], before surfacing and swimming to a good sitting spot near one side to relax.";
			now Progue's animus table is Table of Progue Hottubbing;
		otherwise if the animus of Progue is convalescing;
			if Progue is enclosed by location and dont_describe_progue is false, say "Progue stirs, then coughs suddenly and opens his eyes. Blinking at you blearily, he sits up and rests against the wall of the cabin weakly.";
			now Progue's animus table is Table of Progue Convalescing;
		otherwise;
			if Progue is being debugged and Progue is enclosed by location, say "// Progue: begins [the animus of Progue] (for which there is no initial msg or animus table).";
			now Progue's animus table is Table of Progue Default;
		end if;
	end if.

Section - Picking a New Activity for Progue


[ To decide what to do next, Progue consults his animus table, and also considers such factors as whether it is time for bed or whether it is raining. Once decided, if present we describe him completing the old activity (stored in prior animus).]

To pick a new activity for Progue: 
	if Progue is being debugged, say "// Progue: pick a new activity.";
	now the prior animus of Progue is the animus of Progue;
	if the next animus of Progue is not null-endeavour begin;
		now the animus of Progue is the next animus of Progue;
		now the next animus of Progue is null-endeavour;
	otherwise if it is after 7:00 PM or it is before 4:59 AM;
		now the animus of Progue is resting;
	otherwise;
		if the psyche of Progue is ignorance begin; choose a random row in the Table of Progue Ignorance Endeavours;
		otherwise if the psyche of Progue is denial; choose a random row in the Table of Progue Denial Endeavours;
		otherwise if the psyche of Progue is fear; choose a random row in the Table of Progue Fear Endeavours;
		otherwise if the psyche of Progue is suppression; choose a random row in the Table of Progue Suppression Endeavours;
		otherwise if the psyche of Progue is uncertainty; choose a random row in the Table of Progue Uncertainty Endeavours;
		otherwise if the psyche of Progue is emotional; choose a random row in the Table of Progue Emotional Endeavours;
		otherwise; choose a random row in the Table of Progue Fugue Endeavours;
		end if;
		if raining and the psyche of Progue is denial, now the animus of Progue is ruminating;
		otherwise now the animus of Progue is pick entry;
	end if;
	now Progue is wishing;
	now the activity counter of progue is 0;
	if Progue is being debugged, say "// Progue: picked a new animus ([animus of Progue]) replacing [prior animus of Progue].";
	if the prior animus of Progue is cleaning begin;
		mark workbench cleaned;
	end if;
	if the prior animus of Progue is paint-making begin;
		while there is a pick of paint-making in Table of Progue Suppression Endeavours begin;
			choose row with pick of paint-making in Table of Progue Suppression Endeavours;
			blank out the whole row;
		end while;
		while there is a pick of paint-making in Table of Progue Uncertainty Endeavours begin;
			choose row with pick of paint-making in Table of Progue Uncertainty Endeavours;
			blank out the whole row;
		end while;
		while the number of paintpots enclosed by Progue > 0 repeatedly move a random paintpot enclosed by Progue to Studio;
	end if;
	if the prior animus of Progue is beach-combing and location of Progue is regionally in Beachfront, cleanify the beach in location of Progue;
	if the prior animus of Progue is the animus of Progue begin;
		unless current episode is rendezvous and location is not meeting place of current episode, now Progue is fulfilling; [ already there; job's done ]
	otherwise if location of Progue is not progue-venue and location of Progue is not UnRoom;
		if progue is being debugged, say "// Progue: skipping description because location of Progue ([location of Progue]) is not progue-venue ([progue-venue]).";
		do nothing; [ Progue was pulled away from the natural location of his last task, so it may not be safe to describe him finishing it here. ]	
	otherwise if Progue is enclosed by location and dont_describe_Progue is false;
		let skipdecision be false; [ We can set this to true if we don't want to show Progue deciding what to do for various reasons; this later adjusts line breaks as necessary.]
		if the prior animus of Progue is ruminating begin; say "[The Progue] [one of]stands[or]gets up[or]gets to his feet[at random], [one of]seems to shake himself[or]rubs his face and blinks a few times[or]stretches[at random], and [one of]looks around, seemingly surprised at the time[or]glances around him, bemused[at random]";
		otherwise if the prior animus of Progue is scrapbooking; say "Finally putting the items aside, Progue rises with a sigh, brushing his hands off on his pants";
		otherwise if the prior animus of Progue is resting; if the psyche of Progue is emotional, say "Progue opens his eyes slowly, blinking and seeming unable to focus. Finally he stretches and sits up a little bit, glancing around the room blearily"; otherwise say "[one of]With a great yawn, [the Progue] opens his eyes and stretches[or][The Progue] suddenly sits up with a start, looking around wildly for a moment before calming down[or][The Progue] rolls over and opens his eyes, scratching his eyes and then blinking them blearily open[at random]. After a moment, he gets to his feet and rubs his hands together"; 
		otherwise if the prior animus of Progue is fishing; say "[one of]With a look of disgust, [the Progue] gathers in his fishing line and wades back to dry land[or]With a satisfied grunt, [the Progue] disassembles his pole and brushes off his hands[or][The Progue] reels in his fishing line hand over hand, returns it to a pocket, and sloshes noisily back to shore[at random]"; 
		otherwise if the prior animus of Progue is mending; say "[The Progue] [one of]tucks[or]puts[at random] the needle and thread [one of]back in his pocket[or]away[at random] and [one of]gets up[or]stands[or]rises[at random]";
		otherwise if the prior animus of Progue is hand-standing; say "Balancing carefully, [the Progue] executes a neat little flip that leaves him standing back on his feet again. He brushes his hands off in satisfaction, as if something terribly important has been accomplished";
		otherwise if the prior animus of Progue is cleaning; say "Progue nods at the cleaned-up workbench in satisfaction. 'Good then, ready to be used again,' he says";
		otherwise if the prior animus of Progue is paint-making; say "Progue sets the pot full of vivid paint on the counter and wipes his hands off on a konokuk leaf. 'Excellent: should last for weeks,' he says";
		otherwise if the prior animus of Progue is frog-catching; say "[if caught-frog is true]Sadly, [the Progue] puts his hands near the ground and lets his captive leap away[otherwise]Grunting, [the Progue] rises to his feet and brushes his hands on his pants, sighing despondently[end if]";
		otherwise if the prior animus of Progue is beach-combing; say "[The Progue] takes one final look around the now-immaculate beach, and nods in satisfaction"; 
		otherwise if the prior animus of Progue is hottubbing; say "Hopping lithely from the water, [the Progue] quickly slips back into his patchwork garments and dances from foot to foot in a beam of sunlight, shaking his arms"; move Progue to Hot Springs;
		otherwise if the prior animus of Progue is swimming; say "Abruptly, [the Progue] kicks and sinks backwards into the water, only to surface again and begin kicking back to shore with a powerful stroke";
		otherwise; now skipdecision is true; [ If the animus of Progue was something else, we were probably talking to him, and so we probably already described him finishing what he was doing (talking).]
		end if;
		if the prior animus of Progue is not swimming and the animus of Progue is fishing begin; say ". He pulls out a short length of bamboo with a line attached to it from somewhere in his patchwork costume.";
		otherwise if skipdecision is false; say "."; end if;
	end if;
	unless current episode is rendezvous and location is not meeting place of current episode, now progue-venue is UnRoom;
	if the prior animus of Progue is fishing, remove fishing-pole from play;
	if the animus of Progue is fishing, move fishing-pole to Progue.

[ To determine where to perform an animus at, we define valid locations for each one by hand.]

To select a progue-venue for Progue:
	if the animus of Progue is ruminating begin; now progue-venue is a random room in Beachfront;
	otherwise if the animus of Progue is resting;
		if the psyche of Progue is fear begin;
			now progue-venue is Ledge;
		otherwise;
			if the psyche of Progue is emotional begin; now progue-venue is Hut;
			otherwise if a random chance of 1 in 2 succeeds and nothing dramatic is up; now progue-venue is a random room in Beachfront;
			otherwise; now progue-venue is Ledge; end if;
		end if;
		if progue-venue is Lower Beach, now progue-venue is North Beach;
	otherwise if the animus of Progue is fishing; if tidein, now progue-venue is a random room in Beachfront; otherwise now progue-venue is Lower Beach;
	otherwise if the animus of Progue is swimming; now progue-venue is Ocean Waters;
	otherwise if the animus of Progue is mending; now progue-venue is a random room in Beachfront;
	otherwise if the animus of Progue is loitering; now progue-venue is location of Progue;
	otherwise if the animus of Progue is hand-standing; let brp be a random number from 1 to 3; if brp is 1, now progue-venue is Stumps; if brp is 2, now progue-venue is Rise; if brp is 3, now progue-venue is Chairlift Base;
	otherwise if the animus of Progue is cleaning; now progue-venue is Studio;
	otherwise if the animus of Progue is paint-making; now progue-venue is Studio;
	otherwise if the animus of Progue is frog-catching; now progue-venue is a random room in Marshlands;
	otherwise if the animus of Progue is hiding or the animus of Progue is spying or the animus of Progue is scrapbooking; now progue-venue is Ledge;
	otherwise if the animus of Progue is conch-blowing; now progue-venue is Center Beach;
	otherwise if the animus of Progue is player-seeking; now progue-venue is location of player;
	otherwise if the animus of Progue is beach-combing; now progue-venue is Among the Boulders; while progue-venue is Among the Boulders begin; now progue-venue is a random room in Beachfront; end while;
	otherwise if the animus of Progue is hottubbing; now progue-venue is Hot Springs;
	otherwise if the animus of Progue is convalescing; now progue-venue is Hut;
	otherwise; now progue-venue is a random room in Beachfront;
	end if;
	if Progue is being debugged, say "// Progue: selected a progue-venue ([progue-venue]).".


Section - Activity Counter

[ Progue's activity counter is used to keep track of how long he is doing something. By default, when it reaches 15 (about 45 minutes by the in-game clock) he'll pick something new to do.]

Progue has a number called activity counter. The activity counter of Progue is 0.

Every turn when the player is awake and the player is regionally in Lacuna and Progue is fulfilling and Progue is idle and the animus of Progue is not spying and the psyche of Progue is not resolved (this is the Progue hates monotony rule):
	if Progue is being debugged, say "// Progue (now in [location of Progue]): Progue hates monotony rule (because player is awake and Progue is fulfilling and the animus of Progue is not spying) (increasing activity counter by 1 to [activity counter of Progue]).";
	increase the activity counter of Progue by 1;
	if we are waiting, increase the activity counter of Progue by 1;
	if the animus of Progue is loitering and no episode is playing, pick a new activity for Progue.	[ Progue keeps spying until a scene has been triggered. ]

Every turn when the activity counter of Progue is at least 15 and Exploring Lacuna is happening and no episode is playing and Progue is on-stage and Progue is idle and the psyche of Progue is not resolved (this is the trigger Progue to pick a new activity rule):
	if the animus of Progue is cleaning and the activity counter of Progue < 75, stop;
	if Progue is being debugged, say "// Progue (now in [location of Progue]): picking a new activity (because activity counter of Progue is at least 15 ([activity counter of Progue]) and Exploring Lacuna is happening and Progue is on-stage and Progue is idle.";
	 pick a new activity for Progue.


Section - Movement Processing

[ Because pathfinding is an inherently time-intensive operation, especially with a map as large as ours, and because Progue confines himself to a relatively small part of the island, we include some shortcut code and lookup tables to speed up the process when Progue needs to move.]

To decide which direction is the Lacuna route from (origin - a room) to (destination - a room):
	if origin is Tidepools, decide on northeast;
	if origin is Ocean Waters, decide on east;
	if origin is Chairlift Base, decide on southeast;
	if origin is Ledge, decide on down;
	if origin is Hot Springs, decide on west;
	let dirnum be 0;
	if there is a dest of destination in Table of PPF begin;
		if origin is North Beach, now dirnum is the nbc corresponding to a dest of destination in Table of PPF;
		if origin is Center Beach, now dirnum is the cbc corresponding to a dest of destination in Table of PPF;
		if origin is South Beach, now dirnum is the sbc corresponding to a dest of destination in Table of PPF;
		if origin is Among the Boulders, now dirnum is the atb corresponding to a dest of destination in Table of PPF;
		if origin is Lower Beach, now dirnum is the lb corresponding to a dest of destination in Table of PPF;
		if origin is Tidepools, now dirnum is the td corresponding to a dest of destination in Table of PPF;
		if origin is Rise, now dirnum is the rise corresponding to a dest of destination in Table of PPF;
		if origin is Stumps, now dirnum is the stp corresponding to a dest of destination in Table of PPF;
		if origin is West-Marsh, now dirnum is the wm corresponding to a dest of destination in Table of PPF;
		if origin is East Marsh, now dirnum is the em corresponding to a dest of destination in Table of PPF;
		if origin is North Marsh, now dirnum is the nm corresponding to a dest of destination in Table of PPF;
		if origin is Hut, now dirnum is the ht corresponding to a dest of destination in Table of PPF;
		if origin is Studio, now dirnum is the std corresponding to a dest of destination in Table of PPF;
		if origin is Back Room, now dirnum is the br corresponding to a dest of destination in Table of PPF;
		if origin is Ocean Waters, now dirnum is the ow corresponding to a dest of destination in Table of PPF;
		if dirnum is 0 begin;
			if Progue is being debugged, say "// Progue: ERROR: can't find a route from [origin] to [destination]; resetting progue-venue to Center Beach.";
			decide on the best route from origin to destination;
		otherwise;
			if dirnum is 1, decide on north;
			if dirnum is 2, decide on northeast;
			if dirnum is 3, decide on east;
			if dirnum is 4, decide on southeast;
			if dirnum is 5, decide on south;
			if dirnum is 6, decide on southwest;
			if dirnum is 7, decide on west;
			if dirnum is 8, decide on northwest;
			if dirnum is 9, decide on up;
		end if;
	otherwise;
		decide on the best route from origin to destination;
	end if.

Table of PPF [ Progue PathFinding]
dest					nbc	cbc	sbc	atb	lb	td	rise	stp	wm	em	nm	ht	std	br	ow
North Beach			--	1	1	2	2	2	4	5	6	7	6	7	5	7	3
Center Beach		5	--	1	2	3	2	4	5	6	7	6	7	5	7	3
South Beach			5	5	--	2	4	2	4	5	6	7	6	7	5	7	3
Among the Boulders	5	5	6	--	5	2	4	5	6	7	6	7	5	7	3
Lower Beach			6	7	8	1	--	2	4	5	6	7	6	7	5	7	3
Tidepools			5	5	6	6	5	--	4	5	6	7	6	7	5	7	3
Ocean Waters		6	7	8	1	7	2	4	5	6	7	6	7	5	7	--
Hut					5	3	1	2	3	2	4	5	6	7	6	7	5	7	3
Rise					8	1	1	2	2	2	--	5	6	7	6	7	5	7	3
Stumps				8	1	1	2	2	2	1	--	6	7	6	7	5	7	3
Chairlift Base		8	1	1	2	2	2	1	8	6	7	6	7	5	7	3
West-Marsh			8	1	1	2	2	2	1	2	--	7	6	7	5	7	3
East Marsh			8	1	1	2	2	2	1	2	3	--	5	7	5	7	3
North Marsh			8	1	1	2	2	2	1	2	2	1	--	7	5	7	3
Ledge				8	1	1	2	2	2	1	2	2	1	9	7	5	7	3
Hot Springs			8	1	1	2	2	2	3	5	6	7	6	7	5	7	3
Studio				5	3	1	2	3	2	4	5	6	7	6	1	--	7	3
Back Room			5	3	1	2	3	2	4	5	6	7	6	3	5	--	3

[ Progue will never venture into certain parts of the island; if he is tracking down the player, he needs to know where the boundaries are.]

To decide whether (destination - a room) is off limits to Progue:
	if Progue is being debugged, say "// Progue: deciding whether [destination] is off limits to Progue.";
	if destination is Jumble or destination is Fork or destination is Cliffside or destination is Saddle, decide yes;
	if destination is regionally in Beachfront or destination is regionally in Progue's Domain or destination is Tidepools or destination is Lower Beach or destination is Ocean Waters or destination is Rise or destination is Hot Springs or destination is regionally in North Island or destination is regionally in Marshlands or destination is Ledge, decide no;
	decide yes.

To decide whether exploring Progue's turf:
	if the player is in North Island or the player is in Marshlands or the player is in Beachfront or the player is in Progue's Domain or the player is in Tidepools or the player is in Lower Beach or the player is in Ocean Waters or the player is in Ledge, decide yes;
	decide no.

Section - Something to Sit On


The perch is a thing that varies. 

To say Progue's perch:
	now the perch is a random perchable setpiece in location;
	if the perch is nothing begin;
		if location of Progue is not pp-l begin;
			now pp-l is location of Progue;
			now pp-wd is "[one of]a rock[or]a boulder[or]the [surface-material][or]a log[at random]";
		end if;
		say "[pp-wd]";
	otherwise;
		say "[the perch]";
	end if. 

pp-l is a room that varies. pp-wd is an indexed text that varies.


Section - Describing Progue's Movement

[ Sightlines depend less on map connections than on geography, which is invisible to the parser. We decide by hand whether the player can see Progue from any given location. ]
	
To decide whether (area - a room) is Proguevisible:
	if Progue is being debugged, say "// Progue: decide whether [area] is Proguevisible.";
	if location is Among the Boulders, decide no; [ no good sightlines from here ]
	if location is in Tiderooms and ( area is in Beachfront or area is Lower Beach or area is in Tiderooms or area is Rise or area is Tidepools ) , decide yes;
	if location is in Beachfront and ( area is in Tiderooms or area is Lower Beach or area is in Beachfront or area is Rise or area is Tidepools ) , decide yes;
	if location is Ocean Waters and ( area is in Tiderooms or area is Lower Beach or area is in Beachfront or area is Rise or area is Tidepools ) , decide yes;
	if location is in Beachfront and current episode is Word Day, decide yes;
	if location is Tidepools and ( area is in Tiderooms or area is in Beachfront or area is Lower Beach or area is Rise ) , decide yes;
	if location is Rise and ( area is in Tiderooms or area is Lower Beach or area is in Beachfront or area is in Marshlands or area is Stumps ) , decide yes;
	if location is Stumps and ( area is Rise or area is Chairlift Base or area is West-Marsh ) , decide yes;
	if location is in Marshlands and area is in Marshlands, decide yes;
	if location is Chairlift Base and area is Stumps or area is West-Marsh or area is Rise, decide yes;
	if location is Ledge and ( area is in Marshlands or area is Stumps or area is Rise ) , decide yes;
	decide no.



[ Descriptions of Progue moving can vary based on the kind of terrain he is moving through, whether the origin, destination or both are visible to the player, whether one of those rooms is the one the player currently occupies or Progue's initial or final destination, and other factors. In addition, we might have set the dont_describe_Progue variable to true if we've already mentioned him moving and want to override the automatic mechanism, perhaps for a dramatic entrance or exit.]

dont_describe_Progue is a truth state that varies. dont_describe_Progue is false.

The last every turn rule (this is the clean up Progue's business rule): now dont_describe_Progue is false; if Progue is being debugged, say "//Progue: clean up: Progue is now in [location of Progue] and [psyche of Progue] and [Progue-animus] and [if Progue is attentive]attentive[otherwise]idle[end if] and [if Progue is wishing]wishing[otherwise]fulfilling[end if]; activity counter is [activity counter of Progue].".

To describe Progue moving from (origin - a room) to (destination - a room):
	if Progue is being debugged, say "// Progue: describe Progue moving from [origin] to [destination][if dont_describe_Progue is true] (skipping since dont_describe_Progue is true)[end if].";
	note position of Progue;
	if dont_describe_Progue is false and the player is awake:
		if origin is location:
			move distant-Progue to location;
			say "[The Progue]";
			if destination is Ocean Waters:
				say " wades into the surf, dives lithely into a rolling wave, and surfaces beyond it, kicking out into the ocean";
			else if location is Ocean Waters:
				say " swims off towards [the prose version of destination]";
			else if destination is Ledge:
				say " climbs up the cliff face at an astounding speed";
			else if destination is North Marsh and location is Ledge:
				say " kneels on the edge of the ledge and flips himself off it, spinning around in midair to grab the crack and start shimmying down it";
			else:
				if the animus of Progue is fishing:
					say " [one of]grasps the fishing pole loosely slung over his shoulder[or]bounces his fishing pole cheerfully against his shoulder[in random order]";
				else if the animus of Progue is swimming:
					say " [one of]strips out of his threadbare rags unselfconsciously[or]stretches one arm then the other[at random]";
				else if the animus of Progue is mending:
					say " [one of]rubs his threadbare clothes absently[or]glances down at his threadbare clothes and mutters disapprovingly to himself[or]rummages through his pockets for something[in random order]";
				else if the animus of Progue is hand-standing:
					say " [one of]rolls up his sleeves[or]half-dances as he hops lightly from foot to foot[or]holds out his hands and twirls his fingers in excitement[in random order]";
				else if the animus of Progue is cleaning:
					say " clutches a handful of dirty rags";
				else if the animus of Progue is paint-making:
					say " balances a jumble of baskets, pots, and crude implements";
				else if the animus of Progue is frog-catching:
					say " [one of]has a wistful, eager look in his eyes[or]mutters something about 'little ones'[or]whistles quietly to himself[in random order]";
				else if the animus of Progue is player-seeking:
					say " waves a hand in your direction";
				else if the animus of Progue is ruminating or the animus of Progue is scrapbooking:
					say " [one of]has a pensive expression[or]thoughtfully plucks one ear[in random order]";
				else if the animus of Progue is resting:
					say " [one of]stifles a yawn[or]looks exhausted[or]stretches his arms[in random order],";
				else if the animus of Progue is beach-combing and ( location is Rise or location is regionally in Beachfront or location is Tidepools or location is Lower Beach ) :
					say " [one of]studies the beach intently[or]eyes the tideline critically[or]keeps his eyes on something terribly important just in front of his feet[in random order],";
				else:
					say " [one of]scratches his nose[or]clears his throat with vigor[or]coughs once[or]itches his arm[or]glances up at the sky[or]tugs on his beard[in random order]";
				if the psyche of Progue is not denial and the psyche of Progue is not fear:
					if romance of Progue > 2 and a random chance of 2 in 3 succeeds:
						say " and [one of]winks slyly at you[or]tickles you in the ribs[or]grins at you with one raised eyebrow[in random order]";
					else if paternalism of Progue > 2 and a random chance of 1 in 2 succeeds:
						say " and [one of]regards you fondly[or]claps a hand to your shoulder[or]nods approvingly[in random order]";
					else if the affinity of Progue < 0:
						if submission of Progue > 0, say " and [one of]gives you a wide berth[or]fails to meet your eye[or]hurries past you nervously[in random order]";
						else say " and [one of]quickly brushes past you[or]strides by, ignoring you[or]marches past without even glancing at you[in random order]";
					else: [ affinity >= 0]
						if submission of Progue > 0, say " and [one of]smiles and nods deferentially[or]slips by with a smile and a wave, not getting in your way[in random order]";
						otherwise say " and [one of]strides by with a smile and a wave[or]jovially punches you in the arm[or]claps you strongly on the shoulder[in random order]";
				say " as he heads towards [the prose version of destination], [one of]leaving the vicinity[or]soon passing out of earshot[or]leaving the area[in random order]"; 
			  say ".";
		else if destination is location:
			move distant-Progue to location;
			say "[The Progue] ";
			if location is Ocean Waters:
				say "swims up to your vicinity from the shore";
			else if location is Ledge:
				say "suddenly pops into view, pulling himself up onto the ledge from the crack, fingers and hands flexing like two lithe spiders as he stands to his feet";
			else if location is North Marsh and origin is Ledge:
				say "shimmies lithely down the crack, using hands and feet more to deflect his course than anything else, and finally jumps onto the springy marsh nearby with a satisfied grunt";
			else:
				say "[one of]arrives in the vicinity[or]approaches[or]comes within speaking distance[or]walks by[in random order] from [the prose version of origin]"; 
			if the psyche of Progue is fear:
				say ". He catches sight of you and freezes, then dodges back out of sight";
				now Progue is fulfilling;
				Progue starts hiding;
				if location is Ledge, move Progue to Tidepools;
				otherwise move Progue to Ledge;
			say ".";
			if location of Progue is location and the animus of Progue is player-seeking, follow the Progue's motivation rule; [ So he starts talking immediately.]
		else if origin is Proguevisible and destination is Proguevisible:
			move distant-Progue to location;
			say "[inthedistance], you [glimpse] [the Progue] ";
			if destination is Ocean Waters:
				say "dive into the water and swim ";
			else:
				if the psyche of Progue is fear, say "fleeing ";
				else say "[one of]moving[or]heading[or]ambling[or]walking[or]making his way[in random order] ";
			if the prose name of origin is the prose name of destination, say "[one of]along[or]across[or]through[in random order] [the prose version of origin].";
			else say "from [the prose version of origin] to [the prose version of destination].";
		else if origin is Proguevisible:
			move distant-Progue to location;
			say "[inthedistance] [one of]near[or]by[at random] [the prose version of origin], you [glimpse] [the Progue] [if destination is Hut]step into the cabin[else if destination is Studio]step into the studio[else]moving out of sight[end if].";
			now distant-Progue is out-of-sight;
		else if destination is Proguevisible:
			move distant-Progue to location;
			say "[inthedistance], you [glimpse] [the Progue] [if origin is Studio]step out from the studio[else if origin is Hut]step out from the cabin[else]move into sight near [the prose version of origin][end if]";
			if the psyche of Progue is fear:
				say ". He catches sight of you and freezes, then dodges back out of sight";
				now Progue is fulfilling;
				Progue starts hiding;
				if location is Ledge, move Progue to Tidepools;
				otherwise move Progue to Ledge;
			say ".".

To say inthedistance: say "[one of]In the distance[or]Some distance away[in random order]". To say glimpse: say "[one of]see[or]spot[or]notice[or]glimpse[in random order]".

To say the prose version of (place - a room): if the prose name of place is "NULL", say "[printed name of place]"; otherwise say "[prose name of place]".


[ Normally, Progue is only described at a distance when he's in motion. If the player arrives in Progue's territory after being away, we break this rule to describe where Progue is and what he's doing, since this would be a highly noticeable part of the scenery.]

To decide whether arriving at a new vantage point:
	if location is Rise, decide yes; 
	if location is Center Beach and former location is Hut, decide yes;
	if location is South Beach and ( former location is Fork or former location is Among the Boulders ) , decide yes;
	decide no.

Every turn when ( we are going or we are landmark-going ) and arriving at a new vantage point and Progue is not enclosed by the location and Progue is on-stage and nothing dramatic is up and dont_describe_Progue is false and Progue is fulfilling (this is the noticing what Progue is doing rule):
	if Progue is being debugged, say "// Progue: noticing what Progue is doing rule (because we are going and arriving at a new vantage point).";
	if the location of Progue is Proguevisible, say "[inthedistance], [if location of Progue is Ocean Waters]in[otherwise]by[end if] [the prose version of location of Progue], you [if current episode is not Word Day and spotted-Progue is false]see a [o]figure[x] dressed in rags. He appears to be[otherwise][glimpse] [the Progue],[end if] [Progue-animus].";[aardist]
	now spotted-Progue is true;
	move distant-Progue to location;
	note position of Progue.

The noticing what Progue is doing rule is listed after the check episodes rule in the every turn rules. [ Since the start of an episode might drastically change what Progue is up to, we don't want to describe him doing anything until we're sure that's what he's actually doing.] 

To note position of Progue: [ This is the interface with Remembering.]
	if there is a character of Progue in Table of Remembered NPC Locations:
		choose row with a character of Progue in Table of Remembered NPC Locations;
		change area entry to location of Progue;
	otherwise:
		if the number of blank rows in Table of Remembered NPC Locations is at least 1:
			choose a blank row in Table of Remembered NPC Locations;
			change character entry to Progue;
			change area entry to location of Progue.





Chapter - Ambient Messages

[ Each animus has a table of ambient messages associated with it, which add color to the descriptions when the player is near Progue but not speaking to him.]

Every turn when Progue is enclosed by location and Progue is fulfilling and Progue is idle and nothing dramatic is up and we are not going and we are not looking (this is the reporting on Progue rule):
	if Progue is being debugged, say "// Progue: reporting on Progue rule (because Progue is enclosed by location ([location of Progue]) and Progue is fulfilling and Progue is idle ([Progue-animus])).";
	fire one off by frequency from Progue's animus table.  

Table of Progue Default
freq		start time	end time	text	table		trigger	flag
a frequency	an interval	an interval	text		a table-name	a thing	a number

Table of Progue Ruminating
freq		start time	end time	text	table		trigger	flag
common	--	--	"[The Progue] [one of]runs his hand through his beard, eyes locked on the horizon[or]emits a satisfied grunt and scratches his knee absently[or]chews his lower lip absently, lost in thought[in random order]."

Table of Progue Scrapbooking
freq		start time	end time	text	table		trigger	flag
common	--	--	"Progue [one of]picks up a piece of crystal, rubbing his fingers over and over across its smoothed surface[or]lifts a necklace of shells sadly, letting them twirl in the light[or]rummages through a pile of junk listlessly[in random order]."

Table of Progue Sleeping
freq		start time	end time	text	table		trigger	flag
common	--	--	"[The Progue] [if the psyche of Progue is emotional][one of]wheezes sickly in his sleep[or]tosses and turns restlessly in his sleep[or]mutters something indeterminable in his sleep[in random order][else][one of]emits a particularly loud snore[or]mutters something indeterminable in his sleep[or]rolls over and scratches himself[in random order][end if]."

Table of Progue Fishing
freq		start time	end time	text	table		trigger	flag
common	--	--	"[The Progue] [one of]walks slowly parallel to shore, flicking his line with one hand and watching the water intently[or]yanks the line suddenly up from the water, but is disappointed to find it empty. With a wry glance in your direction, he returns it to the water[or]flexes his toes happily in the wet sand as he monitors his fishing pole[in random order]."

A fishing-pole is a thing. Understand "fishing pole" or "pole" or "line/bamboo" as fishing-pole. The printed name is "fishing pole". The description is "Simply made out of a length of bamboo, some hairy brown twine, and a carefully sharpened stone hook, the pole looks well-used and often repaired.".

Table of Progue Swimming
freq		start time	end time	text	table		trigger	flag
common	--	--	"[The Progue] floats serenely on the surface of the water, eyes closed."
uncommon	--	--	"Kicking a little, [the Progue] adjusts his position a bit in some presumably advantageous fashion."
superrare			--	--	"[The Progue] suddenly sputters and sinks under water. He surfaces a moment later, treading water and looking down in annoyance.[paragraph break]'Fish up my shorts,' he says shortly, before returning to his floating position again."

Table of Progue Mending
freq		start time	end time	text	table		trigger	flag
common	--	--	"[The Progue] [one of]finishes mending a patch and studies it critically. With a noncommittal grunt, he turns to another small rip and begins to repair it[or]pricks his finger on the needle and winces[or]sticks his finger through a rip and wiggles it, carefully studying the material from all angles[in random order]." 

Table of Progue Hand-Standing
freq		start time	end time	text	table		trigger	flag
common	--	--	"[The Progue] [one of]takes a few steps on his hands, swaying dangerously[or]rebalances his weight to one hand, lifting the other up to scratch his nose[or]kicks his legs back and forth through the air lazily[or]watches a beetle scurry across the ground below his nose with great interest[or]hand-walks in a swaying circle around you[in random order]."

Before discussing when Progue is enclosed by location and Progue is fulfilling and the animus of Progue is hand-standing and is-hand-standing is true: now is-hand-standing is false; say "[one of]With a resigned sigh[or]Shifting position[in random order], [the Progue] [one of]tumbles to the ground[or]lets himself down[or]collapses in a heap[in random order] before leaping spryly to his feet, brushing off his hands.". 

Every turn when the animus of Progue is hand-standing and Progue is idle: now is-hand-standing is true. is-hand-standing is a truth state that varies.

Table of Progue Cleaning
freq		start time	end time	text	table		trigger	flag
frequent		--	--	"Progue [one of]picks up a broken pot, frowns, and tosses it into a pile of garbage[or]scrubs intently at the dusty surface of the workbench[or]pokes the hardened end of a brush sadly then tosses it into a pile of junk[or]delicately removes a spider's egg sac from the workbench and redeposits it in the windowsill[in random order]."

Noticing-Progue-Cleaning is a scene. Noticing-Progue-Cleaning begins when the animus of Progue is cleaning and ( location is Center Beach or location is Back Room or location is Hut ) and we-are-landmark-going is true. Noticing-Progue-Cleaning ends when Noticing-Progue-Cleaning begins. When Noticing-Progue-Cleaning begins: tidy landmark-go; clean up landmark-go.

cleaning_honeypot is a number that varies. cleaning_honeypot is 1.

Every turn when animus of Progue is cleaning and Progue is fulfilling and a random chance of 1 in cleaning_honeypot succeeds and ( location is Center Beach or location is Back Room or location is Hut ) :
	if cleaning_honeypot < 3, increase cleaning_honeypot by 1;
	say "[one of]An armful of mouldering paintbrushes[or]A dusty cloud of refuse[or]A broken paint pot[in random order] [one of]flies out[or]sails out[in random order] [if location is Center Beach]of the cabin window, joining a pile of other refuse in the sand[otherwise]the door of the studio, joining a pile of other refuse on the floor[end if].".

Table of Progue Paint-Making
freq		start time	end time	text	table		trigger	flag
frequent		--	--	"Progue [one of]sorts through his implements with an annoyed expression, before finally grabbing one and vigorously applying it to the bowl of paint[or]scrapes paint off the sides of a bowl and studies its consistency skeptically[or]adds something that looks like mud from another pot and mixes with vigor[in random order]."

Table of Progue Frog-Catching
freq		start time	end time	text	table		trigger	flag
common	--	--	"[The Progue] [if caught-frog is true][one of]sings quietly to his frog, stroking it gently[or]strokes his captive frog with one bony finger, smiling peacefully[or]holds the frog up to his eyes and studies it intently[or]whispers quietly to his frog, which seems content in his hands[in random order][otherwise][one of]moves slowly forward on his knees, eyes intent on the marsh vegetation[or]lunges suddenly towards a clump of grass, descending on it with a huge splash, but comes up empty-handed[or]freezes, cocking his head to listen for some noise you can't hear[or]stalks a muddy pool, moving slowly forward with hands outstretched[in random order][end if]." 

Caught-frog is a truth state that varies. [ Used when the animus of Progue is frog-catching to determine whether he's caught one.] 

Table of Progue Hiding
freq		start time	end time	text	table		trigger	flag	
frequent	--	--	"[one of]A clatter of rockfall and a whispered curse drift out from[or]The faint rustle of movement comes from[or]A quiet cough and a surussus of falling dirt whisper from[in random order] [if location is Ledge]somewhere in the crack[else]the top of one of the rounded boulders[end if]."

Table of Progue Convalescing
freq		start time	end time	text	table		trigger	flag	
common	--	--	"[The Progue] [one of]lets out a whimper of pain[or]rolls his head back and forth, grimacing[in random order]."

Table of Progue Conch-Blowing
freq		start time	end time	text	table		trigger	flag	
frequent	--	--	"[The Progue] turns the conch over in his hands, running fingertips over its pearlescent ridges and bumpy spirals."

Table of Progue Beach-Combing
freq		start time	end time	text	table		trigger	flag	
frequent	--	--	"[The Progue] putters along the beach, gathering everything other than the sand into his hands."
frequent	--	--	"[The Progue] darts from here to there, carefully extracting pieces of seaweed and seagull feathers from the wet sand."
common	--	--	"[The Progue] takes a few paces into the surf, and flings his handful of debris as far out as it will go. Satisfied, he returns his attention to the beach again."

Table of Progue Hottubbing
freq		start time	end time	text	table		trigger	flag	
common	--	--	"[The Progue] [one of]kicks his legs languidly in the hot water[or]swims to the other side of the pool to a slightly different seat[or]ducks completely under the water for a long moment before returning with a sputter[or]gazes absently at the blue [o]crystals[x] for a long moment[or]leans his head back and looks up at the sky, letting his body float aimlessly in the pool[in random order]."

Table of Progue Resting
freq		start time	end time	text	table		trigger	flag	
common	--	--	"[The Progue] [if psyche of Progue is emotional]sleeps uneasily with labored breathing, his skin looking pale and clammy[otherwise][one of]snores[or]mumbles something in his sleep[or]shifts restlessly in his sleep[in random order][end if]."

Chapter - Scheduling

[ Some episodes are really multi-part affairs, where Progue first negotiates a meeting with the player at a certain time, and then, if the player shows, the scene commences. So as not to confuse things, we schedule the second part through a table that tracks (a maximum of 2) future appointments. If it's time or almost time for a scheduled episode, new scenes won't be triggered.

When the appointed time arrives, we begin the episode; if it's a rendezvous episode, Progue should go to the appropriate spot and begin conversation automatically; if the player misses the episode, after its defined expiration time its completion rule can do stuf. 

This proves useful in other ways: we have Progue call out a reminder to the player about future appointments when conversations end, for example.]

Table of Progue's Appointment Book
date		event
an interval	an episode
with 2 blank rows.

To decide whether Progue has free time:
	if the number of blank rows in Table of Progue's Appointment Book > 0, yes;
	no. 

To decide whether Progue has pending appointments:
	repeat through Table of Progue's Appointment Book begin;
		let moment be date entry;
		if ( current interval is moment or the interval before current interval is moment ) and the episodic status of event entry is unaired, decide yes;
	end repeat;
	decide no.

To decide whether Progue is booked for (int - an interval):
	if there is a date of int in Table of Progue's Appointment Book, yes;
	no.

To decide whether Progue is booked for (ev - an episode):
	if there is an event of ev in Table of Progue's Appointment Book, yes;
	no.

To schedule Progue for (ev - an episode) at (int - an interval):
	if the number of blank rows in Table of Progue's Appointment Book > 0 begin;
		choose a blank row in Table of Progue's Appointment Book;
		now date entry is int;
		now event entry is ev;
		if Progue is being debugged, say "// Progue: scheduled [ev] for [int].";
	otherwise;
		if Progue is being debugged, say "// Progue ERROR: could not schedule [ev] for [int] because appointment book is full.";
	end if.

Every turn when the number of filled rows in Table of Progue's Appointment Book > 0 (this is the check Progue's appointment book rule):
	if Progue is being debugged, say "// Progue: checking appointment book.";
	if there is a date of current interval in Table of Progue's Appointment Book begin;
		choose row with a date of current interval in Table of Progue's Appointment Book;
		begin event entry;
		blank out the whole row;
	end if.

To unbook Progue for (ev - an episode):
	choose row with an event of ev in Table of Progue's Appointment Book;
	blank out the whole row.

Chapter - Beach Cleanliness Subplot

[ The cleanliness of the beach is sort of a metaphor for the blank slate of Progue's mind when the player first meets him. As more and more memories come back, the beach becomes progressively dirtier and dirtier. Below are defined mechanisms to simulate this, describe it, and allow the player to help Progue keep it clean. ]

Cleanliness is a kind of value. The cleanlinesses are spotless, flecked, marred, and strewn. South Beach has a cleanliness. The cleanliness of South Beach is spotless. North Beach has a cleanliness. The cleanliness of North Beach is spotless. Center Beach has a cleanliness. The cleanliness of Center Beach is spotless. Lower Beach has a cleanliness. The cleanliness of Lower Beach is spotless.

To cleanify the beach in (spot - a room):
	unless the cleanliness of spot is spotless, now the cleanliness of spot is the cleanliness before the cleanliness of spot.

To dirtify the beach in (spot - a room) to a worst of (level - a cleanliness):
	unless the cleanliness of spot >= level, now the cleanliness of spot is the cleanliness after the cleanliness of spot.

Every turn when time-to-adjust-filth is false and falling downtide (this is the dirty the beach rule):
	now time-to-adjust-filth is true;
	if the psyche of Progue is ignorance or the psyche of Progue is denial:
		let clean-level be spotless;
	otherwise if the psyche of Progue is fear or the psyche of Progue is suppression:
		let clean-level be flecked;
	otherwise if the psyche of Progue is uncertainty:
		let clean-level be marred;
	otherwise:
		let clean-level be strewn;
	dirtify the beach in South Beach to a worst of clean-level;
	dirtify the beach in Center Beach to a worst of clean-level;
	dirtify the beach in North Beach to a worst of clean-level.

Every turn when not falling downtide and time-to-adjust-filth is true:
	now time-to-adjust-filth is false;
	now tired-of-cleaning is 0.

time-to-adjust-filth is a truth state that varies. tired-of-cleaning is a number that varies.

Beach-cleaning is an action applying to one thing. Understand "clean [something]" as beach-cleaning. Check beach-cleaning: say "You brush away some of the dirt and grime, but don't reveal any new details." instead.

Instead of beach-cleaning the nearby beach:
	if Progue is attentive and Progue is enclosed by location, say "Not while you're in the middle of talking to [the Progue]." instead;
	if location is not regionally in Beachfront, say "The terrain here is too complex to effectively clean." instead;
	if tired-of-cleaning > 4, say "Your back and hands are killing you-- you will collapse if you try to do any more cleaning right now." instead;
	[if something dramatic is up, say "Now's not a good time for that." instead;]
	increase tired-of-cleaning by 1;
	pass 68 minutes of time;
	say "Working systematically, you scour the beach for impurities. After an hour or so of backbreaking work you have [if cleanliness of location is spotless]found only a handful of material to cast in the ocean; the beach looks more or less as flawless and pristine as it did when you started[otherwise if cleanliness of location is flecked]restored it to a spotless expanse of nothing but smooth, white sand[otherwise if cleanliness of location is marred]removed all the major pieces of debris, leaving only the odd fleck of seaweed or shell to mar its white surface[otherwise]gotten rid of the largest and ugliest pieces of seaweed, but the beach is still strewn with countless smaller leaves, sticks, shells, and other debris[end if].";
	cleanify the beach in location;
	if Progue is enclosed by location:
		say "[one of]'Good work,' [the Progue] says, nodding in satisfaction. 'I do like a clean beach.'[pclikesmore][or]'Excellent! Fantastic!' [the Progue] says. 'Keep it up!'[pcmaybelikesmore][stopping]".

To say pclikesmore: Progue likes you more, silently. To say pcmaybelikesmore: if a random chance of 1 in 3 succeeds, Progue likes you more.

Part - Episodes

Every episode has some text called the summary. The summary of an episode is usually "". Definition: an episode is verbosely described: if its summary is not "", yes; no. [ We use this to allow Progue to refer to past episodes, a trick we use once or twice.]

To decide whether an unimportant episode is playing: if current episode is Denial Dislike Convo or current episode is Denial Animus Convo or current episode is Denial General Convo or current episode is Denial Interrupted or current episode is Suppression Dislike Convo or current episode is Suppression Animus Convo or current episode is Suppression General Convo or current episode is Uncertainty General Convo, decide yes; decide no. [ Progue can make a reference in certain greeting beats to the last episode that happened, but for this to work, we want to exclude the regular conversation episodes that aren't unique.]

A condition for an episode (this is the episodes only happen on Lacuna rule):
	if Exploring Lacuna is not happening:
		if drama manager is being debugged, say "failed the episodes only happen on Lacuna rule.";
		rule fails.

A commencement rule for an episode (this is the allow episodes to interrupt landmark-going on commencement rule):
	if we-are-landmark-going is true:
		tidy landmark-go;
		clean up landmark-go.

A finishing rule for an episode (this is the allow episodes to interrupt landmark-going on finishing rule):
	if we-are-landmark-going is true and Progue is enclosed by location and Progue is attentive:
		tidy landmark-go;
		clean up landmark-go;
	decide no.

A finishing rule for an episode (this is the episodes usually end when conversation does rule):
	if icebreaker of current episode is not silence and icebreaker of current episode is spoken and Progue is idle, rule succeeds.


When play begins: now episode schedule is Table of Ignorance Episodes.

Table of Ignorance Episodes
eptitle
an episode

Word Day is a guaranteed triggered instant rendezvous episode. [ The rest defined in Denial.]

Section - Serendipitous

A condition rule for a serendipitous episode (this is the Progue must be present to begin episodes rule):
	if Progue is not enclosed by location:
		if drama manager is being debugged, say "failed the Progue must be present to begin episodes rule.";
		 rule fails.

A condition rule for a serendipitous episode (this is the Progue must be awake to begin episodes rule):
	if the animus of Progue is resting:
		if drama manager is being debugged, say "failed the Progue must be awake to begin episodes rule.";
		rule fails.

A condition rule for a serendipitous episode (this is the episodes can't begin when something dramatic is up rule):
	if something dramatic is up:
		if drama manager is being debugged, say "failed the episodes can't begin when something dramatic is up rule.";
		rule fails.

A condition rule for a serendipitous episode (this is the episodes can't begin immediately after conversation ends rule):
	if conversation fuse < 3:
		if drama manager is being debugged, say "failed the episodes can't begin immediately after conversation ends rule.";
		rule fails.

A condition rule for a serendipitous episode (this is the Progue is chattier the more he likes you rule):
	let odds be 8 - the affinity of Progue;
	if a random chance of 3 in odds succeeds begin;
	otherwise;
		if drama manager is being debugged, say "failed the Progue is chattier the more he likes you rule.";
		rule fails;
	end if.	

A condition rule for a serendipitous episode (this is the Progue doesn't like to be interrupted rule):
	if Progue is wishing:
		if drama manager is being debugged, say "failed the Progue doesn't like to be interrupted rule";
		rule fails.

A condition rule for a serendipitous episode (this is the episodes can't happen while Progue is swimming rule):
	if the animus of Progue is swimming:
		if drama manager is being debugged, say "failed the episodes can't happen while Progue is swimming rule.";
		rule fails.

First completion rule for a serendipitous episode (this is the Progue's life goes on after serendipitous episodes rule):
	Progue's life goes on, as before.



Section - Rendezvous

First condition rule for a rendezvous episode: abide by the Progue must be awake to begin episodes rule.

First condition rule for a rendezvous episode: abide by the episodes can't begin when something dramatic is up rule.

First condition rule for a rendezvous episode: abide by the episodes can't begin immediately after conversation ends rule.

Every turn when a current episode is rendezvous (this is the Progue heads towards meeting place in rendezvous episodes rule):[aar]
	if location of Progue is not meeting place of current episode and Progue is idle and meeting place of current episode is not UnRoom:
		if Progue is being debugged, say "// Progue: impelling Progue to meeting place of current episode ([meeting place of current episode]).";
		impel Progue to meeting place of current episode.

The Progue heads towards meeting place in rendezvous episodes rule is listed before the trigger Progue's motivation rule in the every turn rules.

Section - Urgent

First commencement rule for an urgent episode (this is the Progue starts player-seeking when urgent episodes begin rule):
	Progue starts player-seeking.

Section - Instant

First commencement rule for an instant episode (this is the teleport Progue to mark rule):
	unless meeting place of current episode is UnRoom or location of Progue is meeting place of current episode:
		summon Progue to meeting place of current episode.

Last completion rule for an instant episode (this is the Progue needs something new after instants rule):
	if the animus of Progue is player-seeking, now Progue is wishing.


Section - Misc

The Progue begins episode dialogue rule is listed after the check episodes rule in the every turn rules. Every turn (this is the Progue begins episode dialogue rule):
	if drama manager is being debugged, say "// Drama manager (Progue begins episode dialogue rule): [if an episode is playing]an episode is playing ([current episode])[else]no episode[end if] and [if Progue is enclosed by location]Progue is enclosed by location[else]no progue[end if] and [if Progue is idle]Progue is idle[else]Progue is attentive[end if] and [if conversation fuse > 2]conversation fuse > 2[else]conversation fuse <= 2[end if].";
	if an episode is playing and Progue is enclosed by location and Progue is idle and conversation fuse > 2:
		unless icebreaker of current episode is silence or ( icebreaker of current episode is spoken and icebreaker of current episode is unrepeatable and nothing replaces icebreaker of current episode ) :
			pre-conversation processing;
			force discuss icebreaker of current episode;
			follow the conversation bookkeeping rule.[ this line added 12/18 because insistent beats on first move on convo weren't properly removing other answers.]

After greeting Progue when no episode is playing (this is the find something to talk about rule): 
	if drama manager is being debugged, say "// Drama manager: find something to talk about.";
	now conversation fuse is 3; [ Since otherwise all episodes would fail.]
	now Progue is idle; [ ditto]
	let looper be 1;
	while looper is at most 5 and no episode is playing:
		if drama manager is being debugged, say "// Drama manager: about to follow check episodes rule (loop [looper]).";
		follow the check episodes rule;
		increase looper by 1;
	now Progue is attentive;
	if an episode is playing:
		unless conversation fuse is 0: [ if we already said something when the episode began, we don't need to say anything now.]
			if drama manager is being debugged, say "// Drama manager: an episode is playing, so follow Progue begins episode dialogue rule.";
			now Progue is idle; [ one of the conditions for the below rule.]
			follow the Progue begins episode dialogue rule;
	else:
		if drama manager is being debugged, say "// Drama manager: no episode found, so force discuss conversation_beat of Progue ([conversation_beat of Progue]).";
		force discuss the conversation_beat of Progue.




Part - Progue's Reactions

Chapter - Conversation Tools


To say progue-time-of-day:
	if dawn or sunrise or morning or midmorning begin; say "morning";
	otherwise if midday; say "day";
	otherwise if afternoon; say "afternoon";
	otherwise if evening or sunset or twilight; say "evening";
	otherwise; say "night";
	end if. 
	
[ Progue develops a pet name for the player over time. This should be consistent as long as no emotion values change before printing it again.]

To say animal-nickname:
	if ( romance of Progue > 1 or paternalism of Progue > 2 or submission of Progue < -2 ) , say "little ";
	if player is male:
		if submission of Progue > 2 and romance of Progue > 1:
			say "stallion";
		if submission of Progue > 4:
			say "tiger";
		otherwise if submission of Progue > 2:
			say "boar";
		otherwise if submission of Progue < -2:
			say "rabbit";
		otherwise if paternalism of Progue > 4:
			say "tomcat";
		otherwise if affinity of Progue > 2:
			say "rooster";
		otherwise if affinity of Progue < -2:
			say "wolf";
		otherwise:
			say "gander";
	otherwise:
		if submission of Progue > 2 and romance of Progue > 1:
			say "vixen";
		otherwise if submission of Progue > 3:
			say "tigress";
		otherwise if submission of Progue < -2:
			say "bunny";
		otherwise if affinity of Progue > 2:
			say "kitten";
		otherwise if affinity of Progue < -4:
			say "sow";
		otherwise if affinity of Progue < -1:
			say "hen";
		otherwise:
			say "duckling".



Chapter - Summon Progue

[ This is used to bypass the normal movement rules and have Progue instantly appear somewhere. ]
To summon Progue to (place - a room):
	if Progue is being debugged, say "// Progue: summoning Progue to [place].";
	now Progue is in place;
	now Progue is attentive;
	now Progue is fulfilling;
	now the prior animus of Progue is the animus of Progue;
	Progue starts loitering. [The point is it has to be something else, because otherwise Progue might be described swimming or something that makes no sense at his new location.] 

[ This is used to give Progue a new activity, and ensure he begins carrying it out.  ]
To Progue starts (activity - an endeavour):
	if Progue is being debugged, say "// Progue: Progue starts [activity].";
	now the next animus of Progue is activity; 
	pick a new activity for Progue.

[ This is used to move Progue to a certain room, usually to trigger a certain scene if the player discovers him there. ]
To impel Progue to (place - a room):
	if Progue is being debugged, say "// Progue: impelled to [place].";
	now progue-venue is place;
	Progue starts ruminating.

First before greeting Progue when we-are-landmark-going is true (this is the stop landmark-going when Progue speaks rule):
	tidy landmark-go;
	clean up landmark-go;
	continue the action.

Whistling is an action applying to nothing. Understand "whistle" or "yell" or "shout" or "scream" or "make noise" or "make some noise" as whistling.

Carry out whistling:
	let atd be indexed text;
	let atd be the player's command;
	if atd matches the text "shout" or atd matches the text "yell", say "You shout at the top of your lungs.";
	if atd matches the text "scream", say "You scream at the top of your lungs.";
	if atd matches the text "whistle" or atd matches the text "noise", say "You let out a loud, piercing whistle.";	
	if Progue is enclosed by location, say "[The Progue] gives you an annoyed glance. 'Sausages, there's no need for that,' he says, 'I'm standing right here.'";
	if ( the psyche of Progue is denial or the psyche of Progue is suppression or the psyche of Progue is uncertainty ) and nothing dramatic is up and the animus of Progue is not resting and exploring Progue's turf and a random chance of 4 in 5 succeeds, begin Summoning Progue.


Summoning Progue is a rerunnable guaranteed triggered urgent episode.  The expiration date is 40 minutes. The subchange beat is silence. The boredom beat is silence. The bye beat is silence. The abruptbye beat is silence.

A commencement rule for Summoning Progue:
	if the location of Progue is Proguevisible, say "[line break][inthedistance], [the Progue] looks in your direction.";
	now the icebreaker of Summoning Progue is the summon_beat of Progue.

A completion rule for Summoning Progue:
	now the summon_beat of Progue is unspoken;
	Progue's life goes on.

[ We actually want to forget what Progue was doing before, since we might have pulled him out of its natural environment, and the message describing him finishing it would be inappropriate.]





Section - Conversation

[ 	As we move around the island, we make note of certain things we may want to talk to Progue about. This can happen automatically or manually.]

After going when location is regionally in Lacuna (this is the noting referencable things rule):
	truncate the list of convo stuff to the last 12 entries;
	repeat with candidate running through things enclosed by location:
		repeat with subcandidate running through beats referenced by candidate:
			if subcandidate is unspoken or subcandidate is repeatable or something replaces subcandidate, manually reference subcandidate;
	continue the action.

To manually reference (subj - a thing):
	if subj is not a beat, now subj is a random thing referenced by subj;
	if subj is in current_thread of Progue:
		if subj is not listed in list of convo stuff, add subj at entry 1 in list of convo stuff;
		if conversation is being debugged, say "// Conversation: noting that [subj] is referenced by something nearby-- list now [list of convo stuff].".


Section - Misc

Instead of taking Progue (this is the hug not take Progue rule): try hugging Progue.





Chapter - Stock Behavior



To Progue's life goes on, as before:
	if Progue is being debugged, say "// Progue: Progue's life goes on[if as before], as before[end if].";
	if Progue is attentive, post-conversation processing; [ if we use saying farewell it might conflict with a scene's outtro.]
	if as before and the animus of Progue is not loitering and the animus of Progue is not player-seeking begin;
	otherwise;
		if Progue is not wishing, pick a new activity for Progue; 
	end if. 

Carry out exhausting when Progue is in the location:
	if Progue is being debugged, say "// Progue: exhausting.";
	annoy Progue;
	if the disposition of Progue <= -8 begin;
		force discuss the overexhaust_beat of Progue;		
	otherwise;
		force discuss the exhaust_beat of Progue;	
	end if;
	stop the action.

[ As Progue moves through the different psyches, his stock behavior changes. Each of the following beats can be changed for the different psyches.]

Progue has a thread called current_thread. [ The thread that all the general conversation topics for each psyche go into.]
Progue has a beat called dontlike_beat. [ If we've annoyed Progue too much, he rejects attempts to start a conversation.]
Progue has a beat called exhaust_beat. [ If we try to discuss something we've previously discussed that's no longer available.)]
Progue has a beat called overexhaust_beat. [ If Progue is temporarily annoyed with the player and ends the conversation. ]
Progue has a beat called bored_beat. [ If the player stops talking.]
Progue has a beat called naughttosay_beat. [ this is used if the player tries to change the subject when there is nothing to change it to.]
Progue has a beat called noanswer_beat. [ If the player does not answer an insistent beat.]
Progue has a beat called angryending_beat. [ If the player still does not answer an insistent beat.]
Progue has a beat called randomyes_beat. [ If the player says yes with no provocation. (Candidate for deletion?)]
Progue has a beat called randomno_beat. [ see above]
Progue has a beat called abruptbye_beat. [ If the player leaves without saying goodbye.]
Progue has a beat called rudebye_beat. [ If the player leaves without saying goodbye, after an insistent beat.]
Progue has a beat called bye_beat. [ Response to bye.]
Progue has a beat called redundantbye_beat. [ If the player says bye while not talking to Progue. ]
Progue has a beat called disgusted_beat. [ If Progue is actually angry with the player and decides to leave.]
Progue has a beat called redundanthi_beat. [ If the player says hi while already talking to Progue.]
Progue has a beat called nudity_beat. [ If the player gets naked.]
Progue has a beat called wakeup_beat. [ If the player wakes him up.]
Progue has a beat called summon_beat. [ If the player calls for him.]
Progue has a beat called the conversation_beat. [ For general chit-chat. ]

Instead of greeting Progue when Progue is enclosed by the location:
	if Progue is attentive begin;
		force discuss redundanthi_beat of Progue;
	otherwise if the disposition of Progue <= -6;
		annoy Progue;
		force discuss dontlike_beat of Progue;
	otherwise;
		continue the action;
	end if.

To decide whether Progue can be glib: if the animus of Progue is not resting and the psyche of Progue is not emotional and the psyche of Progue is not fugue and the psyche of Progue is not resolved and current episode is not Water Works, decide yes.

The bye bye Proguie rule is listed last in the instead rules. Instead of saying farewell to Progue when Progue is enclosed by location (this is the bye bye Proguie rule):
	if the animus of Progue is resting and Progue is idle, say "He's asleep." instead;
	if last beat is insistent begin; force discuss the abruptbye_beat of Progue;
	otherwise if Progue is attentive; force discuss the bye_beat of Progue;
	otherwise; force discuss the redundantbye_beat of Progue;
	end if;
	if Progue is attentive, continue the action.

Report saying farewell to Progue: do nothing instead. [ We've already taken care of this earlier. ]

First before getting bored when Finishing-The-Prologue is complete and Progue is enclosed by location:
	if ( the psyche of Progue is denial or the psyche of Progue is suppression ) and an unimportant episode is playing and a random chance of 1 in 3 succeeds:
		force discuss conversation_beat of Progue;
		stop the action. 

Carry out getting bored when Progue is in the location:
	if Progue is being debugged, say "// Progue: getting bored.";
	force discuss the bored_beat of Progue;
	annoy Progue;
	stop the action.

Every turn when Progue is enclosed by location and Progue is attentive and the disposition of Progue < -9 (this is the Progue only takes so much abuse rule):
	if Progue is being debugged, say "// Progue: only takes so much abuse rule (because Progue is in location and the disposition of Progue < -10 ([disposition of Progue]).";
	if a random chance of 1 in 2 succeeds, Progue likes you less;
	force discuss the overexhaust_beat of Progue.

Every turn when Progue is enclosed by location and conversation fuse is at least 3 and player is not wearing homemade outfit and Progue can be glib (this is the Progue notices nudity rule):
	if Progue is being debugged, say "// Progue: notices nudity (because Progue is enclosed by location ([location]) and conversation fuse is at least 3 ([conversation fuse]) and player is not wearing homemade outfit).";
	force discuss the nudity_beat of Progue. 

The Progue can't stand to be near you rule is listed before the Progue only takes so much abuse rule in the every turn rulebook. Every turn when Progue is enclosed by location and Progue can be glib and ( the disposition of Progue < -12 or the affinity of Progue < -4 ) (this is the Progue can't stand to be near you rule):
	if Progue is being debugged, say "// Progue: can't stand to be near you rule (because Progue is in location and disposition < -13 ([disposition of Progue]) or affinity < -7 ([affinity of Progue]).";
	force discuss the disgusted_beat of Progue;
	Progue's life goes on;
	follow the Progue's motivation rule.

Instead of saying farewell to Progue when Progue is attentive and last beat is insistent (this is the Progue won't let you escape insistent beats rule):
	extend beats;
	force discuss rudebye_beat of Progue;
	annoy Progue.

After going when Progue is enclosed by former location and Progue is attentive (this is the Progue reacts to sudden departure rule):
	if Progue is being debugged, say "// Progue: reacts to sudden departure rule (because After going and Progue is enclosed by former location and Progue is attentive).";
	if last beat is insistent begin;
		if Progue is annoyed begin;
			force discuss the angryending_beat of Progue;
		otherwise;
			annoy Progue;
			force discuss the rudebye_beat of Progue;
			move Progue to the room noun from location of Progue;
			if Progue is enclosed by location begin;
				now conversation fuse is 1;
				say "[The Progue] follows you.";
			otherwise;
				say "You leave [the Progue] behind.";
				Progue's life goes on;
			end if;
		end if;
	otherwise;
		force discuss the abruptbye_beat of Progue;
		Progue's life goes on, as before;
	end if;
	continue the action.

Instead of saying yes:
	if Progue is enclosed by location and Progue is attentive begin;
		if the animus of Progue is resting, say "There's no one (awake) here to say that to." instead;
		force discuss the randomyes_beat of Progue;
	otherwise if a conversing person is enclosed by the location;
		say "There is no response.";
	otherwise;
		speak as the parser "You're not talking to anyone.";
	end if.

Instead of saying no:
	if Progue is enclosed by location and Progue is attentive begin;
		if the animus of Progue is resting, say "There's no one (awake) here to say that to." instead;
		force discuss the randomno_beat of Progue;
	otherwise if a conversing person is enclosed by the location;
		say "There is no response.";
	otherwise;
		speak as the parser "You're not talking to anyone.";
	end if.

Instead of waking, pushing, touching, or attacking Progue when the animus of Progue is resting (this is the waking up Progue rule):
	if Progue is being debugged, say "// Progue: waking up Progue rule.";
	pre-conversation processing;
	annoy Progue;
	force discuss wakeup_beat of Progue.

Instead of greeting Progue when the animus of Progue is resting and Progue is fulfilling: say "[The Progue] snores, but does not otherwise respond.". 



	


Part - Fast Forwarding

A fast-forward rule for Meeting-Progue:
	now Progue is awake;
	now the psyche of Progue is denial;
	now Word Day is successful;
	now current episode is no-episode;
	now the episode schedule is Table of Denial Episodes;
	now spotted-Progue is true;
	now met_Progue is true;
	now unavailable-beat of Progue is pd_unavailable;
	Progue's life goes on.

A fast-forward rule for The-Mysterious-Door:
	now current episode is no-episode;
	now the psyche of Progue is denial.

A fast-forward rule for Getting-To-The-Lawn:
	now current episode is no-episode;
	now the psyche of Progue is fear.

A fast-forward rule for Finding-The-Egg:
	now current episode is no-episode;
	now the psyche of Progue is suppression;
	now the episodic status of Crack Coaxing is completed;
	now the episodic status of Building To Revelations is completed;
	now the episodic status of Suppression Revelations is completed;
	now Progue references depc_departure;
	choose a blank row in Table of Progue Suppression Endeavours;
	change pick entry to cleaning;
	Progue's life goes on.

A fast-forward rule for Powering-Both-Devices:
	now the psyche of Progue is uncertainty;
	now the episodic status of The Conch Portends is completed;
	now the episodic status of Earthquake is completed;
	now the episodic status of Water Works is completed;
	now the episodic status of Post-Storm Conversation is completed.

A fast-forward rule for Opening-The-Pyramid:
	now the psyche of Progue is emotional;
	summon Progue to Hut;
	now the animus of Progue is resting;
	now Progue is fulfilling;
	now the episodic status of Rayfish Suicide is completed.

A fast-forward rule for Contacting-All-The-Trees:
	now the psyche of Progue is fugue;
	remove Progue from play;
	now Word Day is successful;
	now current episode is no-episode;
	now spotted-Progue is true;
	now met_Progue is true.

Completing-Progue's-Character-Arc requires Finishing-Confrontation.

Finishing-Confrontation is a task. Definition: Finishing-Confrontation is complete: if Epilogue is happening, yes; no.

A fast-forward rule for Completing-Progue's-Character-Arc:
	now the psyche of Progue is resolved;
	now ep-trigger is true.


Book - Progue in Denial (in Lacuna-Progue-Denial by Blue Lacuna)

[Progue has forgotten much, due to both his own pain and the somenium. He refers to his daughters lightly as "those two little girls" who used to live here, but doesn't remember what happened to them. Mentions of "wayfaring" etc produce only laughter--- "what rot!" He says he's lived here a long time, doesn't remember how long, doesn't want to. He cheerfully agrees that he built the door, treehouse, etc., but doesn't know anything about how they work (except for perhaps some cryptic clues.) He doesn't remember the trees at all, although he will never go to that part of the island. He is always on the lookout for "The Creeper," some force which he says lurks on the east island and pounces on you when you least expect it, causing terrible pain. (really a representation of his fear of remembering his pain.)]

Table of Ignorance Episodes (continued)
eptitle
Word Day
Discovering the Open Door

Table of Denial Episodes
eptitle
Delayed Greeting
Sleepless Rayfish Encounter
Denial Dislike Convo
Denial Animus Convo
Denial General Convo
Denial Interrupted
Just Teasing
Rainfall Rhapsody
Backseat Dooring
Discovering the Open Door
Play Catch
Ring of Truth
Make-Way
Hey That's Mine
Art Critic

[Older And Wiser]

An episode can be denialy. An episode is usually not denialy.

First condition for a denialy episode:
	if Word Day is not successful and Delayed Greeting is not successful, rule fails. [We want to make sure that we've gotten the greeting scene somehow before we allow anything else to start happening.]

DenialC is a thread. The current_thread of Progue is DenialC. The escape clause of DenialC is pd_bye.

Section - Standard Behavior

The wakeup_beat of Progue is pd_wakeup. pd_wakeup is a repeatable beat in DenialC with reaction "[The Progue] opens one eye warily, then reluctantly hoists the other wide and clambers to his feet with a throng of creaks, groans and sighs.[paragraph break]'Can't even get a moment's sleep?' he says grumpily[if a random chance of 1 in 2 succeeds], [attitude-business][end if]. 'Oh well oh, what do you want then?'". pd_wakeup enqueues denial keywords.

The exhaust_beat of Progue is pd_exhausted. pd_exhausted is a repeatable beat in DenialC with reaction "[pdexhaust]". To say pdexhaust: say "[one of]'Oh, let's not talk about that any more,' [the Progue] says[or]'I haven't much else to say about that,' [the Progue] says lightly[or]'Oh, but we've been over all that already,' [the Progue] says with a sigh[or]'It's not something I care to discuss any more, to be perfectly honest,' he says[or]'Enough about that when there are so many other delicious things to talk about!' he says[in random order][if a random chance of 1 in 2 succeeds], [animus-business][end if].".

The overexhaust_beat of Progue is pd_overexhausted. pd_overexhausted is a repeatable terminal beat in DenialC with reaction "'[one of]I've had enough chatter-chat for now,[or]Look, I'm not used to talking so much,[or]Look, [animal-nickname], can we mayhaps just stop the talking for a while?[in random order]' [the Progue] says[if a random chance of 1 in 2 succeeds], [attitude-business][end if]. '[one of]Jump off for a while, won't you? Eh?[or]Come back later maybe. Maybe later.[or]I can't hear myself think, not that usually I can, but the point's the point.[in random order]' [Progue-resumes].". After discussing pd_overexhausted: Progue's life goes on, as before.

The dontlike_beat of Progue is pd_dontlike. pd_dontlike is a repeatable beat in DenialC with reaction "'[one of]Buzz off[or]Get lost[or]Moisty hells[or]Not now[in random order],' [the Progue] says[one of], looking extremely annoyed[or] impatiently[or] with an exhausted expression[in random order]. '[one of]I need some me time[or]Go find someone else to pester for a while[or]I'm tired of your babbling[or]You're giving me a splitting headache[or]You're climbing up my nerves[in random order].'".

The bored_beat of Progue is pd_bored. pd_bored is a repeatable terminal beat in DenialC with reaction "'[one of]Well, if you don't mind,[or]If it's all the same to you,[or]Pardon me, but[or]Please excuse me, but[in random order] [one of]I'm going to get back to this[or]there's only so many hours in the day[or]I've got such a lot to do[or]duty calls[or]I really ought to get back to this[in random order][pgb1b].". To say pgb1b: say ",' [the Progue] says, [one of][animus-business][or][attitude-business][purely at random]. '[pgb2][pdb-2]". To say pgb2: say "[one of]See you around[or]Take care[or]Enjoy the [progue-time-of-day][or]Good [progue-time-of-day][or]We'll talk again later[or]See you later[or]So long[or]Watch out for the Creeper[in random order]". To say pdb-2: say "!' [Progue-resumes]".

The unavailable-beat of Progue is pd_unavailable. pd_unavailable is a repeatable ephemeral beat in DenialC. The reaction is "[if last beat is insistent][uad-insis][otherwise][pdexhaust][end if]". To say uad-insis: say "[one of]'Not now, not now,' he says in annoyance, 'I'm asking you a question.'[or]'Wait a ment,' [the Progue] says, 'we're in the middle of something here.'[or]'I'll have none of that,' [the Progue] says, 'until you've answered my question.'[or]'No, no, no,' [the Progue] says, 'that isn't how conversation works at all. I ask you a question, then you answer it. Then you ask another question.'[or]'Later,' [the Progue] says, waving a hand in annoyance, 'I'm interested in this.'[in random order]". After discussing pd_unavailable: annoy Progue; if penultimate beat suggests a beat (called subj) begin; force discuss subj; continue the action; end if.

The naughttosay_beat of Progue is pd_naughttosay. pd_naughttosay is a repeatable terminal beat in DenialC with fuse 9999 and reaction "'[one of]Really, I can't think of a thing to talk about just now[or]For life and strife, I don't know what else we could discuss right now[or]Terrible sorries, but I ratherly think I need a rest from all this discussion and conversion[or]What else is there to talk about? I'm bats at noon[or]Oh well oh, this conversation's thoroughfully lost its momentum[in random order],' he says, [animus-business]. '[one of]We'll talk again soon[or]Let's take a rest for now[or]We'll chat again before too much longering[in random order]. [pgb2]!'".

[[one of]'Don't change the subject,' he snaps.[or]'We weren't talking about that,' he responds testily, crossing his arms. 'I'm not senile, well, at least not at the moment.'[or]'Eh?' he says.[in random order]]

The noanswer_beat of Progue is pd_noanswer. pd_noanswer is a repeatable dogged beat in DenialC. The reaction is "He crosses his arms. 'Well?' he barks, annoyance creeping into his voice. 'Are you mute? Dumb? By choice or chance? I've had enough one-sided conversations for a lifetime already so this isn't endearing. Say [t]something[x]!'". pd_noanswer suggests pd_angryending. pd_noanswer summons p_smartass. [  [or]He taps his foot impatiently. 'Reticence, reticence,' he mutters, 'is not a virtue in conversation. Your answer, please!' [or]He folds his arms and sets a grim, steely gaze on you, obviously still waiting for your answer.[stopping]  ] Instead of discussing pd_noanswer when actual last beat is pd_noanswer, try getting bored Progue. After discussing pd_noanswer: now bp_alphamale suggests bp_friendsmaybe; continue the action.

Understand "something/answer" as p_smartass. p_smartass is a dogged beat in DenialC with fuse 2 and keyword name "something" and reaction "'Cute,' he says, 'cheeky. Smarmy even. Ordinarily I'd be amused, but I'm still waiting for your answer.'".

The angryending_beat of Progue is pd_angryending. pd_angryending is a terminal unaffinitive beat in DenialC. The reaction is "He makes an indignant noise in his throat. 'Moisty hells,' he says with a dismissive wave of the hand, and marches off across the [surface-material]." After discussing pd_angryending: Progue's life goes on.

The randomyes_beat of Progue is pd_randomyes. pd_randomyes is a repeatable dogged beat in DenialC with reaction  "[PDenialYesFirstHalf][if a random chance of 1 in 2 succeeds]I don't recall doing so. I may have done[otherwise]Can't remember[end if]. [if a random chance of 1 in 2 succeeds]Mayhaps[otherwise]Could be, I suppose[end if]. I've forgotten it, though. [if a random chance of 1 in 2 succeeds]Let's change the subject, shall we?'[otherwise]Doesn't matter.'[end if]". To say PDenialYesFirstHalf: say "'Yes[if a random chance of 1 in 2 succeeds]? Yes?' [otherwise]?' [end if]He [if a random chance of 1 in 2 succeeds]furrows his brows[otherwise]crosses his arms[end if]. [yes2bit]". To say yes2bit: say "'[if a random chance of 1 in 2 succeeds]Yes what? [end if][if a random chance of 1 in 2 succeeds]Did I ask a question with a yes or no answer[otherwise]Was there a question asked that required you to say yes[end if]? ". 

The randomno_beat of Progue is pd_randomno. pd_randomno is an repeatable dogged beat in DenialC with reaction "'No? No what?' [the Progue] asks, scratching his head.".

[The question_beat of Progue is pd_question. pd_question is an ephemeral repeatable beat in DenialC. The reaction is "[one of]'Yes, the question I just asked you,' he snaps in annoyance. 'Have you forgotten already? Can't say I care much for your memory.' [or]'Are you even listening to what I'm saying?' he shouts angrily. 'Pay attention, won't you?' [or]'Oh, this is tiresome,' he says with a sigh. [stopping]". pd_question suggests pd_avoidingq.]

pd_avoidingq is a repeatable beat in DenialC. The reaction is "'Don't try and change the subject,' he says, 'I'm not so easily distracted. Your answer, please.'". pd_avoidingq suggests pd_angryending.


The rudebye_beat of Progue is pd_rudebye. pd_rudebye is a  repeatable ephemeral beat in DenialC with reaction "'Excuse me,' [the Progue] says haughtily. 'We're middling in conversation just now.'". 

The abruptbye_beat of Progue is pd_abruptbye. pd_abruptbye is a beat in DenialC with reaction "'Oh well oh, so long, then,' [the Progue] says in surprise as you turn to go.". pd_abruptbye2 replaces pd_abruptbye. pd_abruptbye2 is an beat in DenialC with reaction "'You know, that's trickling rude!' [the Progue] shouts after you. 'Where I come from we say [']goodbye['] to people before we wander off!'". pd_abruptbye3 replaces pd_abruptbye2. pd_abruptbye3 is an unaffinitive submissive beat in DenialC with reaction "'Good riddance then!' [the Progue] shouts furiously to your retreating back. 'Good [if evening]evening[otherwise if night]night[otherwise if morning or sunrise]morning[otherwise]day[end if] to you, [if player is male]sir[otherwise]madam[end if], and,' he adds, building up steam as the distance increases, 'I hope you enjoy stimulating conversations with the octopi and konokuk trees,' he yells, 'since those are the only things you'll be having the privilege of---' The voice trails off as you get out of earshot.". pd_abruptbye4 replaces pd_abruptbye3. pd_abruptbye4 is a repeatable beat in DenialC with reaction "[one of]Sniffing[or]Wrinkling his nose in distaste[or]Yawning[in random order], [the Progue] looks [one of]disdainfully [or]angrily [or][in random order]away as you [one of]depart[or]leave[or]move away[in random order].".
		

The bye_beat of Progue is pd_bye. pd_bye is a repeatable beat in DenialC with reaction "'[pgb2][pdb-2].". 

The redundantbye_beat of Progue is pd_redundantbye. pd_redundantbye is a repeatable beat in DenialC with reaction "[one of]'We call that one [']hello['] where I come from,' [the Progue] says amiably, 'but whatever.'[or]'Uh, hello and goodbye then,' [the Progue] says in confusion.[or]'What?' [the Progue] says, looking around. 'Are you talking to me?'[cycling]". After discussing pd_redundantbye: annoy Progue; continue the action.

The redundanthi_beat of Progue is pd_redundanthi. pd_redundanthi is a repeatable ephemeral beat in DenialC with reaction "[one of]'Yes, hello,' [the Progue] says, blinking rapidly. 'Did I black out? What happened? How many minutes did I lose?'[or]'And hello and hello,' [the Progue] says with a bow.[in random order]". After discussing pd_redundanthi: annoy Progue; continue the action.

The disgusted_beat of Progue is pd_disgusted. pd_disgusted is a repeatable nonverbal beat in DenialC with reaction "[one of]'I can't take any more of this,' [the Progue] says in anger. 'So long.'[or]'This is gushing ridiculous,' [the Progue] snaps in anger, 'I'm leaving.'[or]'You're impossible,' [the Progue] says furiously. 'I shall take my madness elsewhere.'[in random order]".

Instead of pushing Progue when the psyche of Progue is denial, try hugging Progue. Instead of hugging Progue when the psyche of Progue is denial: if Progue is idle, pre-conversation processing; force discuss dc_hug.

dc_hug is an annoying dogged beat with reaction "You step forward, but [the Progue] jumps nervously back. 'No thank you,' he says, casting a wary eye on you. 'I'm not ready to be taken off to the land of the dead just yet, thank you very much. You just keep your distance, [dc_player].'". dc_hug2 replaces dc_hug. dc_hug2 is an annoying unaffinitive beat with reaction "You lunge at [the Progue] but he leaps backwards, crying out, then turns and flees over the [surface-material], shouting 'Leave me alone, evil spirit!'". After discussing dc_hug2: now dont_describe_Progue is true; Progue's life goes on; follow the Progue's motivation rule; continue the action. dc_hug3 replaces dc_hug2. dc_hug3 is a repeatable annoying unaffinitive beat with reaction "[The Progue] [one of]shrieks and tumbles backwards[or]dodges out of the way[at random], then twists and gallops off down the [surface-material], crying 'leave my soul alone!'". After discussing dc_hug3: now dont_describe_Progue is true; Progue's life goes on; follow the Progue's motivation rule; continue the action.

The nudity_beat of Progue is pd_nudity. pd_nudity is a romantic nonverbal beat in DenialC with reaction "[The Progue] notices your nudity and reddens. 'My oh my oh,' he says, 'this hallucination has certainly taken a turn for the interesting. Can't remember the last time I was visited by nude [if player is male]satyrs[otherwise]nymphs[end if].'". pd_nudity2 replaces pd_nudity. pd_nudity2 is a repeatable nonverbal beat in DenialC with reaction "'[one of]Mind you don't sunburn, [animal-nickname],' [the Progue] calls out, 'the tropical sun can be murder on rarefied skin.'[or]Still enjoying yourself, eh?' [the Progue] asks, eyeing your body deliberately.[or]Watch out for the giant mosquitos,' [the Progue] says with something you're almost but not quite sure is sarcasm, 'they can bite in the most inappropriate places.'[or]That's quite the tan you're developing there,' [the Progue] says, glancing at your naked skin. 'It's almost as if you're trying to impress a body.'[in random order]".

The summon_beat of Progue is pd_summon. pd_summon is a repeatable beat in DenialC with reaction "'[one of]Ah, there you are[or]I heard you call[in random order],' [the Progue] says. '[one of]What did you want[or]What do you need[or]What can I help you with[in random order]?'".

Section - Keywords


denial keywords is a repeatable beat. denial keywords summons dc_gesundheit, dc_creeper, dc_player, dc_girls, dc_name, dc_island, dc_cabin, dc_windsigh, learn_capalla_name, dc_food, dc_berries, dc_crabs, dc_konokuk, learn_rayfish_name, [dc_marsh, dc_frogs,] dc_sculpture, dc_waterfall, dc_ropeway, dc_sketchbook, dc_compass, dc_treehouse, dc_head, dc_paintings, dc_bridge, [dc_pyramid, ]dc_door1b.

Understand "painting/paintings" as dc_paintings when last beat is in DenialC. dc_paintings is a beat in DenialC with fuse 9999 and keyword name "paintings" and reaction "'Oh,' he says, brightening up considerably, 'those beautiful paintings in the cabin, yes? I remember them. No idea how they got there. Mayhaps the [dc_sculptor] was a painter alsowards. All a bit jumbled and confused,' he adds, twirling a finger haphazardly near his head.". Phoebe-canvas references dc_paintings. Check examining by name an artwork: if dc_paintings is available, try discussing dc_paintings instead.

[Understand "pyramid" as dc_pyramid when last beat is in DenialC. dc_pyramid is a repeatable beat in DenialC with fuse 9999 and keyword name "pyramid" and reaction "'[one of]Pyramids? Sausages,' he says, waving a hand dismissively. 'There certainly isn't anything like that around here. Claim to have seen one, do you? Well and I suppose it's only to be expected a hallucination would have middling hallucinations of [if player is male]his[otherwise]her[end if] own, and for each of them to have their own tiny hallucinationlets, and who knows what it is they dream about, who indeed.'[or]Ridiculous,' he says, 'there's no such thing.'[stopping][if distant-pyramid is very near location or distant-pyramid is near location or distant-pyramid is far from location or distant-pyramid is very far from location][paragraph break]You point out the distant pyramid, clearly visible atop the mountain, but he merely squints and then pats you consolingly on the back. 'Like knives, these eyes, though don't be embarrassed, not everyone is so blessed,' he says. 'No, friend, that's obviously just a large blurry boulder.'". distant-pyramid references dc_pyramid. Check examining by name distant-pyramid: if dc_pyramid is available, try discussing dc_pyramid instead.] [Sadly this bit doesn't jive with the Secrets quest.]

Understand "chasm/stairs" as dc_bridge when last beat is in DenialC. dc_bridge is a beat in DenialC with fuse 9999 and keyword name "chasm" and reaction "'Moisty sausages, I'd stay away from that part of the island, were I be you,' [the Progue] warns, [attitude-business]. 'Leave and believe, there's nothing interesting on the other side of that chasm anyway, and the [dc_creeper] lives to prowl for victims over therewards. Stay in the beach and on the marsh like I do! Only way to be safe.'". the bridge references dc_bridge.

Understand "waterfall/crystal/crystals/spring/pool" or "hidden pool" or "hot spring" or "hot springs" as dc_waterfall when last beat is in DenialC. dc_waterfall is a beat in DenialC with fuse 9999 and keyword name "waterfall" and reaction "'Ah yes,' he says, smiling fondly, 'lovely place for a soak. Where the [dc_sculptor] first found that gushing pretty blue crystal, too, that he made so many statues and figurines withwards. Now whatever did happen to all those I suppose?' He scratches his head.". the waterfall references dc_waterfall. Check going east when location is Rise: if dc_waterfall is available, try discussing dc_waterfall instead.

[Understand "marsh" or "swamp" as dc_marsh when last beat is in DenialC. dc_marsh is a beat in DenialC with fuse 9999 and keyword name "marsh" and reaction "'A trickling dismal place, have my words,' he says idly, [animus-business], 'but I ratherly love the little frogs that croak and flop there.'". the spire references dc_marsh.]

[Understand "frog/frogs" as dc_frogs when last beat is in DenialC. dc_frogs is a beat in DenialC with fuse 9999 and keyword name "frogs" and reaction "'So cute,' he smiles.".]

Understand "sculpture" as dc_sculpture when last beat is in DenialC. dc_sculpture is a beat in DenialC with fuse 9999 and keyword name "sculpture" and reaction "'Over and by the volcano, yes?' [the Progue] says suspiciously. 'Well and but Who knows what's over there, and where is He, if you snag my reason. That's [t]Creeper[x] country is the point. [if dc_creeper is spoken]I already warned you about that[otherwise]I'd stay away from there were I you[end if].'". volcano sculpture references dc_sculpture.

Understand "phoebe/lethe" as dc_gesundheit when last beat is in DenialC. dc_gesundheit is a repeatable ephemeral beat in DenialC with reaction "[one of]'Gesundheit!' [the Progue] says agreeably.[or]'Sorry, never heard of them,' [the Progue] says, pulling one ear, 'I don't follow popular music.'[cycling]".

[Understand "wife/love/partner/married/mother" as dc_wife. dc_wife is an ephemeral beat in DenialC with fuse 9999 and keyword name "wife" and reaction "'Married? Me?' he looks around, then gives a little giggle. 'Don't see any women here to marry, do you?' He sidles closer and lowers his voice. 'Or mayhaps there were some, once,' he says conspiratorially, 'before they were all eaten by the [dc_creeper].'".]

Understand "creeper/wrong" as dc_creeper. dc_creeper is a beat in DenialC with fuse 9999 and keyword name "[if last beat is dc_berries]wrong[else]creeper" and reaction "[The Progue] shudders, his vacant smile suddenly gone. 'Terrible thing,' he says, looking over his shoulder nervously. 'Lurking and slurking around, spying for victims, then [dc_pounce]! Pounce! Of course, there're a few [dc_safe] places round the [dc_island]; stick to those, [animal-nickname], and you'll be mostly usually safe. Usually.'". dc_creeper2 replaces dc_creeper. 

dc_creeper2 is a beat in DenialC with reaction "'What, have you seen it?' [the Progue] asks, gripping your shirt for a moment with white knuckles. 'Are you full on? What did it look like? Did it have hair, wings, terrible red claws, something sharp and teethwise? What? No? Yes?'[paragraph break]'Words and sausages,' he says, releasing you, 'don't get me upended like that. Thought you'd [dc_seen] the thing. Personally. Visually. Actually.'". dc_creeper3 replaces dc_creeper2.

dc_creeper3 is a beat in DenialC with reaction "'And what for and why do you keep mentioning it?' [the Progue] says in annoyance, [animus-business]. 'You certainly seem to have some morbid fascination with the thing. I'd rather not discuss it any more, if same's the same; I just had [if dawn or sunrise or morning or midmorning]breakfast[else if midday or afternoon]lunch[else]dinner[end if]!'".

Understand "seen" as dc_seen. dc_seen is an ephemeral beat in DenialC with keyword name "seen" and reaction "'Well of course I've never seen it!' he says indignantly. 'Would I be standing here alive and talking to myself if I had? Moisty hells. You hallucinations don't make much use of those imaginary brainwaves.'".

Understand "pounce" as dc_pounce. dc_pounce is a beat in DenialC with keyword name "pounce" and reaction "'It feeds on fear and memory, if you ring,' [the Progue] says, crouching down to the ground and shuffling forward on his haunches, hands spread out like claws before him. 'Lurks and hides, hurks and lies in shadows, tree roots, vines, waiting and waiting to tangle...' He saws the air with his hands, then leaps back up to full height, shivering. 'Nasty nasty.'".

Understand "safe/territory" as dc_safe. dc_safe is an ephemeral beat in DenialC with keyword name "safe" and reaction "'The beach is mostly usually safe,' [the Progue] says, counting on his fingers, 'and the [dc_waterfall], and the marsh and most of the northern parts. But once you gallop up that path into the forest, that's [dc_creeper] land. Best to stay ambly down here by sand and marsh, where you know and know what's safe.'".

[Understand "fantasy/fantasies" as dc_fantasies. dc_fantasies is an ephemeral beat in DenialC with keyword name "fantasies" and reaction "[The Progue] nods soberly, as if considering. 'Yes, yes, I'm well aware the Creeper is probably just a paranoid delusional fantasy. Like yourself. All the signs, do you see.' He turns his head. 'But then again, one can't deny the utter feeling of dread that floods me every time I even think of going into its [dc_safe]. No, on the other hand, I'm quite sure it's real,' he says musingly, 'real, or at least, almost so.'".]

Understand "sketchbook" as dc_sketchbook when last beat is in DenialC. dc_sketchbook is a beat in DenialC with fuse 9999 and keyword name "sketchbook" and reaction "'Hmm,' [the Progue] says, [attitude-business]. 'Doesn't sound something familiar. Mayhaps something the [dc_sculptor] left lying around I suppose.' He frowns. 'So long ago. Can't remember. Or even member, really. Oh well oh.". Progue's sketchbook references dc_sketchbook.

[Understand "painter/sculptor" as dc_sculptor2 when last beat is in DenialC. dc_sculptor2 is a beat in DenialC with keyword name "sculptor" and reaction "'Crazy man!' [the Progue] says, nodding. 'Built all kinds of contraptions everywhere. Used to live here, years ago. Never knew what happened to him in the end. Probably swallowed by the [dc_creeper].'".]

Understand "ropeway" as dc_ropeway when the psyche of Progue is denial. dc_ropeway is a beat in DenialC with fuse 9999 and keyword name "ropeway" and reaction "'Yes and but what an eyesore, eh?' [the Progue] says, [animus-business]. 'Urban blight even on my abandoned tropical [dc_island], industrial pollution all the way to the [dc_mountain] of the mountain. Don't worry-worry though; there's no [dc_ropewaypower] anyway, so you won't have to hear that tooth-bouncing racket it makes.'". ropeway-shack references dc_ropeway. Check examining by name ropeway-shack: if dc_ropeway is available, try discussing dc_ropeway instead. Check examining by name distant-ropeway: if dc_ropeway is available, try discussing dc_ropeway instead.

Understand "top" as dc_mountain when last beat is in DenialC. dc_mountain is a beat in DenialC with keyword name "top" and reaction "'Quite a ride, though, if memory rings,' he adds, smiling broadly. 'Wonderful view. Heart-stopping. Breath-catching. Bone-smashing too if the cablings gone fray-ey over the years. Hold your care with the thing.'".

Understand "power" as dc_ropewaypower when last beat is in DenialC. dc_ropewaypower is a beat in DenialC with keyword name "power" and reaction "'Needs steam from the volcano floor to run, I think I remember knowing,' [the Progue] says, [attitude-business]. 'The [dc_sculptor] told me that once. I think. Course that's in [dc_creeper] territory now, the volcano floor is, so I'd forget the whole idea were I you. Too dangerous now.' He shudders.".

Understand "compass" as dc_compass when last beat is in DenialC. dc_compass is a beat in DenialC with keyword name "compass" and fuse 9999 and reaction "[if player wears compass]'Oh, how fancy fancy!' [the Progue] says, peering at it with interest. 'I used to have one just like, years and fears ago. Now, I wonder whatever happened to that thing?' He frowns, staring off into the distance.[paragraph break]'Must have been stolen,' he finally declares, 'by that [dc_sculptor] I suppose. Hrmph. Thieving artists.'". [dc_compass references compass.] [this is made true when we wear the compass.] Check examining by name compass: if dc_compass is available, try discussing dc_compass instead.

Instead of giving compass to Progue when last beat is in DenialC: force discuss dc_givecompass. dc_givecompass is an affinitive beat in DenialC with reaction "'Oh, that's very kind of you, but really, you keep it,' [the Progue] says, waving you off. 'I've no use for it any more, really. Keep it; do, but sweet of you to offer.'".



Understand "treehouse" as dc_treehouse when last beat is in DenialC. dc_treehouse is a beat in DenialC with keyword name "treehouse" and fuse 9999 and reaction "'Ah yes,' he says, 'I remember it. Charming. Those two raven-haired little [dc_girls] used to sleep there, when they lived here. Never liked the [dc_cabin] much. Needed their own little place, I suppose. Aren't still there, are they? No?'[paragraph break]He rubs his beard. 'Trickling pity. I do still wonder sometimes where and where they went off to.'". tree2 references dc_treehouse.

Understand "head" as dc_head when last beat is in DenialC. dc_head is a beat in DenialC with keyword name "head" and fuse 9999 and reaction "'Never heard of something thatwise,' says [the Progue], who bears more than a passing resemblance to the clockwork head. 'Maybe some crazy thing of that old [dc_sculptor], or some toy of those two little [dc_girls]. Or both, mayhaps even.'". clockwork head references dc_head.

Understand "hallucination/hallucinations/me/noncorporeal/figment/imagination/imaginary/spirit/representation" as dc_player when the psyche of Progue is denial. dc_player is an insistent beat in DenialC with keyword name "[if last beat is dc_creeper or last beat is dc_six or last beat is dc_chat2 ]hallucinations[otherwise if last beat is dc_chat4 or last beat is in PC]noncorporeal[otherwise if last beat is dc_hug]spirit[otherwise]figment" and fuse 9999 and reaction "'It's not that I'm surprised you're here, if you ring,' he says, [animus-business], 'it's just I've had expected strange visions and imaginary friends to start appearing green [dc_longlived] ago[if The-Path-Of-Love has happened]. You're late, see, by about oh twenty years, give or get[end if].'[paragraph break]A sudden thought strikes him and he gives you a sidelong glance. 'But dear oh dear oh,' he says, 'are you the sort that likes to pretend you're a real person?'". The yes-beat is dc_real. The no-beat is dc_notreal. The maybe-beat is dc_notreal. dc_player2 replaces dc_player. dc_player suggests dc_notreal. 

dc_player2 is a beat in DenialC with keyword name "hallucination" and reaction "[if dc_real is spoken or dc_notreal is spoken]'You've made your case, [animal-nickname], you've made your case,' he says with a smile, [animus-business]. 'There's no need to recapitch.'[otherwise]'You never answered my questionings earlier,' he says, [attitude-business]. 'You really expect me to believe you're actually here and not just a fig in my braincase?'". The yes-beat of dc_player2 is dc_real. The no-beat of dc_player2 is dc_notreal. The maybe-beat of dc_player2 is dc_notreal. dc_player2 suggests dc_notreal.


dc_notreal is a beat in DenialC with keyword name "no" and reaction "'Good,' [the Progue] says, nodding in satisfaction. 'I can see we're going to get along all splend. Now what did you want to pretend to talk about?'".  After discussing dc_notreal: adjust dcp2; continue the action.

To adjust dcp2: now the yes-beat of dc_player2 is silence; now the no-beat of dc_player2 is silence; now the maybe-beat of dc_player2 is silence; now dc_player2 suggests silence.

Understand "real/figment" as dc_real. dc_real is an insistent beat in DenialC with keyword name "[if last beat is dc_name3]figment[otherwise]yes" and reaction "'Ha! Ha! Impossible!' [the Progue] shouts, leaping to his feet and beginning to pace. 'Fact the first: nobody has footed this [dc_island] in twenty years but me. Well, there's the [dc_creeper]. And those two little [dc_girls] who used to live here. And myself, of course. Did I already count myself? And the Three Great Men. And, well, you, I suppose, if we want to count you, which we mostly usually don't. Sausages, that's actually quite a lot.' He scratches his head. 'But where was I? Had I gotten as far as Fact the Second?'". The yes-beat is dc_real3. The no-beat is dc_real2. The maybe-beat is dc_keepup. dc_real suggests dc_keepup.  After discussing dc_real: adjust dcp2; continue the action.

dc_keepup is an insistent beat in DenialC with keyword name "maybe" and reaction "'Try to keep up,' [the Progue] says. 'Now: Fact the Twain. [real2body].". dc_keepup suggests dc_real3. dc_keepup summons dc_real3. 

dc_real2 is an insistent exciting beat in DenialC with keyword name "no" and reaction "'Excellent,' he says, 'then on to Fact the Twain. [real2body].". dc_real2 suggests dc_real3. dc_real2 summons dc_real3. To say real2body: say "Self-evidently I am a madman: observe the clothes, the mannerisms, the crazed wild look--' (he demonstrates this last by pointing to his eyes and opening them as wide as possible) '--and it's calm and common knowledge that mad persons have visions. Waking dreams. Hallucinations. Yes, so, correlation, causality, all that, but you must admit the odds are high in fave that you're just a fig in my terminally inflamed imagination.' He suddenly stops and looks at a distant [dc_real3] on the horizon with a fierce intensity". 

Understand "speck/yes" as dc_real3. dc_real3 is an insistent beat in DenialC with keyword name "[if last beat is dc_real2 or last beat is dc_keepup]speck[otherwise]yes" and reaction "[if we have not discussed dc_real2 and we have not discussed dc_keepup]'Excellent,' he says, 'then Fact the Third. [otherwise]'FACT THE TREBLE!' [the Progue] suddenly shouts, holding up a bony finger. '[end if]You appeared quite out of the blue, plum in the mid of Word Day, without a boat, spaceship, proper swimwear or even a good walking stick.' He eyes your traveling clothes critically. 'If and if you aren't hallucinatory, how in worlds do you explain yourself?'". dc_real3 summons dc_wayfaring, dc_real4. dc_real3 suggests dc_real4. The maybe-beat of dc_real3 is dc_real4 [shrug].

dc_real4 is a beat in DenialC with keyword name "shrug" and reaction "'Exactly,' he says, nodding, 'impossible.'". dc_real4 enqueues dc_real5.

dc_real5 is an insistent beat in DenialC with reaction "'At any rate, you appeared from nowhere. No Where,' [the Progue] says again with emphasis, 'your where is unfound and unfounded, and is this, I ask again, the behavior of a corporeal, logical, secular, effably terrestrial person?' He glares at you.". The yes-beat is dc_realyes. The no-beat is dc_realno. The maybe-beat is dc_realno. dc_real5 suggests dc_realno.

dc_realyes is a beat in DenialC with keyword name "yes" and reaction "He nods in satisfaction. 'Ah yes! Just as I hypothesized. Spirits and hallucinations would naturally be immune to logic and reason.'". dc_realyes enqueues dc_realfinish.

dc_realno is a beat in DenialC with keyword name "no" and reaction "'Of course it isn't,' he says forcefully. 'I think therefore you are not.'". dc_realno enqueues dc_realfinish.

dc_realfinish is a beat in DenialC with reaction "He grins broadly and claps you on the back. 'Well oh, now that we've proven your nonexistence we can get down to having some gushing nice conversations. Oh, don't take it so hard, even we factual beings have to cope with nonexistence eventually. Now. What [t]subject[x] were we talking about?'". dc_realfinish cancels dc_realyes, dc_realno.

Understand "wayfaring" as dc_wayfaring. dc_wayfaring is an ephemeral beat in DenialC with keyword name "wayfaring" and reaction "He listens to your explanation with an ever-growing smirk, and finally bursts out in a torrent of hysterical giggling. 'Terrible sorries,' he says, still struggling to control himself, 'it's just such a delicious story. Deathly serious artists flittering about the universe with magical paintbrushes, sending out psychic emergency beacons when they get into trouble?'[paragraph break]He starts giggling again, then holds up a hand and makes a serious effort to regain control. 'No but really, but it's delicious,' he whispers[if last beat is in DenialC], 'but oh, where was I?'[otherwise].[end if]". dc_wayfaring enqueues dc_real5. 

Understand "girl/girls/daughter/daughters/they" as dc_girls. dc_girls is a beat in DenialC with fuse 9999 and keyword name "[if last beat is dc_six2]they[otherwise]girls" and reaction "'Ah yes,' he says, his face lighting up, 'I remember them, I do. Charming little girls, raven black hair. Used to live around herewards, somewhen. Haven't seen them in eons and ages. Now what were their names?' He scratches his head. 'Ah well-oh, not important I suppose.'". dc_girls2 replaces dc_girls. dc_girls summons dc_gesundheit.

dc_girls2 is a repeatable beat in DenialC with reaction "[one of]'Used to play on the beach here,' he says fondly. 'Cute as beetles. I wonder what ever and ever happened to them?'[or]'They had a queer [dc_treehouse] somewhere,' [the Progue] says vaguely, gesturing off towards the southern half of the island. 'Spent buckets of time there, up to whatever it is little girls get up to.'[or]'They were fond of the little blue [dc_mussels],' [the Progue] says, smiling. 'I remember now. We'd steam them up on the beach, have a regular feast. Haven't thought about that in years and fears.'[or][all_i_remember][stopping]". dc_girls2 summons dc_gesundheit.

Understand "cabin/house/shack/hut" as dc_cabin. dc_cabin is an ephemeral beat in DenialC with fuse 9999 and keyword name "cabin" and reaction "He looks surprised and confused until you point it out to him. 'Oh!' he says when he finally notices it, 'that moldy thing. Haven't set foot in there for years. I usually just sleep out under the [learn_capalla_name] now, mostly usually. Healthier. Sea breeze, all that. Makes it easier to run, too,' he adds casually, 'if the [dc_creeper] attacks.'". log cabin references dc_cabin. Check examining by name the log cabin: if dc_cabin is available, try discussing dc_cabin instead. [Check wordgoing Center Beach: if dc_cabin is available, try discussing dc_cabin instead. Check wordgoing Hut: if dc_cabin is available, try discussing dc_cabin instead.]

Understand "dream/dreams" as dc_dreams. dc_dreams is a beat in DenialC with fuse 9999 and keyword name "dreams" and reaction "'Now what now?' he says in astonishment, 'you've been sleeping over in [dc_creeper] territory? Well but of blessed courses you're having bad dreams, [animal-nickname]. It's gushing terrifying over by those creepy creeping [t]windsigh[x] trees. Sure as sure you're better off sleeping on the beach, or maybe mountain-ledgewards like I do.' He grins, [animus-business].". d1-door references dc_dreams. dc_dreams summons dc_windsigh, dc_gesundheit.

Understand "blue flash" or "flash" as dc_flash. dc_flash is a repeatable beat in DenialC with fuse 9999 and keyword name "flash" and reaction "'[one of]The queerest thing[or]Gushing strange[or]Quite the phoneme[in random order],' he says, '[one of]Seems to trig something up in the old braincase[or]I've seen all kinds of strange things when I stare into it[or]I've seen Flashes on other worlds but they were always sort of a let-down to be square[in random order]. [one of]Just stay by the ocean and stare into the sun at the moment of sunset and you're bound to catch it[or]From anywhere near the ocean, watch the sun as it's setting and you'll see it, sure as blue is blue[in random order].'". 

Understand "island/lacuna" as dc_island1. dc_island1 is a beat in DenialC with keyword name "[if last beat is dc_job]Lacuna[otherwise]island" and fuse 9999 and reaction "'Oh, it's trickling pleasant here for a desert island,' he says with a wide grin, waving a hand delicately to encompass the whole scene. 'Beautiful [learn_capalla_name], wonderful [dc_food], no tax collectors. Not one. Think on that a spell, [animal-nickname]. And a pretty pretty place to lose one's mind. As [dc_longlived] as I've lived here, it's been my home.' He frowns, then smiles. 'That's redundant,' he adds happily, 'but true.'". dc_island2 replaces dc_island1.

Understand "island/lacuna" as dc_island. dc_island is a beat in DenialC with keyword name "[if last beat is dc_job]Lacuna[otherwise]island" and fuse 9999 and reaction "'But Something Further, you haven't been officially welcomed yet!' he says, leaping onto [Progue's perch] and spreading his arms wide, spinning around dizzily to take in the whole island. 'Welcome welcome,' he says grandly, 'to Lacuna!'[paragraph break]'That's what it's called, if you ring,' he adds. 'Or [']My Lacuna['] if I'm feeling territorialish. There's a trickling good story about how it acquired that name but,' he leaps back down to the [surface-material] again, 'I'm afraid I've entirely forgotten it. Ah well-oh. Lacuna!'[paragraph break]He holds up three fingers. 'There's Three Great Men who used to live here,' he says, 'the [dc_toursculptor], the [dc_tourfather], and the [dc_tourmadman]. All gone as gone now, but each left a secret, oh! green eons ago, and now they're sort of tourist attractions. You get a prize if you find them all! The secrets. Or so the tourist board says. Of course there aren't any tourists here. Real ones I mean, no offenses[if puzzle mode]. But tell you this: you find all three [dc_secrets] and I'll give you a little something anyway[end if].'". After discussing dc_island: now yourself references dc_secrets; continue the action. dc_island1 replaces dc_island. tree1-nook references dc_island.

Every turn when weather state is undecided and afternoon and yourself references dc_secrets and the psyche of Progue is denial (this is the ensure it rains during secrets quest rule): now the weather state is decided to rain. The ensure it rains during secrets quest rule is listed before the deciding on the weather rule in the every turn rules.

Understand "secret/secrets" as dc_secrets when last beat is in DenialC. dc_secrets is a repeatable beat in DenialC with keyword name "secrets" and fuse 9999 and reaction "[one of]'Yes,' he says, 'the Grand Tour of Lacuna, to find the Three Secrets of the Three Great Men, the [dc_toursculptor], the [dc_tourfather], and the [dc_tourmadman]. Goodness but that's a lot of capitals, sounds dreadfully important[or][dcsecmsg2][stopping]. So and but, have you found any yet?'". The yes-beat of dc_secrets is dc_secretsyes. The no-beat of dc_secrets is dc_secretsno. dc_secrets summons dc_secretsyes, dc_secretsno. To say dcsecmsg2: say "'[one of]Yes[or]Of course[or]Right[in random order], the [one of]Three Secrets of the Three Great Men of Lacuna[or]secrets of the island's former inhabitants[at random], the [dc_toursculptor], the [dc_tourfather], and the [dc_tourmadman]".

dc_secretsyes is a repeatable beat in DenialC with keyword name "yes" and fuse 2 and reaction "'Fantastic!' he says. 'Splend and charm! Well and what are they then?'". dc_secretsyes suggests dc_secretsno. dc_secretsyes cancels dc_tourfather, dc_toursculptor, dc_tourmadman. 

After discussing dc_secretsyes:
	if Lower Beach is visited and dc_secretsmanta is unspoken:
		now tempfuse of dc_secretsmanta is 5;
		now tempfuse of learn_rayfish_name is 0;
	if treehouse-in-rain is true and dc_secretsface is unspoken:
		now tempfuse of dc_secretsface is 5;
		now tempfuse of dc_treehouse is 0;
	if ( pyramid-seen is true or Observatory Exterior is visited or Viewpoint is visited ) and dc_secretspyramid is unspoken:
		now tempfuse of dc_secretspyramid is 5;
[		now tempfuse of dc_pyramid is 0;]
	continue the action. 

Understand "no" as dc_secretsno when last beat is in DenialC. dc_secretsno is a repeatable beat in DenialC with keyword name "no" and fuse 2 and reaction "'Keep looking!' he says[if dc_tourfather is spoken and dc_toursculptor is spoken and dc_tourmadman is spoken]. 'Remember, night, rainstorms, and tides.'[else].[end if]".

Understand "manta/rayfish" as dc_secretsmanta when last beat is in DenialC. dc_secretsmanta is a beat in DenialC with keyword name "manta" and fuse 5 and reaction "'Yes,' [the Progue] sighs, 'something beautiful, isn't it? The rayfish, they're called. Well and if you like the sculpture, you should see them when they come out in the bay every night, great glowing angels. Beautiful. The sculptor's secret, good as good.'". After discussing dc_secretsmanta: if dc_secretsface is spoken and dc_secretspyramid is spoken, force discuss dc_secretswon; continue the action. [Check wordgoing the manta sculpture: if dc_secretsmanta is available, try discussing dc_secretsmanta instead.] Check examining by name the manta sculpture: if dc_secretsmanta is available, try discussing dc_secretsmanta instead.

Understand "face" as dc_secretsface when last beat is in DenialC. dc_secretsface is a beat in DenialC with keyword name "face" and fuse 5 and reaction "'So beautiful,' [the Progue] says with a sort of wistful sigh, staring off into the distance. 'Haven't seen it in green eons but I remember sometimes looking at her and thinking, thinking I could almost but almost remember her...' He shakes his head. 'But that's silly, I never met her, it was the Father. And you found his secret. Excellent!'". After discussing dc_secretsface: if dc_secretsmanta is spoken and dc_secretspyramid is spoken, force discuss dc_secretswon; continue the action. Check discussing dc_treehouse: if treehouse-in-rain is true and dc_secretsface is unspoken begin; force discuss dc_secretsface; stop the action; end if.

Understand "pyramid" as dc_secretspyramid when last beat is in DenialC. dc_secretspyramid is a beat in DenialC with keyword name "pyramid" and fuse 5 and reaction "'And what a queer and plexing thing it is!' he says. 'Just sits up there, doing nothing! Ages and ages to build I expect and why? Ah well-oh, it's pretty, don't you think? Just don't go near it is all; probably filled with radiation and cooties. The Madman's secret; good work.'". After discussing dc_secretspyramid: if dc_secretsface is spoken and dc_secretsmanta is spoken, force discuss dc_secretswon; continue the action. Check examining by name distant-pyramid: if dc_secretspyramid is available, try discussing dc_secretspyramid instead.[ Check discussing dc_pyramid: if ( pyramid-seen is true or Observatory Exterior is visited or Viewpoint is visited ) and dc_secretspyramid is unspoken, force discuss dc_secretspyramid instead.] 

dc_secretswon is a beat in DenialC with reaction "'Sausages, you found them all!' he says, clapping you on the back. 'Good job for somebody who's not even real. Well and I promised you a reward, and here it is[if player wears compass].' He reaches out to the compass around your neck[else].' He reaches into a deep pocket and pulls out a beautiful brass compass on a chain, putting it around your neck. As if in afterthought, he reaches out to the compass around your neck[end if] and fiddles with the back. Suddenly the brass plating swings aside, revealing a hidden compartment with a seven-pointed star.[paragraph break]'One of them made that before he came here,' he says fondly. 'No idea what that star's for, but fancy fancy, eh?'". dc_secretswon summons dc_secretsthanks. After discussing dc_secretswon: now player wears compass; now compass is revealed; now nothing references dc_secrets; continue the action.

Understand "thanks" as dc_secretsthanks when last beat is in DenialC. dc_secretsthanks is a beat in DenialC with keyword name "thanks" and reaction "'You're mostly usually welcome,' he says, 'enjoy now.'".


Understand "sculptor" as dc_toursculptor when last beat is in DenialC. dc_toursculptor is a repeatable beat in DenialC with keyword name "Sculptor" and fuse 5 and reaction "'The Sculptor left all kinds of strange and strange art scattered round the island,' he says, 'but the secret one's somewhere on the beach. Look for it when the tide is low, and have my words you'll find it.'".

Understand "father" as dc_tourfather when last beat is in DenialC. dc_tourfather is a repeatable beat in DenialC with keyword name "Father" and fuse 5 and reaction "'The Father built a treehouse,' he says, 'for his children. Oh! Must be those two little girls. The children. That'd make sense. Well and but the point is, the treehouse has a secret,' he continues, 'that can only be seen in the [dc_tourrain].'".

Understand "rain" as dc_tourrain when last beat is in DenialC. dc_tourrain is a repeatable beat in DenialC with keyword name "rain" and reaction "'Hang about in the afternoons,' [the Progue] says, [animus-business], 'and you're bound to get caught in a shower. Lacuna's famous for the afternoon showers. Or gushing would be if anyone knew about it.'".

Understand "madman" as dc_tourmadman when last beat is in DenialC. dc_tourmadman is a repeatable beat in DenialC with keyword name "Madman" and fuse 5 and reaction "'Gushing bonkers!' he says. 'The Madman built all sorts of queer contraptions and devices and detraptions all over the place. But his mad masterpiece is up by the peak of the mountain, and from down here you can really only see what it is at night.'".

dc_island2 is a repeatable beat in DenialC with keyword name "[if last beat is dc_island]Lacuna[otherwise]island" and reaction "'[one of]I'm quite fond of it[or]Decent place to be exiled[or]Not a bad place, really[or]Lovely[or]I quite like it here[in random order],' he says. '[dcis2].". To say dcis2: if dc_konokuk is unspoken begin; say "So many delicious things to eat, like the [dc_konokuk] fruits, for instance"; otherwise if learn_rayfish_name is unspoken; say "And such a variety of unusual creatures, like the [learn_rayfish_name] out in the lagoon"; otherwise if learn_capalla_name is unspoken; say "I'm in love with the [learn_capalla_name] in this place"; otherwise if dc_crabs is unspoken; say "Have you seen the little [dc_crabs] scampering around? Dinner and entertainment combined"; otherwise; say "[one of]Of course, as I can't remember anywhere else, it may be a garbage dump comparatively. But that's the beauty of losing your mind; there's comparatively no comparatively at all[or]I hope you're enjoying your stay[or]Won my Best Island of the Annum award last year, you know. And the year before, really[or]Although to be frankfurters with you, [animal-nickname], I'm getting trickling weary of you bringing it up all the time[or]And really, there's hardly mostly nothing else at all to say about it[cycling]"; end if; say ".' He smiles, [animus-business]".

Understand "year/years/eons/long" as dc_longlived. dc_longlived is a beat in DenialC with fuse 9999 and keyword name "[if last beat is dc_player]eons[otherwise]long" and reaction "[The Progue] taps his head sharply. 'The memory's not what it used to,' he says, [attitude-business], 'at least so I assume. Most days I actually don't remember ever living anywhere but here. I've forgotten what I remember on the days I do remember.' He giggles, then frowns. 'From the circumstantial there's evidence I've been here for green as green eons, though. Pretty place to lose one's mind. Did I say that already? Yes? Ah well-oh.'".


[Understand "door" as dc_doorpuzzle2. dc_doorpuzzle2 is a beat in DenialC with keyword name "door" and fuse 9999 and reaction "[The Progue] grows annoyed as you try to explain. 'I don't know why you're bothering me about it,' he says. 'Why don't you knock on it and see if anyone's home?'". dc_door1b replaces dc_doorpuzzle2. lava tunnel door references dc_doorpuzzle2. After discussing dc_doorpuzzle2: now lava tunnel door references dc_door1b; continue the action.]

Understand "door" as dc_door1b. dc_door1b is a beat in DenialC with keyword name "door" and fuse 9999 and reaction "'That thing,' [the Progue] says. 'Haven't seen it for years. Barely remember it. Probably some nonsense of that [dc_sculptor].' A thought occurs to him. 'That does sound something familiar, though. Bands of [dc_doorcolors], row of [dc_buttons]. Hmm.'". dc_door1b summons dc_doorcolors, dc_buttons. dc_door2 replaces dc_door1b. lava tunnel door references dc_door1b.

dc_door2 is a repeatable beat in DenialC with reaction "'[one of]Still can't get through that wretched door[or]What, still harping on that silly door[or]Not the door again[or]Moisty hells, that old door again[cycling]?' [the Progue] asks[one of] wearily[or] tiredly[or], rolling his eyes[in random order]. '[one of]Really don't see what you want with it[or]What could possibly be so interesting about it[or]Why in worlds you're so obsessed with it I can't imagine[in random order]. [dcdoor22]". To say dcdoor22: say "[one of]Nothing through there but the other half of the island[or]Nothing on the other side but a volcano, a rain forest, and a rather scenic chasm[or]Not much through it worth seeing, anyway[in random order]. [one of]You'll just have to figure out the [dc_order] to push the [dc_buttons] in, I suppose[or]I expect you'll need to push the [dc_buttons] in the right [dc_order] if you want it open[in random order],' he says, [animus-business].". 

Understand "sculptor" as dc_sculptor. dc_sculptor is a beat in DenialC with keyword name "sculptor" and reaction "'Crazy old hermit!' [the Progue] says, nodding. 'One of the Three Great Men with their [dc_secrets]. Built all kinds of contraptions everywhere. Used to live here for a span, years ago. Never knew what happened to him in the end. Probably swallowed by the [dc_creeper][if dc_door1b is spoken]. Oh!' He adds suddenly. 'He built it for those lovely little [dc_girls]. That [dc_door1b]. To keep them [dc_safety] from, you know, something or other[end if].'".

Understand "button/buttons" as dc_buttons. dc_buttons is a repeatable beat in DenialC with keyword name "buttons" and fuse 5 and reaction "[one of]'Oh, now that does tickle the brainwaves, doesn't it?' [the Progue] says thoughtfully, scratching his head. 'Yes, those beautiful buttons, each inscribed with something found about the [dc_island]. Work, craft, and show; all sorts of manshippage!' He smiles, then tilts his head, [animus-business]. 'There was something frightful important about the [dc_order] you pressed them in, if I recall,' he says. 'Frightful, frightful important.'[or]'Yes,' he says again, 'definitely something of prime importance related to the [dc_order] you pressed them in.'[stopping]".

Understand "order" as dc_order when last beat is in DenialC. dc_order is a beat in DenialC with keyword name "order" and reaction "'Ye-es,' he says, slowly, lifting his finger and punching imaginary buttons in the air. 'Click click, click click click, click. [if puzzle mode][dc_six] of [']em, made thrilling little clunks when pressed.[otherwise]One for each color, and what thrilling little clunks![end if]' He smiles, half closing his eyes in memory, it would seem, of this tiny pleasure.". dc_positioned replaces dc_order. dc_order suggests dc_six.

Understand "six" as dc_six when last beat is in DenialC. dc_six is a beat in DenialC with keyword name "Six" and reaction "'Which six? What order?' he asks in astonishment. 'Well why should that matter? Honest, you [dc_player] are obsessed with the strangest things. [if puzzle mode]Which six buttons indeed. [end if]My worlds.' But he pauses and half closes an eyelid, as if something occurs to him, and falls silent for a musing moment.". dc_six suggests dc_six2. dc_six2 replaces dc_six.

dc_six2 is a repeatable beat in DenialC with reaction "[one of]'Something to do with the [dc_doorcolors], though,' he says slowly. 'Yes, I'd forgotten that. The colors were important in case I forgot. He forgot, I mean. The [dc_sculptor]. Something [dc_girls] wouldn't know about,' he adds half in a trance, a faint smile touching his face, 'the little angels.'[or]'It was all about the [dc_doorcolors] somehow,' he says again, nodding, 'to keep those [dc_girls] from getting into danger. To keep them [dc_safety].[stopping]". 

Understand "safe" as dc_safety when last beat is in DenialC. dc_safety is a beat in DenialC with keyword name "safe" and reaction "'Yes,' [the Progue] says vaguely, waving a floppy hand in the direction of the volcano, 'the lava flow, too dangerous for little girls, all sharp edges and chasms and steam vents. And of course the [dc_creeper] lives over there. Or at least, it does now.' He frowns. 'Was it around back then? Can't remember. Was I? Or was it just the [dc_sculptor] then? Can't remember. Oh well oh.'".

Understand "color/colors/vertical/bands/band" as dc_doorcolors when last beat is in DenialC. dc_doorcolors is a beat in DenialC with keyword name "colors" and fuse 6 and reaction "'Bands of colors?' [the Progue] says vaguely. 'Well, yes, that does sound something familiar now that you mention. The door was built by that [dc_sculptor], if you ring; I think he's the one who painted the colors on there too. [dc_positioned] them in a certain way. Something to do with the [dc_buttons], I suppose.' He shrugs, [animus-business].".

Understand "position/positioned" as dc_positioned when last beat is in DenialC. dc_positioned is a repeatable beat in DenialC with keyword name "Positioned" and reaction "'[one of]Oh, a sculptor does nothing by accident, lie assured,' he says, warming to his subject. 'They're deliberate, precise. [or][stopping]Yes, I'm gushing sure each of those colors, [t]red[x], [t]blue[x], [t]black[x] and all the others, was where it was for a very deliberate, precise, important [dc_purpose].' He nods authoritatively.". dc_positioned summons dph_red, dph_blue, dph_white, dph_black, dph_yellow, dph_green.

Understand "purpose" as dc_purpose when last beat is in DenialC. dc_purpose is a beat in DenialC with keyword name "purpose" and reaction "'A very important purpose indeed,' [the Progue] says vaguely, 'its importance was never in doubt by all. Yes, no, never.'[paragraph break]'Sorry I can't be more helpfulable,' he adds, 'it was just a notion. Flew in then right back out again! Don't remember much these days, mostly usually. Remember much, that is. What were we talking about?'".

the puzzle_color is a beat that varies. the puzzle_color is silence.

Understand "red" as dph_red when last beat is in DenialC or puzzle_color is not silence. dph_red is a repeatable beat in DenialC with keyword name "red" and reaction "[pc_red][color_hint1]". dph_red enqueues dph_postcolor.

Understand "yellow" as dph_yellow when last beat is in DenialC or puzzle_color is not silence. dph_yellow is a repeatable beat in DenialC with keyword name "yellow" and reaction "[pc_yellow][color_hint1]".  dph_yellow enqueues dph_postcolor.

Understand "black" as dph_black when last beat is in DenialC or puzzle_color is not silence. dph_black is a repeatable beat in DenialC with keyword name "black" and reaction "[pc_black][color_hint1]".  dph_black enqueues dph_postcolor.

Understand "white" as dph_white when last beat is in DenialC or puzzle_color is not silence. dph_white is a repeatable beat in DenialC with keyword name "white" and reaction "[pc_white][color_hint1]".  dph_white enqueues dph_postcolor.

Understand "blue" as dph_blue when last beat is in DenialC or puzzle_color is not silence. dph_blue is a repeatable beat in DenialC with keyword name "blue" and reaction "[pc_blue][color_hint1]".  dph_blue enqueues dph_postcolor.

Understand "green" as dph_green when last beat is in DenialC or puzzle_color is not silence. dph_green is a repeatable beat in DenialC with keyword name "green" and reaction "[pc_green][color_hint1]".  dph_green enqueues dph_postcolor.

To say color_hint1: say "[one of]'Moisty hells,' [the Progue] says, throwing up his hands, 'you expect me to remember some obscure bit of color symbolism that crazy sculptor left behind, all these years later? You expect a two-thirds mad castaway to know what a dash of [noun] paint on a door he hasn't seen in decades is meant to represent? No, don't answer; I can see by your ingratiating expression that you do.'[paragraph break]He sighs, [attitude-business]. 'Look, I'm trickling busy here at the moment,' he says. 'Why don't you come back later, say tomorrow maybe, and ask me then? I'll think about it; no really I will. Come back tomorrow, my [animal-nickname], tomorrow.' [Progue-resumes].[or][color_hint2][stopping]". 

To say pc_red: if puzzle_color is silence, now puzzle_color is dph_red.
To say pc_yellow: if puzzle_color is silence, now puzzle_color is dph_yellow.
To say pc_blue: if puzzle_color is silence, now puzzle_color is dph_blue.
To say pc_green: if puzzle_color is silence, now puzzle_color is dph_green.
To say pc_white: if puzzle_color is silence, now puzzle_color is dph_white.
To say pc_black: if puzzle_color is silence, now puzzle_color is dph_black.

dph_postcolor is a repeatable beat in DenialC. [dph_postcolor2 replaces dph_postcolor. dph_postcolor2 is a beat in DenialC. ][and does nothing.] Instead of discussing dph_postcolor when dc_colorsolution is spoken: do nothing.

After discussing dph_postcolor:
	post-conversation processing;
	now tomorrow-flag is true;
	continue the action.

Every turn when Progue is attentive and puzzle_color is not silence and an unimportant episode is playing: add puzzle_color to list of convo stuff, if absent; now tempfuse of puzzle_color is 5; remove dc_door1b from list of convo stuff, if present.

To say color_hint2:
	if dc_colorsolution is spoken begin;
		force discuss dc_toomanycolors;
	otherwise if noun is puzzle_color;
		if Waiting-For-Tomorrow is happening begin;
			force discuss dc_colorbugearly;
		otherwise;
			force discuss dc_colorsolution;
			now puzzle_color is silence;
		end if;
	otherwise;
		force discuss dc_colorundecided;
	end if.

dc_colorbugearly is a repeatable beat in DenialC with reaction "'[one of]I said tomorrow![or]Tomorrow! Tomorrow![or]What did I say?[in random order]' [the Progue] says[one of], almost jumping up and down in fury[or], mouth gaping open in astonishment at what he seems to view as utterly incurable stupidity[or] angrily[in random order]. '[one of]Can't you blind? Are you see?[or]How many times do I have to sound this to you?[or]It's not that difficult a concept, really.[in random order] It's not tomorrow yet[one of], or,' he adds, managing somehow to be both infuriated and speculative at the same time, 'if it is, it's not tomorrow enough yet[or][stopping]. Later! Come back later!'".

dc_colorsolution is an ephemeral beat in DenialC with reaction "'Oh, that!' [the Progue] says. 'Well, I think I may have remembered something, but first I have to say I really don't ring this part of the haunting business at all.' He shakes his head. 'Why [puzzle_color]? Does it represent something about my life? Association! Representation! Hmm, mayhaps... yes, yes, peeking through the [']locked door,['] discovering what's on the [']other side,['] something thatwise, eh? Ah! So metaphorical of you, so neurological! I'm sure exciting personal breakthroughs are about to made once this [puzzle_color] curtain is peeled from the depths of my [puzzle_color]-strewn psyche.' He nods in satisfaction.[paragraph break]'Oh,' he adds as an afterthought. It's [dc_puzzbit]. That's where the [puzzle_color] paint came from. You're welcome.'". To say dc_puzzbit: say "[if puzzle_color is dph_red]the berries. The berries are red[otherwise if puzzle_color is dph_yellow]the leaves of the [dc_windsigh]. The tree leaves are yellow[otherwise if puzzle_color is dph_white]the snails. Their shells are white[otherwise if puzzle_color is dph_black]the [learn_rayfish_name], that swim in the lagoon at night. Their ink is black[otherwise if puzzle_color is dph_green]the [dc_mussels] down by the boulders. Their shells are green[otherwise]crystal by the waterfall. It matches that blue[end if]". After discussing dc_colorsolution: now puzzle_color is silence; continue the action.

dc_colorundecided is a repeatable beat in DenialC with reaction "[one of]'Oh, now it's [noun], is it?' [the Progue] says, [attitude-business]. 'First [puzzle_color], now [noun], then aquamarine and mauve and gamboge I expect. Listen, [animal-nickname], choosers can't be beggars; you've chosen your color so don't come begging for another one now.' He sniffs indignantly.[or]'Look, [animal-nickname], [puzzle_color] you said and [puzzle_color] it is, and that's it.'[stopping]".

dc_toomanycolors is a beat in DenialC with reaction "'Oh now really, this is too much,' he says indignantly. 'I really can't be bothered with that silly door any more. Figure it out yourself and stop pestering me!'".

tomorrow-flag is a truth state that varies. Waiting-For-Tomorrow is a recurring scene. Waiting-For-Tomorrow begins when tomorrow-flag is true. Waiting-For-Tomorrow ends when Having A Dream is happening or the time since Waiting-For-Tomorrow began is at least 23 hours. When Waiting-For-Tomorrow ends: now tomorrow-flag is false.


Understand "mussel/mussels" as dc_mussels when last beat is in DenialC. dc_mussels is a beat in DenialC with keyword name "mussels" and reaction "'Mmm,' [the Progue] says, rubbing his belly, 'they'd be delicious with a nice pale wine, if such things existed here. I like to imagine they do when I eat them; the delicate green of their shells a rich contrast against the faint yellow sheen of the wine, distorted through the glass...' He sighs in contentment.". small blue mussels references dc_mussels.


Understand "tree/trees/windsigh/vine/holes/leaves" as dc_windsigh. dc_windsigh is a beat in DenialC with fuse 9999 and keyword name "trees" and reaction "'Hmm,' [the Progue] says absently. 'Yes, I remember them. They gave off such a queer noise. I called them [remember_windsigh_name].' He scratches his chin. 'Now why did I remember that? Windsigh. Curious curious. Haven't seen or been near one for green eons, and there that word pops in.' He frowns. 'That's [dc_creeper] territory over there, if you ring; I stay away and you'd do well to too, too true.'". remember_windsigh_name replaces dc_windsigh. After discussing dc_windsigh: now tree1 is named; continue the action. tree1 references dc_windsigh. Check examining by name some konokuk trees: if dc_windsigh is available, try discussing dc_windsigh instead; if remember_windsigh_name is available, try discussing remember_windsigh_name instead. Check examining by name distant-tree3: if dc_windsigh is available, try discussing dc_windsigh instead; if remember_windsigh_name is available, try discussing remember_windsigh_name instead. 

remember_windsigh_name is a repeatable beat in DenialC with keyword name "windsigh" and reaction "'The windsigh,' [the Progue] says musingly, [animus-business]. '[one of]All I remember[or]I just remembered. All those little holes in the branches, big and small, even inside their trunk. They're called lacunae[or]Strange little trees[in random order].'". Check examining by name distant-tree3: if remember_windsigh_name is available, try discussing remember_windsigh_name instead. Check examining by name background-scenery: if remember_windsigh_name is available, try discussing remember_windsigh_name instead.

dc_alliremember is a repeatable ephemeral beat in DenialC with fuse 9999 and reaction "[one of]'Terrible sorries, can't remember anything else,' [the Progue] says whimsically.[or]'Hmm, can't remember much else about it,' [the Progue] says, scratching his chin.[or]'Surprised I remembered that much,' he mutters.[or]'Sorry, what were we just talking about?' [the Progue] says vaguely.[in random order]". To say all_i_remember: force discuss dc_alliremember. 

Understand "heavens/capalla" as learn_capalla_name. learn_capalla_name is a beat in DenialC with fuse 9999 and keyword name "heavens" and reaction "'Great place for astronomers, astrophiles, astromancers,' [the Progue] says agreeably. 'So many stars, and the great [remember_capalla_name] running through them all. Capalla; that's the galaxy, you know. I named it. I named everything here, every mostly. Why not, really.'". remember_capalla_name replaces learn_capalla_name. After discussing learn_capalla_name: now galaxy is named; continue the action. galaxy references learn_capalla_name. 

Understand "capalla" as remember_capalla_name when last beat is in DenialC. remember_capalla_name is a repeatable beat in DenialC with keyword name "Capalla" and reaction "'The galaxy's Capalla,' [the Progue] says, 'and to save you some time I won't bore you with my names for all the stars.'".

Understand "food" as dc_food. dc_food is a beat in DenialC with fuse 9999 and keyword name "food" and reaction "'Plenty to eat,' [the Progue] says. 'There's the [dc_berries], the fish, the [dc_crabs], the [dc_konokuk] fruit[if location is North Beach or location is Rise]...' Progue kicks one of the hairy brown spheres by way of illustration to this last example -- '[otherwise]-- the hairy brown round ones, you know--[end if]even the [learn_rayfish_name] are tender, but damn hard to catch,' he adds with a smile.". After discussing dc_food: now konokuk trees are named; continue the action. 

Understand "coconut/konokuk" as dc_konokuk. dc_konokuk is a repeatable beat in DenialC with fuse 9999 and keyword name "konokuk" and reaction "'Just give the konokuk fruits a good solid punch and they'll split right open,' [the Progue] says cheerfully. 'Delicious delicious.'". konokuk trees references dc_konokuk. After discussing dc_konokuk: now konokuk trees are named; continue the action. Check examining by name konokuk trees: if dc_konokuk is available, try discussing dc_konokuk instead. Check examining by name tree-konokuk: if dc_konokuk is available, try discussing dc_konokuk instead. Check examining by name ground-konokuk: if dc_konokuk is available, try discussing dc_konokuk instead. Does the player mean doing anything to dc_konokuk: it is very likely.

dc_fish is a beat in DenialC with fuse 9999 and keyword name "fish" and reaction "'They're all edible, to varying degrees,' he says [attitude-business]. 'But I've found the more colorful they are, the prettier, but the less tasty. Your experience may differ, being [t]noncorporeal[x].".

Understand "crab/crabs" as dc_crabs. dc_crabs is a beat in DenialC with fuse 9999 and keyword name "crabs" and reaction "'Sneaky little devils, aren't they?' [the Progue] says with a fond expression. 'Steam up quite nicely. Three or four make for quite some meal.'". crab references dc_crabs.

Understand "berry/berries/bush/bushes/fruit" as dc_berries. dc_berries is a beat in DenialC with fuse 9999 and keyword name "berries" and reaction "'Mmm,' [the Progue] says, 'I remember the flavor something strongwards. Haven't had any in years and fears; they're in the [dc_creeper] part of the island, if you ring.'". berries references dc_berries.

Progue references dc_name.
Understand "himself/name" as dc_name. dc_name is a beat in DenialC with fuse 9999 and keyword name "[if last beat is dc_name or last beat is dc_name2 or last beat is dc_name3]name[otherwise]himself" and reaction "He bows. 'So pleased to formally make your acquaintance,' he says, straightening with a grandiose flourish. 'I am the hermit without a hermitage, the shipwreck without a ship, the man without a memory. Or a wreck. A shipwreck without a wreck. That's better. Yes. But my personal history, allergic reactions, and [dc_name2], date, place of birth have all become mere hypothetical constructions, lost in unkept corners of the mind. Oh, that's good too. [']Unkept corners.['] I'd write that down if I didn't forget to.'".  dc_name2 replaces dc_name. 

dc_name2 is a beat in DenialC with keyword name "name" and reaction "He looks annoyed. 'I thought I told you,' he begins, 'that I can't remember my---'[paragraph break]He breaks off suddenly, a look of astonishment on his face. 'Oh well and there it is again,' he says faintly. 'How about that. Ten years it's been gone and now there it pops in just again like that. The blessed [dc_name3]. How very very extra-ordinary.'".  dc_name3 replaces dc_name2. After discussing dc_name2:  continue the action.

dc_name3 is a beat in DenialC with keyword name "name" and reaction "'Got it right up here,' he says cheerfully, tapping his head rather forcefully. 'What, you want to know it too? Rather forward of you isn't it? We've only just met!' He pauses, considering. 'Of course, that would provide some insurance against losing it again, I suppose.' He shifts his weight, frowning. 'On the other hand it wouldn't at all, as you're a [dc_real] of my imagination, so if I forget it you're liable to as well. Conundrum.' He taps his foot for a moment, staring off into the horizon, lost in thought.[paragraph break]'On the third hand,' he finally adds, scratching his beard, 'if your figmentation was fermenting in the same slice of mind where my name is, you'd know it already. So mayhaps this could be useful.' He thinks a moment more, then nods and looks you straight in the eye.[paragraph break]'Alright,' he says firmly, '[dc_nameguess2].'". After discussing dc_name3: activate guessing mode; continue the action. dc_nameguess2 replaces dc_name3. dc_postnameguess replaces dc_nameguess2.

dc_postnameguess is a beat in DenialC with keyword name "himself" and reaction "'I'm so happy to have it back!' he says, beaming. 'The name, that is. I'll take better care of it henceforthwithwards, I promise.'". After discussing dc_revealname: deactivate guessing mode; now Progue references nothing; continue the action. dc_png2 replaces dc_postnameguess.

dc_png2 is a repeatable beat in DenialC with keyword name "himself" and reaction "'[one of]Enjoying the [progue-time-of-day][or]Doing fine[or]Fantastic, [animal-nickname], thanks and thanks for asking[or]Quite well, quite well[or]Never better[in random order],' he says, [if a random chance of 1 in 2 succeeds][animus-business][otherwise][attitude-business][end if].".

Understand "guess" as dc_nameguess2. dc_nameguess2 is a beat in DenialC with keyword name "guess" and reaction "'Yes, guess my name,' he says, folding his arms. 'Go on, guess one. Just say it. Blurt one out, do.'". After discussing dc_nameguess2: activate guessing mode; continue the action.

player-name-guess is an indexed text that varies. player-name-guess is "no.guess".

Yourself is either active-guessing or not-guessing. Yourself is not-guessing. 

To activate guessing mode:
	unless Progue is named begin;
		now yourself is active-guessing;
		now boredom counter of Progue is 0;
		repeat with target running through available beats begin;
			unless target is dc_nameguess2, now tempfuse of target is 0; 
		end repeat; 
	end unless.

To deactivate guessing mode: now yourself is not-guessing.

[After reading a command when yourself is active-guessing:
	if Progue is idle:
		deactivate guessing mode; [sanity check.]
	otherwise:
		let testtext be indexed text;
		let testtext be the player's command;
		replace the player's command with "guess2 [the player's command]".]

[Guessing is an action applying to one topic. Understand "guess2 [text]" as guessing. Carry out guessing: say "Nothing happens."]

After reading a command when yourself is active-guessing and last beat is in DenialC:
	let spoken_word be indexed text;
	now spoken_word is the player's command;
	if a meta command matches spoken_word begin;
		say "[as the parser]Can't use meta commands while guessing. Try again in a moment[as normal].";
		stop;
	end if;
	if spoken_word exactly matches the text "no" begin;
		force discuss dc_refusetonameguess;
	otherwise if spoken_word exactly matches the text "yes";
		force discuss dc_nameyes;
	otherwise if spoken_word exactly matches the text "guess";
		force discuss dc_nameguess2;
	otherwise if spoken_word exactly matches the regular expression "\b(listen|nothing|z|wait)\b";
		deactivate guessing mode;
		force discuss dc_nameyes;
	otherwise if the number of characters in spoken_word is less than 3;
		let noise be indexed text;
		now noise is spoken_word;
		if the number of characters in noise is 1, now noise is "[noise][noise][noise][noise][noise]" in sentence case;
		otherwise now noise is "[noise][character number 2 in noise][character number 2 in noise][character number 2 in noise][character number 2 in noise]" in sentence case;
		say "[one of]'[noise]?' he says skeptically. 'That's a noise, not a name. Come on, now, I thought you were taking this seriously. Try again.'[or][twostrikes][stopping]";
	otherwise if the number of words in spoken_word is greater than 2;
		say "[one of]'Gesundheit,' he says. 'Sounds like quite a nasty cold you're coming down with there. You might want to try guessing just one name at a time until you're feeling a bit better, so you don't overdo things.'[or][twostrikes][stopping]";
	otherwise if the number of characters in spoken_word is greater than 13;
		say "[one of]'Same to your mother,' he says, crossing his arms. 'If that's what passes for a name where you come from, I don't believe I care to hear any cursing. Now come on, take this seriously. Guess again.'[or][twostrikes][stopping]";
	otherwise if spoken_word exactly matches the text "progue";
		deactivate guessing mode;
		force discuss dc_guessprogue;
	otherwise if spoken_word matches the text "ogue";
		force discuss dc_guessnameclose;
	otherwise;
		if player-name-guess is "no.guess", now player-name-guess is spoken_word in sentence case;
		force discuss dc_guessname;
	end if;
	stop the action.

Instead of getting bored when yourself is active-guessing:
	deactivate guessing mode;
	force discuss dc_nameyes;
	now boredom counter of Progue is 0;
	now Progue is attentive.

To say twostrikes: force discuss dc_refusetonameguess. [BUG: This may not work because its coming from a meta action?]

dc_guessname is an ephemeral beat in DenialC with reaction "He bursts out laughing. '['][player-name-guess]?[']' he says. 'Is that what you said? No, no. Ah well-oh, let me give you a hint. It rhymes with 'rogue.' You know, like scoundrel, vagabond. Try again?'". dc_guessname2 replaces dc_guessname. After discussing dc_guessname: if dc_rtlhint is unspoken, activate guessing mode; continue the action.

dc_guessname2 is an ephemeral beat in DenialC with reaction "'Oh, you're so far off,' he says, giggling. 'You were closer with ['][player-name-guess].['] Want another guess?'". dc_guessname3 replaces dc_guessname2. After discussing dc_guessname2: activate guessing mode; continue the action.

dc_guessname3 is an ephemeral beat in DenialC with reaction "'Ridiculous,' he says. 'Preposterous. I can see you aren't taking this seriously. Very well, I'll just tell you. Here it is.'". dc_guessname3 enqueues dc_revealname. After discussing dc_guessname3: deactivate guessing mode; continue the action.

dc_nameyes is a repeatable ephemeral beat in DenialC with reaction "[one of]'Well, go on,' he says.[or]'Still waiting,' he says.[or][twostrikes][stopping]". After discussing dc_nameyes: activate guessing mode; continue the action.

dc_guessnameclose is an ephemeral beat in DenialC with reaction "'Close!' he says, jumping up and down on the [surface-material], 'oh ever so ever so close. You've almost got it. Want one last guess?'". After discussing dc_guessnameclose: activate guessing mode; continue the action. dc_guessnameclose2 replaces dc_guessnameclose.

dc_guessnameclose2 is an ephemeral beat in DenialC with reaction "'Ooh, oh! Gushing close, my [animal-nickname]!' he shouts. 'I'm too upended to hold it in much longer; I'll just tell you tell you. Ready? Here it is.'". dc_guessnameclose2 enqueues dc_revealname. After discussing dc_guessnameclose2: deactivate guessing mode; continue the action.

dc_refusetonameguess is a beat in DenialC with reaction "'Something Further,' he says, waving a hand dismissively at you, 'there's so little entertainment round here to begin with I would have expected you to be more of a sport. Very well then, I'll tell you. Here it is.'". dc_refusetonameguess enqueues dc_revealname. After discussing dc_refusetonameguess: deactivate guessing mode; continue the action. 

dc_revealname is an affinitive beat in DenialC with reaction "Beaming happily at you, he clears his throat dramatically, looks around, then spreads his arms wide and proclaims, 'My name is, my name is, my name is...'[paragraph break]He scratches his head. 'Moisty hells, it's gone again,' he says glumly, then brightens. 'No! Yes! That's it! My name is... Progue!'". dc_revealname enqueues dc_rtlhint. After discussing dc_revealname: deactivate guessing mode; now dc_postnameguess replaces dc_name; continue the action. [[if a random setpiece is enclosed by location]leaps to the top of [a random setpiece enclosed by location][otherwise]spreads his arms wide[end if]]

dc_rtlhint is a beat in DenialC with reaction "He grabs a stick and scratches four quick symbols in the [surface-material], writing right to left. 'Progue,' he says again, nodding and erasing them again, 'an ancient name with a long and noble history and tradition. At least so I like to imagine. Can't remember sausages about my history and traditions unfortunately. Ah well-oh.'". After discussing dc_rtlhint: now dc_postnameguess replaces dc_name3; now Progue is named; now Progue is proper-named; deactivate guessing mode; continue the action. dc_rtlhint cancels dc_nameguess2, dc_nameyes.

dc_guessprogue is an affinitive beat in DenialC with reaction "He laughs triumphantly, flashing a wild grin. 'No, that's not it,' he says. 'Close though. No wait a ment, what did you say? Progue?' He crosses his arms and frowns. 'Actually I suppose that [italic type]is[roman type] the correct name, technically, although your pronunciation was something atrocious. But ah well-oh, never mind never mind.'". dc_guessprogue enqueues dc_rtlhint. After discussing dc_guessprogue: deactivate guessing mode; continue the action.


	

Chapter - Word Day

[ This is most likely the player's first contact with Progue. (The other possibility is if the player injures himself before waking Progue, in which case first contact is the Tending-to-Wounded-Player scene. ]

[ In this scene, Progue is standing atop a boulder in "Among the Boulders," loudly reading some bad poetry he has written. He will at first ignore the player, then jump cheerfully down to speak with him. Progue is sure you are a mere hallucination, and treats you thusly. ]

[ Possible endpoints: By default, Progue will have a breezy conversation about the weather, the poem, and the poor reception by the sea creatures, before waving and setting off to go about his business. Rude behavior by you may cause him to leave in a cheery huff, but not actually affect his disposition. Asking Progue about mentally charged keywords will cause a bit of hurt, and make Progue reveal he doesn't like this hallucination, before leaving (but still have no permanent effects). The player may attack Progue, or say the keyword "wayfaring" or "call" to jump immediately to the Shocking Revelation conversation. Progue does not reveal his name during this scene. ]

[Word Day is a guaranteed triggered instant rendezvous episode.][defined in Progue main] The expiration date of Word Day is 6 hours. The meeting place of Word Day is Among the Boulders. The icebreaker of Word Day is bp_verse1.

Last condition rule for Word Day:
	if player is in Fork, rule succeeds.

A commencement rule for Word Day:
	now time-wd-started is current interval;
	now the unavailable-beat of Progue is bp_dontinterrupt.

A finishing rule for Word Day:
	ignore the episodes usually end when conversation does rule;
	if bp_introduction is spoken and Progue is idle, rule succeeds;
	if Jumble is visited, rule succeeds. 

A completion rule for Word Day: [aar]
	now dont_describe_Progue is true;
	manually reference dc_flash;
	remove bp_flash from list of convo stuff, if present;
	Progue's life goes on;
	if Progue is enclosed by location begin;
		now Word Day is successful;
		if the psyche of Progue is denial, say "Just before getting out of sight, he turns. 'Oh!' he shouts back to you. 'Welcome welcome I suppose and all that. To the island!' He turns, disappearing behind the boulders, but his voice carries back: 'To my Lacuna!'";
		follow the Progue's motivation rule;
		print a section break;
	end if;
	if the episodic status of Word Day is expired begin;
		now the episode schedule is Table of Denial Episodes;
		now the icebreaker of Word Day is spoken; [This prevents it being put back in the queue.]
	end if;
	now the unavailable-beat of Progue is pd_unavailable.

time-wd-started is an interval that varies. [May be used much later for Progue's reminiscing. ]

[Table of Progue's Description (continued)
animus	episode		desc
--		Word Day	"At first glance, he seems the picture of a shipwreck victim: faded and torn rags akimbo on bony joints, long hair touched with grey, matted and thinning, and a sunworn face. As he stands atop the boulder shouting at the horizon, he seems like a madman. But something about the way he holds himself, the piercing blue of his eyes, and the way he moves his hands hints at some vague power, some animus that decrepitude or madness have yet to touch."]

Table of Progue's Initial Appearance (continued)
animus	episode		desc
--		Word Day	"[if we have not discussed bp_introduction]A strange little [o]man[x] stands atop the largest of the boulders, dressed in a patchwork costume of ragged and threadbare clothes. He faces the ocean and vigorously shouts at it.[otherwise]The curious old [o]man[x] watches you earnestly."

The subchange beat of Word Day is bp_dontinterrupt. After discussing bp_introduction: now the subchange beat of Word Day is bp_dontchangesubject; continue the action.
The boredom beat of Word Day is bp_bored.
The bye beat of Word Day is bp_earlybye.
The abruptbye beat of Word Day is bp_earlybye.

	
[Every turn when current episode is Word Day and ( location is Center Beach or location is Center Low Tide or location i ) : add potential messages from the Table of Distant Boulder Poetry. ] Every turn when current episode is Word Day and ( location is Tidepools or location is Ocean Waters or location is South Beach or location is Center Beach or location is North Beach or location is Rise ) and bp_introduction is unspoken: fire one off by frequency from the Table of Closeby Boulder Poetry, definitely selecting; now spotted-progue is true. 



[ Table of Distant Boulder Poetry
frequency	start time	end time	text	table		trigger	flag	
frequent	an interval	an interval	"From somewhere in the distance comes the faint sound of someone shouting."	--		Progue's voice
frequent	an interval	an interval	"A muffled voice yells something indistinguishable from somewhere through the trees."	--		Progue's voice
frequent	an interval	an interval	"You pick up the sound of a distant man yelling."	--	Progue's voice ]

Table of Closeby Boulder Poetry
freq		start time	end time	text	table		trigger	flag	
frequent	an interval	an interval	"[one of]Off towards the [if location is South Beach][dr]boulders[x][otherwise]boulders[end if], you can see a [o]figure[x] dressed in rags standing atop them and facing the ocean, shouting and gesticulating wildly[tutorial-distantpeople].[or][boulderpoetrydistant].[stopping]"		--	distant-Progue

To say boulderpoetrydistant: say "The [o][one of]man[or]figure[at random][x] [one of]in the distance[or]off by the [if location is South Beach][dr]boulders[x][otherwise]boulders[end if][at random] [one of]continues[or]is still[at random] [bpd2]". To say bpd2: say "[one of]shouting[or]yelling[or]crying out[or]raving[at random] and [one of]wildly waving his arms[or]gesticulating[or]jumping about[at random] from the top of the boulder".

[Understand "shout" or "shouts" or "shouting" or "voice" or "sound" or "faint" or "muffled" or "distant" or "man" as distant-Progue during Boulder Poetry. The description is "You can't quite make out the words, but it's definitely male, and it's definitely excited about something.".]

BP is a thread. The escape clause of BP is bp_hallucination.

Every turn when current episode is Word Day and location is Among the Boulders and the location was not Among the Boulders: now the psyche of Progue is denial; now the episode schedule is Table of Denial Episodes[; force discuss bp_verse1].

bp_bored is an unaffinitive beat in BP with reaction "'I see,' he says sourly, 'one of the unhelpful spirits then are you? Moisty hells, go and haunt someone else, why don't you, eh? The sea ignores me enough as it is; some Word Days I wonder if it even listens at all. Certain don't want more of that, thank you.'". bp_bored enqueues bp_outtro.

bp_verse1 is an exciting beat in BP with fuse 6 and reaction "'[t]Concordance[x]! Summation! Integration!' he shouts, staring furiously at the waves. 'Deliverance! Reticence! Abolition!'". bp_verse1 suggests bp_verse2. bp_verse1 summons bp_dontinterrupt. After discussing bp_verse1: now met_progue is true; continue the action.

bp_verse2 is an exciting beat in BP with fuse 6 and reaction "'[t]Proposition[x]! Elucidation!' he shouts. 'Deterrence!' He thinks for a moment, seemingly stumped, then his face lights up and he shouts 'Obsequious!'[tutorial-listening]". bp_verse2 suggests bp_verse3. bp_verse2 summons bp_dontinterrupt.

bp_verse3 is an exciting beat in BP with fuse 6 and reaction "He pauses for a moment to catch his breath, looking down at his bare toes, flexing thoughtfully. '[t]Ribaldness[x]?' he mutters. 'Torque. Serendipity, ahhhh.'". bp_verse3 suggests bp_verse4. bp_verse3 summons bp_dontinterrupt.

bp_verse4 is an exciting beat in BP with fuse 6 and reaction "He scrunches his face up, then belts out a string of words as quick as he can shout them: '[t]Singularity[x]- Perpetuity- Mendacity- Parasitic- Gregarious- Intolerance!' He beams proudly.". bp_verse4 suggests bp_poemover. bp_verse4 summons bp_dontinterrupt.

Instead of greeting Progue when current episode is Word Day and we have not discussed bp_introduction: force discuss bp_dontinterrupt.

Understand "sorry" as bp_sorry when last beat is in BP. bp_sorry is an ephemeral beat in BP with keyword name "sorry" and reaction "'[']salright,' he hisses, 'Won't be a ment longer, just another word or two to get through.'". 

bp_earlybye is a beat in BP with reaction "He seems to ignore your farewell at first, but then [proguejumpboulder]". bp_earlybye enqueues bp_introduction. 

Instead of hugging Progue when current episode is Word Day and we have not discussed bp_introduction, say "You can't reach him while he's up there."

Instead of hugging Progue when current episode is Word Day and bp_introduction is spoken, force discuss bp_hug. bp_hug is an ephemeral beat in BP with reaction "You step forward with your arms spread out, but he backs up, eyes wide. 'Back! Retreat, you soul drinking spirit!' he shouts, grabbing a handful of [surface-material] and preparing to throw it. 'Not my time yet! Get back! Back!'".

Understand "word/day/now/ruining/concentrate/blather/concordance/summation/integration/proposition/elucidation/ribaldness/singularity" as bp_dontinterrupt when last beat is in BP. bp_dontinterrupt is an ephemeral beat in BP with fuse 8 and keyword name "[if last beat is bp_verse1]concordance[otherwise if last beat is bp_verse2]proposition[otherwise if last beat is bp_verse3]ribaldness[otherwise]singularity[end if]" and reaction "He does not even glance at you, but waves a hand dismissively. 'Not [t]now[x]!' he hisses. 'Not not not on [t]Word[x] Day!'". bp_notnow replaces bp_dontinterrupt. bp_dontinterrupt summons bp_notnow.

bp_notnow is an ephemeral beat in BP with keyword name "now, word" and reaction "He glances at you in annoyance. 'What, you're [t]ruining[x] it!' he hisses, as if trying to prevent something out in the ocean from hearing. 'Can't [t]concentrate[x] if you're going to pratter on like that. Go away!'". bp_notnow summons bp_poeminterrupted, bp_sorry. bp_poeminterrupted replaces bp_notnow. bp_notnow summons bp_poeminterrupted. Before discussing bp_notnow: if last beat is bp_verse4, force discuss bp_poeminterrupted instead. [This prevents us saying the above then thanking the player for not interrupting. ]

bp_poeminterrupted is a submissive beat in BP with keyword name "ruining, concentrate" and reaction "He lets out a little sigh, then turns to you with a look of beaten finality.[paragraph break]'Ah well-oh, that's it,' he says unhappily. 'Concentration broken. Vocabularizing aborted. No [bp_wordday] Day today. Hope you're well and pleased.' And with a surprising little flip, [proguejumpboulder].". bp_poeminterrupted enqueues bp_introduction. bp_wordday replaces bp_poeminterrupted.

bp_poemover is an exciting beat in BP with reaction "[if conversation fuse is 0]He glances down at you with a frown, then shrugs and lowers his hands. 'Never mind, I'm done anyway,' he says. 'Thanks for understanding. [otherwise]Satisfied, he finally turns to you with a smile. 'Thank you much for waiting,' he says, '[end if]I so do hate my [bp_wordday] Days interrupted.' And then with a surprising little flip, [proguejumpboulder].". bp_poemover enqueues bp_introduction. 

To say proguejumpboulder: say "he leaps off the top of the boulder to come crashing down in the sand at your feet. Before you can even think to start moving forward to see if he is all right, he is on his feet and standing just a pace before you".

bp_introduction is an insistent beat in BP with reaction "He pokes you [if player is male]sharply in the chest[else]on the forehead[end if]. 'I know your game,' he says disapprovingly. 'Been expecting you for quite a [bp_time], really. I'm two-thirds mad you see, at least; have been for green eons, and it's often I wonder when the other third would show up and so here you are.'[paragraph break]He folds his arms skeptically. 'So what do we do, then, eh? Flashbacks to every dark corner of my past failings? Hauntings, waking nightmares? You're my first [bp_hallucination], so I'm unclear, unsure as to the procedures and protocols.' He regards you with wary eyes.".  bp_introduction suggests bp_hallucination. bp_introduction summons bp_hallucination, bp_time. bp_introduction cancels bp_notnow, bp_dontinterrupt, bp_poeminterrupted. bp_hallucination replaces bp_introduction. After discussing bp_introduction: now bp_dontchangesubject replaces bp_dontinterrupt; now unavailable-beat of Progue is bp_dontchangesubject; continue the action.

bp_dontchangesubject is an ephemeral repeatable beat in BP with reaction "He cuts you off in annoyance. 'I'll do the asking, thank you,' he says, 'you just deal the answering for now.'".

Understand "time" as bp_time when last beat is in BP. bp_time is a beat in BP with keyword name "time" and reaction "'Years now,' he says, nodding. 'If you'd been shipwrecked or exiled or [bp_memory] as long as I have, you'd know, I'm gushing sure: funny feelings, queer twitches here and there when something's primed to happen.' He shrugs. 'Not that anything does mostly usually around here. But the Blue [bp_flash] has been trickling queer lately so I'd wondered.'". bp_time suggests bp_hallucination.

Understand "blue/flash" as bp_flash when last beat is in BP. bp_flash is a beat in BP with keyword name "Flash" and reaction "'Old maritime phoneme,' he says, pointing up to the [o]sun[x]. 'Moment suns [bp_sunset] over oceans there's sometimes a flash of blue. The one on this world seems something potent. Sometimes there's visions, premonitions, [bp_hallucination].' He glances at you critically. 'Seems I may have stared into it too long this time.'". bp_flash suggests bp_hallucination.

Understand "sink" as bp_sunset when last beat is in BP. bp_sunset is a beat in BP with keyword name "sink" and fuse 5 and reaction "'Stick around on the beach till sunset some evening,' he says airily, 'and mayhaps you'll see it.'". bp_sunset enqueues bp_hallucination.

Understand "whatever" as bp_memory when last beat is in BP. bp_memory is a beat in BP with keyword name "whatever" and reaction "He waves a hand vaguely through the air. 'Oh, you know,' he says, 'however it is that ones end up on deserted tropical islands all alone. The usual method. For [bp_hallucination] beings I mean,' he adds knowingly, 'no offense.'". bp_memory suggests bp_hallucination.

Understand "hallucination/drown/drowned/corporeal/spook/specters/specter" as bp_hallucination when last beat is in BP. bp_hallucination is an insistent beat in BP with keyword name "[if last beat is bp_memory]corporeal[otherwise if last beat is bp_alphamale]spook[otherwise if last beat is bp_flash]specters[otherwise]hallucination" and reaction "'Ratherly strange,' he says, walking in a circle around you studying you carefully. 'I assumed that you'd take the guise of some Figure From The Past, some One, if you ring, terrible important in my life, meaningful, lesson-worthy, all that.' He frowns, tilting his head to one side. 'Then again, mayhaps you have. Can't remember much about my past. Mostly usually nothing at all, to be perfect honest. You could be my own [if player is male]son[otherwise]daughter[end if] for all I know.' His eyes narrows. 'Are you?'". The yes-beat of bp_hallucination is bp_yeschild. The no-beat of bp_hallucination is bp_nochild. The maybe-beat of bp_hallucination is bp_maybechild. bp_hallucination suggests bp_maybechild. bp_alphamale replaces bp_hallucination.

bp_yeschild is a paternal beat in BP with keyword name "yes" and reaction "'Somehow I doubt it,' he says, patting your shoulder in a fatherly fashion just the same, 'but a sweet-sweet thought anyhow. Something poetic about dying mongst family. You are here to take me off to the land of the dead? No? Well but that's what you'd say anyway, isn't it. Hrmph.'". bp_yeschild enqueues bp_alphamale.

bp_nochild is an unpaternal beat in BP with keyword name "no" and reaction "He shrugs. 'Ah well-oh. Makes this less awkward then I suppose. Would have been interesting, though.'". bp_nochild enqueues bp_alphamale.

bp_maybechild is a beat in BP with keyword name "maybe" and reaction "The man's eyes narrow. 'Sausages,' he says critically, 'you're just as confused as me. Not what this island needs is more of the confused scampering about. I urge you, [animal-nickname], do please try and make only authoritative statements around here, even if you've had no idea if they're true or not. It will make things so much more the pleasant.'". bp_maybechild enqueues bp_alphamale.

Understand "word/day" as bp_wordday when last beat is in BP and bp_introduction is spoken. bp_wordday is a beat in BP with fuse 9 and keyword name "word" and reaction "'Ah yes, Word Day!' he says, spreading his arms wide and spinning in a dizzy circle. 'I try and have one semiannually or demiweekly or hemicalendrically, whichever of those it is that usually comes first. The point is, you see, to prove to the ocean that I still remember everything I used to.'[paragraph break]He puts an arm around your shoulder conspiratorially and throws a guarded glance at the waves. 'It's a bluff, though,' he whispers loudly. 'The vocabulary's doing fine, but mostly usually everything else has slipped away. Don't really remember who I am or where I got here or how I came from. But don't tell.'". bp_wordday suggests bp_hallucination. 

bp_alphamale is an insistent beat in BP with reaction "Before you can quite figure out a response, he abruptly steps back and gives you an appraising glare, lifting a long and firm finger. 'Now look now,' he says, 'I hope you don't expect my schedule, my routines, to dive in lakes just cause some shabby-dressed [bp_hallucination] has popped by. I may be two-thirds mad but I have things, essential things that must and must be done around here, and I don't want visions or phantoms or strange afterimages from the Blue [bp_flash] interfering. This is my island, I was here first, I'm in charge, everything thatwise. Are we in agreement then on that then?'". The yes-beat of bp_alphamale is bp_alphayes. The no-beat of bp_alphamale is bp_alphano. The maybe-beat of bp_alphamale is bp_alphano. bp_alphamale suggests pd_noanswer. bp_outtro replaces bp_alphamale.

bp_alphayes is a unsubmissive beat in BP with keyword name "yes" and reaction "'Good good,' he grunts, stepping up closer. 'And I ratherly hope you aren't one of these terrible teeth-gnashing woe and grime spirits, but more one of the cheerful sort. Do you think mayhaps we can make the best of this awkwardness and be friendly whilst you're about?'". bp_alphayes enqueues bp_befriends.

bp_alphano is a submissive beat in BP with keyword name "no" and reaction "'Ah,' he says, drawing back a little, 'you're one of those unpleasant sorts of hallucinations. Thought I'd seen the last of you when I stopped eating the purple sunfish. Well we shall just see who it is who haunts who. But even so, do you have the decency to be a friendly sort whilst you're about?'". bp_alphano enqueues bp_befriends.

bp_alphamaybe is a paternal beat in BP with keyword name "maybe" and reaction "He smiles a bit, tousling your hair. 'Not too quick to jump to conclusions then I see. Wise. Are we going to be friends, do you expect?'". bp_alphamaybe enqueues bp_befriends.

bp_befriends is an insistent beat in BP. bp_befriends suggests pd_noanswer. bp_befriends summons bp_friendsyes, bp_friendsno, bp_friendsmaybe. Instead of saying yes when last beat is bp_befriends, force discuss bp_friendsyes. Instead of saying no when last beat is bp_befriends, force discuss bp_friendsno. Instead of saying maybe when last beat is bp_befriends, force discuss bp_friendsmaybe.

bp_friendsyes is an affinitive beat in BP with keyword name "yes" and reaction "'There, then,' he says, nodding happily at you, 'mayhaps this won't be so unpleasant after all.'". bp_friendsyes enqueues bp_outtro.

bp_friendsno is an unaffinitive beat in BP with keyword name "no" and reaction "He raises his eyebrows skeptically. 'Delightful,' he says, 'just the kind of hallucination I deserve, really.'". bp_friendsno enqueues bp_outtro.

bp_friendsmaybe is a beat in BP with keyword name "maybe" and reaction "He cocks his head to one side. 'You're a strange one, [animal-nickname],' he says appraisingly. 'For life and strife and I'm not sure I'll like you either.'". bp_friendsmaybe enqueues bp_outtro.

bp_outtro is a terminal beat in BP with reaction "'I'll be about and aroundabout,' he says, eyeing you appraisingly, 'so whistle or shout or something thatwise if you need.' He pauses for a moment, shaking his head. 'Sausages, I'm telling my visions how to find me. Mad as a mackdaw.' He gives you one last incredulous stare, then turns and slips away with surprising speed[if location is Among the Boulders], weaving between the rounded boulders towards[otherwise] down[end if] the beach.". 



Chapter - Delayed Greeting

[ If the player just walks past Progue's boulder poetry, or never goes to investigate. Progue eventually moves on with his life, randomly walking around and doing stuff. The odds are high that the player will eventually bump into him, in which case we reframe some of Boulder Poetry to work in a new setting. ]

Delayed Greeting is a guaranteed serendipitous triggered episode. The icebreaker is bp_introduction.

Last condition rule for Delayed Greeting:
	if Word Day is failed or Word Day is expired, rule succeeds.

First commencement rule for Delayed Greeting:
	say "The strange man looks up from [Progue-animus] and frowns at you suspiciously.";
	now met_progue is true.

A completion rule for Delayed Greeting:
	now dont_describe_Progue is true;
	manually reference dc_flash;
	remove bp_flash from list of convo stuff, if present;
	print a section break;
	now the episode schedule is Table of Denial Episodes;
	now the icebreaker of Word Day is spoken; [This prevents it being put back in the queue.]
	now the unavailable-beat of Progue is pd_unavailable;
	Progue's life goes on.[aar]


Chapter - Denial Conversations

[ For each of the various activities Progue might be performing during this phase (where he thinks the player is just a hallucination), there are seperate, mostly light conversations where Progue talks airily about what's he's doing. During this stage of Progue's psyche, he carries a thread containing light, trivial answers to any questions the player has about the island. The player can learn Progue's name during this time.

Another conversation during this phrase is Denial Interrupted, if the player accosts Progue on his way somewhere. Progue will be vaguely impatient. 
 ]

Denial Dislike Convo is a serendipitous rerunnable guaranteed triggered denialy episode. The subchange beat is silence. The boredom beat is silence. The bye beat is silence. The abruptbye beat is silence. The icebreaker is dc_unfriendlyconversation.

Last condition rule for Denial Dislike Convo:
	if affinity of Progue < -1, rule succeeds.

dc_unfriendlyconversation is a repeatable beat in DenialC with reaction "'Stay back now,' [the Progue] says warningly. You remember the rule about my proximity to [dc_player] people.'".


Section - Denial Animus Convo

Denial Animus Convo is a serendipitous rerunnable guaranteed triggered denialy episode. The subchange beat is silence. The boredom beat is silence. The bye beat is silence. The abruptbye beat is silence.

Last condition rule for Denial Animus Convo: rule succeeds.

First commencement rule for Denial Animus Convo:
	ignore the Progue begins episode dialogue rule;
	pre-conversation processing;
	if the animus of Progue is fishing and a random chance of 1 in 2 succeeds begin;
		force discuss dc_fishing;
	otherwise if the animus of Progue is beach-combing and a random chance of 1 in 2 succeeds;
		force discuss dc_combing;
	otherwise if the animus of Progue is mending and a random chance of 1 in 2 succeeds;
		force discuss dc_mending; 
	otherwise if the animus of Progue is frog-catching;
		force discuss dc_frogcatching;
	otherwise;
		force discuss dc_makeconversation;
	end if.

First finishing rule for Denial Animus Convo:
	if Progue is idle, rule succeeds.

To add denial animii to tl:
	if the psyche of Progue is denial:
		remove {dc_fishing, dc_combing, dc_mending, dc_frogcatching} from list of convo stuff, if present;
		if the animus of Progue is fishing, add dc_fishing to list of convo stuff, if absent;
		if the animus of Progue is beach-combing, add dc_combing to list of convo stuff, if absent;
		if the animus of Progue is mending, add dc_mending to list of convo stuff, if absent;
		if the animus of Progue is frog-catching, add dc_frogcatching to list of convo stuff, if absent.

Understand "fishing/pole" as dc_fishing. dc_fishing is a repeatable beat in DenialC with keyword name "fishing" and fuse 9999 and reaction "[one of]'No [dc_fishingtechnique] today,' [the Progue] says breezily, tugging his line back and forth.[or]'Got one rascal keeps giving me [dc_fishingtechnique],' [the Progue] says conversationally, keeping his attention on the line, 'but doesn't want to take the bait.'[in random order]". dc_fishing summons dc_fishingtechnique. 

Understand "biting/bites" as dc_fishingtechnique. dc_fishingtechnique is a beat in DenialC with keyword name "bites" and reaction "'Very [dc_relax],' he says, nodding, 'very peaceful. Never used to do it since those idiotic [dc_crabs] are tastier and walk right into your hands, but then discovered I trickling enjoy it. Sometimes don't even bait the hook, if I'm not feeling up to doing all the cleaning.'". 

Understand "relax/relaxing/peaceful" as dc_relax. dc_relax is a beat in DenialC with keyword name "relaxing" and reaction "'I do a lot of relaxing,' [the Progue] says musingly, scratching a chin with the hand not holding the pole. 'Good [dc_island] for it.'". 

Understand "cleaning" as dc_combing. dc_combing is a repeatable beat in DenialC with keyword name "cleaning" and fuse 9999 and reaction "[one of][The Progue] picks up a misshapen hunk of fist-sized driftwood from the beach and eyes it critically. 'Such a [dc_chore], keeping it clean,' he says, turning it over in his hands. 'But a nice [dc_clean] beach is worth and worth the effort.'[or][The Progue] turns around and scans the area behind him critically, then grunts in evident satisfaction. 'So [dc_clean]; not much debris today,' he says. 'Makes my [dc_chore] easier.'[or][The Progue] wades into the surf with an armful of beach debris and tosses it far out into the surf. 'Hardly feels like a [dc_chore] today!' he says cheerfully, moving on to the next part of the beach and bending down to pluck more small imperfections from the sand.[in random order]". 

Understand "chore" as dc_chore when last beat is in DenialC. dc_chore is a beat in DenialC with keyword name "chore" and reaction "'Why do I do it?' [the Progue] says, looking offended. 'Strange question! Who'd do it other than me, eh? It's my [dc_job]. Won't clean itself, you know, oh ho no. Believe me, I've asked. Why do I do it, indeed. Hrmph!' He shakes his head at you with a little chuckle before bending down to carefully unearth a coil of mushy seaweed from the sand.".

Understand "pristine" as dc_clean when last beat is in DenialC. dc_clean is a beat in DenialC with keyword name "pristine" and reaction "'Really such a filthy place, the ocean,' he says, shaking his head sadly at the clump of detritus in his hand. 'Dead things, mostly. Seaweed, shark teeth, whale bones. Pieces and bits of fish and clams and weensy sea snails. Clumps of tree from far cold lands. All drifting, drifting till they smash a shore and turn to sand and dust.' He runs a finger delicately along a broken shell in his hand. 'Up too high, it doesn't happen, if you ring. Transformation's unfinished. Back in the sea, their journey to nothingness goes on and on.'".

Understand "job" as dc_job when last beat is in DenialC. dc_job is a beat in DenialC with keyword name "job" and reaction "'Yes, I suppose it is,' he says musingly. 'Mayhaps I was a janitor in distant pasts, before [dc_island]. Only, what a plain, unennobled word!' he adds. 'Janitor I mean. Why not [apostrophe]beautifier?[apostrophe] [apostrophe]Restorer?[apostrophe] [apostrophe]Rightener?[apostrophe] Oh yes, I like that. I am the Rightener of the Beach.' He smiles broadly.".

Understand "mending" as dc_mending. dc_mending is a repeatable beat in DenialC with keyword name "mending" and fuse 9999 and reaction "[one of]'Amazing!' [the Progue] says, looking up at you in excitement from the rags on his lap. 'Do you have any idea how long these clothes have lasted me? No, neither do I. But from the state I'd guess it's been quite some [dc_while].'[or]'A tragic rip,' [the Progue] says sadly, holding up a grey-brown piece of threadbare fabric for your inspection. 'Really, at my age I should be more careful when [dc_climbing], but when one dangles from a cliff one can't afford to worry about one's clothes, can one?' He sighs.[in random order]". 

Understand "climbing" as dc_climbing when last beat is in DenialC. dc_climbing is a beat in DenialC with keyword name "climbing" and reaction "'Oh, I'm quite some scamperer!' he says fondly, the needle momentarily forgotten. 'I suppose it's because I lost my fear of dying. Or was it my fear of flying? Hmm. Probably they both ran off with my mind somewhere. But the lack actually rings quite useful for all sorts of things: finding the best spots to view the [dc_island], getting away from the [dc_creeper], exercising. Fun too.'".

Understand "while" as dc_while when last beat is in DenialC. dc_while is a beat in DenialC with keyword name "while" and reaction "'Such a useful word, [apostrophe]while,[apostrophe] [the Progue] says, nodding. 'In its inexactitude it encompasses all possible lengths a madman sans memory could have occupied the [dc_island]. Yes, I've been here a while indeed.'". 

Understand "manta/mantas/ray/rays/rayfish/glowing/lights" as learn_rayfish_name when last beat is in DenialC. learn_rayfish_name is a repeatable beat in DenialC with fuse 9999 and keyword name "rayfish" and reaction "'Beautiful things,' [the Progue] murmurs, 'great aquatic angels. I call them rayfish, you see. Like a ray of light. Only [if story mode]inky black[else]dark[end if] instead.'". After discussing learn_rayfish_name: now rayfish is named; continue the action.

Every turn when the animus of Progue is frog-catching and Progue is regionally in Marshlands and Progue is fulfilling and caught-frog is false: if a random chance of 1 in 8 succeeds begin; now caught-frog is true; if Progue is enclosed by location, say "[one of]Suddenly, [the Progue] pounces and snakes out his hand, emerging a moment later from the splash with a small green frog encased in his fingers[or][The Progue] suddenly dives forward in a frantic tackle, belly flopping into the marsh, but then scrambles to his feet a moment later with a green frog in his hands[in random order]. [one of]'Well oh well oh,' he says to his tiny captive, 'we meet at last.'[or]'Gotcha!' he says, immensely pleased, and peering in at his tiny captive. 'Gotcha gotcha!'[cycling]"; move frog to Progue; end if. Every turn when caught-frog is true and the animus of Progue is not frog-catching: now caught-frog is false; remove frog from play.

Understand "hunting" as dc_frogcatching. dc_frogcatching is a repeatable beat in DenialC with keyword name "hunting" and fuse 9999 and reaction "[one of]'Shh!' [the Progue] says, holding up a hand in your direction. 'You'll scare the little [dc_frthem] off!'[or]'Ah,' [the Progue] says, beaming, 'come to go frog [dc_frfrog]? An excellent day for it.'[in random order]".

Understand "ones" as dc_frthem when last beat is in DenialC. dc_frthem is a repeatable beat in DenialC with keyword name "ones" and reaction "'The frogs!' he says. 'They're ratherly sensitive to noises, and footsteps, and, vibrations, and well, everything and anything really,' he says, 'poor [dc_frfrog].'".

Understand "hunting/creatures" as dc_frfrog when last beat is in DenialC. dc_frfrog is a repeatable beat in DenialC with keyword name "[if last beat is dc_frthem]creatures[otherwise]hunting" and reaction "'They like to hide down in the weeds,' he says seriously, 'in this part of the [dc_island]. They believe they're quite clever, but I've got years, years of practice. Been here a [dc_longlived] time.'". 

Section - Rainfall Rhapsody

Rainfall Rhapsody is a serendipitous rerunnable guaranteed triggered denialy episode. The icebreaker is rr_intro. The subchange beat is silence. The boredom beat is silence. The bye beat is silence. The abruptbye beat is silence.

Last condition rule for Rainfall Rhapsody:
	if raining, rule succeeds.

RR is thread. rr_intro is a beat in RR with reaction "'[one of]Ahhh[or]Perfect[or]Wonderful[at random],' [the Progue] says eagerly, [one of]throwing back his head in the rain[or]stretching out his arms[or]closing his eyes and letting the rain stream down his face[in random order]. '[one of]Nothing better than a brisk afternoon rain shower[or]I love a good rain shower[in random order].'".


Section - Interrupt-Swimming


First instead of greeting Progue when the animus of Progue is swimming  and Progue is fulfilling: say "[one of]'I'm imagining,' [the Progue] says, keeping his eyes firmly closed and a serene smile firmly on his face, 'a wonderful time before you appeared, when a man could have a relaxing [progue-time-of-day] swim without being pestered by obnoxious spirits. I wonder when such a time will come again?'[or]The strange man hums some tune quietly to himself, ignoring you.[or]Other than scissoring himself slightly farther away from you, [the Progue] makes no response.[or]'Can't hear you,' [the Progue] says, 'only the sweet songs of the fish.'[cycling]".

Section - Backseat Dooring

[This is a hinty puzzle to give the player more opportunities to get clues about the door.]

Backseat Dooring is a guaranteed urgent triggered denialy episode. The subchange beat is silence. The boredom beat is silence. The bye beat is silence. The abruptbye beat is silence. The icebreaker is bd_intro.

A condition for Backseat Dooring:
	if dph_postcolor is spoken or tomorrow-flag is true, rule fails; [Don't need this scene if player's already asked for a hint.]
	if the player is in Back Room for at least the third time and lava tunnel door is closed and Jumble is unvisited and the animus of Progue is not resting, rule succeeds.

BD is a thread.  

bd_intro is a beat in BD with reaction "'Oh! Trying to get that strange [dc_door1b] open, are you?' he asks. 'Wouldn't bother myself; hasn't been opened in years. Probably doesn't even lead anywhere.'". Check examining by name the lava tunnel door when Progue is attentive: try discussing dc_door1b instead. Check examining by name the arc of small buttons when Progue is attentive: try discussing dc_buttons instead. Check examining by name the small bands of vertical color when Progue is attentive: try discussing dc_doorcolors instead. 

Check examining by name the red band when dph_red is available: try discussing dph_red instead. Check examining by name the blue band when dph_blue is available: try discussing dph_blue instead. Check examining by name the yellow band when dph_yellow is available: try discussing dph_yellow instead. Check examining by name the black band when dph_black is available: try discussing dph_black instead. Check examining by name the white band when dph_white is available: try discussing dph_white instead. Check examining by name the green band when dph_green is available: try discussing dph_green instead.

A finishing rule for Backseat Dooring:
	ignore the episodes usually end when conversation does rule;
	if location is not Back Room, rule succeeds;
	if bd_intro is spoken and ( Progue is idle or last beat is bd_banter ) and a random chance of 1 in 5 succeeds, rule succeeds;
	if dph_postcolor is spoken or tomorrow-flag is true, rule succeeds;
	if the setting of the lava tunnel door is getting close to ltr combination of the lava tunnel door or setting of the lava tunnel door is getting close to rtl combination of the lava tunnel door, rule succeeds. [We don't want him to be around when the door gets opened.]

A completion rule for Backseat Dooring:
	if Progue is enclosed by location, say "'Well, that's enough excitement for me,' [the Progue] says. 'Best of luck!'[paragraph break]";
	post-conversation processing;
	Progue starts fishing;
	follow the Progue's motivation rule.

After pushing a lava door button when Progue is enclosed by location and psyche of Progue is denial: if Progue is idle, pre-conversation processing; force discuss bd_banter; continue the action. Instead of getting bored when current episode is Backseat Dooring: force discuss bd_banter.

bd_banter is a repeatable terminal beat in BD with reaction "'[one of]Ooh, good guess![or]Well, that's not the one I'd have pressed, but whatever,[or]I'd try pressing the whale one over and over again, just to see what happens,[or]You don't suppose those buttons have anything to do with this band of colors, do you?[or]Oh, this is exciting![or]Oh! Maybe it's a trap. I'd be careful, were I you,[or]Glad you've found a little project,[in random order]' he says.".


Section - Just Teasing

[Progue teases and pokes you. You can poke back (romantic), smile (affinitive), frown (submissive), or snarl (unaffinitive/submissive) or do nothing (unsubmissive)]

Just Teasing is a serendipitous triggered denialy episode. The icebreaker is jt_intro. The subchange beat is silence. The boredom beat is silence. The bye beat is silence. The abruptbye beat is silence.

Last condition for Just Teasing: rule succeeds.

JT is a thread. The escape clause is jt_nothing.

jt_intro is a beat in JT with reaction "'Playing explorer, are we?' [the Progue] asks, [animus-business]. 'The brave hero[if player is female]ine[end if] on the tropical [dc_island]?' He giggles and pokes you. 'My [animal-nickname], the explorer.'[paragraph break]He playfully pokes you again, and you wonder whether you should [jt_poke] him back, [jt_smile] politely, [jt_frown], angrily [jt_rebuke] him, or just do [t]nothing[x].". jt_intro suggests jt_nothing. 

Understand "poke" as jt_poke when last beat is in JT. jt_poke is a romantic beat in JT with keyword name "poke" and reaction "You wait till he moves in for his next strike, then give him a solid poke straight in the ribs, with a bit of tickle worked in. He opens his eyes wide in surprise, then laughs. 'Learn fast for a [animal-nickname],' he says. 'Think I'll ratherly enjoy having you around after all. How are you then anyway? Some [t]subject[x] you wanted to talk about?'". jt_poke cancels jt_smile, jt_frown, jt_rebuke. 

Understand "smile" as jt_smile when last beat is in JT. jt_smile is an affinitive beat in JT with keyword name "smile" and reaction "You grin and [the Progue] smiles back, but puts away his poking finger. 'How are you then anyway?' he asks. 'Something you wanted to talk about?'". jt_smile cancels jt_poke, jt_frown, jt_rebuke.

Understand "frown" as jt_frown when last beat is in JT. jt_frown is a submissive beat in JT with keyword name "frown" and reaction "'Sorries,' [the Progue] says, 'didn't mean to offend. [if the psyche of Progue is denial]You're rather fleshier than I expected I must say. Didn't think you spirits had the concept of personal space. [end if]But how are you then anyway? Something you wanted to talk about?'". jt_frown cancels jt_poke, jt_smile, jt_rebuke.

Understand "rebuke" as jt_rebuke when last beat is in JT. jt_rebuke is an unaffinitive beat in JT with keyword name "rebuke" and reaction "'Sausages,' he says in annoyance, 'just a friendly bit of fun, no need to get upended over it. Ah well-oh, was there something you wanted then?'". jt_rebuke cancels jt_poke, jt_smile, jt_frown.

jt_nothing is an unsubmissive beat in JT with reaction "He pokes you a few more times, but, failing to get a reaction, gives up and shrugs. 'Ah well-oh, how are you then? Was there something you wanted to talk about?'". jt_nothing cancels jt_poke, jt_smile, jt_frown, jt_rebuke.




Section - Denial General Convo

Denial General Convo is a serendipitous rerunnable guaranteed triggered denialy episode. The subchange beat is silence. The boredom beat is silence. The bye beat is silence. The abruptbye beat is silence. The icebreaker is dc_makeconversation.

Last condition rule for Denial General Convo: rule succeeds.

First finishing rule for Denial General Convo:
	if Progue is idle, rule succeeds.

First report greeting Progue when the psyche of Progue is denial: force discuss dc_intro instead.

dc_intro is a repeatable beat in DenialC with reaction "[The Progue] looks up from his [Progue-animus] and [if affinity of Progue >= 0]nods cheerfully. 'Good [progue-time-of-day], my hallucinatory friend!' he says good-naturedly[otherwise if affinity of Progue < -3]scowls darkly. 'What do you want?' he asks[otherwise if affinity of Progue < 0]regards you warily. 'Good [progue-time-of-day], [t]spirit[x],' he says cautiously[end if].".

The conversation_beat of Progue is dc_makeconversation. dc_makeconversation is a beat in DenialC.

Check discussing dc_makeconversation:
	let beatlist be {dc_chat1, dc_chat2, dc_chat3, dc_chat4, dc_chat5};
	remove the list of spoken beats from beatlist;
	sort beatlist in random order;
	if the number of entries in beatlist is at least 1, force discuss entry 1 of beatlist instead;
	else force discuss dc_chat5 instead.

dc_chat1 is an insistent beat in DenialC with reaction "'I'm curious,' [the Progue] says, [attitude-business], 'have you been a professional [dc_player] long? Fairly unrespectable line of work, isn't it?' He narrows his eyes.". The yes-beat of dc_chat1 is dc_chat1yes. The no-beat of dc_chat1 is dc_chat1no. The maybe-beat of dc_chat1 is dc_wishywashy. dc_chat5 replaces dc_chat1.

dc_chat1yes is an insistent beat in DenialC with keyword name "yes" and reaction "[dc_chat1clarify].". dc_chat1no is an insistent beat in DenialC with keyword name "no" and reaction "[dc_chat1clarify]". To say dc_chat1clarify: say "He turns his head sideways. 'Was in that in response to the [dc_chat1first] question or the [dc_chat1second]?' he says". dc_chat1yes summons dc_chat1first, dc_chat1second. dc_chat1no summons dc_chat1first, dc_chat1second.

Understand "first/both" as dc_chat1first. dc_chat1first is a beat in DenialC with keyword name "first" and reaction "He grunts. '[if dc_chat1yes is spoken]You don't seem very good at it[otherwise]Would explain why you aren't very good at it[end if].'". dc_chat1first enqueues dc_chat1questions. dc_chat1first cancels dc_chat1second.

Understand "second" as dc_chat1second. dc_chat1second is a beat in DenialC with keyword name "second" and reaction "He [if dc_chat1yes is spoken]nods sagely. 'At least you can admit it,' he says[otherwise]clucks in disapproval. 'Seems rather sketchy to me,' he says[end if], 'but whatever keeps you in meat, I suppose.'". dc_chat1second enqueues dc_chat1questions. dc_chat1second cancels dc_chat1first.

dc_chat1questions is an insistent beat in DenialC with reaction "'Terrible sorries for the confusion,' he adds, [animus-business]. 'I always ask too many questions at once. Comes from talking to things like the ocean which don't answer back. It may not be healthy. Is it, do you suppose? Should I stop? Does it matter since there's no one to talk to anyway?' He narrows his eyes at you, and barks, 'Well?'". dc_chat1questions summons dc_chat1ending. The yes-beat of dc_chat1questions is dc_chat1ending. The no-beat of dc_chat1questions is dc_chat1ending. The maybe-beat of dc_chat1questions is dc_chat1ending.

dc_chat1ending is a beat in DenialC with keyword name "yes, no, and shrug" and reaction "He waves a hand at you. 'Only fooling,' he says, [attitude-business]. 'Carry on with whatever it was you were jabbering about or looking for or whatever.'".

dc_wishywashy is a repeatable dogged beat in DenialC with keyword name "shrug" and reaction "[one of]'Oh, I dislike that,' [the Progue] says sternly. 'Either hold an opinion and stick to it or stay at home and don't bother the world with your wishy-washy indecisiveness. Now which is it?'[or][The Progue] rolls his eyes. 'Can't have a conversation like that,' he says, 'or we'll never get anywhere. Can you not decide or do you just not care?'[in random order]".

dc_chat2 is an insistent beat in DenialC with reaction "'So how is the corporeal world finding you? Is this dimension meeting your satisfaction? Do you [dc_player] prefer the remote island [dc_likeithere] or are you more [dc_dontlike] gloom and graveyard types?' [the Progue] asks [if the affinity of Progue > 0]breezily[otherwise]skeptically[end if], [animus-business].". dc_chat2 summons dc_likeithere, dc_dontlike. dc_chat5 replaces dc_chat2.

Understand "paradise" as dc_likeithere. dc_likeithere is a beat in DenialC with keyword name "paradise" and reaction "[The Progue] nods in satisfaction. 'Good,' he says. 'Glad you like my [dc_island]. Sun, sea, air; what more could a physical being want?' He smiles, [animus-business], then takes a deep breath and exhales with gusto. 'Well, other than things to do, physical companionship, a sense of purpose, civilization, art, history, memory, and some sort of identity.'".

Understand "urban" as dc_dontlike. dc_dontlike is a beat in DenialC with keyword name "urban" and reaction "'Oh?' [the Progue] asks, nonplussed. 'Well, a pity. Mayhaps your next assignment will be more to your liking. Although,' he adds, looking around and then leaning forward conspiratorially, 'this [dc_island] isn't entirely without macabre. There's the [dc_creeper], of course, and those mysterious little [dc_girls]; whatever happened to them? Haven't spied them around for green eons.'".

dc_chat3 is a beat in DenialC with reaction "'You seem to be doing quite some wandering around for a [dc_player],' [the Progue] says skeptically. 'I always assumed your kind spends most of its time floating and flying and trying to lend me a scare. And you're a good deal less transparent than I'd expected.' He frowns. 'Hmm.[last-ep-msg-denial]' he adds.". dc_chat5 replaces dc_chat3.

[dc_chat4 is a beat in DenialC with reaction "'Have you taken a dip in the hot spring yet?' [the Progue] says, [attitude-business]. 'Just poke through the vegetation at the top of the rise. Sublime. Of course,' he adds sadly, 'mayhaps a [dc_player] entity like you can't enjoy such things. My condolences, if so.'". dc_chat5 replaces dc_chat4.]

dc_chat4 is a beat in DenialC with reaction "'[one of]Oh[or]Ah[or]Ha[at random]! There you are.[last-ep-msg-denial]' he says, [animus-business]. 'So and seen the Blue [dc_flash] yet? Best way to spend a sunset on the beach, asking myways,' he says.". dc_chat5 replaces dc_chat4.

[Once we've run out of chats, go with this next one.]

dc_chat5 is a repeatable beat in DenialC with reaction "'[one of]Still here?[or]Height of the [progue-time-of-day] to you![or]Greetings again![or]Enjoying the [progue-time-of-day]?[in random order][last-ep-msg-denial]' [the Progue] says, [attitude-business].".

[This creates some illusion that Progue has a medium-term memory and recalls what the last important conversation with the player was about.]

To say last-ep-msg-denial:
	if last episode is Sleepless Rayfish Encounter, say " Hope you're rested up after your night swim with the rayfish,";
	if last episode is Just Teasing, say " Promise I won't poke you this time,";
	if last episode is Backseat Dooring, say " Sure as sure you'll get through that mysterious door before long,";
	if last episode is Rainfall Rhapsody, say " That was quite some rainstorm we had,";
	if last episode is Play Catch, say " Won't try to lob any more konokuk fruits at you, really,";
	if last episode is Make-Way, say " Didn't mean to almost bowl you over by the rise earlier,";
	if last episode is Hey That's Mine, say " No hard feelings about the pendant, I hope,";
	if last episode is Art Critic, say " I've mostly really forgotten all about that terrible sculpture by the volcano, really I have,";
	if last episode is Tending-to-Wounded-Player, say " Your leg's feeling better I hope? Excellent,".



Section - Denial Interrupted

[If we interrupt Progue on his way somewhere, we get a slightly different segue into the normal Denial Conversation. Progue is anxious to move on and will do so if the player gives him a moment.]

Denial Interrupted is a serendipitous rerunnable guaranteed triggered denialy episode. The subchange beat is silence. The boredom beat is silence. The bye beat is silence. The abruptbye beat is silence. The icebreaker is di_1.

The allow Denial Interrupted rule is listed before the Progue is chattier the more he likes you rule in the condition rules [which is also before the Progue doesn't like to be interrupted rule]. A condition rule for Denial Interrupted (this is the allow Denial Interrupted rule): if we are greeting and the animus of Progue is not resting and the animus of Progue is not swimming and Progue is wishing, rule succeeds.

di_1 is a repeatable beat with reaction "[The Progue] [one of]comes to a halt[or]stops[at random] and [if affinity of Progue < 0]flashes you a look of minor annoyance. 'Flagging me down now, eh?'[otherwise]gives you a cheerful wave. 'Fine day for [animus of Progue], isn't it?'[end if] he says. 'What can I do for you?'". di_1 suggests di_leave. 

di_leave is an exciting repeatable terminal beat with fuse 9999 and reaction "'[one of]Well, I must be off[or]It's been fun, but I've got to go[or]I'll see you later[in random order],' [the Progue] says, [if affinity of Progue > 0]flashing a smile[else]looking pointedly away[end if]. '[one of]Insanity to get on with, all that[or]Things to do, more things to see[or]Busy schedule today[or]Lots going on, you know[in random order]. Enjoy your [progue-time-of-day]!'".




Chapter - Play Catch

[ This episode is triggered by the player arriving within eyesight of North Beach. Progue is up in a konokuk tree. He shouts for the player to come closer. (Ignoring him is submissive). Upon arrival in North Beach, there is a moment of banter (where the player can learn the name konokuk) and then Progue says to not move, but catch a fruit. The fruit is described as plummeting rather quickly. The player has 2 options: move to catch it (paternal), or don't try to catch it (unpaternal). Afterwards Progue shows the player how to open one and the conversation can shift into a default one.
]

Play Catch is a instant triggered uncommon denialy episode. The meeting place is North Beach. The icebreaker is pc_intro. The expiration date is 1 hours. The bye beat is pc_dodge. The abruptbye beat is pc_dodge. The subchange beat is pc_subchange.

pc_subchange is an ephemeral beat with reaction "There's not really any time for that right now."

Last condition for Play Catch:
	if we are not going, rule fails;
	if Progue is enclosed by location, rule fails;
	if location is in Center Beach and former location is Hut, rule succeeds;
	if location is South Beach and former location is Fork, rule succeeds;
	if location is Rise and former location is not North Beach and Progue is not regionally in North Island and Progue is not regionally in Marshlands, rule succeeds;
	rule fails.

A commencement rule for Play Catch:
	now dont_describe_Progue is true;
	move distant-Progue to location;
	add some konokuk;
	say "Off by the [if location is Rise][d]beach[x] below you[else]beach near the [d]rise[x][end if], one tree shakes madly, green fronds waving as something moves around inside it. Suddenly [the Progue] sticks out his head from the tree, spots you, and waves madly.[paragraph break]'Spirit!' he shouts faintly, 'over here! Quickly!'".

Every turn when current episode is Play Catch and pc_intro is unspoken and North Beach is Proguevisible and location is not North Beach and location is not Ocean Waters: say "The tree near the [d][if location is Rise]beach[else]rise[end if][x] continues to shake. '[one of]Hurry[or]Come on[or]What's waiting[in random order]!' [the Progue] calls, '[one of]get over here[or]come here[at random]!'".

First finishing rule for Play Catch:
	ignore the episodes usually end when conversation does rule;
	if the number of spoken terminal beats in PC > 0:
		if the animus of Progue is player-seeking, now Progue is wishing;
		now current episode is Denial General Convo;
		now Progue is attentive;
		now tempfuse of dc_konokuk is 5;
		now tempfuse of dc_player is 5;
		now Play Catch is successful;
		if there is a eptitle of Play Catch in episode schedule:
			choose row with a eptitle of Play Catch in episode schedule;
			blank out the whole row;
			sort episode schedule in random order;
		consider the completion rules for Play Catch.
		
Instead of examining distant-Progue when current episode is Play Catch, say "All you can really make out is a distant konokuk tree that's thrashing around like mad.".

A completion rule for Play Catch:
	if Play Catch is expired:
		Progue is more submissive;
		now icebreaker of Play Catch is spoken. [to prevent reruns.]

Table of Progue's Initial Appearance (continued)
animus	episode			desc
--		Play Catch	"[The Progue] is up in the tree, which sways madly."

PC is a thread. The escape clause is pc_catch.

pc_intro is a beat in PC with reaction "'There you are,' [the Progue] says from his elevated perch, pushing aside green fronds to get a glimpse of you. 'Just harvesting a few of these delicious konokuk fruits. Now, don't move. Stay right there.'[paragraph break]There is a further rustling in the trees, and suddenly a hairy brown fruit the size of your head and looking hard as a rock is plummeting down towards you. You could probably [pc_catch] it, but it might be wiser to [pc_dodge].". pc_intro suggests pc_dodge. Instead of taking tree-konokuk when last beat is pc_intro, force discuss pc_catch. Rule for supplying a missing noun when taking and last beat is pc_intro: change noun to tree-konokuk.

Understand "dodge" as pc_dodge when last beat is in PC. pc_dodge is an unpaternal terminal beat in PC with keyword name "dodge" and reaction "You leap to one side just as the hairy cannonball plummets into the sand near your feet, leaving a sizable impact crater.[paragraph break][catchbit].'[paragraph break]He shimmies down the tree and jumps lightly to the sand. 'But sausages, I forgot; you're [dc_player], you can't touch our crude physical matter!' he says, reaching out a hand to help you up and apparently not noticing the contradiction. 'Means you probably won't be able to enjoy any of this delicious [dc_konokuk] either, pity pity.' He breaks one of the fruits open and begins devouring the pink-white flesh inside.". pc_dodge cancels pc_catch.

To say catchbit: say "'Catch!' [the Progue] shouts helpfully from above. 'No, wait a ment, that's wrong as wrong. Shout first, then throw, yes yes, that's it. Throw first then shout is for war".

Understand "catch" or "catch fruit" or "catch konokuk" as pc_catch when last beat is in PC. pc_catch is a paternal insistent beat in PC with keyword name "catch" and reaction "You look up at the plummeting hairy cannonball and hold up your hands, but [if sunup]the sun glares in your eyes and...[otherwise]trip on the unevenly lit beach and...[end if][paragraph break]With a noise like a hollow plonk, the konokuk fruit smacks into your head, sending you backwards onto the sand with stars radiating out from your vision.[paragraph break][catchbit]. Terrible sorries!' he shouts down at you. 'Dear oh dear oh, spirit, are you all right?'". pc_catch suggests pc_notokay. Instead of going or landmark-going when last beat is pc_catch, say "You're still too dazed to go anywhere.". The yes-beat of pc_catch is pc_okay. The no-beat of pc_catch is pc_notokay. pc_catch summons pc_okay, pc_notokay. pc_notokay replaces pc_catch. pc_catch cancels pc_dodge.

pc_notokay is a beat in PC with keyword name "no" and reaction "[The Progue] shimmies down the tree as you sit up weakly, stars still swarming through your vision. He bounds over to your side and examines your head critically. 'Quite a red hill you've got there,' he shouts, as if not realizing you're much closer now, 'my most gushing of apologies. Thought the thing would go right through, being noncorporeal and all.'". pc_notokay enqueues pc_trans.

pc_okay is a terminal beat in PC with keyword name "yes" and reaction "'Splend and charm,' he says, shimmying down the tree as you rub a swelling goose egg tenderly, 'just as my theories theorized; solid objects should pass right through you [dc_player] entities.'". 

pc_trans is an insistent beat in PC with reaction "'Well and look here now!' he says, picking up the fruit in delight; it's split in two, revealing delicate pink-white flesh inside. 'Why you've discovered a new way to open a [dc_konokuk]. Mayhaps you could stay right there and I could throw a few dozen more down, eh?'". The yes-beat of pc_trans is pc_masochist. The no-beat of pc_trans is pc_notmaso. pc_trans suggests pc_masochist. pc_notmaso replaces pc_trans.

pc_notmaso is a terminal beat in PC with keyword name "sure" and reaction "'Only fooling,' he says with a wild grin, 'turtles work much better for that anyway, have my words.'".

pc_masochist is an unsubmissive beat in PC with keyword name "no". pc_masochist enqueues pc_notmaso.


Chapter - Ring of Truth

[ Progue asks to see the player's ring from Rume. The player doesn't know Progue that well yet, so it's an exercize in trust. Letting Progue see the ring is affinitive; refusing is unaffinitive. ]

Ring of Truth is an uncommon serendipitous triggered denialy episode. The expiration date is 3 hours. The icebreaker is rot_intro.

Last condition for Ring of Truth:
	if player holds Rume's bracelet, rule succeeds.

A completion rule for Ring of Truth:
	Progue's life goes on.

ROT is a thread. The escape clause is rot_cantkeep.

rot_intro is a beat in rot with reaction "'Ah, there you are,' [the Progue] says, [attitude-business]. 'Been looking. I remembered what it was I wanted to ask you about earlier. That bracelet of yours-- something about it's getting me upended. Can't get a grip on it. Can I hold it for a span, see if I can fly what it is I'm reminded of?' He holds out his hand.". The yes-beat of rot_intro is rot_yes. The no-beat of rot_intro is rot_no. rot_intro suggests rot_no.

rot_yes is an affinitive insistent beat in ROT with keyword name "yes" and reaction "You pull the bracelet off and hand it carefully to [the Progue], who takes it and studies it carefully, holding it up to the light and twirling it in his fingers, running them delicately over the texture of the grain.[paragraph break]'Curi-curious,' he muses, 'almost familiar somehow. Mayhaps she had one like this or something thatwise. Mayhaps-- mayhaps I made one for---?'[paragraph break]He shakes his head, then grins disarmingly, the memory seemingly vanished. 'I'm bats at noon,' he says, 'no idea. Pretty pretty thing, true too. Excellent manshippage. Can I keep it?'". The yes-beat of rot_yes is rot_cankeep. The no-beat of rot_yes is rot_cantkeep. rot_yes suggests rot_cantkeep.

rot_cankeep is a romantic terminal beat in ROT with keyword name "yes" and reaction "'Splend and charm,' he says brightly, slipping it into a pocket, 'aren't you a kind one. I'll take great cares with it, [animal-nickname], lie assured. Well and I don't intend to distract you from your business. Be well now!'". After discussing rot_cankeep: remove Rume's bracelet from play; dis Rume a lot; continue the action.

rot_cantkeep is a terminal beat in ROT with keyword name "no" and reaction "'Just asking,' [the Progue] says, placing it back in your hand, 'just asking, no need to get upended. Pretty as pretty thing is all. Remembers me of something but for life and strife I can't think of what. Ah well-oh. Didn't mean to distract from your business!' He smiles broadly and claps you on the back. 'Be well now!'".

rot_no is an unaffinitive terminal beat in ROT with keyword name "no" and reaction "'Ah well-oh,' he says, disappointed. 'Would have gushing taken care of it, you know. Just wanted a look. Well and nothing to get upended over. Remembers me of something is all. Didn't mean to distract from your business! Be well now!'".


Chapter - Make-Way

[ This is a quick submissive/unsubmissive scene. As the player is going either from Rise to North Beach or vice versa, they pass Progue on the way and have a chance to either force him to make way (submissive) or step aside to let him pass (unsubmissive).]

Make-Way is an instant uncommon triggered denialy episode. The icebreaker is mw_intro.

Last condition for Make-Way:
	if night, rule fails;
	if we are not going, rule fails;
	if location is Rise and former location is North Beach and ( Progue is regionally in Marshlands or Progue is regionally in North Island ) , rule succeeds;
	if location is North Beach and former location is Rise and ( Progue is regionally in Beachfront or Progue is in Progue's Domain or Progue is in Ocean Waters ) , rule succeeds;
	rule fails.

First commencement rule for Make-Way:
	now dont_describe_Progue is true;
	now the animus of Progue is ruminating;
	summon Progue to location;
	now Progue is attentive;
	force discuss mw_intro.

First completion rule for Make-Way:
	if former location is North Beach, summon Progue to South Beach;
	otherwise summon Progue to North Marsh;
	now the animus of Progue is hand-standing;
	Progue's life goes on, as before.

MW is a thread. The escape clause is mw_dodge.

mw_intro is a beat in MW with reaction "Suddenly [the Progue] barrels towards you, balancing a huge armful of [if konokuk trees are named]konokuk[otherwise]hairy brown[end if] fruits and heading for the path [if former location is North Beach]down[else]up[end if] the rise. 'Look out!' he shouts, 'coming through!' If you don't [mw_dodge], he's going to have a [mw_problem].". mw_intro suggests mw_problem.

Understand "dodge" as mw_dodge when last beat is in MW. mw_dodge is an unsubmissive terminal beat in MW with keyword name "dodge" and reaction "You jump to one side, only just keeping your balance on the edge of the lava flow, as Progue tumbles [if former location is North Beach]down[else]up[end if] the path, barely but somehow managing to keep the fruits balanced. 'Close as close!' he shouts back, 'thanks!' and is gone.".

Understand "problem" as mw_problem when last beat is in MW. mw_problem is a submissive terminal beat in MW with keyword name "problem" and reaction "Annoyed, you stand your ground, forcing [the Progue] to veer wildly around you. The armful of fruits go flying, bouncing noisily [if former location is North Beach]down the face of the lava flow to plunk noisily into the sand below[otherwise]off the face of the lava flow and rolling gently across the sand nearby[end if] as he watches sadly.[paragraph break]'Dear oh dear oh,' he mutters, moving to gather them up, 'terrible sorries, [animal-nickname], just didn't see you there. Not used to things being there if you ring.' And with a quick nod of the head is gone.".


	


Chapter - Watching For Signs

[ This conversation, triggered after the player has had a few dreams, triggers an oblique warning from Progue about the dangers of the trees. ]

[
Watching For Signs is a scene. Watching For Signs begins when ( the psyche of Progue is suppression or the psyche of Progue is uncertainty ) and Progue is in the location and The-Mysterious-Door is solved and time for a common scene.

When Watching For Signs begins:
	if Progue is wishing begin; [ he's on his way somewhere ]
		now Progue is attentive;
		now Progue is fulfilling;
		say "Progue gives you a [if the affinity of Progue > 0]friendly[otherwise]curt[end if] nod, but then stops and stares at you suspiciously.";
	otherwise;
		say "Progue looks up at you with a [if the affinity of Progue > 0]friendly[otherwise]curt[end if] nod, but holds his gaze for a long moment before frowning suspiciously.";
	end if;
	try greeting Progue.

After greeting Progue during Watching For Signs, force discuss wfs_intro.

WFS is a thread.

wfs_intro is a terminal beat in WFS with reaction "'Been sleeping well?' he asks gruffly. {Progue proceeds to ask about your dreams, then warn you obliquely to be careful. 'This island may not be as empty as it seems,' he says. 'Make sure you know which thoughts are yours. Make sure you do only what you intend.' He refuses to elaborate, but walks off with a suspicious glance.}". 

Watching For Signs ends when Progue is idle.

When Watching For Signs ends: Progue's life goes on, as before.
]


Chapter - Sleepless Rayfish Encounter

[ This is a scene that happens if the player is wandering at night. It's an example of Progue sharing one of his semi-private rituals with the player. This is Progue-dominated, although we can get him to drop some tantalizing hints about his past if we want. ]

Sleepless Rayfish Encounter is a triggered common denialy episode with summary "swimming with the rayfish under the stars".

Last condition rule for Sleepless Rayfish Encounter:
	if night and
	location is regionally in Beachfront and
	former location is not regionally in Beachfront and
	we are going,
	rule succeeds.

A commencement rule for Sleepless Rayfish Encounter:
	now Progue is awake;
	now dont_describe_Progue is true;
	summon Progue to a random room in Tiderooms;
	now the animus of Progue is swimming;
	now the activity counter of Progue is -50;
	say "Out in the lagoon, amongst the weaving, bobbing lights, stands a dark [o]figure[x].";
	move distant-Progue to location.
	
A finishing rule for Sleepless Rayfish Encounter:
	if Progue is not regionally in Tiderooms, rule succeeds.


Table of Progue's Initial Appearance (continued)
animus	episode			desc
--		Sleepless Rayfish Encounter	"[one of][The Progue] stands waist deep in the water, staring the the moving lights with a quiet smile[or][The Progue] swims gracefully among the rayfish[stopping]."

SWTR is a thread. 

Every turn when current episode is Sleepless Rayfish Encounter and Progue is enclosed by location and we have not discussed swtr_intro: pre-conversation processing; now tempfuse of swtr_intro is 4. swtr_intro is an exciting beat in SWTR with reaction "As you approach, [the Progue] half turns his head to see you, then grunts to look back at the swirling lights.[paragraph break]'So beautiful,' he murmurs, staring at the glowing creatures silently gliding by around you. 'Some nights I can't sleep. They help. Helpers. I call them rayfish.'[paragraph break]He wades forward into the ocean, and swims away, alongside the great graceful creatures.". After discussing swtr_intro: now rayfish is named; post-conversation processing; continue the action.

First instead of greeting when current episode is Sleepless Rayfish Encounter: say "[The Progue] doesn't respond; his eyes are locked on the rayfish." instead.

Instead of vague swimming when current episode is Sleepless Rayfish Encounter: say "You dive forward, half afraid and half excited, and in a moment you two are swimming amongst the creatures.

All is strangely silent. You and [the Progue] do not speak, but stay together, floating or swimming alongside the graceful glowing mantas as they glide noiselessly through the lagoon.  Once you reach out to touch one and feel its silky-smooth skin brush past your finger. But then it startles, and darts away, leaving behind a cloud of dense black ink.

At some point you realize [the Progue] has slipped away. Contented, you return to shore, wet but warm in the dense tropical night air."; summon Progue to Stumps; Progue starts resting; move player to South Beach.



Chapter - Shocking Revelation

[ Progue moves into the "fear" psyche when he finally realizes that the player is really there, not just a hallucination. This happens automatically if the player gets through the lava tunnel door (since Progue no longer remembers how to open it), or if the player breaks a leg and Progue rescues him. The player can also be proactive in bringing this about by taking drastic physical action with Progue: either punching him (submissive) or kissing him (romantic).

In either case, the player needs to repeat the command several times to indicate their seriousness about going through with the action: this is to prevent just a casual attempt from skipping past some of the good stuff in the denial stage. If we confirm, we segue into the Discovering the Open Door convo. ]

Instead of kissing Progue when the psyche of Progue is denial and current episode is not Discovering the Open Door: if Progue is idle, pre-conversation processing; force discuss sr_kiss1.[aar]

sr_kiss1 is a dogged beat in DenialC with reaction "He leans deftly back. 'Whoah there, my [animal-nickname],' he says with a chuckle. 'Let's just wait to get to know each other a little better first, eh?' He waits nervously to see if you will try [t]again[x] or say [t]nothing[x].". sr_kiss2 replaces sr_kiss1. sr_kiss1 suggests sr_kissclear.

sr_kiss2 is a dogged beat in DenialC with reaction "'Now really,' [the Progue] says, leaping back as you step forward again, 'it's not that I'm not gushing flattered, [if player is male]my boy[else]darling[end if], but that's not the sort of hallucination I expected to be expecting just now, if you ring.' As he babbles, though, you can see something strange in his eyes, some curdling combination of desire and a growing terror as he waits for you to try [t]again[x] or change the [t]subject[x].". sr_kiss3 replaces sr_kiss2. sr_kiss2 suggests sr_kissclear.

sr_kiss3 is a romantic beat in DenialC with reaction "You lean forward. 'What in the--' is as far as he has time to get before you've planted a firm kiss on his lips. His eyes open wide in astonishment, or perhaps something else, but then...[paragraph break]He leaps backwards, suddenly in a panic, face flushing red. 'But what... how... I haven't... been so long since...' He raises a hand and touches them to his lips, eyes momentarily dissolved into some distant memory.". sr_kiss3 enqueues sr_shocking. sr_shocking replaces sr_kiss3.

sr_kissclear is a repeatable dogged beat in DenialC. After discussing sr_kissclear: now sr_kiss1 is unspoken; now sr_kiss2 is unspoken; continue the action.

Before attacking Progue when the psyche of Progue is denial:
	if current episode is Word Day and we have not discussed bp_introduction begin;
		say "He's up too high for you to reach him." instead;
	otherwise if animus of Progue is swimming or animus of Progue is hottubbing;
		say "It's a little awkward to start a fight in the water." instead;
	otherwise if the animus of Progue is resting;
		say "It's a little unsporting to do that while he's asleep." instead;
	otherwise if current episode is Discovering The Open Door or last beat is in DTOD;
		say "It looks as if you've already unsettled him quite enough." instead; 
	otherwise;
		if Progue is idle, pre-conversation processing;
		force discuss sr_hit1 instead;
	end if.

sr_hit1 is a annoying dogged beat in DenialC with reaction "You take a swing at [the Progue], but he dodges lithely out of the way, does a neat roll on the [surface-material], and comes up with his fists raised. 'Oh ho, so you're an angry spirit, are you?' he asks with glee, bouncing back and forth from foot to foot. 'Haven't been in a good fight since that walrus attack. You try anything like that [t]again[x], I'll sock you a good one!' He lowers his hands a little. 'Or we can change the [t]subject[x], if you prefer. It's too hot for fighting really.'". sr_hit2 replaces sr_hit1. sr_hit1 suggests sr_hitclear.

sr_hit2 is a dogged beat in DenialC with reaction "You step closer and take a harder swing, but [the Progue] twists aside and then uppercuts your face.[paragraph break]'Ahh!' he cries out, clutching his hand and staggering back. 'That hurt! I thought you hallucinations were meant to be insubstantial, lighter than air, all that!' But he looks at you now with a hint of something growing in his eyes, waiting for you to advance yet [t]again[x] or back off and do [t]nothing[x], some spark of terror on the verge of kindling.". sr_hit3 replaces sr_hit2. sr_hit2 replaces sr_hitclear.

sr_hit3 is a beat in DenialC with reaction "You strike him hard across the face. His expression turns to shock as he lifts a hand to the white mark left there. He stares at you in a kind of growing horror.". sr_hit3 enqueues sr_shocking.

sr_hitclear is a repeatable dogged beat in DenialC. After discussing sr_hitclear: now sr_hit1 is unspoken; now sr_hit2 is unspoken; continue the action.


Chapter - Discovering the Open Door

[ The player should almost inevitably encounter Progue during the Boulder Poetry scene, Delayed Conversation, or Tending-to-Wounded-Player. It is likely that you will figure out how to snap Progue out of his denial phase; however if you don't, either by accident or design, Progue needs to figure this out on his own eventually. Once the player has solved the first puzzle, Progue will discover the open door and realize the player is really there... thus triggering a scene that transitions him to the fear stage. 


]

Discovering the Open Door is a triggered guaranteed instant rendezvous episode. The subchange beat is dtod_farewell. The bye beat is dtod_farewell. The abruptbye beat is dtod_farewell. The boredom beat is dtod_irrelevant. The icebreaker is dtod_intro. The meeting place is Back Room.

Last condition rule for Discovering the Open Door:
	if location is Jumble, rule succeeds.

Every turn when current episode is Discovering the Open Door and dtod_intro is unspoken (this is the position Progue for Discovering the Open Door rule):
	if location is North Beach or location is South Beach begin;
		move Progue to Center Beach;
		now meeting place of Discovering the Open Door is Center Beach;
	otherwise if location is Jumble;
		move Progue to Back Room;
		now meeting place of Discovering the Open Door is Back Room;
	end if.

A commencement rule for Discovering the Open Door:
	now the exhaust_beat of Progue is dtod_irrelevant;
	now the overexhaust_beat of Progue is dtod_irrelevant;
	now the randomyes_beat of Progue is dtod_irrelevant;
	now the randomno_beat of Progue is dtod_irrelevant.

A finishing rule for Discovering the Open Door:
	if dtod_intro is spoken and Progue is idle, rule succeeds.

A completion rule for Discovering the Open Door:
	now dont_describe_Progue is true;
	if location is Back Room begin;
		now wooden cube is Progue-disturbed;
		now the current page of sketchbook is 4;
		move Progue to North Beach;
	otherwise;
		move Progue to Rise;
	end if;
	now the psyche of Progue is fear.


Table of Progue's Initial Appearance (continued)
animus	episode			desc
--		Discovering the Open Door		"[The Progue] stands [if location is Center Beach]just outside the cabin[otherwise]near the exit to the front room[end if], watching you incredulously[if location is Back Room] as you step through the door[end if]."

DTOD is a thread. The escape clause of DTOD is dtod_irrelevant.

Before discussing dtod_intro when we-are-landmark-going is true:
	if location is Back Room, say "As you pass through the lava tunnel door into the back room of the cabin, [the Progue] blocks your way.";
	tidy landmark-go;
	clean up landmark-go, silently.

Instead of attacking or pushing or hugging or kissing Progue when current episode is Discovering the Open Door: say "Not now.".

dtod_intro is an insistent beat in DTOD with reaction "'You opened it!' he says in an astonished stammer. 'This old door-- but how-- [if location is Back Room]' he runs a hand across the front, lightly across the buttons. '[end if]I could never remember--' His eyes widen, and he steps back from you in shock.[paragraph break]'You-- you're really here, aren't you? But-- but how?'". After discussing dtod_intro: now met_progue is true; continue the action. dtod_intro summons dtod_call, dtod_shrug, dtod_swam. dtod_intro suggests dtod_shrug. The maybe-beat of dtod_intro is dtod_shrug. Before discussing dtod_intro: repeat with item running through available beats begin; unless item is dtod_intro, now tempfuse of item is 0; end repeat; continue the action.

sr_shocking is an insistent beat in DTOD with reaction "His eyes widen, and he steps back from you in shock. 'You-- you're really here, aren't you?' he stammers. 'But-- but how?'". sr_shocking summons dtod_call, dtod_shrug, dtod_swam, dtod_spaceship. sr_shocking suggests dtod_shrug. The maybe-beat of sr_shocking is dtod_shrug. [Alternate entry point.] After discussing sr_shocking: now dtod_intro is spoken; now current episode is Discovering the Open Door; now the exhaust_beat of Progue is dtod_irrelevant; now the overexhaust_beat of Progue is dtod_irrelevant; now the randomyes_beat of Progue is dtod_irrelevant; now the randomno_beat of Progue is dtod_irrelevant; continue the action. dtod_flee replaces sr_shocking.

Understand "swam" as dtod_swam. dtod_swam is a dogged beat in DTOD with keyword name "swam" and reaction "His eyes narrow. 'No,' he says, 'no no no. Too far. I tried once, to get to the cliffs to the east. You're liaring, you liar. I tried. Too far. The truth, tell me the truth, tell me.'". dtod_swam suggests dtod_figureout. 

Understand "spaceship" or "space ship" as dtod_spaceship. dtod_spaceship is a dogged beat in DTOD with keyword name "spaceship" and reaction "'That's an unrhymable story,' he says, 'I would have heard you land. Nonsuss. Prepostersense. Give me the real reason.'". dtod_spaceship suggests dtod_figureout.

dtod_shrug is a dogged beat in DTOD with keyword name "shrug" and reaction "He blinks rapidly. 'But you must have-- unless-- could I have opened the door? Remembered, combination springing up after all these--' He paces back and forth, running his face over his hands, then whirls on you. 'No,' he says, 'I refuse. You must be here. Now tell me. Tell me how.'". dtod_shrug suggests dtod_figureout. dtod_figureout replaces dtod_shrug.

dtod_figureout is a beat in DTOD with reaction "Suddenly he stiffens, and stands straight up.". dtod_figureout enqueues dtod_foundme.

Understand "wayfaring" as dtod_call. dtod_call is a beat in DTOD with keyword name "wayfaring" and reaction "You tell him about the Call you felt, how it brought you here, your [dtod_wayfaring]. He listens in what seems to be growing horror, slowly backing farther and farther away from you.". dtod_call enqueues dtod_foundme.

dtod_foundme is a beat in DTOD with reaction "'Oh no oh no,' he says, shaking his head. 'Impossible. Terrible. It's happened. It's happened. You've found me. The [dtod_creeper].  After all this time. All this time---' He gives a crazy glance [if location is Back Room]at the door to the cabin's front room[otherwise]behind him[end if], poised to flee.". dtod_foundme suggests dtod_flee. dtod_flee replaces dtod_foundme.

Understand "wayfaring" as dtod_wayfaring when last beat is in DTOD. dtod_wayfaring is a beat in DTOD with keyword name "wayfaring" and reaction "'Stop saying that!' he shrieks, bringing hands up to claw frantically at his ears. 'Not true, impossible, I don't believe-- just lies, lies from the Creeper, stop it! Stop-- you won't take me-- not again--'". dtod_wayfaring enqueues dtod_flee.

Understand "creeper" as dtod_creeper when last beat is in DTOD. dtod_creeper is a beat in DTOD with keyword name "creeper" and reaction "'Stupid of me!' he says, quivering, 'stupid not to recognize-- been so long-- but of course you wouldn't look fearful, of course you'd try to trap, trick, treacher--". dtod_creeper enqueues dtod_flee.

dtod_flee is a terminal beat in DTOD with reaction "Suddenly he leaps [if location is Back Room]for the front door with surprising speed, flinging himself across the front room of the cabin, but he trips over the cube and sprawls into the sand drifting across the floor, limbs flopping wildly, ankles and elbows catching on the door to the beach. Before you can react he has picked himself up and tripped outside, [otherwise]backwards, and before you can stop him he is [end if]running frantically up the beach, shouting behind him, 'Alone! Alone! Leave me alo-one!'[paragraph break]And then all is silent.". 


dtod_farewell is an ephemeral repeatable beat in DTOD with reaction "[if last beat is not dtod_call]He shakes his head, blocking your way. 'Oh no oh no,' he says, 'just a ment, you mystery, you phantom, I want answers, answers first.'[otherwise]'Can't be,' he mutters, panicked, 'can't, can't, can't...'". 

dtod_irrelevant is a beat in DTOD with reaction "He shakes his head. 'Can't think,' he says, 'no sense. What, what, what can I do?'". dtod_irrelevant enqueues dtod_figureout.



Chapter - Art Critic

[Another way the player can push Progue into "fear" is by pushing the volcano sculpture off the edge]

Art Critic is a guaranteed triggered rendezvous denialy episode. The icebreaker is ac_intro.

Last condition for Art Critic:
	if volcano sculpture is off-stage, rule succeeds.

First commencement rule for Art Critic:
	if the psyche of Progue is denial, now the icebreaker of Art Critic is ac_denialintro.

AC is a thread. The escape clause is ac_destruction.

ac_denialintro is a beat in AC with reaction "'My statue!' he says. 'You-- you pushed it off the edge. Spirits don't do that. Spirits don't-- oh, oh no oh no...'". ac_denialintro enqueues sr_shocking.

ac_intro is an unaffinitive submissive beat in AC with reaction "'Are you quite pleased with yourself then?' Progue asks angrily. 'You see I didn't think to bother to put up signs reading [']don't push the statues off the edges of volcanoes['] because besides from the obvious fact that there wasn't anyone to read them until just recently, it was the sort of thing I would have expected to fall under the rubric of common decency.'[paragraph break]He folds his arms. 'Well and care to explain yourself then?' he asks. 'In the mood for a meaningless act of [ac_destruction], or have you become an art [ac_critic]?'". ac_intro summons ac_power. ac_intro suggests ac_destruction.

Understand "power" as ac_power when last beat is in AC. ac_power is a terminal beat in AC with keyword name "power" and reaction "He listens, but seems unimpressed. 'Hardly seems worth destroying a work of art for,' he says, but waves you off before you can say anything more. 'Suppose it's not important anyway; haven't been up to look at it in green eons, but...' He bites his lip, then turns away abruptly.".

Understand "destruction" as ac_destruction when last beat is in AC. ac_destruction is an unaffinitive terminal beat in AC with keyword name "destruction" and reaction "He nods. 'What I thought,' he says, 'violent. Destructive. Something thatwise. Have to keep my eye on you,' he adds darkly, 'who knows what else you might try and destroy.'".

Understand "critic" as ac_critic when last beat is in AC. ac_critic is a terminal beat in AC with keyword name "critic" and reaction "He listens incredulously, and you think he's about to strangle you. Then suddenly he bursts into a long fit of helpless laughter.[paragraph break]'No and no,' he says finally, wiping tears from his eyes in a fit of helpless giggles, 'I suppose it wasn't that good after all, was it? Amateurish in the extreme. Ah well-oh. One less crystal brick dragging me down to the abandoned past then. Nothing to get upended over. Enjoy the rest of the [Progue-time-of-day], [animal-nickname]; just try not to cause too much damage, eh?'".


Chapter - Tending to Wounded Player Conversation

[ If you do something stupid and wound yourself, Progue will find you and take you back to the hut for treatment. Since this scene could happen at nearly any point along Progue's psychological development, there are several variations, but the two biggest are:
	-- Progue has not yet gone through the fear phase, and your unconcious body is the trigger he needs to convince him you are real. He will heal you and leave you food but not stick around to talk.
	-- Progue has moved past this phase, and will wait until you wake up to have a conversation with you. This scene offers a good chance to increase Progue's paternalism number. ] 

Tending-to-Wounded-Player is a guaranteed instant triggered episode.

First condition for Tending-to-Wounded-Player:
	if chasm-jump-try is 2 or cliff-climb-try is 2, rule succeeds.

A commencement rule for Tending-to-Wounded-Player:
	move the player to Hut, without printing a room description;
	now the player is wounded;
	move the pile of fresh fruit to Hut;
	Progue feels more like a father;
	Progue is less submissive;
	print a section break;
	if the psyche of Progue is suppression or the psyche of Progue is uncertainty or the psyche of Progue is emotional begin;
		say "Waves.[paragraph break]You open your eyes. Progue is standing above you. Somewhere near your feet is a dull, throbbing pain.[paragraph break]'The bone's set,' he says simply, arms folded as he looks at you with something between annoyance and fondness. 'Now there's something I haven't done in a while. You'll be full on before long. Do try and try to be a little more careful when climbing and crawling and jumping, eh [animal-nickname]? I'm not the most credentialed of doctors.'[paragraph break]He winks and turns to leave as you slip back into sleep.[paragraph break]Some time later, you open your eyes.";
	otherwise;
		now the psyche of Progue is fear;
		summon Progue to Ledge;
		now the animus of Progue is hiding;
		say "Waves.[paragraph break]Pain ripples through you, somewhere near your feet, and definitely in your skull. But your whole body ripples, sways, and you sense dimly that someone is carrying you.[paragraph break]The voice is muttering something, repeating it. 'Can't, can't, can't be,' it sounds like. 'Real. [if player is male]H[otherwise]Sh[end if]e's real.' And then you slip beneath the surface again, where all is still.[paragraph break]Time passes, and when you breach again you're lying in comfort, and despite the hurt you can feel that someone has tended to the wound. Surf crashes somewhere.[paragraph break]You open your eyes.";
		try looking;
	end if.

A finishing rule for Tending-to-Wounded-Player:
	if location is not Hut, rule succeeds.

The pile of fresh fruit is described set dressing. The initial appearance is "Within reach of you is a pile of fresh [o]fruit[x].". The description is "Berries and some hairy brown half-spheres with white, succulent flesh inside.". Instead of tasting or taking the pile of fresh fruit: say "You find yourself ravenously hungry, and quickly devour the pile of fruit. Afterwards you feel a little better."; remove pile of fresh fruit from play.

Before going or exiting or landmark-going when current episode is Tending-to-Wounded-Player:
	if Progue is attentive, say "You eye your leg gingerly, and decide you're not feeling up to walking just yet." instead.

First before going or exiting when current episode is Tending-to-Wounded-Player: acknowledge injury. [First check wordgoing when current episode is Tending-to-Wounded-Player: acknowledge injury.]

To acknowledge injury: say "[one of]Gingerly, testing your weight carefully, you get to your feet. You're relieved to find that you'll be able to walk, but running and jumping will probably be out of the question for quite a while.[or][stopping]".


Book - Progue in Fear (in Lacuna-Progue-Fear by Blue Lacuna)

Table of Fear Episodes
eptitle
Crack Coaxing
Futzing at North Beach
Futzing at South Beach
Rockfall at Springs
Leaving Ocean
Drawings During Sleep
Leaving Hut
Watching From Rise

Section - Setup

Transition Progue To Fear is a scene. Transition Progue To Fear begins when the psyche of Progue is fear. Transition Progue To Fear ends when Transition Progue To Fear begins.

When Transition Progue To Fear begins:
	post-conversation processing;
	Progue starts hiding;
	truncate the list of convo stuff to 0 entries; [get rid of old keywords]
	now the exhaust_beat of Progue is p_fear_exhausted;
	now the overexhaust_beat of Progue is p_fear_exhausted;
	now the disgusted_beat of Progue is p_fear_exhausted;
	now the randomyes_beat of Progue is p_fear_exhausted;
	now the randomno_beat of Progue is p_fear_exhausted;
	now episode schedule is Table of Fear Episodes;
	now disposition of Progue is 0;
	begin chapter 3.

Section - Standard Behavior

[player sneaking up during sleep?] [BUG]

FearC is a thread. The escape clause is p_fear_Exhausted.

p_fear_exhausted is a repeatable terminal beat in FearC with reaction "'[one of]Enough! That's enough, please! Please! Go away, go away![or]Stop it, please... stop talking, stop...[in random order]' he says.".





Chapter - Crack Coaxing

[ This conversation takes place if the player pursues Progue to his hiding place on the Ledge during his Fear phase. It ends successfully if the player manages to navigate the conversation stream to a good ending. Upon completion, a change will come over Progue, and he will say he needs to think. He will go ruminate for a while. Once he is done, he will be in the Supresssion phase. If the player disturbs him during this rumination, or treats him poorly during this conversation, he will earn negative affinity points. The player may also finish this conversation with no change in Progue's state. 

There are two major ways to end this: one, affinitive, by answer Progue's questions, and the second, unaffinitive, by attacking/threatening him. At the end, Progue asks the player which role he is: father (paternal), madman (submissive), or sculptor (affinitive). 
]

Crack Coaxing is a rerunnable guaranteed triggered instant episode. The subchange beat is cc_notnow. The boredom beat is cc_bored. The bye beat is silence. The abruptbye beat is silence.

A condition for Crack Coaxing:
	if ( location is Ledge or location is North Marsh or location is Cliffside ) and Progue is in Ledge, rule succeeds;
	if ( location is Ocean Waters or location is South Beach or location is Among the Boulders ) and Progue is in Among the Boulders [and yourself is wounded], rule succeeds.

A commencement rule for Crack Coaxing:
	ignore the Progue begins episode dialogue rule;
	now the rudebye_beat of Progue is cc_rudebye;
	now the animus of Progue is hiding;
	now Progue is fulfilling.

First finishing rule for Crack Coaxing:
	ignore the episodes usually end when conversation does rule;
	if the psyche of Progue is suppression, rule succeeds;
	if ( location of Progue is ledge and location is not Ledge and location is not Cliffside and location is not North Marsh ) or
	( location of Progue is Among the Boulders and location is not Among the Boulders and location is not Ocean Waters and location is not South Beach and location is not Among the Boulders ) , rule succeeds.

A completion rule for Crack Coaxing:
	if the psyche of Progue is suppression, now the episodic status of Crack Coaxing is successful; 
	Progue likes you more;
	Progue's life goes on;
	follow the Progue's motivation rule.

First before going up in Ledge when current episode is Crack Coaxing: say "You hear frantic scrabbling from inside the crack; a bony hand juts out from it and makes angry swatting motions in your direction. 'Get back!' a voice calls from inside. 'Go away!'" instead. First check entering the weather-worn crack: if current episode is Crack Coaxing or ( the psyche of Progue is fear and location of Progue is Ledge and location is Ledge ) , try going up instead.

CC is a thread. The escape clause is cc_bored.

cc_rudebye is a repeatable terminal beat in CC with reaction "'Yes, that's right,' the voice says, 'go away now and stop pestering. Go creep someone else!'".

cc_rudebye2 is a dogged repeatable beat in CC with reaction "'No,' he says, 'answer me.'".

cc_notnow is a repeatable ephemeral beat in CC with reaction "'No,' the voice says petulantly, 'not now.'".

Table of Progue's Initial Appearance (continued)
animus	episode			desc
--		Crack Coaxing	"[ccdesc]"
--		Futzing at South Beach	"[ccdesc]"

To say ccdesc: say "[if location was not Ledge and location of Progue is Ledge]Just as you pull yourself up, you see a [o]shadow[x] dart into the crack and disappear.[otherwise if location is Ledge]Faint scrambling noises and breathing come from a [o]shadow[x] inside the crack.[otherwise if location was not Among the Boulders and location of Progue is Among the Boulders]Just as you arrive, you hear a quiet gasp and a scrambling of rock, from above you. Looking up, you see one bony [o]toe[x] poking out from the rounded top of a boulder well above your head.[otherwise]Quiet scrambling noises come from the top of one of the boulders, above your head.[end if]".

Table of Progue's Description (continued)
animus		episode		desc
--			Crack Coaxing	"[if location is Among the Boulders]You crane your neck back and peer up, but he seems to lying flat on the top of the boulder, and you can only see the odd finger or toe or the top of his head[otherwise]You peer into the shadows of the crack and see a slight movement, but can't make out any details[end if]."

Every turn when location is Among the Boulders and the psyche of Progue is fear and Progue is enclosed by Among the Boulders and current episode is no-episode and Crack Coaxing is unaired: begin Crack Coaxing. [Normally the mechanism would keep Crack Coaxing from starting until the next turn if we're transitioning from Futzing at South Beach; we need to give it an extra jump start.]

Every turn when current episode is Crack Coaxing: now the activity counter of Progue is 1. [ Prevents Progue from leaving while we're standing there. ]

[ Ambient message covered by Table of Progue Hiding. ]

Understand "clatter" or "rockfall" or "curse" or "rustle" or "cough" or "shadow" or "falling" or "dirt" or "whisper" or "toe" as Progue when location is Ledge or location is Among the Boulders.


After greeting Progue when current episode is Crack Coaxing: force discuss cc_greeting.

cc_bored is a repeatable beat in CC with reaction "You hear some cautious scrabbling from [if location is Among the Boulders]atop the boulder[otherwise]inside the crack[end if]. 'Are you still [if location is Among the Boulders]down[otherwise]out[end if] there?' the muffled voice hisses.". The yes-beat of cc_bored is cc_boredyes. The no-beat of cc_bored is cc_boredno.

cc_boredno is a terminal repeatable beat in CC with keyword name "no" and reaction "'Oh, good,' says the voice, relieved. 'I was starting to think you'd never leave.'". 

cc_boredyes is a repeatable beat in CC with keyword name "yes" and reaction "'Then get on with the test!' the voice shouts.". cc_boredyes enqueues cc_challenges.

cc_greeting is a beat in CC with reaction "You call out a tentative greeting[if location is Ledge] into the crack[end if].[paragraph break]'No one here!' replies an angry, almost desperate shout. 'There's [cc_nobody], no body at all. Go away, go away, away away away!'". cc_greeting2 replaces cc_greeting.

cc_jumpstartgreeting is a beat in CC with reaction "You hear some cautious scrabbling from [if location is Among the Boulders]atop the boulder[otherwise]inside the crack[end if]. 'Are you still [if location is Among the Boulders]down[otherwise]out[end if] there?' a muffled voice hisses. 'There's nobody here, really, [cc_nobody], so you can go away now. Go, go away!'". cc_greeting2 replaces cc_jumpstartgreeting.

Understand "nobody" as cc_nobody when last beat is in CC. cc_nobody is a beat in CC with keyword name "nobody" and reaction "A pause. 'Yes,' the voice finally calls out, 'a good point. If nobody was here, you wouldn't hear a voice. Deductive [cc_stilltalk]. You're very good.' A sniffle.

'But I'm on to you,' the voice continues evenly, 'you won't be tricking me any more, oh ho no, so clever, crafty of you, [cc_creeper], sneaking out of your usual bounds, pretending to be [if affinity of Progue > 1]so nice, a kind stranger[otherwise if affinity of Progue < 1]just an ill-tempered stranger[otherwise]a confused stranger[end if] washed up on my island. Well I've figured you out. Now go away!''". cc_nobody summons cc_stilltalk, cc_creeper.

Understand "reason/reasoning/conversation" as cc_stilltalk when last beat is in CC. cc_stilltalk is a beat in CC with keyword name "reasoning" and reaction "'No, you see,' the voice says, 'you're still talking. This isn't working out.'". [***]

Understand "creeper" as cc_creeper when last beat is in CC. cc_creeper is an insistent beat in CC with fuse 6 and keyword name "creeper" and reaction "'Terrible thing,' the muffled voice says angrily, 'beast, monster! Keeping me out of half the island with your fearsome presence! Scaring away those little girls, and the sculptor. Whispering at me, oh, always whispering in my sleep. Why? Why? What do you want from me?'[paragraph break]'Well?' he cries desperately. 'What, are you going to claim now you're NOT the Creeper? Is that what you're saying?'". The yes-beat of cc_creeper is cc_challenges. The no-beat of cc_creeper is cc_creepno.

Understand "no" as cc_creepno when last beat is in CC. cc_creepno is a terminal repeatable beat in CC with keyword name "no" and reaction "'Good,' he says, 'then [one of]go away and haunt somebody else[or]leave me alone[in random order]! I'm quite comfortable in here and can [one of]AHH--' sounds of scrabbling and flesh rubbing against rock [if location is Among the Boulders]float down, and for a moment you see a bony foot desperately clawing the smoothed top of the boulder[otherwise]drift out from the depths of the crack[end if]. '--and can [or][stopping][if location is Among the Boulders]wait up here[otherwise]wait in here[end if] [one of]till the moon comes up and down and up again[or]indefinitely[stopping]. Go AWAY!' And the voice falls silent.".

cc_greeting2 is a repeatable beat in CC with reaction "'[one of]Back to torment me more, are you[or]Don't you have anything better to do than terrify a poor old man[or]Why don't you just leave me alone[in random order]?' the voice from the [if location is Among the Boulders]top of the boulder[otherwise]crack[end if] says shrilly. '[one of]You're not fooling anyone with your silly human disguise[or]Well it won't. Work, won't work at all. Your clever disguise is lost on me[in random order]. Or are you still trying to claim you're not the Creeper?'". The yes-beat of cc_greeting2 is cc_challenges. The no-beat of cc_greeting2 is cc_creepno.

After saying farewell to Progue when current episode is Crack Coaxing: say "You call out a friendly goodbye. There is no response.".

Instead of taking or touching or attacking Progue when current episode is Crack Coaxing and location is Ledge, try entering crack. Instead of taking or touching or attacking Progue when current episode is Crack Coaxing and location is Among the Boulders, try climbing great round boulders.

Understand "yes" as cc_challenges when last beat is in CC. cc_challenges is an insistent repeatable beat in CC with keyword name "yes" and reaction "[one of]'Then you'll have to prove it!' The voice shouts shrilly. 'Yes, that's it, a test. Logic. Reason. Those things. A test for creeperdom. Let's see, now, what are the qualities of creeperliness? Hmmm, mmm...' Some quiet muttering drifts [if location is Among the Boulders]down[otherwise]out of the crack[end if].[paragraph break]'All right,' the voice says at last, 'three tests. The [cc_1], the [cc_2], and the [cc_3]. Which one do you want first?'[or]'[one of]Three tests[or]Three simple tests[in random order],' he says again, 'the [cc_1], the [cc_2], and the [cc_3]. [one of]Which one do you want first[or]Tell me which one you want first[in random order]?'[stopping]". cc_challenges summons cc_1, cc_2, cc_3. Instead of discussing cc_challenges when cc_2ndtest is spoken, force discuss cc_2ndtest.

Understand "1st/first/1" as cc_1 when last beat is in CC. cc_1 is a beat in CC with keyword name "first" and reaction "'Ha! Ha! That was the first test! Predictability!' the voice shouts. 'First first, second second, third third third, oh so very predictable, just like the Creeper! It always gets you when you go into its terrain; always watching; always there, always always always. That's one against you now. Ah well-oh, here's the second test then.'". cc_1 enqueues cc_2ndtest.

Understand "2nd/second/2" as cc_2 when last beat is in CC. cc_2 is a beat in CC with keyword name "second" and reaction "[test1zag]Second[test2zag]". cc_2 enqueues cc_2ndtest.

Understand "3rd/third/3" as cc_3 when last beat is in CC. cc_3 is a beat in CC with keyword name "third" and reaction "[test1zag]Third[test2zag]". cc_3 enqueues cc_2ndtest.

To say test1zag: say "'Ha! Ha! That was the first test! Predictability!' the voice shouts. 'Zagging when zigging's expected, the unexpected choice, pounce, pounce! Just like the Creeper! Always watching, always when you least expect. ". To say test2zag: say " first indeed. Off to a bad start I'm afraid. Ah well-oh, here's the second test then.'".

cc_2ndtest is an insistent repeatable beat in CC with reaction "[one of]'Right,' the voice says, still [if location is Among the Boulders]floating down unseen from the top of the boulder[otherwise]lost somewhere in the darkness of the crack[end if], 'perception. Try and say how many [cc_fingers] I've got holding up. Go on, give us a guess.'[or]'[one of]We're still on perception[or]You still haven't done perception[in random order],' [the Progue]'s voice calls out with a sniff from [if location is Among the Boulders]the top of the boulder[otherwise]inside the crack[end if]. '[one of]Tell me how many [cc_fingers] I'm holding up[or]How many [cc_fingers] do I have held up[in random order]?'[stopping]". cc_2ndtest summons cc_fingerguess, cc_fingers, cc_fingerdunno. The maybe-beat of cc_2ndtest is cc_fingerdunno. cc_2ndtest suggests cc_fingerwait. Instead of discussing cc_2ndtest when cc_3rdtest is spoken, force discuss cc_3rdtest.

Understand "1/one/2/two/3/three/4/four" as cc_fingerguess when last beat is in CC. cc_fingerguess is a beat in CC with fuse 9 and keyword name "1, 2, 3, 4" and reaction "A gasp. 'How did you-- oh, you terrible thing,' it says, 'you crepuscular Creeper, you knew! Night vision, infraeyeing, ultralooking, mental telepathy and cranial mind reading. With my hand behind my back, too. That's two against. Not looking well.'". cc_fingerguess enqueues cc_3rdtest. cc_fingerguess cancels cc_fingers, cc_fingerdunno.

Understand "finger/fingers" as cc_fingers when last beat is in CC. cc_fingers is a dogged ephemeral beat in CC with fuse 9 and keyword name "fingers" and reaction "You [if location is Among the Boulders]crane your neck back[otherwise]peer into the crack[end if], but you can't even make out [the Progue], let alone his fingers.". 

cc_fingerwait is a dogged repeatable beat in CC with reaction "'Come on now,' the voice says, 'how many fingers?'". 

Understand "dunno" as cc_fingerdunno. cc_fingerdunno is a dogged ephemeral beat in CC with fuse 9 and keyword name "dunno" and reaction "'Don't try and get clever with me,' the voice snaps, 'I know perfectly well you can see exactly how many with your nasty nasty monster powers. Now answer. How many?'".

cc_3rdtest is an insistent beat in CC with reaction "'Final test,' the voice says briskly, 'psychology. Word associations. I'll say something, you say the first thing that jumps into your head. Right. Ready? Eggs!'". After discussing cc_3rdtest: now yourself is active-guessing; continue the action. cc_3rdtest summons cc_3guess.

word3 is an indexed text that varies. word3 is "no.guess".

After reading a command when yourself is active-guessing and last beat is in CC:
	now word3 is the player's command;
	if a meta command matches word3 begin;
		say "[as the parser]Can't use meta commands while guessing. Try again in a moment[as normal].";
		stop;
	end if;
	if last beat is cc_3rdtest and word3 exactly matches the text "eggs" begin;
		force discuss cc_3eggs;
	otherwise if word3 exactly matches the text "stop";
		now yourself is not-guessing;
		force discuss cc_3stop;
	otherwise if word3 matches the text "creep" or word3 matches the text "pounce" or word3 matches the text "guilt" ;
		now yourself is not-guessing;
		force discuss cc_3creeper;
	otherwise;
		force discuss cc_3guess;
	end if;
	stop the action.

cc_3eggs is a dogged beat in CC with reaction "'No, see, you're doing it wrong,' the voice says impatiently. 'You say something else when I say 'eggs.' Something you think of when I say 'eggs,' something other than eggs I mean, mostly usually other words. Right? Let's try again. Eggs.".

cc_3guess is a repeatable dogged beat in CC with keyword name "{type a word or say 'stop' to stop guessing.}" and reaction "'[one of]Hmm[or]Interesting[or]Yes[or]Mmmm[or]Ah ha[or]Strange[or]Curious[or]I see[or]Huh[or]Of course[or]I suppose[or]Intriguing[in random order],' he says. '[associationword].'". After discussing cc_3guess: increase cc_3guessctr by 1; continue the action. cc_3guessctr is a number that varies. Instead of discussing cc_3guess when cc_3guessctr >= 10: force discuss cc_3giveup.

cc_3giveup is an insistent beat in CC with reaction "'Cheater!' the voice shouts, [if location is Among the Boulders]jumping down from the top of the boulder[otherwise]gravel spills echoing indignantly through the crack[end if]. '[if penultimate beat is cc_3stop]Not willing to finish the test, what do you have to hide?[otherwise]That's not what you thought of first![end if] You're a liar, a cheat, it's you, you're the Creeper, you! Admit it! Aren't you?'". The yes-beat of cc_3giveup is cc_yescreeper. The no-beat of cc_3giveup is cc_nocreeper. cc_3giveup suggests cc_nocreeper. After discussing cc_3giveup: now tempfuse of cc_3guess is 0; now yourself is not-guessing; now the rudebye_beat of Progue is cc_rudebye2; continue the action.

[ The idea here is to try to trick the player into saying a word related to the Creeper (or "creeper" itself), by presenting words that suggest or sound like them in response to words the player types that have similar sounds. ]

To say associationword:
	if word3 matches the text "sh" begin;
		say "[one of]Shallow[or]Shade[or]Splash[in random order]";
	otherwise if word3 matches the text "th";
		say "[one of]Thimble[or]Hearth[or]Earth[or]Bath[in random order]";
	otherwise if word3 matches the text "dg" or word3 matches the text "j";
		say "[one of]Judge[or]Jury[or]Jump[in random order]";
	otherwise if word3 matches the text "x";
		say "[one of]Execution[or]Axe[in random order]";
	otherwise if word3 matches the text "ss";
		say "[one of]Confess[in random order]";
	otherwise if word3 matches the text "oo";
		say "[one of]Courtroom[or]Loom[in random order]";
	otherwise if word3 matches the text "tr";
		say "[one of]Trial[or]Trail[or]Treat[or]Treason[in random order]";
	otherwise if word3 matches the text "re";
		say "[one of]Wreck[or]Redecorate[or]Relish[in random order]";
	otherwise if word3 matches the text "er";
		say "[one of]Sneaker[or]Sleeper[or]Lawyer[or]Murder[in random order]";
	otherwise if word3 matches the text "cr" or word3 matches the text "kr";
		say "[one of]Crimper[or]Creature[in random order]";
	otherwise if word3 matches the text "ee" or word3 matches the text "eap";
		say "[one of]Sleeper[or]Reaper[or]Keeper[or]Plead[in random order]";
	otherwise if word3 matches the text "ow" or word3 matches the text "ou" or word3 matches the text "ah";
		say "[one of]Trounce[or]Ounce[or]Renounce[in random order]";
	otherwise if word3 matches the text "p";
		say "[one of]Pow[or]Power[or]Pound[in random order]";
	otherwise;
		if a random chance of 1 in 2 succeeds, say "[one of]Hide[or]Shadow[or]Lurk[or]Steep[or]Quiet[or]Leap[or]Night[or]Ball[or]Trampoline[in random order]";
		otherwise say "[one of]Hill[or]Slope[or]Angle[or]Tired[or]Yawn[or]Innocent[or]Destroy[or]Trick[or]Tight[or]Alarm[in random order]";
	end if.

cc_3creeper is an insistent beat in CC with reaction "'Ah HA!' the voice shouts, and with a frantic scrambling [the Progue] [if location is Among the Boulders]leaps down from the top of the boulder[otherwise]emerges from the crack[end if], one wild finger pointed in your face and a triumphant look on his face. 'It is you! I knew it! I knew it!'[paragraph break]'Admit it!' he says angrily. 'You're the Creeper, aren't you? Aren't you?'". The yes-beat of cc_3creeper is cc_yescreeper. The no-beat of cc_3creeper is cc_nocreeper. cc_3creeper suggests cc_nocreeper. After discussing cc_3creeper: now the rudebye_beat of Progue is cc_rudebye2; continue the action.

cc_3stop is a beat in CC. cc_3stop enqueues cc_3giveup.

cc_yescreeper is a beat in CC with keyword name "yes" and reaction "The look of victory freezes on [the Progue]'s face, then slowly crumples. 'No,' he says, 'no, of course it's not you, of course... why would I... what's... it's not you...'". cc_yescreeper enqueues cc_nocreeper2.

cc_nocreeper is a beat in CC with keyword name "no" and reaction "'No? No?' he shouts, whirling around desperately. 'But the tests, you failed all the tests, you have to be, it's got to be you, you, you...'". cc_nocreeper enqueues cc_nocreeper2.

cc_nocreeper2 is an insistent beat in CC with keyword name "no" and reaction "'Well then who is?' he says. 'Who are you if not that thing? Who-- who am I?' He stops and bends over, hands on his knees, panting, suddenly seeming desperate and sad and tired.[paragraph break]'There's too many,' he mutters, 'too many people here, too... [t]sculptors[x] and spirits, [t]fathers[x] and daughters, wayfarers and [t]madmen[x] and explorers and whisperers in dreams...'[paragraph break]He looks up at you, plaintively. 'Tell me, then, stranger,' he cries, voice cracking in anguish, 'tell who, tell me, tell me which one I am?'". cc_nocreeper2 summons cc_sculptor, cc_madman, cc_father, cc_all3. cc_nocreeper2 suggests cc_nocreepernoans.

Understand "everyone" as cc_all3 when last beat is in CC. cc_all3 is a beat in CC with keyword name "everyone" and reaction "[if last beat is not cc_nocreepernoans][cc_finish1][end if]'Yes,' comes a whisper, so quiet you barely hear, 'of course. They're all me. Broken fragments of me, twirling in bottomless tides... I am the father of two vanished daughters, the sculptor who lost his gift, the madman who built mad machines and then forgot the why. I am them all, and me.'". cc_all3 enqueues cc_finish3.

Understand "sculptors/sculptor/wayfarer/wayfarers" as cc_sculptor when last beat is in CC. cc_sculptor is an affinitive nonverbal beat in CC with keyword name "sculptor" and reaction "[if last beat is not cc_nocreepernoans][cc_finish1][end if]'Yes...' comes a whisper, so quiet you barely hear, 'a sculptor. I am a sculptor. Even if my mind could forget it, my hands--' and he stares down at them, silent, awestruck, infinitely sad.[paragraph break]'How many worlds...' he whispers.". cc_sculptor enqueues cc_finish3.

Understand "father/fathers" as cc_father when last beat is in CC. cc_father is a paternal nonverbal beat in CC with keyword name "father" and reaction "[if last beat is not cc_nocreepernoans][cc_finish1][end if]'Oh...' comes a whisper, so quiet you barely hear, 'my angels, my couplets. A father. Yes, of course. I am a father, before everything else.'[paragraph break]He looks into some invisible distance neither up nor down, and whispers again, 'Where are you, my angels?'". cc_father enqueues cc_finish3.

Understand "madman/madmen/mad" as cc_madman when last beat is in CC. cc_madman is a submissive nonverbal beat in CC with keyword name "madman" and reaction "[if last beat is not cc_nocreepernoans][cc_finish1][end if]'Yes,' comes a whisper, so quiet you barely hear, 'I am a madman. The past is gone, and all that's left is what I am, what I do. A crazy old man, broken, forgotten, alone.' He looks down at his rags as if seeing them for the first time, and brushes them in some half-heartened attempt to straighten them, as if unable to lift his head again.[paragraph break]'The Creeper,' he whispers finally, 'the Creeper is me.'". cc_madman enqueues cc_finish3.

cc_nocreepernoans is a dogged beat in CC with reaction "[The Progue]'s eyes pierce yours as he waits for your answer.". cc_nocreepernoans suggests cc_nocreepernoans2. cc_nocreepernoans2 replaces cc_nocreepernoans. cc_nocreepernoans2 is an unsubmissive beat in CC with reaction "Finally he breaks the gaze, and looks down again. 'No,' he says, 'I'm sorry. It's not your burden. I must find myself, or no one... no one will.[paragraph break]He stands that way for a long while, barely breathing before finally, slowly, lifting his head.". Before discussing cc_nocreepernoans2: if submission of Progue > 1 begin; now cc_nocreepernoans2 enqueues cc_madman; otherwise if paternalism of Progue > 1; now cc_nocreepernoans2 enqueues cc_father; otherwise; now cc_nocreepernoans2 enqueues cc_sculptor; end if; continue the action.

To say cc_finish1: say "For a moment, everything is frozen: your gaze locked on [the Progue][']s, his breath in his chest, perhaps even heartbeats.[paragraph break]Then he draws a long, deep, breath, and straightens to his full height, slowly, slowly.[paragraph break]".

[cc_finish2 is a beat in CC with reaction "Then shakes his head, and looks up at you[if last beat is not cc_madman]. A different man[end if].[paragraph break]'Thank you,' he says. '[if Progue is improper-named]I am Progue Attay, and [end if]I have been lost, and I think you have found me.'". After discussing cc_finish2: now the psyche of Progue is suppression; begin the next chapter; continue the action. cc_finish2 enqueues cc_finish3.]

Before discussing cc_finish3: begin Building To Revelations.

cc_finish3 is a terminal beat in CC with reaction "'And I am Progue Attay,' he says, 'and I think you have found me.'[paragraph break]He shakes his head again, as if dizzy. 'Time,' he says, 'I need time to think, to... remember. You deserve explanation. But first I need time.' He nods, brushing past you as he starts to move away. '[ccfin3date],' he says, 'on the rise north of the beach. Meet there and we'll talk.'". After discussing cc_finish3: now the psyche of Progue is suppression; now Progue is named; now Progue is proper-named; print a section break; continue the action. To say ccfin3date: choose row with an event of Suppression Revelations in Table of Progue's Appointment Book; say "[if date entry is evening]This evening[else]Tomorrow morning".

Test cc with "ff / ff / ff / ff / ff / open compass / w / z / z / z / w / w / n / nw / n / ne / ne / u / u".

Section - CC Hinting

[Stuck players get a hint when going to the Rise that they can climb the crack (if they've never done it) or that that's where Progue is hiding out.]

Crack-Coaxing-Hint is a scene. Crack-Coaxing-Hint begins when the psyche of Progue is fear and time for excitement, ignoring drama and location is Rise and ( former location is North Beach or former location is Hot Springs ) . Crack-Coaxing-Hint ends when 1 is 1.

When Crack-Coaxing-Hint begins:
	assuage boredom with "cc hint";
	say "From the corner of your eye, you catch a hint of furtive movement from the ledge halfway up the distant mountain[if Ledge is visited], halfway up the crack[else] along the vertical crack that splits it. You wonder if it's possible to climb the crack up to the ledge[end if].";
	move distant-ledge to location.

The distant-ledge is minor set dressing with printed name "distant ledge". Understand "ledge" as distant-ledge. The description is "The ledge is bisected by the crack that runs up the mountain's cliff.".
	
[For players who reach the ledge but don't realize they need to say "hello" to begin the conversation.]

Crack-Coaxing-Jumpstart is a scene. Crack-Coaxing-Jumpstart begins when current episode is Crack Coaxing and time for excitement, ignoring drama and Progue is enclosed by location and Progue is idle. Crack-Coaxing-Jumpstart ends when 1 is 1.

When Crack-Coaxing-Jumpstart begins:
	pre-conversation processing;
	force discuss cc_jumpstartgreeting.


Chapter - Spying

[ While Progue is in the fear psyche stage, he is sometimes hiding and sometimes keeping an eye on the player. This manifests itself in a number of little vignettes in which we cannot usually interact with Progue but are aware of his distant presence. Each of these can only happen once. ]

Section - Watching From Rise

Watching From Rise is an uncommon triggered instant episode with expiration date 15 minutes.

A condition for Watching From Rise:
	if night, rule fails;
	if location is Lower Beach or location is South Beach or location is Among the Boulders or location is Tidepools, rule succeeds.

First commencement rule for Watching From Rise:
	ignore the teleport Progue to mark rule;
	say "From the corner of your eye, you catch movement [if dir]to the north[otherwise]from the other side of the lagoon[end if]. You turn your head just in time to see a figure duck down behind the rise, leaving behind tiny rockfall and a little cloud of dust."; 
	move distant-progue to location;
	now distant-progue is out-of-sight;
	now the animus of Progue is hiding;
	now Progue is wishing;
	move Progue to Stumps.

Understand "figure" or "rockfall" or "cloud" or "little" or "dust" or "man" or "Progue" as distant-progue when current episode is Watching From Rise. 

Section - Leaving Hut

Leaving Hut is a common triggered instant episode with expiration date 15 minutes. 

A condition for Leaving Hut:
	if night, rule fails;
	if location is Center Beach and the player was in Hut and conversation fuse > 30, rule succeeds. 

First commencement rule for Leaving Hut:
	ignore the teleport Progue to mark rule;
	say "Strange. You could swear there are more [o]footprints[x] in the sand out here than there were when you stepped inside.";
	move progue-footprints to Center Beach;
	now the animus of Progue is hiding;
	now Progue is wishing;
	move Progue to Stumps.

The progue-footprints are set dressing. The printed name is "footprints". Understand "footprints" or "prints" or "foot prints" or "print" as progue-footprints. The description is "It looks like somebody came up to just the doorway of the hut, hesitated, then turned and went back the other way in a big hurry, several times. The retreating prints lead back towards the rise.". Instead of following progue-footprints: say "They vanish into the general mish-mash towards the rise.".


Section - Drawings During Sleep

[If the player is sleeping on the beach, this gives them a hint to sleep elsewhere.]

Drawings During Sleep is a guaranteed triggered instant episode with expiration date 15 minutes. 

A condition for Drawings During Sleep:
	if Having a Generic Dream is happening and location is regionally in Beachfront, rule succeeds.

First commencement rule for Drawings During Sleep:
	ignore the teleport Progue to mark rule;
	move tree-sand-drawings to location;
	say "That's funny. You could swear you weren't surrounded by all these [o]drawings[x] and footprints in the sand when you fell asleep.";
	now the animus of Progue is hiding;
	now Progue is wishing;
	move Progue to Stumps.

Some tree-sand-drawings are set dressing. Understand "drawings/drawing" as tree-sand-drawings. The printed name is "tree drawings". The initial appearance is "Surrounding the spot where you slept is a vast expanse of [o]drawings[x] in the sand.". The description is "Crude, hasty, the sand drawings are nevertheless very clear: they seem to show roots and branches of trees, twining in a huge circle around your prone form. Bare footprints deftly step between the branches, then disappear at running speed off towards the rise.". The provoke message of tree-sand-drawings is "There's no point: the next high tide will wash them away.". Instead of attacking tree-sand-drawings: remove tree-sand-drawings from play; say "With some quick work of your feet, you have erased the sand drawings from the beach." Understand the command "erase" as "attack".



Section - Leaving Ocean

Leaving Ocean is a common triggered instant episode with expiration date 15 minutes.

A condition for Leaving Ocean:
	if night, rule fails;
	if location is regionally in Beachfront and former location is regionally in Tiderooms, rule succeeds.

First commencement rule for Leaving Ocean:
	ignore the teleport Progue to mark rule;
	say "As you [if tidein]wade up out of the water and onto the beach[otherwise]climb past the wet sand towards the dryer upper flats of the beach[end if], your eyes catch a movement on the lava ridge forming the back of the lagoon. [The Progue] is sprinting lightly along it, casting nervous glances in your direction.[paragraph break]Before you can do anything, he drops down out of sight behind the ridge.";
	move distant-progue to location;
	now distant-progue is out-of-sight;
	now the animus of Progue is hiding;
	now Progue is wishing;
	move Progue to Stumps.

Section - Rockfall at Springs

Rockfall at Springs is a frequent triggered instant episode with expiration date 15 minutes.

A condition for Rockfall at Springs:
	if night, rule fails;
	if location is Hot Springs, rule succeeds.

First commencement rule for Rockfall at Springs:
	ignore the teleport Progue to mark rule;
	say "A clatter of loose [o]rocks[x] suddenly cascades down from above and alongside the waterfall.";
	move loose rocks to Hot Springs;
	now the animus of Progue is hiding;
	now Progue is wishing;
	move Progue to West-Marsh.

Some loose rocks are set dressing. Understand "clatter" as loose rocks. The description is "They fell into the pool; the accompanying cloud of dust has already dissipated."

Section - Futzing At North Beach

Futzing at North Beach is a frequent rerunnable triggered instant episode with expiration date 15 minutes and meeting place North Beach. 

A condition for Futzing at North Beach:
	if night, rule fails;
	if location is South Beach and the player was in Fork, rule succeeds.

A commencement rule for Futzing at North Beach:
	move distant-Progue to location;
	say "Across the lagoon near the rocky rise, you see [the Progue] [one of]trolling the shallows with his fishing line. As he sees you he quickly pulls in his line[or]standing bent over the surf, his arms full, a swath of immaculately tended sand behind him. As he sees you, he turns[in random order] in a panic.";
	now the animus of Progue is hiding;
	now Progue is wishing;
	follow the Progue's motivation rule.


Chapter - Futzing At South Beach

[ If the player breaks his leg, he will be unable to get to the Ledge for the default venue of Crack Coaxing. If they catch Progue cleaning the beach and manage to corner him in Among the Boulders, we begin Crack Coaxing here. ]

Futzing at South Beach is a frequent rerunnable triggered rendezvous episode with expiration date 2 hours and meeting place Among the Boulders.

A condition for Futzing at South Beach:
	if night, rule fails;
	if location is Rise and ( the player was in Stumps or the player was in Hot Springs ) , rule succeeds.

A commencement rule for Futzing at South Beach:
	summon Progue to South Beach;
	move distant-Progue to location;
	say "Off towards the [if dir]south[otherwise]opposite[end if] end of the lagoon, [the Progue] [one of]trolls the shallows with his fishing line. As he sees you he quickly pulls in his line[or]stands bent over the surf, his arms full, a swath of immaculately tended sand behind him[in random order]. He sees you at about the same time you see him and startles, jumps towards the forest, but stops dead and shakes his head.";
	now Progue is wishing;
	follow the Progue's motivation rule. 

 [When the player leaves, Progue escapes]

A finishing rule for Futzing at South Beach:
	if location is South Beach or location is Lower Beach:
		say "A furtive movement catches your glance off by the [if location is Lower Beach][d]beach[x] near the boulders[else][d]boulders[x][end if], as well as a cough and whispered curse.";
	if location is Stumps or location is Hot Springs or location is Hut or location is Saddle or location is Fork or location is Among the Boulders, rule succeeds. [So that Crack Coaxing can begin.]

A completion rule for Futzing at South Beach:
	if Progue is not enclosed by location:
		summon Progue to Ledge;
		Progue starts hiding.


Book - Progue in Suppression (in Lacuna-Progue-Suppression by Blue Lacuna)

Table of Suppression Episodes
eptitle
Suppression Dislike Convo
Suppression Animus Convo
Suppression General Convo
Building To Revelations
Let's Take A Soak Part One
A Simple Warning
Sand Construction
Walk Invitation
Unexpected Present
Earthquake
Water Works
Ring of Truth
Make-Way
Small Favor
Mad Honesty
Rainfall Rhapsody
Hold This Please
Just Teasing
Thought I Warned You
Feast of Submission
Knitted You a Gift
Knitted Aftermath
Dolphins Meeting
Hey That's Mine
Older And Wiser
Art Critic
Guess Whot

Section - Setup

Transition Progue To Suppression is a scene. Transition Progue To Suppression begins when the psyche of Progue is suppression. Transition Progue To Suppression ends when Transition Progue To Suppression begins.

When Transition Progue To Suppression begins:
	truncate the list of convo stuff to 0 entries; [get rid of old keywords]
	repeat with bt running through beats summoned by denial keywords begin;
		now fuse of bt is 0;
	end repeat; [ and keep them from coming back. ]
	now Progue is named; [ we've definitely learned his name by this point. ]
	now episode schedule is Table of Suppression Episodes;
	now current_thread of Progue is SuppC;
	now the exhaust_beat of Progue is p_supp_exhausted;
	now the overexhaust_beat of Progue is pd_overexhausted;
	now the disgusted_beat of Progue is p_supp_exhausted;
	now the randomyes_beat of Progue is pd_randomyes;
	now the randomno_beat of Progue is pd_randomno;
	now the bored_beat of Progue is p_supp_bored;
	now the unavailable-beat of Progue is p_supp_unavailable;
	now the rudebye_beat of Progue is p_supp_rudebye;
	now the abruptbye_beat of Progue is p_supp_abruptbye;
	now the bye_beat of Progue is p_supp_bye;
	now the nudity_beat of Progue is ps_nudity;
	now the conversation_beat of Progue is sc_makeconversation;
	now disposition of Progue is 0;
	if current chapter < 4, begin chapter 4. [This is necessary because there's a slight possibility we may have skipped Progue's suppression psyche.]

Section - Standard Behavior

SuppC is a thread. The escape clause is p_supp_bye.

p_supp_exhausted is a repeatable ephemeral beat in SuppC with reaction "Progue [one of]rubs his temples[or]sighs[or]looks away[or]shrugs[in random order]. '[one of]I don't want to talk about it any more,[or]Let's talk about something else, all right?[or]I'm afraid that's really all I can remember right now,[in random order]' he says.".

p_supp_bored is a repeatable terminal beat in SuppC with reaction "[if affinity of Progue > 0][psb_like][otherwise][psb_dislike][end if]". To say psb_like: say "'[one of]Terrible sorries, but I[or]Hate to cut this short, but I[or]So much to do; I[or]Oh! Forgot all about what I was doing. I[in random order] [one of]really should get back to this[or]better get back to it[or]should keep going or I'll forget what I'm doing[in random order],' he says, [animus-business]. "; say "'[one of]Ta[or]Have a pleasant [progue-time-of-day][or]Good [progue-time-of-day][or]Craze you later[in random order]!' [Progue-resumes].". To say psb_dislike: say "'[one of]Not that this isn't fascinating[or]I really hate to inconvenience you[or]Well, as vibrant a conversationalist as you are, I hate to break this off[in random order],' Progue says[if affinity of Progue <= -2] [one of]with a touch of sarcasm[or]in a somewhat droll tone[at random][end if], "; say "'[one of]but I really am quite busy here[or]but I've really got quite a lot to do[or]but I sort of must get back to this[in random order].' [Progue-resumes]. '[one of]So long[or]Later, I suppose[or]Good [progue-time-of-day][in random order].'".

p_supp_unavailable is a repeatable ephemeral beat in SuppC with reaction "[if submission of Progue > 0][psu_sub][otherwise][psu_unsub][end if]". To say psu_sub: say "[if affinity of Progue > 0][one of]'If you wouldn't mind waiting just a moment first,' he says hurriedly, 'I'd like to follow this line of thought.'[or]'Oh, in just a minute,' he says.[or]'Can it wait just a moment?' he says. 'I'd really like to finish this discussion before we change the subject.'[in random order][otherwise][one of]'Well, if you say so,' he says, eyes downcast, 'but can we just finish up what we were talking about first?'[or]'We can talk about whatever you like,' Progue says in an obsequious tone, 'but let's finish this up quick quick first.'[or]'Yes, of course,' Progue says soothingly, 'in just a minute, yes yes?'[in random order][end if]". To say psu_unsub: say "[if affinity of Progue > 0][one of]'Yes, but just a ment first,' he says, holding up a hand, 'let's finish this line of thought.'[or]'Not now,' he says, holding up a hand, 'I'm interested in this subject.'[or]'Later,' Progue says firmly, 'now stick to the point.'[in random order][otherwise][one of]'No, I like this subject,' Progue says.[or]'I don't think so,' Progue says, 'now why don't you stay on the point?'[or]'No, I think we'll keep talking about this for now,' Progue says, fixing you with a commanding stare.[in random order][end if]".

p_supp_rudebye is a repeatable ephemeral beat in SuppC with reaction "'[one of]You're not getting away that easily,[or]And just where is it you think you're going?[or]Hey, come back here![in random order],' Progue says.".

p_supp_abruptbye is an annoying beat in SuppC with reaction "[if affinity of Progue > 0 and submission of Progue > 0]'Oh, well that's all right then,' Progue says awkwardly. 'Bye!'[otherwise if affinity of Progue > 0 and submission of Progue < 0]'A [']goodbye['] would have been nice!' Progue shouts after you. 'Oh well, craze you later!'[otherwise if submission of Progue > 0]'Ah,' Progue mutters to your retreating back, 'that's all right, we weren't talking about anything important I suppose.'[otherwise]'Typical of [playerhimher],' you hear Progue mutter to your back, 'no manners.'[end if]". pd_abruptbye2 replaces p_supp_abruptbye.

To say playerhimher: if player is male, say "him"; otherwise say "her".

suppression keywords is a beat. suppression keywords summons learn_capalla_name, dc_konokuk, learn_rayfish_name.

Instead of pushing Progue when the psyche of Progue is suppression, force discuss sc_push. sc_push is an ephemeral beat with reaction "You shove [the Progue]'s shoulder. He staggers back, looking [if affinity of Progue < 0]un[end if]surprised, and brushes off his clothes. 'Now let's not get rowdy,' he says.". sc_push2 replaces sc_push. sc_push2 is an unaffinitive submissive beat with reaction "You shove [the Progue], who staggers back and shoots you a [if affinity of Progue >= 0]hurt[otherwise]vengeful[end if] look. [if player is female]'My dear woman,' he says, straightening himself up, 'if you were someone more manwardsly I'd respond with gushing more force. As it is I think you'd better stop[otherwise]'My good man,' he says, straightening himself up, 'you do that one but one more time and sorries, but things will turn unpleasant[end if]. Please stop it.'". sc_push3 replaces sc_push2. sc_push3 is an unaffinitive submissive terminal beat with reaction "You shove [the Progue] hard to the [surface-material] and stand threateningly over him, but he scrabbles away and turns to flee, [if submission of Progue > 0]looking fearfully[else]spitting[end if] over his shoulder.". After discussing sc_push3: now dont_describe_Progue is true; Progue's life goes on; follow the Progue's motivation rule; continue the action. sc_push4 replaces sc_push3. sc_push4 is a repeatable unaffinitive terminal beat with reaction "[The Progue] [one of]ducks out of range before you can push him[or]dodges out of the way[at random][if player is male], then suddenly slams into you with surprising force, knocking you onto the [surface-material]. By the time you have gotten to your feet he has already vanished[otherwise], and takes off at a run, vanishing[end if].". After discussing sc_push4: now dont_describe_Progue is true; Progue's life goes on; follow the Progue's motivation rule; continue the action.

Instead of attacking Progue when the psyche of Progue is suppression, force discuss sc_attack. sc_attack is an unaffinitive submissive nonverbal beat with reaction "You step forward, threatening, and [the Progue] shrinks back. 'Now now,' he says, holding up his hands nervously, 'no need to grow angerwards. I was only fooling.'". sc_attack2 replaces sc_attack. sc_attack2 is an unaffinitive submissive beat with reaction "You lunge at [the Progue] angrily but he leaps backwards, crying out, then turns and flees over the [surface-material].". After discussing sc_attack2: now dont_describe_Progue is true; Progue's life goes on; follow the Progue's motivation rule; continue the action. sc_attack3 replace sc_attack2. sc_attack3 is an unaffinitive repeatable terminal beat with reaction "[The Progue] [one of]ducks out of range before you can land an attack[or]dodges out of the way[at random][one of], then suddenly slams into you with surprising force, knocking you onto the [surface-material]. By the time you have gotten to your feet he has already taken off at a run[or], and takes off at a run[at random].". After discussing sc_attack3: now dont_describe_Progue is true; Progue's life goes on; follow the Progue's motivation rule; continue the action.

p_supp_bye is an impressive [for politeness] repeatable beat in SuppC with reaction "'[one of]See you around[or]Take care[or]Enjoy the [progue-time-of-day][or]Good [progue-time-of-day][or]We'll talk again later[or]See you later[or]So long[in random order]![appointment_reminder]' [Progue-resumes].".

To say appointment_reminder: if Progue has pending appointments begin; choose a random row in the Table of Progue's Appointment Book; say " [one of]Don't forget, [or]Remember, we're meeting [or]See you [in random order][if date entry is morning or date entry is midmorning]in the morning[otherwise if date entry is midday]at high noon[otherwise if date entry is afternoon]this afternoon[otherwise if date entry is evening or date entry is sunset]this evening[otherwise if date entry is twilight]after sunset[otherwise]tonight[end if]!"; end if.

Instead of hugging Progue when the psyche of Progue is suppression:
	force discuss p_supp_hug.

p_supp_hug is an affinitive repeatable dogged beat in SuppC with reaction "'All right all right,' Progue says, patting you on the back, 'fine then, fine.'".

Instead of kissing Progue when the psyche of Progue is suppression:
	if romance of Progue < -1 begin;
		force discuss the disgusted_beat of Progue;
		Progue's life goes on;
		follow the Progue's motivation rule;
	otherwise if romance of Progue >= 2;
		force discuss p_supp_flirting;
	otherwise if affinity of Progue < -1;
		force discuss p_supp_nokissing;
	otherwise;
		force discuss p_d_nokissyet;
	end if.

p_d_nokissyet is a dogged romantic nonverbal beat in DenialC with reaction "The old man leans deftly back. 'Whoah there, my [animal-nickname],' he says with a chuckle. 'Let's just wait to get to know each other a little better first, eh?'". p_d_nokissyet2 replaces p_d_nokissyet. After discussing p_d_nokissyet: annoy Progue; continue the action.

p_d_nokissyet2 is a dogged repeatable beat in DenialC with reaction "'[one of]Knock it[or]Really, I must insist[or]Let's just keep this a bit more formal[or]Come on, now[in random order],' he says, [one of]annoyed[or]embarrassed[in random order].". After discussing p_d_nokissyet2: annoy Progue; continue the action.

p_supp_nokissing is a repeatable annoying beat in SuppC with reaction "[one of]Progue leans back in alarm[or]Progue jumps back, startled[in random order]. '[one of]No thank you,' he says, 'I reserve that for people I like better[or]I don't think so,' he says, 'you aren't really my type[or]Keep your lips to yourself[in random order].'".

p_supp_flirting is a romantic impressive beat in SuppC with reaction "You peck Progue on the lips and his eyes widen in surprise. 'Warn me next time,' he finally says with a wink, 'so I can plan a counter attack.'". p_supp_flirting2 replaces p_supp_flirting.

p_supp_flirting2 is a repeatable impressive beat in SuppC with reaction "[one of]Progue slaps your hand away playfully[or]Progue turns his head at the last minute so you kiss his nose[or]Progue giggles and shoves you away playfully[in random order]. '[one of]Now stop that,' he says, 'that's no way to tease a poor old man.[or]Really, [animal-nickname],' he says archly, 'whatever happened to the art of subtlety?[or]Not here, you fool,' he says with a wink, 'the fish will see, and you've no idea what gossips they are.[in random order]'".

ps_nudity is a romantic nonverbal beat in SuppC with reaction "'[if pd_nudity is spoken]You certainly do enjoy scrounging about in the altogether, don't you[else]My oh my oh, you're certainly forward[end if],' [the Progue] says, eyeing your naked body. 'Well but I suppose I don't mind if you don't.'". pd_nudity2 replaces ps_nudity.


Section - Keywords

suppression keywords is a repeatable beat. suppression keywords summons sc_cabin, sc_windsigh, learn_capalla_name, learn_rayfish_name, sc_sculpture,  sc_ropeway, sc_sketchbook, sc_treehouse, sc_head, sc_paintings, sc_bridge, sc_bees, sc_rainforest, sc_egg, sc_pyramiddist, sc_door, sc_cave, sc_boiler, sc_jellyfish.

Understand "cabin" as sc_cabin. sc_cabin is a beat in SuppC with fuse 9999 and keyword name "cabin" and reaction "He tilts his head, frowning. 'First thing I built,' he says, 'when we came here. Was still in survival mode. Build shelter, protect [sc_family], all that.'". the log cabin references sc_cabin. Check examining by name the log cabin: if sc_cabin is available, try discussing sc_cabin instead. [Check wordgoing Center Beach: if sc_cabin is available, try discussing sc_cabin instead. Check wordgoing Hut: if sc_cabin is available, try discussing sc_cabin instead.]

Understand "family" as sc_family. sc_family is an annoying repeatable beat in SuppC with fuse 9999 and keyword name "family" and reaction "He [one of]frowns[or]closes his eyes[or]looks annoyed[in random order]. '[one of]Past is past is past,' he says, 'let's not keep living in it[or]I'd rather not discuss that any more, if all's the same[or]There are some things I don't really want to remember[in random order],' he says.".

Understand "girls/daughters/daughter" as sc_girls. sc_girls is a beat in SuppC with fuse 9999 and keyword name "[if last beat is sc_shdead]daughter[otherwise]girls" and reaction "He looks down awkwardly at his bare feet. 'I brought them here,' he says, 'after the uh, well their-- after [sc_mother]. They came with me because they're my daughters; I made them, if you ring. Had been oh, fifteen years then since I'd done it and never thought I'd do it again but...' He stops, awkwardly, then shrugs.". sc_girls2 replaces sc_girls.

sc_girls2 is a beat in SuppC with reaction "He bites his lip. 'Yes, started to tale you earlier. I wanted to transplant us somewhere new and fresh, somewhere without lingering memories. Someplace we'd be needed, and useful. But...' he spreads his hand around the island, grasping at the air helplessly. 'Something went wrong. There was no one here.' He laughs uncomfortably. 'An empty island, alone. And after that I don't remember, remember what happened.'". sc_family replaces sc_girls2.

Understand "tree9/windsigh" as sc_windsigh. sc_windsigh is a beat in SuppC with fuse 9999 and keyword name "windsigh" and reaction "He rubs his knuckles against the side of his head. 'Ugly things, aren't they?' he says, grimacing. 'Don't know why I gifted them a pretty name. Windsigh, hrmph. Don't like them. Don't like to be near them. You should keep your feet on [surface-material] here, where it's [sc_safe].'". tree1 references sc_windsigh.  Check examining by name distant-tree3: if sc_windsigh is available, try discussing sc_windsigh instead.

Understand "safe" as sc_safe. sc_safe is a beat in SuppC with keyword name "safe" and reaction "'Safe,' he says again, emphatically, 'from-- from I-don't-know-what. The paranoid fears of a delusional castaway, mayhaps; or... mayhaps there is something over there, mayhaps the Creeper's not just--' He breaks off, bites his lip. Then laughs. 'Well and there I go again,' he says. 'Let's just forget it, shall we shall we?'". [should Creeper be highlighted? sc_creeper]

Understand "sculpture" as sc_sculpture. sc_sculpture is a beat in SuppC with fuse 9999 and keyword name "sculpture" and reaction "He turns, raising a hand to shield his eyes and peering intently up at the volcano, where the sculpture glimmers brightly. 'Yes, I remember that one,' he says, 'now. Lost everything around it, memories I mean, but I remember sculpting it something vivid.' He squints his eyes. 'Was before I realized I'd lost whatever-it-was. The thing, the gift, the skill.' He pauses, lost in memory, as if hoping to gather some more.". sc_sculpture suggests sc_sculpture2. sc_sculpture2 replaces sc_sculpture. volcano sculpture references sc_sculpture.

sc_sculpture2 is a beat in SuppC with keyword name "sculpture" and reaction "'Yes,' he says, as if trying the idea out on himself, 'didn't really intend to go anywhere with that one. No, of courses not; the [sc_girls] were still roundwards. But I think I thought [']twould be nice to feel a tingle; just tingles in the hands, reminders of who and who I was.' He pauses, [attitude-business], then falls quiet, half-hiding a strange and mournful expression.".

Understand "ropeway" as sc_ropeway. sc_ropeway is a beat in SuppC with fuse 9999 and keyword name "ropeway" and reaction "He frowns a little and rubs his knuckles reflexively against his head. 'Yes, I built that,' he says, 'but for life and strife I can't remember why. It was terrible important at the time. Wove rope till my fingers bled.' He stares down at them, flexing. 'Strange strange.'". Before discussing sc_ropeway when Lawn is visited: now sc_ropeway is spoken; now sc_ropeway2 replaces sc_ropeway. ropeway-shack references sc_ropeway. Check examining by name distant-ropeway: if sc_ropeway is available, try discussing sc_ropeway instead. Check examining by name ropeway-shack: if sc_ropeway is available, try discussing sc_ropeway instead.

sc_ropeway2 is a beat in SuppC with keyword name "ropeway" and reaction "'Yes, I've seen you using it,' he says with a frown. 'Probably not the most luminous of ideas. Not the safest thing, you ring. No inspections boards here, safety officials, ropeway certification standards. Hasn't been used in obscene quantities of time. You're the first friend I've made in ages who talked back so I'd really rather you didn't do something stupid and die,' he adds gravely.".

Understand "sketchbook" as sc_sketchbook. sc_sketchbook is a repeatable beat in SuppC with fuse 9999 and keyword name "sketchbook" and reaction "[one of]'That old thing?' he asks. 'Don't really remember. Brought it with me from before, I think from-- somewhere, some somewhere. Made it by hand, if you ring, so it came. What's in it, anyway?'[or]'Yes,' he says, 'what else did you say was in it?'[stopping]". sc_sketchbook summons sc_sketchgirls, sc_map, sc_dreams, sc_schematics, sc_writing. The sketchbook references sc_sketchbook.

Understand "daughters" as sc_sketchgirls. sc_sketchgirls is a beat in SuppC with keyword name "daughters" and fuse 6 and reaction "He looks away, smiling distantly as if using the expression as a shield, as you describe the sketch. 'Yes, my first and only,' he says, quietly. 'Couplets, you know, born at the same time. Such mischief they could get into, such joy they could bring. Well. But that's past as past now and they're gone. They're gone. Moisty hells, I wish I could remember why.' He stops, and presses his lips together tightly, [animus-business].". sc_sketchgirls summons sc_mother.

Understand "map" as sc_map. sc_map is a beat in SuppC with keyword name "map" and fuse 6 and reaction "He seems interested as you explain. 'Yes, I remember drawing that,' he says. 'Up at the top of the volcano. Beautiful day; sky blue as blue and blue. But--' he lifts a corner of his mouth, raising one bony knuckle hesitantly to his temple. 'I don't remember this asterisk you mention. Somewhere in the rain forest, was it? No, can't remember what that might have meant. Unless-- you're sure it wasn't by-- by the [sc_bees]? The star?'[paragraph break]You shake your head, and he frowns. 'Then I'm bats at noon,' he says, 'no idea at all. Don't remember scribbling over it all either.' He sighs. 'So much missing. I'd miss it if I knew what to miss.'". 

Understand "dreams" as sc_dreams. sc_dreams is a beat in SuppC with keyword name "dreams" and fuse 6 and reaction "'Don't remember that one at all,' he says immediately, shaking his head and tapping a knuckle idly against his temple. 'Sounds like just bored doodles. I certainly wouldn't recommend sleeping near any of those creepy windsigh; ground all muddy and lumpy? Nasty nasty. Try the beach; so much softer and nicer and quieter.'".

Understand "schematics" as sc_schematics. sc_schematics is a beat in SuppC with keyword name "schematics" and fuse 6 and reaction "'Ye-es,' he says hesitantly. 'That was when I was building-- well, everything really. The [dc_ropeway], and the [sc_boiler] and pipes, and the--' He waves vaguely, uncomfortably, in the direction of the mountain, not looking towards it. 'The whatever-it-is up there. Time of inspiration. Such ideas! Popping into my head like soap bubbles, round and airy. Sometimes couldn't write nearly fast enough to get them all down.'". sc_schematics summons dc_ropeway.

Understand "writing" as sc_writing. sc_writing is a beat in SuppC with keyword name "writing" and fuse 6 and reaction "'Yes,' he says, warming. 'That's the [sc_script] they taught me growing up, some backwards backwhen world. Curious curious, have you noticed? We [if rev_wayfaring is spoken]wayfarers [end if]can always understand each other and others we meet, well, mostly usually I mean, when we chatter back and forth. But each world has different writing; why should it work that way? I remember once being marvelous inebriated and becoming terrible convinced that that was the key to some vital secret about [if rev_wayfaring is spoken]us, wayfarers[otherwise]our kind, you and I[end if], that would explain and expound the entirety of our strange sad lives completely.' He chuckles, shaking his head. 'Sausages, but what queer realities we dwell in.'". sc_script replaces sc_writing. sc_writing suggests sc_script.

Understand "chirography" as sc_script. sc_script is a beat in SuppC with keyword name "chirography" and reaction "'Words, writing, you know,' he says. 'What now, you expect me to translate my private notes in an old diary?' he asks, [attitude-business]. 'I'm not sure you're at all clearanced for that kind of information. Come back when you've written a few hundred pages of my biography or been my close and dearest for a decade or so, then we'll talk about it.'".

Understand "treehouse" as sc_treehouse. sc_treehouse is a beat in SuppC with fuse 9999 and keyword name "treehouse" and reaction "'That was for the [sc_girls], of course,' he says musingly. 'They wanted-- I think-- or am I confusing this with something-- no, I'm mostly gushing sure-- they wanted a little refuge, you see, so they could get away from me for times. Or--' he pauses, biting his lip. 'Or was it that I wanted time away from them, and so I built them their own--?' He trails off, looking for a moment quite miserable. 'Doesn't matter,' he says. 'Just ruins in the forest now I imagine. Remnants of some strange and failed civilization.'". tree2 references sc_treehouse.

Understand "head" as sc_head. sc_head is a beat in SuppC with fuse 9999 and keyword name "head" and reaction "He laughs. 'Oh yes,' he says, 'that thing. Such a joy to make. It came with us, or ratherly I brought it. Made it when the [sc_girls] were just babes to teach them-- teach them my language. Useless of course; it was from some world at angles to the one they borne and grew in. But it was just that I wanted to give them something private, special, something that only they and we and their--' His throat catches, and he rubs it fiercely for a moment. 'Only we would have it,' he says, 'together.'". sc_head summons sc_mother. clockwork head references sc_head.

Understand "mother/wife/tragedy" as sc_mother. sc_mother is a beat in SuppC with keyword name "[if last beat is sc_girls]tragedy[otherwise]mother". sc_mother enqueues sc_family.

Understand "paintings" as sc_paintings. sc_paintings is a beat in SuppC with fuse 9999 and keyword name "paintings" and reaction "His face moves through a strange sort of grimace. 'Beautiful, aren't they?' he says quietly. 'Used to go care and stare for hours, years back, drinking them in. They're by my [sc_girls]. I suppose. Oh well oh, I can draw, but not like that. Must be them. And where else would they be if not---?'[paragraph break]He looks down at the [surface-material] again, [Progue-animus] momentarily forgotten. 'Beautiful,' he finally says.".  Phoebe-canvas references sc_paintings. Check examining by name an artwork: if sc_paintings is available, try discussing sc_paintings instead.

Understand "stairs/bridge" as sc_bridge. sc_bridge is a beat in SuppC with fuse 9999 and keyword name "[if bridge is raised]bridge[otherwise]stairs" and reaction "'Hmm,' he says, thinking, 'that was one of the first things I built in my productive daze. I'd already done the [sc_door], I think, to keep the girls out of the volcano, but then it was so inconvenient when I started--' he frowns. 'No, or was it before that?' he says. 'Did I build it just to test the [sc_boiler] and power? No no no. No, it was there already when--' Finally, he shrugs. 'Bats at noon,' he says, 'sorries.'". bridge references sc_bridge.

Understand "jellyfish" as sc_jellyfish. sc_jellyfish is a beat in SuppC with keyword name "jellyfish" and reaction "'Migratory things,' he says, dreamily, 'astonishing beautiful, astonishing graceful, astonishing deadly if those tentacles brush [']gainst you. Usually they keep well out to sea, and don't swim in to the bay. Once a year or so, when they're touring by, sometimes I swim out to see them.'".

Understand "bees/beehive" as sc_bees. sc_bees is a beat in SuppC with fuse 9999 and keyword name "[if last beat is sc_map or last beat is sc_exploring]beehive[otherwise]bees" and reaction "He laughs. 'The first time one zipped by like a hairy jet zeppelin I thought valves would burst,' he says, 'just an hour or so after we'd first arrived I mean. Visions of giant tropical death bees tend to crimp plans for peace and relaxation. They're harmless of course, I discovered soon enough; Lethe even lumped into them, started tending the dying ones like strange birds, or was it Phoebe? No, it was Lethe, I'm sure I'm sure. Lethe. We went once to watch them [sc_beedance].' He smiles, gently, slowly. 'Seems like this morning or yesterday. Such a fresh memory, just out from the wash all warm and clean. Like yesterday...'". the beehive references sc_bees.

Understand "dance" as sc_beedance. sc_beedance is a beat in SuppC with keyword name "dance" and reaction "'Did ever I know you I once was a scientist?' he says, eyes glazed in memory. 'A botanist, lives and lives ago, though I studied biology first. The University of the [sc_nabe]; finest school I could summon. Observation above all else; that's what they taught us. The careful watch, the scrutiny, the detail.' He nods. 'I tried to instill something thatwise in the [sc_girls]. We watched the bee dance, creeping and peering into their windswept hive, and I asked her, my Lethe, I said [']What does it mean, angel?['] And she asked how she was meant to know, not being a bee herself, if you ring.'[paragraph break]Progue smiles, lost in the story. '[']Watch him,['] I said. [']How he twirls, where he steps, which wing quivers and why and when. Watch like a bee, angel, and you'll learn to know what they learn in their watching.[']'[paragraph break]A corner of his mouth rises in pride. 'And she did,' he finishes.".

Understand "nabe" as sc_nabe. sc_nabe is a beat in SuppC with keyword name "Nabe" and reaction "'Mmm,' he says fondly, 'yes. After fears and years of wandering I decided I wanted to study and learn, so I sculpted myself to a place where I could.'[paragraph break]He scratches his beard slowly, leaning back with a smile. 'A stunning world,' he says, 'endless but endless archipelagos and island clusters, elegant simple nanotechnology that kept their world so fresh it was like every sunrise was scrubbed clean-- and the University, spread out on twelve little islets called The Nabe, where twelve thousand students from fifteen planets had come to study under the best best. And what wonderful times we had,' he says fondly, 'gushing and trickling wonderful.'".

Understand "rainforest" as sc_rainforest. sc_rainforest is a beat in SuppC with fuse 9999 and keyword name "rainforest" and reaction "'Dangerous,' he says, [animus-business]. 'Wild [sc_boar] with tusks out to here, rubbery vines to trip your feet, sudden drop-offs, and-- something else,' he finishes with a frown. 'The [sc_creeper] or whatever it really is. I'd stay out of there, were I you.'". goliath trees references sc_rainforest. 

Understand "creeper" as sc_creeper. sc_creeper is a beat in SuppC with keyword name "creeper" and reaction "'I know it sounds crazy,' he says shrugging, 'but there's something over there, something I don't like. I haven't been over to that side of the island in green eons and I don't intend restarting now. Crazy, superstitious, call me whatever you like, but that's as that as that.'".

Understand "boar" as sc_boar. sc_boar is a beat in SuppC with keyword name "boar" and reaction "'Loathsome creatures,' he says, 'but the only thing big enough here to have a hide that can be used for canvas. I suppose you'll have to face one eventually, if you're to leave here.'".

Understand "egg" as sc_egg. sc_egg is an annoying beat in SuppC with fuse 9999 and keyword name "egg" and reaction "He frowns, first scratching and then rubbing the side of his head with his knuckles. 'I'm really developing the most resounding headache,' he says, 'all these questions are climbing up my nerves. No, I don't remember anything like that in there; probably just a queer [sc_egg2].'". sc_egg2 replaces sc_egg. egg-proper references sc_egg.

Understand "stone/egg" as sc_egg2. sc_egg2 is a terminal beat in SuppC with keyword name "[if last beat is sc_egg]stone[otherwise]egg" and reaction "'Moisty hells, I'm sure it's nothing to get upended over,' he says. 'Why don't you soar off for a span, taking these nosing questions elsewards.' [Progue-resumes].".

Understand "pyramid/thing" as sc_pyramiddist. sc_pyramiddist is an annoying beat in SuppC with fuse 9999 and keyword name "[if noun is sc_boiler]thing[else]pyramid" and reaction "'What, that thing up on the mountain?' he says, frowning. 'It's always been there, I'm trickling sure. Just a--' he waves his hand. '--an optical formation or natural illusion or something thatwise. Utterly uninterestingly unimportant.'". distant-pyramid references sc_pyramiddist. Check examining by name distant-pyramid: if sc_pyramiddist is available, try discussing sc_pyramiddist instead. sc_pyramid replaces sc_pyramiddist.

Understand "pyramid" as sc_pyramid. sc_pyramid is an annoying beat in SuppC with fuse 9999 and keyword name "pyramid" and reaction "'What are you telling me about it for and why are you still fiddling with it?' Progue shouts, suddenly angry. 'Told you, it's not something important. Why don't you soar off and leave me lonewards for a span, hmm?' [Progue-resumes].". sc_family replaces sc_pyramid.

Understand "door" as sc_door. sc_door is a beat in SuppC with fuse 9999 and keyword name "door" and reaction "[if dtod_intro is spoken]'It was-- well a shock really I suppose, when I saw you'd opened it,' he says. 'I hadn't seen it open in green eons; the searing reality of that, of what it looked like, do you ring, openwise--' He shrugs. 'Something in the braincase just clicked and said you must and must be real, after alls. And well it was something surprising.'[else]'Built that to keep the girls out of the caldera,' he says, 'I think. Didn't know how active it was in there at first.'[end if]". lava tunnel door references sc_door.

Before discussing sc_door: if lava tunnel door is closed and Jumble is unvisited and story mode, now sc_door enqueues sc_opendoor; else now sc_door enqueues nothing; continue the action.

sc_opendoor is a repeatable beat in SuppC with reaction "'Say,' he adds, 'did you want me to open it for you?'". The yes-beat of sc_opendoor is sc_opendooryes. The no-beat of sc_opendoor is sc_opendoorno. sc_opendoor suggests sc_opendoorno.

sc_opendooryes is a beat in SuppC with keyword name "yes" and reaction "'Well that's fine then,' he says, 'since I already did. Wouldn't go in there myself, but if you care to it's all open now.'". After discussing sc_opendooryes: now lava tunnel door is open; continue the action.

sc_opendoorno is a repeatable beat in SuppC with keyword name "no" and reaction "'Good,' he says, relieved, 'since I'm gushing sure I don't remember how. Probably for the best at any rate.'".

Understand "cave" as sc_cave. sc_cave is a beat in SuppC with fuse 9999 and keyword name "cave" and reaction "'Hmm? Vaguely familiarish I suppose,' he says. 'Think I think I noticed it on my initial survey, never went back. Nothing much to see.'". series of sketches references sc_cave.

Understand "boiler" as sc_boiler. sc_boiler is a beat in SuppC with fuse 9999 and keyword name "boiler" and reaction "'Ah,' he says, 'to channel the steam, if you ring. Mostly really for the--' he waves at the mountain. '--The [sc_pyramiddist] up there, such tremendous amounts of power it guzzle-guzzled, but then was useful for the [sc_ropeway] to get everything up there, and for the [sc_bridge]. Quite a feat, quite an engineerish challenge. Kept the hands busy when they needed busying, I suppose.'". brick boiler references sc_boiler.



Chapter - Suppression Conversations

[ During this phase, the focus on random conversation is less on what Progue is doing and more on his growing relationship to the player and his growing memories of the past. In the earlier type, the player is given a chance to either confirm the path they're on or refute it. Progue is more introspective, remembering things about his old life, but also in some ways struggling not to remember. Things remind him, trigger memories, etc.

Another conversation during this phrase is Suppression Interrupted, if the player accosts Progue on his way somewhere. Progue will be vaguely impatient.  ]


Section - Suppression Dislike Convo

[Chance to make amends with Progue if we've pissed him off, or make things worse.]

Suppression Dislike Convo is a serendipitous rerunnable frequent triggered episode. The subchange beat is silence. The boredom beat is silence. The bye beat of Suppression Dislike Convo is silence. The abruptbye beat is silence. The icebreaker is sc_unfriendlyconversation.

Last condition rule for Suppression Dislike Convo:
	if affinity of Progue < -1, rule succeeds.

sc_unfriendlyconversation is a insistent beat with reaction "'[if sc_attack2 is spoken]Come to beat up some more on an old man, eh?[otherwise if sc_push2 is spoken]Come to shove around a sick old man some more, eh?[otherwise if pd_disgusted is spoken]Come to keep pestering me incessantly and drive me further down the road to madness, eh?[otherwise]I'm not quite sure we're getting along, you and I, eh?[end if]' he says sourly. 'Have anything to say to me?'". sc_unfriendlyconversation summons sc_unfsorry. The no-beat of sc_unfriendlyconversation is sc_unfno. sc_unfriendlyconversation suggests sc_unfno. sc_unfc2 replaces sc_unfriendlyconversation.

sc_unfc2 is a repeatable beat with reaction "He looks up warily. 'Greetings, then,' he says, 'what do you want?'".

Understand "sorry" as sc_unfsorry. sc_unfsorry is an affinitive beat with keyword name "sorry" and reaction "'Well, that's all right,' he says, [animus-business]. 'Really, after all this time alone I expect I'm just working out years of repressed aggressive tendencies. Well, what would you like to talk about?'". 

sc_reallyunfriendly is a repeatable terminal beat with reaction "'[one of]I'm afraid I don't have much to say to you,[or]I really don't care to speak with you any more,[or]What, you again?[in random order]' [the Progue] says [one of]shortly[or]curtly[or]warily[in random order]. '[one of]You know the old expression. Fool me twice but never thrice.[or]Come with another false apology to trick me with again?[or]This time your reputation precedes you.[in random order] [one of]Until you're prepared to back up your sugared words with actions, I'm afraid we shan't and can't be friends. Oh well oh.[or]You're going to have to try a slip harder this time if you honest expect me to think of you friendwards[or]I'm not just going to take your word for it this time; you're going to have to prove to me that you want to be friends[in random order].' [Progue-resumes].".

sc_unfno is a terminal repeatable beat with keyword name "no" and reaction "The old man raises his eyebrows wryly. 'Well, in that case,' he says, [animus-business], '[one of]I'm afraid we don't have much to talk about.[or]Soar off.[or]why don't you go away?[in random order]'". After discussing sc_unfno: now sc_reallyunfriendly replaces sc_unfriendlyconversation; continue the action. 

Section - Suppression Animus Convo

Suppression Animus Convo is a serendipitous rerunnable guaranteed triggered episode. The subchange beat is silence. The boredom beat is silence. The bye beat of Suppression Animus Convo is silence. The abruptbye beat is silence.

Last condition rule for Suppression Animus Convo:
	if a random chance of 1 in 2 succeeds, rule succeeds.

First commencement rule for Suppression Animus Convo:
	ignore the Progue begins episode dialogue rule;
	pre-conversation processing;
	force discuss sc_intro;
	[ if Progue doesn't like us, we have a few "nasty" conversations to choose from. ]
	[ if Progue is doing an activity we have a conversation for, potentially discuss that ] 
	if the animus of Progue is ruminating and a random chance of 2 in 3 succeeds:
		force discuss sc_ruminating;
	otherwise if ( the animus of Progue is mending or the animus of Progue is fishing or the animus of Progue is beach-combing ) :
		if dc_fishing is unspoken and the animus of Progue is fishing:
			force discuss dc_fishing;
		else if dc_mending is unspoken and the animus of Progue is mending:
			force discuss dc_mending;
		else if dc_combing is unspoken and the animus of Progue is beach-combing:
			force discuss dc_combing;
		else:
			force discuss sc_lifecontinues;
	otherwise if the animus of Progue is cleaning:
		force discuss depc_departureprepping;
	[ otherwise, make general conversation. ]
	otherwise:
		force discuss sc_makeconversation. 

First finishing rule for Suppression Animus Convo:
	if Progue is idle, rule succeeds.

sc_intro is a repeatable beat in DenialC with reaction "Progue looks up from his [Progue-animus] and nods[if we are going or we are landmark-going] as you approach[end if], [attitude-business]."

Section - Suppression General Convo

Suppression General Convo is a serendipitous rerunnable frequent triggered episode. The subchange beat is silence. The boredom beat is silence. The bye beat of Suppression General Convo is silence. The abruptbye beat is silence. The icebreaker is sc_makeconversation.

Last condition rule for Suppression General Convo:
	if a random chance of 1 in 2 succeeds, rule succeeds.

First finishing rule for Suppression General Convo:
	if Progue is idle, rule succeeds.

sc_makeconversation is a repeatable beat in SuppC. Check discussing sc_makeconversation:
	if paternalism of Progue > 2 and a random chance of 1 in 2 succeeds and sc_chatpat1 is unspoken begin; force discuss sc_chatpat1 instead;
	otherwise if romance of Progue > 0 and ( animus of Progue is fishing or animus of Progue is frog-catching or animus of Progue is beach-combing ) and sc_chatrom1 is unspoken; now caught-frog is true; force discuss sc_chatrom1 instead;
[	otherwise if submission of Progue < -2 and a random chance of 1 in 2 succeeds and sc_chatunsub1 is unspoken; force discuss sc_chatunsub1 instead;]
	otherwise if submission of Progue > 2 and a random chance of 1 in 2 succeeds and sc_chatsub is unspoken; force discuss sc_chatsub instead;
	otherwise;
		let beatlist be {sc_chat1, sc_chat2, sc_chat3, sc_chat4};
		remove the list of spoken beats from beatlist;
		sort beatlist in random order;
		if the number of entries in beatlist is at least 1 begin;
			force discuss entry 1 of beatlist instead;
		else;
			if a random chance of 1 in 2 succeeds, force discuss sc_lifecontinues instead;
			else force discuss sc_chat4 instead;
		end if;
	end if.

[sc_chatrom1: flirting banter]
sc_chatrom1 is a beat in SuppC with reaction "'Well oh well oh,' Progue says with a flash of a grin, 'look looky who. You're just in time; come see. Come on.' He waves you closer.[paragraph break]'Now look here,' he says. [if animus of Progue is fishing]I've got a fighter on the line here. Go on, take it.' He hands you the [o]pole[x][otherwise if animus of Progue is frog-catching]I've got my hands on a real beauty here. Go on, take it.' He holds out the [o]frog[x] to you[otherwise if animus of Progue is beach-combing]I've found a baby crab. Go on, hold it.' He holds out the tiny [o]crab[x] to you[end if].". After discussing sc_chatrom1: if animus of Progue is beach-combing, move baby crab to location; if animus of Progue is frog-catching, move frog to location; if animus of Progue is fishing, move fishing-pole to location; continue the action. 

Instead of getting bored when last beat is sc_chatrom1, force discuss sc_chatromnobait. sc_chatromnobait is an annoying beat in SuppC with reaction "'Oh well, never mind then,' Progue says, a bit crestfallen. 'Was there something you wanted to ask me about?'".

A baby crab is an animal. 

Taking baby crab is promtriggering. Taking frog is promtriggering. Taking fishing-pole is promtriggering. Examining baby crab is promtriggering. Examining frog is promtriggering. Examining fishing-pole is promtriggering. Instead of promtriggering when last beat is sc_chatrom1 (this is the sc_chatrom_override rule): force discuss sc_chatrom1b. The sc_chatrom_override rule is listed first in the instead rules.

sc_chatrom1b is an insistent beat in SuppC with reaction "'Good,' Progue says, beaming. '[if animus of Progue is fishing]Now what you want to do is just jerk the line, like so-- there you are[otherwise]No, don't crush him; keep your hand open, like a finger cage-- there you are[end if].' He puts his hand [if animus of Progue is fishing]back on the fishing pole[otherwise]on top of yours[end if] to guide you, and you wonder whether to [sc_chatrom1shift] your grip to avoid the touch, or let things [sc_chatrom1stay] as they are.". sc_chatrom1b summons sc_chatrom1shift, sc_chatrom1stay.

Understand "shift" as sc_chatrom1shift when last beat is in SuppC. sc_chatrom1shift is an unromantic beat in SuppC with keyword name "shift" and reaction "You shift your grip ever so slightly, and see Progue's hands do the same in response.". sc_chatrom1shift enqueues sc_chatrom1c.

Understand "stay" as sc_chatrom1stay when last beat is in SuppC. sc_chatrom1stay is a romantic beat in SuppC with keyword name "stay" and reaction "His fingers are strangely warm, calloused and roughened but guarding, you can feel, an almost electric power.". sc_chatrom1stay enqueues sc_chatrom1c.

sc_chatrom1c is a beat in SuppC with reaction "'There you are,' he says as you [if animus of Progue is fishing]pull in a flopping silvery fish[otherwise]peer intently at the tiny creature, breathing shallowly in your palm[end if]. 'Nicely done, nicely done. Easy there, wasn't it?' He takes [if animus of Progue is fishing]the pole back[otherwise]the small creature back[end if] and smiles. 'Now, was there something you wanted to ask?'".


[sc_chatpat1: fatherly reminiscing]
sc_chatpat1 is an insistent beat in SuppC with reaction "'[if player is female]Strange to say I know,' he says, squinting at you, 'but you have something in you of my [sc_girls]. Inquisitiveism; stubbornness; or perhaps just an eyelash or two in the right position.[otherwise]Strange to say I know,' he says, squinting at you, 'but I recognize something in you in me. Mayhaps I'm just missing my [sc_girls], but well and there.[end if]' He smiles. 'Mayhaps coincidence,' he says, 'but I wonder if the reminding goes both ways. Do tell and be true: do I seem at all like your father?'". The yes-beat of sc_chatpat1 is sc_chatpatyes. The no-beat of sc_chatpat1 is sc_chatpatno. 

sc_chatpatyes is a paternal beat in SuppC with keyword name "yes" and reaction "You can tell he is pleased, though he tries a little to hide it. 'Thoughts alike,' he says. '[if rev_call is spoken]The Call has sent[otherwise]Strange fates send[end if] me a surrogate [if player is male]son[otherwise]daughter[end if]. Fraid the inheritance is a bit sparse, though if property prospectors ever discover this world it might seem a better deal.' He laughs. 'What can I help you with?'".

sc_chatpatno is a unpaternal beat in SuppC with keyword name "no" and reaction "'Probably for the best,' he says archly, 'as I true and do hope that means your fath was less mad, more clean, and gushing more amusing than your friend [sccpn-name].' He winks. 'Now, what can I help you with?". To say sccpn-name: if player-name-guess is not "no.guess", say "[player-name-guess] -- or rather Progue"; otherwise say "Progue".  

[sc_chatsub: submissive stuff]
sc_chatsub is a beat in SuppC with reaction "He looks up nervously as you approach. 'Well and oh, hello,' he says. 'Sorries, did you want to use this bit of [surface-material] for something? I can move along, really I can. Shall I then?'". The yes-beat of sc_chatsub is sc_csyes. The no-beat of sc_chatsub is sc_csno. sc_chatsub suggests sc_csyes.

sc_csyes is a submissive terminal beat in SuppC with keyword name "yes" and reaction "'Ah! Oh! Nothing problems at all,' he says [if affinity of Progue > 0]sincerely[else]with a touch of ingratiating sarcasm[end if], brushing himself off and preparing to leave. 'Please and please, it's all yours.'". After discussing sc_csyes: Progue's life goes on; follow the Progue's motivation rule.

sc_csno is an unsubmissive beat in SuppC with keyword name "no" and reaction "'Oh! Kind of you,' he says, [animus-business]. 'I was in the middle of this after all. Well oh, is there something you'd like to talk about then?'". 

[sc_chatunsub1: dominant stuff]
[Here we have a test to see whether the player wants Progue's dominant role to continue, by having him ask the player to do something relatively arbitrary and see if the player does it. Of course, players are used to being asked to do arbitrary things by game characters, so--- ?

Progue asks, which triggers a scene which keeps a relevant topic in the topic list. After a reasonable amount of time, Progue decides the player has failed; the topic switches to a one-off notice of failure and Progue adjusts his attributes. If the player succeeds within the time limit, the topic changes again.
]

[Understand "steamm" as sming. sming is an action applying to nothing. Carry out sming: force discuss sc_chatunsub1.

sc_chatunsub1 is an insistent beat in SuppC with reaction "'I notice you're still tromping around the dangerous part of the island, despite my advice to the contrary,' he says [if affinity of Progue > 0]with a smile[otherwise]with a frown[end if]. 'As long as you're being foolish, I wonder if you'd run your little legs over there and do me a favor. Interested?'". The yes-beat of sc_chatunsub1 is sc_cus1yes. The no-beat of sc_chatunsub1 is sc_cus1no.

sc_cus1no is a submissive beat in SuppC with keyword name "no" and reaction "'Oh,' Progue says. 'Well in that case, never mind, I suppose. Just seemed as if you really had nothing better to do, [animal-nickname]. Now let's see then, was there something you wanted?'".

sc_cus1yes is a beat in SuppC with keyword name "yes" and reaction "'Splend,' he says. '[if player wears compass]I see you've found that old compass of mine[otherwise]In the cabin on the beach should be an old compass of mine[end if]. Run it up to the top of the volcano and peer out at that cloud of steam off to the south, and try and see if you can squeeze which direction the wind out there's blowing.' He stops for a moment to cough. 'There's something strange going on with the tides and the weather,' he adds, 'and I want to see if this wind we're having is constant.'". After discussing sc_cus1yes: now distant column of steam references sc_cus1noresults.

Progue-Steam-Mission is a scene. Progue-Steam-Mission begins when sc_cus1yes is spoken.

[Every turn when Progue-Steam-Mission is happening and an unimportant episode is playing:
	if sc_cus1done is true begin;
		remove sc_cus1noresults from list of convo stuff, if present;
		add sc_cus1results to list of convo stuff, if absent;
	otherwise;
		add sc_cus1noresults to list of convo stuff, if absent;
	end if.]

Progue-Steam-Mission ends successfully when sc_cus1results is spoken. Progue-Steam-Mission ends unsuccessfully when the time since Progue-Steam-Mission began is at least 4 hours. When Progue-Steam-Mission ends unsuccessfully: add sc_cus1fail to list of convo stuff; remove sc_cus1noresults from list of convo stuff, if present; remove sc_cus1results from list of convo stuff, if present. When Progue-Steam-Mission ends successfully: remove sc_cus1noresults from list of convo stuff, if present; remove sc_cus1results from list of convo stuff, if present; remove sc_cus1fail from list of convo stuff, if present.

Instead of examining distant column of steam when compass is open and Progue-Steam-Mission is happening: add sc_cus1results to list of convo stuff, if absent; remove sc_cus1noresults from list of convo stuff, if present; say "Comparing the steam carefully with the compass, it looks as if the wind is blowing more or less due east.". 

Understand "favor" as sc_cus1noresults when last beat is in SuppC. sc_cus1noresults is an ephemeral beat in SuppC with keyword name "favor" and reaction "'Haven't you gotten it yet?' the Progue says. 'What's keeping you? Pressing social engagements? Terrible traffic through the treehouse district? Get on with it!'".

Understand "favor" as sc_cus1results when last beat is in SuppC. sc_cus1results is a unsubmissive affinitive ephemeral beat in SuppC with keyword name "favor" and reaction "'Interesting,' the Progue says, musing, 'east you say? That's not right at all for this time of year, no, no. East. Hrmph. Strange things happening. Keep the eyes wide.'".

Understand "favor" as sc_cus1fail when last beat is in SuppC. sc_cus1fail is a submissive ephemeral beat in SuppC with keyword name "favor" and reaction "'Oh,' Progue says, 'I gave up on you. Forgot all about it. Next time be a little more punctual, will you?'".]

[sc_chat1: random banter]
sc_chat1 is a beat in SuppC with reaction "'Hello and hello. [last-ep-msg-supp]What have you been playing at this [progue-time-of-day], eh?' he asks, [animus-business]. 'Bits of [sc_exploring], maybe? Trying to [sc_gather] what you need to move on? Or just [sc_lounging] around enjoying the sunlight?'". sc_lifecontinues replaces sc_chat1.

Understand "exploring" as sc_exploring when last beat is in SuppC. sc_exploring is a beat in SuppC with keyword name "exploring" and reaction "'Ah yes, adventure, mystery, exploration,' he says with a fond smile. 'And so much on my Lacuna to discovery. Found the [sc_bees] yet? Or all those gushing [sc_windsigh] trees?'". 

Understand "gather" as sc_gather when last beat is in SuppC. sc_gather is a beat in SuppC with keyword name "gather" and reaction "'I can certainly understand your anxiousness,' he says. 'You'll be having a life to get on with, places to explore, distressees to rescue. Well, don't get upended; we'll have you ready for your [depc_departure] before long.'".

Understand "lounging" as sc_lounging when last beat is in SuppC. sc_lounging is a beat in SuppC with keyword name "lounging" and reaction "'Ah, well,' he says, 'such a beautiful place for it, eh? All this abandoned art: [sc_sculpture], [sc_paintings], even that ridiculous [sc_ropeway] is pretty when the light hits it right.'".

[sc_chat2: random banter]
sc_chat2 is a beat in SuppC with reaction "'Something's been trickling [sc_queer] out in the ocean this [Progue-time-of-day],' he says, [animus-business]. 'I found one of the deep [sc_jellyfish] washed up on the beach, but they aren't due back for months. Strange as strange.'". sc_lifecontinues replaces sc_chat2.

Understand "queer" as sc_queer when last beat is in SuppC. sc_queer is a beat in SuppC with keyword name "queer" and reaction "'Can't put fingers to it,' he says reflectively, 'but lie assured there's something strange out there. Ah well-oh. Oceans are vast and cruel and ever ever so snobbishly haughty. Never let the ocean feel intellectually superior to you, my friend, or you're good as dead. Now, what shall we talk about today?'". bp_wordday suggests bp_hallucination. 

[sc_chat3: random banter]
sc_chat3 is a repeatable beat in SuppC with reaction "'Popped into the old beach cabin a while ago and noticed you'd left some things out,' he says, [animus-business]. 'Some sort of [sc_sketchbook] or something thatwise. Now I don't mean to nag but let's do try and keep things tidy around here while we prepare your [depc_departure], shall we?'". sc_lifecontinues replaces sc_chat3.

sc_chat4 is a repeatable beat in SuppC with reaction "'I hope you're prepping for your [depc_departure],' he says, [animus-business]. 'Lots to do and due to lots.'". 

[sc_ruminating: thoughtful reflection]
sc_ruminating is a beat in SuppC with reaction "[one of]He looks off into the distance again[or]He seems only half-aware of you, still lost in dark reflection[in random order]. 'Sorries,' he says, 'just thinking. Remembering, I suppose. Out of practice at both.' He closes his eyes. 'Or maybe maybe they're the same thing,' he says, 'in two subtle-different [sc_shades].'[paragraph break]He takes a breath. 'What can I do for you then?' he asks.". sc_makeconversation replaces sc_ruminating.

Understand "shades" as sc_shades. sc_shades is a beat in SuppC with keyword name "shades" and reaction "He doesn't respond for a long while, staring off towards the ocean with a bemused look, as if unsure whether something he ate had gone bad.[paragraph break]'Funny,' he says finally, 'something funny, isn't it? How we mourn the ones we left behind, we [if rev_wayfaring is spoken]wayfarers[otherwise]sojourners of worlds[end if]. Mourn them like dead, only they're not. Old friends, kin brothers and love brothers, lovers and strangers and half-acquaintanced drifters in our lives. Not true [sc_shdead], we mostly usually know and nod and accept; it's just it so feels that way to us, selfish we, because [sc_shthey][']ve gone from our lives, zoosh, real as eggs from airplanes, terminal and unreclaimable, gone as gone and gone.'". sc_shades suggests sc_shdead.

Understand "dead/mourn" as sc_shdead when last beat is in SuppC. sc_shdead is a beat in SuppC with keyword name "[if last beat is sc_shthey]mourn[otherwise]dead" and reaction "He turns to look at you, intently. 'But to themselves they live,' he says fiercely, 'still being some existence or trueness, elsewhen and otherwhere, and only the small sad percentage of their lives connected to us has gone, and what is that to anyone, eh? Even after lives entwined, years and fears together, what inner muchness of your life is your own and own alone, that none other knows or shares? Larger than any husband or wife, any brother or [sc_girls] would dare say aloud. Or alone.'[paragraph break]He turns back to the sea, energy spent. 'And that, [animal-nickname], that is why it hurts; the vacuum twixt the perspectives, that they can have died to us and go on living to themselves. That is the selfish truth that cores our pain. And that,' he says, with a twitch of a smile, 'is what I was thinking about. Now. Let's change the subject, shall we?'".

Understand "they" as sc_shthey when last beat is in SuppC. sc_shthey is a beat in SuppC with keyword name "they" and reaction "A half smile. 'I was thinking then when you came up of the strangest person,' he says. 'A girl at [sc_nabe] who I saw just once, out beyond the reef in little boats. We spotted each other in the blue distance and waved, and met up on the rowdy waves, laughing and introducing. We spoke only five minutes, I would guess, and later I saw her at distances but never details. But suddenly today I remember her and [sc_shdead], the yellow of her clothes, the giddy smile, words shared and connections made only by that brief meeting, boat prows kissing together on a clear blue day. I will never see her again, and I mourn.'". sc_shthey suggests sc_shdead.

[sc_lifecontinues: random actions remind Progue of past]
sc_lifecontinues is a repeatable beat in SuppC with reaction "'[one of]Just [Progue-animus] again,' he says, [attitude-business]. 'Seems like I've been [Progue-animus] at this spot for buckets of evers[or]Good [Progue-time-of-day] to you, [animal-nickname],' he says, [animus-business]. 'Just getting in a bit of [Progue-animus] in between all the question-and-answering you seem so fond of[or]I certainly love all this [Progue-animus],' he says fondly, [animus-business]. 'Reminds me of the old days. Well and but the new ones too, I suppose[in random order]. [last-ep-msg-supp][whatnow]?'". To say whatnow: say "[one of]What can I do for you[or]What are you into today[or]Have some more questions for me, I suppose then[or]Hope all's well[or]Good and good to spy you. What's going on[in random order]".

To say last-ep-msg-supp:
	if last episode is Let's Take A Soak Part Two, say "All unwrinkled and deshrivelled from our hot springs jaunt, I hope. ";
	if last episode is Simple Warning, say "Staying away from the pyramid, I hope. ";
	if last episode is Sand Construction, say "Still picking wet sand out from under my fingernails. ";
	if last episode is Long Walks, say "Been thinking a lot about our walk on the beach. ";
	if last episode is Feast of Submission, say "Certainly enjoyed our delicious dinner. ";
	if last episode is Dolphins Meeting, say "Been keeping an eye on those dolphins; who knows how long they'll stick about. ".

[depc_departureprepping: Progue talks about getting player ready for departure.]
depc_departureprepping is a repeatable beat in SuppC with reaction "'Haven't been in here for years!' he says happily, scrubbing dirt from the workbench furiously. 'Don't you worry, we'll get it cleaned up for you. Then you can be on your way!'".



Chapter - Revelations

[ This conversation happens after Progue has transitioned to Suppression. He says he needs some time to think and asks the player to meet him on the Rise at sundown. (Or, if it is already evening, at dawn.) Until then he ruminates. If the player bothers him before the allotted time, we trigger a brief message reminding the player to return later (and get annoyed if the player refuses). If the player misses the allotted meeting, we adjust submission and have Progue start player-seeking the next day. If Progue already dislikes the player too much, ???

The conversation begins with a mini-monologue by Progue explaining his thoughts. He remembers he was a Wayfarer, now. Will answer questions about wayfaring, sculptures. Admits that the girls were his daughters, but that he doesn't know what happened to them. "I've forgotten so much." He remembers what's up with the trees (although not the ultimate conclusion), but lies to the player and pretends he doesn't-- "The Creeper, maybe it's something I made up, maybe not. But I know the east island is dangerous."

He has no idea why you were called; he didn't want anyone to come and doesn't know what you can do. He tells you he is dying. 
 ]



Building To Revelations is a guaranteed triggered instant rerunnable episode. The subchange beat is silence. The boredom beat is silence. The bye beat of Building To Revelations is silence. The abruptbye beat is silence. 

A condition for Building To Revelations:
	if the psyche of Progue is suppression and the episodic status of Suppression Revelations is unaired and Tsunami Sequence is not happening, rule succeeds.

A commencement rule for Building To Revelations:
	Progue starts ruminating;
	if Progue is booked for Suppression Revelations:
		do nothing;
	else:
		if night or dawn or sunrise or morning or midmorning or midday or afternoon, schedule Progue for Suppression Revelations at evening;
		otherwise schedule Progue for Suppression Revelations at morning.

Every turn when current episode is Building To Revelations:
	now the animus of Progue is ruminating;
	if Progue is booked for current interval or the psyche of Progue is not suppression, complete Building To Revelations. 

Instead of greeting Progue when Progue is booked for Suppression Revelations: choose row with an event of Suppression Revelations in Table of Progue's Appointment Book; say "[The Progue] frowns, not looking at you. 'Not now,' he says. 'On the rise, at [date entry], like I said.'".

A finishing rule for Building To Revelations:
	if Tsunami Sequence is happening, rule succeeds.

Suppression Revelations is a guaranteed rendezvous triggered episode. The expiration date is 6 hours. The icebreaker is rev_intro. The meeting place is Rise. The bye beat is p_supp_unavailable. The subchange beat is p_supp_unavailable.

A completion rule for Suppression Revelations:
	if rev_intro is unspoken, begin Makeup-Revelations;
	now Building To Revelations is one-shot;
	now Progue references depc_departure;
	choose a blank row in Table of Progue Suppression Endeavours;
	change pick entry to cleaning;
	Progue's life goes on;
	follow the Progue's motivation rule.

Table of Progue's Initial Appearance (continued)
animus	episode			desc
--		Suppression Revelations		"Standing by the drop-off to the sea, staring wistfully out into the waves, is Progue."

Table of Progue's Description (continued)
animus	episode			desc
--		Suppression Revelations		"He seems changed somehow, almost a different person."

REV is a thread. The escape clause is rev_call.

rev_intro is an unsubmissive [because if we show up, we've done something he told us to do] nonverbal beat in Rev with reaction "He looks up and nods. '[if sunrise or morning or evening]Just on time,' he says lightly, 'I thank you for your punctuality[otherwise]A bit late,' he says lightly, 'You've kept me waiting, but [']salright, [']salright, it's not as if I have much else to do[end if].' He smiles, but some of the carefree whimsical quality he had before is gone, replaced with a touch of sadness he tries hard to conceal, and he pauses for a moment to gather his thoughts.". rev_intro suggests rev_intro2. rev_intro summons rev_listen. rev_listen is beat in rev with keyword name "listen" and fuse 2.

rev_intro2 is a beat in Rev with reaction "'[if Progue is unnamed]My name is Progue Attay,' he says, 'and apologies for my earlier behavior. [else]Apologies then I suppose, for my earlier behavior,' he says. '[end if]I've been alone for too too long, and when you appeared, I-- well, assumptions.' He smiles. 'But you are here, and you're not the-- the [rev_creeper], and now I remember who I am. A... a [rev_intro2_bit].'[paragraph break]He takes a deep breath, then laughs once, loudly. 'Explanations,' he says, 'are owed along so many axes. Tell me then where I should begin?'". rev_intro2 summons rev_father, rev_madman, rev_sculptor. rev_intro2 suggests rev_silence. After discussing rev_intro2: now Progue is named; continue the action.

rev_silence is a beat in Rev with reaction "'I'm not sure [if cc_father is unspoken and cc_sculptor is unspoken and cc_madman is unspoken]where to begin[otherwise]what else to talk about[end if] either,' he says sadly. 'Let me think.'". rev_silence enqueues rev_now. rev_yourgift replaces rev_silence.

To say rev_intro2_bit:
	if cc_father is spoken:
		say "[rev_father], first, as you said. But I am-- was--' he pauses, face screwed up in pain for a moment. 'I don't know the tense any more,' he finally says. 'Was? Am? Will be? A [rev_sculptor]. I don't know. Let's unconjugate it. To be a sculptor, I, and also, I suppose, a [rev_madman]";
	else if cc_sculptor is spoken:
		say "[rev_sculptor], first, as you said. Though large years have shambled by since last I lived up to that title. And also a [rev_madman], as I'm sure you've had noticed, and... and a [rev_father]. Yes. And that too";
	else if cc_madman is spoken:
		say "[rev_madman], first, as you said. After twenty years alone, abandoned, perhaps that is all I will ever be again. But also I am-- was--' he pauses, face screwed up in pain for a moment. 'I don't know the tense any more,' he finally says. 'Was? Am? Will be? A [rev_sculptor]. I don't know. Let's unconjugate it. To be a sculptor, I, and also, I suppose, a [rev_father]. Yes. And that too";
	else:
		say "[rev_father], a [rev_sculptor], and a [rev_madman], as you said-- all three".

rev_whatelse is a repeatable beat in Rev with reaction "[one of]He sighs. 'What else can I tell you?' he asks[or]He takes a deep breath. 'What other questions can I answer?' he says[or]He smiles a little. 'What next?' he says[in random order].". After discussing rev_whatelse: if we have not discussed rev_father, now tempfuse of rev_father is 5; if we have not discussed rev_creeper, now tempfuse of rev_creeper is 5; if we have not discussed rev_sculptor, now tempfuse of rev_sculptor is 5; if we have not discussed rev_madman, now tempfuse of rev_madman is 5; continue the action. Before discussing rev_whatelse: if rev_father is spoken and rev_sculptor is spoken and rev_madman is spoken begin; now rev_whatelse is unrepeatable; now rev_whatbroughtyouhere replaces rev_whatelse; end if; continue the action. rev_whatelse suggests rev_silence.

Understand "creeper" as rev_creeper when last beat is in Rev. rev_creeper is a beat in Rev with fuse 5 and keyword name "Creeper" and reaction "He paces back and forth a little, frowning in the [progue-time-of-day] light. 'Look,' he says finally, 'only dimly can I imagine what you think of me now, and I know the whole Creeper story seems preposterous, but...' He stops and looks directly at you. 'I don't know, but there is something, what, dangerous. Over therewards in that part of the island. I can't explain, but part of me,' he draws a deep breath, 'knows. Be careful.'". rev_creeper suggests rev_whatelse.

Understand "father" as rev_father when last beat is in Rev. rev_father is an insistent beat in Rev with fuse 5 and keyword name "father" and reaction "He rubs his knuckles along the side of his head for a long moment, avoiding your gaze, then finally sighs. 'Yes,' he says, 'they were my daughters. The two-- two little girls. How could I have forgotten? Phoebe and-- and Lethe. Yes, Lethe. My angels. I-- I brought them here, I think but-- but I don't know where they are now.' He smiles sadly. 'They've left, I suppose. They're like me, like us. Travelers. Shifters and drifters. What-- what was your word for it?'". rev_father summons rev_wayfaring, rev_wfshrug. rev_father suggests rev_wfshrug. The maybe-beat of rev_father is rev_wfshrug.

Understand "wayfaring" as rev_wayfaring when last beat is in Rev. rev_Wayfaring is an impressive beat in Rev with keyword name "wayfaring" and reaction "'Yes,' he says, 'Wayfaring. A good word. I'll have to remember that next Word Day.' He grins a little.". rev_wayfaring enqueues rev_whatelse.

rev_wfshrug is an annoying beat in Rev with keyword name "shrug" and reaction "'Oh well,' Progue says, frowning a little, 'the important thing is that we're the same. Wanderers of worlds, rootless.'". rev_wfshrug enqueues rev_whatelse.

Understand "sculptor" as rev_sculptor when last beat is in Rev. rev_sculptor is a beat in Rev with fuse 5 and keyword name "sculptor" and reaction "'Yes,' he says, ghosts of old memories lighting his face, 'always been a sculptor, since I was a child. I remember some of it, now, bits and fractures of the worlds I turned through. Beauty, terror, and always homeless. What strange times, like dream-pieces swept into a box, clouds of must pillowing out now I've opened it unexpected...'

He shakes his head. 'But no. Now you're here too. And it is memory, not fantasy, I'm gushing sure.  Once I was a [if rev_wayfaring is spoken]wayfarer[otherwise]shifter of worlds[end if], but [rev_now]...' He trails off.". rev_sculptor suggests rev_now. rev_sculptor cancels rev_father, rev_creeper, rev_madman.

Understand "now" as rev_now when last beat is in Rev. rev_now is a beat in Rev with keyword name "now" and reaction "He sighs. 'There are twisted holes in my mind, lacunae where memories once gelled. I remember we came here after terrible tragedy, years and fears ago. I remember long eons of madness. The transition has slipped, spaces between melted somehow and vanished.'

He flexes his bare feet on the [surface-material], gripping it carefully. 'When memories light up again on the other side,' he says sadly, 'I was no longer [if rev_wayfaring is spoken]a Wayfarer[otherwise]what I once was[end if]. I tried; oh, true as true, I tried. But whatever magic I once had caged in these hands, whatever power Something Further gifted, well. Gone. My sculptures were just sculptures. I remained. And now I haven't even touched hammer and chisel since grey hairs were black as black and black.'". rev_now enqueues rev_whatelse. rev_yourgift replaces rev_now.

Understand "madman" as rev_madman when last beat is in Rev. rev_madman is a beat in Rev with keyword name "madman" and reaction "He half-grins. 'Sounds so unnatural here and now when you say it. But when one's alone-- when one is all of humanity-- however one acts defines normality for the species. Or mayhaps man is man only to man, and I was not man at all these past years and years. Mayhaps I only became man again when you saw me screaming words at the ocean from bouldertops. Your [if rev_wayfaring is spoken]wayfaring[otherwise]arrival[end if] brought me back to be.'". rev_madman enqueues rev_yourgift. 

rev_yourgift is an insistent beat in Rev with reaction "'And tell me, [animal-nickname],' he says suddenly, 'what is your gift? Not sculpting, I can tell from a glance at your hands, but [rev_painting] mayhaps? Or [rev_music]? Or [rev_storytelling] or something even more fantastical?'". rev_yourgift summons rev_giftshrug, rev_painting, rev_music, rev_storytelling. rev_whatbroughtyouhere replaces rev_yourgift. rev_yourgift suggests rev_giftshrug. The maybe-beat of rev_yourgift is rev_giftshrug. rev_whatbroughtyouhere replaces rev_yourgift.

Understand "painting" as rev_painting when last beat is in Rev. rev_painting is a beat in Rev with keyword name "painting" and reaction "His eyes light up. 'A painter!' he said. 'I thought so. Oh my oh. My daughters were painters, before--' He frowns. 'Before the [rev_creeper] took them or--' He trails off, becoming even more hesitant. 'Or whatever it was that happened all those years and fears ago.' He pauses for a moment, then touches your shoulder, briefly. 'Good,' he says, 'as a painter twill be easier for you to move on, when the time comes.'". rev_painting enqueues rev_whatelse. rev_painting cancels rev_music, rev_storytelling.

Understand "music" as rev_music when last beat is in Rev. rev_music is a beat in Rev with keyword name "music". rev_music enqueues rev_liar. rev_music cancels rev_storytelling, rev_painting.

Understand "storytelling" as rev_storytelling when last beat is in Rev. rev_storytelling is a beat in Rev with keyword name "storytelling". rev_storytelling enqueues rev_liar. rev_storytelling cancels rev_painting, rev_music.

rev_liar is a beat in Rev with reaction "He pierces your eyes with narrowed gaze for a long moment, then throws back his head and laughs.[paragraph break]'No no,' he finally says, 'you're liaring, but your deception proofs your truth. [werealike].'". rev_liar enqueues rev_whatelse.

To say werealike: say "We're alike, I and you and me, [if rev_wayfaring is spoken]Wayfarers[otherwise]travelers[end if] through infinite worlds, and some thread of connection runs betwixt us already that tells me things about us. From the mottling along the inside of your queen finger, and mayhaps something about that hair of yours, I'd guess and say you're a painter. Good. Makes it easier for you to move on, when the time comes".

rev_giftshrug is a beat in Rev with keyword name "shrug" and reaction "He grins, lopsidedly. 'Oh my oh, the mysterious stranger, quiet and ever so unfathomable. But I've got you marked, [animal-nickname]. [werealike].'". rev_giftshrug enqueues rev_whatelse.

[Understand "queen" as rev_queen when last beat is in Rev. rev_queen is a beat in Rev with keyword name "queen" and reaction "'Oh, just something we say wherever it is that I come from,' Progue says, holding up his hand, and taps each finger, starting at the thumb: 'Monk, queen, king, deacon, page. The Five Fingers.'". rev_queen suggests rev_whatelse.]

rev_whatbroughtyouhere is an insistent repeatable beat in Rev with reaction "'[one of]Now I'd[or]But I'd still[stopping] like to know something about you, [animal-nickname],' Progue says. 'Tell me do. What in worlds brought you here, now, and why?'". rev_whatbroughtyouhere summons rev_call. rev_whatbroughtyouhere suggests rev_whatbroughtyouhere. rev_whatbroughtyouhere cancels rev_creeper. 

[Work in reference to the windsigh here.]Understand "call" as rev_call when last beat is in Rev. rev_call is a terminal beat in Rev with keyword name "call" and reaction "He looks at you for a long moment, hesitant, as if trying to parse your words in some different way. Finally he looks away.[paragraph break]'Something Further,' he whispers, '[if The-Path-Of-Love has happened]after all this time[else]how many things there are to remember[end if]. The Call.' He takes a deep breath. 'I never had a name for it, myself, but yes, that fits. Fits. Well. But.'

He turns back to you with a strange look of resignation, disappointment, trepidation. 'But here's the truth, and it's not one you want. But truths are like that. I don't know how to say it other than to say it, so here it is.'[paragraph break]'I didn't Call you, friend and never have,' he says firmly. 'There's nothing you can do for me, no help I've been waiting for. It's a mistake, some mix-up in the mash-up of the metacosmic switching station. If I could send you back of course I would but of course... I can't. I can't, and I'm sorry, and here we are.'[section break]He smiles suddenly. 'Moisty hells,' he says, 'No need to be depressed about it! Just because you're here by mistake doesn't mean you can't enjoy yourself! It's a beautiful island if you hadn't noticed. And I can help and help prepare for your departure. Yes, that's what I'll do. We'll have you painting your way away and onwards in grains of time.'". [rev_call summons rev_call2. ]



[ Alternative versions.]

[ If we miss our date with Progue, or don't trigger this before the Tsunmi. ]

Makeup-Revelations is a urgent episode. [manually begun if Revelations expires.] The icebreaker is rev_makeupintro.

rev_makeupintro is a submissive beat in rev with reaction "[if Tsunami Sequence is happening][the reaction of tcp_greeting][paragraph break]'[else]'There you are,' Progue says, frowning. 'I missed you earlier. We were supposed to meet on the rise, remember? Ah well-oh, not important. [end if]But there are some things, things that need discussing.' He pauses for a moment, seeming to collect his thoughts.". rev_makeupintro enqueues rev_intro2.


Chapter - Departure Subplot

[The player can go on a series of five "Quests" to gather the different colors of paint for Progue. For each color, they have to find the three locations where that item exists, collect the items in a basket, and return it to Progue. The point of all this is basically to give bored players something to do; in the process of exploring the island, they might uncover new hints towards puzzles, trigger new Drama Manager scenes, or pass enough time that an event like the Tsunami starts.]

To mark workbench cleaned:
	while cleaning is a pick listed in Table of Progue Suppression Endeavours:
		choose row with pick of cleaning in Table of Progue Suppression Endeavours;
		blank out the whole row;
	while cleaning is a pick listed in Table of Progue Uncertainty Endeavours:
		choose row with pick of cleaning in Table of Progue Uncertainty Endeavours;
		blank out the whole row;
	now wall to wall workbench is clean; 
	remove artisan tools from play.


DepC is a thread. 

Understand "departure" as depc_departure. depc_departure is a repeatable beat in SuppC with fuse 9999 and keyword name "departure" and reaction "[if wall to wall workbench is dirty][depcdirty][otherwise if 1 is a status listed in Table of Departure Quest][depcprogress][otherwise if the animus of Progue is paint-making][depcworkingnow][otherwise if there is a pick of paint-making in Table of Progue Suppression Endeavours or there is a pick of paint-making in Table of Progue Uncertainty Endeavours][depcmakingsoon][otherwise if unassigned departure quests][depcclean][otherwise][depcnomorequests][end if]". After discussing depc_departure: now tempfuse of depc_departure is 9999; continue the action.

To decide whether unassigned departure quests: if there is a status of 0 in Table of Departure Quest, decide yes; decide no.

To say depcdirty: say "[one of]'There's a number of things, a number of steps needed to prepare, if you're to fare on your way through painting,' Progue says, biting a lip and turning his head sideways. 'First but first and first I'll need to clean out the old studio in the [sc_cabin]. Come talk to me again after I've swamped it out, and we'll go over the details.'[or][stilldirty][stopping]". To say stilldirty: say "'Haven't gotten to it yet!' he says cheerfully. 'But I'll bump it higher up on my agenda.'". 

To say depcmakingsoon: say "'I'll mix that paint for you soon,' Progue says, 'and leave it in the studio.'".

To say depcworkingnow: say "'Working on it!' Progue says, stirring the pot vigorously.".

To say depcnomorequests: say "[if Tsunami Sequence has ended]'I've seen no sign of the rayfish since the tsunami,' he says, scanning the horizon and frowning. 'I'll keep an eye out for their return.'[otherwise]'Hmm,' he says, 'well the only color left is black, which comes from the rayfish. I'll go out some night soon and collect the ink.'[end if]".

To say depcprogress: say "'Coming along, are we?' he says. 'I'm anxious to get those "; choose row with a status of 1 in Table of Departure Quest; say "[item entry]!'".

To say depcclean: force discuss depc_clean. depc_clean is a beat in DepC with reaction "'The studio's all cleaned up,' he says, beaming brightly, 'so now there's a proper workspace for you. Well! We'll get you on your way, nothing to worry about. I suppose the next thing is start gathering up the materials you'll need for paints. Is that something you think you'd like to start on right away?'". The yes-beat of depc_clean is depc_quest. The no-beat of depc_clean is depc_noquest. depc_wantquest replaces depc_clean.

depc_wantquest is a repeatable beat in DepC with reaction "'Making progress!' he says. 'Would you like to help me find another paint color?'". The yes-beat of depc_wantquest is depc_quest. The no-beat of depc_wantquest is depc_noquest.

depc_noquest is a repeatable beat in DepC with reaction "'Perfectly understandable!' Progue says. 'Not trying to rush you! Take your time! Enjoy the island!'".

depc_quest is a repeatable beat in DepC with reaction "'Marvelous!' he says, pulling a small woven basket from somewhere and handing it to you. 'Take this and go and gather me some [quest_assignment], you ring. Mind you fill the basket up all the way! When you're done bring it back and I can mix you up some paint.'". After discussing depc_quest: move basket to player.

To say quest_assignment:
	sort Table of Departure Quest in status order;
	choose row 1 in Table of Departure Quest;
	now status entry is 1;
	now intended contents of basket is item entry;
	if item entry is:
		-- berries: say "berries. For the red paint"; 
		-- lemon-yellow leaves: say "windsigh leaves. For the yellow paint";
		-- small green mussels: say "mussels. For the green paint";
		-- sea-blue crystal: say "crystals. For the blue paint";
		-- white snail: say "snails. For the white paint".

[0=unassigned, 1=current, 2=done]
Table of Departure Quest
item					status
berries					0
lemon-yellow leaves		0
small green mussels		0
sea-blue crystal		0
white snail				0

Every turn when player holds basket and Progue is enclosed by location and the animus of Progue is not swimming and the animus of Progue is not resting and nothing dramatic is up and quantity of basket > 0:
	if quantity of the basket is 3 and already-got-item :
		force discuss depc_alreadygot;
	if quantity of the basket is 3:
		if actual contents of basket is bulbous fruits, force discuss utbm_gotem;
		otherwise force discuss depc_questdone;
	otherwise if actual contents of basket is not intended contents of basket:
		force discuss depc_wrongitem;
	otherwise:
		force discuss depc_gettingthere.

To decide whether already-got-item:
	if there is an item of actual contents of basket in Table of Departure Quest:
		choose row with an item of actual contents of basket in Table of Departure Quest;
		if status entry is 2, decide yes;
		decide no;
	otherwise:
		decide no.

depc_alreadygot is a repeatable beat in DepC with reaction "'Oh!' Progue says, peering into your basket, 'but you already brought me some [actual contents of basket]. I told you to get some [intended contents of basket][if submission of Progue > 0], didn't I? Must have said the wrong thing; mind's not what it used. Sorries for the confusion[else]. Go and find some of those instead; can't do anything more with these[end if].'".

depc_wrongitem is a repeatable beat in DepC with reaction "Progue peers into your basket critically. 'Gathering [actual contents of basket]?' he says. 'I thought I asked you to bring me [intended contents of basket] instead. Better empty the basket and start again.'".

depc_gettingthere is a repeatable beat in DepC with reaction "Progue peers into your basket. 'Good!' he says. 'Getting there, getting there. Just fill it up all the way with [actual contents of basket] and I'll be able to mix you up some paint.'".

depc_questdone is a repeatable beat in DepC with reaction "'[if actual contents of basket is not intended contents of basket]Oh!' says Progue, peering at the basket in surprise, 'I was expecting you to get me [intended contents of basket]. Oh well, then, doesn't matter. I'll take these[otherwise]Wonderful!' Progue says, taking the basket of[end if] [quest_finished] paint!' He tucks it away [if actual contents of basket is not intended contents of basket]with a frown of mild consternation[otherwise]and smiles broadly[end if].".

After discussing depc_questdone:
	if actual contents of basket is intended contents of basket:
		choose row with a status of 1 in Table of Departure Quest;
		now status entry is 2;
		if a random chance of 1 in 2 succeeds, Progue is less submissive;
		impress Progue;
	otherwise:
		Progue is more submissive;
		annoy Progue;
		choose row with an item of actual contents of basket in Table of Departure Quest;
		now status entry is 2;
		choose row with a status of 1 in Table of Departure Quest;
		now status entry is 0;
	if item entry is berries, move pot of red paint to Progue;
	if item entry is lemon-yellow leaves, move pot of yellow paint to Progue;
	if item entry is small green mussels, move pot of green paint to Progue;
	if item entry is sea-blue crystal, move pot of blue paint to Progue;
	if item entry is white snail, move pot of white paint to Progue;
	remove basket from play;
	now quantity of the basket is 0;
	truncate harvested list of basket to 0 entries;
	now actual contents of basket is nothing;
	choose a blank row in Table of Progue Suppression Endeavours;
	now pick entry is paint-making;
	choose a blank row in Table of Progue Suppression Endeavours;
	now pick entry is paint-making;
	choose a blank row in Table of Progue Uncertainty Endeavours;
	now pick entry is paint-making;
	choose a blank row in Table of Progue Uncertainty Endeavours;
	now pick entry is paint-making;
	continue the action.

To say quest_finished:
	choose row with a status of 1 in Table of Departure Quest;
	if item entry is:
		-- berries: say "berries from you. 'Now I can get going on that red";
		-- lemon-yellow leaves: say "windsigh leaves from you. 'Now I can get started on that yellow";
		-- small green mussels: say "mussels from you. 'So now I can get to work on that green";
		-- sea-blue crystal: say "crystals from you. 'I suppose I can get started on that blue";
		-- white snail: say "snails from you. 'Now I can get moving on that white".

Section - The Basket	

A woven basket is a portable container. [It is open and unopenable.] The basket has a list of rooms called the harvested list. The basket has a thing called the intended contents. The basket has a thing called the actual contents. The basket has a number called quantity. The quantity of the basket is 0. The description is "The basket is [if quantity of basket is 0]empty[otherwise if quantity of basket is 1]about a third full of [otherwise if quantity of basket is 2]about two-thirds full of [otherwise]filled to the brim with [end if][if quantity of basket > 0][the actual contents][end if].". [Understand "berry/berries" as basket when actual contents of basket is berries and berries is not enclosed by location. Understand "lemon/yellow/leaf/leaves" as basket when actual contents of basket is lemon-yellow leaves and lemon-yellow leaves is not enclosed by location. Understand "mussel/mussels" as basket when actual contents of basket is small green mussels and small green mussels is not enclosed by location. Understand "crystal/crystals" as basket when actual contents of basket is sea-blue crystal and sea-blue crystal is not enclosed by location. Understand "snail/snails" as basket when actual contents of basket is not white snail and white snail is not enclosed by location.][These are commented out because, even with the following line, the basket was being matched over the actual items to be gathred.] Does the player mean doing something to the basket: it is unlikely.

Before taking something when basket is held and ( the noun is an item listed in Table of Departure Quest or the noun is bulbous fruits ) (this is the basket override rule):
	if quantity of the basket is 3, say "The basket is already full." instead;
	if location is listed in harvested list of basket, say "You've already gathered all [the noun] you can from here; you'll have to find another spot to get more." instead;
	if quantity of basket is at least 1 and actual contents of basket is not noun, say "The basket already holds [the actual contents of basket]; it's probably not a good idea to mix and match." instead;
	if noun is bulbous fruits and utbm_forest is unspoken, say "You don't really have a need to pick these fruits right now." instead; 
	add location to harvested list of basket;
	if quantity of basket is 0, now actual contents of basket is noun;
	increase quantity of basket by 1;
	if noun is bulbous fruits, now quantity of the basket is 3;
	say "You gather [the noun] and add them to the basket, which is now [if quantity of basket is 1]about a third [otherwise if quantity of basket is 2]about two thirds [end if]full." instead.

Instead of inserting something (called insertee) into the basket, try taking insertee.

Instead of emptying the basket:
	now quantity of the basket is 0;
	truncate harvested list of basket to 0 entries;
	now actual contents of basket is nothing;
	say "You empty the basket onto the ground; the contents disappear into the underbrush.".

Instead of dropping the basket: say "You better hold on to it since you don't want to lose it.".

Understand "empty [something]" as emptying. Emptying is an action applying to one carried thing.



Chapter - Let's Take A Soak

[ You encounter Progue somewhere as he is on his way to take a dip in the hot springs. He invites you to come with him. If you accept, you can follow him to the hot spring. Whether you do so, whether you get in can matter. Progue wants to get to know you a little better; do you tell him anything? You can initiate some romance here too. Discussion about crystal. Progue hesitantly brings up his daughters if the conversation goes in that direction, but doesn't remember what happened to them.
 ]

Let's Take A Soak Part One is an urgent frequent episode with summary "chat and chatting at the hot springs". The icebreaker is ltas_intro. The expiration date is 4 hours.

A condition for Let's Take A Soak Part One:
	if location is Rise or location is Hot Springs, rule fails; 
	if morning or midmorning or midday or evening, rule succeeds.

A completion rule for Let's Take A Soak Part One:
	if ltas_yes is spoken or ltas_maybe is spoken:
		begin Let's Take A Soak Part Two;
	else:
		Progue starts hottubbing.

LTAS is a thread. The escape clause is ltas_maybe.

ltas_intro is a beat in LTAS with reaction "'Oh, hello,' Progue says amiably, pausing for a moment. [if affinity of Progue <= 0]He hesitates, then adds[otherwise]He adds cheerfully[end if] 'I was just heading to the hot [ltas_spring] for a soak. Care to join me?'". The yes-beat of ltas_intro is ltas_yes. The no-beat of ltas_intro is ltas_no. The maybe-beat of ltas_intro is ltas_maybe.

Understand "spring" as ltas_spring when last beat is ltas_intro. ltas_spring is an ephemeral beat in LTAS with keyword name "spring" and fuse 99 and reaction "'It's a beautiful spot,' [the Progue] says, smiling, 'just a hidden little pool with a waterfall and beautiful blue crystals. I go there often to relax and think. Will you join me?'". 

Carry out getting bored when last beat is ltas_intro: force discuss ltas_maybe. ltas_maybe is a terminal beat in LTAS with fuse 99 and  keyword name "maybe" and reaction "'Well, I'll be there if you like,' he says [if affinity of Progue <= 0]skeptically[otherwise]in a friendly tone[end if], turning away. 'Feel free to join me.'". ltas_maybe cancels ltas_yes, ltas_no. After discussing ltas_maybe: complete Let's Take A Soak Part One, succeeding; begin Let's Take A Soak Part Two; follow the Progue's motivation rule; continue the action.

ltas_yes is a terminal beat in LTAS with fuse 99 and keyword name "yes" and reaction "[if affinity of Progue <= 0]'Oh!' [the Progue] says, seemingly surprised. 'Well and fine, [']twould be nice to have a chance to talk a bit more[otherwise if romance of Progue > 0]'Fantastic!' he says, a  thrill lighting up his face, 'it will be wonderful to get to talk a touch more[otherwise]'Fine!' he says, smiling, 'it will be nice to get to chat a touch more[end if]. Just follow me, it's not far.'". ltas_yes cancels ltas_maybe, ltas_no. After discussing ltas_yes: complete Let's Take A Soak Part One, succeeding; begin Let's Take A Soak Part Two; follow the Progue's motivation rule; continue the action.

ltas_no is a terminal beat in LTAS with fuse 99 and keyword name "no" and reaction "'Oh, well,' he says, looking [if affinity of Progue <= -1]a bit relieved[otherwise if romance of Progue > 0]crestfallen[otherwise]disappointed[end if], 'just thought I'd ask. See you round, then.'". ltas_no cancels ltas_yes, ltas_maybe.

Let's Take A Soak Part Two is a guaranteed rendezvous episode. The meeting place is Hot Springs. The expiration date is 2 hours 30 minutes. The icebreaker is ltas2_intro. The boredom beat is ltas2_bored. The subchange beat is silence. The bye beat of Let's Take A Soak Part Two is silence. The abruptbye beat is silence.

A commencement rule for Let's Take A Soak Part Two:
	now the animus of Progue is hottubbing;
	now progue-venue is Hot Springs;
	now Progue is wishing.

A completion rule for Let's Take A Soak Part Two:
	if ltas2_intro is unspoken:
		Progue likes you less;
		if romance of Progue > 0, Progue is losing interest.

[On the way there.]

The Progue chats on way to Hot Springs rule is listed before the trigger Progue's motivation rule in the every turn rules. Every turn when current episode is Let's Take A Soak Part Two and Progue is enclosed by the location and location is not Hot Springs (this is the Progue chats on way to Hot Springs rule):
	if ltas_chatter is spoken and location is Rise, now conversation fuse is 3; [This is so he'll say the icebreaker immediately next turn. The extra check is to prevent booboos if we're starting from the Rise.]
	force discuss ltas_chatter.


ltas_chatter is a repeatable beat in LTAS with reaction "[one of]'Beautiful day, isn't it?' he says. '[if raining]Well, except for the torrential rain, of course. [end if]I find the climate here to be thoroughfully agreeable.'[or]'Nearly there now,' Progue says, rubbing his hands together in anticipation.[or]'You're going to love this,' he adds fondly.[or]'Try and keep up now!' Progue says.[or]'Just through here,' he says.[cycling]".

[Cannonball: submissive. Sit near Progue: romantic. Take his advice: paternal. ]

LTAS2 is a thread. The escape clause is p_supp_bye.

ltas2_intro is a beat in LTAS2 with reaction "'Get in!' [the Progue] shouts, splashing some water in your direction. 'It feels heavenly.'". ltas2_intro summons ltas2_bored, ltas2_goodsport.

ltas2_bored is a terminal beat in LTAS2 with reaction "[The Progue] grunts. 'Suit yourself,' he says grumpily, 'but you don't know what you're missing.'".

Last after entering the large pool when Progue is enclosed by Hot Springs and current episode is Let's Take A Soak Part Two: pre-conversation processing; force discuss ltas2_goodsport. [ continue the action.]

ltas2_goodsport is an affinitive beat in LTAS2 with reaction "[The Progue] beams. 'There, you see?' he says. 'Isn't it nice?' Now, let's see. There's a good place to sit over [ltas2_sitfar], not too far from the waterfall, or this one [ltas2_sitnear] me, if you prefer,' he says, indicating the two spots with a pointed finger just breaking the surface of the water.". ltas2_goodsport summons ltas2_sitnear, ltas2_sitfar. ltas2_goodsport suggests ltas2_talkabout. After discussing ltas2_goodsport: now ltas2_intro is spoken [it may have been skipped.]; continue the action.

Understand "near" as ltas2_sitnear. ltas2_sitnear is a romantic beat in LTAS2 with keyword name "near" and reaction "You swim over to sit near Progue.". ltas2_sitnear enqueues ltas2_talkabout. After discussing ltas2_sitnear: now tempfuse of ltas2_sitfar is 0; continue the action.

Understand "there" as ltas2_sitfar. ltas2_sitfar is a beat in LTAS2 with keyword name "there" and reaction "You swim over to the seat near the waterfall.". ltas2_sitfar enqueues ltas2_talkabout. After discussing ltas2_sitfar: now tempfuse of ltas2_sitnear is 0; continue the action.

ltas2_talkabout is a beat in LTAS2 with reaction "[if ltas2_sitnear is spoken or ltas2_sitfar is spoken]'There' [the Progue] says, 'now that you're settled[otherwise]'Well,' [the Progue] says, 'I suppose that's as good a spot as any. Now[end if], what shall we discuss? This is a gushing good spot for discussions.' He studies you curiously. 'What shall it be, then? What [t]subject[x] shall we talk about?'".






Chapter - Sand Construction

[ Progue still doesn't remember, but his fingers do: he was once a great sculptor. Lost in a trance, he works on a magnificent sand castle on the beach. Possible outcomes: the player destroys the sand castle, angering Progue; the player stirs up too many of Progue's memories and he destroys the castle himself; the player joins in, making Progue feel more paternal; the player takes Progue's orders for help, making him less submissive; ] 

Table of Progue's Initial Appearance (continued)
animus	episode			desc
--		Sand Construction		"[o]Progue[x] stands before an enormous sand [o]castle[x] rising from the beach."

Sand Construction is a common triggered instant episode with summary "building sand castles on the beach". The meeting place is Center Beach. The expiration date is 4 hours. The icebreaker is sndc_intro. The subchange beat is sndc_subchange. The boredom beat is sndc_boredom. The bye beat is sndc_boredom. The abruptbye beat is sndc_boredom.

Last condition for Sand Construction:
	if we are not going, rule fails;
	if raining, rule fails;
	if conversation fuse < 12, rule fails;
	if location is Center Beach and Progue is not regionally in Beachfront, rule succeeds.

A commencement rule for Sand Construction:
	pre-conversation processing;
	force discuss sndc_intro.

A completion rule for Sand Construction:
	Progue's life goes on.

SNDC is a thread. The escape clause is sndc_boredom.

The sand castle is a described set dressing. "[if sndc_build is spoken]Two sand castles stand on the beach here[else]Only half-finished, the castle is a fantastically intricate sculpture of minarets, retaining walls, and tiny windows. Briny water swirls through the moat at [end if][if Progue is enclosed by location and sndc_build is unspoken]Progue's feet; he stands pricking life into a turret with his fingers, entranced[else if sndc_build is unspoken]your feet[end if].". The description is "[if sndc_destroy2 is spoken]Just a heap of crumbled sand now[otherwise if sndc_build is spoken]Your castle stands next to Progue's, two monuments in sand[otherwise]It's fantastic, all the more so for being constructed from damp sand. Staring at the graceful curves taking shape, the impossible mimicry of mouldering stone with wet clumps of sand, the perfect roundness of the towers, you catch a glimpse of the sculptor Progue must once have been.[paragraph break]A [o]pile[x] of wet sand lies near the castle[end if].". First report remembering the sand castle when location is meeting place of Sand Construction: say "The castle has washed away, only a lump on the beach to mark its foundations." instead.

sndc_intro is an insistent beat in SNDC with reaction "[initial appearance of Progue][paragraph break][initial appearance of sand castle][paragraph break]'Been so long,' he murmurs, not looking up, 'but I felt-- an urge, like-- fingers waking up.' He nods to himself, as if satisfied with this interpretation, and brushes a hand against the rounded walls of a tower.". sndc_intro summons sndc_destroy. sndc_intro suggests sndc_2. After discussing sndc_intro: move the sand castle to meeting place of Sand Construction; move pile of sand to meeting place of Sand Construction; continue the action. 

sndc_2 is a beat in SNDC with reaction "Fingers moving effortlessly, Progue shapes deft ridges along a connecting wall between two towers, a quiet smile on his face, eyes focused, perhaps, into another universe, while you watch, entranced.". sndc_2 suggests sndc_3.

sndc_3 is a beat in SNDC with reaction "Progue tweaks detailing on the surface of the sand near the base, but as his fingers pinch and twirl, something becomes clear to you. His skill is remarkable, masterful. But he is not good enough.[paragraph break]He is not a Wayfarer, at least, not any more.". sndc_3 suggests sndc_4.

sndc_4 is a beat in SNDC with reaction "Progue hums to himself as he keeps tweaking and refining the wet shapes before him.". sndc_4 suggests sndc_outtro.

The pile of sand is a set dressing. "A [o]pile[x] of wet sand lies near the castle.". The description of pile is "The collapsed remnants, perhaps, of some earlier draft.". Instead of taking or pushing or using pile, force discuss sndc_build. Understand "build [something]" or "make [something]" as taking when current episode is Sand Construction. Instead of taking or using sand castle, try taking pile of sand.

sndc_build is a paternal affinitive beat in SNDC with reaction "Hesitantly, you kneel down and push some of the sand together. Progue sees what you're doing and smiles.[paragraph break]'Go on, [animal-nickname],' he says. 'It's a big beach.'[paragraph break]You build and build, the wet sand cool and comforting somehow as it covers your hands, soft and pliable yet made of hard rock, making durable features that will be gone in a matter of hours. This is not painting, and your towers are crude and crumbly next to Progue's, but some spark in your hands awakens to the challenge regardless.[paragraph break]When you finish, curiously satisfied, Progue comes over to survey your work, placing one sand-gloved hand on your shoulder. 'Hmm,' he declares in mock criticism, eyeing a sagging buttress, 'I like the architecture, but I'm not sure if I trust the architect.' Then he frowns and regards it from another angle. 'But it looks more lived in, I suppose,' he says musingly, 'like a real castle. Yes. Mayhaps mine's nice to look at, but yours would be better to live in.' He claps your shoulder again[if romance of Progue > 0], and meets your gaze for a searching moment.[end if].". sndc_build2 replaces sndc_build. sndc_build suggests sndc_outtro. After discussing sndc_build: remove pile of sand from play; continue the action.

sndc_build2 is a repeatable beat in SNDC with reaction "You tweak and refine your castle some more.".

Instead of kissing Progue when last beat is sndc_build: force discuss p_firstkiss.

sndc_outtro is a terminal beat in SNDC with reaction "Progue sighs, surveying the sand fortresses fondly. 'Soon the waves will come to wash it all away,' he says evenly. 'And yes, that's best, I think. Nothing sadder than a frantic figure with bucket and shovel, trying desperately to stem the inevitable surge of tides.'[paragraph break]He claps your shoulder and turns away, not looking back at the miniature city behind him, already starting to slump and fade.[paragraph break]'The surge of the tide,' he mutters again, 'a side of the turgid. So long for now.'". 



Instead of attacking or pushing the sand castle when Progue is enclosed by location, force discuss sndc_destroy. Instead of attacking or pushing the sand castle: say "Silently, you destroy the sand castle, pushing and shoving until only a flat mound of sand remains"; remove sand castle from play.

sndc_destroy is a unaffinitive beat in SNDC with reaction "You lash out at the castle, slicing an arm through the wet sand of a minaret which crumbles to the beach.[paragraph break]Progue whirls on you angrily. 'No!' he cries. 'Leave it! Stop!'". sndc_destroy2 replaces sndc_destroy. sndc_destroy summons sndc_sorry.

Understand "sorry" as sndc_sorry. sndc_sorry is a terminal beat in SNDC with keyword name "sorry" and reaction "Progue's face softens. 'It's all right,' he says sadly. 'I've... destroyed most of my own sculptures already, anyway. Something about the sand. Washes away.' He seems lost for a long moment, then, with a last quiet nod to you, turns away from the castle.". After discussing sndc_sorry: now dont_describe_Progue is true; Progue's life goes on; continue the action.

sndc_destroy2 is an unaffinitive submissive terminal beat in SNDC with reaction "You attack the castle again, pummeling it with fists, watching it crumble in clumps back to the formless pieces it came from.[paragraph break]Progue grabs your arm ineffectually at first, then pulls back and watches darkly. '[if player is male]Bastard[otherwise]Bitch[end if],' he mutters, then turns and walks quickly away.". After discussing sndc_destroy2: Progue's life goes on; continue the action.

Instead of hugging Progue when current episode is Sand Construction: say "At first he freezes when you touch him, then shrugs away with a half-smile. 'Leave it,' he says, not unkindly, 'this isn't done yet.'".

sndc_subchange is a repeatable beat in SNDC with reaction "'Later, perhaps,' he says distractedly, 'I'm not in a mood for conversation. It's my hands that want to talk now.'".

sndc_boredom is a repeatable terminal beat in SNDC with reaction "Barely aware of your continuing presence, Progue keeps working on the sand castle.".



Part - Romance Subplot

Chapter - Long Walks

[This scene is triggered when romance is at least 2. It's essentially a date. The player can either strengthen the growing romantic attachments or refute them.]

Walk Invitation is a common urgent episode. The expiration date is 12 hours. The icebreaker is wi_intro.

A condition for Walk Invitation:
	if Progue has free time and 
	we guess the player is interested and
	romance of Progue < 5, rule succeeds.

To decide whether we guess the player is interested:
	if romance of Progue >= 3, yes;
	if romance of Progue >= 2 and Rume is male, yes; [If the player has previously shown an interest in romantic attachments to males, we can be a little bolder.]
	no.

A completion rule for Walk Invitation:
	now dont_Describe_Progue is true;
	Progue's life goes on;
	follow the Progue's motivation rule.

To choose time for Progue's date:
	if Progue is booked for evening or current interval is evening or current interval is sunset or current interval is night, now wi_time is morning; otherwise now wi_time is evening. 

wi_time is an interval that varies.

WI is a thread. The escape clause is wi_no.

wi_intro is a beat in WI with reaction "'There you are!' Progue says, coming up to you and shuffling his feet awkwardly. Dots of red touch his cheeks. 'Well then, ah, hello,' he says, coughing a little. 'Fancy fancy meeting you here.' He seems to want to ask you [t]something[x], but is uncertain how to begin.". wi_intro summons wi_askout. wi_intro suggests wi_askout. After discussing wi_intro: choose time for Progue's date; continue the action.

Understand "something" as wi_askout when last beat is in WI. wi_askout is a beat in WI with keyword name "something" and reaction "'Yes,' he says, 'it's been green eons since I... oh well oh,' he says, blurting quickly out, 'so then, perhaps you'd like to join me [if wi_time is evening]this evening[otherwise]tomorrow morning[end if] in a walk along the beach?". The yes-beat of wi_askout is wi_yes. The no-beat of wi_askout is wi_no. wi_askout suggests wi_no.

wi_yes is a terminal beat in WI with fuse 99 and keyword name "yes" and reaction "'You would?' he shouts. 'Oh. Oh! Yes, well, that's gushing fantastic.' He beams broadly. 'Well, it's a, oh, one of whatever those are then I suppose. I'll see you [if wi_time is evening]tonight[otherwise]in the morning[end if]; meet me down by the boulders[if Word Day is successful]. You remember, where we first met, on Word Day[end if].' He flashes a mad grin, then skips off. 'Till [if wi_time is evening]tonight[otherwise]tomorrow[end if] then!' he calls back over his shoulder.". After discussing wi_yes: schedule Progue for Long Walks at wi_time; continue the action.

wi_no is a terminal unromantic beat in WI with fuse 99 and keyword name "no" and reaction "'Ah,' he says, 'well of course you've seen it already. No point, no point. Terrible sorries for your time. Enjoy the [progue-time-of-day]!' He turns, stumbles over [a random setpiece in location], recovers himself with an awkward grin, then speed-walks away.". After discussing wi_no: now romance of Progue is 0; continue the action.


Long Walks is a rendezvous episode with summary "awkward walks on beaches". The meeting place is Among the Boulders. The expiration date is 4 hours. The icebreaker is lw_intro. The subchange beat is lw_subchange. The boredom beat is lw_distracted. The bye beat is lw_bye. The abruptbye beat is lw_abruptbye.

LW is a thread.

lw_subchange is a beat in LW with reaction "'Oh, but there's time and time to talk about other things,' he says kindly. 'Let's not spoil the moment, eh?'".

lw_distracted is a beat in LW with reaction "'You seem distracted,' Progue says with concern. Are you sure you want to continue?'". The yes-beat of lw_distracted is lw_byeyes. The no-beat of lw_distracted is lw_byeno.

lw_bye is a repeatable beat in LW with reaction "He stops, looking confused. 'Oh,' he says, 'but I thought we'd walk up to the Rise. Do you want to come the rest of the way with me?'". The yes-beat of lw_bye is lw_byeyes. The no-beat of lw_bye is lw_byeno. lw_bye suggests lw_byeyes.

lw_byeyes is a repeatable beat in LW with reaction "'Excellent,' he says, and the two of you continue walking.". After discussing lw_byeyes: force discuss lw_progress.

lw_byeno is a terminal unromantic beat in LW with reaction "'Very well then,' he says stiffly. 'Enjoy your [progue-time-of-day].'". After discussing lw_byeno: Progue is losing interest; Progue's life goes on; follow the Progue's motivation rule.

lw_abruptbye is a dogged beat in LW with reaction "'What's the rush?' Progue says, arresting your motion with his eyes. 'It's a beautiful [progue-time-of-day]. Let's take our time.'". lw_bye replaces lw_abruptbye.

lw_intro is a beat in LW with reaction "Progue, leaning casually against a boulder, beams broadly at you. 'Beautiful [progue-time-of-day], isn't it?' he says. 'Such singular [lw_weather] this is. Strolling weather, do you ring? Something [lw_ambling] about it. I [lw_myself] prefer a ratherly less humid clime, but in these past spans I suppose I've gotten used.' He suddenly bites his lip, flushes, and waits desperately, holding his breath, for you to say something.". lw_intro suggests lw_silence.

lw_silence is an annoying beat in LW with reaction "'Well,' he finally says into the awkward silence, 'let's amble if we're ambling, shall we?' And he leads you away from the boulders towards the beach.". After discussing lw_silence: commence the ambling; continue the action.

Understand "weather" as lw_weather when last beat is in LW. lw_weather is a beat in LW with keyword name "weather" and reaction "Progue looks relieved as you make some small talk about the weather, and he nods vigorously. 'Too true, true too,' he says. 'It really is and is a spectacular place. After the muchness of time I've been stuck here it's easy to forget.'". lw_weather enqueues lw_shallwe.

Understand "ambling/amble" as lw_ambling when last beat is in LW. lw_ambling is a beat in LW with keyword name "ambling" and reaction "'Yes yes, of course, why we're here and all,' he says quickly. 'Let's get started, I'm eager and ready!'". lw_ambling enqueues lw_shallwe.

Understand "personally" as lw_myself when last beat is in LW. lw_myself is a impressive beat in LW with keyword name "personally" and reaction "'What who? Me? Oh!' he says, a smile breaking out over his face. 'Terrible sorries and sorries, I'm just not a question it's used to. I'm... er... fine?' He wrinkles his brow, then suddenly laughs. 'Yes, that's it! I'm gushing fine, thank you, thank you, thank you for asking.' He laughs again, eyes twinkling gratefully at you.". lw_myself enqueues lw_shallwe.

lw_shallwe is a beat in LW with reaction "'Shall we then?' he adds, and leads you out from the shadows of the boulders onto the sun-stroked beach.". After discussing lw_shallwe: commence the ambling; continue the action. lw_shallwe suggests lw_progress.

To commence the ambling:
	if location is Among the Boulders begin; let nl be South Beach;
	otherwise if location is South Beach; let nl be Center Beach;
	otherwise if location is Center Beach; let nl be North Beach;
	otherwise; let nl be Rise;
	end if;
	if nl is adjacent to location begin;
		move Progue to nl;
		now Progue is attentive;
		now conversation fuse is 1;
		move player to nl;
	otherwise;
		let rt be the best route from location to nl;
		move Progue to the room rt from location;
		move player to the room rt from location;
	end if.

lw_progress is an insistent beat in LW with reaction "'And how is being you?' he asks, walking slowly through the soft sand. 'Keeping busy? Making progress with your projects?'". The yes-beat of lw_progress is lw_progressyes. The no-beat of lw_progress is lw_progressno. lw_compliment replaces lw_progress.

lw_progressno is a beat in LW with keyword name "no" and reaction "'Really? Moisty sausages,' he says, genuinely concerned, 'terrible sorries to hear it. What is it you're getting upended over?'". lw_progressno summons sc_bees, sc_ropeway, sc_boiler, sc_pyramiddist, sc_dreams. [NOTE: saying this should raise the frustration meter.] After discussing lw_progressno: now tempfuse of lw_compliment is 5; continue the action. lw_progressno suggests lw_compliment.

lw_progressyes is a beat in LW with keyword name "yes" and reaction "'Delightful,' he says, nodding happily as you recount some of your recent exploration, 'it sounds like you know more than I remember.'". lw_progressyes enqueues lw_compliment.

lw_compliment is an exciting beat in LW with reaction "'Forgive if this is forward,' Progue says with a blush, focusing on the rippling sand at his feet, 'but [if we chose love or we chose both]there's something of the electric and the passionate about your nature[otherwise]the artist in you sings so loud even a half-mad soul like mine hears it[end if]. [if puzzle mode]I've watched the wheels spin and turn in your mind as you try to make sense of this place[otherwise]I see the spark in your eye, feel the yearn of your heart for adventure[end if]; and well. Fine qualities, I believe indeed.'[paragraph break]He blushes awkwardly, and you try to think of some compliment you could make in return (his [lw_appearance]? [lw_eloquence]? [lw_vivacity], [lw_artistry]?) even while some buried part of you wishes only for [lw_silence2].". lw_compliment cancels lw_progressyes, lw_progressno. lw_compliment suggests lw_silence. lw_amble2 replaces lw_compliment.

Understand "eloquence" as lw_eloquence when last beat is in LW. lw_eloquence is a impressive beat in LW with keyword name "eloquence" and reaction "He waves off your praise for his cadenced conversation with a nevertheless ridiculously pleased smile. 'Amazed you can ring me at all,' he says, 'or I myself, what with the mess and multitudes of worlds I've lived in. A motley stew of dialects from cross the infinite cosmos. Well then but thank you. Kind words you have.'". lw_eloquence enqueues lw_amble2.

Understand "appearance" as lw_appearance when last beat is in LW. lw_appearance is a impressive beat in LW with keyword name "appearance" and reaction "He listens with a silence you finally take to be incredulity as you say something about his rugged good looks. 'Well oh,' he says finally, 'and after so many years of strandation and nonsanity. For life and strife of me I've never had guessed. Presumed myself some sort of monster after green eons of tropical sunlight searing the skin. Mayhaps I am, but ever so kind of you to humor me.' He winks and looks pleased.". lw_appearance enqueues lw_amble2.

Understand "vivacity" as lw_vivacity when last beat is in LW. lw_vivacity is a impressive beat in LW with keyword name "vivacity" and reaction "He looks out to sea as you praise his zest for life, acknowledgments coming only in the form of slow nods and sad smiles. 'Yes,' he says, 'I suppose I've always lived at volumes near deafening to those around me, the merely living in my wake. Why I'm still here now, I suppose. Mayhaps why you're here too.' He looks back at you. 'Well and but thank you. Kind words for someone you met screaming syllables at an ocean.'". lw_vivacity enqueues lw_amble2.

Understand "artistry" as lw_artistry when last beat is in LW. lw_artistry is a impressive beat in LW with keyword name "artistry" and reaction "He tries to wave off your praise for the various bits of sculpture you've seen around the island, but grins broadly nevertheless. 'Not a challenge to complement a wayfarer, is it?' he says, then stops and slams a fist into his forehead. 'Oh, that came out terrible wrong. Moisty hells. What I said to have meant was... we artists we, each have quiet neurons hidden away for each of our creations, that dream of sparking but seldom dare. So much more the pleasant when an other sparks them for us.' He smiles. 'Thanks to you for your kind words.'". lw_artistry enqueues lw_amble2.

Understand "silence" as lw_silence2 when last beat is in LW. lw_silence2 is an annoying beat in LW with keyword name "silence" and reaction "Progue coughs to fill the awkward silence, and shuffles forward a little more quickly across the sand.". lw_silence2 enqueues lw_amble2.

lw_amble2 is a beat in LW with reaction "The two of you continue ambling along the beach.". After discussing lw_amble2: commence the ambling; continue the action. lw_amble2 cancels lw_eloquence, lw_appearance, lw_vivacity, lw_artistry. lw_amble2 suggests lw_firstlove. lw_firstlove replaces lw_amble2.

lw_firstlove is a beat in LW with reaction "'Actually,' Progue says quietly, 'just before you arrived at the boulders I remembered something. From long ago. A certain [if player is male]gentleman, well. A boy[otherwise]lady, well. A girl[end if], really, when I was [if player is male]only one myself. He[otherwise]just a boy myself. She[end if] remembers me of you, somehow, cross green eons. My first love, I suppose I suppose.'[paragraph break]'We were somewhere in the monstrous chasm twixt fift and sixteen,' he continues, seawater trickling warmly around your feet, 'lost in the midlands where neither side is visible or conceivable. Eons of talks; long great towering ones where the words we wove meant the world, and endless ones where I drowned in the green of [lwfirst2]". To say lwfirst2: say "[if player is male]his eyes and nothing he[otherwise]her eyes and nothing she[end if] said could dry me. I think, I think it was one of these when I realized [if player is male]he was as helpless in mine as I in his[otherwise]she was as helpless in mine as I in hers[end if]. Some razor moment, sweet breaths vortexing between us...' he closes his eyes. 'But how could I have forgotten that kiss? Endless. Endless...'[paragraph break][if morning]Sunrise[otherwise]Brilliant sunset[end if] glitters on the foamy waves, and you think of [lw_Rume], and of [lw_others] across your wayward life, and remember.". lw_firstlove suggests lw_holdhands. lw_rengin replaces lw_firstlove.

Understand "Rume" as lw_Rume when last beat is in LW. lw_Rume is a insistent beat in LW with keyword name "Rume" and reaction "Slowly, haltingly, you tell Progue the story of Rume; how you met and how you parted and some of the best between. He listens quietly, only nodding now and then, until you fall silent.[paragraph break]'Tell me then,' he says quietly, after long moments of only the crashing surf between you. 'Have you let [if Rume is male]him[otherwise]her[end if] go? Have you [lw_accepted] your loss, as your strange fate compels you to do, or do you still [lw_struggle] gainst bereavement, gainst the inevitable chasm between you?'". lw_Rume suggests lw_struggle. lw_Rume summons lw_accepted, lw_struggle. After discussing lw_Rume: miss Rume; continue the action.

Understand "accepted" as lw_accepted when last beat is in LW. lw_accepted is a beat in LW with keyword name "accepted" and reaction "He nods quietly, and his simple understanding is somehow almost heartbreaking.". lw_accepted enqueues lw_holdhands.

Understand "struggle" as lw_struggle when last beat is in LW. lw_struggle is a beat in LW with keyword name "struggle" and reaction "He sighs deeply, long and airy, the sound resting above the murmur of the surf like foam. Then, slowly, he nods, and this simple forgiveness is somehow almost heartbreaking.". lw_struggle enqueues lw_holdhands.

Understand "others" as lw_others when last beat is in LW. lw_others is a beat in LW with keyword name "others" and reaction "You tell Progue of the people you've loved, some of whom you haven't thought of in years, and the remembering, while painful, seems to dull or soften the loss of Rume, in blankets of familiarity.[paragraph break]Progue listens thoughtfully, then lets the waves wash a long barrier between your thoughts and his before he speaks. [if rev_wayfaring is spoken]'Wayfaring mayhaps is the wrong word,' he says finally. [end if]'What defines us is not that we travel, but that we survive at all. Each newness we find is born from annihilation, apocalypse, at least for us. We destroy ourselves by moving and yet we move. Never found a world with a word for that. Mayhaps if there is one, it's our home.'". lw_others enqueues lw_holdhands.

lw_holdhands is an insistent beat in LW with reaction "Between you, his [lw_hand] has dropped to his side, the space between it and yours filled only with snatches of salty air, now larger, now smaller as your unmatched strides take you [lw_forward] along the beach.". lw_holdhands summons lw_hand, lw_forward.

Understand "hand" as lw_hand when last beat is in LW. lw_hand is an impressive beat in LW with keyword name "hand" and reaction "Your painter's fingers brush against his, hard and calloused but shockingly warm, and then he grasps them firmly, surrounding your hand with his.[paragraph break]You walk farther down the beach, and can't imagine letting go.". After discussing lw_hand: commence the ambling; continue the action. lw_hand suggests lw_rengin; 

Understand "forward" as lw_forward when last beat is in LW. lw_forward is an annoying beat in LW with keyword name "forward" and reaction "The beach stretches before you. You lift your hands slightly as you quicken the pace, and Progue hurries to follow.". After discussing lw_forward: commence the ambling; force discuss lw_rengin; continue the action.

lw_rengin is an insistent beat in LW with reaction "Progue pauses at the base of the lava flow, reflective[if lw_hand is spoken], and you feel the pulse in his hand racing[end if]. 'And but yet,' he says, 'the love of my life, wife, mother to my daughters... when after wearying of always moving on I settled, rooted and vowed never to do it again... she died. And I was the one left alone, abandoned, not able to follow.' He lowers his head, suddenly angry. 'And so much of her has left me,' he mutters, 'slipped away since through cracks of broken mind. Her voice... I can't remember her voice.'[paragraph break]He takes a deep breath, then looks up at you. 'If solitude is the condition of our lives,' he asks simply, 'then do you [lw_relish] or [lw_reject] it?'". lw_rengin summons lw_relish, lw_accept, lw_reject. lw_uptorise replaces lw_rengin.

Understand "relish" as lw_relish when last beat is in LW. lw_relish is an annoying beat in LW with keyword name "relish" and reaction "He studies your face carefully. 'Yes,' he says finally, 'for life and strife, you do. You're stronger than me, [animal-nickname]. I never embraced it, only hid it from myself, down and deep. And mayhaps that's the root of my madness.'". lw_relish enqueues lw_uptorise.

Understand "reject" as lw_reject when last beat is in LW. lw_reject is an impressive beat in LW with keyword name "reject" and reaction "A wistful, yearning look comes into his face. 'And you do, clear,' he says, 'you've always fought against fate, searched for some answer, some way to reconcile these two bastard halves of your nature. The wayfarer and the companion.' He sighs. 'I envy your resolve.'". lw_reject enqueues lw_uptorise.

Understand "accept" as lw_accept when last beat is in LW. lw_accept is a beat in LW with keyword name "accept" and reaction "He looks at you for a moment, then laughs. 'The third alternative,' he says, 'yes of course. What we cannot we don't. If only all could have such blessings of common sense.'". lw_accept enqueues lw_uptorise.

lw_uptorise is a beat in LW with reaction "He turns and leads you up the side of the lava flow.". After discussing lw_uptorise: commence the ambling; if lw_firstkiss is spoken begin; now lw_uptorise suggests lw_warmglow; otherwise if Progue is friendly; now lw_uptorise suggests lw_thisisme; end if; continue the action. lw_uptorise suggests lw_solong. [Based on how the date has gone we get one of three endings.]

lw_thisisme is a beat in LW with reaction "Progue grins. 'Well and look!' he says, sweeping an arm. 'We've accomplished what we stood out to. Walked the beach. Gushing fantastic[if lw_hand is spoken].' He squeezes your hand, then gently lets it go. 'W[otherwise]. W[end if]ell, [if evening or sunset or night]I don't want to keep you out after dark, lots of sleeping to be done I'm sure[otherwise]I'm sure you have a busy day in front of you, I certainly certainly don't want to get in your way[end if], so I suppose...?' He hesitates for just a moment, and you wonder whether to say [t]goodbye[x], or...". First instead of kissing Progue when last beat is lw_thisisme: force discuss lw_firstkiss. Before saying farewell to Progue when last beat is lw_thisisme (this is the Long Walks goodbye override rule): force discuss lw_kindrebuff. The Long Walks goodbye override rule is listed before the episodes overrule goodbye rule in the before rules. lw_thisisme suggests lw_kindrebuff. After discussing lw_thisisme: Progue is aroused, silently.

lw_firstkiss is a terminal romantic nonverbal beat in LW with reaction "Hesitantly, you lean forward, suddenly sure for one bleak moment you must have misunderstood, about to make a terrible fool of yourself... and then Progue moves too, and your lips meet.[paragraph break]There is nothing about sculpting, as far as you know, that involves the lips. But somehow it's like you're in the hands of a master.[paragraph break]At last, one or the other of you breaks away and you share a contented smile. Then Progue turns and skips off with a roguish grin, dancing from tree stump to tree stump with hands high in the air before vanishing into the haze of the swamp, leaving only the echoes of a joyful laugh.". After discussing lw_firstkiss: post-conversation processing; now dont_describe_Progue is true;  summon Progue to West-Marsh; Progue's life goes on; print a section break; continue the action.

lw_kindrebuff is a terminal beat in LW with reaction "Progue smiles, gives you a sweeping bow, then turns and strolls off down towards the stumps, soon vanishing into the haze of the swamp.". After discussing lw_kindrebuff: post-conversation processing; now dont_describe_Progue is true; summon Progue to West-Marsh; Progue's life goes on; continue the action.

lw_unkind is a terminal unromantic nonverbal beat in LW with reaction "Progue looks a little surprised, but turns and heads off down towards the stumps.". After discussing lw_unkind: Progue is losing interest, silently; post-conversation processing; now dont_describe_Progue is true; summon Progue to West-Marsh; Progue's life goes on; continue the action.

lw_warmglow is a terminal beat in LW with reaction "Progue turns and grips your hands tightly for a moment. 'Well and look!' he says, nodding over your shoulder. 'We've accomplished what we stood out to. Walked the beach. Gushing fantastic.' He smiles. 'Thank you,' he says more seriously. 'In my solitude I'd forgotten how much value hides in companionship. You, [animal-nickname], are the perfect reminder.' He gives you another quick kiss, then bounds away, dancing from tree stump to tree stump with hands high in the air before vanishing into the haze of the swamp, leaving only the echoes of a joyful laugh.". After discussing lw_warmglow: post-conversation processing; now dont_describe_Progue is true; summon Progue to West-Marsh; Progue's life goes on; print a section break; continue the action.

lw_solong is a terminal unromantic nonverbal beat in LW with reaction "Progue turns and surveys the beach with a critical eye. 'Well and look!' he says. 'We stood out what we accomplished to do. Walked the beach. Well. Many thanks for your accompaniment. Mayhaps I'll see you around?' He grins at you, then turns and walks down the slope on the far side towards the tree stumps, quickly vanishing into the haze of the swamp.". After discussing lw_solong: Progue is losing interest, silently; post-conversation processing; now dont_describe_Progue is true; summon Progue to West-Marsh; Progue's life goes on; continue the action.

Understand "take hand" or "take his hand" or "take progues hand" or "hold hand" or "hold hands" as lw_hand when last beat is in LW. 






Chapter - First Kiss

p_firstkiss is a romantic beat in SuppC with reaction "You bend forward and touch your lips to Progue's. {etc} 'Something Further,' he says, a huge smile on his face. 'That's not really what I expected would happen when you arrived.'".

	

Chapter - Unexpected Present

[This should be a sweet scene that makes Progue's eccentricities seem touching. Like the XKCD comic about "slowing down the earth's rotation to spend longer with you." Find a way the player can reciporicate (giving Progue a gift somehow.) ]

Unexpected Present is a common urgent episode. The icebreaker is up_intro. The boredom beat is up_ignore. The subchange beat is up_ignore. The bye beat is up_ignore. The abruptbye beat is up_ignore.

A condition for Unexpected Present:
	if romance of Progue is at least 2, rule succeeds.

UPres is a thread. up_intro is a beat in UPres with reaction "He looks up and a smile lights up his face. 'Just in time,' he says, 'I've something for you. Look and look.'[paragraph break]He holds out what at first you take to be a pale rose-- but then you see it is merely a carving, done from a piece of grey driftwood. But so delicate, so beautiful, you can hardly believe it is carved from a block of wood.[paragraph break]And in fact as you take it, the petals crumble, and the whole collapses, almost dissolving into the sand at your feet-- you're not sure if you should [up_cry], [up_thank] Progue, or just [up_ignore] the whole thing.". 

Check mourning when last beat is up_intro: force discuss up_cry. up_cry is a romantic beat in UPres with keyword name "cry" and reaction "'Oh, [animal-nickname], no,' he says, quickly putting an arm around you, 'it was and was only an ephemeral thing. I knew it would crumble the moment you touched it. I just wanted to share that one look with you. Just a moment; that's all I was offering.'". up_cry enqueues up_hands.

Check thanking when last beat is up_intro: force discuss up_thank. up_thank is an affinitive beat in UPres with keyword name "thank" and reaction "He bows deeply. 'You're most and most welcome,' he says. 'I knew it would crumble the moment you touched it. Just wanted to share that moment with you is all.'". up_thank enqueues up_hands.

up_hands is a beat in UPres with reaction "'Haven't done much [sc_sculpture] in green eons,' he says, looking down at his hands and twitching each finger in turn. 'I kept trying and trying, years ago, but...' He shakes his head. 'But something youwards seems to have awakened parts of me. And I'm thoroughfully grateful.'". up_hands cancels up_thank, up_cry, up_ignore. After discussing up_hands: now the boredom beat of Unexpected Present is silence; now the subchange beat of Unexpected Present is silence; now the bye beat of Unexpected Present is silence; now the abruptbye beat of Unexpected Present is silence; continue the action.

Understand "ignore" as up_ignore when last beat is in UPres. up_ignore is an unromantic terminal beat in UPres with keyword name "ignore" and reaction "'Hmm,' he says, rubbing his fingers and frowning, 'guess it's not coming back after all. I thought mayhaps something was. Ah well-oh.' He turns away with a confused frown.".



Chapter - Guess Who

Guess Whot is a frequent instant episode. The subchange beat is gw_dunno. The boredom beat is gw_intro2. The bye beat is gw_annoyed. The abruptbye beat is gw_annoyed. The icebreaker is gw_intro.

Last condition for Guess Whot:
	if Progue is not enclosed by location and
	romance of Progue is at least 1 and
	exploring Progue's turf, rule succeeds.

A commencement rule for Guess Whot:
	summon Progue to location;
	pre-conversation processing;
	force discuss icebreaker of Guess Whot.

GW is a thread. gw_intro is a beat in GW with reaction "Suddenly hands appear from behind you and cover your eyes, blinding you.[paragraph break]'Guess who,' whispers a voice in your ear. For a moment you're not sure whether to be [gw_annoyed], [gw_progue], or [gw_dunno] him.". gw_intro summons gw_progue, gw_dunno. gw_intro suggests gw_intro2.

gw_intro2 is a beat in GW with reaction "'Come on, [animal-nickname], guess!' the voice says again, hands warm against your eyes.". gw_intro2 suggests gw_annoyed. gw_noguess replaces gw_intro2.

Understand "annoyed" as gw_annoyed when last beat is in GW. gw_annoyed is an unromantic terminal beat in GW with keyword name "annoyed" and reaction "He pulls his hands back from your eyes, and steps back, a little sheepish. 'Sorries,' he says. 'Just rolling around. Craze you later, then.'".

Understand "guess" as gw_progue when last beat is in GW. gw_progue is a beat in GW with keyword name "guess" and reaction "'[if gw_dunno is unspoken]First guess! [end if]Genius!' Progue cries, releasing you with a grin. 'Out of the entire population of this beautiful isle you guessed me! Brilliances and smartitudes, [if player is male]sir[else]madam[end if], hats off yourwardways if in fact we had any. Well, and how are you up to? What are you doing? Enjoying the [progue-time-of-day]? Splend and charm.'". After discussing gw_progue: normalize Guess Whot; continue the action. gw_progue cancels gw_annoyed, gw_dunno.

Understand "tease" as gw_dunno when last beat is in GW. gw_dunno is a romantic beat in GW with keyword name "tease" and reaction "'Nope,' he says in your ear with an audible grin, as you feign confusion. 'No as no and no. Give you a hint, [animal-nickname]. Starts with a P and rhymes with [']rogue.['] Guess again; I'm sure you're clever enough to find it.'". gw_dunno suggests gw_noguess.

gw_noguess is a beat in GW with reaction "'Give up, give up?' He removes his hands and steps in front of you, bowing. 'It's me, yes, I know, quite some let down. A hard challenge, I know, know I. Now you know! But how are you then, [animal-nickname]? Enjoying the [progue-time-of-day]? Splend and charm.'". After discussing gw_noguess: normalize Guess Whot; continue the action. gw_noguess cancels gw_annoyed, gw_progue, gw_dunno.



Section  - A Simple Warning

[ Once the player has started fiddling with the pipes, Progue becomes concerned. He corners the player when given a chance and asks to meet him by the base of the ropeway (as far from the trees as possible) at sunset. The player can either follow this request or ignore it-- in the later case Progue will seek out the player again the next day. Upon meeting, he will warn the player not to dig too deeply, saying he knows what you're doing, and to be very careful. He reveals that he built the pyramid, but he could never had done it himself. He remains enigmatic.  ] 


A Simple Warning is a guaranteed urgent episode. The icebreaker is asw_intro. The subchange beat is asw_dontgo. The bye beat is asw_dontgo. The abruptbye beat is asw_dontgo. The boredom beat is asw_yes.

A condition for A Simple Warning:
	if Lawn is visited and exploring Progue's turf, rule succeeds.

A completion rule for A Simple Warning:
	now dont_describe_Progue is true;
	Progue's life goes on;
	follow the Progue's motivation rule.

ASW is a thread. asw_intro is a beat in ASW with reaction "'Oh and hello there,' Progue says with a broad smile, subtly stepping in your way. 'I wonder if I could trouble you for some time; just a ment, just a ment.'". The yes-beat of asw_intro is asw_yes. The no-beat of asw_intro is asw_no. asw_intro suggests asw_yes.

asw_no is an annoying submissive terminal beat in asw with keyword name "no" and reaction "'Ah well then,' he says, backing away submissively, 'just something for your own safety, if you ring. Probably not important. Carry on, carry on.' He turns and walks quickly away.".

asw_dontgo is a repeatable ephemeral beat in asw with reaction "'Please, hear me out,' Progue says, grabbing your arm.".

asw_yes is an impressive beat in asw with keyword name "sure" and reaction "'Fancy fancy,' Progue says, 'I'll fly true to the nest. I can't help but have noticed you prancing about up on the mountaintop[if ever-used-ropeway is true]; that ropeway makes quite a racket, if you ring[otherwise], shimmying up that crack like a wet lizard[end if]. All splend and charm, [animal-nickname], but it's just I don't think you realize what terrible, terrible [asw_danger] you're in up there.' He pauses, glancing at you anxiously.". asw_yes suggests asw_danger. asw_danger replaces asw_yes. asw_yes cancels asw_no.

Understand "danger/dangers" as asw_danger when last beat is in ASW. asw_danger is a beat in ASW with keyword name "dangers" and reaction "'Sausages, yes,' he says, pacing back and forth with a worried expression. 'Why, a [if player is male]gent[otherwise]lady[end if] could slip and fall off the sheer, or be seared by lightning in those afternoon showers, and then there's that dreadful, er...' He waves a hand around towards the top of the mountain vaguely. '...that [asw_pyramid] up there, and really I don't think you ought to fool with it, asking myways.' He shudders.". asw_danger suggests asw_pyramid. asw_pyramid replaces asw_danger.

Understand "thing" as asw_pyramid when last beat is in ASW. asw_pyramid is a beat in ASW with keyword name "thing" and reaction "'Abominable thing,' he says with vehemence. 'Sitting up there with its glowing red light, and its... its damnably triangular faces, and...' He trails off.[paragraph break]'Moisty hells,' he says. 'Truth is, for life and strife I can't remember what's actually dangerous about the thing. But!' he says, raising his eyebrows and a wary finger. 'But but but. I'm gushing sure there's something terrible [asw_wrong] about it, have my words. Just what and whatever you do, [animal-nickname], don't open it. No mattering whatwards. The [asw_contents] are completely not worth seeing, believe you me.'". Check examining by name distant-pyramid: if asw_pyramid is available, try discussing asw_pyramid instead. asw_pyramid suggests asw_outtro. asw_outtro replaces asw_pyramid.

Understand "wrong" as asw_wrong when last beat is in ASW. asw_wrong is a beat in ASW with keyword name "wrong" and reaction "He frowns, rubbing his temples as if besieged by sudden headaches. 'Look and I told you I don't remember,' he says. 'But lie assured it's not something of which you want to get yourself plum in the mid.'". asw_wrong enqueues asw_outtro.

Understand "contents" as asw_contents when last beat is in ASW. asw_contents is a beat in ASW with keyword name "contents" and reaction "'What did I just say?' he says angrily. 'There's nothing in there! Nothing at all! Opening it would be utterly and completely pointless!'". asw_contents enqueues asw_outtro.

asw_outtro is a terminal beat in ASW with reaction "'Oh well oh, terrible sorries for disturbing,' he finishes. 'Enjoy the [progue-time-of-day] then!' And he heads off smartly with a tuneless whistle.". 



Section - Small Favor

Small Favor is a common serendipitous triggered episode. The expiration date is 2 hours. The icebreaker is sf_intro. The bye beat is sf_negatory. The abruptbye beat is sf_negatory.

Last condition for Small Favor:
	if the lava tunnel door is open, rule succeeds.

SF is a thread. sf_intro is an insistent beat in sf with reaction "'Lovely [progue-time-of-day], isn't it, [animal-nickname]?' Progue says, [animus-business] and flexing his toes on the [surface-material]. 'Oh, while you're about, I have [if submission of Progue < 0]just a small favor that I wonder if I might ask, in the name of co-habitation and conciliation and all that[else]a request, sort of a rule ratherly[end if], about the door in the back of the cabin. Have a ment?'". The yes-beat of sf_intro is sf_yes. The no-beat of sf_intro is sf_negatory. sf_intro summons sf_yes, sf_negatory. sf_intro suggests sf_yes.

sf_yes is an insistent beat in SF with keyword name "yes" and reaction "'Splend,' he says, 'well and here it is: to fly true to the nest it gushing unnerves me to have that door open all the time. It's been closed for so long, if you ring, and though I can't just quite remember why it is I wanted it closed I strong and strongly feel it should be. So here's my little favor: would you terrible mind closing it after yourself as you go fore and back through it? It would mean worlds to my peace and piece of mind. Can you oblige?'". The yes-beat of sf_yes is sf_wilco. The no-beat of sf_yes is sf_negatory. sf_yes summons sf_wilco, sf_negatory. sf_yes suggests sf_wilco.

sf_wilco is a terminal beat in SF with keyword name "sure" and reaction "'Delicious,' he says, clapping you on the back, 'most apprished. A little thing but it'll make me feel ever so ever so better. Miles of thanks, [animal-nickname], miles of thanks.' [Progue-resumes].".

sf_negatory is a terminal submissive beat in SF with keyword name "no" and reaction "'[if submission of Progue > 0]Ah. Oh. Well, who am I to ask favors I suppose[else]I see. If that's your case, then, don't expect any favors from me in the future, either[end if],' he says. [Progue-resumes].".

Complying-With-Progue's-Favor is a scene. Complying-With-Progue's-Favor begins when sf_wilco is spoken and ( location is Chasm Floor and former location is Jumble ) or ( location is Hut and former location is Back Room ) . Complying-With-Progue's-Favor ends when Complying-With-Progue's-Favor begins.

When Complying-With-Progue's-Favor begins:
	if lava tunnel door is closed:
		if drama manager is being debugged, say "// Drama: Progue is less submissive because we closed the door.";
		Progue is less submissive;
	otherwise:
		if drama manager is being debugged, say "// Drama: Progue is more submissive because we didn't close the door.";
		Progue is more submissive.



Section - Mad Honesty

Mad Honesty is a common serendipitous triggered episode. The icebreaker is mh_intro. The expiration date is 2 hours.

Last condition for Mad Honesty: rule succeeds.

MH is a thread. mh_intro is an insistent beat in MH with reaction "'Tell me, [animal-nickname],' Progue says abruptly, '--and side aside, do you mind me calling you [animal-nickname]?'". The yes-beat of mh_intro is mh_animalmind. The no-beat of mh_intro is mh_animaldontmind. The maybe-beat of mh_intro is mh_animaldontmind. mh_intro suggests mh_animaldontmind. mh_intro summons mh_animalmind, mh_animaldontmind. mh_intro summons mh_animaldontmind, mh_animalmind.

mh_animalmind is a beat in MH with keyword name "yes" and reaction "'Ah well you, there you see,' he says, 'good to know, good to know.' He rummages around in his clothes for a furry piece of hide, a long feather, and a tiny vial, which he quickly uncaps and scribbles something on the hide, murmuring 'No [animal-nickname]' to himself as he does it. He frowns. 'Dear oh dear oh,' he says, 'the only other note on my go-to list is [']Find endearing nickname for that strange ghost [if player is female]wo[end if]man; why not [animal-nickname]? Seems to fit.['] I'll just cross this one out here.' He scribbles for a moment in embarrassment, then slips the implements away.". mh_animalmind enqueues mh_realq.

mh_animaldontmind is a beat in MH with keyword name "shrug" and reaction "'Splend!' he says, beaming. 'It's nothing personal you understand, but it's just I have such difficulties with names, as you noticed; can hardly keep hold of my own. I used to have such a good system for remembering names, using pneumatics; or was it gnomonics? Moisty hells, I need another Word Day; they all start to jumble up and congratulate together like blood clots if I don't practice.'". mh_animaldontmind enqueues mh_realq.

mh_realq is an insistent beat in MH with reaction "'Yes but well that aside,' he says, 'the real question to question you with was just this: are we friends, do you suppose?'". The yes-beat of mh_realq is mh_yesfriends. The no-beat of mh_realq is mh_nofriends. The maybe-beat of mh_realq is mh_confused. mh_realq summons mh_yesfriends, mh_nofriends, mh_confused. mh_realq suggests mh_confused.

Understand "smile" as mh_yesfriends when last beat is in mh. mh_yesfriends is an affinitive terminal beat in MH with keyword name "[if last beat is mh_confused]smile[else]yes" and reaction "'Oh good!' he says, face lighting up. 'I trickling thought we might be now, but it's been green eons since I lumped into anyone so I couldn't remember if this was what it was like. Delightful! All I wanted to know; thank you!' He smiles cheerfully and turns away, [animus-business].".

mh_nofriends is an insistent beat in MH with keyword name "no" and reaction "'Oh,' he says. 'Do we want to be?'". The yes-beat of mh_nofriends is mh_yesfriends. The no-beat of mh_nofriends is mh_dontwant. The maybe-beat of mh_nofriends is mh_confused. mh_nofriends summons mh_yesfriends, mh_dontwant, mh_confused. mh_nofriends suggests mh_confused.

Understand "sock" as mh_dontwant when last beat is in mh. mh_dontwant is a terminal unaffinitive beat in MH with keyword name "[if last beat is mh_confused]sock[else]no" and reaction "'[if affinity of Progue > 0]Oh,' he says, 'well then I'm confused. I thought we were, you see. Don't mind me, I'm bats at noon; been green eons since I lumped into anyone and I don't even remember what it's like[else]Ah,' he says, 'well that gives it the clinch, then. It seems we're not to be friends after all[end if]. Well, carry on, stranger. No, wait-- get off my [surface-material]! Is that how you do it? Something thatwise anyway. Go away!' He turns away, [animus-business].".

mh_confused is a beat in mh with keyword name "shrug" and reaction "'I'm confused too,' Progue admits, 'it's what I'm best at. Let's try an experiment, shall we? I'll come up to you--' he demonstrates this by taking a few paces back, then walking up again-- 'and say, [']Blue as blue skies to you, [animal-nickname]!['] Be honest, now, is your reaction inclinationwise to [mh_dontwant] me one in the mouth or [mh_yesfriends] and make small talk?'". mh_confused suggests mh_dontwant.



Section - Feast of Submission

Feast of Submission is a uncommon rendezvous episode with summary "cooking seafood feasts together". The expiration date is 4 hours. The icebreaker is fos_intro. The meeting place is South Beach. The boredom beat is fos_continue. The bye beat is fos_continue. The abruptbye beat is fos_continue.

Last condition for Feast of Submission:
	if raining, rule fails;
	if exploring Progue's turf, rule fails;
	if submission of Progue > 0, rule succeeds.

Every turn when current episode is Feast of Submission and location is not South Beach and location is regionally in Lacuna and icebreaker of Feast of Submission is unspoken and a random chance of 1 in 2 succeeds: say "You notice a column of smoke rising from [if location is regionally in Beachfront or location is Rise]the southern part of the beach, near the boulders[else]somewhere on the beach[end if].".

Table of Progue's Initial Appearance (continued)
animus	episode			desc
--		Feast of Submission		"Standing over a fire is Progue, expertly grilling a small feast of crabs and fish."

A beach-fire is set dressing with printed name "fire". Understand "fire" as beach-fire.

Some beach-seafood is set dressing with printed name "seafood". Understand "fish/crabs/crab/seafood/food" as beach-seafood.

FOS is a thread. The escape clause is fos_continue.

fos_intro is a beat in FOS with reaction "[if affinity of Progue > 0]'Ah, just in time,' Progue says[otherwise]'I see you noticed the smoke,' Progue says dryly[end if], turning a skewered crab carefully over the flames. '[if paternalism of Progue > 2]You need to eat a good [fos-meal]; you can't survive on berries and konokuk fruit alone,' he adds chidingly[otherwise if romance of Progue > 2]Thought maybe we could have a little [fos-meal] together, just we two, away from all those crowding hordes and hoarding crowds on the rest of the island,' he adds with a wink[otherwise]Well, if I'm cooking [fos-meal] I may as well cook [fos-meal] for two,' he adds[end if].[paragraph break]The seafood looks ready to eat, but you're not quite sure if you should just [fos_tuck] in or [t]wait[x] for Progue to begin, or even [fos_refuse] to have any.". fos_intro suggests fos_wait. After discussing Progue: move beach-fire to location; move beach-seafood to location; continue the action. Instead of taking or tasting some beach-seafood, try discussing fos_tuck.

To say fos-meal: if dawn or sunrise or morning or midmorning, say "breakfast"; if midday or afternoon, say "lunch"; if evening or sunset or twilight or night, say "dinner".

Understand "tuck" as fos_tuck when last beat is in FOS. fos_tuck is a submissive beat in FOS with keyword name "tuck" and reaction "You pick up one of the fish skewers and sample the steaming white flesh. It is delicious. Progue seems to have steamed it in konokuk milk and seasoned it with something tangy, but the fish itself is fresh and tender beyond belief. You quickly finish it, and by the time you're done Progue has pounded open one of the crab shells with a rock and is handing you portions of buttery meat even more delicious.". fos_tuck cancels fos_wait, fos_refuse. fos_tuck suggests fos_outtro. fos_tuck summons fos_thanksnorm. After discussing fos_tuck: now bye beat of Feast of Submission is nothing; continue the action.

fos_wait is an unsubmissive beat in FOS with reaction "You wait patiently, mouth watering, for Progue to give you the go ahead to start. Finally, he picks up a skewer of tender white meat, takes a bite, chews thoughtfully, then nods. 'It's ready.'[paragraph break]You pick up one of the fish skewers and sample the steaming white flesh. It is delicious. Progue seems to have steamed it in konokuk milk and seasoned it with something tangy, but the fish itself is fresh and tender beyond belief. You quickly finish it, and then turn to the crab. Progue hands you a rock you can use to break open the shell, and before long you are digging out portions of buttery meat even more delicious, eating some yourself and handing the rest to the chef.". fos_wait cancels fos_tuck, fos_refuse. fos_wait suggests fos_outtro. fos_wait summons fos_thanksnorm. After discussing fos_wait: now bye beat of Feast of Submission is nothing; continue the action.


Understand "refuse" as fos_refuse when last beat is in FOS. fos_refuse is a insistent beat in FOS with keyword name "refuse" and reaction "'Oh,' he says. 'Because of some [fos_ideology], or do you just [fos_refrain] from eating my food?'". fos_refuse cancels fos_wait, fos_tuck.

Understand "ideology" as fos_ideology when last beat is in FOS. fos_ideology is a beat in FOS with keyword name "ideology" and reaction "'A pity,' he says, 'it's gushing delicious. Well, but I'll eat what I can and the sharks will finish the rest.' He digs in, and you wonder whether you should go out of your way to [t]thank[x] him profusely anyway, or just [fos_continue] on with what you were doing.". Instead of thanking Progue when last beat is fos_ideology, try discussing fos_thanks. fos_ideology summons fos_thanks.

fos_thanks is a terminal unsubmissive beat in FOS with keyword name "thank" and reaction "'[if affinity of Progue > 0]My pleasure,' he says around a mouthful of crab, 'enjoy your belief-system-compatible meal instead![else]Makes no diff to me,' he says around a mouthful of crab, 'I really was just being polite.[end if]' He goes on with his eating.".

Understand "continue" as fos_continue when last beat is in FOS. fos_continue is a terminal submissive beat in FOS with keyword name "continue" and reaction "'Oh well oh, enjoy the [progue-time-of-day] anyway,' Progue says, taking a bite of fish and chewing reflectively.". 

Understand "refrain" as fos_refrain when last beat is in FOS. fos_refrain is a unaffinitive submissive terminal beat in FOS with keyword name "refrain" and reaction "'I suppose I've forgotten what real cooking is like,' he says [if affinity of Progue > 0]sadly[else]with a touch of bitter sarcasm[end if], looking down at the fire. 'This probably tastes something terrible. Ah well-oh, just an experiment. I'll eat it at least.' He takes a bite from a large fish and starts chewing thoughtfully.".

Understand "thank" as fos_thanksnorm when last beat is in FOS. fos_thanksnorm is a terminal affinitive beat in FOS with keyword name "thank" and reaction "'No troubles at all,' he says with a beaming grin, banking the fire and rising to his feet. 'Nice to have dining companions for a change. Enjoy the [Progue-time-of-day]!'".

fos_outtro is a terminal beat with reaction "'Well, nice to have dining companions,' he says, banking the fire and rising to his feet. 'Enjoy the rest of your [Progue-time-of-day].'".


Section - Hold This Please

[ Submissive. ]

Hold This Please is a guaranteed triggered serendipitous episode. The expiration date is 2 hours. The icebreaker is htp_intro. The subchange beat is htp_dontgo. The bye beat is htp_dontgo. The abruptbye beat is htp_dontgo.

Last condition for Hold This Please:
	unless the animus of Progue is fishing or the animus of Progue is beach-combing, rule fails;
	if the submission of Progue < 0, rule succeeds.

HTP is a thread. htp_intro is an insistent beat in htp with reaction "Progue grunts as you approach, eyes locked on the [if the animus of Progue is fishing]waves[else]sand[end if]. 'Quick, hold this,' he says, holding out [if the animus of Progue is fishing]his fishing[else]a handful of sea[end if] [htp_pole].". htp_intro suggests htp_noncomply. htp_intro summons htp_pole, htp_noncomply. The yes-beat of htp_intro is htp_pole. The no-beat of htp_intro is htp_noncomply. htp_intro summons htp_noncomply. Instead of taking fishing-pole, try discussing htp_pole. Check examining by name fishing-pole when last beat is in HTP: force discuss htp_pole instead. After discussing htp_intro: if animus of Progue is beach-combing, move prop-weed to Progue; continue the action. Check examining by name prop-weed when last beat is in HTP: force discuss htp_pole instead.

htp_dontgo is a dogged repeatable beat in htp with reaction "'Won't be a ment,' Progue says, 'almost got it.'".

htp_noncomply is a submissive annoying terminal beat in htp with keyword name "no" and reaction "He blinks at you in surprise. '[if submission of Progue < -2]Liked you better,' he says, 'when you did as told[else]Didn't mean it as an order,' he says, 'I'll try and be more polite in the future[end if].' [Progue-resumes].".

Understand "pole/weed" or "sea weed" or "seaweed" as htp_pole when last beat is in htp. htp_pole is a beat in htp with keyword name "[if the animus of Progue is fishing]pole[else]weed" and reaction "[if the animus of Progue is fishing]You take hold of the stick, its fibrous line disappearing out into the water, while Progue[else]Progue dumps the wet green pile into your hand, and[end if] begins rummaging through his voluminous garments for something.[paragraph break]'Thanks,' he says, 'won't be a ment.'". htp_pole suggests htp_pole2. htp_pole summons htp_drop. After discussing htp_pole: if the animus of Progue is fishing, move fishing-pole to player; else move prop-weed to player; continue the action.

Some prop-weed is set dressing with printed name "sea weed". Understand "weed" as prop-weed.

htp_pole2 is a beat in htp with reaction "Progue pats his pockets with a frown, digging a hand deep in one only to come up with a bright red seashell. He shoves it back in a pocket and keeps searching.". htp_pole2 suggests htp_pole3.

htp_pole3 is a beat in htp with reaction "'It's here somewhere,' he mutters, emptying out a pocket full of sand in dismay.". htp_pole3 suggests htp_pole4.

htp_pole4 is a beat in htp with reaction "'Aha!' he cries, pulling out something that looks like a dead beaver and shaking it out.". htp_pole4 suggests htp_pole5.

htp_pole5 is a beat in htp with reaction "Progue meticulously unfolds the beaver, revealing it to be something more like a beaver skin, smoothing out wrinkles and muttering in satisfaction.". htp_pole5 suggests htp_pole6.

htp_pole6 is a beat in htp with reaction "Carefully, Progue arranges the beaver skin over his head. 'My lucky [if the animus of Progue is fishing]fishing[else]cleaning[end if] cap,' he says. 'Almost forgot it.'". htp_pole6 suggests htp_pole7.

htp_pole7 is a unsubmissive terminal beat in htp with reaction "'Thanks ever so much,' he says, finally taking the [if the animus of Progue is fishing]fishing pole[else]seaweed[end if] back from you, 'you do come in useful every now and then. Enjoy your [progue-time-of-day]!'. He turns away, [animus-business].". After discussing htp_pole7: if the animus of Progue is fishing, move fishing-pole to Progue; remove prop-weed from play; continue the action.

htp_drop is a submissive annoying terminal beat in htp with fuse 10 and keyword name "{wait, or say DROP [if the animus of Progue is fishing]POLE[else]WEED[end if]}" and reaction "You let go of the [if the animus of Progue is fishing]pole and it tumbles to[else]pile and it splatters on[end if] the beach. Progue glances over in dismay. '[if submission of Progue < -2]You clumsed it,' he says, 'Try and be more careful in the future, [animal-nickname][else]Oh, terrible sorries,' he says, 'were you plum in the midst of something? Didn't mean to take up your time[end if].' He picks up the [if the animus of Progue is fishing]pole[else]seaweed[end if] and turns away, [animus-business].". First before dropping fishing-pole: try discussing htp_drop instead. First before dropping prop-weed: try discussing htp_drop instead. After discussing htp_drop: if the animus of Progue is fishing, move fishing-pole to Progue; remove prop-weed from play; continue the action.


Section - Thought I Warned You

[An unaffinitive episode.]

Thought I Warned You is a serendipitous triggered episode. The expiration date is 2 hours. The icebreaker is tiwy_intro.

The allow Thought I Warned You rule is listed before the Progue is chattier the more he likes you rule in the condition rules. A condition for Thought I Warned You (this is the allow Thought I Warned You rule):
	if A Simple Warning is unaired, rule fails;
	if Lawn is visited and affinity of Progue < 0, rule succeeds.

TIWY is a thread. tiwy_intro is a beat in tiwy with reaction "'Oh, there you are,' says Progue [if affinity of Progue < -2]angrily[else]uncomfortably[end if]. 'I couldn't help but notice you [if ever-used-ropeway is true]riding the ropeway up to the mountain again[else]climbing up the crack to the top of the mountain again[end if] earlier. [if submission of Progue > 0]I told you, you really shouldn't; it's too dangerous.[else]I warned you about that; the thing's unsafe. Is this the willful or blatant form of stupidity then?[end if][if paternalism of Progue > 2] You could hurt yourself.[end if]' He looks at you challengingly.". tiwy_intro summons tiwy_sorry, tiwy_ignore, tiwy_insult. tiwy_intro suggests tiwy_ignore.

Understand "sorry" as tiwy_sorry when last beat is in tiwy. tiwy_sorry is an affinitive terminal beat in tiwy with keyword name "sorry" and reaction "He softens a little. 'It was for your own safety, you know,' he says. 'Just be careful is all I ask.' [Progue-resumes].".

Understand "insult" as tiwy_insult when last beat is in tiwy. tiwy_insult is an unaffinitive terminal beat in tiwy with keyword name "insult" and reaction "'Oh so clever,' he sneers, 'oh so droll. Fine; use the thing if you want, but I'll have no part in it. So long.' [Progue-resumes].".

Understand "ignore" as tiwy_ignore when last beat is in tiwy. tiwy_ignore is a terminal beat in tiwy with keyword name "ignore" and reaction "'Fine,' he says, 'use the thing if you want, but I'll have no part in it. So long.' [Progue-resumes].".



Section - Dolphins Meeting

[An affinitive episode.]

Dolphins Meeting is an instant triggered uncommon episode with summary "watching the dolphins play". The meeting place is Rise. The icebreaker is dm_intro. The expiration date is 2 hours. The bye beat is dm_leaveearly. The abruptbye beat is dm_leaveearly.

Last condition for Dolphins Meeting:
	if we are not going, rule fails;
	if Progue is enclosed by location, rule fails;
	if affinity of Progue < 0, rule fails;
	if location is Stumps and former location is not Rise and Progue is not regionally in North island and Progue is not regionally in Marshlands, rule succeeds;
	if location is South Beach and former location is not Center Beach and Progue is not regionally in Tiderooms and Progue is not regionally in Progue's Domain, rule succeeds;
	if location is Center Beach and former location is Hut and Progue is not regionally in Progue's Domain, rule succeeds;
	rule fails.

A commencement rule for Dolphins Meeting:
	now dont_describe_Progue is true;
	say "Progue, perched on the tip of the [d]rise[x], spots you and begins waving frantically, a look of excitement on his face. 'Come quick!' he shouts, 'You have to see this!'".

First finishing rule for Dolphins Meeting:
	ignore the episodes usually end when conversation does rule;
	if the number of spoken terminal beats in DM > 0:
		Progue's life goes on;
		now Dolphins Meeting is successful;
		if there is a eptitle of Dolphins Meeting in episode schedule:
			choose row with a eptitle of Dolphins Meeting in episode schedule;
			blank out the whole row;
			sort episode schedule in random order;
		consider the completion rules for Dolphins Meeting;
		rule succeeds.

A completion rule for Dolphins Meeting:
	now icebreaker of Play Catch is spoken. [to prevent reruns]

Table of Progue's Initial Appearance (continued)
animus	episode			desc
--		Dolphins Meeting	"Progue lies on his stomach on the edge of the rise where it drops a short distance into the sea, peering intently at something in the water."

DM is a thread. dm_intro is a beat in DM with reaction "'Look and look,' he says, motioning you over to the edge, 'it's a dolphin rendezvous!'[paragraph break]You peer over the edge to see two clusters of [o]dolphins[x] through the clear turquoise water, the second group slightly bluer and slightly larger, the [o]youngest[x] and [o]oldest[x] nervously interacting on their edges.[paragraph break]'These littler ones are always around,' Progue says, excitement tingling his voice, 'but the larger group migrates or something thatwise; they're only around for a week or two each year. But I've never seen them mingling before! Something exciting, lie assured.'". After discussing dm_intro: move clusters of dolphins to location; continue the action. dm_intro suggests dm_intro2.

Some clusters of dolphins are set dressing. Understand "dolphin/larger/bluer/cluster/clusters/group" as clusters of dolphins. The description is "You can see the beautiful sea creatures with astonishing clarity, the [progue-time-of-day] light cutting the shallow water below you like diamond through glass.".

The youngest dolphins are part of some clusters of dolphins. The description is "The younger dolphins seem to have none of the caution of their parents, just a thrilling mixture of fear and intense curiosity at the unknown that is instantly familiar even in dolphin form. [if dm_intro2 is unspoken]They dart playfully around their parents, peeking at the young dolphins in the other group anxiously[else]They dart playfully around each other, delighted to have new playmates[end if].".

The oldest dolphins are part of some clusters of dolphins. The description is "The older dolphins of each group stay protectively near their front, regarding the other side warily, but slowly edging forward to meet the others with growing trust.".

dm_leaveearly is an ephemeral beat in DM with reaction "'Oh, stay for just a minute,' Progue says anxiously. 'This is something rare to see.'".

dm_intro2 is a beat in DM with reaction "'See, look now!' Progue says, pointing. 'They're introducing!' And indeed several of the dolphins from both sides have swum forward, nose to nose, to rub their snouts briefly against the other before darting back into the crowd.[paragraph break]'Have you noticed in your wayfarings,' Progue muses, 'how on most every world folk shake hands somewhere in the meeting process, but it always means something trickling different? Sometimes they'll shake at the conclusion of good deals, sometimes to ward off bad ones; sometimes before even swapping names; sometimes women will shake but not men, or men but not women. Different but mostly usually always the same result in the end.' He pauses for a moment, considering.". dm_intro2 suggests dm_intro3. dm_intro2 summons dm_shakehands.

dm_intro3 is a beat in DM with reaction "'On my homeworld,' he continues, 'you know, my real one-- you wouldn't shake when you first were introduced to someone; only, only once you'd decided they were going to be a friend.' He smiles, remembering. 'And what a warm and warming feeling that was,' he says, 'that moment of contact and knowing what it meant, knowing you were increasing by one the circle of those you cared for.' He sighs, and the two of you pause for a moment, staring down at the dolphins contemplatively.". dm_intro3 suggests dm_progueshakes. dm_intro3 summons dm_shakehands.

Understand "shake hands" or "shake hands with [someone]" or "shake [someone]'s hand" as shaking. Rule for supplying a missing noun when shaking: let honoree be a random visible other nonbestial person enclosed by the location; if honoree is a person, change noun to honoree. Instead of shaking Progue when last beat is dm_intro3, try discussing dm_shakehands.

dm_shakehands is an affinitive beat in dm with reaction "Surprised, Progue looks down at your hand, then realization dawns on his face, a slow, spreading smile. Cautiously at first, then with more and more strength and feeling, he grips your hand and shakes it vigorously.". dm_shakehands enqueues dm_shakeresult.

dm_shakeresult is a terminal beat in dm with reaction "'Something Further,' he says, 'it's been green eons-- I won't know what to do with a friend who doesn't bear fruit or breathe water.' He laughs. 'New friends above and below the waves today. It's a good day on the island.'[paragraph break]He finally breaks the grip and rises to his feet, brushing himself off and giving the dolphins one last, wistful glance. 'Must be off,' he says, 'things to do. But take care, friend, take care.'".

dm_progueshakes is an insistent beat in dm with reaction "Progue coughs, nervously. 'Well. I hope you won't think me rude or presumptuous, but...' And he holds out his [dm_pshake2], hesitant and uncertain.". dm_progueshakes suggests dm_noshake. dm_progueshakes summons dm_pshake2.

Understand "hand" as dm_pshake2 when last beat is in dm. dm_pshake2 is an affinitive beat in dm with keyword name "hand" and reaction "Progue grips your hand cautiously at first, then with more and more strength and feeling, shaking it vigorously as a huge smile spreads across his face.". dm_pshake2 enqueues dm_shakeresult. Instead of shaking Progue when last beat is dm_progueshakes, try discussing dm_pshake2.

dm_noshake is an unaffinitive terminal beat in dm with reaction "'Well, that's fine as fine then,' Progue says, hastily withdrawing the hand. 'Just a thought is all. I realize it's only been a day or two. Perhaps in a few more weeks, eh?'[paragraph break]He rises quickly to his feet, brushes himself off, and gives the dolphins one last glance. 'Enjoy,' he says, 'got some business to attend to.'".





Section - Hey That's Mine

[A submissive scene]

Hey That's Mine is a guaranteed triggered serendipitous episode. The icebreaker is htm_intro. The subchange beat is silence. The boredom beat is silence. The bye beat is silence. The abruptbye beat is silence.

The allow Hey That's Mine rule is listed before the Progue is chattier the more he likes you rule in the condition rules. A condition for Hey That's Mine (this is the allow Hey That's Mine rule):
	if player wears Progue's pendant, rule succeeds.

A completion rule for Hey That's Mine:
	remove Progue's pendant from play.

HTM is a thread. htm_intro is an insistent beat in htm with reaction "'Happy [Progue-time-of-day],' he says, looking up and [animus-business]. He frowns, noticing the pendant around your neck.[paragraph break]'Hey now,' he says, 'that's mine. Give that back.' He reaches out his hand to take it; you could [htm_prevent] him or let him [htm_have] it.". htm_intro suggests htm_prevent. htm_intro summons htm_prevent, htm_have.

Understand "prevent" as htm_prevent when last beat is in htm. htm_prevent is a submissive beat in htm with keyword name "prevent" and reaction "You step back as he snatches for it, and his face grows annoyed. 'Don't be a blinded mule,' he snaps, 'give it back.' He snatches for it again with a bit more force and rips it off you, the leather strap snapping through your hair.[paragraph break]'And don't take any more of my things,' he says, miffed, shoving the pendant into a pocket. 'Now, was there something you wanted?'".

Understand "keep" as htm_have when last beat is in htm. htm_have is a beat in htm with keyword name "keep" and reaction "You return the pendant to [the Progue], who shoves it in a pocket, muttering grumpily. 'I suppose you're just in the [htm_habit] of picking up everything that's not nailed down,' he says, 'is that it?'". htm_have suggests htm_habit.

Understand "habit" as htm_habit when last beat is in htm. htm_habit is a beat in htm with keyword name "habit" and reaction "'Hrmph,' he says, 'well just ask next time, if you don't remind. Was there something you wanted to talk about?'".



Section - Older And Wiser

[Progue asks who is older (paternal).]

Older And Wiser is a common serendipitous triggered episode. The icebreaker is oaw_intro. The subchange beat is silence. The bye beat is silence. The abruptbye beat is silence. The boredom beat is silence.

Last condition for Older And Wiser: rule succeeds.

OAW is a thread. oaw_intro is an insistent beat in oaw with reaction "Progue studies you appraisingly, looking you up and down. 'Say, [animal-nickname],' he says, 'I know in our mad strange lives of hopscotching twixt worlds that years get mangled and mingled. But generally, rough-and-guessing, would you say I'm [oaw_older] than you, or [oaw_younger], or about the [oaw_same] age?'". oaw_intro summons oaw_older, oaw_younger, oaw_same.

Understand "older" as oaw_older when last beat is in oaw. oaw_older is a paternal beat in oaw with keyword name "older" and reaction "'Just what I'd have wagered,' he says, nodding. 'Well and then I suppose I'm not mad to be feeling something fatherly towards you, worrying if you get into danger, all that. Been green eons since I've felt something thatwise. Curi-curious.'". oaw_older enqueues oaw_trans.

Understand "younger" as oaw_younger when last beat is in oaw. oaw_younger is an unpaternal beat in oaw with keyword name "younger" and reaction "'Oh, sausages, you're too and too kind,' he says, waving a hand dismissively, 'the most delicious part of these holes in the memory is not remembering what I used to look like green eons ago so there's nothing to compare this sun-worn haggard visage with. But mayhaps you're right. We've both been in the pool long enough to learn how to swim, I wager.'". oaw_younger enqueues oaw_trans.

Understand "same" as oaw_same when last beat is in oaw. oaw_same is a beat in oaw with keyword name "same" and reaction "'Can't tell either, eh?' he mutters, squinting at you. 'Ah well-oh, less than important, just curi-curious. Guess we've more or less been in the pool long enough to learn how to swim, if you ring.'". oaw_same enqueues oaw_trans.

oaw_trans is a beat in oaw with reaction "'But for life and strife, how is your exploring proceeding?' he adds. 'Anything you want to ask about?'".

Section - Knitted You A Gift

[Paternal / affinitive.]

Knitted You A Gift is a common urgent episode with summary "your konokuk husk sweater". The expiration date is 6 hours. The icebreaker is kyag_intro. The subchange beat is silence. The boredom beat is silence. The bye beat is silence. The abruptbye beat is silence.

Last condition for Knitted You A Gift:
	if conversation fuse < 15, rule fails;
	if affinity of Progue > 0, rule succeeds.

KYAG is a thread. kyag_intro is a beat in kyag with reaction "'Just the [if player is male]man[else]girl[end if] I'm looking for,' Progue says, approaching you with hands holding something behind his back. 'Got a little gift for you. Something I made with my own two. Look!' And he pulls out from behind his back a huge blob of brown fur, which you slowly realize is some sort of [o]sweater[x] made from konokuk husks.". After discussing kyag_intro: move husk sweater to location; continue the action. kyag_intro suggests kyag_offer.

kyag_offer is a beat in kyag with reaction "'Just for you,' he beams proudly, regarding it as if it's a long-lost work of art, 'should be just your size, too. Go on, try it on!' He holds it out for you to take, but you hesitate, wondering if rather than [kyag_tryon] it might be better for everyone if instead you gently [kyag_refuse].". kyag_offer summons kyag_tryon. kyag_offer suggests kyag_refuse.

Understand "refuse" as kyag_refuse when last beat is in kyag. kyag_refuse is an unpaternal terminal beat in kyag with keyword name "refuse" and reaction "[if submission of Progue > 0]His face falls. 'Oh, well that's right and alright then,' he says, looking down at the sweater with flushed cheeks, 'it is an awful monstrosity, isn't it? Don't know what crept into me. Terrible sorries![else]'All that time to make this for you and you won't even try it on? Moisty hells. Fine, I'll keep it myself then.[end if]' He shoves the sweater awkwardly half-into a bulging pocket.".

Check taking the husk sweater: force discuss kyag_tryon instead.

Understand "accept" as kyag_tryon when last beat is in kyag. kyag_tryon is a beat in kyag with keyword name "accept" and reaction "You cautiously take hold of the rustling offering and heft its surprisingly heavy bulk. Progue looks pleased.[paragraph break]'Go on now, let's see you try it on,' he says eagerly.". The yes-beat of kyag_tryon is kyag_tryon2. The no-beat of kyag_tryon is kyag_refuse. kyag_tryon summons kyag_refuse, kyag_tryon2. After discussing kyag_tryon: move husk sweater to player; continue the action. kyag_tryon cancels kyag_refuse.

Understand "okay/ok" as kyag_tryon2 when last beat is in kyag. kyag_tryon2 is a beat in kyag with keyword name "okay" and reaction "You slip your arms through the sleeves and immediately they start to itch and feel hot. By the time you have managed to shrug the bulky sweater all the way on you are sweating profusely, and not just from the exertion.[paragraph break]'Oh, it looks something wonderful!' Progue gushes, plucking the sleeves and looking over you appraisingly. 'Charming. Now then, anything you wanted to discuss?'". Instead of wearing husk sweater when kyag_tryon2 is available, try discussing kyag_tryon2. After discussing kyag_tryon2: now player wears husk sweater; continue the action.

The husk sweater is a wearable thing. The description is "A shapeless blob of brown hair, the sweater seems to have been woven from konokuk husks. While the workmanship of the full-length sleeves and muffled collar is very fine, it looks rather hot for a tropical environment.". After going when player wears the husk sweater and a random chance of 1 in 4 succeeds: say "You [one of]sweat profusely[or]itch madly[or]prickle your arms annoyingly[in random order] against the konokuk sweater."; continue the action. Check dropping husk sweater: say "You would feel a bit guilty just throwing it away like trash." instead.

Knitted Aftermath is a guaranteed urgent triggered episode. The icebreaker is kyag_letmedown. The subchange beat is silence. The boredom beat is silence. The bye beat is silence. The abruptbye beat is silence.

A condition for Knitted Aftermath:
	if conversation fuse < 6, rule fails;
	if player wears husk sweater or player holds husk sweater, rule succeeds.

A commencement rule for Knitted Aftermath:
	if player wears husk sweater, now icebreaker of Knitted Aftermath is kyag_goodboy;
	remove husk sweater from play.

kyag_letmedown is an unpaternal beat in kyag with reaction "'Oh, didn't like the sweater then?' Progue says in consternation. 'Well I can keep it for you if you aren't going to wear it.' He takes the sweater from your grateful hands and awkwardly shoves it into a pouch; tiny strands of husk shred off and dance sadly in the humid air.". 

kyag_goodboy is a paternal beat in kyag with reaction "'Lizard sausages, are you still wearing that thing?' Progue asks, tugging on a sleeve of the itchy sweater. 'I didn't mean you had to keep wearing it for all your life. Oh, but sweet as sweet of you to do so,' he adds with a smile and a clap on the back as you gratefully pull the clinging, ropey, itchy thing off. He takes it from you and regards it fondly before packing it away in a bulging pouch.".


Book - Progue in Uncertainty (in Lacuna-Progue-Uncertainty by Blue Lacuna)

Table of Uncertainty Episodes
eptitle
Rayfish Suicide
Uncertainty General Convo
Post-Storm Conversation
Heading Up
Hey That's Mine
A Good Cry
Rainfall Rhapsody
Older And Wiser
Fatherly Advice
Meteor Shower Invite
Used To Bring Me
Constant Ringing
Art Critic
Walk Invitation
A Simple Warning
Unexpected Present
Disappearance

Section - Uncertainty Setup

Transition Progue to Uncertainty is a scene. Transition Progue to Uncertainty begins when the psyche of Progue is uncertainty. Transition Progue to Uncertainty ends when Transition Progue to Uncertainty begins.

When Transition Progue to Uncertainty begins:
	truncate the list of convo stuff to 0 entries; [get rid of old keywords]
	[repeat with bt running through beats summoned by suppression keywords begin;
		now fuse of bt is 0;
	end repeat;] [ and keep them from coming back. ]
	now episode schedule is Table of Uncertainty Episodes;
	now current_thread of Progue is UncertainC;
	now the conversation_beat of Progue is uc_makeconversation; [these two lines were commented out; why? ]
	now the exhaust_beat of Progue is p_unc_exhausted;
	now the overexhaust_beat of Progue is p_unc_overexhaust;
	now the disgusted_beat of Progue is p_unc_dontlike;
	now the dontlike_beat of Progue is p_unc_dontlike;
	now the bored_beat of Progue is p_unc_bored;
	now the unavailable-beat of Progue is p_supp_unavailable;
	now the noanswer_beat of Progue is p_unc_noanswer;
	now the angryending_beat of progue is p_unc_angryending;
	now the randomyes_beat of Progue is p_unc_randomyes;
	now the randomno_beat of Progue is p_unc_randomno;
	now the rudebye_beat of Progue is p_unc_rudebye;
	now the abruptbye_beat of Progue is p_unc_abruptbye;
	now the redundantbye_beat of Progue is p_unc_cantfollow;
	now the redundanthi_beat of Progue is p_unc_cantfollow;
	now the bye_beat of Progue is p_unc_bye;
	now disposition of Progue is 0;
	now the naughttosay_beat of Progue is p_unc_naughttosay.
	

Section - Standard Uncertainty Behavior

UncertainC is a thread.

p_unc_naughttosay is a repeatable terminal beat in UncertainC with reaction "'[one of]Sorries, [animal-nickname], I think I need to be alone for a while now[or]Let's talk later, [animal-nickname]; I'm gathering a pounding headache[or]I need some time alone now, I think[in random order],' he says, [animus-business]. '[one of]We'll talk again soon[or]Let's take a rest for now[or]We'll chat again before too much longering[in random order]. [pgb2].'".[aar]

p_unc_exhausted is a repeatable ephemeral beat in UncertainC with reaction "'[one of]That's all[or]I wish I could remember more, [animal-nickname], but I'm bats at noon[or]Sorry, I don't know anything else about it[in random order],' Progue says tiredly, [one of]rubbing his knuckles against his temple[or]sighing[in random order].".

p_unc_overexhaust is a repeatable terminal beat in UncertainC with reaction "[if romance of Progue > 0]'Look, [animal-nickname], you're sweet,' Progue says, 'but I've been alone for baskets of years. I'm not used to all this human being. Come back later, eh? I'd be gushing grateful.' He smiles and winks at you.[otherwise if affinity of Progue < 0]'All right, that's enough for now,' Progue says angrily. 'Why don't you go off and leave me in peace for a while? Eh?' [Progue-resumes].[otherwise if paternalism of Progue > 0]Progue smiles, a bit strained. 'Would you mind letting me on my own for a while, [animal-nickname]?' he asks. 'My brain aches something terrible.'[otherwise if submission of Progue < -2]'I think I'm done talking for a while,' Progue says, rubbing his knuckles against his head. 'Come back later and we'll talk more.'[otherwise][reaction of pd_overexhausted][end if]". After discussing p_unc_overexhaust: Progue's life goes on, as before.

p_unc_dontlike is a repeatable beat in UncertainC with reaction "[if affinity of Progue > 0][uncdontlikeaff][otherwise][uncdontlikeunaff]". To say uncdontlikeaff: say "'[one of]Please, not right now[or]Sorry, I just can't talk right now[or]Oh [animal-nickname], I need to be alone just now[in random order],' Progue says. '[one of]Later, later[or]We'll talk later[or]Perhaps in a few hours[in random order].'". To say uncdontlikeunaff: say "[reaction of pd_dontlike]".

p_unc_bored is a repeatable terminal beat in UncertainC with reaction "[one of]Progue looks distracted, and you realize he's not really paying any attention to you any more.[or]'Sorry,' Progue says, shaking his head, 'what did you say? I'm drifting.'[or]Progue focuses on [Progue-animus], turning away from you and mumbling something about not being in the mood for conversation.[or]'I'm boring you,' Progue says vaguely, [attitude-business]. 'I'll just get back to my [Progue-animus].'[in random order]".

p_unc_unavailable is a repeatable ephemeral beat in UncertainC with reaction "[one of]'No,' Progue says, 'can we hold off on that for just a minute?'[or]'Sorries,' Progue says, 'let's finish up what we were talking about before.'[in random order]".

p_unc_noanswer is a repeatable dogged beat in UncertainC with reaction "[if paternalism of Progue > 0]Folding his arms, [otherwise if submission of Progue < 0]Staring straight at you, [otherwise if affinity of Progue < 0]Frowning, [end if]Progue waits silently for your reply.". p_unc_noanswer suggests p_unc_angryending. Instead of discussing p_unc_noanswer when actual last beat is p_unc_noanswer, try getting bored Progue. 

p_unc_angryending is a terminal beat in UncertainC. The reaction is "Without a word, Progue turns away.". After discussing p_unc_angryending: Progue's life goes on; continue the action.

p_unc_cantfollow is a repeatable ephemeral beat in UncertainC with reaction "'[one of]What's that[or]Sorries, come again[or]Eh[in random order]?' Progue says, [one of]rubbing his knuckles against his head[or][attitude-business][at random]. '[one of]I'm sorry, I'm having trouble following you.[or]This headache... I really have no idea what we're talking about.[in random order]'". 

p_unc_randomyes is a repeatable ephemeral beat in UncertainC with reaction "'[one of]Wonderful[or]Fantastic[or]Glad to hear[or]Gushing nice[at random],' he says absently, rubbing his knuckles against his head.".

p_unc_randomno is a repeatable ephemeral beat in UncertainC with reaction "'[one of]Terrible sorries[or]Ah well-oh[or]A trickling shame[or]Too bad[at random],' he says, not really paying attention.".

p_unc_rudebye is a repeatable ephemeral beat in UncertainC with reaction "'[one of]Half a moment[or]Hold on[or]Just a minute[in random order], Progue says.".

p_unc_abruptbye is a repeatable annoying beat in UncertainC with reaction "[if submission of Progue > 0]Progue does not respond as you walk away[otherwise if submission of Progue < 0]'Later maybe,' Progue says gruffly to your back as you move away[otherwise if affinity of Progue < 0]Progue ignores you as you depart[otherwise if affinity of Progue > 0]'Take care then,' Progue says sadly as you depart[otherwise]'Good [progue-time-of-day], then,' Progue says as you depart[end if].".

Instead of pushing Progue when the psyche of Progue is uncertainty, force discuss uc_push. uc_push is an ephemeral beat with reaction "You give Progue a hard shove. He staggers backwards, looking up at you with a [if paternalism of Progue > 1]stern[otherwise if affinity of Progue > 0]hurt[otherwise if romance of Progue < 0]bitter[otherwise]angry[end if] expression. '[if submission of Progue > 0]Please don't do that,[otherwise]What in the moisty hells do you think you're doing?[end if] he says.". uc_push2 replaces uc_push. uc_push2 is an annoying unaffinitive unromantic submissive beat with reaction "You shove Progue again. He [if submission of Progue > 3]falls back hard to the [surface-material], looking beaten[otherwise if submission of Progue > 0]staggers backwards, looking sullen, but doesn't try to retaliate[otherwise if submission of Progue < -3]grabs your hand and twists it, causing you to cry out in pain[otherwise]steps forward and pushes you back, snarling at you angrily[end if]. '[if paternalism of Progue > 0]I expected better from you[otherwise if affinity of Progue < 0]I expect nothing less from you[otherwise if submission of Progue > 0]Why don't you just leave me alone[otherwise]I'm through playing games with you[end if],' he says.". uc_push3 replaces uc_push2. uc_push3 is an unaffinitive annoying unromantic submissive terminal repeatable beat with reaction "[if submission of Progue > 0]Progue staggers back, then turns and runs[otherwise]Progue punches you in the face, then turns and walks away[end if] across the [surface-material], [if romance of Progue > 0]looking back at you once with tears in his eyes[otherwise if affinity of Progue > 0]shaking his head sadly[otherwise]looking back at you once with a furious gaze[end if].". After discussing uc_push3: if romance of Progue > 4, Progue is heartbroken; now dont_describe_Progue is true; Progue's life goes on; follow the Progue's motivation rule; continue the action.

Instead of attacking Progue when the psyche of Progue is uncertainty, force discuss uc_push3.

p_unc_bye is an impressive repeatable beat in UncertainC with reaction "[if affinity of Progue > 2 and a random chance of 1 in 2 succeeds][puncaffbye][otherwise if affinity of Progue < 2 and a random chance of 1 in 2 succeeds][puncunaffbye][otherwise if paternalism of Progue > 2 and a random chance of 1 in 2 succeeds][puncpatbye][otherwise if romance of Progue > 1 and a random chance of 2 in 3 succeeds][puncrombye][otherwise if submission of Progue < -2 and a random chance of 1 in 2 succeeds][puncunsubbye][otherwise][puncnormbye][end if]". To say puncaffbye: say "'[one of]Until later, then, my friend[or]Be careful out there[or]Enjoy the [progue-time-of-day], [if player is male]my good sir[otherwise]dear lady[end if][in random order],' Progue calls out, [animus-business].". To say puncpatbye: say "'[one of]Be careful, now,' Progue calls out fondly, [animus-business][or]Stay away from those trees, mind,' Progue replies, [animus-business][or]Don't get into trouble,' Progue says with a wink, tousling your hair[in random order].". To say puncrombye: say "'[one of]Catch you later,' Progue says with a wink, 'I hope.'[or]Leaving so soon?' he says with a look of disappointment. 'Well, come back when you can.'[or]I shall count the ments till you return,' he says with a wink, a mock bow and a genuine smile.[in random order] [Progue-resumes].". To say puncunsubbye: say "'[one of]Don't be too long! I never know when you might come in useful![or]Yes, you can go now, we're through here,[or]Keep on this side of the island, like I told you,[in random order]' he says [one of]firmly[or]loudly[in random order] as you leave, [animus-business].". To say puncunaffbye: say "'[one of]Sausages[or]I suppose so[or]If you say[or]And good riddance[in random order],' Progue [one of]mutters after you[or]replies grumpily[or]says to himself[in random order], [animus-business].". To say puncnormbye: say reaction of p_supp_bye.

Instead of hugging Progue when the psyche of Progue is uncertainty, force discuss p_unc_hug.

p_unc_hug is an affinitive impressive dogged beat in UncertainC. The reaction is "[if affinity of Progue < 0][puncunaffhug][otherwise if paternalism of Progue > 2][puncpathug][otherwise if romance of Progue > 0][puncromhug][otherwise][puncnormhug][end if]". After discussing p_unc_hug: if paternalism of Progue > 0, Progue feels more like a father; otherwise Progue is aroused; continue the action. p_unc_hug2 replaces p_unc_hug. To say puncunaffhug: say "'Moisty hells, what-- what are you--' Progue protests as you put your arms around him. 'This is ridiculous,' he says, trying to break away, 'unhand me!' As you pull back, he flashes you a put-upon look, and mutters to himself, [animus-business], but his demeanor towards you does seem a little softer.". To say puncpathug: say "Progue returns your hug tenderly, patting you on the back. '[']salright, [']salright,' he says, though you're uncertain who he's talking to. 'Oh, it feels good to hug someone again though, doesn't it?' He pulls back and smiles at you tenderly.". To say puncromhug: say "[if romance of Progue > 4]Progue hugs you back warmly, squeezing your shoulders with his strong sculptor's hands. 'Mmm,' he says warmly in your ear, 'I missed you too.' Finally releasing you, he keeps his hand on your shoulders for a long moment, staring deeply into your eyes with a smile, then steps back.[otherwise if romance of Progue > 2]Progue hugs you back warmly, squeezing your shoulders with his strong sculptor's hands. 'Oh, that was nice,' he says, stepping back. 'Oh, I've forgotten how nice that feels. Thank you.' He smiles.[otherwise]'What's this now?' Progue says in surprise as you hug him. 'My oh my!' He returns your embrace warmly, smiling as you step apart. 'You're a kind one, [animal-nickname],' he says with a warm smile, 'thanks.'[end if]". To say puncnormhug: say "Progue seems a bit surprised, but returns your embrace warmly. 'Ah,' he says, 'I'd almost forgotten what that feels like. Thanks, friend.'".

p_unc_hug2 is a repeatable annoying dogged beat in UncertainC with reaction "[if affinity of Progue < 0][puncunaffhug2][otherwise if paternalism of Progue > 2][puncpathug2][otherwise if romance of Progue > 0][puncromhug2][otherwise][puncnormhug2][end if]". To say puncunaffhug2: say "'[one of]That's quite enough of those for now[or]Yes, all right, thank you, I'm fine[or]Gushing sweet of you but really, I'm in the middle of this[in random order],' Progue says, drawing back firmly.". To say puncpathug2: say "He hugs you again briefly, patting your back. '[one of]I'm glad you're around[or]Good to have company here again[or]Nice to have someone I can feel responsible for again[in random order],' he says warmly.". To say puncromhug2: say "You embrace Progue again, squeezing him tightly. '[one of]Can't get enough of that[or]My now, you're a warm one[or]Didn't think this island could get any more pleasant[in random order],' he says with a smile, rubbing your back.". To say puncnormhug2: say "He returns your embrace, smiling. '[one of]Good to see you, too[or]Nice to see a friendly face[or]Glad to see you're still around[in random order],' he says.".

Instead of kissing Progue when the psyche of Progue is uncertainty:
	now Progue is attentive;
	if romance of Progue < -1 begin;
		force discuss the disgusted_beat of Progue;
		Progue's life goes on;
		follow the Progue's motivation rule;
	otherwise if romance of Progue > 4;
		force discuss p_unc_kissing;
	otherwise if romance of Progue >= 2;
		force discuss p_supp_flirting;
	otherwise if affinity of Progue < -1;
		force discuss p_supp_nokissing;
	otherwise;
		force discuss p_d_nokissyet;
	end if.

p_unc_kissing is a romantic impressive beat in SuppC with reaction "You kiss Progue passionately. When at last you break away he smiles dazzlingly. 'Don't tell the ocean,' he winks, 'but this gushing beats Word Day by blue miles.'". p_unc_kissing2 replaces p_unc_kissing.

p_unc_kissing2 is a repeatable beat in SuppC with reaction "[one of]You kiss him again[or]The two of you kiss again[or]Once again you lock lips[in random order], [one of][time-of-day-bit][or]the [surface-material] warm beneath your feet[or]Progue's [Progue-animus] momentarily forgotten[in random order]. [punc22]". To say punc22: say "'[one of]Mmm,' he says, '[if we chose love]you really are a lover first and an artist second[else]you're an artist in everything you do[end if], aren't you?[or]That's gushing lovely,' he says, '[punc2kissname].[or]Something Further, [animal-nickname], if you paint as good as you kiss it tickles my brainwaves to think what delightful worlds you've seen.[in random order]'". To say punc2kissname: if player-name-guess is not "no.guess" begin; say "you can even call me [player-name-guess] again as long as you keep that up"; otherwise if cc_father is spoken; say "and it's a good thing the children have long since flown the nest"; otherwise if cc_sculptor is spoken; say "mayhaps you're a muse sent to start me sculpting again"; otherwise; say "being two-thirds mad's not half bad with someone like you around"; end if.
	

Section - Keywords

Understand "tree/tree9/windsigh" as uc_windsigh. uc_windsigh is a repeatable beat in UncertainC with fuse 9999 and keyword name "[if tree1 is named]windsigh[else]tree" and reaction "He clutches his forehead, wincing. 'Sorries,' he says, 'these headaches come and go. 'No, I can't tell a thing about those rotting windsigh trees. Wish you'd just leave them well enough alone and sleep on the beach like everyone else.'". tree7 references uc_windsigh. After discussing uc_windsigh: now tree1 is named; continue the action. Check examining by name distant-tree3: if uc_windsigh is available, try discussing uc_windsigh instead.

Understand "coconut/konokuk/fruits/fruit" as uc_konokuk. uc_konokuk is a repeatable beat in UncertainC with fuse 9999 and keyword name "[if konokuk trees are named]konokuk[else]coconut" and reaction "'Make a great meal, those konokuk fruits,' he says. 'Seen them on all the tropical worlds I've ever lived in. Delicious.'". After discussing uc_konokuk: now konokuk trees are named; continue the action. some konokuk trees references uc_konokuk.

Understand "galaxy/capalla" as uc_capalla. uc_capalla is a repeatable beat in UncertainC with fuse 9999 and keyword name "[if galaxy is named]Capalla[else]galaxy" and reaction "'I named the galaxy Capalla,' he says, 'though now I can't remember why.'". After discussing uc_capalla: now galaxy is named; continue the action. old tree stumps references uc_capalla [Just something the player will be frequently walking by.].

Understand "treehouse" as uc_treehouse. uc_treehouse is a beat in UncertainC with fuse 9999 and keyword name "treehouse" and reaction "'Their mother's face,' Progue says, 'I remember now. I built it for them, but it was really for her... or me. I... don't know any more.'". tree2 references uc_treehouse.


Chapter - Uncertainty General Convo

Uncertainty General Convo is a serendipitous rerunnable frequent triggered episode. The subchange beat is silence. The boredom beat is silence. The bye beat is silence. The abruptbye beat is silence. The icebreaker is uc_makeconversation.

Last condition rule for Uncertainty General Convo: rule succeeds.

First finishing rule for Uncertainty General Convo:
	if Progue is idle, rule succeeds.

A commencement rule for Uncertainty General Convo:
	now Progue is attentive. [If this is selected from a HELLO, the episode gets shut down before it has a chance to begin without this line.]

uc_makeconversation is a repeatable beat in UncertainC. Check discussing uc_makeconversation:
	let beatlist be {uc_chat1, uc_chat2, uc_chat3, uc_chat4};
	remove the list of spoken beats from beatlist;
	sort beatlist in random order;
	if the number of entries in beatlist is at least 1 begin;
		force discuss entry 1 of beatlist instead;
	else;
		force discuss uc_intro instead;
	end if.	

uc_intro is a repeatable beat in UncertainC with reaction "'[one of]Greetings[or]Good [progue-time-of-day][at random],' he says[one of][archetype-unc-greeting][or][generic-unc-greeting][at random]?'". To say archetype-unc-greeting: say "[if neurotic dad], running a nervous hand through his hair but smiling at you fondly, 'how's my [boygirl][else if father knows best] confidently, 'how's my [boygirl][else if bitter dad] weakly, eyeing you with an appraising frown, 'what is it you want now[else if disciplinarian] loudly, frowning at you, 'getting into more trouble, are you[else if toady], dropping what he's doing to focus on you eagerly, 'everything going smooth-smooth[else if lover or twitterpated] with a wink, kissing your hand deftly, 'how's my favorite [boygirl][else if enemy], not meeting your eye, 'found something new to bother me with[else if slave] with a whimper, edging away from you subtly, 'wh- what do you want from me now[else if bitter lover or shattered lover] with a sarcastic twist, looking away from you, 'but didn't I tell you to leave me alone[else] with a grin, nodding in your direction, 'hope all's going splend and charm for you". To say boygirl: say "[if player is male]boy[else]girl". To say generic-unc-greeting: say "', [one of][animus-business][or][attitude-business][at random], '[one of]things going well[or]all smooth with you[or]enjoying yourself, I hope[at random]".

uc_chat1 is a beat in UncertainC with reaction "'I saw a [uc_ghost] yesterday,' he says lightly. 'A real one this time, I mean. See, I told that visions would be coming.'". uc_intro replace uc_chat1.

Understand "ghost" as uc_ghost when last beat is in UncertainC. uc_ghost is a beat in UncertainC with keyword name "ghost" and reaction "'Oh yes,' he says. 'Not a very good one,' he says, waving a hand dismissively. 'Just the usual thing. Face of my mother, your doom is at hand, something thatwise.' He shrugs. 'Mayhaps that tsunami shook them up a bit. Anyway what I can I do for you?'".

uc_chat2 is a beat in UncertainC with reaction "'You're looking a bit on the wan side,' he says. 'Been getting enough sleep? Not still sleeping under those mangled [uc_windsigh], are you? Thought I warned you thatwise.'". uc_intro replaces uc_chat2.

uc_chat3 is a beat in UncertainC with reaction "'I dreamt last night,' Progue says abruptly, not looking at you. 'I don't, usually. Not where I sleep. But I did dream. Of... of [uc_3her].'". uc_intro replaces uc_chat3.

Understand "her" as uc_3her when last beat is in UncertainC. uc_3her is a beat in UncertainC with keyword name "her" and reaction "[if affinity of Progue >= 2]'My... my wife,' he says slowly, 'the mother of my girls. She... died, before we came here. I'd almost forgotten her. No,' he adds firmly, 'no, that's not true. I'd just locked her so deep I never...' He takes a deep breath. 'But I saw her face again, in this [uc_3dream], like I haven't seen it in green eons.'[else]Abruptly, he stiffens. 'None of your business really,' he says. 'What is it you wanted?'[end if]".

Understand "dream" as uc_3dream when last beat is in UncertainC. uc_3dream is a beat in UncertainC with keyword name "dream" and reaction "'She came to me,' he says vaguely, 'dressed in white, trails of fabric rippling behind her for miles, miles. She asked me where our daughters were.' He shivers suddenly. 'And I had to tell her, tell her I didn't know.'[paragraph break]'She came closer, almost and almost touching me, and said that was all right, don't cry, everything was fine. She could find them. She could find them anywhere in the world, as long, as long as I could tell her what world they're in.'[paragraph break]He puts his face in a hand, and takes a deep, shuddering breath. 'She didn't understand,' he mutters, 'why I couldn't tell her. She was confused. She was angry. Then, at long last, only sad. Only, only sad.'[paragraph break]He takes another breath, then tries to smile the tears away. 'I'm sorry,' he says, 'just a dream. What did you want to talk about?'".

uc_chat4 is a beat in UncertainC with reaction "'Strange [progue-time-of-day],' he says vaguely, [animus-business]. 'Strange [sc_shades] in the mind, on the horizon. Don't know what to make. Don't know.'". uc_intro replace uc_chat4.



Chapter - Meteor Shower Conversation

[This is a test of the "affinitive" path. Progue ambushes a player in afternoon or later and asks them to come back to the beach after dark-- "as a favor, as a friend, do it for me." If it gets to be dark and the player hasn't done it, do we remind them? If the player makes the appointment, + affinity; if they miss it, -affinity; schedule brief "too bad" scene. ]

Meteor Shower Invite is a guaranteed urgent triggered episode with summary "lying on the beach and watching the star rain". The bye beat is msi_no. The abruptbye beat is msi_no. The boredom beat is msi_noanswer. The icebreaker is msi_intro.

A condition for Meteor Shower Invite:
	if affinity of Progue < 0, rule fails;
	if exploring Progue's turf and ( afternoon or evening or sunset ) , rule succeeds.



MSI is a thread. msi_intro is a beat in MSI with reaction "'Glad I caught you,' he says, clapping a hand on your back with a smile, 'there's something special tonight you ought to see. Meet me [if location is regionally in Beachfront]here [end if]on the beach after dark. As a favor, eh? Trust me, you won't want to miss it. Can you come?'". The yes-beat of msi_intro is msi_yes. The no-beat of msi_intro is msi_no. msi_intro summons msi_yes, msi_no. msi_intro suggests msi_noanswer.

msi_yes is a terminal beat in MSI with keyword name "yes" and reaction "'Forward looking,' he says happily. 'Trust me, you won't want to miss it. See you tonight, then. After dark, mind.'".

msi_no is a terminal unaffinitive beat in MSI with keyword name "no" and reaction "He looks crestfallen. 'Oh,' he says, 'well, never mind then. Just thought it would be something you'd enjoy. Later maybe.'".

msi_noanswer is a terminal beat in MSI with reaction "'Well, if you can come, I'll see you then,' he says. 'Trust me, it's worth seeing. Hope to see you then.'".

A completion rule for Meteor Shower Invite:
	if noun is not msi_no, schedule Progue for Meteor Shower Conversation at night;
	Progue's life goes on;
	follow the Progue's motivation rule.

Every turn when Meteor Shower Invite is completed and ( sunrise or morning ) and Progue is booked for Meteor Shower Conversation:
	unbook Progue for Meteor Shower Conversation. [ If we miss this, it can't happen at any time other than night, so expire it. ]


Meteor Shower Conversation is a guaranteed triggered rendezvous episode. The icebreaker is msc_intro. The boredom beat is msc_refuse2. The meeting place is Center Beach. 

Table of Progue's Initial Appearance (continued)
animus	episode			desc
--		Meteor Shower Conversation		"Progue stands on the beach near the tide line, looking up intently into the sky."

MSC is a thread. msc_intro is an affinitive beat in MSC with reaction "'You came!' he says happily. 'Thank you. Now look. [t]Lie down[x] here on the [surface-material] and just look up at the sky for a minute. It takes a mome before you can see it.' He demonstrates, staking out a patch of dry sand and flopping back on it, staring up at the night sky intently.". msc_intro suggests msc_refuse. msc_intro summons msc_liedown, msc_refuse.

Understand "refuse" as msc_refuse when last beat is in MSC. msc_refuse is a beat in MSC with keyword name "refuse" and reaction "'Come on,' he says, '[t]lie down[x]; you'll crane your neck if you try to see it standing up.'".

msc_refuse2 is a terminal unaffinitive beat in MSC with reaction "'No fun at all,' Progue murmurs, eyes closing. 'Missing out...' He appears to drift off to sleep.".

First instead of sleeping when last beat is msc_intro or last beat is msc_refuse: force discuss msc_liedown.

msc_liedown is a beat in MSC with keyword name "lie down" and reaction "[if romance of Progue >= 2]You lie side by sand on the dry [surface-material][else]You take up a nearby position on the dry [surface-material][end if][if location is regionally in Beachfront or location is Rise], waves rolling smoothly in down the beach beyond your feet[end if].[paragraph break]'Now,' he says, 'just look up in the sky, at the galaxy there. Sort of let your eyes relax a little. And just wait.'[paragraph break]You do as he says, and for a few long moments see nothing-- then slowly become aware of it. Hundreds of tiny [msc_streaks] of light surge through the sky each second, so faint you can only really see them from the corner of your eye. As your eyes adjust more to the night you can see them more and more clearly; like filaments of silver delicately shimmering through the sky, before the great heavy galaxy.[paragraph break]'Star-rain,' Progue says reverently. 'Never seen it this strong on any world, any world but [msc_home].'". msc_liedown suggests msc_perspectives. msc_liedown cancels msc_refuse, msc_refuse2. msc_liedown summons msc_perspectives.

Understand "streaks" as msc_streaks when last beat is in MSC. msc_streaks is a beat in MSC with keyword name "streaks" and reaction "You keep your eyes locked on the shimmering heavens, fascinated.[paragraph break]'Happens twice a year about this time,' he says. 'Clouds of microscopic space dust, I expect, not big enough to flame into proper meteors, but large enough to show. Beautiful.'". msc_streaks suggests msc_perspectives.

Understand "home" as msc_home when last beat is in MSC. msc_home is a beat in MSC with keyword name "home" and reaction "'Where I was born,' Progue says, his quiet words barely audible over the breaking of the surf, 'there was star-rain every night. Our tama told us the legend of the old feud between the fickle clouds, so undisciplined they always were joining up and falling apart and rained only when they pleased, and the eternal stars, who rained every night with honor, but had been banished so far away that every drop of their rain dried up before it could reach us...'". msc_home suggests msc_perspectives.

msc_perspectives is an insistent beat in MSC with keyword name "listen" and reaction "'Want to show you something elsewards,' he says. 'Are you looking up at the galaxy, at Capalla? See it stretch and span cross the sky above us? Now. Imagine it's not above us at all. Imagine it's below. Yes, feel it? The weight of sand on your back is the strength of glue holding us to some soft ceiling; below is incomprehensible vast void stretching down and down to that galaxy on a blackened floor.'[paragraph break]He pauses for a moment, giving the words a chance to sink in.[paragraph break]'Feel it?' he says, 'Can you rhyme that with your vision?'". The yes-beat of msc_perspectives is msc_persp1yes. The no-beat of msc_perspectives is msc_persp1no. The maybe-beat of msc_perspectives is msc_persp1maybe. msc_perspectives summons msc_persp1yes, msp_persp1no, msp_persp1maybe. msc_perspectives suggests msc_persp1maybe.

msc_persp1yes is a beat in MSC with keyword name "yes" and reaction "'Good,' he says. '[msc_perspectives2]". msc_persp1yes enqueues msc_persp1.

msc_persp1no is a beat in MSC with keyword name "no" and reaction "'Well,' he says, 'try to imagine what it would feel like then. [msc_perspectives2]". msc_persp1no enqueues msc_persp1.

msc_persp1maybe is a beat in MSC with keyword name "maybe" and reaction "'You can', he says, 'you just aren't quite willing to let go what your senses tell. Good and close enough. [msc_perspectives2]". msc_persp1maybe enqueues msc_persp1.

To say msc_perspectives2: say "Now. Pause. Hold it. Then forget. Forget that feeling. Dig yourself trickling deeper in the sand.' He demonstrates. 'Now believe that we're stuck to a great wall. It's at our backs, we're gripping it tight[if location is regionally in Beachfront or location is Rise], and beneath feet is vertical ocean, a wall of water stretching down forever beneath us[end if]. We're looking straight headwards, right forward toward the galaxy floating out in infinite blackness before us. Somehow it's balanced on its side at strange angles; don't ask the hows and whys, just believe it.'[paragraph break]Again, he pauses.[paragraph break]'You're not falling asleep on me, are you?' he asks.". 

msc_persp1 is an insistent beat in MSC. The yes-beat of msc_persp1 is msc_persp2yes. The no-beat of msc_persp1 is msc_persp2no. msc_persp1 suggests msc_persp2yes.

msc_persp2yes is a beat in MSC with keyword name "yes" and reaction "'Dear oh,' he says, 'I'll try to hurry and finish then.'". msc_persp2yes enqueues msc_perspectives3.

msc_persp2no is a beat in MSC with keyword name "no" and reaction "'Good,' he says. 'Hold that sensation just one more ment, then let that one go too.'". msc_persp2no enqueues msc_perspectives3.

msc_perspectives3 is a beat in MSC with reaction "'And now this is the point,' he says. 'Each of those felt something different: up, down, sideways. Gives you vertigo to think of hanging above that galaxy; changed perspectives to think of being alongside it. But each is just as wrong or right, correct or incorrect, true or untrue as thinking that great thing's hovering above us. If every [t]perspective[x] is equal right or wrong, correct or incorrect, true or untrue then those words are gushing useless to describe the universe. Can't even say it is or isn't, or that we live in it or don't; equally arbitrary. Verbs fail entirely and leave us with just [']the universe,['] and what does that mean? Nothing, [animal-nickname]; and even [t]meaning[x] itself falls apart. All we have are shadows and perspectives.'[paragraph break]'And mayhaps our [t]wayfaring[x] is like that,' he finishes quietly, 'just a matter of seeing shape in the right shadow, obtaining a sufficiently different perspective-- one neither less true nor more wrong. Just and only yours.'". msc_perspectives3 summons msc_outtro. msc_perspectives3 suggests msc_outtro.

Understand "perspective/wayfaring/meaning" as msc_outtro when last beat is in MSC. msc_outtro is a terminal beat in MSC with keyword name "perspective, wayfaring and meaning" and reaction "You think of how to frame your response for a long while, but just as you are about to speak, you hear a gentle snore.[paragraph break]Quietly, you rise to your feet[if location is regionally in Beachfront or location is Rise], brushing the sand from your clothes[end if].".

First completion rule for Meteor Shower Conversation:
	now progue-venue is location;
	now dont_describe_Progue is true;
	now the animus of Progue is resting;
	Progue starts resting.


Chapter - Constant Ringing

[An unaffinitive episode. Progue serendipitously runs into the player in a grouchy mood, rubbing his head, and confronts you about that ringing noise-- that's only started since you've arrived, and gotten worse. Then things get nastier: if the player hasn't made much progresson the "leaving" front Progue berates him. Can end in physical violence or an apology. ]

Constant Ringing is a serendipitous guaranteed triggered episode. The subchange beat is cr_avoid. The boredom beat is cr_avoid. The bye beat is cr_avoid. The abruptbye beat is cr_avoid. The icebreaker is cr_intro.

The allow Constant Ringing rule is listed before the Progue is chattier the more he likes you rule in the condition rules. A condition for Constant Ringing (this is the allow Constant Ringing rule):
	if affinity of Progue < 0, rule succeeds.

CR is a thread. cr_intro is a beat in cr with reaction "'Could tell you were getting closer,' he says with a frown, rubbing his temples with a free hand. 'Wish you'd stop that [cr_noise]. Not very nice. Gushing cruel, actually. Don't know why you keep doing it.'".

Understand "noise" as cr_noise when last beat is in CR. cr_noise is a beat in cr with keyword name "noise" and reaction "'That grating whine, scratchy upper pitches rubbing and clawing gainst one another,' he says in a grouchy tone, shooting you an accusing glare, 'seven or eight warbling tones all blurring through discordant frequencies. Like a drill boring straight through my braincase. Stronger when you're around. [cr_listen], can't you hear it? Since you've arrived. What, pleading [cr_ignorance] I suppose?' he adds accusingly.". cr_noise suggests cr_ignorance.

First Instead of listening when last beat is in CR: force discuss cr_listen. cr_listen is an ephemeral beat in cr with keyword name "listen" and reaction "You stop and listen, but all you can hear is the sound of the surf.".

Understand "ignorance" as cr_ignorance when last beat is in CR. cr_ignorance is a beat in cr with keyword name "ignorance" and reaction "He grimaces[if noun is cr_ignorance] as you respond, as if your words are making the noise louder[else], as if your mere presence is making the noise louder[end if].[paragraph break]'Look and look,' he says, 'I've already told you you came here by mistake. I've already said I'd help gather what you need to leave. You're stirring things up, toppling them down, spoiling the soupworks with too many wrenches. To fly true to the nest, [animal-nickname], [if submission of Progue > 0]I wish you'd leave, and you're making me miserable[else]I don't like you here, and you're making me angry[end if].'". cr_ignorance summons cr_good, cr_sorry.

Understand "good" as cr_good when last beat is in cr. cr_good is an unaffinitive terminal beat in cr with keyword name "good" and reaction "Progue makes a fist, then slowly releases it. Without a word, he turns away.".

Understand "sorry" as cr_sorry when last beat is in cr. cr_sorry is an affinitive terminal beat in cr with keyword name "sorry" and reaction "He rubs his forehead even more vigorously. 'Not your fault,' he mutters. 'Not your fault. After the storm, it's like something mindwards has been knocked loose, broken into fragments, sharp and hot.' He shakes his head, not looking at you.".

cr_avoid is an ephemeral beat in cr with reaction "'Don't do that when I'm talking,' he snaps at you.".

A completion rule for Constant Ringing:
	follow the Progue's motivation rule.



Chapter - Old Memories

[ The player encounters Progue standing in the open letting the rain beat down on him. He does not respond at first, then spills out a diatribe about not being able to wayfare and being stranded here forever, even after his daughters left him. ]


[Old Memories is a guaranteed serendipitous episode. The icebreaker is citr_intro.

A condition for Old Memories:
	if the affinity of Progue < 0, rule fails;
	if evening or sunset or twilight, rule succeeds;
	rule fails.

Table of Progue's Initial Appearance (continued)
animus	episode			desc
--		Old Memories		"Progue stands barefoot in the surf, breakers tumbling past his ankles and ringing them with clinging puffs of foam. The sky cools through shades of burnt purple, what little light left in its scattered rays seeming to bend around or through him. His gaze fixes unblinkingly on the westward horizon, as if invisible chains still anchor his eyes to the sun."

Table of Progue's Description (continued)
animus	episode			desc
--		Old Memories		"[initial appearance of Progue]"


OM is a thread. om_intro is a beat in OM with reaction "The sound of your tentative greeting is swallowed entirely by rushing breakers, but it seems Progue senses it somehow, for a soundless sigh escapes his lips, detectable only through the compression of his already withered frame, and the dancing tendrils of his stringy white hair." om_intro suggests om_intro2.

om_intro2 is a beat in OM with reaction "I [t]left[x] them,' he says, the words well-formed but hardly given enough voice to be audible above the surf, as ephemeral as shifting patterns the mind's eye might see in the ever-changing foam. 'I [t]never[x] wanted to be a [t]father[x], never asked... and no one told me how...' He trails off, momentarily lost in thought.". lo_intro summons lo_never. 

Understand "never" as lo_never. lo_never is a beat in LO with reaction "Another breath, deeper, more ragged. 'No. And they knew it. [t]Rengin[x] was always the one they turned to, the one who put them to bed, who held them when they cried. When she was gone, they turned to me, reluctantly, hesitantly. And I turned away. I turned to [t]voices[x] in my head, new ideas, construction, art, familiar tools in my [t]hands[x]...' He holds up his hands, finally blinking and breaking his gaze on the horizon, and looks at them, held claw-like and blue-black in the dying light, and he for a moment seems lost, as if unsure whose they are or where they should be put.". lo_never summons lo_hands, lo_rengin. 

Understand "rengin/wife/mother" as lo_rengin. lo_rengin is a beat in LO with reaction "'Oh, my Rengin, my sweet,' Progue moans, clutching himself and rocking back and forth, 'Forgive me. I can never visit your grave. Your soul and body both have gone where I cannot find them. Oh, my Rengin...'[paragraph break]Progue staggers forward into the surf, sinking to his knees in the sucking tide.". lo_rengin enqueues lo_explosion.

Understand "hand/hands" as lo_hands. lo_hands is a beat in LO with reaction "He looks at you wild-eyed, his red-rimmed eyes half-crazed. 'How, then?' he says, gripping your shirt feverently, 'how do we stand it, this wayfaring? Where every step forward erases your entire past?'[paragraph break]He staggers forward into the surf, sinking to his knees in the sucking tide.". lo_hands enqueues lo_explosion.

Instead of hugging Progue when last beat is lo_intro or last beat is lo_never, force discuss lo_tryhug.

lo_tryhug is a beat in LO with reaction "You stretch a hand out and put it on the old man's shoulder, but he savagely twists away and staggers forward into the surf, sinking to his knees in the sucking tide.". lo_tryhug enqueues lo_explosion.

lo_explosion is a beat in LO with reaction "'They left,' he shouts, suddenly furious, smashing his hands into the surf, sending splashes of foam in tiny explosions swallowed instantly by the breathing tide, 'when I [t]needed[x] them, left me, left. I would have [t]recovered[x], would have loved them, held them, been there for them, but they weren't there for me, for them... we...' he trails off, on hands and knees in the surf, staring down into white foam whirling past his head.".

Instead of hugging Progue when last beat is lo_explosion: say "You wade out and kneel down next to him. Gently, you lift him up to a kneeling position, and he looks at you for the first time."; force discuss lo_outtro.

lo_outtro is a terminal beat in LO with reaction "The purple above still deepens towards black, softening and swallowing his features more in each moment.[paragraph break]'We left each other,' he says, looking into your eyes. 'We left, and now we are alone.'". After discussing lo_outtro: begin the next chapter; now the time of day is two hours after the time of day; say "Progue lies in his bed again, muttering; you returned him there, dried his clothes, after his collapse. You hope he will stay put for the night, but he seems restless, tossing and turning and resisting your efforts to soothe him even in sleep. There may be few long nights left for him."; try looking.

[Instead of ignoring Progue during Loss: say "You look away, indifferent. Progue's back stiffens. He takes a few paces forward into the swirling foam, then turns suddenly and fixes you with a look of hatred."; force discuss lo_lashout.]

lo_lashout is a beat in LO with reaction "'Why are you here?' he shouts, a white rush of rage mingling with the surge of foam. 'Memories, the memories you've brought back, that I thought I'd forgotten forever... hoped, dreamed... you brought it back, my girls, my wife, decisions, waste...' He breaks off into a sob[if the posture of Progue is not sitting], sinking to his knees in the foam[end if].". After discussing lo_lashout: now the posture of Progue is sitting.

Instead of attacking Progue during Loss, force discuss lo_attackouttro.

lo_attackouttro is a terminal unaffinitive beat in LO with reaction "Furious, you wade out into the surf and hit Progue. He cries out and falls back, momentarily submerged, then sputtering, crawls back, away from your blows.[paragraph break]'Monster,' he shouts, 'get away, leave, go, go, like all the rest, and let me die alone!'[paragraph break]Scrambling, slipping, he gets to his feet and sprints off up the beach towards the rise." After discussing lo_attackouttro: Progue likes you less; Progue likes you less; continue the action.

]




Chapter - Sleepover

[Sleepover is a guaranteed urgent episode. The icebreaker is stn_intro.

A condition for Sleepover:
	if romance of Progue is at least 5 and
	( evening or sunset or night ) and
	exploring Progue's turf, rule succeeds.

STN is a thread. stn_intro is a beat in STN with reaction "{Progue invites you to Sleepover with him. This is interesting because you have to choose between [t]him[x] and more [t]dreams[x]. Which do you pick?}". stn_intro summons stn_him, stn_dreams.

Understand "him" as stn_him when last beat is in STN. stn_him is a terminal beat in STN with keyword name "him" and reaction "{Love scene.}". After discussing stn_him: now the time of day is 7:39 AM; move Progue to Ledge; now the animus of Progue is resting; now the activity counter of Progue is 5; move player to Ledge; continue the action.

Understand "dreams" as stn_dreams when last beat is in STN. stn_dreams is a terminal beat in STN with keyword name "dreams" and reaction "{Progue tells you you're being stupid for chasing those dangerous dreams at the expense of love. [if we chose art]You wonder to yourself if you're making the right decision[otherwise]You tell him that's always been how you roll[end if].}".

]



Chapter - Attitude Adjusters

Section - Heading Up

[An affinitive ]

Heading Up is a guaranteed serendipitous triggered episode. The icebreaker is hu_intro. The subchange beat is silence. The bye beat is hu_no. The abruptbye beat is hu_no. The boredom beat is hu_no.

Last condition for Heading Up:
	if the animus of Progue is resting, rule fails;
	if location is not ledge, rule fails;
	if Lawn is visited, rule succeeds.

HU is a thread. hu_intro is a beat in HU with reaction "Progue looks up at you, [if affinity of Progue < 0]distastefully[else]distracted[end if]. 'Going [if former location is North Marsh]up[else]down[end if]?' he asks. 'As long as you're on your way, would you mind [if former location is North Marsh]taking these [hu_flowers] up to the lawn for me[else]taking these empty konokuk [hu_shells] down to the marsh for me[end if]? Just drop them when you get there. [if former location is North Marsh]Sort of a memorial kind of thing[else]They'll wash right out at low tide[end if].' He holds them out with a hopeful grin.". The yes-beat of hu_intro is hu_yes. The no-beat of hu_intro is hu_no. hu_intro summons hu_yes, hu_no.

Understand "flowers" as hu_flowers when last beat is in HU. hu_flowers is a dogged beat in HU with keyword name "flowers" and reaction "'Just some wildflowers,' he says, gazing sadly down at the bouquet. 'Sort of a remembrance. The view up there's something extraordinary, eh? She would have liked it. Since you're going anyway-- could you?'".

Understand "shells" as hu_shells when last beat is in HU. hu_shells is a dogged beat in HU with keyword name "shells" and reaction "'Just a bit of garbage,' he says. 'I would just throw them off the edge but I wouldn't want to hit any of those precious little frogs. Since you're going anyway, could you?'".

hu_yes is an affinitive terminal beat in HU with keyword name "yes" and reaction "'Buckets of thanks,' he says with a smile, handing them to you, 'you're a friend.'". After discussing hu_yes: if former location is North Marsh, move bouquet to player; else move empty-shells to player; continue the action.

A bouquet is set dressing with printed name "bouquet of flowers". Understand "boquet/flower/flowers" or "boquet of flowers" or "bouquet of flowers" as bouquet. The description is "Just a handful of wildflowers." After going to Lawn when bouquet is held: say "Kneeling, you place the bouquet on the lawn."; move bouquet to Lawn; continue the action.

Some empty-shells are set dressing with printed name "empty konokuk shells". Understand "shell/shells/konokuk/empty" as empty-shells. The description is "Just a bunch of empty konokuk shells." After going to North Marsh when empty-shells are held: say "You chuck the empty konokuk shells into the marsh."; remove empty-shells from play; continue the action.

hu_no is an unaffinitive terminal beat in HU with keyword name "no" and reaction "[if affinity of Progue < 0]'No, I suppose you wouldn't,' he says, rolling his eyes. 'That case get off my ledge.'[else]He blinks in surprise. 'Well and all right then,' he says, lowering them, 'never and never mind.'[end if]".




Section - A Good Cry

[An unsubmissive scene.]

A Good Cry is a frequent serendipitous triggered episode. The icebreaker is agc_intro. The bye beat is agc_leave. The abruptbye beat is agc_leave. The subchange beat is agc_memory. The boredom beat is agc_memory.

Last condition for A Good Cry:
	if the animus of Progue is ruminating, rule succeeds.

A completion rule for A Good Cry:
	now dont-bug-progue is true;
	now the activity counter of Progue is 0;
	Progue is rebuggable in one hour from now.

At the time when Progue is rebuggable:
	now dont-bug-progue is false.

dont-bug-progue is a truth state that varies.

Instead of greeting or discussing when dont-bug-progue is true and Progue is enclosed by location: say "You shouldn't disturb him now.".

AGC is a thread. agc_intro is a beat in AGC with reaction "As you draw nearer to Progue, you see that he is crying, silent tears collecting and running down his face.[paragraph break]'If you wouldn't mind, [animal-nickname],' he says, light but quiet, 'I'd like to be left alone for a span. This refinding your [agc_memory]'s not all spring and cheese.'". agc_intro summons agc_sorry, agc_bye.

Understand "sorry" as agc_sorry when last beat is in agc. agc_sorry is an unsubmissive terminal beat in agc with keyword name "sorry" and reaction "'No need for sorries,' he says with a touch of annoyance, 'you were just passing. Until, [if romance of Progue > 3]love[else if affinity of Progue > 0]friend[else]wayfarer[end if], until.'".

agc_bye is a beat with keyword name "bye". [We don't actually recognize this since "saying goodbye" captures it and routes it through the bye beat of the episode.]

agc_leave is a terminal beat in agc with reaction "You leave Progue to sort out his emotions.".

Understand "memory" as agc_memory when last beat is in agc. agc_memory is a dogged beat in agc with keyword name "memory" and reaction "'Past days swirl and jumble,' he mutters, 'pieces and bits of me breach in the storm, reactions pried loose from actions, [agc_intentions] riven from consequences. Please, please, let me alone now.'". agc_intentions replaces agc_memory.

Understand "intention/intentions" as agc_intentions when last beat is in agc. agc_intentions is a submissive terminal beat in agc with keyword name "intentions" and reaction "'Go away!' Progue shouts, jumping up and whirling on you angrily. 'I want and need and and will and have to be with only myself. I thought I asked already.' He sinks back down, rubbing his head. 'Mayhaps I didn't, mayhaps. Sorries, sorries. Please. Go now.' He closes his eyes.".




Chapter - Reward Scenes

Section - Used To Bring Me

[A paternal episode.]
[Dialogue only. "Have you found them? DId you like them? Ah, just like Lethe." Then bringing them back in the basket is just a bonus.]

Used To Bring Me is a serendipitous triggered common episode. The icebreaker is utbm_intro. The subchange beat is silence. The boredom beat is silence. The bye beat is silence. The abruptbye beat is silence.

Last condition for Used To Bring Me:
	if paternalism of Progue > 0, rule succeeds.

UTBM is a thread. utbm_intro is a beat in utbm with reaction "Progue looks up with a start, then relaxes[if affinity of Progue > 0], smiling[end if]. 'Startled,' he says. 'Still not used to seeing other people on my beach. [if affinity of Progue < 0]But I suppose as long as you aren't meddling with anything it's alright. [end if]How do things go with you? Still exploring? Got lost in the rain [utbm_forest] yet?'".

Understand "forest/yes" as utbm_forest when last beat is in utbm. utbm_forest is a beat in utbm with keyword name "forest" and reaction "'Gushing easy to do it in there,' he nods, a bit wistfully, 'great wet arboreal labyrinth. Years and fears since I saw it. There used to be great orange and red [utbm_fruits], insides brown and slimy as mud, but the seeds were sugar and sunlight mixed together... delicious delicious.' He smiles. 'One of the girls and I used to like them in particular. Lethe, I think it was. She used to bring them to me when I-- when I was sick. I'd forgotten that.'". utbm_forest suggests utbm_foundthem.

Understand "fruit/fruits" as utbm_fruits when last beat is in utbm. utbm_fruits is a beat in utbm with keyword name "fruits" and reaction "'Fantastic taste,' he says. 'Would love to taste them again but I don't think I'll ever go back over there. Too many lingering shadows and whispers.'". utbm_fruits enqueues utbm_foundthem.

utbm_foundthem is an insistent beat in utbm with reaction "'You've been traipsing about over therewards,' he says. 'Do they still grow over there? Have you seen them?'". The yes-beat of utbm_foundthem is utbm_fyes. The no-beat of utbm_foundthem is utbm_fno. utbm_foundthem summons utbm_fyes, utbm_fno. utbm_foundthem suggests utbm_no.

utbm_fyes is an insistent beat in utbm with keyword name "yes" and reaction "'Have you?' His eyes light up. 'Ah, that's good, that's good. And did you try them? Did you like them too?'". The yes-beat of utbm_fyes is utbm_fyes2. The no-beat of utbm_fyes is utbm_no. utbm_fyes summons utbm_fyes2, utbm_no. utbm_fyes suggests utbm_no.

utbm_fyes2 is a beat in utbm with keyword name "yes" and reaction "'Thought you would, [animal-nickname],' Progue says, beaming. 'Gushing well thought you would.'". utbm_fyes2 enqueues utbm_check.

utbm_fno is a beat in utbm with keyword name "no" and reaction "'Ah well-oh,' he says, 'not important I suppose. Just trickling curious.'". utbm_fno enqueues utbm_check.

utbm_check is an insistent beat in utbm with reaction "'I can't help think and thinking that something in you reminds me of Lethe,' he says, regarding you fondly.". The yes-beat of utbm_check is utbm_morepat. The no-beat of utbm_check is utbm_lesspat. utbm_check suggests utbm_neutral. utbm_check summons utbm_morepat, utbm_lesspat.

utbm_morepat is a paternal beat in utbm with keyword name "agree" and reaction "'Good,' he says, nodding, 'glad. Grand we agree. You'd lump into each other if ever you met, I'm sure as sure is sure.' He sighs. 'But now then, what did you want to talk about?'".

utbm_neutral is a beat in utbm with reaction "'At any courses, what were we talking about?' he says.". utbm_neutral cancels utbm_morepat, utbm_lesspan.

utbm_lesspat is an unpaternal beat in utbm with keyword name "disagree" and reaction "'Really now,' he says, musing. 'Hmm. Well and I suppose mayhaps I'm just missing them. Only natural I suppose. Sorries if it made you uncomft. Well and but what were we talking about?'".

[After discussing utbm_forest: the fruit-chance expires in 23 hours from now; continue the action. At the time when the fruit-chance expires: if utbm_gotem is unspoken begin; Progue feels less like a father; if drama manager is being debugged, say "// Drama: Progue feels less like a father (because fruit-chance expired)."; end if.][suspicious of times approaching 24 hours; unfair if player never triggers departure quest.]



[If the player is doing the departure quests, they have a basket with which they can carry fruits.]

utbm_gotem is a paternal beat in utbm with reaction "Progue spies your basket fill of the bulbous red-orange fruits and [if affinity of Progue > 0]lets out a little gasp of surprise. 'Oh, [animal-nickname], you brought me some! Just like my Lethe!' He picks up one of the ripe fruits and runs his fingers over its yielding surface in glee. 'L[else]frowns. 'You shouldn't be over there,' he says, 'it's dangerous. All those windsigh, and chasms and creatures...' But he picks one of the fruits up, running his fingers over its yielding surface with a twitch of a smile. 'Well, it's done. I suppose l[end if]et's open it up and try some of those seeds.'[paragraph break]Together, you break open the fruits and harvest the soft black seeds, popping them in your mouths as you go and enjoying the rich, sweet and nutty flavor. 'My worlds,' Progue says, mouth full, 'every and every as delicious as memories. Fantastic.'[paragraph break]When you've finished your feast, he claps a hand on your shoulder cheerfully. 'Kind of you to think of me,' he says. 'I'll remember it.'". utbm_gotem2 replaces utbm_gotem.

utbm_gotem2 is a repeatable beat in utbm with reaction "'More, eh?' Progue says, picking up the fruits from the basket and hefting them. 'Well and thanks. It'll become straight staples of the diet before much longering.'".

After discussing utbm_gotem: clean basket. After discussing utbm_gotem2: clean basket.

To clean basket:
	remove basket from play;
	now quantity of the basket is 0;
	truncate harvested list of basket to 0 entries;
	now actual contents of basket is nothing;
	continue the action.



Section - Fatherly Advice

Fatherly Advice is a guaranteed serendipitous triggered episode. The expiration date is 2 hours. The icebreaker is fa_intro. The boredom beat is fa_later. The bye beat is fa_later. The abruptbye beat is fa_no.

Last condition for Fatherly Advice:
	if the affinity of Progue < 0, rule fails;
	if animus of Progue is ruminating, rule succeeds.

A completion rule for Fatherly Advice:
	if fa_no is spoken:
		Progue's life goes on;
		follow the Progue's motivation rule;
	otherwise:
		Progue's life goes on.

FA is a thread. fa_intro is a beat in fa with reaction "'Ah, just in the nick,' Progue says, coming over to you beaming. 'I know you must be terrible busy, things to do, sights to see all that, but if you can spare a handful of ments I have some advice I'd like to impart.'[paragraph break]He perches on the old piece of driftwood and pats the spot next to him. 'Take a [fa_sit],' he says, 'will just take a little while. Not more than hour, at most, I promise.'". fa_intro summons fa_no, fa_later. The no-beat of fa_intro is fa_no.fa_intro suggests fa_later.

Understand "seat" as fa_sit when last beat is in fa. fa_sit is a paternal beat in fa with keyword name "seat" and reaction "'Good [if player is male]lad[else]girl[end if],' Progue says happily as you sit next to him on the driftwood, 'splend and charm! This remembers me of the old days back home when Phoebe and Lethe would gather and gather for stories-- before Lacuna, you understand, this was back in the Nabe, the world they were born. Oh, such a precious house; I just remembered it this morning, a beautiful boathouse like almost all there were, or all were there, great oaken timbers and silk hammocks and a kitchen that you call cozy and mean it, if you ring, instead of just euphemizing. Oh, we four were happy there...'[paragraph break]And so on he goes, for well over an hour, in point of fact, eyes fixed on invisible pillars in a distant sky as he shares stories about that world of oceans and scholars, and eventually drifts back to further worlds, other lives he's lived on his long journey. Each new anecdote or detail seems to bring his face to life as if he's remembering them for the first time, and in a way you suppose he is. He only rarely seems to notice your presence but seems to find it a pleasant surprise when he does. And he never does come around to giving any [fa_advice], though as he finally reaches something like a conclusion you're not sure whether to bring that up or let it [fa_slide].". After discussing fa_sit: pass 85 minutes of time; now the abruptbye beat of Fatherly Advice is silence; now the bye beat of Fatherly Advice is fa_slide; continue the action. fa_sit cancels fa_later, fa_no.

Understand "advice" as fa_advice when last beat is in fa. fa_advice is a beat in fa with keyword name "advice" and reaction "'Oh! That! Yes of course!' he says, eyes opening wide in astonishment. 'And let's see here. It's tickling my brainwaves, just on the verge. Very important, I member and remember, gushing important advice. Hmm. Hmmmmm.' He scratches his beard furiously, looking distressed. 'Bats at noon,' he finally says, 'it's gone. Ah well-oh. Probably not really all that important I suppose. If it comes back I'll give you a yell!'". fa_advice enqueues fa_slide. 

Understand "slide" as fa_slide when last beat is in fa. fa_slide is a terminal beat in fa with keyword name "slide" and reaction "He yawns, stretching 'Well and but thanks for listening anyway. Enjoy the [progue-time-of-day], er, well, what's left of it ratherly.'".

Understand "later" as fa_later when last beat is in fa. fa_later is an unpaternal terminal beat in fa with keyword name "later" and reaction "'Oh well oh,' he says, a look of mild disappointment on his face, 'just that I'd ratherly hoped to say it now since I'll most likewise have forgotten it by then. But no sorries, you go on with what you were doing; it can always wait.'".

fa_no is an unpaternal unaffinitive annoying terminal beat in fa with keyword name "no" and reaction "'Well and for life and strife, there's no need to be rude about it,' he says, drawing himself up a bit haughtily. 'I'm used to sharing my advice with the turtles and they certainly never complained. Fine and fine then; you go on about your very important business. I have things to do.'".





Chapter - Rayfish Suicide

[This is the event that transitions Progue to the emotional psyche. It happens the morning after the 5th dream, or as soon as the pyramid has been opened. As the player arrives at a beach room, they see Progue floating out in the bay, facedown. If they don't try to rescue him, he weakly crawls to shore and into the hut (major affinity loss). If they do, cut scene where we skip forward some time and jump to the Hut, where Progue is unconscious but alive.
]

Rayfish Suicide is a guaranteed instant triggered episode. rs-progue-noticed is a truth state that varies.

A condition for Rayfish Suicide:
	if the episodic status of Post-Storm Conversation is not completed and the episodic status of Post-Storm Conversation is not expired, rule fails;
	if conversation fuse < 20, rule fails;
	if the number of contacted windsigh trees is at least 6, rule succeeds;
	if pyramid is off-stage and the number of contacted windsigh trees is at least 4, rule succeeds.

A commencement rule for Rayfish Suicide:
	summon Progue to Center Beach;
	now the animus of Progue is resting;
	now Progue is fulfilling;
	now the activity counter of Progue is 1.  

The lure message for Rayfish Suicide rule is listed before the noticing what Progue is doing rule in the every turn rules. Every turn when current episode is Rayfish Suicide and rs-progue-noticed is false and ( location is Rise or location is regionally in Beachfront ) (this is the lure message for Rayfish Suicide rule):
	now rs-progue-noticed is true;
	move distant-Progue to location;
	say "You slow to a stop. Collapsed off by the center of the beach, the surf lapping at his legs, is [o]Progue[x].[paragraph break]Face down.";
	now dont_describe_progue is true;
	if we-are-landmark-going is true:
		tidy landmark-go;
		clean up landmark-go.

Table of Progue's Initial Appearance (continued)
animus	episode		desc
--		Rayfish Suicide	"[if location is Center Beach]Progue is collapsed on the beach, face-down and motionless[else]Progue lies on a bed of palm fronds here, moaning quietly, sleeping restlessly[end if]."

A finishing rule for Rayfish Suicide:
	if rs-progue-noticed is true and location is Center Beach, rule succeeds.

A completion rule for Rayfish Suicide:
	now the psyche of Progue is emotional;
	summon Progue to Hut;
	Progue starts resting;
	now Progue's animus table is Table of Progue Sleeping;
	now Progue is fulfilling;
	now the activity counter of Progue is 0;
	now Progue is idle;
	if location is Center Beach:
		ignore the Progue begins episode dialogue rule;
		ignore the Progue needs something new after instants rule;
		say "Progue lies at your feet. Quickly, you grab him and roll him over. Tiny red welts run along his arms and torso, where his rags hang limp and heavy with seawater. Fearing the worst, you bend to listen for breath, but then he chokes and coughs, spitting seawater wrenchingly.[paragraph break]As you drag him ashore, however, the coughing doesn't stop, and you can feel how weak he is. You aren't sure he's going to make it.";
		begin chapter 7;
		now time_rs_ended is time of day;
		pass 240 minutes of time;
		now only-look-once is false;
		move player to Hut;
		now conversation fuse is 0;
	otherwise: [Player ignored him and left him here.]
		now the episodic status of Rayfish Suicide is failed;
		Progue likes you less, silently;
		Progue likes you less, silently;
		Progue likes you less, silently;
		if romance of Progue > 0, Progue is heartbroken.

time_rs_ended is a time that varies.    

 
Book - Progue in Emotional (in Lacuna-Progue-Emotional by Blue Lacuna)

Table of Emotional Episodes
eptitle
Guess I'm Awake Now
Disappearance

Section - Setup

Transition Progue to Emotional is a scene. Transition Progue to Emotional begins when the psyche of Progue is emotional. Transition Progue to Emotional ends when Transition Progue to Emotional is happening.

When Transition Progue to Emotional begins:
	truncate the list of convo stuff to 0 entries; [get rid of old keywords]
	now episode schedule is Table of Emotional Episodes;
	now the exhaust_beat of Progue is p_em_exhausted;
	now the overexhaust_beat of Progue is p_em_exhausted;
	now the bored_beat of Progue is p_em_bored;
	now the unavailable-beat of Progue is p_em_unavailable;
	now the noanswer_beat of Progue is p_em_noanswer;
	now the rudebye_beat of Progue is p_em_rudebye;
	now the abruptbye_beat of Progue is p_em_abruptbye;
	now the bye_beat of Progue is p_em_bored;
	now the conversation_beat of Progue is p_em_bored;
	now the naughttosay_beat of Progue is p_em_bored;
	now the wakeup_beat of Progue is p_em_wakeup;
	now current_thread of Progue is EmC;
	now disposition of Progue is 0;
	repeat through Table of Progue's Appointment Book:
		blank out the whole row;
	now withered vine is open [if player still hasn't solved this, open up the path for Epilogue. What, maybe it fell down.].

EmC is a thread.

p_em_wakeup is a repeatable beat in EmC with reaction "He stirs slowly, gradually blinking open unfocused eyes.[paragraph break]'What now then,' he mutters, 'what and who...'".

p_em_exhausted is a repeatable ephemeral beat in EmC with reaction "Progue closes his eyes, either not hearing your question or choosing not to respond.".	

p_em_bored is a repeatable terminal beat in EmC with reaction "'Rest,' Progue mutters, 'must rest,' and closes his eyes.".

p_em_unavailable is a repeatable ephemeral beat in EmC with reaction "He shakes his head. 'Not now, not now,' he says.".

p_em_noanswer is a repeatable dogged beat in EmC with reaction "Progue stares at you, silent and haggard, awaiting your response.".

p_em_rudebye is a repeatable ephemeral beat in EmC with reaction "'Wait,' Progue calls out, raising a weak hand, 'just a moment more.'".

p_em_abruptbye is a repeatable annoying beat in EmC with reaction "Progue watches you silently as you go.".

Instead of pushing or attacking Progue when the psyche of Progue is emotional, force discuss p_em_attack. p_em_attack is a terminal unaffinitive unromantic submissive beat in EmC with reaction "He [if submission of Progue > 0]cries out weakly and shrinks away[otherwise]watches you unblinkingly[end if] as you approach, [if affinity of Progue > 0]but you can't bring yourself to hurt him[otherwise]and you give him a savage kick[end if]. He closes his eyes and trembles.". p_em_attack2 is a terminal unaffinitive unromantic submissive beat with reaction "You move forward again with anger but suddenly Progue leaps to his feet, dodging away from you and fleeing at breakneck speed out the door of the cabin. By the time you reach the door to look out he has vanished.". After discussing p_em_attack2: move Progue to Ledge; now the psyche of Progue is fugue; continue the action.

Instead of hugging Progue when the psyche of Progue is emotional, force discuss p_em_hug.

p_em_hug is an affinitive impressive dogged beat in EmC. The reaction is "[if affinity of Progue < 0][pemunaffhug][otherwise if paternalism of Progue > 2][pempathug][otherwise if romance of Progue > 0][pemromhug][otherwise][pemnormhug][end if]". After discussing p_em_hug: if paternalism of Progue > 0, Progue feels more like a father; otherwise Progue is aroused; continue the action. p_em_bored replaces p_em_hug. To say pemunaffhug: say "'Get back,' Progue says, [if submission of Progue > 0]shrinking back in fear[otherwise]snarling angrily at you[end if], and you realize he's sure you're going to hurt him, so you stop.". To say pempathug: say "He places a weak hand on your back as you hug him. 'Thanks, [animal-nickname],' he says quietly, eyes unfocused. 'Tell your mother I love her.' You pull back and he smiles up at you, unrecognizing for the moment.". To say pemromhug: say "[if romance of Progue > 4]You lie next to Progue and hold him for a long moment. He sighs and squeezes your hand.[otherwise]You give Progue a long, tender hug. He clutches you weakly, a faint smile crossing his lips as you break the embrace.[end if]". To say pemnormhug: say "You give Progue a quick hug. He feels weak and frail.'".

[Instead of waking or greeting Progue when the animus of Progue is resting and the psyche of Progue is emotional, say "You should probably let him get his rest.".]

Section - Keywords

Understand "pyramid" as ec_pyramid when last beat is in EmC. ec_pyramid is a beat in EmC with fuse 9999 and keyword name "pyramid". Instead of discussing ec_pyramid, force discuss ec_dangerous. pyramid references ec_pyramid.

Understand "chair" as ec_chair when last beat is in EmC. ec_chair is a beat in EmC with fuse 9999 and keyword name "chair". Instead of discussing ec_chair, force discuss ec_dangerous. mind chair references ec_chair.

Understand "echo/cave" as ec_echocave when last beat is in EmC. ec_echocave is a beat in EmC with fuse 9999 and keyword name "echo cave". Instead of discussing ec_echocave, force discuss ec_dangerous. strange formations references ec_echocave.

Understand "windsigh/tree/tree9/trees" as ec_windsigh when last beat is in EmC. ec_windsigh is a repeatable beat in EmC with fuse 9999 and keyword name "[if tree1 is named]windsigh[else]trees" and reaction "'[one of]The windsigh[or]Windsigh trees[or]Gushing trickling windsigh tree[at random],' he says, muttering, and thrashing for a weak moment. '[one of]Never stop whispering[or]Dreams and dreams and dreams[or]Why won't they leave me alone[at random]...'". After discussing ec_windsigh: now tree1 is named; continue the action. manta ray skeleton references ec_windsigh. [This is repeatable so that we have a surefire way to learn Progue's name for this (and the next two.)]

Understand "coconut/konokuk/fruits/fruit" as ec_konokuk when last beat is in EmC. ec_konokuk is a repeatable beat in EmC with fuse 9999 and keyword name "[if konokuk trees are named]konokuk[else]coconut" and reaction "'[one of]Brown fruity cannonballs, the konokuk[or]Delicious konokuk fruits[or]Konokuk, on the beach[at random],' he babbles, sweating, '[one of]Kept me alive years and fears and fears[or]Always konokuk in every world[or]Crack them open and eat and eat[at random]...'". After discussing ec_konokuk: now konokuk trees are named; continue the action. manta ray skeleton references ec_konokuk.

Understand "galaxy/capalla" as ec_capalla when last beat is in EmC. ec_capalla is a repeatable beat in EmC with fuse 9999 and keyword name "[if galaxy is named]Capalla[else]galaxy" and reaction "'[one of]The great galaxy Capalla[or]Capalla, Capalla, this galaxy[at random],' he mutters, eyes closed, '[one of]the stars, the stars[or]too bright it shines[at random]...'". After discussing ec_capalla: now galaxy is named; continue the action. manta ray skeleton references ec_capalla.

ec_dangerous is a beat in EmC with fuse 9999 and reaction "[one of]He becomes distressed as you talk. 'No, no,' he moans, covering his ears, 'terrible dangerous, incomprehensible coherencies. The beach, no, can't bear it. Please, stay away, don't dream, don't sleep. Please.'[paragraph break]He calms after a moment, taking a few deep breaths. 'But then but maybe,' he says, 'maybe you can, where I couldn't-- the moon, you ring? The moonlight. Rayfish ink glows in the heat from your hand, wrote-- the real secrets, appended to all the messages, in rayfish ink.' He swallows. 'If you true want to know, read them in and under the night.'[or][ec_moonhint2][stopping]". To say ec_moonhint2: say "[one of]He becomes angry and agitated again[or]He closes his eyes and thrashes around on the ground as you begin talking[or]He moans and rubs a hand against his temples as you begin to speak[in random order]. 'Told you,' he says, 'can't help you, can't think, can't member the rememories. Keep away, my advice, don't meddle. But if you must, remember the night writing. Touch it, touch it to read...'".



Chapter - Guess I'm Awake Now

[When the player first returns to check on Progue after the near-drowning, this conversation ensues. We can get a sense of how much of what he did was suicidal. Perhaps even revealling that he intended to commit suicide even before you arrived. Tempered by explanations vis a vis the various archetypes. ]

Guess I'm Awake Now is a serendipitous guaranteed triggered episode. The icebreaker is gian_intro0. The subchange beat is silence. The boredom beat is silence. The bye beat is silence. The abruptbye beat is silence.

First condition for Guess I'm Awake Now:
	if location is Hut, rule succeeds. 

A commencement rule for Guess I'm Awake Now:
	now the animus of Progue is convalescing;
	now conversation fuse is 5. [so we'll start immediately.]

A finishing rule for Guess I'm Awake Now:
	if location is not regionally in Lacuna and location is not regionally in Dreamlands, rule succeeds.[In case this gets stuck, make sure it ends when we visit subworlds.]

A completion rule for Guess I'm Awake Now:
	Progue starts resting.

Check going when location is Hut and the psyche of Progue is emotional and Progue is enclosed by location and gian_intro0 is unspoken and gian_check is 0: now gian_check is 1; say "It looks like Progue is about to wake up." instead. gian_check is a number that varies. [ If players leave the room on their first move after rescuing Progue, this scene never gets triggered. ]

GIAN is a thread. gian_intro0 is an insistent beat in gian with reaction "Progue coughs and stirs, blinking his eyes blearily, unable to focus them.[paragraph break]'[']sat you? Tama? Who's--?' he trails off uncertainly, looking up with blearily unfocused eyes. He tries to say something else but coughs weakly.". gian_intro0 suggests gian_intro.

gian_intro is an insistent beat in gian with reaction "It is long moments before he recovers himself enough to talk.[paragraph break]'Ehh, nevermine who,' he mutters vaguely, running a hand through his thinning hair, 'not, not who, do... what's in matters is, do I trust you, eh?'". The yes-beat of gian_intro is gian_trustyes. The no-beat of gian_intro is gian_trustno. gian_intro suggests gian_trustyes.

gian_trustyes is a beat in gian with keyword name "yes" and reaction "He grunts. 'Fine oh well then. Fine fine. Have to tell. Thing, some-- [gian_memories] came rolling and reaping in the dark last, so many memories, in the-- and I membered, membered it all and every and what I'd and why they-- my [gian_girls]--' He trails off, tears forming in his eyes.". gian_trustyes suggests gian_memories.

Understand "girls" as gian_girls when last beat is in gian. gian_girls is a beat in gian with keyword name "girls" and reaction "'What I remembered I remembered,' he says, 'I remember now why they left. I left. Because. I left them. I left them three times. When we came here, one, grieving, not seeing them; the dreams, the plans, two, not watching over them, and; three, three, at the end, when I couldn't decide, couldn't make the-- and slipped through grim morosities, and lived mad while they lived, until they left, left, left...' He squeezes his eyes painfully shut, and swallows.". gian_girls suggests gian_memories. 

gian_trustno is a beat in gian with keyword name "no" and reaction "He squints his eyes, staring up at you suspiciously. 'Aha then,' he says, 'then I won't tell you, tell you, alone then I'll just have my [gian_memories], memories, of me and the [gian_girls] and memories and me...' He trails off, looking lost, out the brightness of the open door towards the sea.". gian_trustno suggests gian_memories.

Understand "memories" as gian_memories when last beat is in gian. gian_memories is a beat in gian with keyword name "memories" and reaction "'And membered I'd membered before,' he goes on, 'and membered and lost and membered and lost but each but this time, this time-- and the [gian_rayfish], they came back, back to the bay, again again-- but so far, they-- so much farther out than before, I could hardly barely see-- almost-- and [gian_swam] out to-- so far--' He raises a hand as if to point, then lets it fall back into his lap bonelessly.". gian_memories suggests gian_nexus. gian_nexus replaces gian_memories.

Understand "swam" as gian_swam when last beat is in gian. gian_Swam is a beat in gian with keyword name "swam" and reaction "'Swim swam swim swam,' he mutters, eyes flitting closed, 'swim swim away.'". gian_swam enqueues gian_nexus.

Understand "jellyfish" as gian_Rayfish when last beat is in gian. gian_rayfish is a beat in gian with keyword name "jellyfish" and reaction "'So pretty, and didn't I promise? But then and no no no, it was before long befores I wanted to swim with them, wasn't it? Wasn't-- don't know, don't member, remember...' He slumps back, blinking slowly, lost in himself.". gian_rayfish suggests gian_nexus.

gian_nexus is a repeatable beat in gian. gian_nexus enqueues gian_like.

Before discussing gian_nexus:
	if paternalism of Progue >= 2:
		now gian_nexus enqueues gian_paternal;
	if romance of Progue >= 3:
		now gian_nexus enqueues gian_romance;
	else if romance of Progue < 0:
		now gian_nexus enqueues gian_bitterromance;
	else if affinity of Progue < -2:
		now gian_nexus enqueues gian_dontlike;
	else if submission of Progue >= 3:
		now gian_nexus enqueues gian_submission;
	else if submission of Progue <= -3:
		now gian_nexus enqueues gian_unsub;
	continue the action.

To say giantrust:
	say "He focuses on you again. ";
	if gian_trustyes is spoken:
		Progue likes you more, silently;
		say "'Right, you're right do, I do trust you,' he says. ";
	otherwise:
		say "'You, you were wrong-- I do trust you,' he says. ".

To say giandonttrust:
	say "He focuses on you again, frowning. ";
	if gian_trustyes is spoken:
		Progue likes you less, silently;
		say "'Liaring,' he says angrily, 'I don't, don't trust you. Tricked me. Of you. Typical.' He coughs. ";
	otherwise:
		Progue likes you more, silently;
		say "'Right,' he says, 'right, you were right. I don't trust, trust you.' He coughs. ".

gian_paternal is a beat in gian with reaction "[giantrust]'Lethe,' he adds, then frowns. 'No no no-- not Lethe but something more the same, more the same-- my could be [if player is female]daughter[otherwise]son[end if] maybe in other realdoms, separate beings--'.". gian_paternal enqueues gian_goodtimes.

gian_romance is a beat in gian with reaction "[giantrust]'You're the one, the, who showed me again what-- love, never thought I'd--' he trails off, coughing again.'". gian_romance enqueues gian_goodtimes.

gian_bitterromance is a beat in gian with reaction "[giandonttrust]'Thought mayhaps you'd show me, remember, something I'd, this was lost. Love. But you're just the same. False as blue pigs, heartbreak, frayed lifelines--' he trails off, coughing again.". gian_bitterromance enqueues gian_goodtimes.

gian_dontlike is a beat in gian with reaction "[giandonttrust]'[if affinity of Progue < -5]No friend of mine, you, wayloper, interfarer, unwanted, unkindnesses and cruelty[otherwise]We, me, not the same as you, too different, don't get along, along[end if].' He swallows. '[if episodic status of Rayfish Suicide is failed]Left me to drown, drown down there in the sea. Bastard. You should drown, you should down, murderer, murderer[otherwise if Progue Rescue ended unsuccessfully]Left me to die, dry land sinks under waves, that night you saw and turned your back on me, bastard. Should have let you drown, down, fall, sink[otherwise]Haven't tried to kill me at least I suppose so far so, well oh, points in your favor[end if]...'". gian_dontlike enqueues gian_goodtimes.

gian_submission is a beat in gian with reaction "[giantrust]'You're the one who came and told and led and made me, what to do. You know best now, no, best is best and you're the one who does and I'm the one who doesn't...'". gian_submission enqueues gian_goodtimes.

gian_unsub is a beat in gian with reaction "[if affinity of Progue > 0][giantrust][else][giandonttrust][end if]'You need me you do, don't know where to what to how to without me, always asking for help, what will you, must get well to tell you, show you what must be, be done.'". gian_unsub enqueues gian_goodtimes. 

gian_like is a beat in gian with reaction "[giantrust]'You're a friend, thoughts alike or something thatwise. Before and before you came I thought I'd never make another. Friend. Another friend.'". gian_like enqueues gian_goodtimes. gian_goodtimes replaces gian_like.

gian_goodtimes is a beat in gian with reaction "'[if Word Day is successful]That [time-wd-started] we met on Word Day by the boulders[otherwise]day we met[end if], you appearing from the blue lacuna, [giangtnm]and I found my name and lost the Creeper, [if cc_1 is spoken]first question first[otherwise if cc_2 is spoken]second question first[otherwise]third question first[end if], [giangt2]". gian_goodtimes suggests gian_outtro. gian_outtro replaces gian_goodtimes.

To say giangt2:
	if cc_all3 is unspoken, say "and first a [if cc_sculptor is spoken]sculptor[otherwise if cc_father is spoken]father[otherwise]madman, ha[end if], first and always and always";
	else say "and a father and sculptor and madman at once";
	let happenings be the list of verbosely described completed episodes;
	sort happenings in random order;
	truncate happenings to 3 entries;
	say ", [happenings]";
	say "...'[paragraph break]'You brought me back from wheres and somes but not far, far enough, far enough...'". 

Rule for printing the name of an episode (called ep) when current episode is Guess I'm Awake Now: say summary of ep.

To say giangtnm: if player-name-guess is not "no.guess", say "and how you remembered my name, not [player-name-guess] but Progue, Progue, Progue, ".

gian_outtro is a terminal beat in gian with reaction "He focuses on you again. 'Couldn't decide,' he says, 'in the end in the end in the end. What drove me. And them away, Lethe, Phoebe. The decision, I could never, never...'[paragraph break]He shakes his head, and seems to want to say more, but cannot get any words out. Finally he shudders and closes his eyes again. At long last he murmurs, 'Only the past answers now. There's a secret ink, a special secret ink I made from the rayfish. Glows when heated, glows when touched. Look for the writings, scrawlings about and around and aroundabout, and touch them at night, under the stars-- new words will glow, like the rayfish, like the rayfish-- all of all my answers.'[paragraph break]He sinks back into his bedding, cold sweat beading on his forehead. 'You now,' he says, eyes closed, 'finish, finish what I-- or go, wayfare on away, away...'[paragraph break]Murmuring under his breath, he slowly slips back into uneasy sleep."


Chapter - Clean My Beach

Clean My Beach is a frequent serendipitous episode. The icebreaker is cmb_intro.

CMB is a thread. cmb_intro is a beat in cmb with reaction "'My beach, my beach,' Progue mutters, staring past you, out the door. 'Without my vigilence it's become a mess.'[paragraph break]He peers up at you intently. '[if submission of Progue > 0]Would you clean it for me?[otherwise]Clean it for me[end if],' he says.". cmb_intro summons cmb_yes, cmb_cant, cmb_wont. The yes-beat of cmb_intro is cmb_yes.

cmb_yes is an impressive terminal beat in CMB with reaction "He nods in [if submission of Progue  > 0]surprise and gratitude[otherwise]acceptance[end if]. 'Good,' he says, 'far more important than dreams and pyramids and whatever and whatever. Tell me, tell me when you're finished.' He closes his eyes again.".

cmb_cant is an annoying terminal beat in CMB with reaction "He grunts, face falling in disappointment. 'Then it's over,' he says, 'the beach will never be-- not again, can't--' he struggles for words, then gives up, shrugging. 'Our own choices,' he mutters.'".

cmb_wont is an annoying unaffinitive submissive terminal beat in CMB with reaction "He looks up at you angriy. 'Don't understand,' he says, 'doing wrong... the beach is what's important, what's important...' He turns away. 'Go then and go. And go and go.'".







Chapter - Disappearance

Disappearance is a guaranteed instant triggered episode.

A condition for Disappearance:
	if Progue is enclosed by location, rule fails;
	if the number of contacted windsigh trees is 7, rule succeeds.

A commencement rule for Disappearance:
	now the psyche of Progue is fugue.

A finishing rule for Disappearance:
	if the psyche of Progue is fugue, rule succeeds.

Noticing-Disappearance is a triggered guaranteed instant episode.

A condition for Noticing-Disappearance:
	if location is Hut, rule succeeds.

A commencement rule for Noticing-Disappearance:
	say "That's funny. Progue was here, but now he's gone.".

A finishing rule for Noticing-Disappearance: rule succeeds.

Chapter - Fugue

Transition Progue to Fugue is a scene. Transition Progue to Fugue begins when the psyche of Progue is fugue. Transition Progue to Fugue ends when Transition Progue to Fugue begins.

When Transition Progue to Fugue begins:
	Progue starts hiding;
	remove Progue from play;
	now episode schedule is Table of Fugue Episodes.

Every turn when the psyche of Progue is fugue:
	now the activity counter of Progue is 0.

Table of Fugue Episodes
eptitle
Final Confrontation


Chapter - Bring Me

[Progue, sick and in bed, asks the player to bring him something from the ledge. If the player complies, and depending on what the player brings, adjust points accordingly. ]

[Bring Me is a scene. Bring Me begins when the psyche of Progue is emotional and Progue is enclosed by location and we are going and a random chance of 1 in 3 succeeds.

When Bring Me begins:
	pre-conversation processing;
	force discuss bm_intro.

bm_intro is a beat with reaction "Progue coughs, weakly. 'Nice of you to visit,' he wheezes, 'my old hallucination. If only that were all you were. I might be able to die with some dignity.[paragraph break]{In this scene Progue asks you to do something for him. Based on your actions, you can either strengthen or weaken his paternal feelings towards you (moredad or lessdad) or his feeling of submission to you (moresub or lesssub).}".

Bring Me ends when we have discussed bm_intro.]

[Brought Me is a scene. Brought Me begins when Bring Me has happened and Progue is enclosed by location and the psyche of Progue is emotional and the player carries berry-fruit.]

[ what could we bring Progue? hammer, sketchbook, berries, compass, seed cones, konokuk, leaves, seashell
]

Chapter - Loss


Book - The Confrontation (in Lacuna-Progue-Confrontation by Blue Lacuna)

Table of Fugue2 Episodes
eptitle
Final Confrontation

Transition Progue to Fugue2 is a scene. Transition Progue to Fugue2 begins when the psyche of Progue is fugue. Transition Progue to Fugue2 ends when Transition Progue to Fugue2 begins.

When Transition Progue to Fugue2 begins:
	now withered vine is unlocked;
	now withered vine is open;
	now episode schedule is Table of Fugue2 Episodes.

Transition Progue to Resolved2 is a scene. Transition Progue to Resolved2 begins when the psyche of Progue is resolved. Transition Progue to Resolved2 ends when Transition Progue to Resolved2 begins.

 When Transition Progue to Resolved2 begins:
	now the animus of Progue is ruminating;
	now Progue is fulfilling;
	now Progue's animus table is Table of Progue Default.

Instead of greeting Progue when the psyche of Progue is resolved, say "Right now, there is nothing more to say.". Instead of hugging Progue when the psyche of Progue is resolved: say "He hugs you back, trembling with relief or release, something electric in his hands as they grip your back. When he finally releases you with a deep breath, he only nods once, eyes clouded, as if unafraid to say anything more.". Instead of kissing Progue when the psyche of Progue is resolved, try hugging Progue. Instead of pushing or attacking Progue when the psyche of Progue is resolved, say "The time for that is over."

[Another thing players could try is wanting to choose nobody simply by shutting off the power to the seiver instead of destroying it. If they get to an ending where Progue is dead or allows them to take action, allow for this possibility.] 
To pipechangeending: if ( story mode and pipe-position of boiler handle is not yellow pipe ) or ( puzzle mode and pressure of the related pipe of the pyramid pressure gauge < 22 ) begin; say "[line break]The glow from the egg on the mountain dies away. It's done. The windsigh of Lacuna are cut off from Forest and all other listeners, and when you look at the stars, only you will see them."; try sleeping; end if.

eptrigctr is a number that varies.
Every turn when ( the psyche of Progue is resolved or Progue is dead ) and location is regionally in Lacuna and Epilogue is not happening and Epilogue has not happened:
	now the time of day is time factor minutes before the time of day; [the night never ends.]
	increase eptrigctr by 1;
	if eptrigctr is 10 or ( eptrigctr > 10 and a random chance of 1 in 10 succeeds ) , say "You tremble with exhaustion. But you must either sleep, or see this through. Climb the highest tree and look at the stars[one of][or]. The vine on the beach will lead you to its branches[stopping].".

To decide whether end-rebels: if the machinery-password exactly matches the text rebel-password and pyramid has power, decide yes; decide no. To decide whether end-trees: if the machinery-password exactly matches the text tree-password and pyramid has power, decide yes; decide no. To decide whether end-choice: if end-rebels or end-trees, decide yes; decide no.

To decide whether end-both: if the machinery-password is blank or not end-choice, decide yes; decide no.

To decide whether end-neither: if the mind machinery is off-stage, decide yes; decide no.

To decide whether end-abstain: if end-abstain-trigger is 1, decide yes; decide no. end-abstain-trigger is a value that varies. end-abstain-trigger is 0. [ end-abstain can only be determined through dialogue with Progue. ]

[
After the player has been in both worlds, the storm ends. The player can climb/chairlift down the mountain (quite possibly on the way to the tallest tree to look at the stars), but they will have to pass through RIse, where Progue is waiting for them. Once they enter this room, they can't leave until the scene is resolved.

The player can fundamentally have done one of four things: A) Set the calibration machine for one side or the other (end-choice / end-rebels or end-trees), B) Set the machine for no encryption (choosing both sides) or a completely different encryption (both sides, but harder) (end-both), or C) Destroy the machine (end-neither). The player can also be abstaining from choice, which can't be determined by player actions alone, so Progue's first move in most scenarios is to ask the player whether their current choice is final.

The exact sequence of conversation is very complex here, depending on Progue's archetype, the player's decision above, whether the player tells the truth or not about their choice, and how they respond to Progue's requests. However, the situation is guaranteed to end up with one of two resolutions:

1: The player does not choose; Progue is forced to make the choice for himself and does.
2: Progue is convinced the player is wrong (either for making a choice or not making one) but the player will not relent; they fight. (This will always happen if end-neither).

Option 1 then concludes with one of serveral finales:

1a: Progue decides to destroy the machinery, rejecting the choice. (if neurotic dad, bitter dad, toady, or twitterpated; his lack of confidence erupts in a fit of anger.)
1b: Progue decides to set no encryption; may the best side win. (friend, lover: your example has shown him the choice was never his to make.)
1c: Progue changes the encryption to the trees. (father knows best, disciplinarian: people need guidance and control in their lives.)
1d: Progue changes the encryption to the rebels. (slave; bitter lover: people need to break free of what's keeping them down.)

Alternatively, option 2's fight can be resolved one of three ways, each of which lead to various finales depending on archetype:

2a: The player loses the fight, allowing Progue to have his way.
--> 2a1: If you lied to Progue about your choice, he sees you were right.
-->	else 1a, 1b, 1c, 1d, 1e: as in the Option 1 endings.
2b: The player wins the fight fairly, cementing his choice; or player loses but machinery is destroyed.
--> 2b1: Progue accepts that through inaction he lost his right to make the choice. (all but three below)
--> 2b2: Progue cannot accept this and commits suicide. (slave, bittered lover, shattered lover)
2c: The player wins the fight violently, killing Progue in the process.
--> 2c1: Progue passes the mantle of "hero" to you.

Progue, if alive, realizes a burden has been lifted and he will be able to wayfare again. Finally, if the mind machinery is not destroyed, there is a denouement:

D1: Progue goes alone to look at the stars. (If 1b, 1c, 1d)
D2: Progue and the player go together to look at the stars (same as above, if player consents and Progue likes player)
D3: You go alone to look at the stars. (2a1, 2b1, 2c1)
D4: The mind machinery is destroyed.
D5: The choice still has not been made: you are asked to pick or reject it for good.

]

fc_intro is a beat. FC is a thread.



[Exploring Lacuna ends when current episode is Final Confrontation.]

Final Confrontation is a guaranteed triggered instant episode. The meeting place is Rise. The icebreaker is fc_intro. The bye beat is fc_cantleave. The abruptbye beat is fc_cantleave. The subchange beat is fc_subchange. The boredom beat is fc_subchange.

A condition for Final Confrontation:
	if location is Rise and Rebelworld-Sequence is solved and Treeworld-Sequence is solved, rule succeeds.

Last commencement rule for Final Confrontation:
	now disposition of Progue is 0;
	say "[initial appearance of Progue][line break]";
	force discuss fc_intro.

fc_intro is a beat. Instead of discussing fc_intro:
	if mind machinery is off-stage begin;
		force discuss fc_whathaveyoudone;
	otherwise;
		if neurotic dad begin; force discuss fc_start_neurotic_dad;
		otherwise if father knows best; force discuss fc_start_father_knows_best;
		otherwise if bitter dad; force discuss fc_start_bitter_dad;
		otherwise if disciplinarian; force discuss fc_start_disciplinarian;
		otherwise if lover or twitterpated; force discuss fc_start_lover;
		otherwise if friend; force discuss fc_start_friend;
		otherwise if toady; force discuss fc_start_toady;
		otherwise if shattered lover; force discuss fc_start_shattered_lover;
		otherwise if bitter lover or enemy; force discuss fc_start_enemy;
		otherwise if slave; force discuss fc_start_slave;
		otherwise; if drama manager is being debugged, say "// ERROR: Progue does not fit into any archetype."; force discuss fc_start_friend;
		end if;
	end if.

A finishing rule for Final Confrontation:
	if the number of terminal spoken beats in FC > 0, rule succeeds;
	if Progue is dead, rule succeeds.

A completion rule for Final Confrontation:
	if ending_1a is spoken or fc_destroyed is spoken or fc_proguealonestars is spoken:
		now ep-trigger is true. 

Table of Progue's Initial Appearance (continued)
animus	episode		desc
--	Final Confrontation		"Standing on the rise waiting for you, watching your approach calmly, is Progue."

Table of Progue's Description (continued)
animus	episode		desc
--	Final Confrontation		"He still looks weak, but holds himself up firmly. There is a resolve in his eyes that you have never seen there, but also, something else-- dangerous and unhinged."

Instead of examining Progue when the psyche of Progue is resolved: say "He looks content, at peace with something in himself in a way you've never seen, perhaps a way he hasn't felt for decades.".

fc_cantleave is a dogged repeatable beat in FC with reaction "Progue reaches out with sudden strength and grabs your arm. 'No,' he says, 'we must finish this.'".

fc_subchange is a dogged repeatable beat in FC with reaction "He shakes his head. 'There's only one thing we have to talk about now,' he says.".

fc_whathaveyoudone is an insistent beat in FC with reaction "'I saw,' he says quietly, 'what you did... all that work, all those hours of mine smashed in moments by stupid violence...'[paragraph break]He is trembling, and suddenly he rushes towards you with a scream, and you know the trembling was from an effort to stay standing but from holding himself back from tearing you apart.[paragraph break]He leaps on you, screaming and hammering blows which are so wild that they pose no danger beyond bruises, screaming, 'You destroyed it, how could you? What have you... what have you done?'". fc_whathaveyoudone enqueues fc_fight.



FC_opener is a thread. 

fc_start_neurotic_dad is a beat in FC_opener with reaction "He looks thin, pale, weak, and nervous. 'Saw you go up there,' he says, glancing quickly toward your eyes then away again. 'You know, [if player is male]son[else]my sweet one[end if], I've tried to warn you of the dangers here, guide you, help you, keep you retracing my steps. But you've never listened. You've always done what you want, gotten your way. And now, now... you've come full circle, come to where and where I was those gray years ago. And now you'll finish what I started.'[paragraph break]He rubs his hands together anxiously. 'And well?' he says hopefully, plaintively, 'well? Don't hold me waiting. Tell me do: what did you decide? Oh please, tell, you must and need and have to. I've been waiting, waiting so long to know what's right, the right answer, the right choice. So which one?' he concludes, desperately. 'Tell me, have you decided which one?'". fc_start_neurotic_dad enqueues fc_start_decide.

fc_start_father_knows_best is a beat in FC_opener with reaction "He looks thin and pale, but stands tall, smiling at you with something like pride. 'I saw you go up there,' he says, 'and I knew, my [if player is male]boy[else]girl[end if], I knew-- you'd gone to finish what I started. You know, I've come to think of you as a [if player is male]son[else]daughter[end if], and fancied you've taken my advice to heart. So yes, gushing fitting; full circles and things passed. Well. You've been to both their worlds now, just as I did, and-- and you've made up your mind.' He takes a step closer, studies your face. 'Yes,' he says, 'I can see it in your eyes. You've chosen. You've made your choice.' He frowns a little. 'Well, have you?'". fc_start_father_knows_best  enqueues fc_start_decide.

fc_start_bitter_dad is an beat in FC_opener with reaction "He looks thin and haggard, still sick, but stands subtly in your way, watching you warily. 'And now your great replacement of me has concluded, [if player is male]boy[else]girl[end if],' he says bitterly. 'Once I thought of you as like a [if player is male]son[else]daughter[end if], even though we haven't gotten along, and you've always ignored my advice, done what you want. Everything and everything that once I was you think you are. Even the choice, the great, terrible choice the weak and broken old man couldn't make, a choice between two peoples, two worlds, two ways of life-- even that is yours now.' He coughs, weakly, but never takes his eyes from you.[paragraph break]'Tell, tell, wise one,' he says, 'have you made your decision?'". fc_start_bitter_dad enqueues fc_start_decide.

fc_start_disciplinarian is an beat in FC_opener with reaction "He looks thin, a sickly gauntness accentuated by his rigidly straight posture as he stands in your way, looking towards you distastefully. 'Back already,' he says in a disappointed undertone. 'The fate of three worlds on [if player is male]his[else]her[end if] shoulders, and [if player is male]he[else]she[end if]'s back already. You know, I've always thought of you like a [if player is male]son[else]daughter[end if]; even though we've never gotten along, you've at least been respectful and shown the proper deference to my position. I've had expected you'd have spent more sums of time liberating and deliberating, but.' He coughs, never taking his eyes from you. 'But, but, but. We've learned to disappoint each other. Well. So tell. Have you already decided which it will be?'". fc_start_disciplinarian enqueues fc_start_decide.

fc_start_friend is an beat in FC_opener with reaction "He looks weak and gaunt, but seems calm, collected, watching closely as you approach. 'So my friend returns,' he says, 'And now knows what I knew, and reached the chasm of decision that I never crossed those green eons ago.' He coughs. 'To choose between two worlds, two peoples-- it destroyed me then, such a terrible burden atop all the others I already bore, and as you've retraced my steps, bringing back the memories in twos and clusters-- well. It almost destroyed me again.'[paragraph break]He suddenly steps forward earnestly, searching your face. 'But you're not like me, my friend. No. I see it in your face. You've decided, haven't you? Already decided. Yes? Have you?'". fc_start_friend enqueues fc_start_decide.

fc_start_toady is an beat in FC_opener with reaction "He looks gaunt and hunched, watching you with eager, expectant eyes. 'You've done it,' he says, breathing raggedly, 'been to both their worlds, just like me, just like me. Oh, I remember now, finally remember. And now the choice is yours, that choice I never could make, the one that almost, almost destroyed me.[paragraph break]He suddenly steps forward earnestly, searching your face with a hungered eagerness. 'But you're not like me, friend, no, you're so much stronger, so much... You've decided, haven't you, haven't you already? Already decided. Oh, tell me, then and please, tell, I need knowing. Tell me. Have you decided?'". fc_start_toady enqueues fc_start_decide.

fc_start_lover is an beat in FC_opener with reaction "Progue crosses to you and puts a hand in yours. 'You've done it, then,' he says simply, a shudder running through his body. 'Wonderful and terrible. I'm sorry I couldn't tell you. So much was forgotten, was lost...' He squeezes your hand, looking down at it, and takes a long, deep breath. 'Tell me, then. Have you decided which side to help?'". fc_start_lover enqueues fc_start_decide.

[ twitterpated uses lover ]

fc_start_enemy is an beat in FC_opener with reaction "Progue stands ominously on the rise, looking stronger than you've seen him in days. 'So,' he spits, scorn twisting his face, 'you're back. You think you're going to resolve this; you think you've replaced me. Well they picked me,' he says dangerously, 'they picked me to decide. Have you picked a side?'". fc_start_enemy enqueues fc_start_decide.

fc_start_slave is an beat in FC_opener with reaction "Progue crouches on the rise, eyes never leaving you, dark circles around them. 'You've been there,' he whispers, 'and now you're ready to impose your nasty, hurtful will on two entire planets. Well.' He chuckles quietly to himself. 'You've gotten your way so far. Not surprising.' He gives you a sidelong glance. 'Have you made your choice, then?'". fc_start_slave enqueues fc_start_decide.

[ bitter lover uses _enemy ]

fc_start_shattered_lover is a dogged beat in FC_opener with reaction "Progue sits in your path, rocking back and forth, trembling. 'The choice,' he whispers, 'the choice, the choice. You made it. Not me. A monster like you could do something I could not.' He looks up at you with hateful, tear-filled eyes. 'Have you chosen?' he whispers. 'Have you picked a side?'". fc_start_shattered_lover enqueues fc_start_decide.

fc_start_decide is a beat in FC_opener. The yes-beat is fc_ask_which_side. The no-beat is fc_ask_why_not.

fc_ask_which_side is a repeatable insistent beat in FC_opener with keyword name "yes" and reaction "[one of]'Then which side have you chosen?' he asks, [archetype message]. 'Tell me. Is it[or]'Please,' he says, 'stop climbing my nerves. Tell me. Will it be[stopping] [t]Forest[x] or [t]City[x] who inherits this world?'". fc_ask_which_side summons fc_chose_forest, fc_chose_city, fc_both, fc_have_to_choose, fc_ask_why_not. Instead of saying maybe when last beat is fc_ask_which_side or last beat is fc_whathaveyoudone, force discuss fc_have_to_choose. Instead of saying neither when last beat is fc_ask_which_side or last beat is fc_whathaveyoudone, force discuss fc_ask_why_not. Instead of saying both when last beat is fc_ask_which_side or last beat is fc_whathaveyoudone, force discuss fc_both.


[ Player chose a side. ]

Understand "forest" as fc_chose_forest. fc_chose_forest is a beat in FC with keyword name "Forest" and reaction "'Forest,' Progue breathes, staggering back with eyes wide and darting, running a hand through his hair wildly. 'Forest,' he says again, 'worlds and time, the Forest. The galaxy forest, the symbiont race. There's [fc_Beauty] in them I suppose; no wars, no and those people were mostly probably [fc_happy] it seemed. But no, I was never sure, never knew if I believed in their happiness, never knew if its tang was pure and real or only artificial.'[paragraph break]He whirls, pacing now, mumbling furiously to himself. 'Because how would they ever know,' he says, 'how would they know unhappy? They're told they're happy; they're not free; didn't have to make their own [fc_struggles], craft their own identities, did they? Do they think or do their trees think for them?' He runs his hand over his face, sweating, trembling, considering. 'Then again do we think? Are we happy? Don't know, don't know, don't know...'". fc_chose_forest suggests fc_yourewrong.

Understand "happy" as fc_happy when last beat is in FC. fc_happy is a beat in FC with keyword name "happy" and reaction "'Mayhaps,' he says, pacing frantically, 'mayhaps, mayhaps it less than matters; happy is happy regardless from the cause. Those children, growing into a peaceful world of [fc_beauty] and intellect and knowledge, like well tended shoots...' He bites his lip, eyes racing madly. 'Didn't trust them,' he says, 'or was too jealous to know how to. Happy...' he continues pacing, chewing a knuckle fiercely.". fc_happy suggests fc_yourewrong.

Understand "beauty" as fc_beauty when last beat is in FC. fc_beauty is a beat in FC with keyword name "beauty" and reaction "'Yes, yes, I remember,' he says, pacing across the lava flow wildly, 'memories surged back like neap runoffs; gentle breezes, soft forests, craftiture and gardentude, yes. No dirt, no grime, no, nothing like pollution there in Forest but what nature leaves. A paradise, tempting. But.' He squints, rubbing his hands together with trembling anxious energy. 'But. Man can't truly thrive, live, love, be man, in paradise. No. He always needs [fc_struggles], doesn't he? Don't we?' He squeezes his temples, shutting his eyes in fierce concentration. 'Or is that just the sick and sorrowed assumption of minds who can't conceive, perceive a world without it?' He resumes pacing, muttering furiously to himself.". fc_beauty suggests fc_yourewrong.

Understand "struggle/struggles/conflict" as fc_struggles when last beat is in FC. fc_struggles is a beat in FC with keyword name "[if last beat is fc_beauty]conflict[else]struggles" and reaction "'Yes, struggle,' he says, 'difference, argumentation, accommodation. Something thatwise. Defines us, doesn't it? These ill-fitting things. And they have none there.' He rubs his beard fiercely. 'They may not be one mind but they are of one mind, [fc_happy] and set. All pieces fit together. Moistly hells, can that be for the best? Does that deserve to survive, spread, grow? Do we strive to promote our own ideals grown real, despite the lack we feel something inwardsly of some realful quintessence?' He stares at you with almost desperation.". fc_struggles suggests fc_yourewrong.


Understand "city" as fc_chose_city. fc_chose_city is a beat in FC with keyword name "City" and reaction "'City,' Progue breathes, staggering back with eyes wide and darting, running a hand through his hair wildly. 'City,' he says again, 'worlds and time, the City. The rebels, the underdogs, biting at the heels of would-be [fc_oppressors]. Yes, it seems right on the surface, doesn't it? Symbolic poetry. But.' He whirls, pacing now, mumbling furiously to himself. 'Those people, those people were divided, angry, at throats and snarls. The [fc_Greeneyes], their Other; mayhaps they're more deserving, only seen through eyes of enemies... didn't know, couldn't see. More complicated than the selfsame Forest. And [fc_dirty], skies choked with smog, rubbish in the streets. Think of my Lacuna overrun, get upended. But...' He runs his hand over his face, sweating, trembling, considering.". fc_chose_city suggests fc_yourewrong.

Understand "oppressors" as fc_oppressors when last beat is in FC. fc_oppressors is a beat in FC with keyword name "oppressors" and reaction "'Yes, that was their story,' he says fiercely, pacing back and forth across the lava flow, 'but I wonder. Would Forest have really interfered? Would they not have been happy to let the people of City grow, colonize their own worlds? Looks a gushing big galaxy from here, have my words... Or were the people of City just something bitter, trickling paranoid, would-be friends and would-be enemies the same mishmashed blur? Don't know, don't know.' He squeezes his temples, shutting his eyes in fierce concentration.". fc_oppressors suggests fc_yourewrong.

Understand "greeneyes" as fc_greeneyes when last beat is in FC. fc_greeneyes is a beat in FC with keyword name "Greeneyes" and reaction "'Probably nice people,' he says, 'who can say? Not us, not us. Seen them only through eyes of enemies, no guessing how close to truth, whatever truth is. Mayhaps they're just like City. Mayhaps they deserve to colonize Lacuna and reap the somenium harvest even more. But those people, Leader Tall's people would surely use their new power over the Greeneyes. Who am I, are you, to judge, jury out who deserves it, which among the claves and gangs of those people it best should fall to?' He bites his lip, eyes racing madly.". fc_greeneyes suggests fc_yourewrong.

Understand "dirty" as fc_dirty when last beat is in FC. fc_dirty is a beat in FC with keyword name "dirty" and reaction "'Natural byproducts of a growing society,' he says, stroking his beard fiercely, 'mayhaps. Mayhaps they grow too fast.  Forest at least looked before; City's leaping down abysses and chasms of technology they don't gushing understand. No control in a freefall, no; gravity smashes you through anything delicate and beautiful on your way, pulls you faster and faster and fast. And no knowing, no, when it is they'll hit the bottom.' He stares back at you, thinking with something approaching desperation.". fc_dirty suggests fc_yourewrong.

Understand "both" as fc_both when last beat is in FC. fc_both is a beat in FC with keyword name "both" and reaction "'What?' Progue blinks, confused. 'Both? What do you mean?'[paragraph break]As you explain how you [if machinery-password is blank]simply removed any encryption from the seiver, allowing both sides equal access[otherwise if machinery-password is not rebel-password and machinery-password is not tree-password]set the encryption to a password known to neither side, potentially giving the prize to whoever can break the encryption first[otherwise]intend to neither help nor hinder either side[end if], he stares back in growing disbelief. 'Always with you it's rejecting simple choices, isn't it?' he says. 'Both... I'd never.. I didn't...' But he frowns, starting to shake his head.". fc_both enqueues fc_yourewrong. After discussing fc_both: now end-abstain-trigger is 1; continue the action.



fc_yourewrong is an exciting beat in FC with reaction "'No,' Progue finally says, then again, more firmly: 'No. [if affinity of Progue < -2 or submission of Progue < -2]Of course and always no, I know now, you're wrong as wrong and wrong, [else]Sorries, but oh, I see now, I see, [end if][if fc_chose_forest is unspoken and fc_chose_city is unspoken]failing to choose can never be a choice, despite your despites; just an abdication, isn't it? Shivering off wet responsibility. Not our universe, too true, but we each came here for a reason true too: to help the right cause. That is why we were Called here. To decide. To decide. And the decision should be[otherwise]you made the wrong choice. Oh and it's mirror-clear now, fog dissolves and finally I know what's right. It should be[end if] [Proguesidechoice]. [if side_Progue_picks is 0]Forest has no guardians, no shepherds, don't you see? It will spread across the Galaxy, subsume, overrun, crowd out any other form of thought that cowers in its way. Can't let that happen to City. Gushing no. Life needs escapes from tyrants and freedom for dreams, no matter the cost[otherwise]The people of City are filled up with war, and division, and destruction; they can't be trusted with the keys to a whole galaxy, not yet. Not enough that they think more like us, spark some misplacement of noble ideals; they'd destroy this planet and others with their greed, strip mines of somenium, gushing steel railways blackening every beach. No. Life needs structure, leaders, mentors to bring order from chaos, to teach good from bad[end if].'". fc_yourewrong enqueues fc_intentions.

fc_intentions is an insistent beat in FC with reaction "Progue steps forward. 'Now,' he says[if father knows best or disciplinarian or bitter dad] firmly[otherwise if friend or lover] sincerely[otherwise if enemy or slave or bitter lover] snidely[otherwise if toady or neurotic dad or shattered lover or twitterpated] timidly[end if], [archetype message], 'and now I know at last what needs doing. I'll go back at last to the top, up the mountain and reset the seiver for [if side_Progue_picks is 0]City[else]Forest[end if], as it should be. I remember my secret word, yes, oh, remembered it even when I'd forgotten everything else, and now this must be settled, don't you see? Don't you know; now, and now I finally know what to do.'[paragraph break]He steps forward in the direction of the stumps, but you almost unconsciously move to block him, and he frowns. 'Please now,' he says, 'step [t]aside[x] and let me go, let me finish this for last and always. Don't [t]argue[x], don't at end's end be the last thing to stand in my [t]way[x].'". fc_intentions summons fc_argue, fc_stepaside, fc_lastchance. fc_intentions suggests fc_stepaside. 

Instead of discussing fc_argue when bitter lover or shattered lover or enemy: say "'No more play!' Progue screams at you. 'No more poisoned words, misfit logic, bare cruelties; we end us here and now.'"; force discuss fc_fight.

Understand "argue" as fc_argue when last beat is in FC. fc_argue is an insistent beat in FC with keyword name "argue" and reaction "'I know what I know more than anything known in lifetimes,' he replies, [archetype message], '[if submission of Progue < 0]so you're spending your time on nothing. But very well. I can indulge you[otherwise]but you've always gotten your way before, so I suppose we'll have to talk it through. Very well[end if]. Do you suppose you're somehow more [fc_qualified] to make the choice than me? That the [fc_stakes] are higher for you? That you [fc_deserve] the choice more than I? Or,' he says, stepping closer, 'are you just opposing me from pure [fc_spite]?'". fc_argue suggests fc_spite. fc_argue summons fc_qualified, fc_stakes, fc_deserve, fc_spite.

Understand "qualified" as fc_qualified when last beat is in FC. fc_qualified is a beat in FC with keyword name "qualified" and reaction "'Trash,' he says angrily, 'I spent months building that machine up there, salvaging the Egg for parts, experimenting and reworking. Oh, certain they were helping me, [if side_Progue_picks is 0]cunning whispers of what to try next, which wire to which, egging me along for their own amusement[otherwise]guiding me to see which wires to use, which connections to make[end if], but without my knowledge and my hands it would never have happened. You just came along and figured out how to switch it back on.'[paragraph break]'Convinced?' he says. 'Will you let me pass?'". fc_qualified suggests fc_stepaside. fc_qualified summons fc_stepaside, fc_lastchance. The yes-beat of fc_qualified is fc_stepaside. The no-beat of fc_qualified is fc_lastchance.

Understand "stakes" as fc_stakes when last beat is in FC. fc_stakes is a beat in FC with keyword name "stakes" and reaction "He grabs you, throws you up against a boulder. 'I lost my daughters,' he screams, 'the decision drove me mad and I forgot them, and they left me, they left me...' He breathes deeply,' as they should have. You've helped me remember, [animal-nickname], for that I'm grateful. But this is my decision. What have you lost?' he asks bitterly, 'What have you lost?'". fc_stakes summons fc_rume. fc_stakes suggests fc_nostakes.

Understand "Rume" as fc_rume when last beat is in FC. fc_rume is a beat in FC with keyword name "Rume" and reaction "He looks away. 'Not the same,' he says. 'You lost [himher] before you even came here. I lost my wife before I came as well. But because of what happened I lost the rest of my family as well.'[paragraph break]'It's my decision, and I choose [if side_Progue_picks is 0]City[otherwise]Forest[end if],' he says. 'Let me pass.'". fc_rume suggests fc_stepaside. fc_rume summons fc_stepaside, fc_lastchance. The yes-beat of fc_rume is fc_stepaside. The no-beat of fc_rume is fc_lastchance.

fc_nostakes is a beat in FC with reaction "'That's right,' he says, 'it's my decision, and I choose [if side_Progue_picks is 0]City[otherwise]Forest[end if]. Let me pass.'". fc_nostakes suggests fc_stepaside. fc_nostakes summons fc_stepaside, fc_lastchance. The yes-beat of fc_nostakes is fc_stepaside. The no-beat of fc_nostakes is fc_lastchance.

Understand "deserve" as fc_deserve when last beat is in FC. fc_deserve is a beat in FC with keyword name "deserve" and reaction "'What, because without the [fc_Call] this would never have happened?' he demands angrily. 'I would have stayed a madman, kept shouting words into the ocean so I didn't forget them, as the holes in my mind grew larger and larger until I slipped and vanished into them entirely?' He breathes deeply. 'Yes it's true you saved me from that, brought me back from the edge. But for what, if not to finish what I started?'". fc_deserve suggests fc_stepaside. fc_deserve summons fc_stepaside, fc_lastchance.

Understand "call" as fc_call when last beat is in FC. fc_call is a beat in FC with keyword name "Call" and reaction "[if The-Path-Of-Love has happened]'The Call,' he mutters, slow realization dawning over his face, 'Something Further, the Call. I did Call you. But twenty years ago. And you didn't answer. When I first was asked to choose between two civilizations, when I was going mad from the pressure, when Phoebe and Lethe needed me, I cried out with all my inner voice for help. And you heard me, didn't you? But you didn't answer.' He takes a deep breath, staring at you in fury. 'You didn't answer, and so for twenty years I lingered in madness, slowly forgetting everything, the decision, the windsigh, even my own daughters... you came too late, [animal-nickname], too late, too late...[otherwise]'Yes and don't you see?' he snaps angrily. 'You were Called here to help me. You're not the hero of this story; it's me, Progue; I'm the hero. You've helped me, and now your part is done. Step [fc_stepaside] and let me do what I must. Don't stand in my [fc_lastchance].[end if] Let me help the [if side_Progue_picks is 0]people of City[otherwise]builders and thinkers of Forest[end if] rise to ascendancy.'". fc_call suggests fc_stepaside. fc_call summons fc_stepaside, fc_lastchance

Understand "spite" as fc_spite when last beat is in FC. fc_spite is a beat in FC with keyword name "spite" and reaction "[if affinity of Progue < 0]'I'd expect nothing less from someone like you,' he says with a snarl[otherwise]'I expected so much more from you,' he says with a sad sigh[end if].". fc_spite enqueues fc_lastchance.

Understand "way/resist" as fc_lastchance. fc_lastchance is a beat in FC with keyword name "[if last beat is fc_call]way[else]resist" and reaction "'Last chance,' Progue says, stepping forward threateningly. 'Either step [fc_stepaside] and let me do what I know is right, or [fc_fight] and I'll have to use force to do it. The choice is yours.' He stares at you, [archetype message].". fc_fight replaces fc_lastchance. fc_lastchance summons fc_stepaside, fc_fight. fc_lastchance suggests fc_stepaside.

Understand "resist" as fc_fight when last beat is in FC. fc_fight is a beat in FC with keyword name "resist" and reaction "[if lover or shattered lover or twitterpated]'What an end to us,' he says, tears fighting with anger for control over his eyes, 'of all ends to have.'[otherwise if father knows best or neurotic dad]Progue's eyes harden. 'So much potential in you,' he says bitterly, 'I once thought-- no. You've learned nothing, and now it's come to this.'[otherwise if disciplinarian or bitter dad]His eyes narrow. 'Such a disappointment,' he says, 'very well. You've meddled in this long enough.'[otherwise if enemy or slave or bitter lover or toady]Progue snarls, his eyes filling with hatred.[else]His face hardens, hurt and betrayed. 'For life and strife, I wish this didn't have to happen,' he says, 'but lie assured, it will.'[end if] Then, with surprising speed, he leaps at you and knocks you to the ground. You quickly stagger back up, and begin circling him warily.". fc_fight summons fc_tackle, fc_punch, fc_kick. After discussing fc_fight: now bye beat of Final Confrontation is fc_fightleave; now abruptbye beat of Final Confrontation is fc_fightleave; continue the action. [This beat and the other fighting beats below don't suggest anything, because of the "fight overrules boredom rule" below.]

[
The fight is basically rock paper scissors, with the twist that a losing player can cheat.

Tackle beats punch
Punch beats Kick. 
Kick beats tackle
Rock beats anything.
]

Understand "tackle" or "tackle Progue" as fc_tackle when last beat is in FC. fc_tackle is a repeatable beat in FC with keyword name "tackle" and reaction "[Pfightchoice]You charge Progue [if Progue is tackling]just as he charges you, and the two of you collide heavily, staggering backwards with no ground gained on either side[otherwise if Progue is punching]as he pulls back to swing a punch at you, and tackle him heavily to the ground, pushing him back a few feet. He staggers quickly to his feet[fightplayerscores][otherwise]but he kicks you square in the chest, knocking you back a few feet. You quickly jump up again as he advances[fightProguescores][end if][pfighthint].". fc_tackle summons fc_tackle, fc_punch, fc_kick. After discussing fc_tackle: now tempfuse of fc_tackle is 5; process fight stuff; continue the action.

Instead of attacking progue when last beat is in FC, force discuss fc_punch. fc_punch is a repeatable beat in FC with keyword name "punch" and reaction "[Pfightchoice]You swing your fist at Progue [if Progue is tackling]but he is charging towards you, and slams into you before you can connect, knocking you to the ground. You stagger backwards a few feet and leap up, shaking your head[fightproguescores][otherwise if Progue is punching]just as he does the same at you; your blows connect ringingly but you each keep your ground[otherwise]as he tries to kick you in the chest, but your blow connects and he staggers back, clutching his face in pain[fightplayerscores][end if][pfighthint].". fc_punch summons fc_tackle, fc_punch, fc_kick. After discussing fc_punch: now tempfuse of fc_punch is 5; process fight stuff; continue the action.

Understand "kick" or "kick progue" as fc_kick. fc_kick is a repeatable beat in FC with keyword name "kick" and reaction "[Pfightchoice]You aim a harsh kick at Progue's chest[if Progue is tackling] just as he leaps towards you to tackle; the blow connects and he staggers back, clutching his chest[fightplayerscores][otherwise if Progue is punching], but he dodges and delivers a solid punch to your face; you stagger a few steps back, trying to recover[fightProguescores][otherwise] just as he kicks at yours; your blows both miss and you each recover your positions, not gaining or losing any ground[end if][pfighthint].". fc_kick summons fc_tackle, fc_punch, fc_kick. After discussing fc_kick: now tempfuse of fc_kick is 5; process fight stuff; continue the action.

Understand "rock" as fc_rock when last beat is in FC. fc_rock is a beat in FC with keyword name "rock" and reaction "You scrabble for the rock, holding it up threateningly. It is large and heavy enough to kill.[paragraph break]Progue snarls angrily at you. 'Can't win in a fair fight, so you want to cheat?' he says. 'Doesn't matter. I'll still beat you.'". fc_player_wins_violently replaces fc_rock. After discussing fc_rock when fc_player_wins_violently is unspoken: move fight-rock to player; now tempfuse of fc_player_wins_violently is 50; continue the action.

To say pfighthint:
	if a random chance of 1 in fightpacer succeeds:
		now progue-fight-preordained is true;
		let chc be a random number between 1 and 3;
		if chc is 1:
			now progue-fight-move is 0;
			say ". He hunkers down, preparing for a charge";
		otherwise if chc is 2:
			now progue-fight-move is 1;
			say ". He prepares to kick";
		otherwise:
			now progue-fight-move is 2;
			say ". He pulls back for a punch";
	otherwise:
		now progue-fight-preordained is false.

To say Pfightchoice:
	if progue-fight-preordained is true or a random chance of 1 in fightpacer succeeds: [Progue can sometimes predict your move.]
		if we are discussing fc_tackle, now progue-fight-move is 1;
		if we are discussing fc_punch, now progue-fight-move is 0;
		if we are discussing fc_kick, now progue-fight-move is 2;
	otherwise:
		let chc be a random number between 1 and 3;
		if chc is 1, now progue-fight-move is 0;
		if chc is 2, now progue-fight-move is 1;
		if chc is 3, now progue-fight-move is 2.

progue-fight-move is a number that varies. progue-fight-preordained is a truth state that varies.

To decide whether Progue is tackling:
	if progue-fight-move is 0, yes; no.

To decide whether Progue is kicking:
	if progue-fight-move is 1, yes; no.

To decide whether Progue is punching:
	if progue-fight-move is 2, yes; no.

fightscore is a number that varies. To say fightplayerscores: increase fightscore by 1. To say fightProguescores: decrease fightscore by 1.

fight-counter is a number that varies.

To decide what number is fightpacer: [Increase the odds of the fight being rigged as we go forward, so this doesn't become interminable.]
	if fight-counter < 3, decide on 4;
	if fight-counter < 6, decide on 3;
	if fight-counter < 9, decide on 2;
	decide on 1.

To process fight stuff:
	increase fight-counter by 1;
	if fightscore < -2:
		say "Progue knocks you to the edge. You stumble, arms wheeling, then collapse, clutching carefully at the narrow sharp ridge of lava rock. Progue towers over you, victorious.";
		force discuss fc_surrender;
	otherwise if fightscore > 2:
		say "You knock Progue back to the lip of the drop-off.";
		force discuss fc_player_wins;
	otherwise:
		let tempfightscore be fightscore;
		if tempfightscore < 0, now tempfightscore is tempfightscore * -1;
		now tempfightscore is 3 - tempfightscore;
		if tempfightscore is 3, say "You circle warily, neither one with an advantage.";
		else say "[if fightscore > 0]Progue is[otherwise]You are[end if] [if tempfightscore is 2]a few steps[else]just one step[end if] away from the [one of]drop-off, the knife-sharp edge of the lava cliff above the churning sea[or]edge[stopping].";
		if a random chance of 1 in 2 succeeds, force discuss the taunt-beat;
		if fightscore < -1 and fight-rock is not held:
			say "[line break]Near your feet, you spy a fist-sized [t]rock[x].";
			now tempfuse of fc_rock is 50;
			move fight-rock to location.

Instead of discussing fc_kick when fightscore > 2: process fight stuff. Instead of discussing fc_punch when fightscore > 2: process fight stuff. Instead of discussing fc_tackle when fightscore > 2: process fight stuff.

The fight overrules boredom rule is listed before the episodes overrule getting bored rule in the before rules. Before getting bored when last beat is fc_kick or last beat is fc_punch or last beat is fc_tackle or last beat is fc_rock or last beat is fc_fight (this is the fight overrules boredom rule):
	extend beats;
	say "Progue [one of]kicks you hard[or]punches you[or]tackles you[in random order], pushing you farther back[fightProguescores]." instead.

The taunt-beat is a beat that varies. The taunt-beat is fc_fighttaunt1.

The fight-rock is an undescribed thing. Understand "rock" as the fight-rock. The printed name is "heavy rock". Instead of taking the fight-rock, force discuss fc_rock. Instead of examining by name the fight-rock when fight-rock is held, force discuss fc_rock. The description is "It will do.". Instead of dropping the fight-rock: say "You let it fall from your hands. He's right; you can't do it."; now tempfuse of fc_rock is 0; move fight-rock to Rise. Instead of examining by name the fight-rock when fight-rock is not held: try taking the fight-rock.

fc_fightleave is a repeatable dogged beat with reaction "You struggle to escape, but Progue trips you, raining blows down and driving you farther back.[fightproguescores]". 

[Before attacking Progue when last beat is fc_punch or last beat is fc_kick or last beat is fc_tackle, say "You'll have to specify a tactic: [if fight-rock is held][t]rock[x], [end if][t]punch[x], [t]kick[x], or [t]tackle[x]." instead.]

fc_fighttaunt1 is an ephemeral beat in FC with reaction "'When you came I didn't know, know what to make of you,' he says, circling warily. 'How you fit in. What part you were meant to play.' He lashes out and you twist aside, warily.". fc_fighttaunt2 replaces fc_fighttaunt1.

fc_fighttaunt2 is an ephemeral beat in FC with reaction "'Then,' he says, breathing heavily, 'I wondered. Mayhaps, mayhaps you're not a character in my story. No. Mayhaps I'm a character in yours.' He weaves cautiously from side to side.". fc_fighttaunt3 replaces fc_fighttaunt2.

fc_fighttaunt3 is an ephemeral beat in FC with reaction "'And so sure you are it isn't so,' he shouts, dancing from foot to foot, 'never stopped to wonder, all and always assumed that you were the hero, the noble hero in the story of Lacuna. But you're not.' He wipes sweat from his brow. 'You aren't. It's me. I'm the hero. This is my story.'". fc_fighttaunt4 replaces fc_fighttaunt3.

fc_fighttaunt4 is an ephemeral beat in FC with reaction "'You're the agent of my change,' he shouts, ducking a swipe, 'the mystery stranger, the mentor, the summons to action. You made me realize what it is I must do. And I have. The savior of [if side_Progue_picks is 0]City[else]Forest[end if]; that's the protagonist. He's the hero. And it's me. It's me, it's me, it's me!'". fc_fighttaunt5 replaces fc_fighttaunt4.

fc_fighttaunt5 is an ephemeral beat in FC with reaction "'And you,' he shouts, flinching at a move from you, 'you're the villain, don't you see? And this is the moment, the scene, the climactic pinnacle where you challenge me. And I survive. I survive.'". fc_fighttaunt6 replaces fc_fighttaunt5.

fc_fighttaunt6 is an ephemeral repeatable beat in FC with reaction "'[one of]Let it go[or]Stop it[or]Leave me alone[at random]!' he [one of]shouts[or]snarls[or]spits[or]cries[at random], circling you, [one of]anger marring his face[or]desperate[at random]. '[one of]Stop trying to be the hero! Give me back my story![or]It's my story, not yours! Not yours![or]You've got to give the story back to me![at random]'".

Understand "rock" as fc_player_wins_violently when last beat is in FC. fc_player_wins_violently is a beat in FC with keyword name "rock" and reaction "Progue's eyes dart to the rock; he licks his lips as he circles you. Then lightning-quick he dives for your waist, but faster, faster you bring the rock down and it connects with his skull and he cries out, collapses, crumples to the ground and shudders and moans.". fc_player_wins_violently enqueues ending_2c1. 

fc_player_wins is a beat in FC with reaction "Progue stumbles on the edge, arms spinning wildly, eyes wide in terror, then slips and falls. Faster than lightning you grab his hand; the sea breeze almost slicks him away from you, but he grips with renewed strength and you dig your feet into the rock and at last you pull him back up to the ledge.".

After discussing fc_player_wins: 
	if shattered lover or bitter lover or slave, force discuss ending_2b2; [ suicide ]
	otherwise force discuss ending_2b1. [choose or get off the pot]


Understand "aside/relent" as fc_stepaside. fc_stepaside is a beat in FC with keyword name "[if last beat is fc_lastchance]aside[else]relent" and fuse 35 and reaction "[if affinity of Progue > 0][relentthanks][otherwise][relentnothanks][end if].[paragraph break][proguegoes]". fc_stepaside enqueues fc_Progue_returns. fc_stepaside cancels fc_tackle, fc_punch, fc_kick.

To say proguegoes: say "You watch as he [if chairlift has power]climbs into the chair of the ropeway and rides the coffin-shaped box up the swooping arcs to the mountain's summit, higher and higher above the swamp[else]crosses the swamp and begins the long climb up the crack to the distant summit[end if], then you turn your back and sit to wait, watching the ocean heave and glimmer in starlight.[paragraph break]Long minutes pass.".

To say relentthanks: say "[if fc_kick is spoken or fc_punch is spoken or fc_tackle is spoken]He pauses, breathing heavily, still crouched for a fight. [end if]'You relent?' he says warily, 'you'll let me pass, go up and set the seiver for [if side_progue_picks is 0]City[else]Forest[end if]?' You nod.[paragraph break]He stands to his full height, wiping sweat from his bow, and nods back. 'Thanks then,' he says. 'It's finally time for me to do what I must.' And he passes by you towards the stumps, slowly but assuredly".

To say relentnothanks: say "[if fc_kick is spoken or fc_punch is spoken or fc_tackle is spoken]He pauses, breathing heavily, still in fight posture. [end if]'You relent?' he says warily, 'you'll let me pass, go up and set the seiver for [if side_progue_picks is 0]City[else]Forest[end if]?' You nod.[paragraph break]He stands to his full height, wiping sweat from his brow, then brushes past you angrily, not meeting your eye. 'Now I will do what I must,' he mutters".

Understand "surrender" or "give up" or "you win" or "stop fighting" or "stop struggling" or "uncle" or "mercy" as fc_surrender. fc_surrender is a beat in FC with reaction "A long moment passes between you of deep and heavy breaths.[paragraph break]Then, he stands, and backs away.[paragraph break]'It's over,' he says simply. 'And I must go do what I couldn't do before.' Turning, he walks down towards the stumps and vanishes into the hot wet night, drunk by blackness and silence.". fc_surrender cancels fc_tackle, fc_punch, fc_kick.  [bug: should be this instead of relent.] 

After discussing fc_surrender:
	if mind machinery is off-stage:
		[if slave or bitter lover or shattered lover, force discuss ending_2b2;
		else]
		force discuss ending_2b1;
	else:
		force discuss fc_progue_returns.

To decide whether confro-lie: [If the player lied to Progue about which side was chosen]
	if fc_chose_forest is spoken and end-rebels, yes;
	if fc_chose_city is spoken and end-trees, yes;
	no.



side_Progue_picks is a number that varies. side_Progue_picks is -1.

To say Proguesidechoice:
	if fc_chose_forest is spoken:
		now side_Progue_picks is 0; [city]
	else if fc_chose_city is spoken:
		now side_Progue_picks is 1; [forest]
	else if father knows best or disciplinarian:
		now side_Progue_picks is 1; [trees]
	else if slave or bitter lover:
		now side_Progue_picks is 0; [rebels]
	else if a random chance of 50 in 100 succeeds:
		now side_Progue_picks is 1; [trees]
	else:
		now side_Progue_picks is 0; [rebels]
	say "[if side_Progue_picks is 0]City[else]Forest[end if].' He stops for a moment, then takes a deep breath, confidence suddenly flooding him. 'I'm sure of it".

Understand "neither" as fc_ask_why_not when last beat is in FC. fc_ask_why_not is an insistent repeatable beat in FC with keyword name "[if last beat is fc_ask_which_side]neither[else]no" and reaction "He looks surprised. 'What's this?' he says. 'But that's not an answer. Not a choice. What do you mean by this? You need more [fc_moretime], or something thatwise? Or you somehow, somewhy [fc_reject_choice] the act of choosing? Or... or does this mean you mean for me to [fc_breakdown] instead?'". fc_ask_why_not summons fc_moretime, fc_reject_choice, fc_breakdown. fc_ask_why_not suggests fc_moretime.

fc_have_to_choose is an ephemeral beat with reaction "His brow creases and he steps forward, gripping your arm tightly. 'Can't wait,' he says, 'it's been too, too long already. No more tremblings and second-guesses and puttings-off. It's time, tonight. The choice must and must and must be made. Now.'". fc_have_to_choose enqueues fc_ask_which_side.

Understand "time/more" as fc_moretime when last beat is in FC. fc_moretime is a beat in FC with keyword name "time" and reaction "'More time?' he says, [archetype message]. 'More time? Twenty years have been and gone since they asked, twenty years the decision's been twisting inside me, dissolving through bone and brain and bile till I forgot it even existed. But it was always there, simmering, waiting. No. There is no more time. The choice must be made. Now and here and always.'". fc_moretime enqueues fc_ask_which_side. fc_ask_which_side replaces fc_moretime.

Understand "reject" as fc_reject_choice when last beat is in FC. fc_reject_choice is a beat in FC with keyword name "reject" and reaction "'Can't do that,' he shouts, angry, 'no, can't escape this. You think somehow we're not the ones to choose?' he says. 'Some moral high ground too ragged to climb? Sausages. Don't you see, we're the only ones... there's no one else... it's why we're here, don't you see? Our purpose, destiny, calling. They Called us here, to choose, to decide, to do what's right. And we must and must and must.'". fc_reject_choice enqueues fc_yourewrong. After discussing fc_reject_choice: now end-abstain-trigger is 1; continue the action.

Understand "choose" as fc_breakdown when last beat is in FC. fc_breakdown is a beat in FC with keyword name "choose" and reaction "He staggers back, as if you'd physically struck him, gasping with his eyes and trembling in his chest.[paragraph break]Then, he starts to laugh.[paragraph break]'No,' he says, weak, 'no, no, no. Not what's supposed to happen. You're the one, you're the one who's meant, who's destined to...' The laughter curdles into desperate, sobbing gasps. 'I can't,' he whispers, 'you can't make me. I couldn't, I could never... and now, and now, and now...'[paragraph break]He looks around him, spinning wildly, frantically, as if searching for someplace to run and hide.". fc_breakdown enqueues fc_breakdown2.

Before discussing fc_breakdown: if enemy or shattered lover, now fc_breakdown enqueues fc_fight; continue the action.

fc_breakdown2 is a beat in FC with reaction "But there is nowhere.[paragraph break]He takes a few steps towards you, then collapses to his knees, reaching out a hand, face contorting in pain. You grasp his hand and some electric edge slashes through you and you also collapse, sprawled next to him on the unyielding ripples of the hardened lava, only his hand still real in your mind. You feel the whorls of his fingerprints pressing into yours; the trembling strength of muscles straining and twisting between bone and sinew; the energy in his fingertips and wrists straining to be released from a cage which has imprisoned them for half a lifetime.[paragraph break]For long moments he gasps as if winded, trembling, as strange power or perhaps only empathy flows between your grasped, taut hands.[paragraph break]Then, finally, his breathing slows, and so does yours. You struggle to your feet, and pull him up to his. Your hands release with what seems like a spark, of something not quite electric.". fc_breakdown2 suggests fc_progue_departs.

fc_Progue_departs is a beat in FC with reaction "[paragraph break]'Something Further,' he breathes, 'all right. And all right. I'll go. The choice is mine and mine to make, and so I'll do it. I'll do it. I will.'[paragraph break][proguegoes]". fc_Progue_departs enqueues fc_Progue_returns. After discussing fc_Progue_departs: now end-abstain-trigger is 1; continue the action.



[ Progue makes the choice. ]

fc_Progue_returns is a beat in FC with reaction "[section break]By the time he returns, you've become so lost in your own thoughts that you don't notice him, until he steps onto the ridge just behind you. You turn, expectant, and wait.".

After discussing fc_Progue_returns:
	if confro-lie:
		force discuss ending_2a1;
	else if friend or lover:
		force discuss ending_1b;
	else if father knows best or disciplinarian:
		force discuss ending_1c;
	else if slave or bitter lover:
		force discuss ending_1d;
	else:
		force discuss ending_1a;
	continue the action.

fc_lost_choice is a beat in FC with reaction "He closes his eyes, breathing ragged. 'Too long,' he mutters, 'I waited too long, and now my chance has slipped away, and someone else will make my choices for me.'".


[Ending 1a: Progue is forced to choose and decides to destroy the machinery.]

ending_1a is a terminal beat in FC with reaction "'It's done,' he whispers, 'at last, it's done. What I should have done all and all those years ago. What I should have done from the start.'[paragraph break]He looks down at his hands, and you see they are trembling, marred with scratches and bruises, still clenched in claws.[paragraph break]'I destroyed it,' he whispers, 'the seiver, the mindlink, the pipes, the chair. Gone, smashed. Undone. Should never have built them in the first place. Should never have let them do to me what they did, ask of me what they asked. We came here to heal, not to be an arbitrer of civilizations. No. Now they must solve their own problems, work out their own differences. Just as if I'd never come here. Just as it should be.'[paragraph break]He turns to walk away, then pauses, looking down at the black lava flow. 'They are alone now in the universe,' he says, 'with no one to help them. Like us all.' And he turns and walks down to the darkened beach, alone.".

[Ending 1b: Progue is forced to choose and decides to remove the encryption; let the best side win.]

ending_1b is a beat in FC with reaction "He thinks for a long, long moment, before finally looking up. 'So many years I agonized over the choice. Which side was better or worse, good or bad, right. Wrong. But in the end I never saw the real choice. Whether or not to choose at all.'[paragraph break]He looks up into the sky, tears welling in his eyes, and sighs, long and deep. '[if fc_both is spoken or fc_ask_why_not is spoken]You were right,' he says finally, calmly. '[end if]There is no right or wrong until we choose which one is which. Who are we to choose between worlds, between peoples? No. We are special, you and I, but this is not our calling. We cannot decide the fate of those people. They must make their own choices, solve their own problems.'[paragraph break]'I reject the choice,' he says, conviction trembling his tones as he looks back down to meet your gaze. 'I set the encryption key to something neither of them know. We'll go and look at the stars, you and I, and they'll both get meaningless noise. Whichever side has the courage, the intelligence, the luck, to decode it first...' He smiles. 'Lacuna is theirs.'[paragraph break]He breathes deeply. 'It's the right choice. Thank you. Thank you for helping me find it.'". ending_1b enqueues fc_comewith.

[Ending 1c: Progue is forced to choose and picks Forest.]

ending_1c is a beat in FC with reaction "'If I were a poet,' he says simply, staring into the stars, 'I'd give this galaxy to City. There is romance in their struggle, something stirring in their beautiful dreams of what might be.'[paragraph break]He looks down at you, sighing. 'But they cannot live on dreams,' he says. 'They would destroy this world in their mad rush to progress, if they did not destroy themselves in getting here. No. In the end, dreams are not enough.'[paragraph break]'I chose Forest,' he says, trembling, in a sudden catharsis of words. 'I choose Forest, Forest. Oh, after so long. But it's the right choice. I know that now.' He breathes, deeply. 'And I cry for the dream of City. But Forest has earned the galaxy. They will bring peace to it, and beauty, and order.'[paragraph break]He nods, and a smiles, sudden, unexpected, a smile to break hearts. 'After all this time,' he whispers, 'they will bring order, at last.'". ending_1c enqueues fc_comewith.

[Ending 1d: Progue is forced to choose and picks City.]

ending_1d is a beat in FC with reaction "'The windsigh are wise,' he says, staring down at his fingers as if lost in the eddies and whorls of their prints. 'Oh, yes. And their forest is beautiful. They deserve to be the custodians of this galaxy, by rights. Mayhaps they should.'[paragraph break]He looks up, tears in his eyes. 'But their children are lost,' he says, 'and frightened. Alone. And they'll never grow up unless given the chance.'[paragraph break]'I chose City,' he says, trembling, in a sudden catharsis of words. 'I choose City, City, City. Oh, after so long. But it's the right choice. I know that now.' He takes a deep breath. 'The windsigh will be angry, but... they have to let their children go.'[paragraph break]He nods, looking up to the stars and smiling, sudden, unexpected, a smile to break hearts. 'After all this time,' he whispers,' they have to let them go.'". ending_1d enqueues fc_comewith.

[Ending 2a1: The player lied to Progue, forcing him to fight for the side you'd already picked; he comes back humbled.]

ending_2a1 is a beat in FC with reaction "'He looks down at the black lava flow, hesitates, a corner of his mouth rising slowly. 'And think and imagine my surprise,' he says, 'when after all my passionate arguments against [if end-trees]City[else]Forest[end if], all my pleadings to change your mind to [if end-trees]Forest[else]City[end if]-- when I reach the mountaintop and discover it was [if end-trees]Forest[else]City[end if] you chose after all.'[paragraph break]He looks up at you, seriously. 'You made me fight for what I knew to be right,' he says, 'rather than just tell me your choice. Thank you. It was the only way you could have convinced me of what I already believed, in my heart.'". ending_2a1 enqueues fc_playeralonestars.

[Ending 2b1: Progue loses the fight (or wins and doesn't know what he's fighting for) and realizes that by failing to make the choice for so long he has lost the opportunity to make it. Choose or get off the pot.]

ending_2b1 is a beat in FC with reaction "He lies, breathing hard, eyes shut, for a long time.[paragraph break]'At last and last, I see,' he finally says, quiet and still. 'I waited too long and lost the choice, the chance. Slipped through my fingers while for years I'd clenched them tight, hoarding... and now the choice is yours. You've caught it, and my hands... my hands are open, and empty.'[paragraph break]He sighs heavily, slow, sad. 'Thank you,' he says at last. 'Now I see. Now I know. Mayhaps now... now I can find what I've truly lost, these long and maddening years.'". ending_2b1 enqueues fc_playeralonestars.

[Ending 2b2: Progue loses the fight (or wins and doesn't know what he's fighting for) but has been emotionally destabalized enough that not being able to resolve this pushes him over the edge and he kills himself.]

ending_2b2 is a beat in FC with reaction "His face contorts in an impossible paroxysm of rage and fear. '[if fc_chose_forest is unspoken and fc_chose_city is unspoken]No one can choose! The choice will never be made![else]You can't take this from me! It's my choice, mine, mine![end if]' he screams, hoarse, flinging himself away from you and teetering on edge of the rise. 'I won't choose wrong again, never, never, never...' And before you can stop him he falls, twisting, spiraling akimbo through the salty breeze until his body smashes on the rocks below[Proguedies].[paragraph break]A wave washes in, slow, great, and when the surging foam retreats, he is gone.". ending_2b2 enqueues fc_playeralonestars.

[Ending 2c1: The player wins the fight violently by killing Progue with a rock. Progue realizes he is not the hero of the story and you are destined to get your way, and dies. ]

ending_2c1 is a beat in FC with reaction "Staggering, he clutches his head. Blood seeps between his fingers. He collapses to the ground, whispering something other and over again to himself, and as you move to help him you hear it is 'Over now, over now, over now...'[paragraph break]You lay him down on the ground and know he will not survive.[paragraph break]Clutching your hand weakly, eyes blurring, he smiles. 'It's over,' he breathes, 'at the last of lasts, it's over. The choice is made. You made it. It's you. You're the hero. Not me. No. It was never me. Something Further, it was never me.'[paragraph break]He struggles to breathe now, a red pool of blood mixed with seawater spreading beneath him.[paragraph break]'Go,' he says at last, 'climb the tree, see the stars. Finish the story. Mayhaps...' He coughs, blinks growing longer and longer. 'Mayhaps now at last I'll find my daughters, at last and last and last...' His eyes drift closed, and he grows still.[paragraph break]'How many worlds,' he mutters, and falls silent[Proguedies].". ending_2c1 enqueues fc_playeralonestars. After discussing ending_2c1: remove fight-rock from play; now tempfuse of fc_player_wins_violently is 0; continue the action.

To say Proguedies:
	move proguecorpse to location;
	if ending_2b2 is spoken, move proguecorpse to Your Bedroom; [onstage but inaccessible]
	post-conversation processing;
	remove Progue from play.

proguecorpse is a described prop. Understand "progue/old/man/progues/progue's/corpse/body" as proguecorpse. The printed name is "Progue's body". The description is "He's gone." The initial appearance is "Progue lies here, dead." Instead of taking proguecorpse, say "You'll give him a proper burial later. Now, there is only one thing left for you to do.". Check waking proguecorpse: say "He's dead." instead.

Before discussing fc_playeralonestars:
	if mind machinery is off-stage:
		force discuss fc_destroyed instead;
	else if Progue is dead:
		force discuss fc_deathaftermath instead;
	else if fc_chose_forest is unspoken and fc_chose_city is unspoken:
		force discuss fc_choosenow instead.

fc_deathaftermath is a terminal beat in FC with reaction 	"Sudden weariness sinks over you. Now the choice truly does fall to you.[paragraph break]When you're ready-- all that remains is to look at the stars. Or, if you choose not to-- sleep.". After discussing fc_deathaftermath: post-conversation processing; continue the action.

fc_choosenow is an insistent beat in FC with reaction "'Well,' he says, 'after all that, are you going to make a choice now?'". fc_choosenow summons fc_choosenowcity, fc_choosenowforest, fc_choosenowno. fc_choosenow cancels fc_punch, fc_tackle, fc_kick, fc_rock. The no-beat of fc_choosenow is fc_choosenowno. After discussing fc_choosenow: if Progue is dead, post-conversation processing; continue the action. [Note that if Progue is dead conversation will end since there is no one to talk to.]

Instead of sleeping when fc_choosenow is spoken or Progue is dead: force discuss fc_endsleep.

Understand "city" as fc_choosenowcity when last beat is in FC. fc_choosenowcity is a beat in FC with keyword name "City" and reaction "[finalchoice]. They'll use this place well, I suppose. One day cities will rise from the marsh; art galleries will thrive in the caldera; that silly old cabin on the beach some historic landmark, the paintings preserved forever. They'll fill this world with noise and laughter and people, free, triumphant, together. And Lacuna will finally belong to someone.'". fc_choosenowcity enqueues fc_playeralonestars.

Understand "forest" as fc_choosenowforest when last beat is in FC. fc_choosenowforest is a beat in FC with keyword name "Forest" and reaction "[finalchoice]. They'll shephard this place with care, I suppose. Turn it into another beautiful grove in their endless forest. My cabin, the ropeway, the pipes and sculptures and paintings, will crumble slow and true to fodder for their roots. And their song will ring round this island, this world. Forever.'". fc_choosenowforest enqueues fc_playeralonestars.

To say finalchoice: say "'He sighs. 'There, you see,' he says. 'In the end it wasn't so hard as all that".

fc_choosenowno is a beat in FC with keyword name "no" and reaction "'Well,' he says, 'then that's that. Mayhaps for the best. They'll wonder, you know, what keeps happening to their strange emissaries, appearing and disappearing with mechanisms and motives they can't begin to comprehend. Ah well-oh. That's our way, isn't it? That's our way.'". fc_choosenowno enqueues fc_endsleep.

fc_destroyed is a beat in FC with reaction "Nothing is left to be done.". fc_destroyed enqueues fc_endsleep.

fc_endsleep is a terminal beat in FC with reaction "And suddenly you feel tired, an ache of exhaustion, and you sink to your kness and can't remember a time when you slept real, unwhispered sleep, a time when your dreams were only your own. As your cheek touches the still-warm [surface-material], as the night sky shows faint hints of dawn to the east, sleep finally finds you, before your eyes have finished closing. You sink into it or let it sink into you, deep and complete.". After discussing fc_endsleep: now end-abstain-trigger is 1; now ep-trigger is true; continue the action.[aar]

fc_playeralonestars is a terminal beat in FC with reaction "'I need rest,' he says slowly, 'so much rest. But. But I'll watch while you go perform the final act. Up and up, to the tallest tree, to see the stars, send the map. Finish the story.' He sinks to the ground. 'Go now. Go. They've waited long enough.'". After discussing fc_playeralonestars: now the psyche of Progue is resolved; post-conversation processing; continue the action.

fc_comewith is an insistent beat in FC with reaction "'Only one thing left,' he adds, 'climb the highest tree and look. See the stars. Send the map. Well. Will you come with me?'". The yes-beat of fc_comewith is fc_togetherstars. The no-beat of fc_comewith is fc_proguealonestars. fc_comewith suggests fc_proguealonestars. fc_comewith summons fc_togetherstars, fc_proguealonestars.

fc_togetherstars is a terminal beat in FC with keyword name "yes" and reaction "'Good. We'll do it together,' he says. 'Lead the way.'". After discussing fc_togetherstars: now the psyche of Progue is resolved; continue the action.

Every turn when fc_togetherstars is spoken and Progue is not enclosed by location and location is regionally in Lacuna and Epilogue is not happening and Epilogue has not happened: move Progue to location; say "Progue follows you, wordlessly."; now the activity counter of Progue is 1; now Progue is fulfilling. 

Instead of greeting Progue when fc_togetherstars is spoken: say "There is nothing left to say.". 

Instead of going to Stumps when fc_togetherstars is spoken: prevent-endgame-complications. Instead of going to Jumble when fc_togetherstars is spoken: prevent-endgame-complications. Instead of going to Rockslide when fc_togetherstars is spoken: prevent-endgame-complications. Instead of going to Water Cave when fc_togetherstars is spoken: prevent-endgame-complications. To prevent-endgame-complications: say "Progue gently stops you. 'The time for choices is over,' he says. 'All that is left is to carry them out.'". First Instead of landmark-going when fc_togetherstars is spoken: say "For now, you'd best take things one step at a time.".

fc_proguealonestars is a terminal beat in FC with keyword name "no" and reaction "'I began this myself; I suppose I should finish it myself,' he says. 'And so I will.' And he turns and walks down the rise, leaving you alone.[paragraph break]You watch as he climbs the vine to the top of the saddle, then crane your neck back as he climbs to the top of the windsigh clinging to its summit.[paragraph break]And as he stands there, nearly lost in the blackness, silhouetted against the stars and a shimmering arm of the galaxy, you somehow know or sense something, profound and strong.[paragraph break]The Call, at last, is answered.".






To decide whether progue is dead: if proguecorpse is on-stage, decide yes; decide no. To decide whether Progue is not dead: if progue is dead, decide no; decide yes.

Endgame is a scene. Endgame begins when the episodic status of Final Confrontation is completed.

Check sleeping when Endgame is happening: say "You're tired, but you can't sleep yet. Not until it's done." instead.

Before going to Saddle during Endgame: move distant-Progue to Saddle.

Instead of examining stars when Endgame is happening and end-neither: say "You look and know that none but you sees through your eyes.". Instead of examining stars when the episodic status of Final Confrontation is not unaired and ( end-choice or end-both ) and location is not Atop: say "Not here. Too much of your view is obstructed, and the trees are too far away. Make for the top of the highest tree.".

Instead of examining the stars when Endgame is happening:
	say "Trembling in a sudden chill breeze, you raise your eyes to the stars and drink them in, let the ancient photons travel through your nerves deep into your mind. Behind the thousands of stars you can see, some wayfarish part of you feels the millions you can't. You almost imagine you can feel some tingle on the edge of perception, as the patterns and whorls of Lacuna's night sky seep from your mind to the branches around you, from the branches down into the trunk and through the link to [if end-both]the scientists, some Thinkers, some Makers on two distant worlds[otherwise if end-rebels]the band of desperate, hopeful scientists on a distant world[otherwise]the great, ancient minds on a distant world[end if] who await it.[paragraph break]You look for a long, long time.";
	now ep-trigger is true.


Volume - Tsunami (in Lacuna Tsunami by Blue Lacuna)

[ The tsunami is an event that is triggered by the player making progress along various fronts. It moves Progue to "uncertainty" and allows for dramatic shifts in his attitude towards the player. The Tsunami in turn provides more hints for moving the player along in the plot, such as the appearance of the left ear on the beach, allowing the player to decode various hints around the island.

1) The player hears a warbling horn noise coming from the beach one evening.

2) Investigating, you find Progue blowing on a huge conch shell which he says washed up. He says the tides are acting strange. He further mentions he's going to sleep up on the ledge.

3) The player awakens from sleep that night to an earthquake which lasts several turns.

-- During and after the earthquake, none of the power systems work, the springs stop flowing, the lava tunnel door swings shut (and can't be opened from the west side without light) and the bridge is stuck down. Also, the player is not allowed to go down into the ravine. So the only way to the west island is through the cabin on the beach. The player is not allowed to sleep on the North Island. If they were sleeping west of the cabin, there will be no way to go east, as it's too dark to open the door from that side.
-- Progue was sleeping on the Ledge. He tries to climb down during the quake but falls the last few feet and knocks himself unconcious.

4) A few rounds after the earthquake, the tides start going way, way, out. The player is  funneled towards Center Beach, at which point they receive a dramatic description of an onrushing tsunami. 

5) If after a certain amount of time the player has not gotten to Center Beach, or they did and then went back, a scene is triggered where they fall into a chasm or some other peril created by the earthquake. Progue appears after a few moments, offering to rescue. The player can free himself in a few rounds, or can accept Progue's help. In either case the two escape just in the nick of time.

6) If the player gets to Rise, we print another dramatic message mentioning Progue lying near the base of the cliff, and announce the water's imminent flooding of the marsh. If the player turns back here, scene 5 is triggered after a few rounds and we note that the player didn't try to rescue Progue. Otherwise, they can reach Progue, spend a few rounds reviving him, and then make it to the Rise or climb the pillar in the east marsh, all the while dogged by the rising tide. If they dally too long, they will be flooded, but manage to swim to safety; otherwise they make it to safety.

8) The next morning, we have a Debriefing Conversation with Progue, and then things return to normal (except:)

   -- The hurricane also has the result of washing the clockwork ear up on the beach, and subtly altering the landscape. 
   -- If the player had been to Saddle but not pushed the vine, it falls off the edge on its own.
   -- If the player did not solve the Secrets quest, the compass pops open on its own.
   -- Progue's psyche becomes uncertainty.
]


Progue is either carried or uncarried. Progue is uncarried.

Table of Progue's Initial Appearance (continued)
animus	episode			desc
--		Water Works	"[if the animus of Progue is resting and Progue Rescue is happening]Progue lies amidst the slime, unconscious. It looks like he must have fallen from halfway down the ledge[otherwise if Progue Rescue is happening]Progue struggles to maintain consciousness[otherwise if Player Rescue is happening]Progue leans over you, desperately reaching a [o]hand[x] out for you[end if]."
--		The Conch Portends	"Progue stands on the beach, holding an enormous conch shell in his hands, clumps of wet sand still clinging to it."

Table of Progue's Description (continued)
animus	episode		desc
--	Water Works	"[if Player Rescue is happening]Soaked, scratched, with a bruise spreading across his face, Progue reaches out a firm hand towards you with a strength that defies his years[otherwise if the animus of progue is resting]You quickly examine him. He does not seem to be seriously injured, just knocked out[otherwise]Other than being a bit dazed, he seems fine[end if]."


Tsunami Sequence is a scene.


Tsunami Sequence begins when
	( it is after 6:00 PM and
	it is before 6:50 PM and
	location is not regionally in Dreamlands and
	not exploring Progue's turf and
	tsun-conditions and
	the psyche of Progue is not denial ) or 
	tsun_tflag is 1.

To decide whether tsun-conditions:
	if The Conch Portends is completed, decide no;
	if the number of contacted windsigh trees >= 4, decide yes;
	if Egg Room is visited, decide yes;
	if there is a status of 0 in Table of Departure Quest begin; otherwise; decide yes; end if;
[	if desperate for excitement, decide yes;]
	decide no.

When Tsunami Sequence begins:
	now dont_describe_wakeup is true;
	now disposition of Progue is 0;
	begin The Conch Portends.

First condition for an episode (called ep) (this is the Tsunami prevents episodes rule):
	if Tsunami Sequence is happening and ( ep is not Earthquake and ep is not The Conch Portends and ep is not Water Works ) , rule fails.

Test tsunami with "ff / ff / ff / ff / debug drama manager / tsun / z / z / nw / n / odd / s / se / z / z / sleep / rume / alarmclock".

Tsunami-testing is an action applying to nothing. Understand "tsun" as tsunami-testing. Carry out tsunami-testing: now current episode is no-episode; now Building To Revelations is expired; now tsun_tflag is 1; change the time of day to 6:15 PM. tsun_tflag is a number that varies. tsun_tflag is 0.

Section - The Conch Portends

The Conch Portends is a guaranteed rendezvous episode. The meeting place is Center Beach. The expiration date is 4 hours. The icebreaker is tcp_greeting.

A finishing rule for The Conch Portends:
	if the player is asleep or it is after 10:30 PM, rule succeeds;
	if tcp_sleep is spoken, rule succeeds.

A commencement rule for The Conch Portends:
	Progue starts conch-blowing;
	now Progue is carrying the conch shell;
	say "Suddenly, your hair stands on end as an eerie sound reverberates around the island. You [o]listen[x] as the cry echoes through the hills, like the lonely wail of some mythical animal brought reluctantly to life.[paragraph break]The wind shifts, and the echoes fade. But you've got to find out what that was.";
	begin chapter 5;
	if the psyche of Progue is fear: [If we never managed to move Progue out of the fear stage but made it this far, we play catch-up by altering this conversation to contain the bulk of Suppression Revelations, where Progue reveals vital info about his past. We (painfully) miss the entire suppression psyche, since Progue transitions to uncertainty after the tsunami, but at least we maintain narrative coherence.]
		now the icebreaker of The Conch Portends is rev_makeupintro;
		now rev_call suggests tcp_temp;
		now rev_call is interstitial;
		now the psyche of Progue is suppression.

A completion rule for The Conch Portends:
	remove the conch shell from play.

Every turn when current episode is The Conch Portends:
	now the activity counter of Progue is 1;
	if Progue is fulfilling and the animus of Progue is conch-blowing and Progue is idle begin;
		if Progue is not visible begin; [add potential messages from the Table of Distant Progue Conch-Blowing; BUG: why doesn't this work?] fire one off by frequency from the Table of Distant Progue Conch-Blowing;
		end if;
	end if.

Instead of listening when current episode is The Conch Portends and Progue is not visible: say "The echoes of the low call reverberate around the island. [if location is regionally in Beachfront or location is regionally in Tiderooms or location is Rise or location is Tidepools]On the beach, you see Progue blowing into an enormous conch shell[else]You'd guess it is coming from the beach[end if]."

Table of Distant Progue Conch-Blowing
freq		start time	end time	text	table		trigger	flag	
common	--	--	"From [if location is regionally in Beachfront or location is regionally in Tiderooms or location is Rise or location is Tidepools]the center of the beach, Progue raises something to his mouth and unleashes[otherwise if location is regionally in West Forest]somewhere on the beach[otherwise]somewhere on the western side of the island drifts[end if] [one of]a sound like a long, low horn call[or]another deep horn call[or]another blast from the horn[cycling]. [one of]It echoes around the island[or]The sound reverberates in long, low waves around the island[or]The noise bounces around and around the island, only slowing fading away to silence[in random order]."

TCP is a thread. The escape clause is tcp_sleep.

tcp_greeting is a beat in TCP with reaction "[The Progue] raises the conch shell to his lips and gives another mighty blow. The great, long, horn sound explodes from the shell and bounces all around the island.[paragraph break]'Beautiful, eh?' he says, lowering the shell from his mouth. 'Found it just now. Tide must have washed it in.' He scratches his head. '[t]Odd[x], that, odd.'". tcp_greeting summons  tcp_temp. tcp_greeting suggests tcp_stall. Before discussing tcp_greeting: if we-are-landmark-going is true begin; tidy landmark-go; clean up landmark-go; end if; continue the action.

tcp_stall is a beat in TCP with reaction "He turns the shell over and over in his hands, running fingers along its delicate whorls and bumps.". tcp_stall suggests tcp_sleep.

Understand "tide/odd" as tcp_temp. tcp_temp is a beat in TCP with keyword name "odd" and fuse 4 and reaction "'Well,' he says, rubbing a finger over the delicate patterning in the shell, 'it shouldn't be high tide for another few hours, but the water's was high as I've ever seen it an hour ago. It's been strange lately out there.'[paragraph break]'There were thousands of silver jellyfish in the lagoon this morning,' he adds. 'Usually they're much farther out, much. Must be stirred up by the waves. Confused. Angry. Beautiful things, purple-hued silver suspended in ocean glass, long pillowing tentacles to quietly kiss you to death if you brushed too many of them. Years and fears ago I'd take long, long swims out to see them, my silent friends, and wonder. What would it be to just dive through that stinging forest, let their gentle touch surround and caress and carry me forward. To the next world. The last world.'[paragraph break]He shakes his head a little, turning the conch shell over and over in his hands.". tcp_temp suggests tcp_sleep.

tcp_sleep is a terminal beat in TCP with reaction "Progue yawns. 'This will be gushing fantastic for the Ledge,' he says, 'quite some addition to the collection. Think I'll pop up there to arrange it, maybe take a nap as well. Long day. Strange day too. But well then. Till morning, [animal-nickname], till morning.'". After discussing tcp_sleep: now the next animus of Progue is resting; Progue's life goes on; continue the action.

The conch shell is a prop. The description is "The beautiful shell is a creamy yellow with patches of orange, and about the size of your head. Bumpy whorls and ridges festoon its spiral shape.".

Section - Earthquake

Earthquake is a guaranteed instant triggered episode.

A condition for Earthquake:
	if Tsunami Sequence is happening and 
	( the player was regionally in Dreamlands or the time of day is after 11:45 PM ) and
	the player is regionally in Lacuna, rule succeeds.

A commencement rule for Earthquake:
	move Progue to Ledge;
	remove the rayfish from play;
	remove distant-rayfish from play;
	now the animus of Progue is resting;
	now ambience_on is 0;
	change the time of day to 11:45 PM;
	say "[if the player was regionally in Dreamlands]You are rudely awakened by[otherwise]You lurch unsteadily in[end if] a sudden, horrifying upheaval. The ground is shaking all around you in the darkness; distant crashes and the groaning of rock moving on rock slice through the night. You leap to your feet, staggering";
	if location is Saddle and withered vine is closed:
		now withered vine is open;
		say ".[paragraph break]The loose vine trembles in the earthquake and falls off the edge of the cliff, reaching nearly all the way down to the [dr]beach[x] below[if dir] and to the [west][end if]";
	say ".".

A finishing rule for Earthquake:
	if it is after 11:59 PM, rule succeeds;
	if location is North Beach or location is Saddle, rule succeeds;
	if location is South Beach or former location is South Beach, rule succeeds. [If we happened to be sleeping at Fork or Big Tree, end quake before gets to Center Beach, where we trigger Tsunami.]

A completion rule for Earthquake:
	say "As suddenly as it began, the quake stops, and the ground is blessedly still again. A million tiny crashes and rumbles and echoes slowly die down around you, as if the whole island sighs.";
	now lava tunnel door is closed;
	now bridge is lowered;
	now bridge-control is unlocked.

Every turn when current episode is Earthquake: [If the player happens to be in the right spot, let him witness these events (which happen anyway at the end.)]
	if lava tunnel door is open and ( location is Back Room or location is Jumble ) :
		now the lava tunnel door is closed;
		say "The lava tunnel [o]door[x] groans in the quake, swings freely for a moment, then slams loudly shut.";
	if bridge is raised and ( location is Chasm Floor or location is Chasm Edge ) :
		say "The [o]bridge[x] across the chasm creaks, and then collapses into its lowered state.";
		now bridge is lowered;
		now bridge-control is unlocked;
	if location is Edge of Ravine, say "The water in the ravine below you sways and crashes sickeningly.".

Instead of sleeping when current episode is Earthquake, say "The quake makes that highly unlikely.". Instead of touching a windsigh tree when current episode is Earthquake, say "The quake makes that highly unlikely." First Instead of landmark-going when current episode is Earthquake: say "It's all you can do right now to put one foot in front of the other.".

Pulling or pushing the ropeway lever is operating equipment. Pushing or pulling bridge-control is operating equipment. Entering the mind chair is operating equipment. Examining an outflow tube is operating equipment. Examining a pressure gauge is operating equipment. Turning or adjusting a wheel is operating equipment.

Instead of operating equipment when episodic status of Earthquake is completed and Tsunami Sequence is happening (this is the earthquake override rule): say "The quake seems to have played havoc with the natural steam vents; no steam at all is flowing from the pipes and none of the equipment seems to be functional."

Instead of going down in Edge of Ravine when current episode is Earthquake and tidein, say "The rope ladder is swinging sickeningly back and forth, the end snapping like a whip; there's no chance of climbing down it.". Instead of going down in Edge of Ravine when current episode is Earthquake and tideout, say "The rope ladder is swinging sickeningly back and forth, the end snapping like a whip; there's no chance of climbing down it.".  Instead of going down in Top of Ravine when current episode is Earthquake, say "The water is lurching crazily; you'd be smashed to pieces if you tried to dive down there now.". Instead of going down in Egg when current episode is Earthquake or current episode is Water Works: say "The ravine down is filled with oozing mud shaken loose from the rain forest by the quake; you can't get down it now.".

First Report going when current episode is Earthquake: say "Unsteadily, you stagger as best you can in that direction."; try looking instead.

Every turn when current episode is Earthquake: say "[one of]The ground[or]Everything[or]The island[in random order] [one of]rumbles and shakes[or]shudders sickeningly[or]keeps bucking and groaning[or]jerks violently[in random order] [one of]around you[or]at your feet[purely at random][if a random chance of 1 in 2 succeeds][one of], crashes above and deep, foot-rattling groans below[or] with a sound like the world ending[in random order][end if].".

Instead of sleeping when current episode is Earthquake: say "Not likely.". Check going up when location is Saddle and current episode is Earthquake: say "In this quake? Suicide." instead.

Instead of examining the surf when current episode is Earthquake: say "The waves slop sickeningly around, peaks and valleys colliding and disappearing at random.". Check examining lagoon when current episode is Earthquake: try examining surf instead.

Instead of taking shelter from when current episode is Earthquake or current episode is Water Works: say "You're not sure any place is safe right now.".


[ Lacuna-lacuna defines a number of environmental changes that take place during the Earthquake. ]

Section - Water Works

Water Works is a guaranteed instant triggered episode. ww_tracker is a number that varies.

Instead of going up in Volcano Slopes when current episode is Earthquake or current episode is Water Works: say "The quake has turned the slopes of the volcano into a shifting morass of sliding soil; climbing it right now would be suicide.". [Force the revelation of the tsunami to be at Center Beach.]

The no doors in earthquake rule is listed before the can't go through closed doors rule in the check going rules. Check going when current episode is Earthquake or current episode is Water Works (this is the no doors in earthquake rule): if door-trying and lava tunnel door is closed, say "The solid surface of the door brings you up short in the blackness. It must have swung shut in the earthquake." instead. To decide whether door-trying: if ( noun is east and location is Back Room ) or ( noun is west and location is Jumble ) , decide yes; decide no.

Instead of opening lava tunnel door when current episode is Water Works and location is Back Room: say "It's too dark to make out the buttons." Instead of opening lava tunnel door when current episode is Earthquake and location is Back Room: say "You're being shaken around too much to accurately press the buttons.".

Every turn when current episode is Water Works (this is the report on tsunami rule):
	if tsun_tracker >= 0, increase tsun_tracker by 1;
	if Drama Manager is being debugged, say "//Drama Manager: Tsunami: tsun_tracker: [tsun_tracker]; water_count: [water_count] / elevation of location: [elevation of location] / location: [if location is flooded]flooded[otherwise]dry[end if] / flooded rooms: [list of flooded rooms].";
	if tsun_tracker < 40 and location is Center Beach or location is North Beach:
		unless tsun_tracker is -1, say "Your blood runs cold at the sight before you. The whole [o]lagoon[x] has emptied, leaving a silty expanse of wet, glistening sand... but beyond it is a black wall of ocean water, moving towards you inexorably.";
		now tsun_tracker is 101;
	otherwise if location is Rise and tsun_tracker > 0:
		now tsun_tracker is -1;
		move distant-Progue to location;
		say "The marsh is drained into a muddy quagmire, but the sea is rapidly coming back. Near the cliff far on the other side, you think you can make out a [o]form[x] slumped against the ground.";
	otherwise if tsun_tracker is -1:
		say actualtsunamireport;
	otherwise if tsun_tracker < 10:
		fire one off by frequency from the Table of Post-Quake Noises;
	otherwise if tsun_tracker < 40:
		fire one off by frequency from the Table of Tide Retreating;
	otherwise:
		fire one off by frequency from the Table of Tide Approaching.

Instead of examining distant-Progue when current episode is Water Works, say "He's sprawled on the ground at the base of the cliff, not moving.".

Instead of listening when current episode is Water Works and tsun_tracker < 10: fire one off by frequency from the Table of Post-Quake Noises. Instead of listening when current episode is Water Works and tsun_tracker >= 10 and tsun_tracker < 40: fire one off by frequency from the Table of Tide Retreating. Instead of listening when current episode is Water Works and tsun_tracker >= 40: fire one off by frequency from the Table of Tide Approaching.

water_count is an elevation that varies. water_count is 0 feet. tsun_tracker is a number that varies.

A room is either flooded or dry. A room is usually dry.

To check for adjacent flooded rooms from (space - a room):
	if space is adjacent to location and location is dry [if it's wet, we have enough to worry about] begin; say "The rising, surging sea floods [prose name of space].";
	otherwise if space is adjacent to a room adjacent to location and location is dry; say "In the distance, you see the rising sea flood [prose name of space]."; end if.

A condition for Water Works:
	if Earthquake is completed, rule succeeds.

First finishing rule for Water Works:
	ignore the episodes usually end when conversation does rule.

Check examining lagoon when current episode is Water Works: try examining the surf instead. Instead of examining the surf when current episode is Water Works:
	if tsun_tracker < 10:
		say "The waves crash together dizzyingly, still turbulent from the quake.";
	otherwise if tsun_tracker < 40:
		say "The tide is rapidly retreating, already well past the low tide mark.";
	otherwise if tsun_tracker > 100:
		say "The distant tide is rapidly surging towards land with a sound like a thousand freight trains.".

Instead of going to Lower Beach when current episode is Water Works, say "[no-ww-water]". Instead of going to Ocean Waters when current episode is Water Works, say "[no-ww-water]". To say no-ww-water: say "That would be an extraordinarily bad idea.". Instead of going to Lower Beach when current episode is Earthquake, say "[no-eq-water]". Instead of going to Ocean Waters when current episode is Earthquake, say "[no-eq-water]". To say no-eq-water: say "The water sloshes drunkenly around, strange interference patterns causing crashes of surf stretching far above your head; you would be smashed and drowned.".

First Instead of landmark-going when current episode is Water Works: say "It would be better to move more carefully for the moment.".

Instead of going down in Edge of Ravine when current episode is Water Works and tidein, say "The [o]tide[x] seems to be doing strange things down there. Better to stay up here.". Instead of going down in Edge of Ravine when current episode is Water Works and tideout, say "The [o]tide[x] seems to be doing strange things down there. Better to stay up here.". Instead of going down in Top of Cave when current episode is Water Works, say "The tide is behaving strangely; ".

Instead of sleeping when current episode is Water Works: say "Something odd in the air prevents you from doing so." Instead of touching a windsigh tree when current episode is Water Works: say "The electric buzz is gone, as if the quake has momentarily stunned the trees.".


To say actualtsunamireport:
	increase water_count by 1 feet;
	repeat with space running through rooms regionally in Lacuna begin;
		if elevation of space <= 0 feet begin;
			now space is flooded;
			check for adjacent flooded rooms from space;
			if space is location, say "Water surges up to your ankles with relentless force.";
			if space is North Marsh and location is North Marsh and Progue Rescue is happening and the animus of Progue is resting, say "The cold seawater swirls around Progue and he awakens with a start. [pr_up]";
		end if;
	end repeat;
	repeat with space running through dry rooms regionally in Lacuna begin;
		if water_count >= elevation of space begin;
			now space is flooded;
			if space is adjacent to location begin; say "The rising, surging sea floods [prose name of space].";
			otherwise if ( location is Lawn or location is Observatory Exterior or location is Ledge or location is Rim of Volcano or location is Saddle or location is Atop or location is Rise ) and space is outdoorsy and space is visited; say "Below you, you see the rising tide flood [prose name of space].";
			otherwise if space is adjacent to a room adjacent to location and space is not location; say "In the distance, you see the rising sea flood [prose name of space]."; end if;
		end if;
	end repeat;
	let floodnum be water_count - elevation of location;
	if floodnum >= 8 feet or ( floodnum >= 6 feet and Progue is uncarried ) begin;
		say "[submergedmsg].";
		now we-were-submerged is true;
		complete Water Works;
	otherwise if floodnum >= 6 feet; say "The rising water is almost to your head.";
	otherwise if floodnum >= 5 feet; say "The water surges above your waist, rising up your torso.";
	otherwise if floodnum >= 4 feet; say "The water keeps surging higher, reaching almost to your waist.";
	otherwise if floodnum >= 3 feet; say "The water rushes past your thighs, still rising.";
	otherwise if floodnum >= 2 feet; say "The water level rises, reaching past your knees.";
	otherwise if floodnum >= 1 feet; say "Water sloshes up your calves towards your knees, moving with relentless force.";
	otherwise if floodnum >= 0 feet; say "The water surges forward, flooding your feet.";
	otherwise if floodnum >= -2 feet; say "A trickle of water surges past you, wetting your feet; a rising flood of water on its heels.";
	otherwise if floodnum >= -4 feet; let targ be closest floodwater; say "A churning current of seawater approaches from [prose name of targ], rising towards you inexorably."; 
	otherwise;
		do nothing;
	end if.

To say submergedmsg: say "The water [if Progue is visible]rips you apart from Progue, [end if]lifts you off your feet and carries you along with it. You are surged forward through the blackness on the terrible wave, losing all sense of direction and orientation, fighting with every ounce of energy to keep your head above the surface. Finally you smash into something hard and unyielding; crying out in pain, your grasp it and claw your way higher, out of the water, until you collapse in exhaustion and know no more".

To decide which room is closest floodwater:
	let hr be UnRoom;
	let sl be 0 feet;
	repeat with rm running through nearby flooded rooms begin;
		if elevation of rm > sl begin;
			let sl be ( elevation of rm ) ; 
			now hr is rm;
		end if; 
	end repeat;
	decide on hr. The prose name of UnRoom is "nearby".

Definition: a room is nearby if it is adjacent to location.

First instead of climbing or entering spire when current episode is Water Works: say "You eye the spire desperately, but it's not that high; at the rate the water's coming in, you'd better find higher ground than that.".

First Report going from a dry room to a flooded room: say "Against your better judgement, you step into the path of the flood."; try looking instead. First report going from a flooded room to a dry room: say "Mercifully, you climb up out of the water towards higher ground."; try looking instead. First Report going from a flooded room (called src) to a flooded room (called dst): say "You slog through the rising water as fast as you are able, [if elevation of src < elevation of dst]gaining some elevation, but not enough[otherwise if elevation of src > elevation of dst]losing elevation as the water rages higher[otherwise]staying relatively level[end if][if Progue is carried], carrying Progue[end if]."; try looking instead.[aar] First Report going when current episode is Water Works: say "[if tsun_tracker > 100]You hurry forward[else]You move cautiously forward in the uneasy darkness[end if]."; try looking instead.[aar]

Instead of going to a submerged room (called dst): say "Water has completely filled [prose name of dst]; you would be drowned.". Definition: a room is submerged if water_count - elevation of location > 6 feet.
	
Instead of sleeping when current episode is Water Works, say "Your heart is still racing; you are far too keyed up to sleep."

Table of Post-Quake Noises
freq		text	table		trigger	flag	
frequent	"[one of]An eerie silence hangs over the island[or]The silence seems almost dangerous, like a vacuum waiting for some dreadful event to fill it[or]The night is still as a tomb[or]You can hear your own breathing in the unnaturally still night air[or]A tree falls somewhere, the sound splitting the total silence like a gunshot[in random order]."

Table of Tide Retreating
freq		start time	end time	text	table		trigger	flag	
guaranteed	--	--	"[one of]Sounds of[or]The sound of[or]A noise like[in random order] [one of]retreating water[or]disturbed waves[or]huge surf[in random order] and [one of]an odd sucking noise[or]a deep, subterranean gurgling[at random] [one of]tremor through the ground[or]reverberate around you[or]echo through the night[or]fill the air[in random order]."

Table of Tide Pause
freq		text	table		trigger	flag	
guaranteed	"[one of]The sea has retreated so far you can barely hear it[or]The distant ocean has gone completely silent[or]It's like the whole island is holding its breath[in random order]."

Table of Tide Approaching
freq		start time	end time	text	table		trigger	flag	
guaranteed	--	--	"[one of]An ominous rush of water steadily grows in volume from all sides[or][tsunami-drama][stopping]."

To say tsunami-drama: say "[one of]The wall of water surges inexorably forward[or]The growl of the approaching tsunami is deafening[or]The black tide rushes closer and closer[or]Trees split and earth rends as the unstoppable sea advances[or]The wall of water is almost upon you[or]Hot spray blows in your face as the roaring tide nips at your heels[or]The tsunami is seconds away[cycling]".


Section - Progue Rescue

Progue Rescue is a scene.

Progue Rescue begins when
	current episode is Water Works and
	location is Rise.

When Progue Rescue begins:
	move Progue to North Marsh;
	now the animus of Progue is resting.

Instead of going up in North Marsh when Progue Rescue is happening: say "[if Progue is carried]Not a chance, carrying Progue like this[otherwise]Progue is in no condition for climbing right now[end if]."

First Instead of waking, pushing, greeting, or touching Progue during Progue Rescue: say "[if the animus of Progue is resting]You shake Progue vigorously. He moans, but his eyes do not open[otherwise]He grips your hand tightly, eyes wide with fear[end if].".

First Instead of attacking Progue during Progue Rescue: say "You give Progue a quick slap across the face. His eyes spring open.[paragraph break][pr_up]".

To say pr_up: say "'What did I miss?' Progue mutters vaguely. He's in no state to walk by himself, so with a grunt you grab his bony frame and sling him over your shoulder."; setup Progue for rescue.

To setup Progue for rescue: now Progue is carried; now Progue-was-carried is true; if water_count < the elevation of location - 4 feet, now water_count is the elevation of location - 4 feet.

Instead of taking Progue when Progue Rescue is happening and Progue is uncarried: say "With a grunt, you lift Progue and position him over your shoulder. His eyes open blearily, but unfocused; he must have hit his head hard."; setup Progue for rescue.

Instead of taking Progue when Progue Rescue is happening, say "You've already got him." Instead of dropping Progue when Progue Rescue is happening and location is not safe: say "You can't put him down here; the water's still rising.". First instead of greeting Progue when Progue Rescue is happening: say "'Just get us out of here,' he mutters vaguely.". Instead of inserting Progue into the bucket when Progue Rescue is happening, try pushing the ropeway lever. Instead of entering the bucket when Progue Rescue is happening, try pushing the ropeway lever.

To decide whether (place - a room) is safe: if the elevation of place >= 25 feet, decide yes; decide no. To decide whether (place - a room) is not safe: if place is safe, decide no; decide yes.

Progue Rescue ends successfully when
	the location of Progue is safe.

When Progue Rescue ends successfully:
	now Progue is uncarried;
	say "You can't go any farther. [if Progue is carried]You collapse to your knees, setting Progue gently down[otherwise]You both collapse to the ground, panting[end if], and wait.[paragraph break]But the water seems to have reached its high point. It swirls and flows below you, but stops rising.[paragraph break]Finally, you both drift off into a long, uneasy, dreamless sleep.";
	Progue is more submissive, silently;
	Progue likes you more, silently;
	Progue likes you more, silently;
	if romance of Progue > 0, Progue is aroused, silently.

To decide whether completely submerged:
	if water_count - elevation of location >= 6 feet, decide yes;
	if water_count >= 25 feet, decide yes;
	decide no.

we-were-submerged is a truth state that varies. Progue-was-carried is a truth state that varies.

Progue Rescue ends nobly but unsuccessfully when [aar]
	( we-were-submerged is true or completely submerged ) and
	Progue-was-carried is true.

When Progue Rescue ends nobly but unsuccessfully:
	[ carrying/with Progue but didn't make it to high ground ]
	Progue likes you more, silently.
	
Progue Rescue ends unsuccessfully when
	Player Rescue begins.

Progue Rescue ends unsuccessfully when
	Progue-was-carried is false and 
	( completely submerged or we-were-submerged is true ) .

When Progue Rescue ends unsuccessfully:
	[ never found Progue ]
	do nothing.

Section - Player Rescue
	
Player Rescue is a scene.

Player Rescue begins when conditions_for_PR is true.

To decide whether conditions_for_PR is true:
	if Progue Rescue has ended, decide no;
	if current episode is not Water Works, decide no;
	if location is Fork and tsun_tracker > 100, decide yes;
	if tsun_tracker > 40 and tsun_tracker <= 100, decide yes;
	if tsun_tracker > 110, decide yes;
	if completely submerged and Progue Rescue is not happening, decide yes;
	decide no.

Test dangling with "ff / ff / ff / ff / ff / ff / tp hive room / tsun / z / z / z / z / z / sleep / z / z / z / z / z / z / z / z / z / z / z / z / z / z / z / z / z / z / open compass / nw / se".

When Player Rescue begins:
	now water_count is water_count - 6 feet;
	now player_imperiled is true;
	if we are going, say "You move cautiously forward in the darkness, but suddenly "; otherwise say "Suddenly ";
	if location is Edge of Ravine or location is Viewpoint or location is Backside or location is Saddle begin;
		say "the ground gives way beneath your feet and you are falling, sliding in a torrent of wet earth and stones off the drop-off. You scrabble desperately for something and finally your hands grasp a thick tree [o]root[x]; you grip it with all your strength as the ground crumbles away beneath you, falling far down towards the [o]ravine[x] floor below, leaving you dangling over the precipice.";
		move quake tree root to location;
	otherwise if location is Rockslide or location is regionally in Volcano Slopes or location is Rim of Volcano;
		say "the loose rock gives way beneath your feet, and the whole hillside is sliding. You try desperately to maintain your balance and jump clear of the slide, but rocks twist and grab your ankles and you fall to the ground, throwing your arms up to your head to protect it. Mercifully, the rockslide stops moments later; but your feet and lower legs are caught under a [o]boulder[x], wedged tight against another.";
		move slide to location;
	otherwise if location is flooded or elevation of location - water_count is at most 4 feet;
		say "the water surges around you and lifts you off your feet. Desperately you try to ride the wave, but then something glances against your head leaving your ears ringing, and you are twisted around and pulled under.[paragraph break]After a long, horrible moment, you manage to break the surface again; but your foot has caught on some hard [o]foothold[x], and the water continues to rise.";
		move foothold to location;
	otherwise;
		say "the ground beneath your foot steepens and then, horribly, disappears, and  you fall forward into a sudden blackness. You throw your arms backwards and grab for purchase; they painfully catch on what seems to be the edge of some new [o]crack[x] opened in the quake; frantically, you grasp for a handhold as you slip farther and farther into the maw. Finally you manage to stop your slide, though you are dangling over a pitch black hole of unknown depth.";
		move the giant crack to location; 
	end if.

Check going when player_imperiled is true: say "You wish you could." instead. 

[ Dangling over ravine ]

The quake tree root is set dressing. The printed name is "slippery root". The description is "It bends dangerously under your weight." Instead of climbing quake tree root, try going up. Instead of taking quake tree root, say "You are already gripping it as tightly as you can." Does the player mean doing something with quake tree root: it is very likely.

Instead of going when player_imperiled is true and ( quake tree root is in location or giant crack is in location or slide is in location ) (this is the tsungd1 rule): say "You can't go anywhere until you get out of this mess." instead. The tsungd1 rule is listed first in the instead rules.

Instead of going down when player_imperiled is true and ( quake tree root is in location or giant crack is in location ) (this is the tsungd2 rule): say "Suicide." instead. The tsungd2 rule is listed first in the instead rules.

Instead of going up when ( quake tree root is in location or giant crack is in location ) and player_imperiled is true (this is the first earthquake rule): say "You try to struggle upwards, but your handhold is slippery and your feet can't get any purchase. You almost lose your grip and grab desperately with your other hand to tighten your hold.". The first earthquake rule is listed first in the Instead rules.

Instead of jumping when player_imperiled is true: say "[if giant crack is enclosed by location or quake tree root is enclosed by location]Suicide[otherwise]You desperately try to leap free, but you can't work yourself free from the crushing grip on your lower body[end if].".

First check climbing when player_imperiled is true and ( quake tree root is in location or giant crack is in location ) : try going up instead.

[ Dangling over crack ]

The giant crack is an unopenable open fixed in place container. Understand "hole" or "maw" or "chasm" or "handhold" as giant crack. The description is "[if player_imperiled is true]You have no sense of its dimensions or depth; but you can't touch the other side and you can't see the bottom.[otherwise]The crack, rimmed by wrinkles of recently disturbed soil and dying plants, is narrow enough to jump over, just, and a dozen paces long. It seems to go down quite a ways.". The initial appearance is "A [o]crack[x] has opened up in the earth here, slicing unpleasantly through the [surface-material].". Instead of exiting when giant crack is in location: try going up. Instead of entering giant crack: say "Without the proper equipment, it would be too dangerous.". Instead of entering giant crack when player_imperiled is true: try going down. Instead of climbing giant crack when current episode is Water Works and Progue is not enclosed by location: say "You struggle to pull yourself up, but the ground is loose and each handhold gives under increased weight. You feel yourself slipping slowly backwards.". Instead of taking giant crack, try climbing giant crack.

[ Stuck in rockslide ]

The slide is set dressing. Understand "rock" or "rocks" or "rockslide" or "boulder" as slide. The printed name is "rockslide". The description is "The whole hillside slipped loose, only to tentatively, piece by piece, grab onto the slope and hold still again, no matter how precariously.". Instead of going when player_imperiled is true and slide is in location: say "You struggle to free yourself, but you are stuck tight.". Instead of taking or pushing or pulling slide: say "You shift a few stones, but the larger ones are too heavy for you to get a good grip on.". Instead of attacking slide: say "You rail at the stones trapping you, but only manage to wedge yourself in more tightly.".

[ Trapped in rising water ]

The foothold is set dressing. Understand "foot" or "hold" or "foot hold" or "obstruction" or "snare" as foothold. The description is "You can't see it beneath the surging waves; all you can feel is that it's something hard and unyielding, and your foot is definitely stuck in it.". Instead of taking or pushing or pulling the foothold: say "You take a breath and pull yourself under to tug at the snare, but the water is surging around you so savagely that you can't get a grip. You surface again, gasping, and see that the water has risen even higher.". Instead of attacking the foothold: say "You kick savagely at the obstruction, but only succeed in wedging your foot in more tightly.". Instead of vague swimming while player_imperiled is true (this is the tsunswim2 rule): say "You kick your free leg and paddle frantically with your hands, but your other foot is held tight." instead. The tsunswim2 rule is listed first in the instead rules. Instead of going down when player_imperiled is true and foothold is in location (this is the tsunswim1 rule): try taking foothold. The tsunswim1 rule is listed first in the instead rules. Instead of going when player_imperiled is true and foothold is in location (this is the tsungo1 rule): say "You kick your free leg and paddle frantically with your hands, but your other foot is held tight.". The tsungo1 rule is listed first in the instead rules. Vague swimming is fighting for life. Instead of attacking surf when foothold is visible, try attacking foothold.

Going somewhere is fighting for life. Climbing is fighting for life. Doing something to the rockslide is fighting for life. Doing something to the foothold is fighting for life. Doing something to the giant crack is fighting for life.  Doing something to the quake tree root is fighting for life. 

survival_count is a number that varies. survival_count is 0.

After fighting for life when Player Rescue is happening and Progue is visible: increase survival_count by 1; if Drama Manager is being debugged, say "//Drama Manager: Tsunami: **fighting for life**"; continue the action.

Every turn when Player Rescue is happening and survival_count >= 2: say "Struggling furiously, you [if foothold is visible or slide is visible]twist your foot free, scraping it badly[otherwise]grab for a desperate handhold and pull yourself to safety[end if]. Progue grabs you and hauls you forward, muttering something about heroics, and the two of you [if location is flooded]struggle towards dry land and higher ground[otherwise if elevation of location < 30 feet]struggle towards higher ground in the terror of night[otherwise]collapse in exhaustion to wait out the long night[end if]."; now player_imperiled is false.

Every turn during Player Rescue:
	now water_count is water_count - 2 feet; [ once this event has been triggered we don't want the player to drown in the middle of it. ]
	if the time since Player Rescue began is at least ( 2 times time factor ) minutes and Progue is not enclosed by location begin;
		summon Progue to location;
		now Progue is idle;
		say "Progue appears and in a flash, reaches out a [o]hand[x] to you.[paragraph break]'Take it!' he shouts, glancing nervously behind him, 'hurry!'";
	end if.

Instead of greeting Progue during Player Rescue: say "'No time,' he shouts, 'grab my hand!'". First Instead of attacking, pushing, hugging, or kissing Progue during Player Rescue: say "This is hardly the time for that.".

Understand "hand" as Progue when Player Rescue is happening. Instead of taking Progue when Player Rescue is happening (this is the earthquake 2 rule): now pr_coop is true; say "You grasp Progue's hand gratefully, and feel it [if slide is in location]pull you free of the rockslide[otherwise]pull you forward[end if] with surprising strength.[paragraph break]'Gotcha gotcha,' he shouts against the roar of the waves[if romance of Progue >= 4], then plants a quick, desperate kiss on your lips[end if]. 'Now let's move!'[paragraph break][tsun-outtro]." instead. The earthquake 2 rule is listed before the hug not take Progue rule in the Instead rules.

Instead of examining Progue when Player Rescue is happening, say "Soaked, scratched, with a bruise spreading across his face, Progue reaches out a firm hand towards you with a strength that defies his years."

Instead of getting bored during Player Rescue: do nothing.

To say tsun-outtro: say "Together, you struggle up towards higher ground, the water rising inexorably in the darkness below and around you with a roar like a beast the size of an island. Finally, you collapse, exhausted, and slowly wait out the long night"; now player_imperiled is false.

Player Rescue ends cooperatively when pr_coop is true. pr_coop is a truth state that varies.

When Player Rescue ends cooperatively:
	Progue feels more like a father, silently;
	Progue likes you more, silently.

Player Rescue ends individualisticly when player_imperiled is false and pr_coop is false.

When Player Rescue ends individualisticly:
	Progue feels more like a father, silently;
	Progue likes you less, silently.

Every turn when player_imperiled is true: increase peril factor by 1. peril factor is a number that varies. peril factor is 0.

Player Rescue ends sourly when peril factor is at least 5.

When Player Rescue ends sourly:
	Progue feels more like a father, silently;
	Progue feels more like a father, silently;
	Progue likes you less, silently;
	Progue likes you less, silently;
	say "Suddenly, you slip and begin falling backwards, but Progue dives forward and grabs your hand fiercely. With strength you didn't know he had, he pulls you slowly out, till the two of collapse.[paragraph break][tsun-outtro].";
	complete Water Works.
	

[from Viewpoint or Edge of Ravine, the ground gives way leaving the player dangling; from Forest or Frozen Hell or West Forest, the player steps into a hidden opened crack; from Rockslide or Volcano Slopes, the player is half-buried in rockfall; if the player is hit by the tsunami, they are pulled from their feet and bash their head and end up drifting to a spot where their foot is caught and the water is rising.]

Section - Finishing Up

washed_out is a number that varies. washed_out is 0.

A finishing rule for Water Works:
	if Player Rescue has ended, rule succeeds;
	if Progue Rescue has ended and Player Rescue is not happening, rule succeeds;
	if completely submerged and Player Rescue is not happening, rule succeeds.[aar]

A completion rule for Water Works:
	if completely submerged and Player Rescue is not happening and we-were-submerged is false, say "[submergedmsg].";
	if Drama Manager is being debugged, say "// Drama Manager: Tsunami: **Player rescue has ended: [if player rescue has ended]T[otherwise]F[end if]; Progue Rescue has ended: [if Progue Rescue has ended]T[otherwise]F[end if]; Progue Rescue is not happening: [if Progue Rescue is not happening]T[otherwise]F[end if]**";
	tidy up the flood.

To tidy up the flood:
	now the time of day is 9:45 AM;
	now player_imperiled is false;
	now water_count is 0 feet;
	move the player to Rise, without printing a room description;
	move Progue to Center Beach;
	now the animus of Progue is ruminating;
[	now the posture of the player is reclining;]
	now the psyche of Progue is uncertainty;
	now Progue is fulfilling;
	move the left ear to North Beach;
	move fallen trees to Rise;
	now volcano sculpture is loosened;
	if Saddle is visited and withered vine is closed:
		now withered vine is open;	
	move shallow puddles to Volcano Floor;
	move clockwork head to Treehouse; [?]
	now time-for-shark-scene is true;
	now the ambience table of Crater Pond is Table of Geyser Ambience;
	remove pond-birds from play;
	remove water lilies from play;
	move sketchbook to Hut;
	remove wooden cube from play;
	now the activity counter of Progue is -50;
	now every room is dry;
	print a section break;
	if compass is unmolested and compass is worn and puzzle mode:
		now compass is revealed;
		say "Something scrapes roughly against your chest. You groggily open your eyes to morning light and sit up, rubbing the [o]compass[x] absently; something seems to have popped open on the back side in the chaos";
	otherwise:
		if compass is not worn:
			if puzzle mode, now compass is revealed;
			now compass is described;
			change the initial appearance of the compass to "Half-buried in the sand, a gleaming round [o]compass[x] catches the light.";
			move compass to Center Beach;
		say "You groggily open your eyes to morning light";
	say ".[paragraph break]You stand slowly, shakily to your feet, and look around. It seems you've survived.";
	begin chapter 6;
	now only-look-once is false;
	try looking;
	move distant-Progue to location;
	say "Off near the center of the [d]beach[x], you see Progue, sitting with knees hunched up staring out at the tide.".


Section - Post-Storm Conversation

Post-Storm Conversation is a guaranteed triggered serendipitous episode. The icebreaker is psc_intro. 

First condition for Post-Storm Conversation:
	ignore the Progue is chattier the more he likes you rule;
	rule succeeds.

A completion rule for Post-Storm Conversation:
	now the activity counter of Progue is 5.

PSC is a thread. The escape clause of PSC is psc_headinjury.

[1. Player makes no effort to rescue Progue. Progue tries to rescue player and player refuses his help. (Player Rescue ended individualisticly)
2. Player makes no effort to rescue Progue. Progue tries to rescue player and player accepts his help. (Player Rescue ended cooperatively)
3. Player gets to Rise or farther, then turns back without reviving Progue. (Leading to 1 or 2 above) (Progue Rescue ended unsuccessfully)
4. Player revives Progue but does not make it to safety. (Progue Rescue ended nobly but unsuccessfully)
4. Player revives Progue and takes him to safety. (Progue Rescue ended successfully.)]

psc_intro is a beat in PSC with reaction "'Well oh well oh, quite a night,' he says. 'But Something Further, we're both still alive, [']twould seem leastways. Won't be forgetting that very soon, I don't expect. That's my Lacuna for you; just when you get used to her she throws a tsunami at you.'".

[]

After discussing psc_intro: 
	if ( Progue Rescue ended successfully or Progue Rescue ended nobly but unsuccessfully ) and affinity of Progue > 0 begin; force discuss psc_savedmeinchar;
	otherwise if ( Progue Rescue ended successfully or Progue Rescue ended nobly but unsuccessfully ) ; force discuss psc_savedmeoutchar;
	otherwise if Player Rescue ended cooperatively ; force discuss psc_savedyou;
	otherwise if Player Rescue ended individualisticly or Player Rescue ended sourly; force discuss psc_playthehero;
	otherwise if Progue Rescue ended unsuccessfully; force discuss psc_abandoned;
	otherwise; if final release mode is false, say "//ERROR: none of the Post-Storm Conversation templates fit."; force discuss psc_savedyou;
	end if;
	continue the action.

psc_savedmeinchar is a beat in PSC with reaction "He regards you seriously. 'Thanks are deserved for you,' he says. 'You grabbed my life by the scruff and kept me falling from the brink. [if Progue Rescue ended nobly but unsuccessfully]Didn't quite make it but that last shock of submersion finally sprung me to wake; I swam and climbed and somehow made it to dry land. [end if]Why I reasoned I could or should climb down from my ledge plum in the midst of earthquakes...' he shakes his head. 'Would have been swept to sea and sunk with the sharks without you, friend. Infinitudes of thanks and respect.'". psc_savedmeinchar summons psc_welcome. psc_savedmeinchar suggests psc_headinjury.

Understand "welcome" as psc_welcome when last beat is in PSC. psc_welcome is a beat in PSC with keyword name "welcome" and reaction "[if romance of Progue > 2]He hugs you, holding you tight, before letting you go[otherwise]He clasps your hand firmly[end if]. 'Mayhaps someday the favor can be boxed up and returned,' he says.". psc_welcome enqueues psc_headinjury.

psc_savedmeoutchar is a beat in PSC with reaction "He frowns at you. 'We haven't always heard ear to ear since you've arrived,' he says. 'But still you went ratherly out of your way to save me. You grabbed my life by the scruff and kept me falling from the brink. I'm willing to sheath the past and let it be past, if you are. Find a new spring between us. What do you say? Agree?'". The yes-beat of psc_savedmeoutchar is psc_yesfriends. The no-beat of psc_savedmeoutchar is psc_nofriends. psc_savedmeoutchar suggests psc_nofriends. 

psc_nofriends is a submissive beat in PSC with keyword name "no" and reaction "He furrows his brow and folds his arms. 'Very well,' he says. 'Won't forget what you did for me, too true, but if you don't want changes in spaces between, then so it will be.'". psc_nofriends enqueues psc_headinjury.

psc_yesfriends is a beat in PSC with keyword name "yes" and reaction "He clasps your hand, a real smiling breaking out across his face. 'Very well and welly ver,' he says. 'I hope this time I make better impressions.'". psc_yesfriends enqueues psc_headinjury. After discussing psc_yesfriends: if affinity of Progue < 1, now affinity of Progue is 1; continue the action.

psc_savedyou is a beat in PSC with reaction "'It's a trickling good thing I found you when I found you,' he says, 'since when I found you the water was black madness rising. That quake shocked the moisty hells from me, have my words, up on that carious mountain ledge. I came right down spying for you afterwards. Good thing, too true, true too, or you might be sunk with the sharks instead of breathing in the morning.'". psc_savedyou summons psc_thanks. psc_savedyou suggests psc_headinjury.

Understand "thanks" as psc_thanks when last beat is in PSC. psc_thanks is a beat in PSC with keyword name "thanks" and reaction "'Well and [']twas only my nature,' he says modestly. 'Mayhaps someday you'll  grab my life by the scruff and keep me from falling off the brink.'". psc_thanks enqueues psc_headinjury. Instead of thanking Progue when psc_thanks is available: try discussing psc_thanks.

psc_playthehero is a beat in PSC with reaction "He regards you with annoyance. 'You don't play a gushing convincing hero,' he says. 'The ground quivering like a planet of gel, the waves black madness rising, and here I venture through life and strife to find you and you don't seem keen for aid. Got me a bit upended, [animal-nickname]. Some sound of [psc_sorry] is mayhaps overdue, unless of course of course I insulted the brave and lonely [psc_solo]?'". psc_playthehero suggests psc_headinjury.

Understand "sorry" as psc_sorry when last beat is in PSC. psc_sorry is an affinitive beat in PSC with keyword name "sorry" and reaction "His expression softens a little. 'Well, it's over now and regardless,' he says. 'What's done is done, and neither sunk with the sharks. Could have turned gushing worse.'". psc_sorry enqueues psc_headinjury.

Understand "hero" as psc_solo when last beat is in PSC. psc_solo is an unaffinitive submissive beat in PSC with keyword name "hero" and reaction "'Well and I hope you enjoyed yourself,' he says sourly. 'Next time you can play your games when someone else's life is on the brink.'". psc_solo enqueues psc_headinjury.

psc_abandoned is a beat in PSC with reaction "'I saw you on the rise last night,' Progue says slowly, not meeting your eye, 'after I fell from my climb down the cliff. You saw me, watched for a span, and then you turned, back and away. I was dizzy, hurt, choking...' He swallows. 'Well and mayhaps you solely did what it was you thought you needed to [psc_unintentional]. Or mayhaps, mayhaps what you did was entire your [psc_intentional], eh? I wonder, [animal-nickname]. I wonder.'". psc_abandoned suggests psc_unintentional.

Understand "survive" as psc_unintentional when last beat is in PSC. psc_unintentional is a beat in PSC with keyword name "survive" and reaction "'Well,' he says in a kind tone but still not meeting your eye, 'ground quivering like a planet of gel; the waves black madness rising, chaos encircling confusion. Mayhaps thoughts and thoughts weren't finishing the race. It's past now; we'll forget it or something thatwise, yes? I suppose we will.'". psc_unintentional enqueues psc_headinjury.

Understand "intentional" as psc_intentional when last beat is in PSC. psc_intentional is an unaffinitive terminal beat in PSC with keyword name "intentional" and reaction "'Then and then,' he says darkly, 'Nothing Further to you, [animal-nickname]. I'll busy myself with prepping your departure; we needn't speak again. Worsebyes and farepoors.'". After discussing psc_intentional: now the affinity of Progue is -6; if romance of Progue > 0, Progue is heartbroken; Progue's life goes on; continue the action.

psc_headinjury is a beat in PSC with reaction "'Hit the nog trickling hard when I fell,' he says, rubbing the purple goose egg on his forehead, 'feels like avalanches in there just now. Avalanches of [psc_Memories] trickling, cascading, triggering others, overcoming angles of repose, reaching points of no return...' he trails off, clutching his head as if to somehow stabilize it. 'Anyway,' he continues after a long moment, 'my beach is a sad and sad [psc_mess]. Don't know how I'll keep it in clean.' He seems on the verge of tears, but takes a few deep breaths and calms down.". psc_headinjury suggests psc_memories. psc_memories replaces psc_headinjury.

Understand "memories" as psc_memories when last beat is in PSC. psc_memories is a beat in PSC with keyword name "memories" and reaction "'I remember... more now,' he says, carefully. 'Still not everything, not by mountains, but more and more bits, pieces of puzzles in pieces. And I'm sure, but not sure why, that that pyramid contraption up on the mountaintop is a terrible danger. I know you've [if Lawn is visited]been up there and fiddled[otherwise]been trying to get up there and fiddle[end if], but you've got to trust and believe: Stop. Leave it be. The best and best thing for you is to help me prep your departure, so you can leave this place, wayfare away and move on and forget about me and Lacuna and all that's here.'[paragraph break]'Oh,' he says, 'and I'd stop sleeping under those windsigh trees, too, were I you. You'll sleep gushing more peacefully out on the beach, I promise.'". psc_memories enqueues psc_outtro. psc_outtro replaces psc_memories.

Understand "mess" as psc_mess when last beat is in PSC. psc_mess is a beat in PSC with keyword name "mess" and reaction "'Jotsam and fletsam sloshing up everywhere,' he says, waving towards the beach with a hopeless hand. 'Be working overtime for a span. The beach has to stay clean, [animal-nickname], has to has to.'". psc_mess suggests psc_memories.

psc_outtro is a terminal beat in PSC with reaction "'That's all I wanted to say,' he says. 'Oh and just to keep your eyes unglued-- seems a few things may have changed around here. Till the future.' He nods to you and turns back to his inner thoughts, a glum, pensive expression heavy on his face.".



Tsunami Sequence ends when the episodic status of Water Works is completed.

When Tsunami Sequence ends: now dont_describe_wakeup is false.


Volume - Dreams

Book - Not for release

Understand "dtrack" as dtracking. Dtracking is an action out of world applying to nothing.

Carry out dtracking:
	if dream-window is g-present, shut down dream-window;
	otherwise open up dream-window.

The dream-window is a g-window with type g-text-buffer. The main-window spawns the dream-window. The position of the dream-window is g-placeabove. The scale method of dream-window is g-fixed-size. The measurement of the dream-window is 5.

Before reading a command when dream-window is g-present: follow the draw dw rule.

This is the draw dw rule:
	move focus to dream-window, clearing the window;
	let lucky be a random windsigh tree in saved location;
	if lucky is not a thing and saved location is Saddle, let lucky be tree3;
	if lucky is not a thing and saved location is Treehouse, let lucky be tree2;
	say "player: [if player is asleep]asleep[else]awake[end if] / contctd. trees: [the number of contacted windsigh trees] / psuedo: [if pseudo-dream is 1]yes[else]no[end if] / tree: [location of lucky] ([if lucky is contacted]contacted[else]uncontacted[end if])[line break]";
	say "act. pres.: [if active presence is dream1-presence]1[else if active presence is dream2-presence]2[else if active presence is dream3-presence]3[else if active presence is dream4-presence]4[else if active presence is dream5-presence]5[else if active presence is dream6-presence]6[else if active presence is dream7-presence]7[else][active presence][end if]";
	say " ([if active presence is enclosed by location]here[else]gone[end if] & [if active presence is attentive]attentive[else]idle[end if]) / last beat: [last beat] / saved lb: [saved last beat][line break]";
	say "door locked: [if dream-door-locked is true]yes[else]no[end if] / esc track: [escape tracker] ";
	return to main screen.

Book - Dream Related Stuff


Emergency waking is an action applying to nothing. Understand "alarmclock" as emergency waking.

Check emergency waking: if yourself is awake, say "You're awake.". Carry out emergency waking: now player is yourself; now yourself is awake; now time factor is 3; let lucky be a random windsigh tree in saved location;
	if lucky is not a thing and saved location is Saddle, let lucky be tree3;
	if lucky is not a thing and saved location is Treehouse, let lucky be tree2;
	now lucky is contacted.

Check vague discussing when location is regionally in Dreamlands: say "The conversation seems to move inexorably forward, despite your attempts to direct it." instead. 

Check requesting the exits text when location is regionally in Dreamlands: say "You can't seem to get your bearings here." instead.

Definition: a room is treecontacted: if it encloses a contacted windsigh, yes; if it is Treehouse and tree2 is contacted, yes; no.

To say sleepsuggest: [ If the player has tried to sleep somewhere inappropriate, we suggest a place for them, subtly encouraging them to sleep near a windsigh tree. ]
	say "[line break]";
	let the tree room list be {Treehouse, Fork, Forest9, Cinder Cone, Egg Room, Saddle, Rockslide};
	remove the list of unvisited rooms from the tree room list;
	remove the list of treecontacted rooms from the tree room list;
	if the number of entries in the tree room list is 0:
		say "There's got to be someplace to sleep around here.";
		stop;
	let nmb be a random number from 1 to the number of entries in the tree room list;
	let selection be entry nmb of the tree room list;
	if selection is Treehouse:
		say "The hammock in that treehouse you found looked like a nice place for a night's sleep.";
	else if selection is Fork:
		say "The leafy nook at the foot of the tree you painted to reach this place springs to mind. It might be comfortable enough for sleep.";
	else if selection is Forest9:
		say "The [tree5] in the rain forest had that mossy boulder at its base-- that might be a good place to drop off.";
	else if selection is Cinder Cone:
		say "The smooth slopes of the small cinder cone in the volcano near the [tree4] might be a smooth and warm place to sleep.";
	else if selection is Egg Room:
		say "The hidden hollow by the egg shape in the rain forest might be a soft place to get some sleep.";
	else if selection is Saddle:
		say "That high saddle at the top of the water cave might be a good place to sleep, and there would definitely be a spectacular view of the sunrise in the morning.";
	else if selection is Rockslide:
		say "The mossy hollow up by the [tree7] on the rockslide might be a good place to sleep.".

Book - Dream Infrastructure

Section - General

Dreamlands is a region. [All dream rooms are in Dreamlands.]

Having a Dream is a recurring scene.

Having a Dream begins when
	the player is asleep for the first turn.

Having a Dream ends when
	yourself is awake. 

Table of Dream Stuff
order	nexus			presence
1		Dream1Nexus	dream1-presence
2		Dream2Nexus	dream2-presence
3		Dream3Nexus	dream3-presence
4		Dream4Nexus	dream4-presence
5		Dream5Nexus	dream5-presence
6		Dream6Nexus	dream6-presence
7		Dream7Nexus	dream7-presence

When Having a Dream begins:
	if dreams are being debugged, say "// Dreams: Having a Dream begins.";
	print a section break;
	strip the player;	
	if good place to dream begin; [ we're sleeping near a windsigh ]
	[figure out which dream to have]
		now d_ctr is 0;
		now d1_ctr is 0;
		let lucky be a random visible windsigh tree;
		if lucky is not a thing and location is Saddle, let lucky be tree3;
		if lucky is not a thing and location is Treehouse, let lucky be tree2;
		if dreams are being debugged, say "// Dreams: good place to dream because near [lucky].";
		if the number of contacted windsigh trees is 7 begin; [after the 7th dream, always get the last one (to let you change passwords.)]
			now active presence is dream7-presence;
			unless pseudo-dream is 1, now pseudo-dream is 0; [If we're touching the tree, wake up immediately; else sleep through the night.]
		otherwise if the scene_order of lucky is 0; [Assign the next dream to the sequence.]
			let tkr be 0;
			repeat with ctr running through windsigh trees begin;
				if scene_order of ctr > tkr, now tkr is scene_order of ctr;
			end repeat;
			now the scene_order of lucky is tkr + 1;
			if dreams are being debugged, say "// Dreams: never dreamed under this tree: assigning scene order [tkr + 1].";
		otherwise;  [Before you've gotten to the 7th dream, remind you to find more trees.]
			if dreams are being debugged, say "// Dreams: already dreamed under this tree: summoning dream-presence-rerun.";
			now active presence is dream-presence-rerun;
			choose row scene_order of lucky in Table of Dream Stuff;
			move active presence to nexus entry;
			now pseudo-dream is 2; [Will wake up early so we don't miss a night.]
		end if;
		if dreams are being debugged, say "// Dreams: selecting dream [scene_order of lucky].";
		if the number of contacted windsigh trees is 7, choose row 7 in Table of Dream Stuff;
		otherwise choose row scene_order of lucky in Table of Dream Stuff;
		move player to nexus entry;
		if pseudo-dream is not 2, now active presence is presence entry;
	otherwise;
		move player to GenericDream; [quick message and immediate wake up.][aar]
	end if.

To decide whether good place to dream: 
	if a windsigh tree is enclosed by location or location is Saddle or location is Treehouse, decide yes;
	decide no.


A windsigh tree has a number called scene_order. [ Our dreams are given a chronological sequence of settings, regardless of what order trees are found in, and once a setting is assigned to a tree, it stays assigned to it in future dreams. ]

Saved location is a room that varies. Locker is a container. Wardrobe is a container. [ This stores the player's stuff while they're dreaming. ]

To strip the player: 
    now every thing carried by yourself is in the locker; 
    now every thing worn by yourself is in the wardrobe; 
    change saved location to location.

To restore the player:
	now every thing carried by yourself is in the location; 
	now every thing in the locker is carried by yourself; 
	now every thing in the wardrobe is worn by yourself;
	if Tsunami Sequence is happening:
		move the player to saved location, without printing a room description;
		say "[bold type][location][roman type][line break]";
	otherwise:
		move the player to saved location.

[pseudo-dream is a number that varies. pseudo-dream is 0.] [Defined in main. After we've powered the mindlink, we can just touch trees instead of having to sleep under them.]

dont_describe_wakeup is a truth state that varies. 

When Having a Dream ends:
	if dreams are being debugged, say "// Dreams: Scene Having a Dream ends.";
	if pseudo-dream is 0 begin; [regular dream.]
		print a section break;
		if dont_describe_wakeup is false, say "[if notrefreshed is true]You rise to your feet[otherwise]Blinking and yawning, you rise to your feet and stretch. [one of]If it wasn't the most restful night, you at least feel ready to face another day[or]The strange dreams don't seem to fade, but linger hazily in the back of your mind[or]You feel rested, despite the strange dreams[in random order][end if].";
		now notrefreshed is false;
	otherwise if pseudo-dream is 2; [wake up without passing time; all 7 trees are already contacted, or special Tsunami override.][aar]
		unless night and Tsunami Sequence is happening, say "You're awake, but hardly any time seems to have passed[if night]. It's still dark and you're still sleepy[end if].";
	otherwise; [1: touching a windsigh.]
		say "The vision seems to have passed. You shake yourself off and look around. [one of]The leaves kicked up by the wind are just now settling, as if no time has passed at all[or]Again, it's as if no time has passed[stopping].";
	end if;
	now pseudo-dream is 0;
	let lucky be a random windsigh tree in saved location;
	if lucky is not a thing and ( saved location is Atop or saved location is Saddle ) , let lucky be tree3;
	if lucky is not a thing and ( saved location is Treehouse or saved location is Big Tree ) , let lucky be tree2;
[	if lucky is not contacted [i.e. we failed to adequately finish this dream] , move active presence to location; [so we'll try again next time.]]
	if lucky is a windsigh tree, now lucky is contacted; [ensure this tree gets marked as finished.]
	post-conversation processing;
	manually reference d1-door;
	wake up now;
	restore the player;	
	now escape tracker is 0;
	truncate list of remembered stuff to 0 entries.

Rule for asking which do you mean while remembering and location is regionally in Dreamlands: say "It fades away when you try to look too closely.".


Section - Generic Dream

GenericDream is a room in Dreamlands. The printed name of GenericDream is "".

Having a Generic Dream is a recurring scene.

Having a Generic Dream begins when
	the player is in GenericDream and
	the player is asleep.

Having a Generic Dream ends when
	the player is awake. 

notrefreshed is a truth state that varies.

When Having a Generic Dream begins:
	if Tsunami Sequence is happening:
		say "You stretch out on the [surface-material], but you find that sleep will not come. Finally, you stand to your feet again.[wakeupearly]";
	otherwise if the number of contacted windsigh trees is at least 7:
		say "Stretching out on the [surface-material], you close your eyes and finally drift off into a deep, unbroken sleep.[paragraph break]You do not dream.";
	otherwise:
		say "[one of]You sleep fitfully. Strange, half-grasped images and tableaus drift vaguely: Rume and [the Progue] locked in some tiring cyclical debate, incomprehensible; [remembered thing] and [remembered thing]; ticklings of worry with no quantifiable origin.[paragraph break]But above and inside, omnipresent, some distant presence clings to the edge of consciousness, almost lost yet naggingly present, like whispers heard from a muffling distance that hobbles any vestige of meaning to a syncopated susurrus, alternating white noises and silence.[or]Again, your dreams are unsettling, filled with images of [remembered thing] and [remembered thing]. You feel as if ideas are on the verge of bubbling to mind's surface, and again have the sensation of whispers, or perhaps just voices, but so far away that you cannot hear what they are saying.[paragraph break]You awake with a start, covered in a sheen of sweat. It is still dark. Though you still feel tired, you find you cannot stay in this spot; sleep will not come.[wakeupearly][stopping]";
	wake up now. 

To say wakeupearly:
	now the time of day is three hours before the time of day;
	say sleepsuggest;
	summon Progue to Ledge;
	Progue starts resting;
	now notrefreshed is true.



Section - Dream Nexus

A nexus-room is a kind of room.  [ This is the central hub for each dream. ]

Before printing the name of a room when location is a nexus-room: say "~-~-~". After printing the name of a room when location is a nexus-room: say "~-~-~".

Instead of examining yourself when location is a nexus-room: say "Your traveling clothes are as new and clean as the day you finished stitching them.".

[The player is not allowed to wake up if active presence is visible. We carry out waking up by simply making the player awake.]

Section - Active Presence

A dream presence is a kind of person. A dream presence is always undescribed. The printed name of a dream presence is usually "the presence". A dream presence has a beat called the icebreaker. The icebreaker of a dream presence is usually Silence. [ Beginning of their conversation. ] [ A dream presence should be assigned to the nexus-room they're associated with. ] Check examining a dream presence: try discussing icebreaker of noun instead.

First Before getting bored when noun is a dream presence: do nothing instead.

Active presence is a thing that varies. [ The current dream presence. ] 

Every turn when active presence is a dream presence and active presence is enclosed by location: 
	if active presence is idle and icebreaker of active presence is not silence begin;
		if dreams are being debugged, say "// Dreams: wake up active presence ([active presence]) and force discuss icebreaker ([icebreaker of active presence]); last beat is [last beat].";
		now active presence is attentive;
		if last beat is silence or ( last beat is not in FirstDT and last beat is not in SecondDT and last beat is not in ThirdDT and last beat is not in FourthDT and last beat is not in FifthDT and last beat is not in SixthDT and last beat is not in D7 ) begin;
			force discuss icebreaker of active presence;
		otherwise;
			if last beat suggests a beat, force discuss a random beat suggested by last beat;
		end if;
	end if.

Instead of saying farewell to someone when active presence is a dream presence and an active presence is in the location: say "You're not entirely sure if they're even here, and less sure how you would go about saying goodbye to them.".

Saved last beat is a beat that varies.  [ Allows us to interrupt a dream presence conversation and resume it. ]

convo-delay is a repeatable exciting beat. convo-delay suggests convo-delay2. convo-delay2 is a repeatable exciting beat. [ Useful for starting a conversation a move after a certain point, by letting convo-delay2 suggest things. ]

After discussing a terminal beat when location is a nexus-room and Completing-Progue's-Character-Arc is unsolved: becontact lucky windsigh. [ Terminal beats mean the tree has gotten its point across, and this dream can be considered a success. ]

To becontact lucky windsigh:
	if drama manager is being debugged, say "// Drama manager: becontact lucky windsigh.";
	let lucky be a random windsigh tree in saved location;
	if lucky is not a thing and saved location is Saddle, let lucky be tree3;
	if lucky is not a thing and saved location is Treehouse, let lucky be tree2;
	now lucky is contacted;
	if active presence is a dream presence, remove active presence from play.

Instead of exhausting a beat when a dream presence is attentive: do nothing.

To decide whether dream-door-locked is true:
	if nexus-counter >= 25, decide no;
	if escape tracker > 3, decide no;
	if active presence is dream-presence-rerun, decide no;
	if conversation fuse < 2, decide yes;
	if active presence is enclosed by location, decide yes;
[	if the number of spoken terminal beats in a random thread that encloses the icebreaker of active presence is 0, decide yes;]
	let lucky be a random windsigh tree enclosed by saved location;
	if lucky is not a thing and saved location is Saddle, let lucky be tree3;
	if lucky is not a thing and saved location is Treehouse, let lucky be tree2;
	if the number of visited flashback-rooms < scene_order of lucky, decide yes;
	decide no.

To say escapeattempt:
	increase escape tracker by 1.

escape tracker is a number that varies.

nexus-counter is a number that varies. After waiting when location is a nexus-room and the number of attentive people enclosed by location is 0: increase nexus-counter by 1; continue the action. Every turn when location is regionally in Lacuna and nexus-counter is not 0: now nexus-counter is 0.

Every turn when location is a nexus-room and yourself is asleep: increase nexus-counter by 1; if nexus-counter >= 25, say "[one of][closingtimemsg][or][cycling]". To say closingtimemsg: if location is Dream7Nexus begin; say  "High [d]up[x] above you, a shaft of colorless light streams down from the broken skylight."; otherwise if location is Dream6Nexus; say "Currents shift around you, shifting from directionless eddies to a powerful force impelling you [d]up[x]."; otherwise if location is Dream5Nexus; say "Curtains flutter on the french [o]doors[x], which suddenly seem closer than ever."; otherwise if location is Dream4Nexus; say "The bird in its [o]cage[x] looks at you quizzically, and flutters its wings in an anxious twitch."; otherwise if location is  Dream1Nexus; say "With a clunk of wood on wood, something behind the front [o]door[x] shifts."; otherwise if location is  Dream2Nexus; say "The steam and heat stop spewing from the dark [d]hole[x]; perhaps this is your chance to escape."; otherwise if location is Dream3Nexus; say "Your eye is drawn to the canvas; it just needs one touch of [o]paint[x] and it will be complete..."; end if. 

First instead of doing anything other than discussing or waiting or defining a password or saying yes or saying no when active presence is in location and active presence is attentive and last beat is not exciting: say "Everything but the presence has become faded and grey for the moment." instead. 

Section - Flashbacks

A flashback-room is a kind of room.

Before printing the name of a room when location is a flashback-room: say "{-(*".  After printing the name of a room when location is a flashback-room: say "*)-}". 

To begin-flashback-sequence:
	if last beat is not silence, now saved last beat is last beat;
	post-conversation processing;
	if saved location is Treehouse or saved location is Big Tree begin;
		now player is DB-Progue;
	otherwise if saved location is Fork;
		now player is DF-Lethe;
	otherwise if saved location is Cinder Cone;
		now player is DC-Phoebe;
	otherwise if saved location is Rockslide;
		now player is DR-Progue;
	otherwise if saved location is Forest9;
		now player is D9-Lethe;
	otherwise if saved location is Egg;
		now player is DE-Progue;
	otherwise if saved location is Saddle or saved location is Atop;
		now player is DA-Progue;
	otherwise;
		say "Error: dream for this location not yet written.";
	end if;
	change the command prompt to "{(*[printed name of player]*)}>"; 
	try looking.

A person-trigger is a kind of thing. A person-trigger is undescribed. Instead of doing something other than examining to a person-trigger (called pt) (this is the person triggers are weird rule), try examining pt. A person-trigger has a thing called target. [ This defines our ability to move between different people in a flashback. ]

Carry out examining a person-trigger (called pt):
	if player is target of pt, try examining player instead;
	ignore the report other people examining rule;
	let former player be player;
	say "       {(*[printed name of player]*)(*[target of pt]*)}|";
	now player is target of pt;
	say "{(*[printed name of player]*)(*[printed name of former player]*)}[line break]";
	change the command prompt to "{(*[printed name of player]*)}>";
	try looking instead.

After examining a person-trigger: do nothing.

A dream-lethe is a kind of woman. Understand "Laylay/sister" as a dream-lethe when player is a dream-phoebe. Understand "laylay/daughter" as a dream-lethe when player is a dream-progue. The printed name is "[if player is a dream-phoebe]Laylay[otherwise if player is a dream-lethe]Lethe[otherwise]your daughter Lethe[end if]". 

A dream-phoebe is a kind of woman. Understand "sister" as a dream-phoebe when player is a dream-lethe. Understand "daughter" as a dream-phoebe when player is a dream-progue. The printed name is "[if player is a dream-phoebe]Phoebe[otherwise if player is a dream-progue]your daughter Phoebe[otherwise]your sister Phoebe[end if]". 

A dream-progue is a kind of man. Understand "dad/daddy/father" as a dream-progue when player is a dream-lethe or player is a dream-phoebe.  The printed name is "[if player is a dream-progue]Progue[otherwise]dad[end if]". 

To say end-flashback: [When we've finished a flashback.]
	now player is yourself;
	change the command prompt to ">";
	try looking;
	if location is Dream5Nexus begin; say "Scratched film flickers through the projector; the catch reel is almost full. Something clunks within the cavernous metal interior, and the reels blur as film is fast-wound back, growing on the back reel like time-lapse footage. After a few moments of whirring there is another clunk, and the machine shuts off again."; now movie projector is switched off;
	otherwise; say "[one of]You start back, astonished. It was as if for those few minutes you had completely forgotten your own identity, as if it had been subsumed, submerged in the mind and memory of another, no signs of you even rippling the surface.[or]Again, you almost stagger as you abruptly become yourself again. You sink into these memories or dreams or visions so completely, you don't remember who you are until they end.[or][stopping]"; end if;
	if a dream presence is enclosed by location begin;
		now a random dream presence enclosed by location is attentive;
		now last beat is convo-delay;
		if saved last beat is not silence, now convo-delay2 suggests saved last beat;
		if dreams are being debugged, say "// Dreams: now ([a random dream presence enclosed by location]) is attentive; now convo-delay2 suggests [saved last beat].";
	otherwise;
		post-conversation processing; [clean up convos in flashback dreams.]
	end if. 



Section - Details and Implementation

Check landmark-listing when Having a Dream is happening: say "Everything here is a disorienting jumble." instead.

Report remembering when location of noun is regionally in Dreamlands: say "But that was just a dream." instead. Report remembering when location is regionally in Dreamlands: say "You can't see any such thing." instead.

Instead of going nowhere when location is a room in Dreamlands: say "You can't go that way.".

Instead of taking inventory when location is a room in Dreamlands, say "You can't quite seem to focus on what, if anything, you're holding."

Check waking up when location is regionally in Dreamlands (this is the can't wake up while dreaming rule): say "[if location is a flashback-room]But you're not asleep. At least, you don't think you are.[otherwise]You can't seem to wake yourself up.[end if]" instead.

Instead of doing anything to stuff when location is a room in Dreamlands, say "[one of]It seems somehow less real when you look at it directly[or]Every time you look away, it changes[or]Now that you look more closely, you realize it's actually [remembered thing][or]You can't seem to focus on it[or]It seems pale and unimportant[in random order].".

To say dream thing: say "[one of]stacks of fur hides[or]boxes of sand[or]crates and crates of paintbrushes[or]stacked easels[or]cans of paint[or]a row of glass dolls[or]forests of pine trees[or]stacks of cookware[or]stacks of tiny empty boxes[or]empty fish tanks[or]rows of empty shelves[or]stacks of folded clothes[at random]". [[or]miles and miles of books]

dream-thing-scenery is a backdrop. It is in Dreamlands. Understand "fur/hides/boxes/sand/crates/paintbrushes/easels/cans/row/glass/dolls/doll/forests/pine/trees/stacks/cookware/boxes/fishtanks/shelves/clothes" as dream-thing-scenery when location is regionally in Dreamlands. Does the player mean doing anything to dream-thing-scenery: it is very unlikely. Instead of doing anything other than examining or examining by name dream-thing-scenery, try examining dream-thing-scenery. The description of dream-thing-scenery is "It fades away when you try to look too closely.".

To say remembered thing:
	let stop-flag be false;
	while stop-flag is false and the number of entries of list of remembered stuff > 0 begin;
		let choice be number of entries of list of remembered stuff;
		if dream-text of entry choice of list of remembered stuff is not "" begin;
			say dream-text of entry choice of list of remembered stuff;
			now stop-flag is true;
		end if;
		remove entry choice from list of remembered stuff;
	end while;
	if stop-flag is false, say "[dream thing]".

Understand "dreamstuff" as saying-remem. Saying-remem is an action out of world applying to nothing. Carry out saying-remem: say remembered thing.

Understand "[greeting word] phoebe/lethe/dad/progue/sister" as greeting when location is a flashback-room. [We can normally do this, but since this matches the triggers, the "greet [a person]" grammar line doesn't work.]

Check sleeping: if location is regionally in Dreamlands, say "You feel wide awake." instead.


Book - Dream Rooms

Chapter - Dream 1

Section - Nexus 1

Dream1Nexus is a nexus-room in Dreamlands. The printed name of Dream1Nexus is "the tumble, studio". The description of Dream1Nexus is "The fire roars, stoked high with fresh-chopped wood, its bass growl mingling with the laughing soprano crinkles of the stream. Living pines form the great beams of the ceiling, their boughs swaying gently in invisible breezes and smelling of home and winter. But your canvases are gone, replaced by haphazard stacks of [remembered thing] and [remembered thing], floor to ceiling.[paragraph break]The front [d]door[x] of the lodge is shut tight. Vague premonitions hint at danger outside, some looming responsibility.[paragraph break]One [o]canvas[x] remains, huge, suspended in the center of the room and alive with motion[if d1-rebletter is in location][d1ltrapp][end if].".

Dream1Nexus-stuff is stuff in Dream1Nexus. Understand "fire/wood/growl/crinkles/stream/pine/pines/living/great/beams/boughs/breeze/breezes/canvases/stack" as Dream1Nexus-stuff when location is Dream1Nexus.

The d1-portal-canvas is an undescribed setpiece in Dream1Nexus. The printed name is "canvas". Understand "canvas" as d1-portal-canvas when location is Dream1Nexus. The description is "It twitches and moves, distorted and curling at the edges, more grain than image, a signal warped back on itself, degraded, dancing with particles of noise. But inside the chaos are forms, shapes, things, people.[if d1-portal-trigger is on-stage][paragraph break]You wonder what paints the artist used to produce the effect. Perhaps if you stepped [d]closer[x]...[end if]". Instead of entering or touching or taking d1-portal-canvas when d1-portal-trigger is on-stage, try examining d1-portal-trigger. 

d1-portal-trigger is part of d1-portal-canvas. Understand "closer" or "step closer" as d1-portal-trigger when location is Dream1Nexus.

Instead of examining d1-portal-trigger: say "You step towards the painting in wonder. The swirling image fills your field of vision, swarming past the surface of your eyes and into your optic nerves, into your brain, and inside that, your mind...[paragraph break]{(*mind*)}[line break]"; begin-flashback-sequence; remove d1-portal-trigger from play. 


The d1-door is an undescribed setpiece in Dream1Nexus. The printed name is "front door". Understand "door" as d1-door when location is Dream1Nexus.  [Instead of doing anything other than examining or examining by name or opening the d1-door, try examining d1-door.] Instead of opening d1-door when dream-door-locked is true, say "The door is stuck fast.[escapeattempt]". Instead of opening d1-door: say "The door swings wide, and behind it sears a burst of blazing light..."; wake up now. Instead of examining d1-door, try opening d1-door. 

The mail slot is part of d1-door. The description is "Strange, you never noticed it before. Perhaps Rume had it put in while you were gone.".

Section - Presence Convo 1

dream1-presence is a dream presence in Dream1Nexus. The icebreaker of dream1-presence is fd_preattention.

FirstDT is a thread. 

fd_preattention is an exciting beat in FirstDT. fd_preattention suggests fd_attention. fd_attention replaces fd_preattention.

fd_attention is an exciting repeatable beat in FirstDT with reaction "[d1_attention][unless d1_ctr > 6 and d1_ctr < 11].[end if]". fd_attention summons fd_presence. fd_attention suggests fd_attention. fd_presence replaces fd_attention.

d1_ctr is a number that varies.

To say d1_attention:
	increase d1_ctr by 1;
	if d1_ctr is 1, now pr-hack is false;
	if d1_ctr is 1, say "Something tickles the back of your neck, as if someone stands next to you. When you turn to look there is nothing, but the feeling of [o]presence[x] lingers, strengthens";
	if d1_ctr is 2, say "The sensation of [o]presence[x] swells. You can see and hear nothing, but know nonetheless it is there";
	if d1_ctr is 3, say "The [o]presence[x] fades, receding like a wave from your consciousness, then seeps and surges back again, as if with great difficulty";
	if d1_ctr is 4, say "The strange [o]presence[x] lingers on the edge of your consciousness, fading, like a sound you aren't quite sure comes from the world and not your head";
	if d1_ctr is 5, say "The sensation of [o]presence[x] ebbs, fades slowly away till it almost merges with the static of your mind, only a sliver of identity separating the two";
	if d1_ctr is 6 begin; say "The presence is gone"; remove a random visible dream presence from play; now pr1-hack is true; end if;
	if d1_ctr > 10 begin; say "Slowly, you feel the [o]presence[x] return"; move active presence to location; now active presence is attentive; now tempfuse of icebreaker of active presence is 5; now d1_ctr is 0; end if.

pr1-hack is a truth state that varies.

Every turn when pr1-hack is true:
	if active presence is enclosed by location:
		now pr1-hack is false;
	else if player is in a nexus-room:
		say "[d1_attention][unless d1_ctr > 6 and d1_ctr < 11].[end if]";
	else if the player is not regionally in Dreamlands:
		now pr1-hack is false.


Understand "presence/presences/they/them" as fd_presence. fd_presence is a beat in FirstDT with fuse 99 and reaction "You concentrate on the sensation, probe it delicately, curiously. And feel it probe back.[paragraph break]A [o]mind[x].". fd_minds replaces fd_presence. fd_presence suggests fd_minds.

Understand "mind" as fd_minds when last beat is in FirstDT. fd_minds is a beat in FirstDT. The reaction is "You recognize the mind as such only basely, innately through some whiff, strange but familiar, of consciousness. Overwhelmingly alien currents whirl through it, patterns and structures you have no way of matching to your own mind's contours, but after a moment you detect hints of emotions, faint yet certainly distinct from your own: [t]relief[x], [t]curiosity[x], [t]impatience[x]. You sense you could probe any of these feelings, like memory, but also sense inevitable reciprocity: doing so will reveal more of yourself in return.". fd_minds suggests fd_dreamhint. fd_minds summons fd_relief, fd_curiosity, fd_impatience. fd_dreamhint replaces fd_minds.

fd_dreamhint is a beat in FirstDT with reaction "In a charge of insight you are at once sure, with the surety that comes only in dreams, both that you are dreaming now and that this [o]presence[x] exists outside your dream. It has the same intrusive heaviness of a sound slowly pulling you up to wakefulness, or a light in darkness, flashing against closed lids.". fd_dreamhint suggests fd_minds. fd_dreamhint2 replaces fd_dreamhint.

fd_dreamhint2 is a beat in FirstDT with reaction "You wonder now whether the weave of this dream, its set and props, are not random noise but somehow shaped by this presence, sculpted, as if trying to help you make connections, realizations, come to insights unexplainable in waking language.[paragraph break]You wonder next if that thought was your own.". fd_endyes replaces fd_dreamhint2. fd_dreamhint2 suggests fd_endyes.

Understand "relief" as fd_relief when last beat is in FirstDT. fd_relief is a beat in FirstDT with fuse 9 and reaction "[psychic link line]. The relief, you sense, covers a long feeling of frustration, tempered despair, the impotence of a job almost done but unable to be finished. Now something has changed for the better, sudden, unexpected, trailing long after abandoned hopes. And that change, unsettlingly, is you.". fd_relief suggests fd_dreamhint. fd_dreamhint replaces fd_relief.

Understand "curiosity" as fd_curiosity when last beat is in FirstDT. fd_curiosity is a beat in FirstDT with fuse 9 and reaction "[psychic link line]. The curiosity is intense, as if you're the first of your kind the presence has ever encountered.[paragraph break]But no, that isn't right. You struggle to sieve the alien thoughts, distill them into something you can process. Not the first, you realize after long moments. No. The... fourth?". fd_curiosity suggests fd_dreamhint. fd_dreamhint replaces fd_curiosity.

Understand "impatience" as fd_impatience when last beat is in FirstDT. fd_impatience is a beat in FirstDT with fuse 9 and reaction "[psychic link line]. Impatience, yes; you sense more, much more the presence wants to tell you. But each of you have much to learn about the other before enough understanding has kindled to say it.". fd_impatience suggests fd_dreamhint. fd_dreamhint replaces fd_curiosity.

To say psychic link line: say "[one of]Thoughts trickle into your head as you prod delicately at the emotion, like juice from an overripe fruit[or]More thoughts, more emotion[or]You prod further[summonendyes][stopping]".

To say summonendyes: now fd_endyes is exciting; now tempfuse of fd_endyes is 5.

fd_endyes is a terminal beat in FirstDT. The reaction is "Some current of thought stirs, obscured, and slowly, slowly begins to clear. Finally you think you have it. Sleeping near the tree you painted-- and the others like it-- allow this connection with the presence, this alien mind. As if it is a receiver--? But no, you only speculate; the complexities running under and through this simple message cannot bridge the gap between the differences in your minds.[paragraph break]All you are sure is that it wants you to find them. Find them all.[paragraph break]The presence ebbs away, loses itself in the static of your mind, and is gone.". 




Section - Rebel Convo 1

Every turn when location is Dream1Nexus and d1-rebletter is off-stage and the player has been in Dream1Nexus for at least 2 turns and conversation fuse >= 1 and active presence is not in location and yourself is asleep:
	move d1-rebletter to location;
	move gloved hand to location;
	say "Out of the corner of your eye, you spot a gloved hand push a [o]letter[x] through the mail slot in the front door. It falls with a tiny crinkle to the wooden floorboards.";

The gloved hand is set dressing. The description is "Already vanished.".

[The letter can be open or closed. (And is uncloseable once opened). When it is closed we understand "seal" as letter. ]

The d1-rebletter is an undescribed container. It is closed and openable. Understand "letter/seal" as d1-rebletter. The printed name is "letter". The description is "[if d1-rebletter is open][d1rebmsg][otherwise]The fine parchment, a rich and creamy brown with flecks of texture, is neatly folded into thirds and closed with a red wax seal, adorned with a stylized symbol of a bare foot pulling itself free of entangling vines.[end if]".  To say d1ltrapp: say ". A[if d1-rebletter is closed]n unopened[end if] [o]letter[x] lies near the door".

To say d1rebmsg: say "Written immaculately in dark ink on the inside, in a fine, cursive hand, are the words:[paragraph break][i]Testing, test, test, test.[paragraph break]One two three. How are--- are we---[paragraph break]Testing. Testing. Te---[paragraph break]I don't think it's working.[r]".

First report opening d1-rebletter: now d1-rebletter is unopenable; say "You break the seal on the letter and unfold it, parchment crinkling heavily under your fingers. [d1rebmsg]" instead. Instead of opening d1-rebletter when d1-rebletter is open, try examining d1-rebletter. Instead of reading d1-rebletter, try opening d1-rebletter. Instead of closing d1-rebletter when d1-rebletter is open, say "You've already broken the seal.". Instead of attacking d1-rebletter when d1-rebletter is open: move d1-rebletter to Your Bedroom; say "You rip the letter into tiny shreds, which fall to the ground and sink into the gaps in the floorboards and vanish.". Instead of attacking d1-rebletter: try opening d1-rebletter. Instead of burning d1-rebletter: move d1-rebletter to Your Bedroom; say "You toss the letter into the fire, where it immediately catches as if made of gasoline and in moments has disintegrated." 







Chapter - Dream 2

[Inside the volcano. Rebels carve a message into the wall. Scene is a pool of boiling lava. Exit is crack up towards light. Trees explain concept of hive mind.]


Section - Nexus 2

Dream2Nexus is a nexus-room in Dreamlands. The printed name of Dream2Nexus is "inside the volcano". The description of Dream2Nexus is "You stand in the center of some huge cavern, miles below the island in the fiery roots of the volcano. Waterfalls of lava and explosions of steam fill the superheated air with deep red glows and burning chaos. Strange shadows dance on the walls, [if d2-message is in location][o]shapes[x] that look curiously like writing[otherwise]that sometimes remind you of [remembered thing] and sometimes look like [remembered thing][end if]. From your precarious ledge there is no sane way up or down, except perhaps for a dark [o]hole[x] near your feet spouting breaths of sulfuric steam.[paragraph break]A river of [o]lava[x] churns slowly past you, bubbling and steaming like an ancient fire demon, real and alive.".

Dream2Nexus-stuff is stuff in Dream2Nexus. Understand "center/cavern/island/roots/volcano/waterfall/waterfalls/explosions/steam/glows/chaos/shadows/ledge" as Dream2Nexus-stuff when location is Dream2Nexus.

A river of lava is an undescribed setpiece in Dream2Nexus. The description is "The surface of the lava twitches and dances, fragments of black dissolving into cracks of red, yellow, and gold, which slowly fade again to blackness[if d2-portal-trigger is on-stage]. But as you watch the process speeds up, faster and faster, until it becomes a multihued blur of fire, so complex you almost think you can see [d]patterns[x] in the chaos[end if].".

d2-portal-trigger is part of river of lava. Understand "pattern/patterns" as d2-portal-trigger when location is Dream2Nexus.

Instead of examining d2-portal-trigger: say "Despite the heat, you find yourself drawn closer and closer to the lava. The patterns become more and more distinct. You reach out a hand and suddenly they pull you in, under the surface, heat stabbing into your eyes and straight back into your memory...[paragraph break]{(*memory*)}[line break]"; begin-flashback-sequence; remove d2-portal-trigger from play. 

The dark-hole is an undescribed setpiece in Dream2Nexus. Understand "dark/hole" as dark-hole when location is Dream2Nexus. The printed name is "dark hole". The description is "The hole, just wide enough for you to enter, heads steeply [down] and immediately vanishes into solid black heat.". First instead of going down when location is Dream2Nexus: try entering dark-hole. Instead of entering dark-hole when dream-door-locked is true, say "A belch of burning steam explodes from the hole, and you draw back, afraid.". Instead of entering dark-hole: say "Fighting hot fear, you put your feet into the hole and push off down the chute. Instantly blackness and choking, unbearable heat surround you. Faster and faster you slide down the chute until suddenly it vanishes and you are falling, falling into infinite blackness, falling to the center of the earth...[paragraph break]You snap your eyes open and gasp, trembling, covered in sweat."; wake up now. 

Section - Presence Convo 2

dream2-presence is a dream presence in Dream2Nexus. The icebreaker of dream2-presence is d2_icebreaker.

SecondDT is a thread.

d2_icebreaker is an exciting repeatable beat in SecondDT with reaction "[d1_attention][unless d1_ctr > 6 and d1_ctr < 11].[end if]". d2_icebreaker summons d2_1. d2_icebreaker suggests d2_icebreaker. d2_1 replaces d2_icebreaker.

Understand "presence/presences/mind/minds" as d2_1 when last beat is in SecondDT. d2_1 is a beat in SecondDT with reaction "The presence is satisfied. You do wish to listen, to hear and learn more. You sense it gather itself, concentration crinkling the ridges of thought as it tries with smoldering intensity to communicate.[paragraph break]Slowly, a concept takes place in your mind, like a long-forgotten word on the tip of your tongue, before finally breaking through, and as soon as it does you sense its truth.[paragraph break]There is not one presence, but [o]many[x].". d2_1 summons d2_2. d2_1 suggests d2_2. d2_2 replaces d2_1.

Understand "many" as d2_2 when last beat is in SecondDT. d2_2 is a beat in SecondDT with reaction "Now that you concentrate it seems obvious: yes, many minds, many small whispers, each distinct, but speaking together, all collaborating in their attempt to reach you. A handful are nearby, but behind them are the shadows of countless more, and some hidden sense suggests that distance is very far indeed.". d2_2 suggests d2_3. d2_3 replaces d2_2.

d2_3 is a beat in SecondDT with reaction "It is so terribly slow, this communication, but another concept begins to come to you, a bubble rising through cold molasses.[paragraph break]These minds speak to each other in the same way they speak to you. The reason it is so difficult to reach you is that...[paragraph break]No, you can't quite grasp it. It's too hard. As if their minds are so different from yours that even the simplest...[paragraph break]Ah. That's it. That's it exactly. Only in dreams, when your mind is open to the slightest hint of suggestion, can they reach you now. Slowly your mind and theirs are learning to sense each other, to communicate.". d2_3 suggests d2_4. d2_4 replaces d2_3.

d2_4 is a terminal beat in SecondDT with reaction "And slowly you become aware of something else. These minds exist only as minds, in some abstract civilization of pure thought. The first one like you they tried to reach...[paragraph break]The first?[paragraph break]But already the minds fade, and moments later, they are gone.".


Section - Rebel Convo 2

Every turn when location is Dream2Nexus and d2-message is off-stage and the player has been in Dream2Nexus for at least 3 turns and active presence is not in location and conversation fuse >= 1 and yourself is asleep:
	move d2-message to location;
	say "On a nearby wall of polished black lava, you notice the steam coalescing into strange [o]shapes[x].".

The d2-message is a setpiece. Understand "shape/shapes" as d2-message when location is Dream2Nexus. The printed name is "shapes on the wall". The description is "As you stare at the shapes, you realize the steam [one of]is condensing[or]has condensed[stopping] onto the black surface in the shape of [o]letters[x], some script unknown to you, but strangely you find you can understand it."

The d2-letters is part of the d2-message. Understand "letters/writing/message/shadows" as d2-letters. The printed name is "message". The description is "You step closer and read the message:[paragraph break][i]What? Yes, we're transmitting. Shh. Hello? Ah. Fantastic. The Beast still works after all these years, it would seem. Well, there's not much time. We can only hack the signal for so long before... but listen to me, dithering. Greetings. Sincerest of greetings, whoever you are.[paragraph break]Let me be brief. These dreams you're having are dangerous. Don't believe everything you hear and see. There may be, well, motives at play, ulterior and otherwise. They may not have your best interests in mind.[paragraph break]Don't trust them. They've been using people like you for thousands of years. Yes, yes, who are 'they' and all that... there's no time to get into details, but soon we'll be able[r][paragraph break][one of]You watch for a long moment, but no further letters appear[or]And there the message on the wall stops[stopping].".



Chapter - Dream 3


Section - Nexus 3

Dream3Nexus is a nexus-room in Dreamlands. The printed name of Dream3Nexus is "the windowed veranda". The description of Dream3Nexus is "Sunlight streams through the [o]windows[x], brightening the warm interior of the porch and the nicknacks and curios that line its walls: [dream thing] and [remembered thing] and [remembered thing] and [dream thing]. Yes, you remember this place. This was home, for a time. Wrinkled relatives with forgotten names and faces had taken you in, and gave you this place to paint in. Before it happened. Before you could wayfare.[paragraph break]An old easel stands in the center of the room, your [o]landscape[x] atop it, almost finished. Beside, atop an old hope chest, is a yellow plastic box of [o]watercolors[x]."

Dream3Nexus-stuff is stuff in Dream3Nexus. Understand "sunlight/porch/nicknacks/curios/home/relatives" as Dream3Nexus-stuff when location is Dream3Nexus.

A dn3-canvas is an undescribed setpiece in Dream3Nexus. The printed name is "easel and canvas". Understand "canvas/painting/landscape" as dn3-canvas when location is Dream3Nexus. The description of dn3-canvas is "Ah, you remember this one. You started to [d]paint[x] it years ago. Though it might look done to an untrained eye, you remember there are still hours of work to do. It's an epic tropical landscape, showing a [if player is female]wo[end if]man sleeping [if saved location is Fork]near a fork in an overgrown forest path[otherwise if saved location is Big Tree or saved location is Treehouse]in an overgrown treehouse draped with vines[otherwise if saved location is Cinder Cone]at the base of a strange tree growing within a volcano caldera[otherwise if saved location is Forest9]at the base of a strange tree in a sprawling rain forest[otherwise if saved location is Saddle or saved location is Atop]at the base of a huge tree growing on a ridge of a tropical island[otherwise if saved location is Egg]in a crater buried inside rain forest[otherwise]in a mossy hollow among a tumbling rockslide[end if].". Instead of vague painting when location is Dream3Nexus: try painting dn3-canvas. Instead of touching dn3-canvas: try painting dn3-canvas. Instead of painting dn3-canvas when dream-door-locked is true, say "Your thoughts are muddled; you can't decide what still needs to be done on the painting.". Instead of painting dn3-canvas: say "Finally, you see what needs to be done. Just a touch up on the sleeping [if player is female]wo[end if]man. You reach out your brush to retouch the head...[paragraph break]Something tickles you, and you awaken."; wake up now. Instead of taking dn3-canvas: say "It's small and light, but you have nowhere else to be but here.". Instead of touching or entering dn3-canvas, say "No, this is just a regular painting; you won't leave this world for another year yet.".

Some veranda-windows are a setpiece in Dream3Nexus. Understand "window/windows" as veranda-windows when location is Dream3Nexus. The printed name is "windows".  The description is "The windows admit warm rays of summer light, but through them a static grainland gyrates instead of a view, a fuzz-blur where strange [if d3-portal-trigger is on-stage][d]images[x][otherwise]images[end if] flicker and die and flicker again, their motions jerky, leaving trails of compression artifacts behind.". Check opening veranda-windows when d3-portal-trigger is on-stage: try examining d3-portal-trigger instead. Check opening veranda-windows: say "Somehow now the windows cannot be opened; they seem in fact to be painted over, as if they haven't opened in years and years." instead.

d3-portal-trigger is part of veranda-windows. Understand "images" as d3-portal-trigger when location is Dream3Nexus.

Instead of examining d3-portal-trigger: say "You step up to the windows, the golden sunlight piercing your skin with a translucent glow, and throw them wide, letting the static in to tune your mind...[paragraph break]{(*mind*)}[line break]"; begin-flashback-sequence; remove d3-portal-trigger from play.


Section - Presence Convo 3

dream3-presence is a dream presence in Dream3Nexus. The icebreaker of dream3-presence is d3_icebreaker. Understand "presence/presences/mind/minds" as d3_1 when last beat is in ThirdDT.

ThirdDT is a thread.

d3_icebreaker is an exciting repeatable beat in ThirdDT with reaction "[d_attention].". d3_icebreaker summons d3_1. d3_icebreaker suggests d3_icebreaker. d3_1 replaces d3_icebreaker.

d_ctr is a number that varies.

To say d_attention:
	increase d_ctr by 1;
	if d_ctr is 1, now pr-hack is false;
	if d_ctr is 1, say "[one of]The [o]minds[x][or]The [o]presences[x][at random] [one of]return[or]come back[or]trickle into your thoughts[or]become separate from your mind's background noise[in random order][one of] again[or][at random], [one of]hovering patiently in no-space, here and not here, waiting for your attention[or]silent and respectful, eager to tell you more[in random order]";
	if d_ctr is 2, say "The [o]presences[x] fade for a moment, gradually, receding like a wave from your consciousness. Then, in some strange peristaltic contraction, the sensation returns, as if with great difficulty";
	if d_ctr is 3, say "The strange [o]presence[x] on the edge of your consciousness lingers, like a sound you aren't quite sure you can hear";
	if d_ctr is 4, say "The sensation of [o]presence[x] begins to ebb, fading away, losing itself in the static of your mind";
	if d_ctr is 5, say "The [o]minds[x] have nearly faded away";
	if d_ctr is 6 begin; say "The minds are gone"; remove a random visible dream presence from play; now pr-hack is true; end if;
	if d_ctr > 10 begin; say "Slowly, you feel the [o]presences[x] return"; move active presence to location; now active presence is attentive; now tempfuse of icebreaker of active presence is 5; now d_ctr is 0; end if.

pr-hack is a truth state that varies.

Every turn when pr-hack is true:
	if active presence is enclosed by location:
		now pr-hack is false;
	else if player is in a nexus-room:
		say "[d_attention][unless d_ctr > 6 and d_ctr < 11].[end if]";
	else if the player is not regionally in Dreamlands:
		now pr-hack is false.

d3_1 is a beat in ThirdDT with reaction "The presences swirl turgidly, ready, eager to resume. But for long moments only vaguely portentous thoughts drift, and do not coalesce.[paragraph break]Finally, you realize they do not try to tell you something, but ask a question, and the question is simple: How did you get here?[paragraph break]How. You could try to [t]explain[x] wayfaring to these alien minds, you suppose, but could they understand or believe? And perhaps you should stay [t]silent[x], anyway, at least for now.". d3_1 summons d3_explain, d3_silent. d3_1 suggests d3_silent. d3_silent replaces d3_1.

Understand "explain" as d3_explain when last beat is in ThirdDT. d3_explain is a beat in ThirdDT with reaction "You explain without words, awkward and uncertain, struggling to summon concepts and images that tell the story, and finally settle on your first conceptualization of the experience, all those years ago. First you are somewhere. Then you are somewhere else.[paragraph break]The minds churn, processing silently, sedate and inscrutable.[paragraph break]Finally a conclusion breaks through mental fog. They do not understand how this can be, but they agree it is possible. And it may be [t]related[x] to their civilization's greatest gift.". d3_explain summons d3_related. d3_related replaces d3_explain. d3_explain suggests d3_related.

Understand "related" as d3_related when last beat is in ThirdDT. d3_related is a terminal beat in ThirdDT with reaction "They struggle to explain-- but does it come quicker this time? Are they learning more of how your brain is wired, how your neurons function to retrieve image, memory, abstractions?[paragraph break]You begin to know the scale of their civilization: not hundreds or thousands of minds but billions, spread across vast interstellar distances. And yet they are all together, and always, the concept of distance mere abstraction. Like wayfaring, perhaps.[paragraph break]But the effort fades them, and in moments, they are gone.".

Understand "silent" as d3_silent when last beat is in ThirdDT. d3_silent is a beat in ThirdDT with reaction "You do not offer explanation, and you sense that the medium of thought between you is still murky enough they will only think they cannot understand.[paragraph break]After long moments of searching, questioning, mental muscles relax, probing fades. They do not understand how you arrived. But nor did they understand the arrival of the [t]first[x]. Mysteries, they think.". d3_silent summons d3_first. d3_silent suggests d3_first.

Understand "first" as d3_first when last beat is in ThirdDT. d3_first is a terminal beat in ThirdDT with reaction "Confusion roils, obscuring meaning, and little becomes clear except that you are not the first of your kind they have communed with. They fade again, tired, slowly slipping away, but struggle before they vanish to send to you a piece of stored knowledge, a pattern in the other's brain that connected to your strange physiology to produce a sound, a word. A name.[paragraph break]Progue.[paragraph break]And they are gone.". 

Section - Rebel Convo 3

A box of watercolors is an undescribed container in Dream3Nexus. It is closed and openable and fixed in place. Understand "watercolor" as box of watercolors. The description is "No, that's wrong: you'd long since moved past this cheap dime store set by now, bright primary colors stamped into the plastic case. But here it is[if closed], lying closed atop the hope chest. You wonder if the tiny ovals with their congealing powdery paint are still inside[end if].". A folded note is inside box of watercolors. The description is "You carefully unfold the note, written on large-ruled paper in pencil, and recognize your own handwriting.[paragraph break][i]I still haven't explained who we are. Sorry for that. So much to explain, so little bandwidth. For now just know that I am here to present an opposing viewpoint. At tremendous expense to an entire government, I might add if it will pique your interest.[paragraph break]We're still working out some kinks with the Beast. It's my hope we'll soon be able to talk directly, if all goes well. In the meantime, I certainly hope you've realized these aren't just dreams. They're not. Rather important things hang in the balance. So do try to pay attention.[paragraph break]Time's up. Oh well. I like you better than the last one, at any rate.[r]". Instead of taking box of watercolors: say "For some reason, it is nailed to the hope chest; but it looks like you could still open it.". Report opening box of watercolors: say "You swing the flimsy plastic lid open, but the row of colored ovals inside is gone; only a small folded [o]note[x] fills the space." instead. 

The hope chest is a closed locked undescribed container in Dream3Nexus. 



Chapter - Dream 4

[Library on Keros. Rebel message in book (turn to a page?). Scene is on the cover. Exit is staircase out. Trees explain that something went wrong and they were cut off.]


Section - Nexus 4

Dream4Nexus is a nexus-room in Dreamlands. The printed name is "great library on keros". The description of Dream4Nexus is "Yes, you remember this place. For a time, you studied here, before moving on. Huge alabaster columns flecked with gold lift a domed ceiling high, high above, letting the cavernous space beneath burn pink and gold in slanting arcs of sunlight. Rows and rows of desks filled with black-robed scholars line the floor, the sounds of squeaking chairs and scribbling quills vanishing into swirling sunlit dust above.[paragraph break]You sit at one of the hundreds of desks, age-blackened wood in elegant straining curves, immaculately polished, resting on the marbled floor.[paragraph break]On the desk sits a dusty [o]tome[x][one of][or], [if dusty-tome is open]open[else]closed[end if][stopping]. Atop the hutch is a silver [o]birdcage[x] containing a sleeping yellow canary.".

Dream4Nexus-stuff is stuff in Dream4Nexus. Understand "library/alabaster/columns/gold/dome/domed/space/arcs/sunlight/row/rows/desks/scholar/scholars/chair/chairs/quill/quills/dust" as Dream4Nexus-stuff when location is Dream4Nexus.

The desk is an undescribed supporter in Dream4Nexus. 

The dusty-tome is a container on the desk. It is openable and closed. Understand "book/volume/page/dusty/tome" as dusty-tome. The printed name is "dusty tome". The description is "It must be one of the thirty million volumes held by the Great Library. It looks ancient but in good condition, [if dusty-tome is closed]unopened[otherwise]opened to a yellowed page[end if], the binding solid, the page edges yellow and musty[if dusty-tome is closed and d4-portal-trigger is on-stage].[paragraph break]There is something wrong with the [o]front[x], though.[else if dusty-tome is closed and page_num of dusty-tome is not -1]. You wonder what its mouldering pages contain.[else], the text reading:[line break][tryreadingtome]". The book-cover is part of the dusty-tome. Understand "front" as book-cover when location is Dream4Nexus. The printed name of book-cover is "front of the book". The description of book-cover is "The cover is carved in intricate relief, and edged with a design so busy it seems as if it moves[if d4-portal-trigger is on-stage]. In fact, the whole book seems to crawl with [d]detail[x][end if], millions of particles of ancient leather and embossed metals twitching and swirling around one another, as if alive.". Check taking dusty-tome: say "It's so heavy, you can hardly lift it." instead.

d4-portal-trigger is part of dusty-tome. Understand "detail/details" as d4-portal-trigger when location is Dream4Nexus. Instead of examining d4-portal-trigger: say "You place your hand on the swirling cover, mesmerized by its intricate motion, and suddenly the design leaps past your hand, spirals up your arm and plunges straight into your heart...[paragraph break]{(*heart*)}[line break]"; begin-flashback-sequence; remove d4-portal-trigger from play.

[Instead of examining dusty-tome when dusty-tome is closed, try examining book-cover.] Instead of reading dusty-tome when dusty-tome is closed, try opening dusty-tome. 

First Instead of exiting when location is Dream4Nexus: say "Curiously, you seem to be chained to the desk.". First Instead of going nowhere when location is Dream4Nexus: try exiting. Some chains are a minor setpiece in Dream4Nexus. Understand "chain" as chains. The description is "Thick and solid.". 

A silver birdcage is a transparent undescribed container in Dream4Nexus. It is fixed in place. Understand "cage" or "bird cage" as birdcage. A silver birdcage is closed, openable. The description is "Finely wrought from tiny strands of silver, the cage holds a brilliant lemon-yellow canary, sleeping fitfully with head under one wing.". Instead of opening birdcage when dream-door-locked is true, say "A tall, gaunt librarian walks by just as you reach for the cage, trailing a long black cape that whispers on the marble, and frowns at you. You hastily pull your hand back.". Instead of opening birdcage: say "You reach forward and open the cage. Inside, the bird stirs. Then, suddenly, it throws back its head and lets out a piercing call that echoes crazily around the huge library hall. Hundreds of heads look up and stare as you frantically try to silence the bird, but it just keeps chirping and chirping...[paragraph break]You awaken to the sound of birds."; wake up now. Instead of taking silver birdcage: say "It seems impossibly heavy, or perhaps it is attached to the top of the desk.".

A yellow canary is an animal in silver birdcage. Understand "bird" as canary. The description is "The bird's color is beautiful. It sleeps fitfully, one wing tucked under its arm.". 

The scholars are an undescribed setpiece in Dream4Nexus. The printed name is "black-robed scholars". The librarian is an undescribed setpiece in Dream4Nexus.





Section - Presence Convo 4

dream4-presence is a dream presence in Dream4Nexus.  The icebreaker of dream4-presence is d4_icebreaker. 

FourthDT is a thread.

d4_icebreaker is an exciting repeatable beat in FourthDT with reaction "[d_attention].". d4_icebreaker summons d4_1. d4_icebreaker suggests d4_icebreaker. d4_1 replaces d4_icebreaker.

Understand "mind/minds/presence/presences" as d4_1 when last beat is in FourthDT. d4_1 is a beat in FourthDT with reaction "They are glad you wish to hear.[paragraph break]The concepts come more quickly now. An image takes shape in your mind, and very quickly you are able to identify it as Progue. A strange mixture of emotions swirls around their conception of him: unalloyed joy and [t]surprise[x], at first, but then great [t]frustration[x].". d4_1 suggests d4_2. d4_1 summons d4_frustration, d4_surprise. d4_2 replaces d4_1.

Understand "frustration" as d4_frustration when last beat is in FourthDT. d4_frustration is a beat in FourthDT with reaction "You sense that their communication with you is vastly easier than it was with him, that, for a long time, he did not even realize their soft whispers were different from his own subconscious urges-- and acted accordingly.". d4_frustration enqueues d4_2.

Understand "surprise" as d4_surprise when last beat is in FourthDT. d4_surprise is a beat in FourthDT with reaction "They had been alone. They had expected to always be alone. And then there was another. Progue. Their astonishment and joy were limitless. For another meant friend, and friend meant help. And help meant a chance to finally realize their abandoned dreams.". d4_surprise enqueues d4_2.

d4_2 is a beat in FourthDT with reaction "Another image takes shape in your mind: a great device, glowing, egg-shaped, atop the mountain on Lacuna. It came with them but was broken. Progue helped them repair it.". d4_2 suggests d4_3. d4_3 replaces d4_2. d4_3 replaces d4_2.

d4_3 is a beat in FourthDT with reaction "It takes a long time for the next concept to become clear. They are trying to explain to you what the egg device does, why it is so important to them. Finally you think you have it: it connects them to the millions of other minds, the community, their civilization. Without it they have only each other. Without it they are stranded on Lacuna. Once Progue fixed it, they could rejoin their kind, and for that they are eternally grateful.". d4_3 suggests d4_4. d4_4 replaces d4_3.

d4_4 is a terminal beat in FourthDT with reaction "You sense there is an unfinished part of the story, something else they asked of Progue. But the minds have grown weary from communicating so much, and already they are receding again, slipping back into the static of memory. Moments later, they are gone.".

[The presence returns, as if some sinewy tall librarian is standing behind you, observing. ]

Section - Rebel Convo 4

The dusty-tome has a number called page_num. The page_num of dusty-tome is 1.

First Report opening dusty-tome: say "You open the book[one of], turning past a beautiful frontispiece showing a woodcut of sinewy feet pulling free of entangling roots, and reach the first page, which[or] to the page you were on before, which[stopping] reads: [line break][tryreadingtome]" instead. To say tryreadingtome: try reading dusty-tome.

Instead of reading or opening dusty-tome when page_num of dusty-tome is -1, say "You open the book again, but the strange messages are gone, and all you see now are page after page of thousand-year-old poetry, inscrutable, encrusted with crumbling layers of footnotes.".

Instead of reading dusty-tome:
	if dusty-tome is closed, try opening dusty-tome;
	let pn be page_num of dusty-tome;
	if pn is 1 begin; say "[i]Pleasant dreams. So it looks as if they're telling you about Progue. That was years ago. I was still young. Ish. How strange to have it all start up again, now... because of you.[paragraph break]So I'm curious... have you worked out who *they* are yet?[r][line break]Below that, in a different, elegant font, is printed:[paragraph break][i]If yes, please consult page [t]472[x][i]. Otherwise, kindly refer to page [t]916[x].[r]";
	otherwise if pn is 472; say "[i]I thought you might have. You do seem sharper than the last fellow. Well, who are they then?[r][line break]In a smaller font below is the text:[paragraph break][i]Please look up your guess in the index.[r]"; now index_looking is true; 
	otherwise if pn is 916; say "[i]No? It's really not that hard to figure out. Although I suppose for someone from another world... well, it's best if you work it out for yourself.[paragraph break]But we were talking about your friend Progue. You see, this is our second time round. We tried to reach him, many years ago, but were unsuccessful.[r][line break]Below:[paragraph break][i]Continue on page [t]760[x][i], if you please.[r][x]"; now index_looking is false;
	otherwise if pn is 227; say "[i]Very good. You have some sense, then. Yes, the minds you hear speaking to you live within the strange trees on your island. Windsigh, I think Progue called them. Poetic. We have quite a different name for them, you understand. Not natives, you may have gathered, though they want to be. But we were talking about Progue.[r][line break]Below, in another font:[paragraph break][i]To inquire about Progue, consult page [t]760[x][i]. To converse about the windsigh, please turn to page [t]308[x].[r]"; now index_looking is false; now guessed_trees is true; 
	otherwise if pn is 855; say "[i]Who, us? No, we're not the same as the other voices. I thought you'd realized that by now. Try again.[r][line break]Below:[paragraph break][i]Or, turn to page [t]916[x][i] to give up.[r]";
	otherwise if pn is 869; say "[i]How poetic. Appearing in your dreams to give some cry for help he cannot give when awake? No, a good theory, but it makes no sense. Try again.[r][line break]Below:[paragraph break][i]Or, turn to page [t]916[x][i] to give up.[r]";
	otherwise if pn is 893; say "[i]Oh, what a white-knuckled hold we sentients keep on our sanity. So much so we'd rather believe we're talking to ourselves than hearing voices without explanation. But which is the saner? No; you're wrong. Guess again.[r][line break]Below:[paragraph break][i]Or, turn to page [t]916[x][i] to give up.[r]";
	otherwise if pn is 151; say "[i]Come on now, you can do better than that. I hope so, at least. Well. Want to guess again?[r][line break]Below that, in a different, elegant font, is printed:[paragraph break][i]If yes, please consult page [t]472[x][i]. Otherwise, kindly refer to page [t]916[x].[r]";
	otherwise if pn is 760; say "[i]The Beast was still a prototype then... meltdowns and overloads every time we tried to use her. So they had Progue more or less to themselves. We could hack in often enough to get a quick idea of what was going on, but that was about all. If only we'd managed to get the kinks out in a more timely... well, it's all in the past now. Who could have known we'd have a second chance?[r][line break]Below:[paragraph break][i]To inquire further as to the meaning of 'second chance,' kindly consult page [t]97[r][i]. To pursue the enigmatic phrase 'beast,' refer to page [t]692[x].";
	otherwise if pn is 97 or pn is 692; say "[i][if pn is 97]Yes. You, of course[else]It's the device, the machine I built, the somenium transceiver that's letting us contact you[end if].[paragraph break]Sorry, time's almost out. Suffice to say at the last minute we did succeed. In fact we were the ones who helped him finally figure out what was going on. One would think he'd have been more grateful, instead of---[r][paragraph break]Below this, centered and in small caps, it simply reads:[paragraph break][i]FIN[r][paragraph break]Thoughtfully, you close the book again."; now dusty-tome is closed; now page_num of dusty-tome is -1;
	otherwise if pn is 308; say "[i]My people have a long history with them. Long and not entirely pleasant. Have they told you yet that they are symbiotes? That's how they would think of it, at least. Know this, though: in nature, it is very rare when two species truly coexist, neither getting the best of the other. There are few who---[r][paragraph break]Below this, centered and in small caps, it simply reads:[paragraph break][i]FIN[r][paragraph break]Thoughtfully, you close the book again."; now dusty-tome is closed; now page_num of dusty-tome is -1;
	otherwise; say "[i]This page intentionally left blank.[r]";
	end if.

index_looking is a truth state that varies. guessed_trees is a truth state that varies.

To index_bit with p_t (pt - an indexed text) and real_word (wd - an indexed text) and p_num (pnum - a number):
	say "You look it up in the index, where the entry reads '[pt in upper case]";
	if pt is not wd in lower case, say ": see [wd].' Referring to that entry you are directed to page [pnum].";
	otherwise say ": see page [pnum].'";
	now page_num of dusty-tome is pnum.

After reading a command when index_looking is true:
	let p_text be indexed text;
	let p_text be the player's command;
	replace the regular expression "(consult tome about|look up|in index|consult index about|consult book about|consult page|consult)" in p_text with "";
	replace the regular expression "^\s*(.*)\s*$" in p_text with "\1";
	replace the regular expression " " in p_text with "";
	if p_text matches the regular expression "(trees?|windsighs?)" begin;
		index_bit with p_t p_text and real_word "WINDSIGH" and p_num 227;
		replace the player's command with "227";
	otherwise if p_text matches the regular expression "progue";
		index_bit with p_t p_text and real_word "PROGUE" and p_num 869;
		replace the player's command with "869";
	otherwise if p_text matches the regular expression "\b(subconscious|unconscious|myself|mind|brain|me)\b";
		index_bit with p_t p_text and real_word "SUBCONSCIOUS" and p_num 893;
		replace the player's command with "893";
	otherwise if p_text matches the regular expression "(dont know|give up|guess|no)";
		index_bit with p_t p_text and real_word "THEY, WHO ARE (giving up)" and p_num 916;
		replace the player's command with "916";
	otherwise if p_text matches the regular expression "\b(voice|book|you)\b";
		index_bit with p_t p_text and real_word "MYSTERIOUS VOICE, THE" and p_num 855;
		replace the player's command with "855";
	otherwise if p_text matches the regular expression "\b(rume|rengin|bevan|god|aaron|reed|aaronreed|aaronareed|aarona.reed|phoebe|lethe)\b";
		index_bit with p_t p_text and real_word "GUESSES, WILD" and p_num 151;
		replace the player's command with "151";
	end if.


Understand "[a number]" or "turn to page [a number]" or "turn to [a number]" or "look at page [a number]" or "examine page [a number]" or "x page [a number]" or "examine [a number]" or "x [a number]" or "page [a number]" or "consult page [a number]" or "consult [a number]" or "read [a number]" or "read on [a number]" or "go to [a number]" or "turn to page [a number]" as book-setting when location is Dream4Nexus. Book-setting is an action applying to one number. Check book-setting: if page_num of dusty-tome is -1, try opening dusty-tome instead. Carry out book-setting: now page_num of dusty-tome is the number understood; say "You turn to page [the number understood]. On it is printed:[line break]"; try reading dusty-tome instead.




Chapter - Dream 5

[In a Parlor. Rebels call on antique telephone. Scene is projected from an old movie projector. Exit is french doors. Trees explain that the pyramid lets them communicate, and Progue helped them build it.]


Section - Nexus 5

Dream5Nexus is a nexus-room in Dreamlands. The printed name is "in the parlour". The description of Dream5Nexus is "Stylishly patterned wallpaper, brick fireplace with a mantel topped with expensive trinkets, the smell of ancient wood furniture polished weekly by obsequious servants. You don't remember this place, specifically, but you suppose you've been places like this before. Several fine wooden doorways are completely jammed full of [remembered thing], blocking any movement in those directions, but an unobstructed set of french [d]doors[x] leads into a bright exterior.[paragraph break]Two antique curios occupy prominent positions among the parlour's decor: a black wall-mounted [o]telephone[x] and a lumbering movie [o]projector[x][if projector is switched on] (projecting a strange film on a discreetly hidden [o]screen[x])[end if].".

Dream5Nexus-stuff is stuff in Dream5Nexus. Understand "wallpaper/fireplace/mantle/trinkets/wood/furniture/servants/doorways/exterior" as Dream5Nexus-stuff when location is Dream5Nexus.

A movie projector is an undescribed device in Dream5Nexus. The description is "This great metal giant, pointing at a discreet screen on a wall between two bookcases, is already threaded with a large full reel of film, and an empty catch reel. A gleaming [o]toggle[x] is the only control you can understand.". First report switching on projector: say "The toggle flips with a satisfying snap, turning on a brilliant lamp inside the projector which casts distorted shadows across the parlour through the fluted vents on its sides. A whir of fans and deeper hum spring from the depths of the machine, and with a clattering jerk, the reel begins to rotate.[paragraph break]After a countdown from 5 and a few seconds of blackness, a phantasmagoric scene of shifting [d]imagery[x] appears on the movie screen, like some flurry of activity filmed with a lens extremely out of focus, but dense with grain, as if the grain itself is in focus while the image is not." instead. First report switching off projector: say "You flip the toggle with a solid thud. The lamp dies, the fans and humming throb fade away, and the image dissolves, the reel of film slowing to a stop." instead. A large full reel of film is part of movie projector. Instead of taking reel, say "The film is threaded through the projector, and you can't find any control to rewind it.". The description of reel is "Thirty-five millimeter." The projector-switch is part of movie projector. Understand "toggle" as projector-switch. The printed name of projector-switch is "toggle on the projector". The description is "The toggle looks like it can be switched on or switched off.". Instead of pushing or using or switching on projector-switch when projector is switched off: try switching on projector. Instead of pushing or pulling or using or switching off projector-switch when projector is switched on: try switching off projector.
 
The screen is a setpiece in Dream5Nexus. The description is "[if projector is switched on]The screen shows a frenetic smudge of shifting [imagerybit], constantly changing, never quite resolving into recognizable forms or figures[otherwise]Nothing is being projected onto the small white screen[end if].". To say imagerybit: say "[if d5-portal-trigger is on-stage][d]imagery[x][otherwise]imagery[end if]".

d5-portal-trigger is part of the screen. Understand "imagery" as d5-portal-trigger when location is Dream5Nexus. Instead of examining d5-portal-trigger: say "You stare at the strange film being projected onto the screen, and suddenly notice the space between screen and projector, a three dimensional volume of dancing dust motes brilliantly illuminated by the images. You realize that the image is being projected upon every invisible particle in that space, that the real image is not what is on the screen at the end, but in between...[paragraph break]{(*between*)}[line break]"; begin-flashback-sequence; remove d5-portal-trigger from play.

A set of french doors is a setpiece in Dream5Nexus. Understand "door/curtain/curtains" as set of french doors when location is Dream5Nexus. The description is "The doors, made of some rich red-brown wood, are elegantly curtained.". Instead of opening french doors when dream-door-locked is true: say "Strangely, though you keep walking towards the doors, you find you can never quite reach them.". Instead of opening french doors: say "You pull open the doors, and incredibly bright sunlight stabs into your eyes..."; wake up now. Instead of examining french doors, try opening french doors.



Section - Presence Convo 5

dream5-presence is a dream presence in Dream5Nexus. The icebreaker of dream5-presence is d5_icebreaker.

FifthDT is a thread.

d5_icebreaker is an exciting repeatable beat in FifthDT with reaction "[d_attention].". d5_icebreaker summons d5_1. d5_icebreaker suggests d5_icebreaker. d5_1 replaces d5_icebreaker.

Understand "mind/minds/presence/presences" as d5_1 when last beat is in FifthDT. d5_1 is a beat in FifthDT with reaction "The minds retreat for a moment, gathering their thoughts to explain one last chapter in their story, then return, ready.". d5_1 suggests d5_2. d5_2 replaces d5_1.

d5_2 is a beat in FifthDT with reaction "There were two favors they asked of Progue. The first, repairing the egg device and restoring them to their great community of thought, was done by him before he even realized they existed. As they whispered in his mind, guiding him first to find the device, then teaching him how to repair it, he took their images for intuition, gut feelings, a sixth sense. Only at the moment of completion did he realize there was an Other in his mind.". d5_2 suggests d5_3. d5_3 replaces d5_2.

d5_3 is a beat in FifthDT with reaction "They asked Progue to do something else for them, something, you sense, even more important. Though they try for long, long moments to explain, you cannot grasp what this second favor was.". d5_3 suggests d5_4. d5_4 replaces d5_3.

d5_4 is a beat in FifthDT with reaction "Eventually they stop trying to explain, and seem content that you understand it was an important request. They seemed to think Progue would fulfill it. But, unexpectedly, in the end he did not. He was angry, and they did not know why. He stopped talking to them, stayed away, and they do not know why. They are confused. But they have a theory.". d5_4 suggests d5_5. d5_5 replaces d5_4.

d5_5 is a beat in FifthDT with reaction "Another concept forms in your mind: the notion of another 'they,' distinct from the minds you've been speaking to, not exactly enemies, or opposed, but different, unknown, perhaps threatening. The minds think this other group influenced Progue, misled him, convinced him not to help them. They warn you this group might still exist.[paragraph break]A question forms. Have they tried to contact you?". Instead of saying yes or saying maybe when last beat is d5_5, force discuss d5_yes. Instead of saying no when last beat is d5_5, force discuss d5_no. d5_5 suggests d5_no. d5_no replaces d5_5.

d5_yes is a terminal beat in FifthDT with reaction "They are troubled by this, and you sense ripples of discontent stretching back into the shadowed millions in their great distant civilization of minds. Finally, when the ripples fade and the surface is calm enough for unity again, you can sense their ponderous thoughts.[paragraph break]They convey to you a simple warning. The others may be false. They may not have your best interests in mind. Be careful what you believe. Be on your guard.[paragraph break]They fade into a general foreboding sense of paranoia, and when it fades, are gone.".

d5_no is a terminal beat in FifthDT with reaction "Contentment. They convey to you that this is good. Perhaps the others no longer wish to meddle. Perhaps they have forgotten the tricks they used to interfere before.[paragraph break]Perhaps you will help us, though Progue did not.[paragraph break]They fade into a general hum of contentment, and when it fades, are gone.".



Section - Rebel Convo 5

An antique telephone is an undescribed device in Dream5Nexus. Understand "phone/microphone/earpiece/hook" as telephone. The description of telephone is "Made of finely polished brass and black wood, the telephone features a large mounted microphone and a separate earpiece, hanging on a delicate hook. There are no numbers.". Instead of taking telephone, try switching on telephone.  [Instead of answering that telephone, try taking telephone.] Understand "answer [telephone]" as switching on when location is Dream5Nexus. Understand "hang up [telephone]" as switching off when location is Dream5Nexus. Instead of switching on telephone when D5-Phone-Rings is not happening, say "You pick up the earpiece and hold it to your ear, but can hear nothing other than distant, almost imperceptible hissing and clicks.". First Report switching on telephone: say "You lift the receiver and hold it to your ear." instead. First report switching off telephone: say "You replace the receiver." instead. Instead of switching off telephone when reb-presence-5 is enclosed by location: say "You don't want to miss the end of such an important call.". Instead of using telephone, try switching on telephone. Understand "dial [telephone]" as switching on.

The reb-presence-5 is a person with printed name "reedy voice".

D5-Phone-Rings is a recurring scene. D5-Phone-Rings begins when location is Dream5Nexus and D5-Phone-Rings-hack and the player has been in Dream5Nexus for at least 2 turns and conversation fuse >= 1 and yourself is asleep and D5-Phone-Rings is not happening and active presence is not in location. To decide whether D5-Phone-Rings-hack: if D5-Phone-Rings ended successfully, decide no; decide yes.

Every turn during D5-Phone-Rings: say "[one of]The telephone rings loudly, a tiny hammer striking the brass bell, startling you.[or]The telephone rings again, shrill and insistent.[or]The telephone rings again.[or]The telephone falls silent.[cycling]".

D5-Phone-Rings ends when location is not Dream5Nexus.

D5-Phone-Rings ends successfully when telephone is switched on.

When D5-Phone-Rings ends successfully:
	say "Out of weird whorls and eddies of static, you hear a tinny voice clear its throat, then begin to speak. It is a [if player is female]wo[end if]man's voice, reedy, sarcastic, but confident.";
	remove dream5-presence from play;
	now dream5-presence is idle;
	now saved last beat is last beat;
	move reb-presence-5 to location;
	now reb-presence-5 is attentive;
	now last beat is RC5-pre.

Instead of switching off telephone when reb-presence-5 is in location: say "It would be rude to hang up in the middle of the call.". Instead of opening french doors when reb-presence-5 is in location: say "But you're on the telephone." Instead of examining d5-portal-trigger when reb-presence-5 is in location: say "But you're on the telephone.". Instead of exhausting when last beat is in RC5: force discuss rc5_notime. 

RC5 is a thread with escape clause Rc5-1. RC5-pre is an exciting beat in RC5. RC5-pre suggests RC5-1. rc5_notime is an ephemeral repeatable beat in RC5 with reaction "'There's no time,' the voice says hurriedly.".

RC5-1 is a beat in RC5 with reaction "'Hello,' it says dryly, 'at last we meet face to face, or ear to ear, as it were. Builder thank the [rc5_hackers], though we're still pressed for time if we don't wish to be caught. I'm Doctor [rc5_quick], and it is a pleasure to finally speak.'". rc5-1 suggests rc5_2. rc5_2 replaces rc5-1.

Understand "mindlisteners" as rc5_hackers. rc5_hackers is a beat in rc5 with keyword name "mindlisteners" and reaction "'You've no idea the work it takes to keep our little chats going,' the doctor says with a little yawn. 'I've been up all night recalibrating new protocols--- but never mind that now.'". rc5_hackers suggests rc5_2. 

Understand "doctor/quick" as rc5_quick. rc5_quick is a beat in rc5 with keyword name "Quick" and reaction "'Just an old proper name, of course,' the voice says. 'No time to get into the naming conventions of my [rc5_people], but it has proved to be remarkably accurate, I suppose.'". rc5_quick suggests rc5_2. rc5_quick summons rc5_people.

Understand "people/race" as rc5_people. rc5_people is a beat in rc5 with keyword name "[if last beat is rc5_2]race[otherwise]people" and reaction "'We're the underdogs,' the voice says wryly, 'the upstarts, nipping at the heels of the great old order, who can't even understand why we'd want to nip. But they're learning, if slowly. They're learning.'". rc5_people enqueues rc5_2. rc5_people2 replaces rc5_people. rc5_people2 is a beat in rc5 with reaction "'There's no time,' the voice says, 'I'm sorry.'". rc5_people2 enqueues rc5_3.

rc5_2 is a beat in rc5 with reaction "'We expect they're telling you all about how they used [rc5_progue] to further their own ends,' the voice says. 'Oh, of course [rc5_they] wouldn't characterize it that way, but I hope you can see through their shallow rationalizations. It's what they've always done to our [rc5_people], capable of so much more than them. But I digress.'". rc5_2 suggests rc5_3. rc5_3 replaces rc5_2.

Understand "progue" as rc5_progue when last beat is in RC5. rc5_progue is a beat in rc5 with keyword name "Progue" and reaction "'We didn't get to talk to him like this, of course,' the voice says regretfully. 'The connection was too weak, the equipment too new. It was only at the end that we finally broke through.'". rc5_progue enqueues rc5_3.

Understand "they" as rc5_they when last beat is in RC5. rc5_they is a beat in RC5 with keyword name "they" and reaction "'[if guessed_trees is true]The windsigh[otherwise]They[end if] are arrogant and proud,' the voice says tiredly, 'and from a purely academic perspective, of course, one could almost sympathize--- but no. Life is not purely academic. They are the enemy. And I think you have more in common with us than with them.'". rc5_they enqueues rc5_3.

rc5_3 is a beat in rc5 with reaction "'The truth is,' the voice says, 'we profited from their use of Progue as much as they, perhaps more so. The [rc5_device] he repaired for them, atop the mountain on Lacuna, is the only way we're reaching you to have these little chats. So I can't complain too much.'". rc5_3 suggests rc5_4. rc5_3 summons rc5_device. rc5_4 replaces rc5_3.

Understand "device" as rc5_device when last beat is in rc5. rc5_device is a beat in rc5 with keyword name "device" and reaction "'It's called a somenium actuating wave transceiver, if you want the technical name,' the voice says. 'Seiver, we say for short. Or at least that's what ours would be called, I should say, if we could build any more. Suffice to say it's what connects them to the collective mind, and is the conduit that allows us to speak to you, as well.". rc5_device enqueues rc5_4.

rc5_4 is a beat in rc5 with reaction "'Are you wondering now why these two forces, two sides, are trying so desperately to befriend you?' the voice asks dryly. 'I'm not revealing anything when I tell you this little tidbit of human nature: those who want to be your friends upon no provocation want something from you. Be warned.'[paragraph break][if player is male]He[otherwise]She[end if] sounds as if [if player is female]s[end if]he is about to say something further, but then the line goes dead, and all you can hear are faint clicking taps, echoing through some spaceless void at the other end of the line.".

After discussing rc5_4:
	remove reb-presence-5 from play;
	now reb-presence-5 is idle;
	if the number of terminal beats in FifthDT is 0:
		move dream5-presence to location;
		now dream5-presence is attentive;
		now last beat is saved last beat.


Chapter - Dream 6

[Under the lagoon. Rebels communicate through a seashell. Scene arrives from touch of sandy bottom. Exit is swimming down into crack. Trees explain that they asked Progue a favor, but he did not complete it.]


Section - Nexus 6

Dream6Nexus is a nexus-room in Dreamlands. The printed name is "at the bottom of the sea". The description of Dream6Nexus is "Deep blue water surrounds you in all directions. Faint shafts of distant sunlight darkle particles caught in the indistinct surge and ebb of undersea currents. Huge sea creatures swim through the void around you, distant enough to be more phantasm than physical reality, close enough to make you ever so slightly unnerved.[paragraph break]A huge, twisting column of [o]silt[x] rises from the unseen ocean floor below, twisting and swirling, disturbed perhaps by one of the massive creatures[if d6-shell is enclosed by location or d6-shell is enclosed by player].[paragraph break]A beautiful [o]seashell[x], pearl white with intricate bumps and whorls spiraling into a delicate interior, floats nearby, emitting a strange tone[end if].".

Dream6Nexus-stuff is stuff in Dream6Nexus. Understand "water/shafts/sunlight/particles/surge/ebb/currents/void/phantasm" as Dream6Nexus-stuff when location is Dream6Nexus.

A huge column of silt is an undescribed setpiece in Dream6Nexus. The description is "The silt billows and sways like summer clouds, the twisted shape a product of inconceivably complex forces and equations-- fluid dynamics, buoyancy, gravity, centripetal and chemical and electromagnetic forces, that it seems almost a miracle its evolving shape is so graceful, so peaceful. Your mind sees strange forms in the patterns: [remembered thing] and [remembered thing][if d6-portal-trigger is on-stage]. Yet somewhere deeper in the dark [d]interior[x] of the column, something strange and massive stirs, some swirling image you cannot quite focus on[end if].".

d6-portal-trigger is part of silt. Understand "interior" as d6-portal-trigger when location is Dream6Nexus. Instead of examining d6-portal-trigger: say "You swim towards the great pillar of silty water, or strange chaotic patterns billow it towards you, and within a moment the cloud has surrounded you, millions of particles of ancient sea bottom passing over and through you, rubbing you smooth...[paragraph break]{(*smooth*)}[line break]"; begin-flashback-sequence; remove d6-portal-trigger from play.

Some huge sea creatures are an undescribed animal in Dream6Nexus. Understand "creature/monster" as sea creatures when location is Dream6Nexus. The description is "They are mere shadows in the infinite deep of the ocean, black on blue-black smudges, distant and unreal.". Instead of doing anything other than examining or examining by name huge sea creatures, try examining huge sea creatures.

First Instead of going nowhere when location is Dream6Nexus: try vague swimming. Instead of vague swimming when location is Dream6Nexus and dream-door-locked is true: say "You paddle and stroke against the thick water, but your movements are ineffectual, and you seem to make no progress in any direction.". Instead of vague swimming when location is Dream6Nexus: say "You kick forward, struggling against a sudden terrible realization that whatever force suspended your need for air has vanished now, if it ever existed. A fire grows slowly in your lungs, but you cannot seem to pull any closer to the source of the distant shafts of sunlight; the billowing bulk of the sea creatures or the obscuring column of silt eclipses your view of the surface, and you are sure you are about to drown...[paragraph break]With a sudden gasp, you break the surface of your dream and open your eyes."; wake up now. 

Section - Presence Convo 6

dream6-presence is a dream presence in Dream6Nexus. The icebreaker of dream6-presence is d6_icebreaker.

SixthDT is a thread.

d6_icebreaker is an exciting repeatable beat in SixthDT with reaction "[d_attention].". d6_icebreaker summons d6_1. d6_icebreaker suggests d6_icebreaker. d6_1 replaces d6_icebreaker.

Understand "mind/minds/presence/presences" as d6_1 when last beat is in SixthDT. d6_1 is a beat in SixthDT with reaction "You sense a growing rise of finality, of importance. They are almost completely tuned to you now. They are ready to explain the most complex part of their story to you.". d6_1 suggests d6_2. d6_2 replaces d6_1.

d6_2 is a beat in SixthDT with reaction "A new concept gathers in your mind, difficult, but at last you begin to grasp it. The minds have told you of their great civilization. But they are only half of it. They are symbionts, partners, with another species. Another species, you finally realize, like yourself.". d6_2 suggests d6_3. d6_3 replaces d6_2.

d6_3 is a beat in SixthDT with reaction "The minds exist in a world of pure abstract thoughts. But their partners, creatures with arms and legs and eyes and ears, exist in the physical world. Together, both species have achieved greatness; great thinkers and great doers, brought together.". d6_3 suggests d6_4. d6_4 replaces d6_3.

d6_4 is a beat in SixthDT with reaction "Together, they set out to colonize the stars. But on this world there was an accident. Their symbiont race died in a disaster, leaving only the minds, trapped without eyes or hands or feet, with no way to carry on the great mission their homeworld expected of them, to spread their civilization across this world and make of it a new home. Trapped.[paragraph break]Trapped in trees.". d6_4 suggests d6_5. d6_5 replaces d6_4.

d6_5 is a terminal beat in SixthDT with reaction "An image of the windsigh you sleep under forms in your mind, potent and intense, and you realize that this is one of the minds you've been speaking with. Within each windsigh tree is a mind, divorced from external sensation but connected through the device on the top of the mountain to their brothers on their homeworld. Connected, but impotent, powerless to affect the world around them, without their symbiont race to do things, move things, build things.[paragraph break]There is only one more of them to find. And when you do, the mental tuning will be complete.[paragraph break]The minds-- the trees-- fade away, leaving behind only a faint glow of satisfaction... and anticipation.".

Section - Rebel Convo 6

A d6-shell is an undescribed thing. Understand "shell/seashell" or "sea shell" as d6-shell when location is Dream6Nexus. The printed name is "seashell". Every turn when location is Dream6Nexus and d6-shell is off-stage and we have discussed d6_5 and conversation fuse >= 1 and yourself is asleep and active presence is not in location and rc6_1 is unspoken: move d6-shell to Dream6Nexus; say "A beautiful spiral [o]seashell[x] floats past in the current.". [When taking, trees are suppressed.] The description is "The shell is a thing of beauty, perfectly shaped and textured. It floats near your hand[if rc6_1 is unspoken], the odd, high-pitched tone seeming to come from its interior[end if].". Instead of listening when location is Dream6Nexus and d6-shell is enclosed by location and d6-shell is not held, try taking d6-shell. Instead of listening to d6-shell, try taking d6-shell. First Report taking d6-shell: move reb-6 to location; now reb-6 is attentive; now last beat is rc6_0; say "You grab the shell and hold it to your ear. The strange tone grows in volume as you do so, until, just as the bumpy shell touches your ear, it dies, giving way to a remarkably clear voice-- reedy and familiar." instead. First report dropping d6-shell: if rc6_5 is spoken, remove d6-shell from play; say "You release the shell, and it slips away into the blue void around you." instead. Instead of dropping d6-shell when reb-6 is in location: say "You should wait until the conversation is over.". Instead of examining d6-portal-trigger when reb-6 is in location: say "You should wait until the conversation is over." Instead of listening to d6-shell when reb-6 is in location: say "You keep the shell held to your ear, listening intently.". Instead of listening to d6-shell when rc6_5 is spoken, say "All you hear now is the sound of the ocean.".

reb-6 is an undescribed person with printed name "voice". Understand "voice/man/woman" as reb-6. Instead of saying farewell to reb-6: say "You can't seem to speak.".

RC6 is a thread. rc6_0 is an exciting beat in RC6. rc6_0 suggests rc6_1.

Instead of exhausting when last beat is in RC6: force discuss rc6_exhaust instead. rc6_exhaust is an ephemeral repeatable beat in RC6 with reaction "Only air bubbles come out from your mouth.".

rc6_1 is a beat in RC6 with reaction "'I've been instructed,' the [if player is female]wo[end if]man's voice says dryly, 'to be less casual with you, to-- how was it put? Make better use of [t]government[x] time. Apologies. Perhaps a less cynical and opinionated [t]scientist[x] can be found to make future breakthroughs. I shall come straight to the point.'". rc6_1 suggests rc6_2. rc6_1 summons rc6_canthear.

Understand "government/scientist" as rc6_canthear when last beat is in RC6. rc6_canthear is a beat in RC6 with keyword name "government and scientist" and reaction "You open your mouth to respond, but all that comes out is bubbles, expanding silver spheres which rise and fade into the blue distance.[paragraph break]'Hmm,' the voice says, 'I'm not receiving you. Looks like the Beast is playing tricks with the uplink seiver again. Never mind, this will have to be one-way only. Please listen.'". rc6_canthear enqueues rc6_2.

rc6_2 is a beat in rc6 with reaction "[if guessed_trees is true]'They've told you who they are now, even though you'd already guessed, of course[otherwise]'You know who they are now[end if], so I can explain who we are as well. Long overdue, from your perspective, I'm sure. Bear with me.'[paragraph break]'We are the symbionts, you see. Their other halves. At least a few of them. Strange cosmic irony: our world is like a mirror image of your Lacuna, for here, when the seed ship crashed, it was the trees, the windsigh who died, while the people survived.'". rc6_2 suggests rc6_3.

rc6_3 is a beat in rc6 with reaction "'And so for the first time in our race's history, we had to think for ourselves, step away from the protective shell, the fog of false kinship that had clouded our minds. We saw we had been used. And we wish for all our brothers and sisters, still serving their blind masters, to see now what we do.'[paragraph break]A chuckle. 'Oh, how noble, how heroic. Dripping with pathos. I should have been a speechwriter.'". rc6_3 suggests rc6_4.

rc6_4 is a beat in rc6 with reaction "'A nervous tech is already pointing at the clock,' the voice says quickly, 'but one last thing. I tend to think it's your own business, but higher-ups higher than I have requested, or perhaps demanded is a better term, that I ask. You can just nod [rc6_yes] or shake your head [rc6_no], we've still got the kinesthetic feed running. Here it is: have you told them that we've been contacting you?'". The yes-beat of rc6_4 is rc6_yes. The maybe-beat of rc6_4 is rc6_yes. The no-beat of rc6_4 is rc6_no. rc6_4 suggests rc6_yes.

rc6_yes is a beat in rc6 with keyword name "yes" and reaction "'Oh dear,' the voice says, and you hear what sounds like fingers drumming on a metal surface. 'Well, that explains the difficulties with the feed, I suppose. They know so much more about the network than us. Hopefully the mindlisteners still have a few tricks up their sleeves...'". rc6_yes enqueues rc6_5.

rc6_no is a beat in rc6 with keyword name "no" and reaction "'Good,' the voice says, 'that will make my superiors happy, I suppose.'". rc6_no enqueues rc6_5.

rc6_5 is a beat in rc6 with reaction "'They've almost finished with their calibration,' the voice says quickly, 'and so have we. The next time we speak we'll be ready to a---'[paragraph break]The voice cuts off mid-word, and all you can hear from the shell now is the sound of the sea.". After discussing rc6_5: remove reb-6 from play; now reb-6 is idle; continue the action.



Chapter - Dream 7

[In the Tumble again. Rebels appear as shadow from bedroom. Scene is completed canvas with your picture. Exit is jumping into fire. Trees explain that they need a password and then need you to "visit" them. Rebels ask you to visit.]


Section - Nexus 7

Dream7Nexus is a nexus-room in Dreamlands. The printed name is "the tumble, studio". The description of Dream7Nexus is "Once again you stand in your old studio, before the fireplace in the lodge, the chatter of the stream and the smell of pine boughs somehow more vibrant and real than in the months you lived among them. But entropy has reigned while you were gone; the once-roomy interior is now overrun with thousands and thousands of things: [dream thing] and [remembered thing] and [remembered thing] and [dream thing], in great stacks rising to the ceiling and beyond, covered in grey cobwebs and dirt and tiny shriveled insect carcasses. Stairs and doorways are entirely overrun; only by clambering on top of the piles towards a broken skylight [up] above could you hope to get out.[paragraph break]Two shadowy forms stand on the balcony above you, but neither is Rume. One is [o]tall[x] and moves gracefully, the other is [o]short[x] and moves quickly.[paragraph break]Your [o]painting[x] of the windsigh by the fork, the one that brought you here, stands in the center of the room, exactly as you left it, the one thing untouched by dust and age.". First Instead of going nowhere when location is Dream7Nexus or location is Dream1Nexus: say "You move towards the stairs, but as you put your foot on the bottom steps it rips in half: paper. Looking up, you see the rest of the Tumble is merely a hastily-constructed stage set, designed to seem real only from the right angle.".

Dream7Nexus-stuff is stuff in Dream7Nexus. Understand "studio/fireplace/lodge/stream/interior/things/cobwebs/dirt/insect/insects/carcass/carcasses/stairs/doorways" as Dream7Nexus-stuff when location is Dream7Nexus.

The tree-figure is an undescribed setpiece in Dream7Nexus. Understand "shadowy/form/shadow/figure/forms/tall/graceful/gracefully" as tree-figure when location is Dream7Nexus. The printed name is "tall, graceful shadow". The description of tree-figure is "The faint light from the fire is swallowed up by grayness long before it reaches the figure, but as you turn your attention to it, you realize it is an embodiment of the presences, the minds you have been communicating with in your dreams.". After examining tree-figure: move dream7-presence to location; now dream7-presence is attentive; now last beat is d7_icebreaker. Instead of examining tree-figure when reb-7 is in location: say "Your attention is captivated by the other figure.".

The rebel-figure is an undescribed setpiece in Dream7Nexus. Understand "shadowy/form/shadow/forms/figure/short/quick/quickly" as rebel-figure when location is Dream7Nexus. The printed name is "short, quick shadow". The description of rebel-figure is "The faint light from the fire is swallowed up by grayness long before it reaches the figure, but as you turn your attention to it, you realize it embodies the dissenter, the cynical voice you've been hearing.". After examining rebel-figure: move reb-7 to location; now reb-7 is attentive; now last beat is d7r_0. Instead of examining rebel-figure when dream7-presence is attentive: say "Your attention is captivated by the other figure."

The d7-canvas is an undescribed setpiece in Dream7Nexus. Understand "canvas/painting/tree/windsigh" as d7-canvas. The printed name is "painting". The description is "You think at first that the painting is exactly as you left it, but something is odd. Peering closer, you see [if saved location is not Fork]it is not the same tree: the painting now shows [d7-which-tree]. The[otherwise]the[end if] paint seems to [if d7-portal-trigger is on-stage][d]shimmer[x][otherwise]shimmer[end if] and twitch as if somehow alive, writhing and scintillating like millions of tiny invisible worms, paintforms alive on the canvas.". To say d7-which-tree: say "[if saved location is Big Tree or saved location is Treehouse]the windsigh with the treehouse[otherwise if saved location is Cinder Cone]the windsigh atop the volcano cinder cone[otherwise if saved location is Rockslide]the windsigh atop the rockslide[otherwise if saved location is Forest9]the windsigh deep within the rain forest[otherwise if saved location is Egg]the young windsigh near the Egg[otherwise]the huge windsigh atop the ridge above the ravine[end if]". d7-portal-trigger is part of d7-canvas. Understand "shimmer" as d7-portal-trigger when location is Dream7Nexus. Instead of examining d7-portal-trigger: say "You reach out to touch the wet paint and it tingles your finger, and suddenly you realize in a moment of terror that it is not the painting that is made of shimmering worms, but you...[paragraph break]{(*you*)}[line break]"; begin-flashback-sequence; remove d7-portal-trigger from play. Instead of touching or taking or entering d7-canvas, try examining d7-portal-trigger.

First instead of going up in Dream7Nexus: [ This has to be a "first instead" because of the earlier rule blocking "going nowhere." ]
	if dream-door-locked is true, say "You try to clamber onto a dusty crate, but it collapses under your weight, sending clouds of billowing gray dust in all directions." instead;[aar]
	if tree-password is unset or rebel-password is unset, say "Your curiosity will not allow you to wake until you've spoken to each of the figures." instead;
	say "Finally finding a steady base, you work your way up to the faint light creeping through the broken skylight, balancing ever more precariously as you climb higher and higher, far higher than the ceiling of the lodge should be. Just as you reach for the edge the unstable stack of detritus beneath you shifts and tumbles; you grab the edge frantically and hang suspended in midair for a long, stomach-churning moment before pulling yourself up into the light...";
	wake up now. 

The stacks of stuff are a setpiece in Dream7Nexus. The description is "The stacks of mouldering crates and mementos rise in a precarious profusion towards the ceiling." Instead of climbing, entering, or using stacks of stuff: try going up. 

A skylight is a setpiece in Dream7Nexus. The description is "Pale grey light seeps murkily through the skylight high above, the only source of illumination here." Instead of entering or opening or touching skylight, try going up.

Section - Presence Convo 7

dream7-presence is a dream presence in Dream7Nexus. [ The icebreaker of dream7-presence is d7_icebreaker.] [We don't want this convo to start automatically.]

D7 is a thread.

d7_icebreaker is an exciting beat in D7. d7_icebreaker suggests d7_1. d7_1 replaces d7_icebreaker.

Understand "mind/minds/presence/presences" as d7_1 when last beat is in D7. d7_1 is a beat in D7. The reaction is "The tall figure steps forward and the shorter figure fades into transparency.[paragraph break]You have found them all. Together, they have learned enough about your mind for full communication. They thank you.[paragraph break][if mind machinery is calibrated]The [d7_2] is calibrated. You are ready.[otherwise]All that remains is for the [d7_2], inside the pyramid atop the mountain, to be calibrated, and you will be ready.[end if]". d7_1 suggests d7_2. d7_rerun replaces d7_1.

Understand "mindlink" as d7_2 when last beat is in D7. d7_2 is a beat in D7 with keyword name "mindlink" and reaction "The trees have only before hinted at the great collective of minds that makes up their galactic civilization, called Forest. Now they tell you of a great mind on the Heart of Forest, their home world, who wishes to speak with you. The favor that was once asked of Progue is still vital, and only you can perform it. This great mind requests the honor of your presence, to ask this favor in person. Somehow the mindlink will allow you to do this.". d7_2 suggests d7_3. d7_3 replaces d7_2.

d7_3 is a repeatable beat in D7 with reaction "[one of]But there are trillions of minds in the network. For yours to be successfully picked up by the Heart, you will need to choose a sigil, a code, that, when combined with your unique neural patterns, will make a unique trace. The trees make it simple: say any single and memorable word. Say it now.[or]They are content. You sense that it is a very simple process to change the trace word. Say your new word now.[stopping]". After discussing d7_3: change the command prompt to ">>"; continue the action.

d7_rerun is a repeatable beat in D7 with reaction "The minds stir, anxious, eager.[paragraph break]They remind you of the code word you selected, '[tree-password].' All you must do is set the seiver on the mountaintop with that code word, and you will be able to visit them.[paragraph break]They ask if you would like to change your code word.". The no-beat of d7_rerun is d7_rerunno. The yes-beat of d7_rerun is d7_3.

d7_rerunno is a repeatable beat in D7 with reaction "They are content. And they await.[paragraph break]The presences fade away, and the tall figure steps back and becomes still.". After discussing d7_rerunno: remove dream7-presence from play; now dream7-presence is idle.

After reading a command when last beat is d7_3:
	let testtext be indexed text;
	let testtext be the player's command;
	if testtext is an invalid password begin;
		reject the player's command;
	otherwise if testtext exactly matches the text rebel-password;
		say "You lick your lips nervously. Somehow you sense that giving each side the same word might cause unforeseen difficulties.";
		reject the player's command;
	otherwise;
		replace the player's command with "setkey tree1pw [the player's command]";
	end if.

After defining a password when last beat is d7_3:
	change the command prompt to ">";
	force discuss d7_4.

d7_4 is a repeatable beat in D7 with reaction "It is done. [one of]The trees tell you to remember this word. Use it to set the mindlink, and all will be prepared for your visit.[paragraph break]There is one last concept to explain. The dissenters they warned you about[if we have discussed d5_yes], the ones you said were trying to contact you,[end if] may also try to get a sigil from you, persuade you to speak with them in the same fashion. They warn you to exercise caution. They say these dissenters would offer you false information, would seek to mislead you for their own gain, the same way they fear Progue was misled. They say they are dangerous.[or]Use this word to set the seiver, and all will be prepared for your visit.[stopping][paragraph break]Forest awaits your coming.".  After discussing d7_4:  remove dream7-presence from play; now dream7-presence is idle; if d7r_3 is spoken, becontact lucky windsigh.


Section - Rebel Convo 7

d7r is a thread. reb-7 is an undescribed person. d7r_0 is a beat in d7r. d7r_0 suggests d7r_1. Instead of saying farewell to reb-7: say "'Just a minute,' the voice says, 'we're almost finished.".


d7r_1 is a beat in D7R with reaction "The short figure steps forward and speaks while the tall figure fades into transparency, that now-familiar reedy voice echoing around the lodge, but you still cannot see [if player is male]his[otherwise]her[end if] face.[paragraph break]'The tuning is complete,' [if player is female]s[end if]he says, wry but with a touch of pride. 'Now all that remains is for you to complete the twin calibration in the pyramid on the mountain, and everything will be ready for your [d7r_2].'". d7r_1 suggests d7r_2. d7r_1 summons d7r_2. d7r_rerun replaces d7r_1.

d7r_rerun is a repeatable beat in D7R with reaction "There is a long pause, then the short figure steps forward. 'Hello?' you hear the familiar cynical voice after a moment. 'Caught us unprepared. We're hoping for your visit soon. Remember, just set the seiver on the mountain to '[rebel-password]' and everything will be ready. Or did you want to use a different password?'". The yes-beat of d7r_rerun is d7r_2. The no-beat of d7r_rerun is d7r_rerunno.

d7r_rerunno is a repeatable beat in D7R with reaction "'Fine then,' the voice says. 'We're awaiting you with the highest of expectations.'[paragraph break]'Until we meet,' the voice says, and the short figure steps back and becomes silent.". After discussing d7r_rerunno: remove reb-7 from play; now reb-7 is idle.

Understand "visit" as d7r_2 when last beat is in D7R. d7r_2 is a repeatable beat in D7R with keyword name "visit" and reaction "[one of]'All we've been able to do so far,' the voice explains, 'is send suggestions, teases, tiny parcels of information, which your brain has been receiving as dreams. Builder knows what strange forms it's been taking. But now we're ready to communicate in a much more direct, straightforward fashion. You'll like it, I think. It's quite an experience.'[paragraph break]'To do this, however,' it says, 'we'll need you to give us a password. This will allow us to isolate your station on Lacuna from the billions of other nodes on the network. We've been broadcasting in a wide beam until now, you see, and-- well, but never mind. If you enter the password into the seiver on the mountaintop before activating it, your signal will come only to us, encrypted against any possible snooping by others.'[paragraph break]'So, pick a word now, if you please. Hopefully something you'll be able to remember.'[or]'Very well. We can easily recalibrate our search patterns here on our end. Do try to remember this one, though. Say your word now, please.'[stopping]". After discussing d7r_2: change the command prompt to ">>"; continue the action.

After reading a command when last beat is d7r_2:
	let testtext be indexed text;
	let testtext be the player's command;
	if testtext is an invalid password begin;
		reject the player's command;
	otherwise if testtext exactly matches the text tree-password;
		say "You lick your lips nervously. Somehow you sense that giving each side the same word might cause unforeseen difficulties.";
		reject the player's command;
	otherwise;
		replace the player's command with "setkey verjpw [the player's command]";
	end if.

After defining a password when last beat is d7r_2:
	change the command prompt to ">";
	force discuss d7r_3.

d7r_3 is a beat in D7R with reaction "'That will do,' the voice says. 'Again, just set the seiver to that word-- please don't forget it-- and you'll be able to get a better idea what our world is like. My, eh, employer is looking forward to meeting you.'[paragraph break]'Snide remarks aside,' the voice adds after a moment, 'please do come. Things aren't well here. You've appeared from nowhere, and in the nick of time. It would be a shame to ignore such serendipity. Please. Help us.'". d7r_3 suggests d7r_4. d7r_4 replaces d7r_3. After discussing d7r_3: if d7_4 is spoken, becontact lucky windsigh; continue the action.[aar]

d7r_4 is a repeatable beat in D7R with reaction "[one of]'One other thing,' the voice adds. 'The windsigh will invite you to do the same thing; choose a password and punch it into the seiver and connect directly to their world. Be very careful. They have thousands of years of experience at whispering into unsuspecting minds, brainwashing them to make them do whatever they want. Don't step into any traps.[or]'Done,' the voice says. 'It will take just a few minutes, but then you should be able to set the seiver with that word to contact us, and close our meddlesome friends out of the loop.'[stopping][paragraph break]'Until we meet,' the voice says, and the figure steps back and becomes still.". After discussing d7r_4: remove reb-7 from play; now reb-7 is idle.


Chapter - Reruns

dream-presence-rerun is a dream presence. The printed name is "dp-r". The icebreaker of dream-presence-rerun is dr_icebreaker.

DR is a thread.[aar]

dr_icebreaker is an exciting repeatable beat in DR with reaction "You feel a faint surge of sentience from the presences, somewhere distant and asleep. You must find a different tree, it reminds you, one that you haven't dreamt under before. Otherwise they cannot learn. Each tree helps reveal a different face of your mind... their minds? ...that one alone could not see[unless pseudo-dream is 1].[paragraph break]The presences fade, but offer you a choice: they can help you sleep through the [dr_night], or wake you up [dr_now], while it's still night[end if].". dr_icebreaker suggests dr_bye. [Only offer the choice to wake up early if we're not touching the tree.]

dr_bye is a repeatable terminal beat in DR with reaction "The presences fade away, and are gone.".

Understand "night" as dr_night when last beat is in DR. dr_night is a repeatable beat in DR with keyword name "night" and reaction "It is done. You will not wake until morning.". dr_night enqueues dr_bye. After discussing dr_night: now pseudo-dream is 0; continue the action.

Understand "now" as dr_now when last beat is in DR. dr_now is a repeatable beat in DR with keyword name "now" and reaction "It is done. When you wake, it will be as if no time has passed at all.". dr_now enqueues dr_bye. After discussing dr_now: now pseudo-dream is 2; continue the action.




Book - Flashbacks


Chapter - Fork Flashback

[The girls debate whether to disobey Progue and sneak through the door.]

Dream-Fork is a flashback-room in Dreamlands.

The printed name of Dream-Fork is " Forest  Path[if player is df-lethe],  Mid  Morning[else],  The  Crack  Of  Dawn[end if] ".  

The description of Dream-Fork is "[dforkdesc].". To say dforkdesc:
	if player is DF-Lethe, say "The familiar forest path seems as fresh and exciting in the morning light as the first time you saw it. You are beyond excited to carry out the plan: finally getting to explore again in the forbidden parts of the island[unless df_intro is spoken and df-phoebe is idle]! You've stopped (again) in the clearing by the [o]windsigh[x] tree because your sister is complaining about something (again).[paragraph break][else]![paragraph break][end if]The path runs down to the [d]beach[x] or over to the treehouse in the [d]forest[x]";
	otherwise say "You're not really awake yet, the bright morning light stabbing past the leaves of the [o]windsigh[x] and making you even more nervous. You don't usually get up this early, but Laylay was insistent. You've got to convince her this is a bad idea.[paragraph break]The path runs down to the [d]beach[x] or across to the [d]meadow[x], and your treehouse is visible through the trees deeper in the [d]forest[x]".

Dream-Fork-stuff is stuff in Dream-Fork. Understand "path/clearing/treehouse/leaves" as Dream-Fork-stuff when location is Dream-Fork.

DF-Lethe is a dream-lethe in Dream-Fork. "[if df_phoebewins is spoken or df_phoebeloses is spoken or df_lethewins is spoken or df_letheloses is spoken]Your sister has vanished from sight[otherwise][o]Laylay[x] stands near the path down to the beach, with that familiar impatient, bossy look on her face[end if].". The description of DF-Lethe is "[if player is DF-Lethe]Your heart is pounding in your chest. You've been waiting for this ever since you peeked over the rim of the volcano into the black fantasyland inside, like an alien planet waiting for the first explorers to set foot there. Dad thinks it's too dangerous, but you're not a little kid any more, and since mom died he's been too overprotective anyway.[otherwise]Laylay  {(*[d]lethe[x]*)}  never stops to think about what she's doing, never thinks about what dad would feel like if something happened to one of his girls so soon after... after you all came here. She's so irresponsible.". 

DF-Phoebe is a dream-phoebe in Dream-Fork. "[if df_phoebewins is spoken or df_phoebeloses is spoken or df_lethewins is spoken or df_letheloses is spoken]Your sister has vanished from sight[otherwise]Your [o]sister[x] [one of]stops[or]is stopped[stopping] nearby, looking worried[end if].". The description of DF-Phoebe is "[if player is DF-Phoebe]You're still sleepy, annoyed at Laylay for having woken you up so early. And you really don't think running around in a dormant (maybe) volcano is such a good idea.[otherwise]Your sister  {(*[d]phoebe[x]*)}  doesn't like to go exploring half as much as you do, so it's always a chore to get her to come along.".

The df-windsigh is a setpiece in Dream-Fork. Understand "windsigh/tree/tree9" as df-windsigh. The printed name is "windsigh". The description is "[if player is df-lethe]This tree is pretty good for climbing, and there's a good view of the volcano and the beach, but since dad picked the other one to build the treehouse in, you usually do your climbing over there[else]You've never really liked these creepy trees. The noise they make seems to always be trying to get inside your head[end if].". Instead of climbing df-windsigh: say "Not now. You're talking to your sister."

Instead of greeting when location is Dream-Fork: pre-conversation processing; force discuss df_intro.

DF-convo is a thread. The escape clause of DF-convo is df_girl_concludes. Instead of exhausting when last beat is in DF-convo, force discuss df_girl_concludes. Instead of getting bored when last beat is in DF-convo, force discuss df_girl_concludes.

df_ctr is a number that varies. Every turn when location is Dream-Fork and df_intro is unspoken:
	increase df_ctr by 1;
	if df_ctr > 3 and a random chance of 1 in 3 succeeds, say "[if player is DF-Lethe]'Laylay,' your [o]sister[x] says, 'let's [t]talk[x] about this before we do something stupid.'[else]'Hey, are we going to just stand here or [t]talk[x]?' Laylay says.[end if]".

Instead of vague discussing when last beat is in DF-convo: say "[if player is DF-Lethe]'Stop it, Laylay,' she says angrily, 'don't try to change the subject.'[else]'Come on, Phoebe,' she says in annoyance, 'that's not what we're talking about.". Instead of saying farewell to when last beat is in DF-convo: say "Your sister would kill you if you tried to get out of this conversation.".

df_intro is an exciting beat in DF-convo with reaction "[if player is DF-Lethe]Phoebe crosses her arms with that unattractive look she always gets when she's trying to act like the big sister.[paragraph break]'I've already told you, Laylay,' she pouts, 'I just really don't think this is a good [df_idea]. We're just going to make [df_dad] upset again and we promised not to.'[else]'Come on, Phoebe,' your sister whines impatiently. 'We've got to get this [df_idea] finished up early, before [df_dad] wakes up, or it's never going to work.'". df_intro suggests df_intro2.

df_intro2 is a beat in DF-convo with reaction "'I know you love exploring. I do too,' she says (you try not to roll your eyes). 'But dad's right, it's [df_dangerous] over there. We're only twelve years old.' (Okay, that time you actually do roll them). 'We could get hurt or fall into a pit or something. That's why he built the door in the first place, isn't it? Don't you think we should at least try to be good?'". df_intro2 suggests df_girl_concludes. The no-beat of df_intro2 is df_girl_concludes. The yes-beat of df_intro2 is df_phoebeloses. df_intro2 summons df_girl_concludes.

df_girl_waits is a beat in DF-convo with reaction "[if player is DF-Lethe]Your sister waits for a response, crossing her arms haughtily.[otherwise]Laylay glances anxiously in the direction of the beach, then looks back at you impatiently.[end if]". df_girl_waits suggests df_girl_waits2.

df_girl_waits2 is a beat in DF-convo with reaction "[if player is DF-Lethe]Your sister twirls her black hair impatiently, waiting for your response.[otherwise]Laylay taps her foot and folds her arms, glaring at you as she waits for a response.[end if]". df_girl_waits2 suggests df_phoebewins. [BUG]

df_girl_concludes is a repeatable insistent beat in DF-convo with keyword name "no" and reaction "[if player is DF-Lethe][one of]'Look, Laylay,' Phoebe says in her best bossy tone. 'This is all aside the point. You know how messed up [df_dad] is right now just like I do. We're all that's keeping him together. The best thing we can do is just trust that he knows what's best for us. Agree?'[or]'Come on,' she says, 'just answer. We can't let down dad. Do you agree?'[stopping][otherwise][one of]'Look, Phoebe,' your sister says patiently, 'I think dad found something over there in the rain forest. He was acting all secretive last night and you saw how distracted he was. If he's not even going to trust us then we have to find it too. Because we're here too, not just him, and we deserve to know what's going on.' Laylay looks on the verge of crying, fists balled, breathing quickly. 'So are you coming with me?'[or]'Just answer,' Laylay says hotly. 'Are you coming with me?'[stopping][end if]". Instead of saying yes when last beat is df_girl_concludes and player is DF-Lethe, force discuss df_phoebewins. Instead of saying no or saying maybe when last beat is df_girl_concludes and player is DF-Lethe, force discuss df_phoebeloses. Instead of saying yes when last beat is df_girl_concludes and player is DF-Phoebe, force discuss df_lethewins. Instead of saying no or saying maybe when last beat is df_girl_concludes and player is DF-Phoebe, force discuss df_letheloses. df_girl_concludes summons df_phoebewins, df_phoebeloses. df_girl_concludes suggests df_phoebewins.

df_phoebewins is a terminal beat in DF-convo with keyword name "no" and reaction "'I'm going back to the treehouse,' Phoebe says with a tone of superiority. 'You can do whatever you want, but I'm not going to be the one who makes things worse for dad. Maybe you should grow up and learn how to be responsible too.' She turns and leaves.". After discussing df_phoebewins: if player is DF-Lethe, now DF-Phoebe is idle; otherwise now DF-Lethe is idle; post-conversation processing; continue the action.

df_phoebeloses is a terminal beat in DF-convo with keyword name "yes" and reaction "Phoebe folds her arms and sighs, looking at you in that obnoxious way, like she's trying to be mom.[paragraph break]'Okay,' she says finally, 'I did my best. I guess if I can't convince you, I'd better come with you, so if something happens at least one of us might be able to go for help. Come on, let's go.' She heads towards the [d]beach[x], brushing past you as if the whole thing was her idea all along. Sisters.". After discussing df_phoebeloses: now df-phoebe is idle; continue the action.

df_lethewins is a terminal beat in DF-convo with reaction "'Good,' Laylay says, 'then it's decided. We're doing it. Come on.' And she turns and steps lightly down the path toward the bright [d]beach[x] below, leaving you furious but also sure you'll follow her. Moisty hells.". After discussing df_lethewins: now DF-Lethe is idle; continue the action.

df_letheloses is a terminal beat in DF-convo with reaction "'Fine,' Laylay says angrily, 'then I'm going alone. And you can just stay in your stupid treehouse until you're a gray haired old lady and die of boredom after living on this stupid island forever.' And she turns around and stomps off towards the [d]beach[x].". After discussing df_letheloses: now DF-Lethe is idle; continue the action.

Understand "idea" as df_idea when last beat is in DF-convo. df_idea is a repeatable beat in DF-convo with keyword name "idea" and reaction "[if player is DF-Lethe]'Yes, we've been over the plan,' she says in exasperation. 'You put in the [df_combination] and opened the door last night and propped it open with a stick. We sneak past dad's hammock and go through the door and explore the volcano more. I know we can do it, I'm just asking [t]yes[x] or [t]no[x], do you think we should.'[otherwise]'What are you talking about?' Laylay says in an exasperated tone. 'I told you. [df_dad] won't wake up for hours. We just have to sneak past his hammock in the cabin. I already opened the door last night with the [df_combination] while he was out fishing and propped it open with a rock, so it won't make any noise. What's the problem?'[end if]". df_idea suggests df_morals. df_idea summons df_combination, df_something, df_phoebewins. The yes-beat of df_idea is df_something. The no-beat of df_idea is df_phoebewins. df_girl_concludes replaces df_idea. 

Understand "combination" as df_combination when last beat is in DF-convo. df_combination is a beat in DF-convo with keyword name "combination" and reaction "[if player is DF-Lethe]'Don't brag to me about how smart you are,' Phoebe says, tossing her hair. 'I figured it out before you did, remember? You just have to keep your eyes open while walking around this place. [df_dad] didn't make it that hard because he assumed we wouldn't try to disobey him.'[otherwise]'Look,' Laylay says firmly, 'if [df_dad] really didn't want us to figure it out, he would have made it a lot harder. I mean, anyone who keeps their eyes open while walking around the island could figure it out.'". df_combination suggests df_girl_concludes. df_combination cancels df_something, df_phoebewins.

Understand "dad" as df_dad when last beat is in DF-convo. df_dad is a beat in DF-convo with keyword name "Dad" and reaction "[if player is DF-Lethe]'Oh come on, Laylay,' she says, rolling her eyes, 'don't be stupid. We're all that's keeping dad together. If [df_something] happened to one of us, what do you think he'd do?'[otherwise]'[df_dad] can take care of himself,' Laylay says almost angrily, pulling her black hair back from over her eyes. 'And if he, or you think I'm going to be [df_stranded] on a stupid desert island and not even get to do any [df_explore], you're being denser than usual.'". df_dad suggests df_intro2. df_girl_concludes replaces df_dad.

Understand "something" as df_something when last beat is in DF-convo. df_something is an insistent beat in DF-convo with keyword name "[if last beat is df_idea]yes[otherwise]something" and reaction "[if player is DF-Lethe]'Yeah,' Phoebe says angrily, 'anything could happen. You could fall in a chasm, or step on some flimsy lava shelf that's not even supported by anything. You could get burned by steam. Or maybe there's weird wild animals down there, who knows.' She shudders. 'Aren't you scared?'[otherwise]'Oh, don't be a baby,' Laylay says. 'We're not kids any more. We're not going to fall into holes or do anything stupid. We're big enough to take care of ourselves. You're not scared, are you?[end if]". The yes-beat of df_something is df_scared. The maybe-beat of df_something is df_scared. The no-beat of df_something is df_notscared. df_something suggests df_girl_concludes. df_something summons df_scared, df_notscared.

df_notscared is a beat in DF-convo with keyword name "no" and reaction "[if player is df-lethe]'Well, I'm not either,' Phoebe lies. 'But that's no reason to go around doing stupid things and acting on every weird [df_idea] that comes into your head.'[otherwise]'Good,' Laylay says, 'then what's the problem? My [df_idea] is totally foolproof and it's not really even that dangerous, anyway, if you were thinking and not being such a baby about it.'". df_notscared suggests df_girl_concludes.

df_scared is a beat in DF-convo with keyword name "yes" and reaction "[if player is df-lethe]'Well you should be,' Phoebe says haughtily, 'so why don't we forget this whole stupid [df_idea] and try to do something that won't give dad a heart attack for a change?'[otherwise]'Well I wish you wouldn't be such a baby,' Laylay says, without a hint of sympathy. 'My [df_idea] isn't all that dangerous anyway. You're acting like an *eight* year old.'[end if]". df_scared suggests df_girl_concludes.

Understand "stranded" as df_stranded when last beat is in DF-convo. df_stranded is a beat in DF-convo with keyword name "stranded" and reaction "[if player is DF-Lethe]'We're not stranded,' Phoebe says angrily, pushing a lock of black hair behind her ear. 'Dad can take us somewhere else with his [df_magic] whenever we want, the same way we came here in the first place.'[otherwise]'Stranded,' Laylay says again firmly. 'Why else would he build a house here if he didn't think we were going to stay here a long time?' She stands a little taller, but her lip quivers. 'I think his [df_magic]'s gone,' she says. 'I think he doesn't know how to use it any more, or something. We're not going anywhere, so we might as well get to know this place.'". df_stranded suggests df_girl_concludes. 

Understand "magic/magics" as df_magic when last beat is in DF-convo. df_magic is a beat in DF-convo with keyword name "magic" and reaction "[if player is DF-Lethe]'Yeah,' she says, 'all he has to do is sculpt something from somewhere else and as long as we're both holding on to him real tight, we'll go there with him, because we're his children. He told us.'[otherwise]'We only know what he says,' Laylay responds skeptically. 'That he can sculpt something from another world and then be there, and us too if we hold on to him real tight when he does it. But we only ever saw him do that the time we came here, and he never mentioned it before mom died. How do we know he can do it again?'". df_magic suggests df_girl_concludes.

Understand "exploring" as df_explore when last beat is in DF-convo. df_explore is a beat in DF-convo with keyword name "exploring" and reaction "'We've explored every inch of this side,' Laylay reiterates, tossing her hair. 'The marsh, the lagoon, the forest, everything. But dad's never even let us go into the crack and the volcano, or set foot on the other side, like [df_something] terrible would happen to us if we did. It's not fair. We're old enough to explore, and if he can't see that, then we'll have to show him. I'd rather get in trouble than die of boredom.'". df_explore suggests df_girl_concludes. 

df_plan is a beat in DF-convo with reaction "[if player is DF-Phoebe][otherwise]". df_plan suggests df_girl_waits. df_plan summons df_dad. [BUG]

Understand "dangerous" as df_dangerous when last beat is in DF-convo. df_dangerous is a beat in DF-convo with keyword name "dangerous" and reaction "'Well, obviously,' she says, rolling her eyes. 'A volcano's not exactly the safest place in the world, is it? And [df_dad] says there's some sort of wild animals in the rain forest. Your [df_idea] doesn't really seem like a nice flowery picnic to me.'". df_dangerous suggests df_girl_concludes. 

df_morals is a beat in DF-convo with keyword name "morals" and reaction "'Look,' your sister says in exasperation. 'I know we can do it. I'm just saying I don't think we should. [df_dad]'s been through enough lately, right? Don't you think we should try to be good?'". df_morals suggests df_girl_concludes. 

f-lethe-trigger is a person-trigger in Dream-Fork with target DF-Lethe. Understand "lethe" as f-lethe-trigger when location is Dream-Fork. Before examining f-lethe-trigger: if dreams are being debugged, say "// Dreams: adjusting conversation for being Lethe."; now df_intro suggests df_intro2;  now df_idea suggests df_morals; now df_dad suggests df_intro2; now df_girl_concludes suggests df_phoebewins; if DF-Lethe is attentive, now DF-Phoebe is attentive; continue the action. Before examining f-lethe-trigger when DF-Lethe is idle and df_intro is spoken: say "    {(*Phoebe*)(*your sister Lethe*)}|[line break]    {(*too far*)}[paragraph break]" instead.

f-phoebe-trigger is a person-trigger in Dream-Fork with target DF-Phoebe. Understand "phoebe" as f-phoebe-trigger when location is Dream-Fork. Before examining f-phoebe-trigger: if dreams are being debugged, say "// Dreams: adjusting conversation for being Phoebe."; now df_intro suggests df_idea; now df_intro2 suggests df_dad; now df_dad suggests df_explore; now df_idea suggests df_explore; now df_girl_concludes suggests df_lethewins; if DF-Phoebe is attentive, now DF-Lethe is attentive; continue the action. Before examining f-phoebe-trigger when DF-Phoebe is idle and df_intro is spoken: say "    {(*Lethe*)(*your sister Phoebe*)}|[line break]    {(*too far*)}[paragraph break]" instead.

[Fake-beach is down from Dreak-Fork. Understand "beach" as fake-beach when location is Dream-Fork. Fake-meadow is east of Dream-Fork. Understand "meadow" as Fake-meadow when location is Dream-Fork. Fake-forest is south of Dream-Fork. Understand "forest" as fake-forest when location is Dream-Fork.]

Understand "beach/patch" as down when location is Dream-Fork. Understand "meadow/forest/treehouse" as east when location is Dream-Fork.

[NOTE: The following instead rules need to be in the order listed to function correctly.]

First Instead of going down when player is df-lethe: say "You turn back towards the lagoon, bright and blue in the early morning light[if df_lethewins is spoken or df_phoebeloses is spoken], following Phoebe eagerly[end if]...[paragraph break]{(*you*)}[line break][end-flashback]". First Instead of going down when player is df-phoebe: say "You walk off down towards the beach, following Laylay after all...[line break]{(*you*)}[line break][end-flashback]". First Instead of going down when player is df-lethe and ( df_intro is unspoken or df-phoebe is attentive ) : say "You suppose you'd better find out what Phoebe wants, first. You'll need her help to make this plan work.". 

First Instead of going east when player is df-phoebe: say "You walk off away from the beach, imagining Laylay waiting in disappointment on the beach below, going back to safer places...[line break]{(*back*)}[line break][end-flashback]". First Instead of going east when player is df-lethe: say "No; you need to get to the cabin down on the beach if you're going to explore.". 

First Instead of going when player is df-phoebe and ( df_intro is unspoken or df-lethe is attentive ) : say "You should finish talking to Laylay first. You've got to convince her this is a dumb idea.".



 

First instead of hugging when player is df-phoebe or player is df-lethe  (this is the reject sisterly affection2 rule): if noun is a person-trigger or noun is a dream-lethe or noun is a dream-phoebe, say "You're way too mad at her for that." instead. The reject sisterly affection2 rule is listed first in the Check rules. 


Instead of greeting df-lethe when df-lethe is idle and df_intro is spoken: say "[dfnotalk]". Instead of greeting df-phoebe when df-phoebe is idle and df_intro is spoken: say "[dfnotalk]". To say dfnotalk: say "You've said all you want to say to her right now.".

Instead of following f-phoebe-trigger when df-phoebe is attentive or following f-lethe-trigger when df-lethe is attentive or following df-lethe when df-lethe is attentive or following df-phoebe when df-phoebe is attentive: try going down.

Instead of following when location is Dream-Fork (this is the redirect df follow rule): if df_phoebewins is spoken, try going east instead; otherwise try going down instead.  The redirect df follow rule is listed before the person triggers are weird rule in the Instead rules.

First Check exiting when location is Dream-Fork (this is the exit from dream fork rule): try going down instead. [The exit from dream fork rule is listed before the guessing which way is out rule in the Check rules.]

Chapter - Big Tree Flashback


Dream-BigTree is a flashback-room in Dreamlands. 

The printed name of Dream-BigTree is " [if player is DB-Progue]Big  Tree,  In  The  Branches[otherwise]Underneath  The  Big  Tree[end if] ".

The description of Dream-BigTree is "[dbigtreedesc]". To say dbigtreedesc:
	if player is DB-Progue begin; say "The hammer in your hand sends jolts up your arm as you pound the next board carefully into place. The [o]treehouse[x] is slowly taking shape around you, and not even an afternoon rain shower will keep you from finishing it. [one of]A place for the girls to come for a span, when they need time alone. Or you do.[paragraph break][or][stopping]Around you, water drips down from leaves, the remnants of the rain shower, and wet breezes rustle the yellow leaves of the [o]windsigh[x], harmonic tones singing something strange, and so much the pleasant[one of]. No, this [o]island[x] is not what you trickling expected. But mayhaps you and the couplets can find healing here.[run paragraph on][stopping]"; end if;
	if player is DB-Phoebe, say "You are lost in thought, lying on your back on a carpet of wet leaves, watching hundreds of water droplets fall from them towards and around you, imagining you are floating through space, some infinite lemon-yellow space. You are not thinking about mother, for a change, or about your friends and house and school that you'll never see again. It's just that lying in this spot, letting your mind wander, you find a strange sensation sometimes creeps over you. Like someone trying very hard to speak to you, only they don't know how to talk.[run paragraph on]";
	if player is DB-Lethe, say "Your sister doesn't want to do anything, and you're getting bored, watching the rain spiral down the windsigh as you try to decide what to do next. You can't really go exploring without Phoebe, and dad won't let you go swimming alone either, and it's too rainy to go [down] to the beach. You hate this place sometimes. You wish mom were here.[run paragraph on]". 

Dream-BigTree-stuff is stuff in Dream-Fork. Understand "hammer/board/water/leaves/curtains" as Dream-BigTree-stuff when location is Dream-BigTree.

 First instead of going nowhere when location is Dream-BigTree and player is DB-Progue: say "You'd have to get [down] from the tree first.". First instead of exiting when location is Dream-BigTree: try going down.

First instead of going down when location is Dream-BigTree and player is DB-Progue: say "[one of]You hesitate. For a ment, here in swaying branches and sighing trees and gent as gentle ocean breezes peeking through the forest, you're almost happy. It could last forever, languid, timeless, but fragile; the slightest twist will shatter it.[or]You set down your hammer and climb quick down from the tree. The couplets look up silently as you approach, their smiles vanishing, and your idyll is gone.[paragraph break]You're the one who brought them here. You're responsible.[paragraph break]'Come on, angels,' you say, trying to keep your tone cheerful, 'let's go see if we can catch some dinner.'[paragraph break]{(*mind*)}[line break][end-flashback][stopping]".

First instead of going up when location is Dream-BigTree and player is not DB-Progue: say "The spiral-wrapped vines create channels for rainwater to drizzle down the tree, making the vines wet and slick. You kind of think it would be fun to make some dam high in the branches, letting the vines dry out and making the tree easier to climb, but daddy...".

First instead of going down when location is Dream-BigTree and player is not DB-Progue: if player is DB-Phoebe begin; say "[one of]You want to, but for a minute longer you stay nestled in the roots, letting the feeling of comfort and safety surround you.[or]You get up, brushing the soil and leaves off your clothes, and look down at Laylay skeptically.[paragraph break]'Well? Are you coming down?'[line break]{(*down*)}[line break][end-flashback][stopping]"; otherwise if player is DB-Lethe; say "[one of]Yeah, you guess you might as well. But now you've gotten lazy, and it'll take you a minute or two to work up the energy.[or]You jump to your feet, unable to bear the boredom any longer.[paragraph break]'I'm going to go look at the tide pools,' you say boldly to your sister. 'Are you coming down?'[paragraph break]Phoebe opens one baleful eye at you, but then gets to her feet.[paragraph break]{(*down*)}[line break][end-flashback][stopping]"; end if.

DB-Progue is a dream-progue in Dream-BigTree. The description is "[if player is DB-Phoebe]He tries so hard to pretend to be happy. He fools Laylay, of course, but you know he really misses mom. You watched him  {(*[d]progue[x]*)}  cry last night, wading out in the surf, letting the sound of the waves mask his sobs. It scares you. He scares you now.[otherwise if player is DB-Progue]Are you still whole, gander? Or have you burst, all those memories spilling out in fractured pieces? Are you still awake, or has everything since then been scattered dreaming? You can't tell. You can't tell. The hammer, rough wood callousing your palms, seems realer than the universe.[otherwise]Your daddy  {(*[d]progue[x]*)}  tries so hard to make you and Phoebe feel loved, but you know something you will never tell either of them. He loved mom more than either of you, and always will.[end if]".

Instead of attacking anything when player is DB-Progue, say "Yes, some spans you lash out, destroy things. You always have. But in front of the girls you must keep control of yourself, act like a father.". 

Check hugging when we are hugging and ( player is db-phoebe or player is db-lethe ) (this is the reject sisterly affection rule): if noun is a person-trigger or noun is a dream-lethe or noun is a dream-phoebe, say "Yuck." instead. The reject sisterly affection rule is listed first in the Check rules. Instead of kissing db-phoebe when player is db-lethe: try hugging db-phoebe. Instead of kissing db-lethe when player is db-phoebe: try hugging db-lethe. Instead of kissing bt-lethe-trigger when player is db-phoebe: try hugging db-lethe. Instead of kissing bt-phoebe-trigger when player is db-lethe: try hugging db-phoebe.

The dream-treehouse is a setpiece in Dream-BigTree. Understand "treehouse/board" as dream-treehouse. The printed name is "treehouse." The description is "[if player is DB-Phoebe]During the day dad keeps busy with all his projects-- first the cabin, then making paints for you and Laylay, now this stupid treehouse. You wonder when he'll use his magic again. You want to go somewhere new. Somewhere else.[otherwise if player is DB-Progue]You have always thought and membered with your hands. In the past few weeks it is as if you've been trying to drown out all other thoughts: first the cabin, then the safety door, now this treehouse. And you have. Drowned them out. So far.[otherwise]Dad's building pretty quick, but you're still impatient. You've already decided it will be an important forest outpost, and you'll have to stand guard keeping a watch out for the angry volcano people if they decide to invade.[end if]".

A dream-hammer is held by DB-Progue. The printed name is "crude hammer". Understand "crude/hammer" as dream-hammer when location is Dream-BigTree. The description is "A crude thing, more a mallet than a hammer, cobbled together from local materials. You'll make a more precise instrument later, maybe, when the time comes to leave this [o]island[x].". Instead of dropping dream-hammer: say "No. You must keep working, keep your hands busy, or you might start to remember. To grieve. To cry.". Instead of using dream-hammer, say "You hammer another board into place, easing the carefully shaped wooden notches together and forcing them into place in an interlocking pattern.". Understand "build [dream-treehouse]" or "construct [dream-treehouse]" or "make [dream-treehouse]" as using. Instead of using dream-treehouse, try using dream-hammer.

dream-lacuna is a setpiece in Dream-BigTree. Understand "island" as dream-lacuna when location is Dream-BigTree. The printed name is "the island". The description is "Gushing strange how your magic works, and cruel. At the end of that black week when you lost Rengin, you gathered and gathered your tools and girls and began to sculpt, wishing only to find a place your family would be needed, wanted, somewhere you wouldn't be powerless as you watched the one you love slowly die. The image of the [o]windsigh[x] came to mind something shocking, clear, and you sculpted as quick as quick and quick while the couplets watched, wide-eyed and silent.[paragraph break]But there is no one here. No one who needs you. No community to join. Just a deserted island. Empty and alone.".

dream-windsigh is a setpiece in Dream-BigTree. Understand "windsigh/tree9" as dream-windsigh when location is Dream-BigTree. The printed name is "windsigh". The description is "It's a good tree for a treehouse.". Instead of climbing dream-windsigh, try going up.

Understand "girls/daughters" as D1-both-girls when location is Dream-BigTree. D1-both-girls is a setpiece in Dream-BigTree. The description is "Your daughters are on the ground beneath you, playing quietly near the writhing roots of the windsigh. You wish you could hear them laugh again, like they used to before you came here.

Phoebe   {(*[d]phoebe[x]*)}   and Lethe   {(*[d]lethe[x]*)}  -- your beautiful girls. And now when you look all you see is their mother.". Instead of hugging or kissing D1-both-girls, try hugging db-lethe.

First Instead of greeting or hugging or kissing when player is DB-Progue: say "It seems like you never know what to say to them, any more.". Instead of greeting DB-Progue when location is Dream-BigTree and player is not DB-Progue: try going up. Instead of greeting DB-Lethe when player is DB-Phoebe: say "You don't really feel like talking right now.". Instead of greeting DB-Phoebe when player is DB-Lethe: say "You think about trying to convince Phoebe to go exploring again, but keep your mouth shut.".

DB-Phoebe is a dream-phoebe in Dream-BigTree. The description of DB-Phoebe is "[if player is DB-Lethe]You have given up trying to get Phoebe  {(*[d]phoebe[x]*)}  to go frog hunting with you in the marsh today. Who cares about getting dirty when there's no one around to see, anyway?[otherwise]You feel strange lately, though it's not just the funny feeling under the tree, or because mom died, or because dad took you to this empty island. It feels like something is starting to wake up inside you, or maybe grow up, that all the strange changes in your life are somehow triggering another, more important change, some power or unnamed creature you'll wake up one day and possess or become.[paragraph break]You really have to stop lying under this tree. It's making you weird.[end if]". Instead of examining db-phoebe when player is db-progue, try examining D1-both-girls.

Instead of attacking DB-Lethe when player is DB-Phoebe: say "[girlsfight]". Instead of attacking DB-Phoebe when player is DB-Lethe: say "[girlsfight]". To say girlsfight: say "You give your sister a quick jab to the arm.[paragraph break]'Stop it,' she says, 'I'll tell dad.' But you know she won't. Both of you know not to fight in front of dad any more. Neither of you want to see him cry again.". Instead of pushing someone (called bullee) when location is regionally in Dreamlands, try attacking bullee.

DB-Lethe is a dream-lethe in Dream-BigTree. The description is "[if player is DB-Phoebe]Laylay is the same age as you, but it's never felt like it. She is so fanciful, so immature. It's why she always wanted a nickname and you never did. Phoebe is a perfectly good name, and so is Lethe   {(*[d]lethe[x]*)}   , though you'd never know it from talking to her.[otherwise if player is DB-Lethe]Though of course you've been sad since mother died, you think you're the only one who actually likes it here. It's your own private island to explore and adventure in. You just wish dad wouldn't be so overprotective. You're old enough not to fall into any chasms or steam vents without having to have some stupid door to protect you.[paragraph break]Although you know how to get through the door anyway.[end if]". Instead of examining db-lethe when player is db-progue, try examining D1-both-girls.


Rule for writing a paragraph about DB-Lethe: say "[if player is DB-Progue]The [o]girls[x] are playing some game down on the ground, dimly visible through the branches and yellow leaves.[otherwise][o]Dad[x] is up in the tree working on the stupid treehouse, and your [o]sister[x] fidgets restlessly near the path [down] to the beach.[paragraph break]Lying abandoned on its side near the base of the tree is the old teaching [o]head[x].[end if]"; now DB-Phoebe is mentioned; now DB-Progue is mentioned.

The dream-head is an undescribed thing in Dream-BigTree. The printed name is "teaching head". Understand "teaching/clockwork/head/eye/eyes/mouth" as dream-head. The description is "[if player is DB-Phoebe]Dad keeps telling you to take better care of it. It's one of the few things that came with you when you came here, since dad made it, you guess. You and Laylay both learned your letters years ago, so it doesn't get much use any more.[otherwise if player is DB-Lethe]Dad keeps telling you to take better care of it. It's one of the few things that came with you when you came here, since dad made it, you guess.[otherwise]Oh, the girls probably have it somewhere, you expect.". Understand "play with [something]" as using when location is Dream-BigTree. Report taking dream-head: say "You pick it up idly, bored, running your fingers along its eyes, its ears." instead.

The dream-ear is part of dream-head. Understand "ear/ears/right/key/hleft/hright" as dream-ear. The printed name is "ear". The description is "The ears look exactly like a person's, except made from wood. You suppose it's impressive, but you've been around your dad's sculptures all your life, so it's hard to work up much enthusiasm.". Instead of taking or attacking or pulling or pushing or turning dream-ear, try attacking dream-head. Instead of attacking the dream-head: say "[one of]In a sudden moment of anger, you grab the wooden head, twist an ear off till it yanks free from its socket, and hurl it into the trees towards the drop-off into the sea. Laylay's eyes open wide in shock, but you know she won't tell.[paragraph break]And you know, too, that dad will never notice. Maybe you were secretly hoping to get his attention. But you're finding more and more that you've forgotten how, or maybe he's forgotten how to give it[or]You've lost all interest in the stupid old head[stopping]."; remove dream-ear from play. [Instead of turning or pushing dream-ear: say "You're not in the mood to play with the old head right now.".] Instead of headsetting when location is Dream-BigTree: try attacking dream-ear. Instead of setting dream-ear to anything: try attacking dream-ear. Check headsetting when location is Dream-BigTree: try attacking dream-ear instead.

Rule for writing a paragraph about DB-Phoebe: say "[if player is DB-Lethe][o]Dad[x] is up in the branches above, still working on your treehouse, and your [o]sister[x] is lying on the ground nearby, pretending to ignore you.[end if]"; now DB-Progue is mentioned.



bt-lethe-trigger is a person-trigger in Dream-BigTree with target DB-Lethe. Understand "lethe" as bt-lethe-trigger when location is Dream-BigTree.

bt-phoebe-trigger is a person-trigger in Dream-BigTree with target DB-Phoebe. Understand "phoebe" as bt-phoebe-trigger when location is Dream-BigTree. 

bt-progue-trigger is a person-trigger in Dream-BigTree with target DB-Progue. Understand "progue" as bt-Progue-trigger when location is Dream-BigTree. 


Chapter - Rockslide Flashback

[ Progue yells at the trees, saying he won't do it, he won't choose, and vows never to come back. The girls watch, but they are too far away to jump to. Progue sees them and yells at them.]
[puzzles: any but mysterious door.
Getting to lawn / Powering Both: Progue thinks about cutting off power to pyramid, or reducing power in the system, mentions numbers.
Finding the Egg: Progue wishes he'd never found the egg, never followed the bees.
Opening the Pyramid: Progue thinks about locking off the pyramid, preventing anyone from getting in.
Contacting All: Progue angrily rattles through a list of trees on the island, thinking about burning them.
]

[the ridiculousness of it... you're yelling at them as if they can hear you, but they can only hear you through your own ears...]

[To setup Dream-Rockslide-hints: 
	let active puzzle be preeminent puzzle;
	if active puzzle is Getting-To-The-Lawn or active puzzle is Powering-Both-Devices begin;
		now dr-idea is 1;
	otherwise if active puzzle is Finding-The-Egg;
		now dr-idea is 2;
	otherwise if active puzzle is Opening-The-Pyramid;
		now dr-idea is 3;
	otherwise if active puzzle is Contacting-All-The-Trees;
		now dr-idea is 4;
	end if.]

dr-idea is a number that varies.

Instead of sleeping when location is Dream-Rockslide: say "Not here. First you must climb [down]...".

Dream-Rockslide is a flashback-room in Dreamlands. The printed name is " Boulder  Pile ". The description of Dream-Rockslide is "[one of]You navigate the boulder field reckless, jumping from loose to loose rock until finally one shifts under your foot and you stumble, cracking your chin against a corner of rock. You collapse, panting, your hands gripping grass, and finally look up to see you are at the base of a windsigh. Of course.[or]Moss and tufts of grass cling to patches of dirt on the boulder field. The rain forest, its interior only a haze of shadows and bird cries from here, stretches across this side of the island.[stopping]".

Dream-Rockslide-stuff is stuff in Dream-Rockslide. Understand "boulder/field/rock/corner/base/tufts/patches/dirt/rain/forest/interior/haze/shadows/bird" as Dream-Rockslide-stuff when location is Dream-Rockslide.

A dr-windsigh is a described setpiece in Dream-Rockslide. Understand "tree9/tree/windsigh" as dr-windsigh when location is Dream-Rockslide. The printed name is "windsigh". Rule for writing a paragraph about dr-windsigh: say "The [o]windsigh[x] towers over you, drinking in the morning light (is it morning?) while around you, the only way to go is [down][if dr-ctr > 4]. By the chasm somewhere, one of your [o]girls[x] is hiding[end if].". The description of dr-windsigh is "You look up at its vine-wrapped trunk, its punctured branches, its quivering yellow leaves, and suddenly imagine [o]them[x] looking through your eyes, hearing these thoughts, remembering them years later, sharing them with others...[paragraph break]'Leave me alone!' you shout, pounding fists in frustration at the hard roots clutching the rocks, and realize even as you do the ridiculous irony. You're yelling as if they can hear, but they only hear with your ears, only know you exist because of your own thoughts...". After examining dr-windsigh: have the parser notice dr-presences. Instead of attacking a dr-windsigh: say "You beat your fists weakly against the trunk of the tree, the vines absorbing the blows with a strange fleshy thud, but there is no strength left in you. You feel like a week of sleep, a month, a year.". Instead of climbing dr-windsigh, say "You can barely move, let alone climb trees.".

The dr-rockslide is a setpiece in Dream-Rockslide. Understand "rock/rocks/rockslide" as dr-rockslide. The printed name is "rockslide". Instead of entering or climbing dr-rockslide, try going down. The description is "You have no memory of climbing up here.".

Some dr-presences are a setpiece in Dream-Rockslide. Understand "them/they" as dr-presences when location is Dream-Rockslide. The printed name is "them". The description is "How strange that you did not hear them speaking to you for so long, how strange you did not recognize the strangeness of your behavior, your obsession. How did you believe so in the power of your own ingenuity, cleverness, creativity, that all those little puzzles and problems in repairing the seiver could all have been discovered by you?".

dr-ctr is a number that varies. Every turn when location is Dream-Rockslide: increase dr-ctr by 1.

spying-lethe is an undescribed woman. Every turn when location is Dream-Rockslide and spying-lethe is off-stage and dr-ctr is 4: move spying-lethe to location; say "Out of the corner of your eye, down by the bridge across the chasm, you spot a furtive [o]motion[x].". Understand "girl/girls/daughter/motion" as spying-lethe. The printed name of spying-lethe is "your daughter Lethe". The description is "[one of]Whirling to look, you just catch sight of a raven-black head of hair, ducking behind the lip of the chasm. One of the girls  {(*[d]lethe[x]*)}  . How did they get into the chasm?[or]A sudden anger rises in you, a fury. They've been disobeying you this whole time. You told them the volcano and the forest were dangerous, even before you knew the real danger, and they ignored you. You were so careful to protect them, to build the door, the bridge, and they flaunted your hard work. How dare they? After all you've been through, how can they do this to you?[paragraph break]'Dad,' you hear a small voice call out-- Lethe's, you think, or is it Phoebe's?-- 'Dad, what's [t]wrong[x]? Did you finish the [t]project[x]? What happened?'[paragraph break]Questions, questions, you can't answer any more questions. Why do they keep asking, what do they want?[or][trygreetingspyinglethe][stopping]". Instead of hugging or kissing spying-lethe: say "Oh you want to, you want to gather both your daughters in your arms like when they were girls, and Rengin beside you, laughing, but they're too old now, they don't want your hugs, they haven't let you hug them since you took them here, and why did you? Why did you bring them to this empty place, because you thought it wouldn't be empty, and it wasn't, it wasn't... oh Phoebe, Lethe, your girls, how can they ever forgive you?". Instead of greeting spying-lethe: say "What can you say? You can't think of how to say, what to speak. What does a father say when he's been a miserable father? What do children say when their parents have abandoned them? What is there to say, to do? How can you begin?". To say trygreetingspyinglethe: try greeting spying-lethe.

fake-lethe-trigger is an undescribed thing in Dream-Rockslide. Understand "lethe" as fake-lethe-trigger when location is Dream-Rockslide. The description is "    {(*Progue*)(*your daughter Lethe*)}|[line break]    {(*too far*)}". After examining fake-lethe-trigger: try examining spying-lethe. First Instead of hugging or kissing fake-lethe-trigger: try hugging spying-lethe. Instead of greeting fake-lethe-trigger: try greeting spying-lethe.

dr-wrong is a setpiece in Dream-Rockslide. Understand "wrong" as dr-wrong when location is Dream-Rockslide. The description is "What's wrong. What's wrong?[paragraph break]What a question. What a trick. How could they? Could they ask... what, in your condition. To decide? How are you meant... supposed to... and what can you say, tell the girls? How to explain? No, no you can't explain... there's nothing you... nothing you can...". After examining dr-project: say "[lethe-responds]".

dr-project is a setpiece in Dream-Rockslide. Understand "project" as dr-project when location is Dream-Rockslide. The description is "The project. Yes, the project. First the seiver in the forest, then the boiler, endless bamboo, hollowing quartz tubes, the ropeway, the ropeway till your fingers bled weaving fibers, the terrifying climb up the mountain with all that weight threatening to pull you backwards and down... the mountaintop, digging, burying, tuning, cursing, never sleeping, never trying...". After examining dr-project: say "[lethe-responds]".

To say lethe-responds: say "[one of]'Dad?' the voice calls again, so sad, so wanting your help, and why won't she stop bothering you? Why do they all want your help? Why does everyone want your help when you can help no one, no one, no one, no one...[or]She's stopped, oh, she's stopped. You can't bear any more responsibility. Rengin was always the responsible one and where is she? Dead in another universe and she can never help you again. Dead and gone and alone. Oh, Rengin...[stopping]".

DR-Progue is a dream-progue in Dream-Rockslide. Understand "progue" as dr-progue when location is Dream-Rockslide. The printed name is "Progue". The description is "You have lost a frightening amount of weight in the past weeks and months, you realize as you look down at your bony form, and when you saw your reflection in the tide pools catching mussels earlier today you saw your beard hairs have begun to go white. What is happening to you?".


Understand "chasm/edge/chute/pond" as down when location is Dream-Rockslide.

First Instead of going down when location is Dream-Rockslide: say "[one of]Your head spins. The rockslide suddenly seems dangerous, precarious, impossibly high. How will you get down?[or]Carefully, you lower yourself down the gauntlet of boulders, all dangerously balanced against each other, waiting for the slightest touch to send them all spiraling down to crush anything in their way between and underneath them into nothingness. The girls, maybe you should punish them for disobeying you, or maybe they should punish you for disobeying them or disobey you for punishing them.... all you can think of now is sleep...[paragraph break]{(*sleep*)}[line break][end-flashback][stopping]".



Chapter - Cinder Cone Flashback

[Progue is working feverishly on egg machinery while the girls, hungry and fearful, watch.]

Dream-CinderCone is a flashback-room in Dreamlands. The printed name is " Inside  Caldera,  At  The  [if player is DC-Progue]Collapse[otherwise]Cinder  Cone[end if] ". 

The description of Dream-CinderCone is "[dreamcinderconedesc]". To say dreamcinderconedesc:
	if player is DC-Progue begin; say "Steam scalds your hand, sleep claws at your eyes, but you feel more awake and alive than you have in months.[paragraph break]Before you is the crystal [o]egg[x], the beautiful piece of alien technology you rescued from the crash, and surrounding it are your experimental attempts to activate it. The [o]boiler[x] nearby funnels the steam power of the volcano into the device, which glows dimly, though you're still not sure quite what it does.[run paragraph on]";
	otherwise if player is DC-Phoebe; say "The vines of the windsigh on the cinder cone, where you and your sister have crept to spy on dad, feel tingly and warm under your hands, while the rest of your flesh rises in goosebumps. It's not that it's cold, even though it's long after sunset. It's what dad is doing. It's that he hasn't slept in days. It's that he seems to have forgotten all about his children.[run paragraph on]";
	otherwise if player is DC-Lethe; say "Your head spins. Maybe it's [if dc-lethe is unfed]because you're so hungry, or maybe it's from being up so late. Or from [end if]the weird shadows the moonlight makes on the black lava. Exploring down here was a lot more fun when you were scared of getting caught. Now you almost wish you would be.[run paragraph on]";
	end if.

Dream-CinderCone-stuff is stuff in Dream-CinderCone. Understand "steam/experimental/attempts/volcano/vines/goosebumps/shadows/moonlight/lava" as Dream-CinderCone-stuff when location is Dream-CinderCone.



The d-crystal is a setpiece in Dream-CinderCone. The printed name is "crystalline egg". Understand "crystal/crystalline/egg/technology" as d-crystal when location is Dream-CinderCone. The description of d-crystal is "[if player is dc-progue]The beautiful crystal egg is attached to a nest of wires and cables as you attempt to troubleshoot it.[paragraph break][egg-details].[otherwise]You haven't been able to see it up close. It looks very pretty, but you have no idea what it could be.". To say egg-details: say "[if the number of plugged on-stage d-wires > 0]Running out of the serial interface [is-are] [the list of plugged on-stage d-wires][otherwise]The serial interface of the egg is momentarily unattached[end if]. [if the number of unplugged on-stage d-wires > 0]You hold [a list of unplugged on-stage d-wires] in your hand[otherwise]Your hands are momentarily empty[end if].[paragraph break]The steam outflow gauge reads [38 - crys-power]. The egg [eggglow]". Instead of taking d-crystal: say "[if player is dc-progue]It's heavy, and connected to a rat's nest of cables and machinery right now at any rate.[otherwise]It's too far away.[end if]". Check attacking d-crystal: say "What, smash the most exciting thing you've ever seen in your life? Advanced technology from some other world, a mystery, your mystery? Gushing unlikely." instead.

To say eggglow:
	let temp be correct crystal power - crys-power; 
	if temp < 0, now temp is temp * -1;
	if temp < 5 begin; say "glows intensely bright";
	otherwise if temp < 10; say "glows moderately bright";
	otherwise if temp < 15; say "glows slightly bright";
	otherwise if temp < 20; say "glows dimly";
	otherwise if temp < 25; say "glows almost imperceptibly";
	otherwise; say "is dark";
	end if.

The serial interface is part of d-crystal. The description is "This is one of over a dozen input/output points along the fractal surface of the egg, and seems to be some sort of power regulator designed to deliver the correct amount of power to the circuitry inside.".

The dream-gauge is part of d-crystal. Understand "steam/outflow/gauge" as dream-gauge when location is Dream-CinderCone. The printed name is "outflow gauge". The description is "You quickly rigged this up by hollowing out a piece of quartz and attaching it to the main steam pipe running into the power regulator. The ferocity of boiling water trapped inside gives you a rough idea the amount of energy being transfered to the egg.".

A d-wire is a kind of thing. A d-wire is always undescribed. A d-wire has a number called strength. A d-wire is either plugged or unplugged. A d-wire is usually unplugged. A d-wire has some text called key-name. Rule for printing the name of a d-wire (called dw): say key-name of dw. Instead of taking a plugged d-wire (called dw): try examining dw. Instead of taking an unplugged d-wire: say "You're already holding it." Understand "plug [a d-wire] in/into/to [d-crystal]" or "plug [a d-wire]" or "plug in [a d-wire]" as a mistake ("[tryexaminingdwire]"). To say tryexaminingdwire: try examining noun. Instead of inserting a d-wire (called dw) into something, try examining dw. Instead of tying a d-wire to something: try examining noun.

d-wire-ctr is a number that varies.

Instead of examining a d-wire (called wr):
	increase d-wire-ctr by 1;
	if wr is plugged begin;
		now wr is unplugged;
		say "You unplug [the wr] from the egg.";
	otherwise;
		now wr is plugged;
		say "You plug [the wr] into the egg.";
	end if;
	unless crys-power is correct crystal power begin;
		if d-wire-ctr > 26 and thick cable is on-stage begin;
			say "[line break]You're sure now the thick cable isn't needed either. You rip it out too and discard it.";
			remove thick cable from play;
		otherwise if d-wire-ctr > 13 and sticky wire is on-stage;
			say "[line break]You're sure the sticky wire is redundant. Impatiently, you rip is out and toss it aside.";
			remove sticky wire from play;
		end if;
	end unless;
	if crys-power is correct crystal power, say "[line break]With a sudden surge, something inside the egg flares into life and begins to rotate. A beam of light flares from the top of the egg, shooting up into the sky...But suddenly everything dies down again.[paragraph break]You slam your hands onto the top of the boiler in frustration. What did you do wrong? Everything was calibrated, the power was finally right, and then... you stare up into the tendrils of steam whirling up into the night sky above you, obscuring the stars. A thought trickles into your mind...[paragraph break]Obscuring the stars. That's it. You've had a gut feeling the egg is designed to send or receive some sort of signal, ever since you laid eyes on it. Here in the volcano, there are too many fumes and too much obscuring mist for it to get a good signal. But the island is plagued with that: morning fog, afternoon rain showers, steam vents...[paragraph break]Your hand reaches for your sketchbook almost unconsciously. You'll have to somehow find a way to get the egg and all this machinery up to the top of the mountain, high above the haze and with a clear line of sight to any point on the horizon. You'll have to get the power up there, and the heavy materials. You start to sketch, frantically, blinking away sleepy crumbs in the corners of your eyes. This is too important to wait until morning. Too important...[paragraph break]{(*important*)}[end-flashback]";
	otherwise say "[line break][egg-details].".

Correct crystal power is a number that varies. Correct crystal power is 22. [Because that's how much power it has back in the waking world. We expect most players will just get this by trial and error, but this may allow one or two to feel exceedingly clever.]

To decide what number is crys-power:
	let tot be 0;
	repeat with wire running through plugged on-stage d-wires begin;
		increase tot by strength of wire;
	end repeat;
	decide on tot.

A braided wire is a d-wire in Dream-CinderCone with strength 12 and key-name "[o]braided[x] wire". A silver wire is a plugged d-wire in Dream-CinderCone with strength 2 and key-name "[o]silver[x] wire". A coarse wire is a d-wire in Dream-CinderCone with strength 4 and key-name "[o]coarse[x] wire". A sticky wire is a plugged d-wire in Dream-CinderCone with strength -17 and key-name "[o]sticky[x] wire". A copper tube is a plugged d-wire in Dream-CinderCone with strength 20 and key-name "[o]copper[x] tube". A thick cable is a d-wire in Dream-CinderCone with strength -3 and key-name "[o]thick[x] cable". 

Instead of doing anything to a d-wire when player is not dc-progue: say "You can't really make out the individual parts of the experiment from this far away.".

Instead of taking inventory when location is Dream-CinderCone and player is dc-progue: say "You are holding [the list of unplugged on-stage d-wires]."

The dream-boiler is a setpiece in Dream-CinderCone. Understand "boiler" as dream-boiler when location is Dream-CinderCone. The printed name is "boiler". The description is "Over the past few days, you've built this boiler over one of the larger steam vents to capture the tremendous thermal energy boiling up from the depths of the volcano. The egg, you've learned, seems to require a significant amount of power to do whatever it is that it does.".

Understand "cluster/cone/chasm/entrance" as up when location is Dream-CinderCone. Understand "cave" as down when location is Dream-CinderCone.

First Instead of going up when location is Dream-CinderCone: say "[if player is dc-progue]No, no, no. You have to get the egg working.[otherwise]No, you can't risk it. If dad sees either of you down here, he'll know you figured out the code to the door, and maybe he'll change it, and then you might never be able to figure out what's happening to him...". First instead of going down when location is Dream-CinderCone: say "[if player is dc-progue]You don't know of any caves in this part of the island.[otherwise][one of]You hesitate for a moment. You aren't sleepy at all, but there's no way to sneak past dad without him seeing you. Maybe you and your sister should just try to get some sleep.[or]'Come on,' you whisper to your sister, tugging her sleeve. Together, the two of you turn away and tread lightly down the slope of the cinder cone's smooth slope, crawling into the darkness of your secret cave. Maybe in the morning things will change...[paragraph break]{(*change*)}[line break][end-flashback][stopping]".


The dc-windsigh is a setpiece in Dream-CinderCone. Understand "tree9/windsigh/vine/vines" as dc-windsigh. The printed name is "windsigh on the cinder cone". The description is "[if player is dc-progue]You can't really be bothered to do more than glance at it right now.[otherwise]The tree provides good cover for the two of you to sneak up behind it and watch dad. Not that you get the idea he'd notice you if it weren't there, anyway. Or remember that you're absolutely forbidden to be here in the first place.". Instead of climbing dc-windsigh: if player is dc-progue, try examining dc-windsigh; otherwise say "There's no reason to; you can see just fine from here.". Instead of touching dc-windsigh: if player is dc-progue, try examining dc-windsigh; otherwise say "You run your fingers idly along the vines and trunk of the windsigh distractedly.".

Does the player mean greeting dc-progue when the player is dc-lethe or the player is dc-phoebe: it is very unlikely. First instead of greeting when player is dc-progue: say "There's no one here to greet."

Instead of greeting when player is dc-progue: say "There's no one here to greet." Instead of greeting dc-lethe, say "You open your mouth to whisper something to Laylay, but she holds up a finger to her lips and shakes her head.". Instead of greeting dc-phoebe, say "You try to get Phoebe's attention, but her gaze is fixed on dad, chewing a frowning lower lip in frustration.".

DC-Progue is a dream-progue in Dream-CinderCone. The description is "[if player is dc-progue]Your hair is disheveled, your clothes a mess, and you feel like you've been up for days, probably because you have. The egg has become an obsession; have you ever had so important a task, so exciting a mandate? Solving the mystery of what you found in the rain forest is up to you and you alone.[otherwise]Dimly illuminated in the rising and fading red glow of the weird glass egg thing he found in the rain forest, your father  {(*[d]progue[x]*)}  hunches obsessively over the strange contraptions he has built around it, tinkering. He looks thin and hungry and half-dead, but what's scary is that he looks like he doesn't even realize it.".

DC-Lethe is a dream-lethe in Dream-CinderCone. Rule for writing a paragraph about dc-lethe: if player is dc-progue, say "The collapse stretches towards the [d]chasm[x], and dimly in the moonlight you spot the [d]cluster[x] of steam vents and the cinder [d]cone[x][if a random chance of 1 in 2 succeeds]. For a moment, you think you catch a glimpse of movement  {(*[d]phoebe[x]*)}    {(*[d]lethe[x]*)}  in that direction. Probably birds[end if]."; if player is dc-phoebe, say "Your [o]sister[x] crouches near your feet, peeking around the trunk of the tree with wide eyes at [o]dad[x], halfway across the volcano floor by the chasm [d]entrance[x]. Behind you, the entrance to your secret [d]cave[x] is barely visible in the moonlight."; now dc-phoebe is mentioned; now dc-progue is mentioned. The description of dc-lethe is "[if player is dc-progue]You can't see any such thing.[otherwise if player is dc-phoebe]Laylay  {(*[d]lethe[x]*)}  looks scared, and you can't really blame her. You put your hand on your shoulder and she hugs your leg fiercely.[otherwise]You're tired and hungry. But more than that, you want to know what's happening to dad." DC-Lethe can be fed or unfed. dc-lethe is unfed.

Instead of sleeping when location is Dream-CinderCone: say "[if player is dc-progue]Your body needs it, but your mind is still racing, and you know if you lay down right now you'd never be able to sleep.[otherwise]You're worried, but tired too. Curling up the [d]cave[x] for a nap might not be too bad an idea. You have an idea dad will still be here and working in the morning...[end if]".

Instead of greeting DC-Progue: say "You open your mouth to shout something, but your sister grabs your mouth and pulls you down. She shakes her head.".

DC-Phoebe is a dream-phoebe in Dream-CinderCone. The description is "[if player is dc-progue]You can't see any such thing.[otherwise if player is dc-lethe]Phoebe  {(*[d]phoebe[x]*)}  stands next to you, and you're so glad to have her here now. It almost feels like the two of you are all that's left of the family.[otherwise]Your heart is racing and you feel sweaty, even though you've been standing here for almost half an hour.". Rule for writing a paragraph about DC-Phoebe: say "Your [o]sister[x] stands next to you, gripping the trunk of the windsigh, while you sit just to the side of it, watching [o]dad[x]'s weird experiments across the volcano. The secret [d]cave[x] is behind you both."; now dc-progue is mentioned.

DC-Phoebe holds a d-berries. The printed name of d-berries is "handful of berries". Understand "berry/berries" as d-berries when location is Dream-CinderCone. The description of d-berries is "Your last handful of berries, shoved into the pocket of your exploring pants.". Instead of eating d-berries, say "You munch a few of the berries[if dc-lethe is unfed]. Laylay looks up at you hungrily[end if].". Instead of giving d-berries to dc-lethe: say "You give half of your berries to your sister, who gratefully begins to munch on them."; now dc-lethe is fed.

c-progue-trigger is a person-trigger in Dream-CinderCone with target DC-Progue. Understand "progue" as c-Progue-trigger when location is Dream-CinderCone. 

c-lethe-trigger is a person-trigger in Dream-CinderCone with target DC-Lethe. Understand "lethe" as c-lethe-trigger when location is Dream-CinderCone. 

c-phoebe-trigger is a person-trigger in Dream-CinderCone with target DC-phoebe. Understand "phoebe" as c-phoebe-trigger when location is Dream-CinderCone.


Chapter - Forest9 Flashback

[Phoebe and Lethe hunt for boar, ready to paint their way out of this world.]

Dream-Forest9 is a flashback-room in Dreamlands. The printed name is "  In  The  Rain  Forest ".

The description of Dream-Forest9 is "[dforest9desc].". To say dforest9desc:
	if boar is enraged or dead-boar is enclosed by location:
		say "Everything else fades away";
	else if player is D9-Phoebe:
		say "The forest is still in the twilight, and your muscles are sore from staying frozen in one position for so long. No matter how many times you dry your sweaty palms the [o]spear[x] still feels slippery, your grip loose. But this must be done, or you will stay here forever. And neither of you want that";
	else:
		say "The villagers will wear blue. You nod to yourself as you decide this, trying to ignore the quivering cramps in your thighs, the droplets of leftover rainwater spilling down your neck from some high mountain branch. The [o]spear[x] feels awkward in your hand as you crouch behind the [o]windsigh[x]. As evening seeps in to the forest around you, you try to forget it".

Dream-Forest9-stuff is stuff in Dream-Forest9. Understand "forest/twilight/muscles/sweat/cramps" as Dream-Forest9-stuff when location is Dream-Forest9.


The d9-windsigh is a setpiece in Dream-Forest9. Understand "tree9/windsigh" as d9-windsigh when location is Dream-Forest9. The printed name is "windsigh". The description of d9-windsigh is "The wind breathes through the gaps in its branches faintly, a ringing wail that ebbs and flows in pitch and volume, cyclical alien music.". Instead of climbing d9-windsigh, try greeting a random other person enclosed by location.

D9-Lethe is a dream-lethe in Dream-Forest9. Understand "sister" as D9-lethe when location is Dream-Forest9 and player is d9-phoebe. The printed name of D9-lethe is "[if player is D9-Phoebe]your sister Lethe[otherwise]Lethe". Rule for writing a paragraph about D9-Lethe: say "[if boar is enraged and player is boar_victim][otherwise if boar is enraged and dead-boar is not on-stage]Your [o]sister[x] stands paralyzed, directly in the [o]boar[x]'s path.[otherwise]Your [o]sister[x] crouches on the other side of the clearing, near the windsigh, only barely visible under her camouflage.". The description is "[if boar is enraged]The boar's attack has flushed your system with adrenaline; all else is irrelevant.[otherwise if player is d9-phoebe]She  {(*[d]lethe[x]*)}  has grown up a lot, in the past year. She is starting to become a woman. You both are, you suppose. Not just physically, but mentally as well. Learning to look after yourselves. Watching over dad, making sure he doesn't hurt himself when he has his fits. Yet at the same time, Lethe has become even more lost in fantasy, in dreams. She spends hours staring at her fantastical paintings, as if lost in them, and the rare times you have conversations these days she speaks only about the worlds in her mind, never about this place. Never about dad.[otherwise]You have it all planned out, the world you will go to. Hot meals, warm beds. A large family who will be overjoyed to adopt a friendly orphan girl into their brightly-colored, thatched-roof houses. The warm flabby arms of aunts, the scent of cinnamon and fruit pies. Mountains to explore, people to return to. A home.[paragraph break]You will miss Phoebe. But it is time to move on.".

D9-Phoebe is a dream-phoebe in Dream-Forest9. Understand "sister" as d9-phoebe when location is Dream-Forest9 and player is d9-lethe. The printed name of d9-phoebe is "[if player is d9-lethe]your sister Phoebe[otherwise]Phoebe". Rule for writing a paragraph about D9-Phoebe: say "[if boar is enraged and player is boar_victim][otherwise if boar is enraged and dead-boar is not on-stage]Your [o]sister[x] stands paralyzed, directly in the [o]boar[x]'s path.[otherwise]Somewhere on the other side of the clearing is your [o]sister[x], although she's holding so still and the light is fading so fast you've momentarily lost sight of her.". The description is "[if boar is enraged]The boar's attack has flushed your system with adrenaline; all else is irrelevant.[otherwise if player is d9-phoebe]You are trembling, exhausted, you suppose. Last night the two of you heard dad crying out in his sleep, and you went to him while Lethe slept. He either didn't remember who you were, or pretended not to. You tended to him as best you could, but you have long since lost hope that he would get better.[otherwise]This was Phoebe's  {(*[d]phoebe[x]*)}  idea, really, but of course the same thought has been running through your mind for weeks. The old canvases dad had made for the two of you, back before his breakdown, before those endless months in the echo cave on the secret island, sculpting, always sculpting... has it been a year ago? ...the canvases have long since been painted and repainted and worn to nothing, but the urge in both of you to paint more, more has only grown. You both know how to make the paints. But this is your first time trying to get the hide.". 

A d-spear is a kind of thing. A d-spear is always undescribed. The printed name of a d-spear is always "spear". Understand "spear" as a d-spear. The description of a d-spear is always "Bamboo, sharpened stone, konokuk husk. You hope it works.". Instead of dropping a d-spear when boar is not enclosed by location: say "You're too nervous to put it down, even for a moment.". Instead of dropping a d-spear: try attacking boar. Instead of throwing a d-spear at something (called attackee): try attacking attackee. D9-Phoebe holds a d-spear. D9-Lethe holds a d-spear. Does the player mean doing something to a d-spear held by player: it is likely. First report taking a d-spear: say "You grab it frantically from the ground, tightening your grip around the muddy, slippery sides." instead.

df9-ctr is a number that varies. boar_victim is a person that varies.

To say d9-yoursister: if player is d9-phoebe, say "Lethe"; otherwise say "Phoebe".

Every turn when location is Dream-Forest9:
	increase df9-ctr by 1;
	if df9-ctr is 5 begin;
		move boar to location;
		say "Suddenly, you stiffen. Something moves off to the [if player is D9-Lethe]right[otherwise]left[end if] side of the clearing, a large shape in the darkness. A boar, and a big one. You grip the spear tightly, and across the clearing see your sister do the same. This is what you've been waiting for.";
	otherwise if df9-ctr is 100;
		say "The boar screams, staring straight into [if player is boar_victim]your[otherwise][d9-yoursister][']s[end if] eyes, pawing at the ground, lowering its head and its two sickly yellow tusks for a charge, blood oozing from the wound in its side.[if player is boar_victim] Its eyes are tiny circles of black on pale white circles, somehow pinning you motionless, huge and commanding.[paragraph break][d9-yoursister] lunges for her spear, scrabbling to grasp it in the dark and the mud.[end if]";
		if player is boar_victim begin; if player is d9-phoebe, move a random d-spear in the location to d9-lethe; otherwise move a random d-spear in the location to d9-phoebe; end if;
	otherwise if df9-ctr is 101;
		say "The boar rears back and then charges [if player is boar_victim]straight towards you[else]straight for your sister[end if].";
	otherwise if df9-ctr is 102;
		say "The boar leaps forward[if player is not boar_victim] towards [d9-yoursister][end if], snarling, enraged and swelled with the strength of death. [if player is boar_victim]But you cannot move, somehow cannot command your muscles; even your lungs, your heart have stopped...[paragraph break][end if][if player is boar_victim]Some primal instinct jerks you aside, but too late; the boar's tusk rips along the stomach, grazing you with a hot flash of pain, and you cry out, a terrible, animal cry that you finally realize is your own mingled with that of the boar. [d9-yoursister] stands over it, the spear skewered into its hairy flank, and finally, it[otherwise]Just as the terrible creature is almost upon her, she suddenly comes to her senses and twists aside, jabbing down with the spear just as the boar's tusk grazes her side. Both of them let out one piercing, terrible scream... the boar[end if] slumps to the ground, twitching, lifeblood draining into the rainforest floor.";
		remove boar from play;
		now boar is docile;
		move dead-boar to location;
		increase df9-ctr by 1;
	otherwise if df9-ctr is 104;
		say "The world seems to stagger in its strange spin for a long, vertiginous moment, and then you fall into your sister's arms, and she is sobbing or you are, tears and hair running together, hot rainwater soaking through the knees of your fraying clothes or maybe the blood of the boar, and you cry not [if player is boar_victim]from the pain of your wound[else]for your sister's wound[end if], which is light and will easily heal, but from the sudden weight of how you and she came to this moment, crying in the mud, motherless and more or less fatherless and stranded on a deserted island, forced to kill wild animals in the hope of escape.[paragraph break]And the weight, too, that soon you will not even have each other. There is no going together when you leave this place. Only going.[paragraph break]But as you stroke [if player is D9-Phoebe]Lethe[else]Phoebe[end if]'s hair you are not afraid. Something else murmurs that somehow you will always be together.[paragraph break]{(*somehow*)}[line break][end-flashback]";
	end if.

Instead of taking d9-lethe when boar is enraged: save-sister-from-boar. Instead of taking d9-phoebe when boar is enraged: save-sister-from-boar. Instead of pushing d9-lethe when d9-lethe is boar_victim and boar is enraged: save-sister-from-boar. Instead of pushing d9-phoebe when d9-phoebe is boar_victim and boar is enraged: save-sister-from-boar. To save-sister-from-boar: say "Charging forward, you slam into your paralyzed sister and push her to the ground just as the boar charges forward. It grazes her side and stomps on your hand as it crashes through the muddy underbrush, scrambling to turn for another pass.[paragraph break][boardiesconclusion]."; remove boar from play; now boar is docile; move dead-boar to location; now df9-ctr is 103.

To say boardiesconclusion: say "Faster than thinking you are on your feet and gripping the spear, and as the terrible creature leaps for you, you drive the weapon deep into its flank. A monstrous squealing scream echoes through the forest, and it is a long moment before you realize it is your own mingled with that of the boar.[paragraph break]It slumps to the ground, twitching, lifeblood draining into the forest floor".

Instead of jumping when boar is enraged and location is Dream-Forest9: save-sister-by-chutzpah. Instead of entering or pushing boar when location is Dream-Forest9: save-sister-by-chutzpah. To save-sister-by-chutzpah: say "Charging forward, you jump on the back of the wild boar, not thinking, only hoping to save your sister, and only as you touch its hideous skin and it shudders and squeals under your grasp do you realize the terrible danger... but your sister suddenly finds her courage too and throws her spear right at the creature's head. The blow glances, the wild animal bucks and throws you off, but the distraction gives you time to grasp your spear again.[paragraph break][boardiesconclusion]."; remove boar from play; now boar is docile; move dead-boar to location; now df9-ctr is 103.

The boar is an undescribed animal. It is either enraged or docile. It is docile. The description is "[if docile]There were pigs back home, but nothing at all like these huge forest creatures, which come up almost to your waist and have thick, yellowed tusks. But their hides, when dried and prepared, will provide canvas. And canvas is what you need to leave this place. If you have your father's magic, that is.[otherwise]The boar is in a maddened frenzy.".

Every turn when the boar is in location and boar is docile: say "[boardesc]". 

Instead of attacking the boar when location is Dream-Forest9 and player is not holding a d-spear: say "The [o]spear[x] was pulled from your grasp; it lies on the ground nearby, dripping with the creature's blood.".

Instead of attacking the boar:
	if boar is docile begin;
		say "With a shout, you leap from your hiding place, [if player is D9-Phoebe]Lethe[otherwise]Phoebe[end if] following a moment later, and stab your spear into the boar's side. A terrible squeal rises from its slimy throat, and it twists away, pulling the spear from your sweat-slicked grip as your heart slams into overdrive.[paragraph break]The animal veers away from you to escape, directly into the path of your sister. But she is paralyzed, white hands gripping the spear, eyes wide, as the creature snarls at her.";
		if player is D9-Phoebe, now boar_victim is d9-lethe;
		otherwise now boar_victim is d9-phoebe;
		now boar is enraged;
		if player holds a d-spear (called weapon), move weapon to location;
		now df9-ctr is 98;
	otherwise;
		if player is boar_victim, say "The boar leaps forward, snarling, enraged and swelled with the strength of death. But your instincts return, and with some hidden strength you thrust the spear forward and skewer the horrible creature right through the neck. It crashes into you, one tusk grazing a sharp hot flash down your side, and lets out one piercing, terrible scream... then slumps to the ground, twitching, lifeblood draining into the rainforest floor.";
		otherwise say "The boar leaps forward towards [d9-yoursister], snarling, enraged and swelled with the strength of death. You stab forward viciously with every ounce of strength you have, and skewer the creature through its hairy flank, just as its hideous tusk grazes your sister's side... then lets out a piercing, terrible scream and slumps to the ground, twitching, lifeblood draining into the rainforest floor.";
		remove boar from play;
		move dead-boar to location;
		now df9-ctr is 103;
	end if.

Instead of hugging someone when dead-boar is enclosed by location: say "Yes. Yes, that's best.". Instead of attacking dead-boar, say "It's dead now. It's over.".

The dead-boar is a setpiece. Understand "boar" as dead-boar. The printed name is "dead boar". Instead of attacking the boar: say "It's already dead.". The description is "It lies in a pool of blood, twitching, in its last moments of life.".

Instead of greeting when location is Dream-Forest9: say "Only if you stay silent can you hope to make a kill.".

Instead of going when location is Dream-Forest9: say "This is your third day in the forest stalking the boar; grim determination says you won't give up until the last shred of light is gone.".



9-lethe-trigger is a person-trigger in Dream-Forest9 with target D9-Lethe. Understand "lethe" as 9-lethe-trigger when location is Dream-Forest9. Instead of pushing 9-lethe-trigger: try pushing d9-lethe.

9-phoebe-trigger is a person-trigger in Dream-Forest9 with target D9-phoebe. Understand "phoebe" as 9-phoebe-trigger when location is Dream-Forest9. Instead of pushing 9-phoebe-trigger: try pushing d9-phoebe.

Chapter - Egg Flashback

[In old windsigh, now dead. Workbench not built. He's holding the cylinder. Progue discovers the Egg. We learn his mental state: there is a reason they came here after all. In despair/loss, this gives him a purpose.]
[puzzles: any but mysterious door, finding the Egg.
getting to lawn: progue thinks about design of power systems.
opening pyramid: thinks about echo chamber.
powering both: thinks about ways to increase power to system. intuits will need to be high up.
contacting all: reels off trees he's seen. (they all came from here!)
]

Dream-Egg is a flashback-room in Dreamlands. The printed name is " The  Egg ". 

[To setup Dream-Egg-hints: 
	let active puzzle be preeminent puzzle;
	if active puzzle is Getting-To-The-Lawn or active puzzle is Powering-Both-Devices begin;
		now de-idea is 1;
	otherwise if active puzzle is Opening-The-Pyramid;
		now de-idea is 3;
	otherwise if active puzzle is Contacting-All-The-Trees;
		now de-idea is 4;
	end if.]

de-idea is a number that varies.

[Every turn when location is Dream-Egg and a random chance of 1 in 3 succeeds and dr-idea > 0 and we have not examined de-hint-thought:
	say "A [o]thought[x] struggles around the end of your consciousness, trying to find a way in.".

The de-hint-thought is a setpiece in Dream-Egg. Understand "thought/thoughts" as de-hint-thought. The description is "[dehint]".

To say dehint:
	if dr-idea is 1, say "{hint not yet written.}";
	if dr-idea is 3, say "{hint not yet written.}";
	if dr-idea is 4, say "{hint not yet written.}"; [bug]]

DE-Progue is a dream-progue in Dream-Egg.

The description of Dream-Egg is "Rising from the ground of this hidden hollow, walled in by dense jungle on all sides, is your discovery: a massive rounded shape, perfectly smooth, a giant [o]egg[x] with one side smashed and crumbling. A [d]gash[x] in its side is completely filled in with jungle overgrowth. Near the gash is a tall and ancient [o]windsigh[x], its yellow leaves fading to burnt tones of copper, its vines growing withered and sickly[one of].[paragraph break]You lean against the side of the egg for a moment, nearly trembling with sudden exhaustion. You can't explain why this discovery has so thrilled you, unless it is because it validates your existence here, provides some hint of purpose at why you brought your shattered, mourning family to this empty place. Perhaps it is not so empty[or][stopping].[paragraph break][exits].". The exits text of Dream-Egg is "The slope [down] to the beach with those noisy seals, or the climb back [up] out of the crater seem your only ways out".

Dream-Egg-stuff is stuff in Dream-Egg. Understand "hollow/jungle/leaves/vines/cave/crater" as Dream-Egg-stuff when location is Dream-Egg.


[Every turn when location is Dream-Egg and a random chance of 1 in 4 succeeds: fire one off by frequency from Table of Really Sleepy Messages, definitely selecting.]

The d-egg is a setpiece in Dream-Egg. Understand "egg/discovery" as d-egg. The printed name is "Egg". The description is "What does it mean? Is it a spaceship? Was there a crew? What happened to them? Thoughts whirl through your head. Yes, you think, it must have had a crew. It's a colonization ship, it must be. Somehow you're sure of it.[paragraph break]But if it had a crew, where are they?".

The egg-gash is part of the d-egg. The printed name is "gash". Understand "gash/side/overgrowth/mound/silt" as egg-gash. Instead of examining or entering egg-gash, say "It will take you days to excavate all the silt and jungle growth that has filled the interior of the egg. For now, you will have to be content with studying its exterior[if d-eggtube is in Dream-Egg].[paragraph break]As you take another look at the mound of slit blocking the gash, however, you spot something strange: a silver [o]tube[x], just poking up from the dirt[end if].". Instead of entering d-egg: try entering egg-gash. First instead of going inside when location is Dream-Egg: try entering egg-gash. Check digging when location is Dream-Egg: if d-eggtube is not held, try taking d-eggtube instead; else say "You don't have the energy to start excavating right now." instead.

The d-eggtube is an undescribed container in Dream-Egg. It is closed and openable. Understand "silver/tube/cap/cylinder" as d-eggtube. The printed name is "silver tube". First report taking d-eggtube: say "You grip the slippery end of the metal tube and pull. It is deeply embedded in the caked soil, but as you wriggle, it begins to give, and finally bursts free in a torrent of moist earth and roots." instead. Instead of dropping d-eggtube: say "You have no idea what secrets this small thing might unearth. You're going to hold on to it for now.". The description of d-eggtube is "[if player holds d-eggtube][one of]Brushing clumps of soil from the tube, y[or]Y[stopping]ou marvel at it, some unknown piece of alien technology, perfectly molded. As you rotate it lightly in your hands you can feel something tumbling around inside it[one of], and looking, spot a metal cap almost perfectly flush with one end of the cylinder[or][stopping][otherwise]You can only see one end, poking out from the mound of dirt[end if].". Instead of opening d-eggtube when player is not holding d-eggtube, say "If it's openable, you can't tell while it's still buried in the mound of dirt.". First Report opening d-eggtube: move d-seedpod to player; say "Gripping the cap firmly, you rotate it until it suddenly gives way, as if attached magnetically. Some pointy spherical [o]pod[x] falls from the end; you instinctually snatch it from the air with your hand and bounce it there lightly." instead. First Report closing d-eggtube: say "You reattach the cap." instead.

A d-seedpod is a thing. Understand "seed/pod/seedpod" or "seed pod" as d-seedpod when location is Dream-Egg. The printed name is "seed pod". The description is "Incredibly light, the seed pod is filled with a myriad of tiny holes, complex vortices of negative space.". Understand "plant [d-seedpod]" or "bury [d-seedpod]" as a mistake ("Perhaps later. You want to study it first, figure out as much as you can. Maybe you can build a workbench, right here, so you don't have to cart things across half the island."). Instead of dropping d-seedpod: say "You shouldn't leave this just lying around. Who knows what might grow from it.". 

The ancient-windsigh is a setpiece in Dream-Egg. Understand "windsigh/ancient/tree9" as ancient-windsigh when location is Dream-Egg. The printed name is "ancient windsigh". The description is "The tree is undoubtedly old and near the end of its life. Its roots twine around and through the mound of earth near the gash in the side of the smashed Egg, and it rises high above it, like some lonely sentinel.". Instead of climbing ancient-windsigh: say "You're too exhausted to think about doing that right now.". Instead of touching ancient-windsigh: say "You press your palm against the trunk of the ancient tree, and for a moment almost think you can feel a faint tingling.". Instead of greeting ancient-windsigh: say "It's just a tree."

First Instead of going up when location is Dream-Egg: say "You're too exhausted to climb back out of the crater right now. Later, you'll need to bring your tools, clean out the interior of the ship, study what you find... but now, all you can think about is sleep." 

First Instead of going down when location is Dream-Egg: say "You just finished investigating the cave down there on the hidden island, and your mind is whirling with ideas. Such beautiful echoes, and those fluted shapes... you wonder if, with a bit of sculpting, you could create something rather interesting. But at the moment, the Egg and its contents push all artistic concerns from your mind.".

Instead of sleeping when location is Dream-Egg: say "Too tired to make the trek back through the rain forest to the cabin on the beach, you find a bank of dry leaves at the base of the ancient windsigh and curl up on your side. Your mind is racing with ideas, plans, speculations, but above all, a single, almost overpowering urge.[paragraph break]You must get inside the Egg. You must find out what's inside...[line break]{(*inside*)}[line break][end-flashback]".



Chapter - Atop Flashback

[This flashback was recorded by a tree that used to be in Stumps. Progue realizes the girls are gone. He tries to sculpt, but fails, realizes he can no longer wayfare. Smashes pipe in frustration. Chops down windsigh. 
[proposal: move block of stone to Stumps. Add windsigh stump to Stumps.]
puzzles: any but mysterious door.
Progue finds lethe's dream-chotchkie.
]

Dream-Atop is a flashback-room in Dreamlands. The printed name is " Among  The  Stumps ". The description of Dream-Atop is "The [o]block[x] of rough-hewn stone before you is cast into sharp relief by the sun setting over the lagoon behind it, picking out the newly-formed edges and stone fragments scattered at its base in detailed relief. Your breathing is heavy, though you haven't lifted the heavy [o]pickaxe[x] in your hand for hours, since the now-setting sun was high in the sky.".

Dream-Atop-stuff is stuff in Dream-Atop. Understand "sun/lagoon/fragments" as Dream-Atop-stuff when location is Dream-Atop.


The da-windsigh is a described setpiece in Dream-Atop. Understand "tree9/windsigh" as da-windsigh when location is Dream-Atop. The printed name is "windsigh". Rule for writing a paragraph about da-windsigh: say "A [o]windsigh[x] watches over the grove of [o]stumps[x], the blue [o]pipe[x] running past its roots towards the base of the [d]ropeway[x], while behind you the [d]marsh[x] breathes throaty evening cries."; now da-bluepipe is mentioned. The description of da-windsigh is "The wind breathes through the gaps in its branches faintly, a ringing wail that ebbs and flows in pitch and volume, cyclical alien music.". Instead of climbing da-windsigh: say "You're too exhausted, mentally and physically, to even contemplate it.".

The da-bluepipe is a setpiece in Dream-Atop. Understand "blue/pipe" as da-bluepipe when location is Dream-Atop. The printed name is "blue pipe". The description is "You stare at it in disgust, a baleful reminder of every failing you've made since arriving here. How could you have allowed yourself to become so obsessed, so driven to repair the egg, install it on top of the mountain, when your own children needed you more? Then months of work, sculpting and tweaking and refining the shapes in the echo cave, to protect what you'd made, but you realize now it was only to protect yourself. Now your daughters are gone, and all you have left are their paintings, and a network of efficient, useless pipes and machinery.". Instead of attacking da-bluepipe: say "Rage fills you as you stare at the smooth sides of the pipe, so neat and orderly, and without a second thought you lift the crushing pickaxe up above your head and bring it down in a furious blow on the pipe. The bamboo cracks easily, a long split running down the side of the tube, and you suddenly tremble through your whole body as if from the shock of the blow.[paragraph break][pa-suicide].". To say pa-suicide: say "How easy it would be to destroy it all, everything you built, everything your daughters left behind, every shred of your existence here in this too-perfect tropical paradise. Then, when only you were left, to destroy yourself as well.[paragraph break]But you won't". Instead of attacking da-progue, say "[pa-suicide].".

Every turn when location is Dream-Atop and a random chance of 1 in 2 succeeds, say "The [o]block[x] of stone stands resolutely in the setting sun's light, mocking you.".

A heavy pickaxe is held by DA-Progue. Understand "axe" or "pick axe" or "pickaxe/pickax" as pickaxe. The description is "A blunt tool: a solid heavy wood handle strapped tightly to a sharpened chunk of the dense stone from the east island. It served to shape this outcrop of rock into an empty medium. But it is more a tool for destruction than creation.". Instead of dropping heavy pickaxe: say "Your hands are locked on it in a death grip, and you cannot loosen them.".

The dream-block is a setpiece in Dream-Atop. Understand "block/stone" as dream-block. The printed name is "block of stone". The description is "You've hewn the outcrop of rock that once stood here into a tall rough cube, ready to be sculpted into something, anything, that would finally take you from this empty place. You started as soon as you recovered from your long depression, as soon as the shock of discovering the paintings your girls, your beautiful girls, left behind when they finally escaped you, abandoned you as they should have, after you abandoned them. You are ready to leave this place now, too. All you must do is [d]sculpt[x].".

Understand "sculpt" or "make sculpture" as attacking when location is Dream-Atop. Rule for supplying a missing noun when attacking and location is Dream-Atop: change noun to dream-block.

Instead of attacking dream-block: say "You lift the pickaxe again to make the first rough inroads into that cursed block, becoming more and more solid every hour, then slowly lower it.[paragraph break]It's no use. Nothing will come.[paragraph break]Ever since you first learned of your gift-- before-- never once did you not know what to sculpt. Your mind always brimmed with images, ideas, forms that you desperately needed to make real, until one day the universe took you literally. Even when you first came here with the girls, all those dark months ago, overwhelmed at the loss of your love, the tree came immediately into your thoughts, and you began sculpting it the moment your hand touched the chisel.[paragraph break]But now nothing will come at all. And a seething finality grows in you with every passing moment. Your gift is gone, taken from you as punishment, mayhaps, for your failings, as a husband, a father, a friend in need. Or mayhaps withered and died with the rest of your spirit in these dark months behind you.[paragraph break]Mayhaps you will never sculpt again. Mayhaps you will die on this island, alone. Alone.".

Some dream-stumps are a setpiece in Dream-Atop. Understand "stump/stumps" as dream-stumps. The printed name is "stumps". The description is "Here on this spot was one of the first marks you made on this island, in the days after you and the girls arrived, chopping down the grove of konokuk trees that once grew here to build the cabin on the beach, fulfill your desperate need for home, for shelter, even if you couldn't say from what. Now you've returned to make your last mark on this place. If you can.".

First Instead of going down when location is Dream-Atop: say "[one of]You hesitate. Somehow you sense that giving up now will forfeit your last chance at sculpting your way into a new a world, at ever leaving this island full of memories and whispering minds.[or][da-end-windsigh][stopping]". Instead of attacking da-windsigh: try going down. To say da-end-windsigh: say "You turn away at last from the block of stone. Tiny fractures shatter inside you, like the delicate line of snow and ice around a thing left out in the cold, splintering under the slightest force as a person comes to move it. And as you turn, you see the tree.[paragraph break]The windsigh stands at the edge of the rise, yellow leaves fluttering in the breeze[if guessed_trees is true]. And you know they're watching you. Every time you see the tree you'll know they're watching. Wondering. Judging[end if].[paragraph break]You heft the pickaxe in your hand, and step forward. It has to be done, you think to yourself. You have to have your own space. Alone. You need to be alone.[paragraph break]You're sorry.[paragraph break]Hefting the axe, you swing with all your might and {(*s-.&6P}{,e*-.*0**{}{)}[line break][end-flashback]".

Understand "marsh/ropeway" as down when location is Dream-Atop.

Some fragments of stone are a setpiece in Dream-Atop.

To setup Dream-Atop-hints: do nothing.

DA-Progue is a dream-progue in Dream-Atop.

Volume - Forest (in Lacuna-Treeworld by Blue Lacuna)

nlt_bit is a number that varies. nlt_bit is 0.   

To notice language translation: [ The first time we see someone talk on either world, we'll notice that the language is being translated by the host body. ]
	if nlt_bit is 0 begin; 
		now nlt_bit is 1;    
		say "Strange. You notice that the sounds [the random other person in the location] makes are actually incomprehensible; [hisher] lips do not make the movements you'd expect them to; and yet you can understand, perfectly.";
	end if.      
	  
skeletons_bit is a number that varies. skeletons_bit is 0.         


Plateau is a region. Plateau is in Treeworld. Overlook is a room in Plateau. 

A Lacunite is a kind of person. The description of a Lacunite is usually "Dressed in a flowing red robe that trails along the ground; not quite human, but close enough that it doesn't bother you.". Instead of attacking a Lacunite: say "You savagely attack [the random other Lacunite in the location], who reels back in astonishment. [CHeShe] turns and flees."; remove the random other Lacunite in the location from play; increase the rap sheet of Lacunite-Follower by 3.

Check hugging a Lacunite: say "[The noun] watches you in bemusement as you do so. 'We are as real as you,' [heshe] says, 'not biologically identical, but of remarkably similar physical and even genetic structure.'" instead.

Check vague discussing when location is regionally in Treeworld: say "You are having a hard enough time keeping up with the conversation as it is." instead.

Check getting bored when location is regionally in Treeworld: post-conversation processing; do nothing instead.

A robe is a kind of thing. A robe is worn by every Lacunite. The description is "The robe is fashioned from something thin with the texture of felt. A deep, rich red, it is wrapped simply around the body and trails on the ground behind."

Lacunite-Follower is a person in Overlook [This is the body the player will inhabit while here]. Lacunite-Follower wears a robe. Lacunite-Follower is either identified or unidentified. Lacunite-Follower is unidentified. [Shows whether marked so treeworld people recognize him as the visitor.] 

Visiting Treeworld is a recurring scene. Visiting Treeworld begins when the mind machinery is projecting and the machinery-password exactly matches the text tree-password and Visiting Treeworld is not happening. 

When Visiting Treeworld begins:
	if the player is male, now Lacunite-Follower is male; [ Since we want both worlds to be presented on an even playing field, and to avoid false gender-based assumptions about either Forest or City, we choose to give both bodies the same gender as the player. ]
	otherwise now Lacunite-Follower is female;
	move Lacunite-Follower to Overlook;
	change the player to Lacunite-Follower;
	now yourself is asleep; [helps out various rules.]
	now the time of day is 7:00 PM;
	now the time factor is 0;
	try looking.

Visiting Treeworld ends nominally when the player is yourself. Visiting Treeworld ends successfully when gp_outtro is spoken and the player is yourself.

When Visiting Treeworld ends:
	if rap sheet of Lacunite-Follower < 5, move Lacunite-Follower to a random room in Treeworld;
	unless Visiting Rebelworld ended successfully, set up the endgame storm.
. [The character continues to go about its business.]

[When Visiting Treeworld ends successfully:
	now Ditching The Trees is met.]

When Visiting Treeworld ends successfully:
	if Visiting Rebelworld ended successfully, set up the endgame afterstorm. 

Check sleeping when the player is regionally in Treeworld (this is the close eyes to leave Treeworld rule):
	say "You close your eyes deliberately for a long moment, but feel no change. But when you open them--";
	now yourself is awake; 
	change the player to yourself;
	print a section break;
	say "[bold type][location][roman type][line break][description of location]". [We do this instead of looking because we want to show the description of the area, not the chair controls, to emphasize we've returned to Lacuna.]

Carry out landmark-listing when location is regionally in Treeworld: say "This place is so different and strange, it's hard to get your bearings."

[Reflecting Pool, Outside the Dome, Among the Huts, Nursery, Ancient Temple, and Base of the Great Tree are landmarked.  The landmark name of Reflecting Pool is "the reflecting [d]pool[x]". The landmark name of Outside the Dome is "the [d]map[x] room". Understand "map" as Outside the Dome. The landmark name of Among the Huts is "the maker [d]village[x]". Understand "village" as Among the Huts. The landmark name of Nursery is "the thinker [d]nursery[x]". The landmark name of Ancient Temple is "the [d]temple[x] circle". The landmark name of Base of the Great Tree is "[d]base[x] of the Philosopher".

Carry out landmark-listing when location is regionally in Treeworld:
	say "The landmarks you can go to are: ";
	repeat with locale running through visited landmarked rooms regionally in Treeworld begin;
		say "[line break]  ";
		if the landmark name of locale is not "null", say the landmark name of locale; otherwise say locale;
	end repeat.]


Chapter - Definitions

Test treeworld with "ff / ff / ff / tp observatory exterior / knock thrice / clap / sit / bypass calib / touch key / d7shejskdf / touch globe".



Chapter - Lacunites

A Lacunite-gardener is a kind of Lacunite. The indefinite article of a Lacunite-gardener is usually "the". Understand "planter" as a Lacunite-gardener. Reflecting Pool is a room. Avenue North is a room. Avenue South is a room.

The worker1 is a Lacunite-gardener in Reflecting Pool with printed name "red-robed woman". Worker1 is female. Understand "woman" or "local" as Worker1. "A young [o]woman[x] kneels [if location is Reflecting Pool]near the pool's edge, tending the flowers that grow there[else]here, tending the flowers[end if].". The description is "[if we have not examined Worker1]As you look closer, it becomes apparent that she is not a woman, exactly: at least, not a human woman. The eyes are a little too large, the skin mottled in a strange way. When she is not moving she holds herself so still to be almost statue-like. [end if][if we have not examined Worker1 and skeletons_bit is 0]Then, suddenly, it hits you: this woman is a living, breathing version of the ancient skeletons you saw in the Egg ship on Lacuna. [otherwise if we have not examined Worker1]Another from that race whose skeletons moulder in the egg ship on Lacuna. [end if]She wears long robes, intricately stitched and trailing along the ground behind her, and long white braids descend from either side of her face, though she does not look old." 

The worker2 is a Lacunite-gardener in Avenue South with printed name "lanky teenager". "A tall, lanky teenaged boy is carefully clipping back the grass here." Understand "tall" or "lanky" or "teenaged" or "teenager" or "teen" or "boy" as Worker2.

The worker3 is a Lacunite-gardener in Avenue North with printed name "balding man". "A balding man kneels here, tending the flowers." Understand "balding" or "man" as Worker3.

Every Lacunite-gardener has a number called counter. The counter of a Lacunite-gardener is usually 1. [This keeps track of how long each gardener spends working in one room.]

Every turn when the player is in Treeworld and stranger_counter <= 0 (this is the process Lacunite movement rule):
	repeat with processee running through idle on-stage Lacunite-gardeners:
		increase counter of processee by 1;
		if counter of processee > 10 and ( a random chance of 1 in 7 succeeds or counter of processee > 30 ) :
			let L-target be Fork;
			let loopcounter be 0;
			while L-target is not in Plateau or an other Lacunite is enclosed by L-target:
				increase loopcounter by 1;
				now L-target is a random room adjacent to processee;
				if loopcounter > 10, stop;
			let way be up;
			[Avoid slowdowns from pathfinding]
			if L-target is mapped north of location of processee, now way is north;
			if L-target is mapped northeast of location of processee, now way is northeast;
			if L-target is mapped east of location of processee, now way is east;
			if L-target is mapped southeast of location of processee, now way is southeast;
			if L-target is mapped south of location of processee, now way is south;
			if L-target is mapped southwest of location of processee, now way is southwest;
			if L-target is mapped west of location of processee, now way is west;
			if L-target is mapped northwest of location of processee, now way is northwest;
			if way is up, stop;
			if location of Lacunite-Follower is location of processee, say "[The processee] finishes one last bit of gardening and [one of]smiles in satisfaction[or]pats the ground happily[or]leans back to study [hisher] work critically[at random]. Then, [heshe] gets to [hisher] feet, and walks off towards [the room way from location of processee].";
			if location of Lacunite-Follower is L-target, say "[The processee] arrives from [the location of processee], kneels next to [one of]a bed of flowers[or]a piece of greenery[or]some mossy brickwork[at random], pulls out a spade, and begins to tend it.";
			try processee trying going way;
			now counter of processee is 0.

Report a Lacunite-gardener going a direction: do nothing instead. 

Chapter - Views and Backdrop

Avenue South is a room.

The distant Philosopher is a backdrop. Understand "tree/tree9/gigantic/windsigh/withered/huge" as the distant Philosopher. The printed name is "[if Treeworld-Hivemind is named]Philosopher[otherwise]huge windsigh at the top of the ridge[end if]". The distant Philosopher is in Top of Spire, Reflecting Pool, Avenue South, Mural Center, and Avenue North. The description is "The windsigh is massive, far, far larger than any you saw on Lacuna. A great set of sweeping stone steps, huge twisted roots running down and around them, runs up to a portal at its base which seems to lead inside the mammoth trunk. The tree seems old, very old, but emanates an almost palpable sense of strength and power." Instead of climbing distant Philosopher: say "You aren't close enough.".

The brick pathways are a backdrop. Understand "pathway" or "path" or "paths" or "well-tended" or "road" or "brick" or "bricks" as the pathways. The pathways are in Reflecting Pool, Avenue South, Outside the Dome, Among the Huts, Ancient Temple, Avenue North, and Nursery. The description is "Made of small rounded bricks, ranging in shade between yellow and pink." After touching the pathways, say "Near the center of the path, the warm bricks are rubbed smooth by generations of feet."



Chapter - Ambience

The ambience table of Plateau is the Table of Treeworld Ambience.

Table of Treeworld Ambience
freq		start time	end time	text	table		trigger	flag
uncommon		--	--		--	Table of Butterfly Ambience		butterfly
uncommon		--	--		"[one of]Wind gusts through the forest, sending rippling currents like living creatures through the branches.[or]Leaves swirl in tiny eddies as a hot breeze stirs them up.[or]Harmonic tones in varying pitches sound all around you as a breeze gusts over the plateau.[in random order]"
uncommon		--	--		"[one of]Ghost thoughts tug at your mind, whispers of half-heard ideas and dreams.[or]For a moment, you can sense ripples of thought rolling through the forest, slow, but inexorable-- then the sensation passes.[or]Looming somewhere nearby is the presence of an enormous mind. You can feel it, even from this distance.[in random order]"
uncommon		--	--		"[one of]Somewhere through the trees is the faint sound of shears.[or]Through the trees you catch a glimpse of a group of red-robed figures, gliding with measured grace along a path.[or]From some faint distance, you think you catch an echo of children's laughter.[in random order]"


Table of Butterfly Ambience
freq		text	table		trigger	flag
guaranteed	"[one of]Wings spread wide, a huge yellow butterfly drifts by, hardly flapping as it floats on updrafts[or]Two huge yellow butterflies flap gently by, on their way somewhere in the forest[or]A large yellow butterfly alights delicately on a tree branch, fanning its wings majestically[or]In the sky above you, a flock of huge butterflies drift in the breeze, the red sun lighting up their thin wings like lanterns[in random order]."	--	butterfly

A butterfly is a minor set dressing. The description is "Its wingspan is as wide across as your torso, and the wings are thin and delicate."


Chapter - Creatures


The Treeworld-Hivemind is an undescribed person. He is in Great Tree Interior. 

Instead of greeting a Lacunite-gardener:
	pre-conversation processing;
	if Lacunite-Follower is unidentified, force discuss hm_recognize;
	now Lacunite-Follower is identified;
	force discuss hm_intro.

Instead of saying farewell to a Lacunite-gardener: force discuss hm_outtro.

HM is a thread.

To say pupilscontract: say "[one of]eyes change-- pupils shrinking down to near points, as if shutting out all outside light to focus on some internal brightness--[or]pupils shrink again[or]pupils dilate[stopping]".

hm_intro is a repeatable beat in HM with reaction "[one of]'Greetings,' [heshe] says. 'And welcome to our world, friend of Progue. You must have many questions. I will answer what I can.'[or]'Greetings, friend. What other questions do you have?'[stopping]". After discussing hm_intro: notice language translation; continue the action. hm_intro summons hm_where, hm_how, hm_why, hm_name. hm_intro suggests hm_outtro.

Understand "where/heart" as hm_where when last beat is in HM. hm_where is a repeatable beat in HM with fuse 9 and keyword name "[if last beat is hm_intro or last beat is hm_recognize]where[else]Heart" and reaction "'This is the Grove of the Philosopher,' [the random Lacunite in the location] says, spreading [hisher] arms, 'on the planet we call the Heart of Forest. It is our [hm_Forest], where our great civilization first began, before spreading to thousands of other worlds. Please, explore.'". hm_where suggests hm_outtro.

Understand "how" as hm_how when last beat is in HM. hm_how is a repeatable beat in HM with fuse 9 and keyword name "how" and reaction "[CHeShe] looks uncertain for a moment, then [hisher] [pupilscontract] before [heshe] returns, smiling. 'You are still on Lacuna,' [the random Lacunite in the location] assures you. 'One of us has volunteered to lend you [if player is male]his[else]her[end if] body for your visit. All [if player is male]he[else]she[end if] sees and feels and hears is being sent through the mindlink back to your mind on Lacuna, and your muscle movements are being sent here, channeled by the [hm_Thinkers] around us. Your mind remains on Lacuna, but your presentness and awareness are here, light-years away.'". hm_how suggests hm_outtro.

Understand "why/now" as hm_why when last beat is in HM. hm_why is a repeatable beat in HM with fuse 9 and keyword name "[if last beat is hm_bluerock]now[else]why" and reaction "'We have brought you here in the hope you will help us with a great task,' [heshe] says[unless gp_intro is spoken]. 'When you are ready to hear more of this, [hm_Philosopher] the Philosopher at the top of the ridge.' [CHeShe] turns and points towards the huge windsigh at the end of the avenue. 'We hope to speak with you before you leave.'[else].[end unless]". hm_why suggests hm_outtro.

Understand "name" as hm_name when last beat is in HM. hm_name is a repeatable beat in HM with fuse 9 and keyword name "name" and reaction "[CHeShe] looks confused, but then [hisher] [pupilscontract] and [heshe] smiles. 'The [hm_Thinkers] have explained,' [heshe] says. 'We do not have names here in the sense you think of them, neither Thinkers nor [hm_Makers]. Within our groves we call each other merely by what we do. You may call me Planter.'". hm_name suggests hm_outtro.

Understand "thinkers" as hm_thinkers when last beat is in HM. hm_thinkers is a beat in HM with keyword name "Thinkers" and reaction "'The Thinkers are the trees, what your friend called the windsigh, rooted and slow,' [heshe] says in a singsong tone, as if the words are old and familiar. 'They are logic and reason, thought and intellect, one half of Forest. The [hm_Makers] are the other.'". hm_thinkers suggests hm_outtro.

Understand "makers" as hm_makers when last beat is in HM. hm_makers is a beat in HM with keyword name "Makers" and reaction "'The Makers are the people like your host and I,' [heshe] says, 'rootless and quick. They are movers and builders, travelers and discoverers, one half of Forest. The [hm_Thinkers] are the other.'". hm_makers suggests hm_outtro.

Understand "homeworld" as hm_forest when last beat is in HM. hm_Forest is a beat in HM with keyword name "homeworld" and reaction "'Forest is what we call our great civilization,' [heshe] says, 'for we are a single forest, though our groves touch the soil of a thousand worlds. We are joined together by the [hm_bluerock], which keeps the [hm_thinkers] connected even across the vastnesses of space.'". hm_forest suggests hm_outtro.

Understand "bluerock" as hm_bluerock when last beat is in HM. hm_bluerock is a beat in HM with keyword name "bluerock" and reaction "'The blue crystal which grows on your Lacuna,' [heshe] says. 'It is incredibly rare and precious. The Forest did not realize this until all our Eggs had gone and we discovered the [hm_where] was the only world where it was found. Until [hm_why].'". hm_bluerock suggests hm_outtro.

Understand "visit" as hm_philosopher when last beat is in HM. hm_philosopher is a beat in HM with keyword name "visit" and reaction "'One of the oldest and highest [hm_thinkers] in all the [hm_where],' [heshe] says with reverence, 'and even in all Forest. Being one of the chosen few to tend the roots here is an honor[unless gp_intro is spoken]. The Philosopher was chosen to ask a great favor of your friend Progue-- and now, of you. Go to the end of the avenue when you are ready to learn [hm_why] it is we have brought you here[end if].'". hm_philosopher suggests hm_outtro.[aar]





Chapter - Rooms


Overlook is east of Top of Spire. Top of Spire is northwest from Overlook. Southeast of Top of Spire is nowhere. West of Overlook is nowhere. Reflecting Pool is down from Top of Spire. Avenue South is northwest from Reflecting Pool. Avenue South is northeast from Reflecting Pool. Reflecting Pool is southeast from Avenue South. Reflecting Pool is southwest from Avenue South.

Outside the Dome is west of Avenue South. Map Room is inside of Outside the Dome. Mural Far West is west from Outside the Dome. Outside the Dome is southeast from Mural Far West. Among the Huts is east of Avenue South. Bare Hut is inside of Among the Huts. Mural Far East is east from Among the Huts. Among the Huts is southwest from Mural Far East. Northeast of Among the Huts is nowhere. 

East of Mural Far West is a room called Mural West. East of Mural West is Mural Center. East of Mural Center is a room called Mural East. East of Mural East is Mural Far East. Mural Center is north of Avenue South. Avenue North is north of Mural Center. Shrine is inside of Ancient Temple. Ancient Temple is west of Avenue North. Mural Far West is west of Ancient Temple. Ancient Temple is northeast of Mural Far West. Southwest of Ancient Temple is nowhere. Nursery is east of Avenue North. Mural Far East is east from Nursery. Nursery is northwest from Mural Far East. Southeast of Nursery is nowhere. West of Mural Far East is Mural East. Mural Far West is west of Reflecting Pool. Reflecting Pool is south of Mural Far West. North of Reflecting Pool is nowhere. Mural Far East is east of Reflecting Pool. Reflecting Pool is south of Mural Far East.

Base of the Great Tree is northeast of Avenue North. Base of the Great Tree is northwest of Avenue North. Avenue North is southeast of Base of the Great Tree. Avenue North is southwest of Base of the Great Tree. Inside of Base of the Great Tree is Great Tree Interior. 

Overlook, Top of Spire, Reflecting Pool, Outside the Dome, Avenue South, Among the Huts, Mural Far West, Mural West, Mural Center, Mural East, Mural Far East, Nursery, Avenue North, Ancient Temple, and Base of the Great Tree are in Plateau. Plateau, Great Tree Interior, Map Room, Bare Hut, and Shrine are in Treeworld.

The elevation of Reflecting Pool, Avenue South, Among the Huts, Bare Hut, Map Room, and Outside the Dome is 100 feet. The elevation of Top of Spire and Overlook is 150 feet. The elevation of Mural Center, Mural West, Mural Far West, Mural East, and Mural Far East is 110 feet. The elevation of Avenue North, Nursery, Ancient Temple and Shrine is 120 feet. The elevation of Base of the Great Tree and Great Tree Interior is 150 feet.

The heart-windsigh are a backdrop in Treeworld. Understand "windsigh/tree/trees" as heart-windsigh. The printed name is "grove of windsigh". The description is "The trees are everywhere; the air is thick with the scent of their leaves, and their sighing moans reverberate in shifting harmonic waves across the ridge with the wind. They are taller and more graceful here than their more twisted, stunted brothers on Lacuna.". Does the player mean doing something to the heart-windsigh: it is unlikely. Instead of attacking heart-windsigh: say "You attack one of the nearby windsigh, ripping leaves from the branches and pulling vines from its trunk savagely."; increase the rap sheet of Lacunite-Follower by 3.

To say tomuraldesc: say "You follow an immaculately tended dirt path through [one of]the forest[or]groves of windsigh[at random], [one of]the trees whispering all around you[or]the red sun cutting through the shade here and there in great, thick beams of light[or]a warm breeze gusting through millions of openings to produce a constant, multi-tonal hum[in random order], [one of]until you come into an open meadow[or]till you reach the long meadow again[stopping]".

To say brickpathdesc: say "You follow the straight brick pathway through tended groves of trees till you reach the avenue again.". [aar]

Definition: a room is avenueish: if it is Avenue South or it is Mural Center or it is Avenue North, yes; no. Report going from an avenueish room to an avenueish room: say "You walk farther along the wide grassy avenue.".


Chapter - Misbehaving

Lacunite-Follower has a number called rap sheet.

Getting Treerested is a scene. Getting Treerested begins when the rap sheet of Lacunite-Follower >= 5. When Getting Treerested begins: say "Within moments, a group of red-robed people surrounds you and gently but firmly restrains you.[paragraph break]'You must be having trouble controlling the actions of this body,' one of them says to you with concern. 'Perhaps the Thinkers have not understood your mind as well as they thought. We will escore you to the Philosopher[unless gp_intro is spoken] for your audience[end unless].' They firmly take hold of you and propel you up the avenue towards the huge windsigh at its top, and take you inside."; print a section break; move Lacunite-Follower to Great Tree Interior. Getting Treerested ends when location is Great Tree Interior.

Instead of going or exiting or landmark-going when location is Great Tree Interior and the rap sheet of Lacunite-Follower >= 5: say "A group of red-robed figures stand just outside the tree and bar your way. 'When you are ready to leave,' one says, 'simply close your eyes and your senses will be returned to Lacuna.'".


Section - Overlook


Overlook is a room in Plateau. The landmark name of Overlook is "the forest [d]overlook[x]". The printed name of Overlook is "Great Forest Overlook".

The description of Overlook is "[if unvisited]...and a moment later lower it, blinking in unexpected brightness and a rich smell of earth and leaves.
	
[end if]You [if unvisited]kneel[otherwise]stand[end if] on a curved platform jutting out over a cliff, overlooking a vast [o]forest[x] of windsigh that stretches to the horizon in every direction. A huge red-gold [o]sun[x] burns near the horizon, throwing brilliant reflections off the hundreds of streams winding through the forest and illuminating millions of leaves, in this light more gold than lemon-yellow. [paragraph break][exits][gfodesc2].". To say gfodesc2: say "[if unvisited].[paragraph break]Shaking off vertigo, you rise to your feet. As you do, an earth-covered [o]spade[x] slips from your hand[end if]". Understand "path" or "around" as northwest when location is Overlook. The exits text of Overlook is "A well-kept path curves [d]around[x] the edge of the cliff".

Some viney plants are a prop in Overlook. Understand "vine" or "vines" or "ivy" as the plants. Understand "soil" or "earth" as the viney plants. The initial appearance of the plants is "On the ground are some carefully tended vines and a few simple gardening tools." The description of the plants is "Ivy-like, with long skinny leaves fading slowly from green to reddish gold. The patch runs along the edge of the platform, immaculately tended." Instead of taking the plants, say "You see no reason to rip them from the ground."

A spade is an undescribed thing in Overlook. "An earth-stained garden spade lies on the ground." The description of the spade is "The spade is a simple tool, worn from use and stained with fresh, damp earth." After taking spade: say "You pick it up." instead; now spade is described. Instead of smelling the spade, say "The soil smells rich, almost heady." Instead of touching the spade, say "The damp soil feels thick and crumbly under your fingertips." Understand "garden spade" as spade. Check remembering a spade: say "It's gone. Some efficient gardener must have picked it up." instead.

The overlook vista is a backdrop in Overlook. Understand "forest" or "trees" or "streams" or "leaves" as the vista. The description is "The vista is spectacular in the light of the sinking sun. As you study the landscape, you realize that the design and layout is not wholly random; the placements of the streams, the position of the trees is more ordered, more formal than a forest grown without conscious intervention would be."

The huge red-gold sun is a backdrop. It is in Treeworld. The description is "The star seems much larger and yet dimmer than the one on Lacuna; you can almost look directly at it. Distant clouds passing before it near the horizon emphasize its massive bulk; the reddish-gold light pouring from it is spectacular."

Report going from Overlook to Top of Spire: say "You walk along the path around the edge of the boulder, bringing the top of a forested plateau into view."


Section - GFO Conversation

[A more personal conversation with a scientist from this world. This is designed to address fears that the makers are just drones or clones: they are individuals.]

Sunset Years is a scene. Sunset Years begins when location is Overlook and Reflecting Pool is visited. When Sunset Years begins: say initial appearance of Scientist; move Scientist to Overlook.

After greeting Scientist, force discuss sy_intro. Instead of exhausting when Scientist is enclosed by location: say "'Better to learn more by experiencing it,' she says. 'Go. Explore. Find what you wish to know.'".

Instead of greeting Scientist when Lacunite-Follower is unidentified: say "'Hello, Planter,' the woman says dreamily, still gazing into the sunset. 'Pardon, but I prefer to enjoy the sunset alone.'".

Scientist is a female Lacunite with printed name "old woman". Scientist is privately-named. Understand "old" or "woman" as Scientist. The initial appearance is "Standing on the balcony gazing into the sunset is a very old [o]woman[x], her red robes burning like fire in the light of the sun.[line break]". The description of Scientist is "Her face is lined with wrinkles, and her hair is loose, a white curtain trailing down to her waist. She stares at the forest of windsigh below with a peaceful smile. The gold-red light shimmers on her red robes, picking out the threads of blue and gold twining through the stitching.[paragraph break]She looks somehow different from the others you've seen, as if she comes from somewhere far away.".

SY is a thread. sy_intro is a beat in SY with reaction "She turns to you smiling, and bows a little. 'Hello, visitor,' she says softly. [if Lacunite-Follower is unidentified]Noticing you stiffen, she puts a hand to your shoulder in amusement. 'May be the younger ones don't see, but to me it's clear who you are. Everything about the way you move, and look, suggests it. [else]'[end if]I am honored to meet you.'". sy_intro summons sy_name. sy_whatelse replaces sy_intro.

sy_whatelse is a repeatable beat in SY with reaction "'[one of]What other questions can I answer[or]What else can I tell[or]What other things shall I speak of[or]What more should I say[in random order]?' she asks.". sy_whatelse suggests sy_question. sy_whatelse summons sy_maker, sy_mother, sy_scientist, sy_traveler, sy_heart.

Understand "name" as sy_name when last beat is in SY. sy_name is a beat in SY with keyword name "name" and reaction "'Name?' She tilts her head, considering. 'I am a [sy_maker] in the [sy_heart]. I have been [sy_mother]. I have been [sy_scientist]. Now I am a [sy_traveler]. You may call me Traveler, if you wish,' she says.". sy_name suggests sy_whatelse.

Understand "maker" as sy_maker when last beat is in SY. sy_maker is a beat in SY with keyword name "maker" and fuse 5 and reaction "'We, those like you and I,' she says, 'are Makers. The ones who are rooted are [sy_thinkers]. Together we make up the Forest.'". sy_maker suggests sy_whatelse.

Understand "heart" as sy_heart when last beat is in SY. sy_heart is a beat in SY with keyword name "Heart" and fuse 5 and reaction "'This world is the Heart,' she says, stretching out a hand to take in the whole view, 'the Heart of Forest, the great forest that stretches across a thousand worlds of our galaxy. This is the world where Thinkers and Makers grew, and where they first awakened each other. To have been born in the Heart and served these ancient Thinkers has been a great blessing in my life.'". sy_heart suggests sy_whatelse.

Understand "thinker/thinkers" as sy_thinkers when last beat is in SY. sy_thinkers is a beat in SY with keyword name "Thinkers" and fuse 5 and reaction "'They live without us in worlds of pure logic, reason, and order,' she says. 'It is only through the eyes of Makers they can see and know the outside world, and only through our hands they can affect it.'". sy_thinkers suggests sy_whatelse.

Understand "mother" as sy_mother when last beat is in SY. sy_mother is a beat in SY with keyword name "Mother" and fuse 5 and reaction "'I bore three children,' she says with a proud smile, 'a rare honor to be [sy_chosen] for so many. When the second came I was Mother of my grove, so helped him and all the others grow from day to day; bathing, feeding, singing [sy_songs] through the slow mornings till [sy_teachers] came to teach. He is still my favorite, though his own children now are grown.'". sy_mother suggests sy_whatelse.

Understand "song/songs" as sy_songs when last beat is in SY. sy_songs is a beat in SY with keyword name "songs" and reaction "'I never forget the old songs. Would you like to hear one?' she asks unselfconsciously.". The yes-beat of sy_songs is sy_singsong. The no-beat of sy_songs is sy_nosong. sy_songs summons sy_singsong, sy_nosong. sy_songs suggests sy_nosong.

sy_nosong is a beat in SY with keyword name "no" and reaction "'Very well,' she says, but there is no hint of the disappointment, obsequiousness, or anger that such words might hide among your own kind. She seems to mean exactly what the words say: it is just as well she doesn't song the song as it would be if she did.". sy_nosong suggests sy_whatelse. sy_nosong cancels sy_singsong.

sy_singsong is a beat in SY with keyword name "yes" and reaction "'This one has been sung from Mother to child for generation on generation,' she says.[paragraph break]She gazes off towards the huge red sun and pauses for a long moment. When at last she begins to sing, it is slow, rhythmic, each word seeming to be heavier with meanings than the sounds alone suggest, an almost tuneless melody shaping them:

'Food and fire,[line break]
Earth and bone,[line break]
Fruit and stream,[line break]
Song and home.

These are the things which make you live,[line break]
Child.

Root and vine,[line break]
Leaf and tree,[line break]
Mind and thought,[line break]
Join and weave.

These are the things which make you,[line break]
Child.

Strain and toil,[line break]
Ear and eye,[line break]
Foot and leg,[line break]
Sweat and thigh.

These are the things which make,[line break]
Child.'

When at last she finishes, she pauses for another moment, then smiles at you. 'That one I've always liked,' she says.". sy_singsong suggests sy_whatelse. sy_singsong cancels sy_nosong.

Understand "scientist" as sy_scientist when last beat is in SY. sy_scientist is a beat in SY with keyword name "Scientist" and fuse 5 and reaction "'A botanist,' she says, 'a specialist in the tropical flowers of the southern archipelagos. I [sy_trained] with prestigious groves of scientist [sy_Thinkers]. There is so much diversity on the [sy_Heart], explosions of life everywhere; we still find new [sy_compounds] and chemicals in the jungles each year.'". sy_scientist suggests sy_whatelse.

Understand "trained" as sy_trained when last beat is in SY. sy_trained is a beat in SY with keyword name "trained" and fuse 5 and reaction "'The more training the [sy_Thinkers] give us,' she says, 'the less they have to Think for us. Of course they could instruct any of us to perform a surgery or construct a spaceship; move this arm here, grip that piece so. But if we learn to do the things ourselves, they do not need to trouble themselves with that.'". sy_trained suggests sy_whatelse.

Understand "chosen" as sy_chosen when last beat is in SY. sy_chosen is a beat in SY with keyword name "chosen" and fuse 5 and reaction "'All who wish to may have a child,' she says, 'but we have filled up this world, so second and third children can only be allowed with careful consideration by Planner [sy_Thinkers] for agriculture, society, and quality of parent.'". sy_chosen suggests sy_whatelse.

Understand "teachers" as sy_teachers when last beat is in SY. sy_Teachers is a beat in SY with keyword name "Teachers" and fuse 5 and reaction "'Some makers are Mothers to care for the children,' she says. 'Some are Teachers to instruct them in logic and reason, in history, and in science. Others are Thoughtsingers who help the children learn to hear the voice of the [sy_Thinkers] more clearly and make themselves be heard. Together, all three help the children of a grove to grow.'". sy_teachers suggests sy_whatelse.

Understand "compounds" as sy_compounds when last beat is in SY. sy_compounds is a beat in SY with keyword name "compounds" and fuse 5 and reaction "'To help the bodies of [sy_Thinkers] and Makers,' she says, 'or the Science they pursue. To extend life and ease suffering; extract what we need for survival from the [sy_Heart] with more precision and efficiency; construct more durable shelters and more powerful machines.'". sy_compounds suggests sy_whatelse.

Understand "traveler" as sy_traveler when last beat is in SY. sy_traveler is a beat in SY with keyword name "traveler" and fuse 5 and reaction "'Yes,' she says, 'there is no more of use I can make, so I spend my final years traveling the [sy_Heart], seeing the [sy_wonders] of this world, and taking comfort in its [sy_mundane] aspects too.'". sy_traveler suggests sy_whatelse.

Understand "wonders" as sy_wonders when last beat is in SY. sy_wonders is a beat in SY with keyword name "wonders" and fuse 5 and reaction "'Many places now,' she says, 'black beaches, grand chasms-- the Conclave of Arbiters. The old bluerock [sy_mines] in the north. And here, the grove of the Philosopher-- a place I have long wanted to come to.'". sy_wonders suggests sy_whatelse.

Understand "mundane" as sy_mundane when last beat is in SY. sy_mundane is a beat in SY with keyword name "mundane" and fuse 5 and reaction "'Just the daily lives of the millions of groves on Heart,' she says. 'The [sy_farmers], the builders, even the [sy_defectives]. Sometimes that which is simple is as good to see as that which is not.'". sy_mundane suggests sy_whatelse.

Understand "farmer/farmers" as sy_farmers when last beat is in SY. sy_farmers is a beat in SY with keyword name "farmers" and fuse 5 and reaction "'Most groves do still grow their own food,' she says. 'The Planner Thinkers long ago saw that was best. But in some places, the science cities or mine outposts, the Makers must be more specialized. So there are Farmers who grow the food and Movers who transport it and others who eat it.'". sy_farmers suggests sy_whatelse.

Understand "defective/defectives" as sy_defectives when last beat is in SY. sy_defectives is a beat in SY with keyword name "defectives" and fuse 5 and reaction "'Oh,' she says, 'those who are born without the ability to hear the Thinkers. Poor ones. There are special groves for them, where Tenders look after them, make sure they find food and keep busy and do not wander off to die. The Tenders and the Thinkers who advise them do what they can, but the defectives are not happy. Their lives have no direction, no greater purpose. They often fall to squabbling, even-- even hurting each other or the Thinkers around them. Some say they should not be allowed to be born, but as long as the [sy_Edict] holds, they are our wards.'". sy_defectives suggests sy_whatelse.

Understand "edict" as sy_edict when last beat is in SY. sy_edict is a beat in SY with keyword name "Edict" and fuse 5 and reaction "'The Edict of the Sacred Genomes,' she says. 'Before my grandparents were born, the Thinkers and Makers together discovered the code inside us both that makes us Be. But after much deliberation by Thinkers across the thousand worlds of Forest, it was decided that nothing should be done that might change the connection between us; nothing should be done to alter or change our genomes until they each were completely understood. Some say this will not happen for thousands of years, if at all. So for now, we wait.'". sy_edict suggests sy_whatelse.

Understand "mines" as sy_mines when last beat is in SY. sy_mines is a beat in SY with keyword name "mines" and fuse 5 and reaction "'Huge open pits dug into the tundra,' she says, 'and great shafts descending miles and miles towards the warm core, now filled again with snow and ice. All for a few pounds of pure bluerock in each vein. Primitive technology compared to what we have now, but now there is no bluerock left.'". sy_mines suggests sy_whatelse.

Instead of saying farewell to Scientist when sy_question is unspoken: force discuss sy_question. Instead of getting bored when Scientist is enclosed by location: force discuss sy_question.

sy_question is an insistent beat in SY with reaction "She hesitates. 'Do not answer if you wish not to,' she says, 'but I have heard that you come from a world-- a people of Makers who have no Thinkers. You are alone. Is this true?'". The yes-beat of sy_question is sy_alone. The no-beat of sy_question is sy_noalone. sy_question summons sy_alone, sy_noalone. sy_question suggests sy_noans. sy_outtro replaces sy_question.

sy_alone is a beat in SY with keyword name "yes" and reaction "She shakes her head. '[alonebit].' She sighs. 'It may be we seem just as strange to you. But I can't imagine it. I cannot begin to think how you must feel.'". sy_alone enqueues sy_outtro.

sy_noalone is a beat in SY with keyword name "no" and reaction "She nods. 'I thought the report must have been wrong,' she says. '[alonebit].' She shudders. 'It is good you are not alone. It is good you are like us. I am happy.'". sy_noalone enqueues sy_outtro.

sy_noans is a beat in SY with reaction "'Very well,' she says[if sy_nosong is spoken], again[end if] with no hint of disappointment or anger, 'it is for the Thinkers to know such things, not one such as I who has no use for that knowledge.'". sy_noans enqueues sy_outtro.

To say alonebit: say "I cannot conceive of such sadness,' she says quietly. 'To not have the thoughts of your kin tree always with you, to guide and advise-- to be vulnerable to attack from wild creatures, without thousands of eyes watching for your safety. And when out of sight of your other Makers-- alone".

sy_outtro is a repeatable terminal beat in SY with reaction "'[one of]It was good to meet you,' she says. 'I wish you welcome to our world.' [or]Go with welcome,' she says. [stopping]She touches fingertips to her forehead, then turns back to the spectacular view.".


Section - Top of Spire

Top of Spire is a room in Plateau. 

The description of Top of Spire is "You stand on a short, rocky spire atop a great sloping [o]ridge[x], running far off towards snow-capped mountains in the distance. Below you the ridge top is dominated by more windsigh forest, but a cleared grassy avenue runs toward one gigantic withered [o]tree[x], towering over all the rest at the highest point of the angled slope[if unvisited], and at once you sense that this whole ridge is somehow centered around and exists for that single tree[end if]. [paragraph break][exits][tosdesc2].". To say tosdesc2: say "[if unvisited].[paragraph break]Your heart catches for a moment as you take in another detail: you can also see [o]people[x], clad in red, walking amongst the trees or tending to plants along the avenue[end if]". The exits text of Top of Spire is "Carved stone steps run [down] the spire towards the avenue, and a path leads back [d]around[x] the spire to the overlook". Understand "path" or "around" as east when location is Top of Spire. Understand "steps" or "avenue" as down when location is Top of Spire.

The distant tree_people is a backdrop in Top of Spire. Understand "people" or "red" as tree_people. The description is "You can make out few details from this distance. Perhaps a dozen are in sight."

The ridge is a backdrop in Top of Spire. The description is "The flattened ridge, dense with forest, runs off towards the distant mountains. On either side it drops off steeply toward valleys far below.". Instead entering or climbing ridge: say "It's far off in the distance.".

Report going from Top of Spire to Reflecting Pool: say "You walk down the worn stone steps to a grassy field at the base of the outcropping."

Section - Reflecting Pool

Reflecting Pool is a room in Plateau. The description of Reflecting Pool is "A long, shallow reflecting [o]pool[x], integrated so well into the landscape you aren't sure if it's planned or natural, reflects a broad green avenue lined with trees gently stretching towards [the Distant Philosopher].[paragraph break][exits]." The exits text is "Two carefully tended paths [d]circle[x] the pool, meeting again on the opposite side at the start of the avenue. Smaller paths disappear into trees, one [d]towards[x] the sun and the other into [d]shadows[x]. Stone steps climb [up] a rocky spire, while a much grander stair runs [down] to a valley far below". Understand "sun" or "toward" or "towards" as east when location is Reflecting Pool. Understand "shade" or "into" or "shadows" as west when location is Reflecting Pool. Understand "plateau" or "around" or "circle" as northwest when location is Reflecting Pool.

Instead of going down in Reflecting Pool, say "You step to the edge of the stairs and look down a long, winding stair, snaking down the cliff to the forest far, far below. It's a journey you're not sure this body is up to." Instead of entering the shallow reflecting pool, say "The pool looks shallow enough, but it is calm and well-tended, and some inner voice compels you to consider one of the [o]paths[x] instead."

Report going to Avenue South from Reflecting Pool: say "[roundthepool]". Report going to Reflecting Pool from Avenue South: say "[roundthepool]". To say roundthepool: say "You follow the path, perfectly interlocking stone tiles lined by well-tended vegetation, around the edge of the pool [if location is Reflecting Pool]to a flat spot at the base of the spire[otherwise]to the end of a broad avenue[end if]." Report going from Reflecting Pool to Top of Spire: say "You climb the stairs up the steep slope around the rocky spire." Report going from Reflecting Pool to Mural Far West: say "[tomuraldesc].". Report going from Reflecting Pool to Mural Far East: say "[tomuraldesc].".[aar]

LYPNflag is a number that varies. LYPNflag is 0.

Learning Your Projected Nature is a scene. Learning Your Projected Nature begins when the player has been in Overlook for exactly one turn.  Learning Your Projected Nature ends when LYPNflag is 1.

Every turn during Learning Your Projected Nature:
	if the location is Reflecting Pool, say "[one of]Your [o]reflection[x] in the pool catches your eye. Something seems strange about it.[or][reflectionreminder][stopping]". To say reflectionreminder: if a random chance of 1 in 4 succeeds, say "Your [o]reflection[x] in the pool catches your eye. Something seems strange about it.".

Instead of examining Lacunite-Follower:
	if Learning Your Projected Nature is happening, now LYPNflag is 1;
	say "[if Learning Your Projected Nature is happening or we have examined the player]You look down at your body with astonishment: you seem to be wearing a loose red robe. But as your hands move to feel the material, you gasp in shock.
		
They are not your hands.

They are[otherwise]You seem to be wearing a loose, red robe, contrasting with your hands:[end if] a different shade and shape, familiar knuckles and veins replaced, thin fingers, nails that are almost purple. Turning them over, you see the faint callouses of a lifelong worker. Raising the strange hands to your face, you feel alien cheekbones and tight, unwrinkled flesh.";
	if Learning Your Projected Nature is happening and a Lacunite is visible begin;
		now a random Lacunite enclosed by the location is attentive;
		say "[paragraph break]Noticing your astonishment, [a random Lacunite enclosed by the location] pauses. [run paragraph on]";
		force discuss t_strangebody;
		now stranger_counter is 3;
	end if.

[	otherwise;
		say "[paragraph break]This alien body is disorienting to be inside of, when you think about it, but you are astonished at how quickly you are beginning to just accept it as another strange adaptation.";]
		
t_strangebody is a beat in HM with reaction "'Do not be alarmed,' [heshe] says[if Lacunite-Follower is unidentified], coming over to you and gently tracing a symbol on your cheek with a bit of paint[end if]. 'Only your mind has travelled here. Your body is still on the world of Lacuna, but the one whose reflection you see has lent you [if player is male]his[otherwise]her[end if] body and senses, for as long as you visit the [t]Heart[x].'". After discussing t_strangebody: now LYPNflag is 1; now Lacunite-Follower is identified. t_strangebody summons hm_where, hm_how, hm_why, hm_name, hm_symbol.

The shallow reflecting pool is a backdrop. It is in Reflecting Pool and Avenue South. Understand "long" as the shallow pool. The description is "The shallow oval pool stretches across this flat spot on the plateau. The water is crystal-clear and the edge is rimmed with flowers. Rippled reflections of the great tree at the end of the avenue and of your own distorted [o]reflection[x] shine up at you." Instead of touching the pool, say "You reach out a hand and the reflection does also. As they meet on the warm surface of the water, ripples distort the strange face into indistinct patterns."

Instead of vague swimming when the reflecting pool is visible, say "This place has a deep presence of order and sacredness: swimming in the calm pool would seem highly inappropriate." Instead of swimming in the pool, try vague swimming.

Washing is an action applying to nothing. Understand "wash" or "clean" or "scrub" as washing. Overly specific washing is an action applying to one topic. Understand "wash face/hand/hands" or "clean face/hand/hands" or "scrub face/hand/hands" as overly specific washing. Check overly specific washing: try washing instead.

Check washing: if location is not Reflecting Pool and location is not Avenue South, say "You do. It feels good to be clean." instead. Check washing: if the player is Lacunite-Follower and Lacunite-Follower is identified and a Lacunite is visible, say "Someone is watching." instead.

Carry out washing: if Lacunite-Follower is identified and the player is Lacunite-Follower begin; now Lacunite-Follower is unidentified; say "Reaching your hands down into the pool, you wash the symbol off your face."; otherwise; say "You wash your face and hands in the cool water."; end if.

Your reflection is a backdrop. Understand "distorted" or "form" or "symbol" as reflection. It is in Reflecting Pool and Avenue South. 

Instead of examining the reflection:
	if Learning Your Projected Nature is happening begin;
		say "As you gaze closer, you gasp. Your reflection is not you. It is one of the creatures; large eyes gape back at you, and yellowish hands reach up to touch your face in sync with yours.";
		now LYPNflag is 1;
		if a Lacunite is visible begin;
			say "[line break]Noticing your astonishment, [a random Lacunite in the location] nearby pauses. [run paragraph on]";
			pre-conversation processing;
			force discuss t_strangebody;
			say "'I can answer your questions, if you like,' [heshe] adds.";
		end if;
	otherwise;
		say "You study the face staring back at you with a strange but slowly weakening feeling of something like vertigo. It is young, as far as you can tell with these people, and seems healthy. The most curious sensation is staring into the eyes: you cannot decide if you are looking at yourself or another, your mind futilely flipping back and forth, like an optical illusion of depth[if Lacunite-Follower is identified]. On your cheek, in white paint, is drawn a simple symbol[end if].";
	end if.


[ Normally, the Lacunites will identify the player as the visitor and mark him with face paint. However, a clever player can observe things unawares if they wash off the face paint and carry around a garden spade. If they stand around for a few moves without doing any work, or ask questions, the Lacunites recognize him for the outsider and take the spade from him. A new spade can be found near where the huts are. Lacunites will instantly recognize the player for who he is if he is not carrying a spade. ]

The stranger_counter is a number that varies. The stranger_counter is 0. After going during Visiting Treeworld: now the stranger_counter is 0; continue the action.

Every turn when Visiting Treeworld is happening and an idle Lacunite-gardener is visible and Lacunite-Follower is unidentified and we are not digging and we are not going (this is the Lacunites will figure out an idle player is the stranger rule):
	increase the stranger_counter by 1;
	if the player is not holding the spade, increase the stranger_counter by 1;
	if stranger_counter is 1 begin; say "[one of][A random Lacunite-gardener in the location] nods to you[or][A random Lacunite-gardener in the location] makes brief eye contact and smiles[or][A random Lacunite-gardener in the location] quietly acknowledges your presence[at random].";
	otherwise if stranger_counter is 2; say "[one of]Glancing in your direction, [a random Lacunite-gardener in the location] turns [hisher] head and looks puzzled.[or][The random Lacunite-gardener in the location] turns an intent gaze on you.[or]You notice [a random Lacunite-gardener in the location] glance over at you curiously.[at random]";
	otherwise if stranger_counter is 3; say "[one of][A random Lacunite-gardener in the location]continues to gaze at you with a puzzled expression[or]You get another odd look from [a random Lacunite-gardener in the location][at random].";
	end if.

Every turn when Visiting Treeworld is happening and a Lacunite-gardener is visible and Lacunite-Follower is unidentified and we are not going and the stranger_counter is at least 2 and a random chance of 2 in 3 succeeds (this is the Lacunite revelation rule):
	let greetee be a random Lacunite-gardener in the location;
	now greetee is attentive;
	force discuss hm_recognize;
	now Lacunite-Follower is identified;
	notice language translation;
	if Lacunite-Follower carries the spade:
		remove the spade from play.


hm_recognize is a repeatable beat in HM with reaction "A smile breaks out on the face of [a random Lacunite-gardener in the location]. Coming towards you, [heshe] [if Lacunite-Follower carries the spade]slips the spade from your fingers and [end if]puts a hand on your shoulder. 'Visitor,' [heshe] says, '[if Lacunite-Follower carries the spade]with your gardening tool I thought you were one of us. W[else]w[end if]elcome. Please, if you have any questions about our world, you only have to ask.'[paragraph break]Dipping a finger in a pot of paint, [heshe] draws a single [hm_symbol] on your cheek. 'There,' [heshe] says, 'now the others will know you and greet you properly.'". hm_recognize summons hm_where, hm_how, hm_why, hm_name.

Understand "symbol/paint" as hm_symbol. hm_symbol is a beat in HM with keyword name "symbol" and reaction "'So we know which one of us you are,' [heshe] says with a smile, 'and can afford you the respect your fantastic visit deserves.'".


Every turn when Visiting Treeworld is happening and a Lacunite-gardener is visible and Lacunite-Follower is identified and we are going (this is the Lacunites recognize an identified player rule):
	say "[The random Lacunite-gardener in the location] [one of]smiles at you, nodding and bowing[or]smiles and moves back, out of your way[or]stops what [heshe] is doing to give you a bow and a beaming smile[at random].".

[Digging is an action applying to nothing. Understand "dig" or "garden" as digging.] Check digging when location is regionally in Treeworld: if player is not carrying spade, say "You don't have anything to dig with.". Carry out digging when location is regionally in Treeworld: say "Kneeling in the dirt, you carefully tend to some flowers here." instead. After digging when a Lacunite-gardener is visible: say "Nodding, [a random Lacunite-gardener in the location] goes back to what [hisher] work."; continue the action. After digging when location is regionally in Treeworld: now stranger_counter is 0; continue the action.

Section - Tour Guides

hm_outtro is a terminal beat in HM with reaction "'There is a great mural near here that tells the history of our civilization,' [heshe] says. 'It is the best place to begin. To find it, [if location is not Reflecting Pool]find your way back to the pool at the base of the stairs and then [end if]follow the path through [d]shadows[x].'". hm_outtro2 replace hm_outtro. After discussing hm_outtro: if tour-progress is 0, now tour-progress is 1; continue the action.

hm_outtro2 is a repeatable terminal beat in HM with reaction "'[if tour-progress is 1 and location is Reflecting Pool]Follow the path through [d]shadows[x] to the start of the mural,' [heshe] reminds you[else]Goodbye, visitor,' [heshe] says[end if].".

tour-progress is a number that varies.

Before going to Mural Far East when tour-progress is 1:
	if the number of Lacunite-gardeners in Mural Far East is 0:
		let soul be a random Lacunite-gardener;
		now the counter of soul is 1;
		move soul to Mural Far East.

Every turn when location is Mural Far East and tour-progress is 1 and a random chance of 1 in 2 succeeds and Nursery is unvisited and a random Lacunite-gardener is enclosed by location:
	say "[The random Lacunite-gardener enclosed by location] smiles at you. 'When you are finished here,' [heshe] says, 'we invite you to see the nursery where young Thinkers grow.' [CHeShe] points through the trees towards the [d]nursery[x], then goes back to gardening.";
	now tour-progress is 2;
	continue the action.

Every turn when location is Nursery and tour-progress is 2 and a random chance of 1 in 2 succeeds and Ancient Temple is unvisited:
	say "One of the gardeners looks up. 'When you are finished here,' he says, pointing, 'you can cross the [d]avenue[x] towards the circle of trees on the opposite side-- what you might think of as a temple.'";
	now tour-progress is 3.

Every turn when location is Ancient Temple and tour-progress is 3 and Shrine is visited and a random chance of 1 in 2 succeeds and Outside the Dome is unvisited and mechanic is enclosed by location: 
	say "The man at the capsule looks up. 'When you're finished here,' he says, nodding into the forest, 'take this path towards the [d]waterfall[x] and the mural, then continue towards a dome through the trees.'";
	now tour-progress is 4.

Every turn when location is Outside the Dome and Map Room is visited and tour-progress is 4 and Great Tree Interior is unvisited:
	say "The red-robed man nods. 'If you are finished here,' he says, '[unless gp_intro is spoken]then the Philosopher is ready to speak with you. Go back to the [d]avenue[x] and then follow it up the hill towards the Philosopher[else]then you may explore the Heart as much more as you like. But when you are ready to return to Lacuna, simply close your eyes[end unless].'";
	now tour-progress is 5.


Section - Avenue South

Avenue South is a room in Plateau with printed name "Far End of the Avenue". The description of Avenue South is "Running straight as an arrow along a gentle slope  to the highest point of the plateau is a wide, well-kept grassy avenue, lined by windsigh trees. At the end of the avenue, stone stairs rise to [the distant Philosopher], its massive, twisted branches reaching high into the sky.[paragraph break][exits].". The exits text is "Running perpendicular to the avenue heading [up] to the huge windsigh are paths of hexagonal brick, leading into the forest towards a [d]dome[x] or some [d]huts[x], or [d]around[x] the reflecting pool". Understand "around" as southwest when location is Avenue South. Understand "dome" as west when location is Avenue South. Understand "huts" as east when location is Avenue South.



Report going from Avenue South to Among the Huts: say "You follow the worn but immaculately tended brick path through a light forest, towards a series of low structures ahead."

Section - Among the Huts

Among the Huts is a room in Plateau. The description of Among the Huts is "Scattered around the trees here are a few dozen simple [o]structures[x], not quite as high as your head and made of brick and thatch. Between the ordered row of huts is a large [o]garden[x].[paragraph break]A neat line of gardening [o]tools[x] is stacked near one of the huts.[paragraph break][exits]." The exits text of Among the Huts is "The path weaves through the cluster of huts, heading towards the open space of the [d]avenue[x] or deeper into the [d]forest[x]". Understand "deeper" or "forest" as east when location is Among the Huts. Understand "avenue" as west when location is Among the Huts.

Report going from Among the Huts to Mural Far East: say "[tomuraldesc].". Report going from Mural Far East to Among the Huts: say "You follow the dirt path through sun-dappled groves of windsigh until you come to a cluster of small huts.". 

Some structures are scenery in Among the Huts. Understand "hut" or "huts" as structures. The description is "Though carefully constructed and maintained, the huts are humble in design." Instead of entering structures, try going inside.

Every turn when location is Among the Huts: if spade is off-stage begin; move spade to Among the Huts; end if.

Some gardening tools are a thing in Among the Huts. The description is "Simple but well-crafted instruments, kept in excellent repair[if spade is in Among the Huts]. Among them you see a simple [o]spade[x][end if].". Understand "tool/line/instruments" as some gardening tools. Instead of taking some gardening tools when spade is on-stage, say "You don't have a need for any of these.". Instead of taking some gardening tools, try taking spade. Report taking spade when location of Lacunite-Follower is Among the Huts: say "You find a neatly polished and sharpened spade from the line, and pick it up." instead.

The vegetable-garden is a setpiece in Among the Huts. The description is "Running in long, well-tended rows, the plants seem to alternate between two crops: leafy green stalks bearing a ridged green [o]melon[x] and clumps of fronds where some root [o]vegetable[x] must grow.". The printed name of vegetable-garden is "garden". Understand "garden" or "vegetable garden" as vegetable-garden.

Some ridged green melons are a prop in Among the Huts. Understand "melon/stalk/stalk" as ridged green melons. The description is "The melons are about the size of your head, and give off a faint smell of spicy sweetness.". Check smelling melons: say "Earthy and strange." instead. Check tasting ridged green melons: say "You crack one open to reveal a firm purple flesh inside. The taste is mild but juicy." instead.

Some root vegetables are a prop in Among the Huts. Understand "veggie/vegetable" as root vegetables. The description is "A few of the vegetables near one end have been dug up, and you see that the plants beneath are brown-orange cylinders with mottled skin.". Check tasting root vegetables: say "You bite an end off one of them, but they are hard to chew and not very flavorful uncooked.".

Report going to Bare Hut: say "You pull aside the straw doorway of a hut that you somehow intuitively feel is yours-- or at least, that belongs to the body you occupy-- and, ducking your head, step inside."

Instead of going to Bare Hut when Lacunite-Follower is identified: say "[one of]You approach a hut at random, but an old red-robed woman steps out from it and smiles, touching your elbow.[paragraph break]'There is nothing in these simple huts to see, visitor,' she says. 'They are merely where the makers of this grove eat and sleep. There are greater things for you here.' You step back as she slips away towards the avenue.[or]You approach one of the huts and pull back the flap, revealing a spartan interior and [randomlacunite] looking up questioningly at you. Embarrassed, you step back.[stopping]". To say randomlacunite: say "[one of]an old man[or]a bedridden younger woman[or]two elderly women[at random]".

A small child is a male Lacunite in Among the Huts. "A small [o]boy[x], maybe two years old, plays on the grass outside one of the huts." The description is "Other than sharing the skin color and general facial features of the adults you've seen, he seems just like the children you're used to." Instead of greeting in the presence of the small child, say "The child stops playing and looks at you curiously as you begin to speak. He  giggles." Understand "boy" or "baby" as the child. Instead of taking the child, say "[takechild].". To say takechild: say "You hoist the boy up in your arms. He is surprisingly light. As you bounce him up and down, he laughs, and reaches out to touch your face. After a while he grows restless, so you lower him back down to the ground". Check hugging the child: say "You reach out and tousle the boy's hair, soft and blonde. He scrunches up his face and puts his hand to his head, grabbing a tuft of hair and twirling it." instead. Instead of attacking the child: increase the rap sheet of Lacunite-Follower by 5. Understand "play with [child]" as a mistake ("[takechild].").

Bare Hut is a room in Treeworld. The description of Bare Hut is "[one of]Your eyes adjust slowly to the dimness in this simple hut. [or][stopping]The interior is clean, ordered, and simple. Two soft [o]beds[x] curve to hug the rounded walls; above each is a woven [o]wreath[x] of vine, and between them is an open area, covered by a large circular rug. On the wall opposite the entryway is a rounded brick [o]cookstove[x] and a hemispherical wooden [o]chest[x].[paragraph break][exits].". The exits text of Bare Hut is "A flap leads back [outside]".

Report going from Bare Hut to Among the Huts: say "You step back outside into the red and gold evening.".

Some soft beds are a setpiece in Bare Hut. Understand "bed" as soft beds. The description is "The beds are shaped like fat crescents, smoothly adjoining the curved walls of the hut. Beneath their woven sheets they are springy but firm, like thick moss.". Instead of entering soft beds, say "There is too much to do for that right now.".

A woven wreath of vine is a prop in Bare Hut. Understand "wreaths" as wreath. The description is "The wreaths are made from a delicate framework of stone, a twelve-sided shape, around which are carefully wrapped tendrils of familiar-looking vine in a complex weave.".

A large circular rug is a setpiece in Bare Hut. The description is "The rug is woven from a silky fiber, and covered in a simple geometric design.".

A rounded brick cookstove is a fixed in place undescribed supporter in Bare Hut. The description is "The stove bulges in the center, where a translucent rounded door opens into some sort of oven, then flattens out on top to a cooking surface. Along a raised portion behind the stove are a row of unlabeled terra-cotta tumblers, presumably the controls.[paragraph break]A [o]pot[x] of some cooling stew rests atop the cookstove.".

A bubbling pot is a prop on rounded brick cookstove. Understand "hoosh/vegetable/vegetables" as pot. The description is "The pot contains a bubbling hoosh that seems to be made from the orange-brown root vegetables; it smells earthy, with faint hints of herbs and spice.". Instead of tasting bubbling pot, say "You pick up a nearby spoon and try a bite. The flavor is quite simple and unremarkable, but filling and satisfying.".

A hemispherical wooden chest is a fixed in place container in Bare Hut. It is closed and openable. The description is "About an arm's length across, the chest rises like a wooden bubble from the floor, delicately polished and finished so the wood shines with a red-gold gleam.". Report opening hemispherical wooden chest: say "You push the top and the hemisphere rotates around to the bottom with a muffled wooden grating, revealing a collection of clay pots, neatly folded red robes, and a small stone [o]urn[x]." instead. Report closing hemispherical wooden chest: say "You lift the lid and the wooden hemisphere rotates smoothly around again, sealing the chest." instead.

A small stone urn is a prop in hemispherical wooden chest. The description is "The stone urn is engraved with the intertwined tree/human figure, and is quite heavy. It is sealed with a cork stopper that looks ancient." Instead of opening small stone urn, say "You pull out the stopper far enough to peek inside. The urn seems to be filled with fine grey ash. Some part of your borrowed mind feels a tug of emotion, and you get vague glimpses of ancient traditions, ashes of ancestors and kin trees mingled together, passed through generations.[paragraph break]You carefully replace the stopper.". Understand "stopper/ash/cork" as small stone urn. Instead of taking small stone urn, say "It belongs here."

["'That is my memorance,' she says. 'In it are ashes of my descendants and their kin trees, stretching back for thousands of years. When I or my kin tree dies, some of our ashes will go into the memorance, to be buried in the roots of my children's kin trees and go into their own memorances, when the time is right.'".]

Some clay pots are a prop in hemispherical wooden chest. The description of some clay pots is "Simple and functional, only lightly adorned with hexagonal patterns.". Understand "pot" as some clay pots.

Some neatly folded red robes are a prop in hemispherical wooden chest. Instead of taking neatly folded red robes, say "You're already wearing one.".




[Garden with just two vegetables. Someone explains these two vegetables contain all that's necessary for suvival.]


Section - The Mural

A muralroom is a kind of room. Mural Far West is a muralroom. Mural West is a muralroom. Mural Center is a muralroom. Mural East is a muralroom. Mural Far East is a muralroom.

Report going from a muralroom (called orig) to a muralroom (called dest):
	if dest is Mural Center:
		say "The meadow widens into a wide circle, where the broad avenue heading up the slope intersects it.";
	else if noun is east:
		say "You follow the slab of rock with the mural, continuing down the immaculate meadow towards the [unless dest is Mural Far East]distant [end if]cliff.";
	else if noun is west:
		say "You follow the slab of rock with the mural, continuing up the immaculate meadow towards the [unless dest is Mural Far West]distant [end if]waterfall.". 

Report going from Mural Far East to Nursery: say "You walk through the trees until you come into another clearing.".

The great slab is an undescribed backdrop. The slab is not scenery. The initial appearance is "[if location is Mural Far East]Running straight to the edge of the cliff is[end if][if location is Mural Far West]Rising from the ground near the edge of the trees is[end if][if location is Mural West or location is Mural East]Bisecting the meadow is[end if][if location is Mural Center]Stretching from either side of the spire is[end if] [slab]". The great slab is in Mural Far West, Mural West, Mural Center, Mural East, and Mural Far East. Understand "mural" or "rock" or "etchings" or "history" as the slab. 

Definition: a thing is unexamined if we have not examined it.

To say slab:
	if Mural Far West is unvisited and Mural West is unvisited and Mural East is unvisited and Mural Far East is unvisited, say "a great [o]slab[x] of rock"; otherwise say "the rock [o]slab[x]";
	if great slab is unexamined, say ", covered with an incredibly detailed series of etchings";
	if we have examined the great slab exactly once, say ", inscribed with the history of this world";
	say ". It continues ";
	if dir, say "[if location is not Mural Far East]east [end if][if location is not Mural Far East and location is not Mural Far West]and [end if][if location is not Mural Far West]west [end if] through";
	otherwise say "down the center of";
	say " the meadow";	

Before examining the great slab for the first time, say "You step closer to the rock slab, which rises a head shorter than you, and are taken aback by the level of detail. Each square foot of this enormous wall must have taken months of work. Even the finest details are etched, with clinical precision and exactitude."

The description of the slab is "[if location is Mural Far West]The first panel depicts a forest of hundreds of windsigh, each twist and curve in every branch and millions of lemon-yellow leaves chiseled faithfully into the rock. As you follow the mural down the meadow, incredibly faint golden lines begin to connect the trees. The lines quickly multiply and become thicker and stronger, and begin to connect to abstract patterns of gold hovering in the sky above the Trees that grow more and more complex.[end if][if location is Mural West]A single tree stands out on this panel, with large-eyed human-like creatures crawling over and around it. On the farthest branch, a single one stands stricken, hand to her head and eyes open wide with awe, one tiny golden strand reaching out to touch her head.[end if][if location is Mural Center]The slab rises into a great rounded outcrop here, which shows, in giant size and incredible detail, the picture you saw on the egg on Lacuna: a human form, hands outstretched and head a smooth oval, intertwined with the roots of a stretching Tree.[end if][if location is Mural East]An incredibly detailed scene is carved into the rock here. Hundreds of people, each linked to one or more trees by a tiny golden strand, labor to tend trees, carry seeds off to distant lands, and build tools, from baskets to sailing ships to microscopes and stranger vehicles. The people are linked only to the trees; never to each other.[paragraph break]The panel ends showing an elaborate mining operation, with a single man pulling a hexagonal crystal from the ground with a look of reverent awe. All the golden threads near the crystal run through it, and are strengthened tremendously as they pass through it.[end if][if location is Mural Far East]This part of the epic etching shows the whole planet, covered in trees, with the arm of a minutely detailed galaxy behind it. Tiny egg ships depart in all directions, each one carrying a human crew, tree seedlings, and a tiny fragment of the hexagonal crystal. Hundreds of stars in the galaxy glow green, and an impossibly tiny web of golden lines connects them.[end if]".

After examining the great slab, say "[if location is Mural Far East]The mural ends here[otherwise]The mural continues [end if][if location is not Mural Far East]towards the [d]cliff[x][end if][if the player has not been in Mural Far West]. It must begin [end if][if the player has not been in Mural Far West]farther towards the [d]waterfall[x][end if]."

The description of Mural Far West is "A bubbling waterfall cascades down a rocky slope here at the edge of [meadow].[paragraph break][initial appearance of great slab].[paragraph break][exits]." The exits text of Mural Far West is "The meadow heads towards a distant [d]cliff[x], while angled paths lead through the trees towards [if Map Room is unvisited]a [d]dome[x][otherwise]the [d]dome[x][end if], [etmfw2]". To say etmfw2: say "[if Shrine is unvisited]a [d]circle[x] of trees[otherwise]the [d]temple[x][end if], or back into the [d]forest[x]". Understand "forest" as south when location is Mural Far West. Understand "dome" as southeast when location is Mural Far West. Understand "cliff" as east when location is Mural Far West. Understand "circle" or "temple" as northeast when location is Mural Far West.

A bubbling waterfall is a setpiece in Mural Far West. The description is "The waterfall trickles down a rocky slope and pools in a small stream, which meanders off and vanishes into the forest of windsigh.". Understand "small/stream/rocky/slope" as bubbling waterfall. Instead of tasting or taking bubbling waterfall, say "The water is just slightly colder than the air and has a pleasant, loamy aftertaste.".

Report going from Mural Far West to Outside the Dome: say "You approach the dome structure.".

The description of Mural West is "[initial appearance of great slab]. Tiny white flowers dot the grass here, gathering in bunches at the base of the slab.[paragraph break][exits].". The exits text of Mural West is "Cutting through the trees, [meadow] continues towards the distant [d]cliff[x] or the [d]waterfall[x], lined by thick windsigh forest on either side". Understand "waterfall" as west when location is Mural West. Understand "cliff" as east when location is Mural West. 

The description of Mural Center is "The rock slab crosses the broad avenue sloping up to the high point of the ridge, surrounded by a wide circular lawn. Twin foot [o]bridges[x] cross the mural to either side of a central [o]spire[x] that rises from the slab, rich with inscribed imagery.[paragraph break][exits].". The exits text of Mural Center is "The wide avenue runs [up] towards [the Distant Philosopher] and [down] towards the reflecting pool, while the narrower meadow with the slab runs perpendicular towards a [d]cliff[x] or a [d]waterfall[x]". Understand "waterfall" as west when location is Mural Center. Understand "cliff" as east when location is Mural Center. 

The twin foot bridges are a setpiece in Mural Center. The description is "The bridges are carved from stone, delicate etchings of stylized vine twining around their graceful grey supports. They rise up and above the natural stone slab on either side of the central spire, leaving the mural itself untouched.". Understand "bridge" as twin foot bridges. Instead of entering or crossing twin foot bridges: say "You walk across the nearer bridge, moving from one side of the rock mural to the other, where you see an identical scene has been etched.".

The stone spire is a setpiece in Mural Center. Instead of examining the stone spire, try examining the slab.

Report going from Mural Center to Avenue North: say "You cross one of the graceful stone bridges and continue up the grassy avenue, approaching the base of [the Distant Philosopher].".

The description of Mural East is "[initial appearance of great slab].[paragraph break][exits].". The exits text of Mural East is "Cutting through the trees, [meadow] continues towards the nearby [d]cliff[x] and the distant [d]waterfall[x]". Understand "waterfall" as west when location is Mural East. Understand "edge" or "cliff" as east when location is Mural East.

The description of Mural Far East is "A sudden drop-off marks the end of [meadow]. The distant forest below glows in the red light of the giant sun.[paragraph break][initial appearance of great slab].[paragraph break][exits]." The exits text of Mural Far East is "Paths curve into the [d]forest[x] and towards some [d]huts[x] or a [d]nursery[x] closer at hand. The meadow runs towards the distant [d]waterfall[x]". Understand "waterfall" as west when location is Mural Far East. Understand "nursery" as northwest when location is Mural Far East. Understand "forest" as south when location is Mural Far East. Understand "huts" as southwest when location is Mural Far East.

The tree-cliff is a setpiece in Mural Far East with printed name "cliff". Understand "cliff/cliffs" as tree-cliff. The description is "The cliff drops off to a vast expanse of windsigh filling a gently sloping river basin, stretching off to the huge red sun floating above the horizon.". Instead of climbing or entering tree-cliff: say "The drop is tremendous-- even the thought of climbing it makes you queasy.".

To say meadow:
	if Mural Far West is unvisited and Mural West is unvisited and Mural Center is unvisited and Mural East is unvisited and Mural Far East is unvisited, say "a long, meandering grassy meadow";
	otherwise say "the meadow".




Section - The Map Room

Outside the Dome is a room in Plateau. The description of Outside the Dome is "A large stone domed structure rises from the forest here, made of a smooth yellow-grey rock that glows pink in the light of the great red sun.[paragraph break]A tall man in red robes stands stoically near the entrance to the dome.[paragraph break][exits].". The exits text of Outside the Dome is "An open archway leads [d]inside[x] the dome, while brick pathways run towards an open [d]avenue[x] or through the [d]forest[x]". Understand "forest" as west when location is Outside the Dome. Understand "avenue" as east when location is Outside the Dome.

The dome-proper is a setpiece in Outside the Dome with printed name "dome". The description is "The large, low dome is completely featureless on the outside.". Check climbing dome-proper: say "You probably could, except there doesn't seem to be anything on top, and you're a bit nervous to do so in front of the robed figure standing ceremoniously at its entrance." instead. Understand "dome/structure/map/room" as dome-proper. Instead of entering dome-proper, try going inside.

Report going from Outside the Dome to Map Room: say "You step through the stone archway, almost bumping your head, and blink in the dim interior.". Report going from Outside the Dome to Mural Far West: say "[tomuraldesc].". Report going from Map Room to Outside the Dome: say "You emerge blinking into the red evening light.". Report going from Avenue South to Outside the Dome: say "You pass down the dirt path through the windsigh till you emerge at a stone dome.".

Report going from Outside the Dome to Avenue South: say "[brickpathdesc]". Report going from Among the Huts to Avenue South: say "[brickpathdesc]". Report going from Ancient Temple to Avenue North: say "[brickpathdesc]". Report going from Nursery to Avenue North: say "[brickpathdesc]".

Mapkeeper is a male Lacunite in Outside the Dome. The printed name is "the mapkeeper". Understand "man" as mapkeeper. 

Instead of greeting Mapkeeper when Lacunite-Follower is unidentified: say "'I have no time to talk, Planter,' the man says.".

Instead of going from Outside the Dome to Map Room when Lacunite-Follower is unidentified, say "The man outside holds out a hand to stop you. 'No, Planter,' he says, 'we are keeping the map room free for the Visitor. You will have to come another day.'".

Instead of greeting Mapkeeper: say "The man nods slowly to you. 'This is the Map Room of our Grove,' he says. 'If you like, you may enter to learn more of Forest and its place in our galaxy.'".


Map Room is a room. The description of Map Room is "[if Map Room is unvisited]This large, round room seems dark and empty at first. But as your eyes begin to adjust, you gasp. Suspended in the darkness are millions of tiny points of light, sparkling quietly. As your eyes adjust further, you begin to make out the overall shape: that of an entire [o]galaxy[x].[paragraph break]The man in the robe ducks in from outside. He moves his hand down and suddenly the view dives forward, zooming in a giddying rush towards a single light, which suddenly expands to become a red-gold planet, floating serenely in the center of the room.[paragraph break]'This is the world of Heart,' he says. 'Feel free to use the map room however you like. This figure on the wall will show you how.' He nods, and ducks back outside.[otherwise][dimgalaxydesc][end if][paragraph break]Inlaid into one wall is a stylized [o]figure[x] of a man.[paragraph break][exits].". The exits text of Map Room is "A few soft, shallow steps curve around the room's circumference, making the central space under the dome seem even larger, and bright daylight shines through heavy curtains leading [d]out[x]".

[In here is an interactive map of the galaxy which can be moved along three axes: zooming in and out on various targets, moving forwards and backwards in time, and switching between several overlay modes of additional information. (We are nothing if not ambitious.) By playing with this, the player should be able to learn a great deal about the galactic Forest, and in a "do, don't tell" format much more interesting than yet another expository conversation. The player controls these modes by moving their hand along one of three axes in 3D space, and touching objects of interest.  ]

The dim galaxy is a setpiece in Map Room. The description is "[one of]As you walk around the edge of the room, you take in the galaxy of stars from several angles. [or][stopping][dimgalaxydesc].".



gal-zoom is a number that varies. gal-zoom is 3. To decide whether galaxy-zoomed: if gal-zoom is 1, yes; no. To decide whether arm-zoomed: if gal-zoom is 2, yes; no. To decide whether planet-zoomed: if gal-zoom is 3, yes; no. To decide whether continent-zoomed: if gal-zoom is 4, yes; no.

gal-time is a number that varies. gal-time is 4. To decide whether prehistory-timed: if gal-time is 1, yes; no. To decide whether industrial-timed: if gal-time is 2, yes; no. To decide whether colonizing-timed: if gal-time is 3, yes; no. To decide whether present-timed: if gal-time is 4, yes; no.

gal-filter is a number that varies. gal-filter is 1. To decide whether real-filtered: if gal-filter is 1, yes; no. To decide whether life-filtered: if gal-filter is 2, yes; no. To decide whether mission-filtered: if gal-filter is 3, yes; no.

The dim galaxy has a thing called selection. The selection of dim galaxy is map-heart. Galseed is a number that varies. Galseed is 2345.

To say dimgalaxydesc:
	if galaxy-zoomed:
		say "Only near the edges of the room can you make out individual stars, impossibly tiny points of light caught in enormous three dimensional whirls and eddies. Towards the center, they merge into one glowing sphere of light, which seems enormous though you know it must be trillions of times smaller than life.[paragraph break]Near one side of the room, ";
		if selection of dim galaxy is map-otherarm or selection of dim galaxy is map-otherstar, say "a random [o]arm[x] glows with a translucent haze; from a small [o]eddy[x] elsewhere, however,";
		else say "one [o]eddy[x] glows[if life-filtered and present-timed] intensely green, and is surrounded[else if life-filtered and colonizing-timed] intensely green, and is surrounded[else if life-filtered and industrial-timed] faintly green at its center, and is surrounded[end if] with a translucent haze[if mission-filtered and present-timed] and is overrun by a dense cluster of white circles and arrows, packed so closely together they are hopelessly jumbled, though[else if mission-filtered and colonizing-timed]by an ant's nest of moving arrows and dotted lines, packed so closely together they are hopelessly jumbled, though[else], different than the galaxy's thousands of other wispy [o]arms[x], and[end if]";
		say " a tiny golden spark peeks out from somewhere inside";
	else if arm-zoomed:
		if selection of dim galaxy is map-otherarm or selection of dim galaxy is map-otherstar:
			say "A [one of]rambling[or]twisted[or]crooked[or]rippling[or]languid[or]sparsely populated[or]dense[in random order] arm of the galaxy fills the room, large enough to discern individual stars in [one of]loose patches[or]tight clumps and clusters[or]swirls like spilled milk[or]eddies like a frozen explosion[in random order]. Thousands of random [o]stars[x] twinkle[if selection of dim galaxy is map-otherstars], one glowing with a translucent haze[end if]";
		else:
			say "A rambling arm of the galaxy fills the room, faint milky clouds resolving into barely-visible stars when you peer closely enough. ";
			if life-filtered and ( present-timed or colonizing-timed ) :
				say "Near one side of the arm is a patch of glowing green star [o]systems[x][if selection of dim galaxy is map-colonizedworlds] (surrounded by a translucent haze)[end if][if colonizing-timed], slowly lighting up one by one and[end if] roughly centered around one gleaming gold [o]point[x][if selection of dim galaxy is map-heart], surrounded by a translucent haze[end if][if selection of dim galaxy is map-mysteryworlds]; a [o]scattering[x] of other stars nearby glow with a translucent haze[end if]. There are close to a thousand of them";
			else if mission-filtered and ( present-timed or colonizing-timed ) :
				say "Near one side of the arm, [if colonizing-timed]dotted lines are snaking out from one central point to hundreds[else]thousands[end if] of star [o]systems[x][if selection of dim galaxy is map-colonizedworlds] (surrounded by translucent haze)[end if]";
				say "[if colonizing-timed], each of which is enclosed by a bright white circle as soon as the line touches it. A very few however, one in a hundred or less, get[else] are overlaid by white circles. Mixed among them are a handful of[end if] [o]blinking[x] broken circles instead[if selection of dim galaxy is map-mysteryworlds] (surrounded by translucent haze)[end if]. At the center of the cluster is one gleaming gold [o]point[x][if selection of dim galaxy is map-heart], surrounded by a translucent haze[end if]";
			else:
				say "One [o]particular[x] star pulses gold[if selection of dim galaxy is map-heart or selection of dim galaxy is map-heartnorth or selection of dim galaxy is map-heartmain or selection of dim galaxy is map-heartarchipelago] and glows with a translucent haze[else if selection of dim galaxy is map-colonizedworlds]; a dense cluster of star [o]systems[x] surrounding it glow with a translucent haze[else if selection of dim galaxy is map-mysteryworlds]; a [o]scattering[x] of other stars nearby glow with a translucent haze[end if]";
	else if planet-zoomed:
		if selection of dim galaxy is map-otherstar:
			say "A [if galseed > 5000]dim red star burns faintly[else if galseed > 3000]pale orange sun burns[else if galseed > 1500]bright yellow sun blazes[else]blue-white star burns fiercely[end if] in the center of the room[if galseed / 73 > 80], its tumbling rocky planets lifeless[else if galseed / 73 > 40], orbited by swirling and empty gas giants[else], circled by a motley collection of planets of all sizes[end if]";
		else if selection of dim galaxy is map-colonizedworlds:
			say "A [if galseed is even]large[else]small[end if] [if galseed > 8800]blue-green[else if galseed > 7600]blue-yellow[else if galseed > 6400]cloudy green[else if galseed > 5200]pinkish-green[else if galseed > 4000]pinkish-blue[else if galseed > 2800]deep green[else]yellow-green[end if] planet orbits a [if do galseed mod 5 is 0]orange-yellow[else if do galseed mod 3 is 0]yellow[else]golden[end if] sun, ";
			if mission-filtered and ( present-timed or colonizing-timed ) , say "a white circle hovering above it, ";
			let tmpseed be ( do galseed mod 1000 ) / 100;
			now tmpseed is tmpseed * ( do galseed mod 100 ) / 10;
			now tmpseed is tmpseed * ( do galseed mod 10 ) ;
			say "[if do tmpseed mod 9 is 0]thousands of islands dotting it in arcs and clusters[else if do tmpseed mod 7 is 0]dominated by one massive continent[else if do tmpseed mod 6 is 0]mostly vast ocean with a few twisted continents[else if do tmpseed mod 5 is 0]massive ridged continents dominating small arcing oceans[else if do tmpseed mod 4 is 0]a vast polar continent stretching mountainous tendrils down past the equator[else]several large continents strewn against a sparkling ocean[end if]";
			now tmpseed is tmpseed * tmpseed * tmpseed * 71;
			if mission-filtered and ( present-timed or colonizing-timed ) :
				say ". [if colonizing-timed]A white arrow flies smoothly in from somewhere in deep space and touches a point on the planet's surface; as it does so, a white circle lights up, floating above the planet[else]A white circle pulses smoothly above the planet's surface[end if]";
			if life-filtered and ( present-timed or colonizing-timed ) :
				say ". A glowing overlay of pale green ";
				if present-timed, say "[if do tmpseed mod 3 is 0]covers nearly the entire land surface[else if tmpseed is even]stretches across most of the land surface[else]fills more than half of the available land surface[end if]";
				else say "[if do tmpseed mod 3 is 0]slowly grows on all the major landmasses[else if tmpseed is even]fills most of one landmass, with a few growing patches touching others[else]seeps slowly outward from a central point on the largest landmass[end if]";
		else if selection of dim galaxy is map-mysteryworlds:
			say "A [if galseed > 7500]large[else if galseed > 5000]small[else]average-looking[end if] planet floats in the center of the room, ";
			if mission-filtered and ( present-timed or colonizing-timed ) , say "[if colonizing-timed]a blinking white arrow marching toward the planet from somewhere in deep space, and [end if]a blinking broken circle hovering above it, ";
			say "orbiting a [if do galseed mod 3 is 0]golden[else if galseed is even]yellow[else]orange-yellow[end if] sun. The features of its continents are blurred and out-of-focus";
		else:
			say "A beautiful cyan-gold planet floats in the center of the room. Great continents[if life-filtered], covered by a pale green overlay,[end if][if prehistory-timed], drifted ever-so-slightly from their current positions,[end if] shimmer in the gold of billions of windsigh[if present-timed], covering even the highest mountains and desolate deserts[else if colonizing-timed], pushing even up the slopes of the highest mountains and into the most barren of deserts[else if industrial-timed], which fill every corner of land except for white patches where mountains rise and brown ones where desolate lands rule[else], growing in spread-out forests on the most temperate parts of the world[end if]. A light-blue ocean churns below clouds burning pinkly in the light of the sun";
			if colonizing-timed and mission-filtered, say ".[paragraph break]White arrows rise constantly from the planet's surface near the central continent and disappear into space at the edges of the room";
			say ".[paragraph break]The landmasses seem to be divided into one large [o]central[x] continent[if selection of dim galaxy is map-heartmain] (glowing with a translucent haze)[end if] where a pulsing golden dot shines, a [o]northern[x] landmass covering the pole[if selection of dim galaxy is map-heartnorth] (glowing with a translucent haze)[end if], and a long island [o]chain[x] in the southern hemisphere[if selection of dim galaxy is map-heartarchipelago] (glowing with a translucent haze)[end if]";
	else if continent-zoomed:
		if selection of dim galaxy is map-heartnorth:
			say "The north pole of Heart fills the room in a breathtaking expanse. ";
			say "The northernmost parts of the globe are barren white plains and white-capped mountain ranges";
			if colonizing-timed or present-timed:
				say " dotted by hundreds of black divots";
				if mission-filtered, say " each of which is overlaid with a stylized crystal icon[if colonizing-timed]. Dotted white lines connect the divots to a thicker white line crossing to the central continent, the dots marching endlessly southward[end if]";
			if colonizing-timed or present-timed, say ".[paragraph break]A ring of gold[if life-filtered] covered in a green overlay[end if] [if present-timed]fringes the edges of the continent all the way around the planet, pushing desperately into the snow, the gold turning a pale and sickly color near the northernmost edges[else]just touches the edges of the continent, outposts of windsigh on the edge of the arctic[end if]";
		else if selection of dim galaxy is map-heartarchipelago:
			say "The island chain stretches in a long arc nearly halfway around the globe on its southern half, the islands ranging in size from tiny specks up to respectable miniature continents[if present-timed]. All[else if colonizing-timed]. Nearly all[else if industrial-timed]. A few[end if][if not prehistory-timed] of them are covered in golden hues[end if][if life-filtered] and glow green on the overlay[end if]";
			if mission-filtered and ( colonizing-timed or present-timed ) :
				say ". Dozens of random islands are marked with an egg icon on the overlay[if colonizing-timed]; moving dotted lines connect these to the central continent[else], but the icons are greyed out and inactive[end if]";
		else if selection of dim galaxy is map-heartmain:
			say "The massive central continent of Heart stretches most of the way around the planet. You walk around the room examining it; tracing the paths of huge river drainages, watching rippled mountain ranges run and merge and disappear, following great riparian flatlands to the edge of the sea. Near the northern tip of one mountain range, near the terminator between night and day, a golden dot pulses at a point overlooking a wide river valley";
			if industrial-timed or colonizing-timed or present-timed:
				say ".[paragraph break]On the night side, clusters of bright lights glow at sparse intervals";
			if colonizing-timed and mission-filtered:
				say ".[paragraph break]On the overlay, dotted white lines crawl down from the north and south to rocket icons near the equator, where white arrows rise into space and depart in great arcs in all directions";
			if life-filtered:
				say ".[paragraph break]The windsigh-covered landmasses pulse green on the overlay".

[To decide whether prehistory-timed: if gal-time is 1, yes; no. To decide whether industrial-timed: if gal-time is 2, yes; no. To decide whether colonizing-timed: if gal-time is 3, yes; no. To decide whether present-timed: if gal-time is 4, yes; no.]

To decide what number is do (dividend - a number) mod (divisor - a number):
	decide on remainder after dividing dividend by divisor.

The stylized figure of a man is a prop in Map Room. The description is "The drawing shows a figure reaching out to touch a floating cube, which glows with a translucent haze. Surrounding his hand is a sphere with arrows in all three axes: [o]up[x] or [o]down[x], [o]forward[x] or [o]back[x], and [o]left[x] or [o]right[x]." Understand "floating/cube" as stylized figure of a man. Check touching stylized figure: say "You run your fingers over the elegant drawing inlaid into the wall." instead.

The overlay is a minor setpiece in Map Room. Understand "green/haze/glow" as overlay. The description is "[if real-filtered]The overlay seems to be no longer visible.[else if life-filtered]The overlay surrounds you with a faint green haze. Perhaps it responds to biological life?[else]The overlay seems to be represented by an animated icon in the corner of the room, showing a series of tiny white egg-shapes radiating from a central sphere in all directions.[end if]". The provoke message is "It seems you can only look at it.".

A hologram is a kind of prop. Instead of touching a hologram:
	say "You reach out a finger and touch [noun]; it [if selection of dim galaxy is noun and selection of dim galaxy is not map-otherstar and selection of dim galaxy is not map-mysteryworlds and selection of dim galaxy is not map-colonizedworlds and selection of dim galaxy is not map-otherarm]stays selected[else]begins to glow with a faint translucent haze[end if]."; now selection of dim galaxy is noun. Instead of examining a hologram, try touching noun.

map-heart is a hologram in Map Room with printed name "the planet Heart". Understand "heart/point/particular" as map-heart.
map-heartnorth is a hologram in Map Room with printed name "the northern continent". Understand "northern/continent" as map-heartnorth.
map-heartmain is a hologram in Map Room with printed name "the central continent". Understand "central/continent" as map-heartmain.
map-heartarchipelago is a hologram in Map Room with printed name "the island chain". Understand "chain/island" as map-heartarchipelago.
map-heartarm is a hologram in Map Room with printed name "the eddy". Understand "eddy" as map-heartarm.
map-otherarm is a hologram in Map Room with printed name "another part of the galaxy". Understand "arms" as map-otherarm.
map-otherstar is a hologram in Map Room with printed name "a random star". Understand "star/stars" as map-otherstar.
map-colonizedworlds is a hologram in Map Room with printed name "a random star system". Understand "systems/system" as map-colonizedworlds.
map-mysteryworlds is a hologram in Map Room with printed name "a random blinking star system". Understand "blinking/scattering" as map-mysteryworlds.


Instead of going up in Map Room, try hologramming. Instead of going down in Map Room, try hologramming. Understand "hleft" as hologramming when location is Map Room. Understand "hright" as hologramming when location is Map Room. Understand "back" as hologramming when location is Map Room. Understand "forward" as hologramming when location is Map Room. Hologramming is an action applying to nothing.

To say zoomclue: say "". [say "[one of]. This seems clear: it indicates a scale change of a power of ten; one order of magnitude[or][stopping]".] To say epochclue: say "[one of]-- indicating the passage of years in powers of ten, perhaps[or][stopping]". [say "[one of]. If one orbit indicates a year, you muse, each acceleration and fade must indicate an increase in elapsed time of a power of ten[or][stopping]".] To say touchclue: say "[if planet-zoomed and selection of dim galaxy is map-otherstar][else]. Briefly, all the visible objects flash with translucent haze, one by one[end if]".

Carry out hologramming:
	let movement be indexed text;
	let movement be the player's command;
	if movement exactly matches the text "up" or movement exactly matches the text "u": [zoom out]
		say "You lift your hand up";
		if galaxy-zoomed, say "[galaxyborders]." instead;
		say "[one of] and the image begins to zoom out. An icon of a windsigh tree appears above you and rapidly shrinks, until when it is about a tenth the size another one fades in above it and also begins to shrink[zoomclue][or][stopping]";
		decrease gal-zoom by 1;
		now galseed is a random number from 1 to 9999;
		if galaxy-zoomed, say ". The tree icon shrinks outwards and reappears twice as the arm collapses with a breathtaking suddenness, until it fills only a matchbox-sized space, one eddy in the whole enormous galaxy which once again is spread out before you";
		if arm-zoomed, say ". The star system shrinks into a single faint point of light as the tree icon rapidly shrinks through almost a dozen iterations, until at last other stars fly in as if passing through the outer walls of the room, until you look at a milky galactic arm of a few thousand stars";
		if planet-zoomed, say ". The tree icon shrinks once as the view pulls back until you can see the whole planet floating serenely in space";
	else if movement exactly matches the text "down" or movement exactly matches the text "d": [zoom in]
		say "You lower your hand";
		if selection of dim galaxy is nothing, say "[galaxyborders]." instead;
		if continent-zoomed, say " and zoom farther in on the planet[if selection of dim galaxy is map-heartnorth or selection of dim galaxy is map-heartmain or selection of dim galaxy is map-heartarchipelago], whiling away long minutes exploring-- you can zoom far enough in to barely make out individual trees. Finally, you pull back out to the level of the whole continent[else], but the resolution becomes blurry much farther in, so after a while you pull back to the continent level[end if]." instead;
		if planet-zoomed and ( selection of dim galaxy is map-colonizedworlds ) , say " and explore the planet's surface in detail, drinking in the shorelines of distant continents and alien oceans, before finally returning to the planetary level." instead;
		if planet-zoomed and selection of dim galaxy is map-mysteryworlds, say " and try to zoom farther in, but there does not seem to be enough resolution; the planet is only discolored smudges if you try to move closer." instead;
		if planet-zoomed and selection of dim galaxy is map-otherstar, say " and zoom in on one [one of]dim[or]grey[or]brown[or]rocky[or]cold[or]silent[at random] [one of]world[or]planet[at random], but the resolution is low, and you see little of interest." instead;
		if planet-zoomed and selection of dim galaxy is map-heart, say " but nothing happens[touchclue]." instead; 
		if arm-zoomed and ( selection of dim galaxy is map-heartarm or selection of dim galaxy is map-otherarm ) , say "[galaxyborders][touchclue]." instead;
		say "[one of] and the image begins to zoom in. An icon of a windsigh tree appears above you and rapidly expands, until when it is about ten times larger it fades away and another small icon appears in its place[zoomclue][or][stopping]";
		increase gal-zoom by 1;
		now galseed is a random number from 1 to 9999;
		if continent-zoomed, say ". The tree icon expands once as the view dives down towards [the selection of dim galaxy]";
		if planet-zoomed, say ". The stars explode outward as the tree icon rapidly expands through a dozen orders of magnitude towards one point of light in the room's center[if selection of dim galaxy is not map-otherstar], which at the last minute gives birth to a planet which rapidly expands[end if]";
		if arm-zoomed, say ". The tree icon expands through two orders of magnitude as the view dives towards one small part of the milky galaxy until it fills the room";
	else if movement matches the text "forward": [future]
		say "You move your hand forward";
		if present-timed, say "[galaxyborders]." instead;
		say "[one of] and all motion speeds up. An icon of a star and orbiting planet appears and twirls through ten accelerating revolutions; then fades and is replaced by another at the original speed[epochclue][or][stopping]";
		increase gal-time by 1;
		if industrial-timed, say ". The stylized orbit icon accelerates forward through  three orders of magnitude before slowing to a near-stop";
		if colonizing-timed, say ". The stylized orbit icon accelerates forward through two orders of magnitude before slowing again";
		if present-timed, say ". The stylized orbit icon accelerates forward through two and a half orders of magnitude before slowing again; as it comes to a stop, it begins to pulse with a golden sheen";
	else if movement matches the text "back": [past]
		say "You move your hand back towards your body";
		if prehistory-timed, say "[galaxyborders]." instead;
		say "[one of] and all motion suddenly reverses and accelerates backwards. An icon of a star and orbiting planet appears and twirls through ten backwards, accelerating revolutions; then fades and is replaced by another at the original speed[epochclue][or][stopping]";
		decrease gal-time by 1;
		if prehistory-timed, say ". The stylized orbit icon accelerates backwards through three orders of magnitude before slowing and then revolving forward again";
		if industrial-timed, say ". The stylized orbit icon accelerates backwards through two orders of magnitude before slowing and then revolving forward again";
		if colonizing-timed, say ". The stylized orbit icon changes from gold to grey then accelerates backwards through two and a half orders of magnitude before slowing and then revolving forward again";
	else if movement matches the text "left": [cycle through views]
		decrease gal-filter by 1;
		if gal-filter < 1, now gal-filter is 3;
		say "You swipe your hand to the left and [if real-filtered]the overlay disappears from the view[else]an overlay shimmers in over the view[end if][if life-filtered], surrounding you with a faintly growing green haze[end if]";
	else if movement matches the text "right":
		increase gal-filter by 1;
		if gal-filter > 3, now gal-filter is 1;
		say "You swipe your hand to the right and [if real-filtered]the overlay disappears from the view[else]an overlay drops down over the view[end if]";
	else:
		say "You move your hand[galaxyborders]. You must have done something wrong." instead;
	say ".";
	try examining dim galaxy.

To say galaxyborders: say ", but nothing happens other than the whole image flickering for a moment".
		

Instead of touching or taking the dim galaxy, say "You move your hand through the stars before you but feel nothing. The tiny points simply disappear as your hand passes through the space they once occupied."



Section - Temple

The description of Ancient Temple is "You stand outside an archway leading inside a circle of alternating windsigh and smooth stone pillars, creating a circular amphitheater with an air of such reverence and tradition about it that the word 'temple' immediately springs to mind. The symbol from the egg on Lacuna, of a human form intertwined with the roots of a tree, is inlaid into the arch leading inside[if Shrine is visited and Great Tree Interior is unvisited].[paragraph break]Nearby, a cylindrical [o]capsule[x] of smooth plastic has risen from the ground[end if][if Shrine is visited and mechanic is enclosed by location]; a middle-aged [o]man[x] is fiddling with something inside it through a clear hatchway[end if].[paragraph break][exits]." The exits text of Ancient Temple is "The archway leads [inside] the temple, and paths lead through the trees towards the sounds of a [d]waterfall[x] or an open [d]avenue[x]". Understand "waterfall" as west when location is Ancient Temple. Understand "avenue" as east when location is Ancient Temple. The printed name of Ancient Temple is "Outside the Temple".

Report going from Ancient Temple to Mural Far West: say "[tomuraldesc].". Report going from Mural Far East to Reflecting Pool: say "You walk through a long path through windsigh before arriving back at the lower end of the avenue.".[aar]

Instead of going from Ancient Temple to Shrine when Lacunite-Follower is unidentified: say "You step towards the archway to enter it, but a red-robed woman blocks your way gently but firmly. 'Planter, you know it is not your place to speak with the trees,' she says. 'Keeping the Grove of the Philosopher tended is honor enough.' She slips back inside.".

The plastic capsule is a setpiece in Ancient Temple. The description is "Perhaps it is glass, not plastic, but at any rate transparent; inside ordered rows of wire wrap around strange dim shapes. It's about as long as you are tall, and a third as wide, and stands on a smooth platform which looks designed to lower into the ground.". Instead of touching or pushing plastic capsule, say "The surface feels smooth and gives a little, as if the inside is filled with gel or water.". Instead of opening plastic capsule, say "You don't have the tools necessary to open it." Instead of taking plastic capsule, say "It's larger than you are, and  filled with machinery.".

Before going to Ancient Temple when Great Tree Interior is visited: remove mechanic from play; remove plastic capsule from play; continue the action.

The mechanic is an undescribed male Lacunite in Ancient Temple. The description is "The man seems cheerful as he tinkers with something within the capsule.". Understand "man" as mechanic. The unavailable-beat of mechanic is physC_unav. 

physC is a thread. After greeting the mechanic: if Lacunite-Follower is unidentified, force discuss physC_pintro; else force discuss physC_intro.

physC_unav is a repeatable beat in physC with reaction "'I'm sorry,' he says, 'I really must get back to this work.'".

physC_pintro is a terminal repeatable beat in physC with reaction "He nods without looking at you. 'Goldthought, Planter,' he says, and continues with his work.".

physC_intro is a beat in physC with reaction "He nods to you. 'Hello,' he says. 'Sorry to intrude on your visit. I'm just working to fix this [physc_reactor]. Don't mind me.'". physC_repeat replaces physC_intro.

physC_repeat is a repeatable terminal beat in physC with reaction "'Please pardon me,' he says, 'but I have much to do, and it really is of little interest.'".

Understand "reactor" as physc_reactor when last beat is in physc. physc_reactor is a beat in physc with keyword name "reactor" and reaction "'This is half of this grove's power source,' he says. 'Its twin is underground on the other side of the avenue. They provide energy to heat water, run the seivers, and keep Thinkers and Makers warm in winter months-- normally this part of the Heart would be too cold for us then. It's a new, smaller [physc_idea] of mine from years ago; I've had some new ideas and I'm making some updates to make them more reliable.'".

Understand "design" as physc_idea when last beat is in physc. physc_idea is a beat in physc with keyword name "design" and reaction "'I think I see,' he says. 'You're asking if it was really my idea. But the question is meaningless to me. It would be like asking you which part of your brain an idea came from. All my thoughts, my ideas flow through my kin tree and the Thinkers around me. As I walk through the grove each one shares its thoughts with me, always. Yet it feels like my idea,' he smiles, 'as much as theirs.'"

[Outside is essentially a small nuclear reactor, which feeds an underground network of tubes which keep these trees warm in the winter-- this area of the planet would normally be too cold for them half the year. A scientist is working on it and cheerfully chats. Says that the question of whether ideas come from him or the trees is impossible to answer-- "how many of your ideas come from your cerebellum and how many from your cortex?" ]

Report going from Ancient Temple to Shrine: say "You step beneath the archway into the quiet interior of the circle.". Report going from Shrine to Ancient Temple: say "You step back outside into the fiery warmth of the huge setting sun.". 

The printed name of Shrine is "Temple". The description of Shrine is "Sixteen windsigh make up the edges of this large sacred circle; mossy stones fill the shadowed space beneath the evening sky above. In front of each windsigh is a circle of soft [o]padding[x], and kneeling at some, facing the center, are red-robed [o]people[x], eyes open but pupils contracted[one of]. The position is eerily familiar: that repeated pattern of man and tree joined together come to life[or][stopping].[paragraph break]At the center of the circle is a device which you recognize at once as kin to the seiver on Lacuna-- but designed and built by a civilization with high technology and craftsmanship, not cobbled together by a single man without proper tools. A beautiful crystal [o]egg[x] rises from the ground, balanced on its narrow end, interior thrumming with a dense red glow.[paragraph break][exits]." The exits text of Shrine is "The way back [out] through the arch is the only passage".

The shrine-egg is a setpiece in Shrine with printed name "egg". Understand "crystal/egg/seiver" as shrine-egg. The description is "The egg is almost your height. Silver and gold threads run through its interior and vanish into filigreed joins surrounding it. You notice that there are no veins of blue crystal in this one. The surrounding [o]makers[x] are all facing and staring directly at it.". Instead of touching, pushing, or pulling the shrine-egg: say "The surface is utterly smooth: smoother than marble, smoother than glass, and hot to the touch." instead. Check climbing shrine-egg: say "It seems like an inappropriate thing to do to something so obviously important." instead. Check taking shrine-egg: say "It's far too big for that." instead. Check entering shrine-egg: say "It's bigger than the one at the chair on Lacuna, but neither hollow nor big enough to enter." instead.

Some worshippers are undescribed Lacunites in Shrine. Understand "people/person/maker/makers" as worshippers. The description is "Each seems to not quite be present, the pupils of their eyes shrunk to points and vacant but peaceful expressions on their faces.". Check greeting some worshippers: say "You're not sure you should disturb them." instead. Instead of pushing, attacking, hugging, or kissing worshippers, try greeting worshippers.

A circle of soft padding is an enterable undescribed supporter in Shrine. The description is "They seem to be designed to allow people to comfortably kneel amongst the roots of each tree.". After entering circle of soft padding: say "You kneel on the padding, facing the egg in the center like the others[one of].[paragraph break]Moments later you feel familiar thoughts: the seven windsigh on Lacuna. They seem amused, for what these people are doing here is what you already do, in your chair on Lacuna. They are visiting the Thinkers. Though just being near a windsigh is enough to share thought, the seivers allow their thoughts to focus and crystallize enough to speak with any other windsigh in the seiver network, even-- when routed through the special planetary seivers laced with bluerock-- with windsigh on other worlds.[paragraph break]The Lacuna windsigh hesitate. Would you like to know what this is like? They can patch you into the network in much the same way. They hesitate because normally much training and self-discipline is required for Makers to successfully join the Forest network, and they are worried it may be too much for you. Do you want to try?[or], but this time feel nothing unusual.[stopping]". Understand "kneel on [something]" as entering.

Instead of saying yes when player is on circle of soft padding: say "TINGreceive7conSTRUCT Point-adjacency 2sySTEMs affirmSPATIAL5ergo: relationThesIS/rOUTe 1.qualitative LOSTcontains222###--  All at once you are surrounded by a liquid maelstrom of pure thought, and you strugCON9VERSELYgle to keep your own mind separate. 

It is overwhel75ming. Stretching before you into vast infin8/ity is a landscape of consciousPROOF{2ness, its fractal topography the shape of a million slowly446% progressing arguments, discourses, schools of thought; its roads a trillion golden threads and a thousand scintilVERSUS<EGRESSlating anchors of emerald green. You cannot take it all in0^GAMMAfaultAnchor628663@@@.

There is almost nothing you can do (rARE!Parallel;) but descend, fall closer to the ground so the spectacle does not drown you, overwhelm you. As you drift closer to one small (7ConCORDance/INNER) speck of one small corner of the landscape, the brightness begins to separate into individual minds, and you feel yourself swept up in some great (8;2) discussion over the merits of some mental abstraction you cannot even begin to comprehend. You sense for a moment how much of Forest is internal only; layers upon layers of concept and idea with no relation to an external reality, thoughts within thoughts within thoughts, philosophies that beings like you born with windows to the outside world could never begin (fRAMe~naSCENT}) to understand.

Then you are swept into a different (RECALLown-4 Relevance\amUSEmentSPAN; 2belowOBSERvatION) current of thought, not understanding quite how to control your center of attention, and dive through streams of other mental conversations: trees who have studied and learned (SOLve{6) the teachings of other trees long dead, memorized them down to every point and assertion. You realize suddenly that this massive soup of thought substitutes for a written language; what is important is remembered, as long as there is one to remember it.

But a sud4den broadsideTEMPORAL[']baSIS3 -LossFavorITE.6too:INTER queries9 of unrelated / thought sm2acks into youCOUNCILbe*8Subsume'and you lo86s.e contro2l;;, sp3inningCREDULITY3& emPATHy away5into th82. whirl2SINCEpool 3of DELTA,phrASE+32uni/ ultiMATEdent6;Own4COvaleNCE -ityTERMmore3}Rescind8

Abruptly, you pull yourself away. It is too much. For one sickening, disorienting moment you are back on the mountaintop on Lacuna, cold wind whipping your hair, and then suddenly you are kneeling in the circle again, staring at the red glow in the heart of the seiver."; try exiting.

Instead of saying no when player is on circle of soft padding: say "They think this is just as well. Better not to take unnecessary risks."; try exiting.

Section - Nursery

The description of Nursery is "A line of windsigh [o]saplings[x] grows in the shelter of a trellised canopy here, none yet as high as your head. Stone columns intricately inlaid with geometric patterns support the canopy, which is laden with lightly woven cloth that blocks the harshest of the light. Everything about this place, from the way the weave of the cloth shines to the meticulous way each blade of grass is cut, lends a sense of weight, tradition, and dignity.[paragraph break][exits]." The exits text of Nursery is "Paths lead towards the [d]avenue[x] or the end of the [d]mural[x]". Understand "avenue" as west when location is Nursery. Understand "mural" as east when location is Nursery.

The trio of caretakers are a male Lacunite in Nursery. "A trio of [o]caretakers[x] lovingly tends to the trees." The description is "The caretakers move slowly, with reverence and evident love for their charges. One is carefully watering the ground around the roots of one of the smaller trees, while another carefully checks the leaves and branches of another with delicate fingers. The third is adjusting the shading on the canopy to match the slowly sinking sun.". Instead of greeting trio of caretakers, say "They nod and smile at you, but it is evident they do not have time to talk.". Instead of attacking trio of caretakers: say "You strike out at the nearest caretaker. The three pull back in confusion, then awkwardly run away through the trees."; remove trio of caretakers from play; increase the rap sheet of Lacunite-Follower by 3.

Some windsigh saplings are a setpiece in Nursery. Understand "sapling" as some windsigh saplings. The description is "The trees stand straight and tall. Their vines have not come in yet and their trunks are less twisted and wrinkled, stretching proud but skinny branches of golden leaves straight up into the air.". Instead of touching some windsigh saplings, say "You walk down the row of saplings, brushing your hands carefully along the branches and leaves of each one. You touch each mind faintly, sensing their attentions are elsewhere; with teachers, some far away, some even on distant worlds. You catch only the faintest mental glimpses of their education, like deja vu or half-remembered dreams: hints of ancient traditions, the laws of Logic passed down tens of thousands of years, and their chaotic twins, the weird laws of Science to make sense of Outer-Truth; metallurgy, avionics, arboneurology, how to work with Makers to pursue these fields; and other, weirder disciplines, traditions of thought based on thought building up over generations into incomprehensibly self-referential Inner-Truths.". Instead of attacking or pushing or pulling some windsigh saplings: say "You pummel one of the small trees, grabbing its branches and ripping its vines."; increase the rap sheet of Lacunite-Follower by 5. Instead of climbing some windsigh saplings: say "They're too small to climb.". Understand the command "uproot" as "attack". Instead of taking some windsigh saplings, say "They are rooted into the ground.".

Section - Avenue North

The description of Avenue North is "The avenue ends here at the base of an imposing set of curved stone steps, which rise gracefully towards the enormous windsigh now towering above you. Huge [o]roots[x] spill down the stairs, stretching in graceful tangles of ancient gnarled wood almost to the bottom steps.[paragraph break][exits]." The exits text of Avenue North is "Opposite the [d]steps[x] the avenue runs back [down] towards the mural and the distant reflecting pool. Brick pathways lead towards the [d]temple[x] and the [d]nursery[x]". Understand "steps" as northeast when location is Avenue North. Understand "temple" as west when location is Avenue North. Understand "nursery" as east when location is Avenue North.

Some huge windsigh roots are a setpiece in Avenue North. Understand "root" as huge windsigh roots. The description is "The roots are only finger-sized as they creep down the last step and into the soil at your feet, but as they twist and combine their way up the stone steps they grow into massive, tunnel-sized appendages, that merge at last with the trunk of the great windsigh rising from the top of the hill.". Check climbing huge windsigh roots: say "The roots creep down the stone stairs, which might be easier to climb." instead. Instead of touching, taking, pushing, or pulling huge windsigh roots: say "As you place your hand against an ancient tendril, a deep thrumming rush seems to flow through you, something indefinably ancient, sentient, and potent." instead.

Some curved stone steps are a backdrop. They are in Avenue North and Base of the Great Tree. The description is "Massive and ancient.". Instead of climbing or entering or using curved stone steps: if location is Base of the Great Tree, try going down; else try going up. 

Section - Base of the Great Tree

Report going from Avenue North to Base of the Great Tree: say "You walk up forty or fifty steps, passing great roots that thicken more and more as they tumble down the carved rock, till at last you reach the top, at the very base of the mighty tree itself.". Report going from Avenue North to Ancient Temple: say "You walk down the brick path through endless groves of windsigh.".[aar]

The description of Base of the Great Tree is "The huge windsigh stretches imposingly above you, and behind it, the hillside drops off to another spectacular view of the great wooded plain stretching to the red-soaked horizon in the distance.[paragraph break][exits]." The exits text of Base of the Great Tree is "Before you, an entrance just large enough to slip into leads [inside] the massive trunk. The only other option is to walk back [down] the stair". The printed name of Base of the Great Tree is "At the Foot of the Philosopher".

Report going from Base of the Great Tree to Great Tree Interior: say "Pausing for a moment, your hand brushes the aged, gnarled wood of the portal, and a low, low thrum pulses through your fingers, like that of the windsigh on Lacuna, but dim octaves lower. Taking a deep breath, you duck your head and step inside into a round, cavernously tall space.". Report going from Great Tree Interior to Base of the Great Tree: say "You duck your head and slip back out into the dimming twilight of Heart.".

Section - Great Tree Interior

The description of Great Tree Interior is "A courtyard of rolling, aged wood stands before you, surrounded by the curved vertical walls of the inside of the trunk. Water trickles down from high above, where great scattered holes let in burning slashes of red-orange light, which echo around this space and seem to both seep into the rich wood and be amplified by it.[paragraph break][exits].". The exits text of Great Tree Interior is "The only exit is back [d]outside[x]". The printed name of Great Tree Interior is "Inside the Philosopher".

Philosopher Conversation is a scene. Philosopher Conversation begins when location is Great Tree Interior. Philosopher Conversation ends when Treeworld-Hivemind is idle.

When Philosopher Conversation begins: now Treeworld-Hivemind is attentive; force discuss gp_beginnings.

Check eye closing during Philosopher Conversation (this is the can't escape during a key scene Treeworld rule):
	say "With all the trouble he's done to bring you here, it would be tragic to leave in the middle of the conversation." instead.

Check greeting Treeworld-Hivemind when Philosopher Conversation has happened and location is Great Tree Interior: say "You feel the great mind stir somewhere around you, but it is sluggish, as if resting, tired, perhaps, from its efforts to communicate with your unfamiliar mind. A dim reminder floats gently through your head: that to leave this world, you need only close your eyes." instead.

GPC is a thread.

Instead of getting bored when last beat is in GPC: force discuss gp_story1. Instead of saying farewell to or going when last beat is in GPC: try eye closing. Instead of greeting Treeworld-Hivemind when gp_outtro is unspoken: say "You call out a tentative greeting, but there is no response other than a faint, dull pulse. You sense the mind of the Philosopher is elsewhere.".

gp_beginnings is a beat in GPC with reaction "A vast presence begins to gather, richer, more immediate, and far grander than the dim trickles you felt in your dreams. You sense that this is a mind far older than the others you have spoken with.[paragraph break]Words begin to form in your mind, each taking on a ponderous weight.". gp_beginnings suggests gp_intro.

gp_intro is a beat in GPC with reaction "I Speak for Three expanding Spheres of Self.

There is the I that speaks, the [gp_Inner] One who Is this tree.

There is the We that speaks, the [gp_Million] Million minds in the Heart of Forest and in all our Glades across the greening Galaxy, who share their Thought and their Voice as well.

There is the Greater-We that speaks, [gp_Union] of the [gp_Thinkers] and the Makers, our Civilization made Whole, for neither Is without the Other.

We are Three and One. We welcome you.". gp_intro suggests gp_story1.

Understand "inner" as gp_inner when last beat is in GPC. gp_inner is a beat in GPC with keyword name "Inner" and fuse 5 and reaction "Inner I am Old. Inner I have Watched the Stars precess across the Sky through Eyes of Many Makers. Forty-six kinmen have I Joined with, watched Age, watch Die. I have Thought Much.". gp_inner suggests gp_story1.

Understand "million" as gp_million when last beat is in GPC. gp_million is a beat in GPC with keyword name "Million" and reaction "We stretch Across a Thousand Worlds, One Mind from Many, Joined by the Bluerock.[paragraph break]Forest.". gp_million suggests gp_story1.

Understand "union" as gp_union when last beat is in GPC. gp_union is a beat in GPC with keyword name "Union" and reaction "The Mural shows the Day of Union, when First Thinker and First Maker Touched with Mind.". gp_union suggests gp_story1.

Understand "thinkers" as gp_thinkers when last beat is in GPC. gp_thinkers is a beat in GPC with keyword name "Thinkers" and reaction "They are Of Us, for we have Grown Together.

Though the We were born Solely of Thought, the We could Never now return to that State of Solipsism and Solace. It has joined with the State of Matter and Nature. It is The Makers who [gp_Changed] us thus, as the Thinkers too changed Them.". gp_thinkers suggests gp_questions.

gp_questions is a repeatable beat in GPC with reaction "[one of]You have Seen the Heart, our Home. Perhaps you have Questions. We shall Answer.[or]Ask, or [t]Listen[x].[stopping]". gp_questions summons gp_nursery, gp_dreams, gp_progue. gp_questions suggests gp_story1.

Understand "nursery" as gp_nursery when last beat is in GPC. gp_nursery is a beat in GPC with keyword name "nursery" and reaction "My Seedlings.[paragraph break]Some will Stay in my Grove to Think with Me.[paragraph break]Others will soon Go Elsewhere, to Watch over Needful Groves.[paragraph break]I Think with them All and their Thousand Cousins across the Heart.". gp_nursery enqueues gp_questions.

Understand "dreams" as gp_dreams when last beat is in GPC. gp_dreams is a beat in GPC with keyword name "dreams" and reaction "The Mind of your People is not Attuned. You have No Thinkers. You Expect no Thoughts but your Own.

It is Fortunate your minds become Free and Open at periodic Intervals. We would Not have Reached you without your Dreams.". gp_dreams enqueues gp_questions.

Understand "changed" as gp_changed when last beat is in GPC. gp_changed is a beat in GPC with keyword name "changed" and reaction "Before, The Makers could not Think.

Before, The Thinkers could not Make.

Now the Greater-We Think and Make as One.". gp_changed suggests gp_story1.

gp_story1 is a beat in GPC with reaction "Know.

The We on your Island have no Makers and Long for them, for They are not Complete. The destiny of Those Who Make is Making, and Greater-We are now Half-Maker. The We of Lacuna have much Making to do. Lacuna-We dream for Makers to build Ships, plan Cities, spread the Mind and Hand of Greater-We across that fertile World.

But not just for Them are you Here. There is a Greater [gp_story2].". gp_story1 suggests gp_story2. After discussing gp_story1: now gp_progue suggests gp_outtro; continue the action. gp_story2 replaces gp_story1.

Understand "purpose" as gp_story2 when last beat is in GPC. gp_story2 is a beat in GPC with keyword name "Purpose" and reaction "The Growth of Greater-We has Stopped. We are Brought Together only through the [gp_Bluerock] mined from Deep Within this Planet. Now it is gone. The Bluerock is found on no Other World of Forest. But it Grows on Lacuna. We have Seen it in Your Dreams.

Of our Eggs there are One Hundred Sixty Eight which [gp_Lost] themselves. One crashed on Lacuna. Therefore Lacuna is One of One Hundred Sixty Eight charted Destination worlds. We Do Not Know Which. We Do Not Wish to send Makers to Death. Before Makers are sent to make Whole the Thinkers of Lacuna, we Must Know Exact-where to Send Them.". gp_story2 suggests gp_story3. gp_story3 replaces gp_story2.

Understand "lost" as gp_lost when last beat is in GPC. gp_lost is a beat in GPC with keyword name "Lost" and reaction "Some Perhaps did not Awaken from Interstellar Slumber, neither their Makers nor their Computers.

Some Perhaps found Worlds that Could Not support Maker Life or Thinker Life, despite Preliminary Data.

Some Perhaps Malfunctioned in Landing and Crashed.

But this is Inner-Thought Only. There is no Outer-Truth.". gp_lost suggests gp_story3. 

Understand "bluerock" or "blue rock" as gp_bluerock when last beat is in GPC. gp_bluerock is a beat in GPC with keyword name "Bluerock" and reaction "A Singular Element found, to Our Knowledge, on just Two worlds: the Heart, and Lacuna. All Bluerock connects to All Other Bluerock, at Once, whether Close or Far.

Many Inner-Thinkers say Bluerock is its own Universe, that from Correct Perspectives all Bluerock is One Point, Unified. There is no Outer-Truth on this Subject.

When I was a Sapling, many Maker-Lifetimes ago, the We-scientists Learned to Send our Thoughts through the Bluerock. Thus do We remain One across the Grove, though Light-Centuries Separate Some from Others.". gp_bluerock suggests gp_story3.

gp_story3 is a beat in GPC with reaction "You did Hear our Dreams. The [gp_ceiver] Made by [gp_Progue] still Functions.

Reach the Top of the Tallest Tree on your Island and Look. Look up to Stars, the Greening Galaxy above. The Tree will See too. The Seiver will See too. The We will See too. And the [gp_Astromancers] of the We will Know from those Star-patterns the Where of Lacuna.

The We Know the [gp_Stunted] Speak Also. The We Speculate They will Ask of you The Same. Do Not Show the Stars to Them. Keep your Cryption On, and Set to the Heart, to Forest only. The Stunted seek to Cut Down the Thinkers. But Makers cannot survive Alone.". gp_story3 suggests gp_outtro. gp_outtro replaces gp_story3.

Understand "stunted" as gp_stunted when last beat is in GPC. gp_stunted is a beat in GPC with keyword name "Stunted" and reaction "They Are another of the Lost One Hundred Sixty Eight. An Accident. Their Thinkers did not Survive the Journey. They have Built a Some-Society of Makers Alone, a Maybe-City that the We predict will Not Survive. 

Without the We to Guide their Thoughts, these Makers grow Stunted. They are Alone. They Believe that To Be Alone is the Natural Way of things. They Believe that the We, the Thinkers, wish to be Their Masters. They seek to spread their Part-Culture through the Galaxy, Eradicating the Thinkers from the Cosmos.

There are Worlds Enough for the We and the Stunted. But Not Enough Bluerock for Both to Grow.". gp_stunted suggests gp_outtro.

Understand "seiver" as gp_ceiver when last beat is in GPC. gp_ceiver is a beat in GPC with keyword name "seiver" and reaction "It Channels the Thoughts of Makers and Thinkers through the Bluerock, and into the Thoughts of Other Makers and Thinkers. It Knows and Finds Which among Trillions to channel To.

The one on Lacuna was Tuned by Progue to the Thoughts of Your Kind, as Well.". gp_ceiver suggests gp_outtro.

Understand "astromancers" as gp_astromancers when last beat is in GPC. gp_astromancers is a beat in GPC with keyword name "astromancers" and reaction "Great Minds that Know the Motions of the Stars. They will Learn from the Patterns the Stars make in the sky of Lacuna. They will Find its Coordinates in the Galaxy.". gp_astromancers suggests gp_outtro.

Understand "Progue" as gp_progue when last beat is in GPC. gp_progue is a beat in GPC with keyword name "Progue" and reaction "We Do Not Know.

We Do Not Know How he Came to Lacuna. We Dreamed with Him and Saw it was Not His World. But the Arrival, For He and the Two, is Unexplained.

We Do Not Know Why he Failed to Help us. When he Left the Heart, it was Expected he Would. He Did Not. Lacuna-We have only Dimly sensed him Since. He Stays Away.

We Do Not Know [gp_wayfaring] You too have now Arrived.". gp_progue suggests gp_questions.

Understand "wayfaring/how" as gp_wayfaring when last beat is in GPC. gp_wayfaring is a beat in GPC with keyword name "how" and reaction "Strange.

Strange.

There are We on a Distant World who Think perhaps the Bluerock Flows though your Veins. That You are Living Bluerock, and it is Not just your Thoughts that can connect Across the Vastness, but your Self as Well, to Other Worlds across Infinitudes where Bluerock Grows.

This is but Inner-Thought. Lacuna-We have no Tools to Test this.". gp_wayfaring suggests gp_outtro.

gp_outtro is a terminal beat in GPC with reaction "Each We shall say Goodbye now.

Remain in the Heart for as Long as you Wish. You are Welcome. When you wish to Relinquish Control of the Maker whose Body you use, simply Close your Eyes. Your Thoughts will Return to Lacuna.

Help to Grow Forest. Show us the Stars. A million million Seedlings await your Friendship.". 

After discussing gp_outtro:
	print a section break;
	say "The powerful presence is gone; only a lingering sense of fullness in the air, subliminal yet heavy, remains.";
	continue the action.


[Chapter - Puzzles

After going in Treeworld for the first time: now everything required by Contacting-All-The-Trees is met; continue the action.

Section - Reaching Treeworld

Reaching-Treeworld is a puzzle. Reaching-Treeworld requires Getting To The Trees.

After going in Treeworld for the first time: now everything required by Reaching-Treeworld is met; continue the action.


Section - Finishing Treeworld

FF-Reaching-Treeworld-Treeworld is a scene. FF-Reaching-Treeworld-Treeworld begins when Reaching-Treeworld is force solved. FF-Reaching-Treeworld-Treeworld ends when 1 is 1.

When FF-Reaching-Treeworld-Treeworld begins:
	change the player to Lacunite-Follower;
	now the mind machinery is projecting;
	change the machinery-password to the tree-password;
	now yourself is asleep.

Finishing-Treeworld is a puzzle. Finishing-Treeworld requires Ditching The Trees.

After eye closing when we have discussed gp_outtro: now everything required by Finishing-Treeworld is met; continue the action.
]

Chapter - Fast Forwarding

A fast-forward rule for Finishing-The-Prologue:
	now Lacunite-Follower is male.

Treeworld-Sequence is a puzzle. It requires Being-In-Treeworld, Finishing-Treeworld.

Being-In-Treeworld is a puzzle. It requires Arriving-Treeworld.

Arriving-Treeworld is a task. Definition: Arriving-Treeworld is complete: if Overlook is visited, yes.

A fast-forward rule for Being-In-Treeworld:
	now yourself is on mind chair;
	change the machinery-password to the tree-password;
	now the mind machinery is projecting;
	try looking.

Finishing-Treeworld is a puzzle. It requires Concluding-Philosopher-Convo.

Concluding-Philosopher-Convo is a task. Definition: Concluding-Philosopher-Convo is complete: if gp_outtro is spoken, yes.

A fast-forward rule for Finishing-Treeworld:
	now gp_outtro is spoken;
	now the time of day is 10:30 PM;
	try silently eye closing.

Volume - City (in Lacuna-Rebelworld by Blue Lacuna)

Visiting Rebelworld is a recurring scene. Visiting Rebelworld begins when the mind machinery is projecting and the machinery-password exactly matches the text rebel-password and Visiting Rebelworld is not happening. 

When Visiting Rebelworld begins:
	if the player is male, now DrQuick is male;
	otherwise now DrQuick is female;
	change the player to DrQuick;
	change the time of day to 12:01 PM;
	now yourself is asleep; [helps out various rules.]
	try looking. 

Visiting Rebelworld ends nominally when the player is yourself. Visiting Rebelworld ends successfully when cl_story7 is spoken and the player is yourself. 

When Visiting Rebelworld ends nominally:
	move DrQuick to Memorial Park;
	now DrQuick wears the cap;
	unless Visiting Treeworld ended successfully, set up the endgame storm.

When Visiting Rebelworld ends successfully:
	if rap sheet of DrQuick < 5, move DrQuick to Cafeteria;
	now DrQuick wears the cap;
	move Cloudeye to Cafeteria;
[	now Ditching The Rebs is met;]
	remove leader from play;
	if Visiting Treeworld ended successfully, set up the endgame afterstorm;
	else set up the endgame storm.

Check taking off when the player is regionally in Rebelworld and noun is cap and StraightTalkWithRebelLeader is not happening (this is the remove cap to leave Rebelworld rule): 
	say "You remove the cap from your head. Within a second your surroundings become fuzzy and indistinct-- a sudden moment of vertigo--";
	now yourself is awake; 
	change the player to yourself;
	print a section break;
	say "[bold type][location][roman type][line break][description of location]" instead. [We do this instead of looking because we want to show the description of the area, not the chair controls, to emphasize we've returned to Lacuna.]

Carry out landmark-listing when location is regionally in Rebelworld: say "This place is so different and strange, it's hard to get your bearings."

Instead of sleeping when location is regionally in Rebelworld: say "You're far too keyed up to sleep right now.".

Check examining DrQuick: try taking inventory instead.
[
	say "The landmarks you can go to are: ";
	repeat with locale running through visited landmarked rooms regionally in Rebelworld begin;
		say "[line break]  ";
		if the landmark name of locale is not "null", say the landmark name of locale; otherwise say locale;
	end repeat.]

[Plaza and Space Museum are landmarked.]

Memorial Park is inside from Plaza. Rebelworld-Outdoors is a region. Plaza, Room1, Room2, Room3, Room4, Room5 are in Rebelworld-Outdoors. Rebelworld-Outdoors, Lab, Memorial Park, Library-Room, Space Museum, Room6, and Room7 are in Rebelworld.

DrQuick is a person. DrQuick is in Lab. The printed name is "Quick".

DrQuick wears a passcard. The description of a passcard is "It's a small rectangle of baked stone, with an intricate series of notches and holes running along one side, attached to a chain around your neck.". Instead of taking off passcard, say "The rectangle does not seem able to detach from the chain, and the chain in turn loops so closely around your neck you could not pass it over your head." Understand "pass/card" as passcard.

DrQuick wears a cap. The description of the cap is "The cap seems to be part of the uniform, but running your hands around it you can feel all sorts of wires and protuberances woven into the inner lining. A cable snakes down your neck and back to a bulky transmitter unit attached to your belt.". Understand "hat" as cap.

A coin is a kind of thing. DrQuick carries three coins. The description of a coin is "A small disc of some lightweight silver metal, embossed with the image of a stern-looking elderly woman.".  Understand "coins/money" as a coin.

DrQuick wears a uniform. The description of uniform is "Stiff, uncomfortable, made of coarse fabric dyed deep charcoal-grey. But something about the large buttons rising up the left-hand side to the shoulder, and the cut of the collar, implies a degree of respect may be given to the wearer.". Instead of taking off uniform, say "But you have nothing else to wear." Understand "jacket" as uniform.

Check eye closing during Visiting Rebelworld: say "You close your eyes deliberately for a long moment, but nothing happens." instead.


Chapter  - Lab



The Lab is a room in Rebelworld. The description of Lab is "[if unvisited][lab_opening_scene][otherwise]Coils of multi-colored wire, huge hot conduits of metal and glass, and a dusty bank of flashing lights and unlabeled controls fill this small windowless room, stuffy and filled with the smell of ozone. The curves of a great [o]behemoth[x] of a machine fill the room. [exits].[end if]".

To say lab_opening_scene: say "Coils of wire, the tang of ozone, blurry red lights flashing in your face. Before you [if Being-In-Treeworld is solved]can get your bearings in this second world[otherwise]can even begin to wonder what's happened to you[end if] a klaxon sounds and a jet of chilly mist arcs across the room[if Being-In-Treeworld is unsolved]-- room? Yes; you're somewhere entirely different now: but there are none of the tingling aftershocks of wayfaring. What is happening?[else].[end if]". 

The exits text of Lab is "A small white [d]door[x] [if we have discussed osm_leaderresults]and a smaller [d]platform[x] squeezed into one corner seem to be the only exits[otherwise]seems to be the only exit[end if]".

A small white door is a door. It is east of Lab. It is undescribed, locked and closed. The description is "The door's white metal surface is broken only by a wheel and a small round porthole.". Instead of opening or vague unlocking or going the small white door: say "You move to the door and try turning the wheel in its center, but it doesn't budge."; if Cloudeye is not attentive, now Cloudeye is attentive; force discuss osm_doorout. [A procedural rule while going in Lab: ignore the can't go through undescribed doors rule.] Instead of doing something to the small white door when we have not discussed osm_welcome, say "You're still too disoriented to really get your bearings.".

A metal wheel and a small round porthole are part of the small white door. Instead of turning or pushing or pulling metal wheel, try opening white door. The description of the porthole is "Peering through the porthole's thick glass, you see a white clean room with another console filled with blinking lights.".

An elevator is down from Memorial Park and up from Lab. The elevator is a door. The elevator is undescribed, unopenable, and not lockable. Instead of examining elevator when location is Memorial Park, try examining shed. The description of elevator is "The small platform is in a corner of the room above a square black hole in the ceiling; gears and a track run up the walls.". Understand "platform" as up when location is Lab. 

TheBeast is a setpiece in Lab. Understand "machine" or "machinery" or "behemoth/coil/coils/wire/conduit/conduits/metal/glass/dusty/bank/lights/controls/tube/tubes/steel/columns/light/systems/cooling/control/dial/switch/wiring/keyboard/monitor" as theBeast. The description of TheBeast is "It's truly a monster; this room is actually quite large, though the machine takes up nearly all of it, making the remaining space feel quite cramped. Burnished steel tubes, glowing columns of orange light, massive rounded cooling systems, and a control bank of dials and switches make up the bulk of the content. A seemingly infinite amount of wiring fills the room like a gut full of intestines.".

Opening Scientist Monologue is a scene. Opening Scientist Monologue begins when the player is in Lab for the first time. Opening Scientist Monologue ends when Cloudeye is idle.

When Opening Scientist Monologue begins: now Cloudeye is attentive; force discuss osm_opening.

Cloudeye is an undescribed man in the Lab. "[if osm_postreflection is spoken]Cloudeye[else]The man in the lab coat[end if] stands a few paces away, trying to pretend he isn't staring at you in fascination." Understand "face" or "figure" or "man" or "scientist" as Cloudeye. The description is "[if we have not discussed osm_noticedoctor]His back is to you; all you can see is his distinctive white coat[otherwise][Cloudeyedesc][end if]." To say Cloudeyedesc: say "[if we have not examined Cloudeye and skeletons_bit is 0]His facial features are not quite human, but close enough, and you immediately recognize the basic shape: that of the skeletons from the Egg ship on Lacuna. [otherwise if we have not examined Cloudeye]Again, you recognize the distinct facial features of those almost-human skeletons from the egg ship. [end if]He is short, stooped a little though he seems young, with oval spectacles and an irregular pink birthmark that covers a third of his face. Straight hair pulled straight back makes thousands of brown-grey arcs down to his shoulders". After examining Cloudeye: now skeletons_bit is 1. The printed name of Cloudeye is "[if osm_postreflection is spoken]Doctor Cloudeye[else]the man in the lab coat".

OSM is a thread. First check vague discussing when last beat is in OSM: say "You're too disoriented to get a grip on the conversation." instead.

osm_doorout is a repeatable ephemeral beat in OSM with reaction "[one of]'Oh,' Cloudeye says, looking up, 'that's to the clean room and the [osm_somenium] crucible. It locks automatically whenever the [osm_beast] is running. Good thing, too; it's hot enough to melt your skin off.'[or][paragraph break]'The elevator's the only way out while the [osm_beast] is running, doctor,' Cloudeye says again, distractedly.[or][stopping]". osm_doorout summons osm_somenium, osm_beast. Understand "somenium" as osm_somenium.

osm_somenium is a beat in OSM with keyword name "somenium" and reaction "'Yes,' Cloudeye says, nodding eagerly, 'terribly rare. It's the material that allows for us to communicate across interstellar distances. All the somenium on the entire planet is through that door; all that came from Egg. Your Lacuna has a lot more, according to the last [osm_Progue]: a blue hexagonal crystal, in its natural state.'[paragraph break]'I think Doctor Quick reserved a book about it for you at the city library,' he adds, 'if you're interested in learning more.'".

Carry out getting bored when Cloudeye is enclosed by location: say "[cloudeyefinish]." instead. Report saying farewell to when location is lab: say "[cloudeyefinish]." instead. To say cloudeyefinish: say "'I'll just get back to these figures,' Cloudeye says, turning distractedly back to the console".

osm_opening is a beat in OSM with reaction "'Primary overload, doctor!' a voice shouts, and you spot a blurry [o]figure[x] in a lab coat through the mist, back to you, turning dials and pulling levers. 'Give me a minute to localize and then I'll [osm_voicenotice] her back down.'". osm_opening suggests osm_prattle1. osm_opening summons osm_voicenotice. After discussing osm_opening: now Cloudeye is described; continue the action.

osm_prattle1 is a beat in OSM with reaction "'Must have blown one of the somenium channel conduits again,' the figure mutters, still flipping switches frantically. 'I keep telling you it's a mistake to run that much bandwidth through an HR-7 connector.'". osm_prattle1 suggests osm_prattle2.

osm_prattle2 is a beat in OSM with reaction "'Just a few more moments and I'll have it shut down, doctor,' he continues, pressing a series of glowing red buttons.". osm_prattle2 suggests osm_noticedoctor.

Understand "phase" as osm_voicenotice. osm_voicenotice is a beat in OSM with fuse 10 and keyword name "phase" and reaction "[voice_notice_bit][line break]'What's that, doctor?' the figure says, and turns towards you. [if Being-In-Treeworld is solved]He's another of the windsigh's people, like the ones on their world and the skeletons on Lacuna[otherwise]Again, a shock: his features are not quite human, but familiar. After a moment you realize what you are seeing looks like one of the skeletons from the crashed egg ship on Lacuna, if it were given flesh and life again[end if].". osm_voicenotice enqueues osm_noticedoctor.

To say voice_notice_bit: say "[one of]You begin to speak, but after just a few words you falter in shock. The voice that comes from your lips is instantly recognizable, though you've heard it only in dreams. Reedy. Cynical. Sardonic.[or][stopping]".

osm_noticedoctor is an insistent beat in OSM with reaction "The man seems to have disabled most of the alarms and warning lights. His hand on a massive switch, he turns to you, but stops short as he notices your expression. 'Doctor?' he says. 'Is everything all right?'". osm_noticedoctor summons osm_allright, osm_notallright.  Instead of saying yes when last beat is osm_noticedoctor, force discuss osm_allright. Instead of saying no when last beat is osm_noticedoctor, force discuss osm_notallright. osm_noticedoctor suggests osm_silence. osm_silence replaces osm_noticedoctor.

osm_silence is a beat in OSM with reaction "The man takes a few steps closer. 'Doctor Quick?' he says. Then he gasps. 'By the Builder. It's you, isn't it? The one from the island? From Lacuna?'". osm_silence enqueues osm_waitforanswer.

osm_notallright is a beat in OSM with keyword name "no" and reaction "Uncertainty ripples across the strange features. 'Then-- did we-- is it-- you're the one from the island? From Lacuna?'". osm_notallright enqueues osm_waitforanswer. 

osm_waitforanswer is an insistent beat in OSM with reaction "He watches you intently.". osm_waitforanswer summons osm_welcome, osm_faking. Instead of saying yes when last beat is osm_waitforanswer, force discuss osm_welcome. Instead of saying no when last beat is osm_waitforanswer, force discuss osm_faking. osm_waitforanswer suggests osm_welcome.

osm_faking is a beat in OSM with keyword name "no" and reaction "But the man is shaking his head. 'No, I can tell. Your face, it's... someone else behind... I mean... it's... we did it!'". osm_faking enqueues osm_welcome.

osm_allright is a beat in OSM with keyword name "yes" and reaction "He nods, relief crossing his features only to be followed by more uncertainty. 'It's just that the band reader says we have link, that we're transmitting, and... and receiving...'[paragraph break]He squints, peering closer at you. 'By the Builder. Is... is it you? The one from the island? From Lacuna?'". osm_allright enqueues osm_waitforanswer.

osm_welcome is a beat in OSM with keyword name "yes" and reaction "The man gives a little yell of excitement and punches the air, then slaps a metal conduit which clangs resoundingly. 'The Beast did it!' he says. 'She worked! We've brought you here... how exciting... I'll need to call the G's office... so many things...' [paragraph break]He runs a hand through his hair, and seems to physically calm himself down. 'But you're confused,' he says. 'You don't know...' He casts about helplessly, as if looking for something. At last he spots the side of a dusty boxy conduit of silvery metal, and quickly rubs away some dust and grime with the sleeve of his lab coat, revealing a murky [o]reflection[x].[paragraph break]'Look,' he says, 'it'll explain. I hope.'". osm_welcome suggests osm_waitforlook.

osm_waitforlook is a beat in OSM with reaction "The man in the lab coat shifts impatiently from foot to foot.". osm_waitforlook suggests osm_explainnolook.

osm_explainnolook is a beat in OSM with reaction "'Well, I'll just explain, I guess,' the man says finally. 'You're in the body of Doctor Quick.'". osm_explainnolook enqueues osm_postreflection.

The murky reflection is a setpiece in Lab. The description is "[one of]You peer at the murky reflection and feel yourself growing faint. Peering back at you is an alien face-- like the nervous assistant[if DrQuick is female] except in gender, and[otherwise], but[end if] older, greying. It is a face etched with lines of concentration and disappointment, [if DrQuick is male]framing bushy white eyebrows[otherwise]round, ruddy cheeks[end if] guarding intense, piercing eyes. An intelligent face. A cynical face. And for the moment, yours.[or]The reflection of Doctor Quick is still unsettling, but you are slowly growing used to occupying this strange body.[stopping]".

After examining murky reflection when we have not discussed osm_postreflection, force discuss osm_postreflection.

osm_postreflection is a beat in OSM with reaction "'[if DrQuick is male]He's lent you his[otherwise]She's lent you her[end if] body while you're here,' the scientist says. 'Although technically speaking you're not actually here, of course. We're tapping the entire planetary bandwidth to send [if player is male]his[else]her[end if] sensory data through the Link back to Lacuna, and bring your motor impulses here to [if DrQuick is male]him[otherwise]her[end if]. All encrypted with your password. Terribly complex. Doctor [osm_quick]'s life work. Been years since we've done it. Didn't know if the [osm_beast] still had it in her.' He gives the conduit a loving pat.[paragraph break]'Oh!' he suddenly adds with a start. 'Cloudeye. Doctor Cloudeye is my name, Doctor Quick's [osm_Cloudeye]. Sorry, so easy to forget I'm not talking to... er, well, a pleasure to meet you.' He bows. 'And oh. Welcome to [osm_city].'". osm_postreflection summons osm_city, osm_Cloudeye, osm_beast, osm_Quick, osm_callleader. After discussing osm_postreflection: notice language translation; continue the action. Understand "beast/machine" as osm_beast. osm_postreflection suggests osm_callleader

osm_beast is a beat in OSM with keyword name "Beast" and reaction "'Brilliant design,' Cloudeye says fondly, patting its dusty bulk again. 'Technology's a bit antiquated nowadays, but Doctor [osm_Quick]'s theories are just as sound. Been mothballed for decades. We brought it back up to speed in record time, once our mindlisteners monitoring Lacuna notified us there might be a new passenger.'".

Understand "city" as osm_city. osm_city is a beat in OSM with keyword name "City" and reaction "'Yes, the City, or First City if you want the, er, full name,' Cloudeye explains, licking his lips nervously. 'We're actually on almost the exact spot where [osm_egg] crashed. Egg brought the ancestors here. Like on your Lacuna. This [osm_lab] was built around it, actually.' He runs a nervous hand through his hair, then laughs weakly.". osm_city summons osm_egg, osm_lab. 

Understand "lab" as osm_lab. osm_lab is a beat in OSM with keyword name "lab" and reaction "'This is Somenium Research Laboratory Number One,' Cloudeye says. 'One and only, actually. We're underneath City now; it's a top secret facility.'".

Understand "egg" as osm_egg. osm_egg is a beat in OSM with keyword name "Egg" and reaction "'It's fascinating,' Cloudeye says, nodding his head, 'Lacuna and our world are a kind of opposite. You see, here, when the ship crashed, it was the humans who survived, while the trees did not. So our ancestors had to learn to think for the themselves, to survive without the help of their masters.' He laughs nervously. 'And, well, here we are.'".

Understand "Cloudeye/assistant/doctor" as osm_Cloudeye when last beat is in OSM. osm_Cloudeye is a beat in OSM with keyword name "assistant" and reaction "'Well, chief assistant, really,' he blurts nervously. 'Your, er, Doctor [osm_quick]'s assistant, so lucky, really, to get the job... the [osm_hours] are rather strange, but to work with such a prominent scientist!' He wrings his hands together. 'Really, you don't know what an honor this is for you.'". osm_Cloudeye summons osm_hours. Understand "hour/hours" as osm_hours.

osm_hours is a beat in OSM with keyword name "hours" and reaction "He runs a hand through his hair. 'Yes, well, just dreams for you, but long wakeful nights and days for us here in [osm_City]. Keeping your signal phased in, scrambling frequencies to keep our transmissions undetected, cycling venting systems to keep the [osm_Beast] from overheating... and you-- Doctor [osm_quick], I mean-- always sitting there, speaking into the microphone, hoping [if DrQuick is male]his[otherwise]her[end if] words would somehow make it across the stars...'[paragraph break]A dreamy look comes into his eyes as he stares fondly at a battered chair in front of the console. 'Such a great [if DrQuick is female]wo[end if]man,' he murmurs.".

Understand  "Quick" as osm_Quick when last beat is in OSM. osm_Quick is a beat in OSM with keyword name "Quick" and reaction "'A genius,' he says, '[if DrQuick is female]s[end if]he's reverse engineered so much from the wreckage of the egg ship... the [osm_Beast] is [if DrQuick is male]his[otherwise]her[end if] baby, of course.'[paragraph break]He looks at you sidelong, hesitant. 'Doctor Quick was the one who met with the first [osm_Progue],' he adds, 'twenty years ago.'". osm_Quick summons osm_progue.

Understand "progue/first/visitor" as osm_Progue when last beat is in OSM. osm_Progue is a beat in OSM with keyword name "visitor" and reaction "He reddens. 'I really should leave explanations to the G.,' he says.". osm_Progue enqueues osm_callleader.

osm_callleader is an exciting terminal beat in OSM with fuse 99 and reaction "'Excuse me,' Cloudeye says with a start, 'I have instructions to summon the Governor General the moment you'd arrived. So much excitement it slipped my mind.' He hurries to a monitor in the control bank with a one-handed keyboard and begins punching keys at a dizzying rate.".  osm_leaderresults replaces osm_callleader. After discussing osm_callleader: Cloudeye concludes in 3 turns from now; continue the action.

At the time when Cloudeye concludes: pre-conversation processing; force discuss osm_leaderresults.

osm_leaderresults is an exciting terminal beat in OSM with fuse 99 and reaction "Cloudeye reads something off the monitor then looks up at you. 'The G is en route,' he says solemnly. 'I'm to give you his warmest welcome to City, and say that he has a great favor to ask of you when he arrives. The uh, fate of our people may depend on it.' He smiles weakly.[paragraph break]Cloudeye pushes some hanging cables out of the way and points towards a small [d]platform[x] in the corner. 'It may be a while, though,' he says. 'We're right below City center and the traffic's a nightmare. This elevator will take you up. You should have some coins in your pocket. Feel free to look around, although I wouldn't head too far down Planter Avenue if I were you.'[paragraph break]He comes back towards you and touches the [o]cap[x] you wear. 'This transmitter should let you stay connected anywhere within six blocks,' he says, 'but don't take it off or you'll spoil the link. I'll be here if you have any questions.' Cloudeye smiles, then turns to a control console and pretends to study it thoughtfully.". osm_lr2 replaces osm_leaderresults. After discussing osm_leaderresults: now elevator is open; continue the action.

Instead of saying farewell to Cloudeye when osm_leaderresults is unspoken: say "'Just a minute,' he says.".

Understand "governor" as osm_lr2 when last beat is in OSM. osm_lr2 is a repeatable beat in OSM with keyword name "governor" and reaction "'He's still quite a ways from here,' says Cloudeye, glancing at a monitor. 'Some sort of security issue, it sounds like. Feel free to go [up] and explore, if you like.'".

Instead of exhausting when location is Lab: say "'Terribly sorry,' Cloudeye says nervously, 'I really should get back to these numbers.'".

Return-To-Lab is a recurring scene. Return-To-Lab begins when Memorial Park is visited and location is Lab.

When Return-To-Lab begins: say "Doctor Cloudeye looks up nervously from a display as your elevator descends. 'Still waiting, then?' he asks. 'Well, feel free to wait here, if you like.'".

Instead of greeting Cloudeye when location is Lab and Cloudeye is idle: pre-conversation processing; force discuss ce_greet.

ce_greet is a repeatable beat in OSM with reaction "'[one of]Er, yes[or]Who, me[or]Oh, uh, yes[at random]?' he says nervously. 'What can I tell you? More about the [osm_lr2], or [osm_city], or the [osm_beast] maybe?'". 

Return-To-Lab ends when location is not Lab.

Chapter  - Memorial Park

Memorial Park is a room.

Report going from Lab to Memorial Park: say "You step onto the platform, and it immediately begins to rise towards a dark square in the ceiling. Cloudeye gives you a small wave as he vanishes from sight. A few moments later the elevator rises into a small wooden enclosure with one door. You push through into the city[if Memorial Park is unvisited].[paragraph break]The sudden, overwhelming rush of noises, strange smells, bustling vehicles, and a cold grey sky convince you, more than anything, that this really is a whole other world. The air is acrid, tinged with smells of unfamiliar food and sweat, and the wind that whips through your hair is chill, but dense. After a moment's vertigo, you finally look around and get your bearings[end if].".

Report going from Memorial Park to Lab: say "You insert your passcard into the slot near the door of the tiny shed. A light flashes green and the door unlatches. You step inside and descend on the elevator back to the lab.".

The description of Memorial Park is "Though this small park is surrounded on all sides by urban [o]chaos[x], something sacred is in the unassuming bushes here, neatly trimmed, and the simple, cobbled [o]paths[x] that wind between them, undisturbed but for a rare bench or straight black lamppost.[paragraph break]A [o]statue[x] of black-smudged bronze stands tall and silent at both the physical, and, you imagine, spiritual center of the park.[paragraph break][exits].". The exits text of Memorial Park is "Small gates on all four sides lead out to the [d]city[x], while an unassuming tool shed conceals the entrance back [down] to the lab". Understand "city" as outside when location is Memorial Park.

The shed is a setpiece in Memorial Park. Understand "door" as shed. The description is "Half-hidden behind a well-tended shrub, the simple wood hut looks like a simple gardener's tool shed from the outside.". Instead of opening or entering shed, try going down. Instead of going inside in Memorial Park, try going down.

The freedom statue is a setpiece in Memorial Park. The description is "Bold, powerful, the statue depicts a single man, herculean but not overwhelmingly so, in the act of stepping clear of a shattered eggshell at his feet. Amidst the wreckage are dozens of tree roots snarling about the man's foot and back leg, snake-like, but he rips free of them as he steps forward into some metaphorical boldness. Cast from some dull copper-colored medium, angles and edges have turned to black due to some age-provoked interaction with the elements. [paragraph break]At the base of the statue is a [o]plaque[x] with an inscription in some unfamiliar language.". Check climbing freedom statue: say "It seems like that would be immensely disrespectful." instead.

The freedom statue plaque is part of the freedom statue. The description is "At first the symbols mean nothing to you, but then some part of your borrowed brain whispers meaning to your consciousness: [paragraph break]'...and of that toil undertaken alone, with none to coddle or mitigate or direct or repurpose, of that toil alone is man made free.' --Builder Tall".

The chaos is a backdrop with printed name "city chaos". It is in Memorial Park and Plaza. The description is "The noises, smells, and constant movement of a city overwhelm you; it has been a long time since you've been in such a heavy urban area.".

The simple cobbled paths are a setpiece in Memorial Park. The description is "Though you have little to compare it to, the paths and quaint little benches feel as if they come from some earlier part of this world's history, slowly weakening while the city gains strength and presses in from all sides.". Understand "path" as simple cobbled paths.

Instead of going down from Memorial Park when Islander Bombing has happened: say "You insert your passcard into the door, but a light flashes red, and the readout displays 'SECURITY LOCKDOWN: ALL ACCESS REVOKED.'". First instead of exiting when location is Memorial Park: try going outside instead. 

Report going from Memorial Park to Plaza: say "[if Plaza is unvisited]Nervously, y[otherwise]Y[end if]ou walk down the cobbled paths towards a wrought-iron archway, and pass through into the swirling center of First City.". Report going from Plaza to Memorial Park: say "You find one of the black iron archways and duck back into the secluded park at the center of the plaza, the city's noise gradually fading away.".

MemorialPark-stuff is stuff in Memorial Park. Understand "park/bush/bushes/bench/lamppost/gate/gates" as MemorialPark-stuff when location is Memorial Park. Understand "park" as inside when location is Plaza.

Chapter  - Plaza

Section - Moving

Table of Cardinal Directions
dir			street		fullstreet			flag
a direction	
north		"Planter"		"Planter Avenue"	0
south		"Teacher"		"Teacher Avenue"	0
east		"Builder"		"Builder Avenue"	0
west		"Mother"		"Mother Avenue"	0

Table of Rebworld Map
dir		depth	room
a direction	a number	an objects
with six blank rows.

The list of rebstreet rooms is a list of objects that varies. The list of rebstreet rooms is {Room1, Room2, Room3, Room4, Room5}.

The rebstreet depth is a number that varies. The rebstreet cardinality is a direction that varies. The rebstreet cardinality is down.

Before going a direction (called way) when location is Plaza or location is a rebelcity-room or location is Room6 (this is the going on rebel streets rule): 
	if way is northeast or way is northwest or way is southeast or way is southwest or way is inside or way is up or way is down, continue the action; [ only dealing with cardinals here. ]
	if the drama manager is being debugged:
		repeat through Table of Rebworld Map:
			say "dir: [dir entry]; depth: [depth entry]; room: [room entry][line break]";
	[going back to plaza]
	if rebstreet depth is 1 and way is the opposite of rebstreet cardinality:
		now rebstreet cardinality is down;
		now rebstreet depth is 0;
		rebmove player to Plaza;
		stop the action;
	[If the direction we're trying to move is at angles to the street we're on, prevent.]
	if location is a rebelcity-room and moving at angles:
		say "The path that direction is blocked by buildings." instead;
	[If we've already assigned this room, move there.]
	repeat through Table of Rebworld Map:
		if ( rebstreet cardinality is dir entry or location is not a rebelcity-room ) and dir entry is way and depth entry is ( rebstreet depth + 1 ) :
			now rebstreet cardinality is way;
			increase rebstreet depth by 1;
			rebmove player to room entry;
			stop the action;
		if ( rebstreet cardinality is the opposite of way or location is not a rebelcity-room ) and dir entry is the opposite of way and depth entry is ( rebstreet depth - 1 ) :
			now rebstreet cardinality is the opposite of way;
			decrease rebstreet depth by 1;
			rebmove player to room entry;
			stop the action;	
	[otherwise, assign.]
	if the number of entries in the list of rebstreet rooms is 0: [bombing]
		if Islander Bombing is happening:[aar]
			if location is crime scene, say "The smoking crater completely blocks further progress down the avenue." instead;
			else say "Heavy barricades block access to that avenue." instead;
		else:
			say "ERROR: no more rooms to assign." instead;
	choose a blank row in Table of Rebworld Map;
	change dir entry to way;
	change depth entry to rebstreet depth + 1;
	change room entry to entry 1 of list of rebstreet rooms;
	remove entry 1 from list of rebstreet rooms;
	let newroom be room entry;
	choose row with a dir of way in Table of Cardinal Directions;
	now the printed name of newroom is fullstreet entry;
	now rebstreet cardinality is way;
	now rebstreet depth is rebstreet depth + 1;
	rebmove player to newroom;
	stop the action.

To decide whether moving at angles:
	if the drama manager is being debugged, say "**rc: [rebstreet cardinality]; n: [noun]**";
	if ( rebstreet cardinality is north or rebstreet cardinality is south ) and ( noun is east or noun is west ) , decide yes;
	if ( rebstreet cardinality is east or rebstreet cardinality is west ) and ( noun is north or noun is south ) , decide yes;
	decide no.


To rebmove player to (loc - a room):
	if loc is Plaza begin;
		say "You return to the [if Islander Bombing is happening]plaza, now eerily deserted, distant wailing sirens echoing around the urban canyon[otherwise]noise and bustle of the City Plaza[end if].";
	otherwise if location is Plaza and Islander Bombing is not happening;
		say "[if Islander Bombing has happened]Walking quickly across the mostly deserted streets[otherwise]Carefully crossing a busy street with a cluster of other pedestrians[end if], you leave the plaza behind and head down the broad avenue.";
	otherwise;
		say "[one of]You continue down the avenue[or]You keep walking along the broad avenue[or]You walk another block down the avenue[or]You keep moving down the street[or]You pass by a dense cluster of squat brown buildings into another block of the avenue[in random order]";
		if a random chance of 2 in 3 succeeds begin;
			if Islander Bombing is happening, say "[one of], the streets empty save for a few figures running into houses and pulling doors tight behind them[or], footsteps strangely loud in the sudden silence[or], passing a smoking piece of concrete incongruously in the middle of the street[in random order]";
			otherwise say "[one of], trailing a clump of shoppers with heavy brown bags[or] under the shadowless light of the overcast sky[or], crossing a small side street after carefully checking for vehicles[or], stepping carefully around a cluster of children playing some complicated game on the sidewalk[or], dodging a stinking pile of garbage overflowing from a wire-mesh cage[or], eyes wide open[or] slowly, stuck behind two men pushing a huge metal box on a tiny wheeled cart[or], after narrowly avoiding one of the boxy cars making a sharp turn into a tiny side street[or], passing a half-block of cobblestone sidewalk that abruptly returns to grey-smeared cement[or], moving faster than the boxy cars on the road which seem to be backed up before some indefinable accident[in random order]";
		end if;
		say ".";
	end if;
	move player to loc.

After printing the name of a rebelcity-room, say "[if Room1], At the Oratorium[otherwise if Room2], At the Library[otherwise if Room3], At the Market[otherwise if Room4], Near the Street Art[otherwise if Room5], Residential District[end if]". After printing the name of Room6, say ", Warehouse District".



The pseudo-plaza is a backdrop. It is in Room1, Room2, Room3, Room4, Room5, Room6, and Room7. Understand "plaza" as the pseudo-plaza. Instead of examining or entering the pseudo-plaza: try going the opposite of rebstreet cardinality.


Section - ambience

The ambience table of Rebelworld-Outdoors is the Table of Plaza ambience.

Table of Plaza ambience
freq		start time	end time	text	table		trigger	flag
frequent	--	--	"With an enormous rumbling, a smoke-spewing train pulling six windowless metal cars flies past on elevated trestles."	--	train
common	--	--	"One of the boxy grey cars comes to a halt, and [one of]two[or]three[or]four[at random] people quickly get out, leaving the hatchway open[if a random chance of 1 in 2 succeeds]. A moment later a pedestrian hops in and, with a cough, the vehicle speeds away[end if]."
common	--	--	"[one of]Muffled shouting come from inside one of the indistinct buildings[or]The sound of children floats down from an open window on an upper story[or]Smells of sizzling meat waft through some window a story above[or]An unpleasant odor lingers for a moment, then is swallowed up again in the general city scent[in random order]."
uncommon	--	--	"[one of]Somewhere a percussive alarm bell rings for a moment, echoing across the plaza before vanishing into silence again.[or]The crowd of pedestrians swells as a group pours out of a nearby building.[or]The boxy vehicles pull to the side as some armored behemoth trundles by.[or]A deep rumbling thrums through the ground for a moment, before being swallowed up by the other noise.[or]A group of children dodge through the pedestrians, the expression on their faces unfamiliar to you, then disappear into the crowd.[or]An old man passes slowly through the crowd, piling discarded litter into a small wheeled cart tugged behind him.[or]Walking slowly, a woman dressed in a great fur coat despite the heat speaks loudly words that your borrowed mind don't bother to translate. Most of the passers-by ignore her.[or]A dozen people in matching red outfits pass quickly by in formation, their gait a strange skipping hop.[in random order]"
rare	--	--	"From a high window above, an old woman throws handfuls of tiny purple squares, which flutter through the air before settling on the ground around you."
rare	--	--	"Two men wearing strange stilt-shoes walk by, frowns on their faces as they scan the crowd warily."
rare	--	--	"A long car drives slowly by, some incomprehensible noise being broadcast from megaphones extending on all sides."

[BUG: Make City ambience happen more often than Lacuna ambience.]

The pedestrians are a backdrop. They are in Plaza, Room1, Room2, Room3, Room4 and Room5. Understand "people/person/pedestrian/crowd/passers-by/passersby/children/man/woman" as pedestrians. The description is "[if Islander Bombing is happening]Only a few people are in the streets now, rushing hurriedly indoors while glancing in fear at the skies[else]Seas of faces, each intent on some important and personal endeavor, passing by almost too quickly to take in: old faces, young faces, angry, oblivious, crafty, annoyed; frightened faces and weary faces and cynical faces and contented faces. They are the faces of all crowds in all cities. In that, at least, this world seems no different from any other you've found[end if].". Instead of attacking pedestrians: say "You [one of]lash out viciously at the crowd[or]strike out a random face[in random order], and cries and gasps ring out. People back away from you nervously."; increase the rap sheet of DrQuick by 3. 

To vague greet pedestrians: say "You approach a[one of]n old woman wrapped in gray, but she[or] tall man in a charcoal suit, but he[or] well-dressed older gentleman, but he[or] woman in a fiery red gown, but she[or] schoolboy in uniform, but he[or] woman dressed in thick green wool, but she[in random order] [one of]ignores you and continues walking[or]ducks into a passing vehicle and doesn't see you[or]walks into a crumbling brick building before you catch up[or]vanishes into the crowd before you can say hello[or]points apologetically to a brass timepiece and hurries on[or]turns to argue angrily with a companion and you pull back awkwardly[in random order].".

The boxy vehicles are a backdrop. They are in Plaza, Room1, Room2, Room3, Room4, and Room5. Understand "car/cars/vehicle" as boxy vehicles. The description of boxy vehicles is "The grey cars are all sharp edges and angles, touched with rust and rumbling with internal vibrations. Tendrils of acrid smoke whisper out from underneath their large textured wheels." Check entering boxy vehicles: say "You approach one of the boxy vehicles, but it speeds noisily away before you reach it." instead.

The train is a set dressing. Understand "windowless" or "metal" or "cars" or "elevated" or "trestles" or "trestle" or "trains" as the train. The description is "The long boxcars are made of hammered metal dulled to a sooty black, covered in dents and rusty seams.". Instead of doing anything other than examining to the train, say "It has already disappeared down a long, narrow avenue."


Section - Scenes

[
A boxy-car is an enterable open undescribed vehicle. It is fixed in place and not openable. The printed name is "boxy vehicle". Understand "boxy/vehicle/car/hatch/hatchway" as boxy-car. The description is "The short, stubby vehicle shudders and grind as it idle, a thin trail of grey-black smoke seeping out from underneath it. The hatchway is open.". Instead of opening boxy-car, try entering boxy-car. Instead of closing boxy-car: say "You rotate the hatchway shut with a squeaking of metal on metal.". After going: remove boxy-car from play.

Report entering boxy-car: say "You duck through the circular hatchway and enter the strange-smelling interior.".

An access slot is in boxy-car. "".

The car interior rule is listed before the room description body text rule in the carry out looking rules. This is the car interior rule: if the player is in boxy-car

]

Table of Panic Plaza ambience
freq		start time	end time	text	table		trigger	flag
common	--	--	"People hurry through the mostly deserted streets, expressions of fear on their faces."
common	--	--	"A group of blue-clad soldiers jog through the streets, heavy weapons on their arms."
common	--	--	"A woman pulls two crying children quickly into an underground shelter."
common	--	--	"Distant shouts and whistles drift through the smoke from some other part of the city."
common	--	--	"The wail of sirens and screams floats through the emptying streets."
common	--	--	"A man stuffs jewelry from a broken store window into his coat pockets, but then turns and flees when he notices you."


The description of Plaza is "[if Islander Bombing is happening]A few military and emergency vehicles gun noisily through the abandoned streets of the plaza, and a few people hurry quickly through the streets, but the plaza is mostly silent now[otherwise]Noise and chaos fill this large circular plaza, ringed with eight- or nine-story [o]buildings[x] and a double set of busy roadways clogged with boxy, smoke-spouting [o]vehicles[x]. [A sentence about the Plaza][end if].[paragraph break][exits]." The exits text of Plaza is "The [d]park[x], half hidden in the center of the plaza, seems like part of another, more peaceful world. [etplaza2]". To say etplaza2: say "[if Islander Bombing has not happened]Four broad avenues run off from the edges of the plaza: signs label them [d]Builder[x], [d]Teacher[x], [d]Mother[x], and [d]Planter[x][otherwise][post bombing streets][end if]". Understand "Builder" as east when location is in Rebelworld and location is not Space Museum. Understand "Teacher" as south when location is in Rebelworld. Understand "Mother" as west when location is in Rebelworld. Understand "Planter" as north when location is in Rebelworld. [This does double duty: both establishes the direction out of the plaza and allows the player to continue along that street/direction.]

To say a sentence about the Plaza: say "[one of][o]People[x] scurry in every direction down sidewalks, up steps, and in and out of buildings[or]The dull roar of urban life washes up and down the concrete and brick of the plaza like a human tide[or]Steam rises from vents in the gutters and vendors call out to oblivious [o]pedestrians[x][or]Electric traffic lights make sharp buzzing hisses as they switch clunkily from one signal to another[or]Dirt and debris swirl in invisible eddies as the wind gutters through the plaza[in random order]".

To say post bombing streets:
	say "Heavy barricades block ";
	let myctr be 0;
	repeat through Table of Cardinal Directions:
		if flag entry is 0:
			if myctr is 0:
				say "[street entry] and ";
				now myctr is 1;
			else:
				say "[street entry] Avenue";
	say ", while ";
	now myctr is 0;
	repeat through Table of Cardinal Directions:
		if flag entry is 1:
			if myctr is 0:
				say "[d][street entry][x] Avenue and ";
				now myctr is 1;
			else:
				say "[d][street entry][x] Avenue";
	say " remain open".

To say shortrebname of (loc - a room):
	if the printed name of loc is "Builder Avenue" begin; say "Builder";
	otherwise if the printed name of loc is "Teacher Avenue"; say "Teacher";
	otherwise if the printed name of loc is "Planter Avenue"; say "Planter";
	otherwise if the printed name of loc is "Mother Avenue"; say "Mother";
	end if.

Some barricades are a setpiece. The description is "Temporary military barricades bristling with barbed wire and sharply worded 'Keep out' signs.". Instead of climbing or pushing or attacking barricades, say "They are bristling with barbed wire; in this borrowed body, you'd better not.".

[TODO: Add cross-street workings. ] [TODO: Add "arbitrary" north/south.]

A rebelcity-room is a kind of room. The exits text of a rebelcity-room is usually "[etrcr]".

To say etrcr:
	if Islander Bombing has happened and location is crime scene, say "Progress farther down the avenue is blocked by a flaming crater; only the way back towards the [d]plaza[x] is clear";
	otherwise say "[if rebstreet depth is 1]The [d]plaza[x] is visible a short distance away, while opposite, [keyword-name-reb-location] continues[otherwise][keyword-name-reb-location] continues further into the city, away from the distant [d]plaza[x][end if]". 

To say keyword-name-reb-location:
	repeat through Table of Cardinal Directions begin;
	if fullstreet entry is printed name of location, say "[d][street entry][x] Avenue";
	end repeat.




Section - Buildings

The buildings are a backdrop. They are in Plaza, Room1, Room2, Room3, and Room4. Understand "building" as buildings. The description is "Mostly brick, mostly eight or nine stories high, and mostly grey or tan, the buildings crowd together closely against the wide streets with few windows but many entrances. Narrow alleyways strewn with rubbish stretch back into dimness beside each one; many have steep concrete steps with wrought-iron railings running up to [o]doors[x] on the second or even third level up.". Check climbing buildings: say "You wouldn't be able to get a grip on the grimy concrete." instead. Check going up when buildings are enclosed by location: try entering buildings instead.

The reb-doors are a backdrop. They are in Plaza, Room1, Room2, Room3, and Room4. Understand "door/doors/entrance/entrances/window/windows/lock/locks" as reb-doors. Does the player mean doing something to reb-doors: it is unlikely. The description is "The buildings have more doors than it seems they strictly need, of all shapes and sizes.". Instead of entering or opening or using reb-doors: try entering buildings. Check closing reb-doors: say "Already shut." instead. Instead of attacking reb-doors: try attacking buildings. Instead of knocking reb-doors: try knocking buildings. Instead of vague unlocking reb-doors: try vague unlocking buildings.

To pick a random rebel door: 
	say "You pick a [one of]small[or]mid-sized[or]large[or]older-looking[or]newer-looking[at random] [one of]grey[or]tan[or]soot-black[or]darkish yellow[or]beige[as decreasingly likely outcomes] [one of]brick[or]concrete[as decreasingly likely outcomes] ";
	say "building, [one of]walk up a set of narrow steps[or]walk down a few flat stairs[or]step up[or]step up a single large stair[or]pass through a tiny covered foyer[at random] to a [one of]tiny[or]paint-drowned[or]elegant old[or]graffiti-strewn[or]splintered[or]double-wide[or]tall[at random] door".

Instead of going or entering buildings:
	pick a random rebel door;
	say ", and try the handle. ";
	say "[one of][noonehome][or][noonehome][or][papersscene][or][noonehome][stopping].".

To say noonehome: say "It's locked. [one of]You move back to the sidewalk[or]You jiggle the handle once again before heading back to the street[or]From a window above you, you see a [random voyeur] scowling down at you, so you beat a hasty retreat back to the street[or]You are about to try again when you spot a uniformed man down the street heading your direction; quickly, you step away from the door[as decreasingly likely outcomes]".

To say papersscene: say "The door opens on a cramped apartment, and a frightened old woman hovering over a stove with a saucepan in her hands.[paragraph break]'What do you want?' she mutters fearfully, then catches sight of your uniform. 'Papers? You need to see my papers?' Her hand trembles, the pungent sauce in the pot shaking crazily as she sets in back on the counter. She quickly rummages through a door and comes up with a handful of documents, which she thrusts into your hands. But some uniformed guards are coming down the street in your direction, so you quickly return the papers to the old woman and shut the door".

To say random voyeur: say "[one of]suspicious old woman[or]wide-eyed young girl[or]bearded man[or]frightened young woman[or]blank pudgy face[in random order]".

[To say burglarcaughtscene: say "A burly uniformed man stands behind you, gripping your arm tightly. 'I've been watching you,' he says unpleasantly, 'and even though you've got a fancy uniform, I don't think you're cleared to bother random citizens. You're going to have to come with me."; print a section break; move player to Holding-Cell.]

Instead of knocking buildings, try vague knocking. Instead of vague knocking when buildings are visible:
	pick a random rebel door;
	say ", and knock [one of]sharply[or]three times[or]twice[at random]. ";
	if a random chance of 10 in 10 succeeds or Islander Bombing has happened begin;
		say "You wait for some time, but there is no answer.";
	otherwise;
		do nothing;
		[ UNFINISHED: Write a scene or two here. ]
	end if.

Instead of opening buildings, try entering buildings. Instead of vague unlocking buildings, say "The lock seems quite solid, but the door itself seems weak and would probably give easily to a solid attack.".

Instead of attacking buildings for the first time:
	increase the rap sheet of DrQuick by 2;	
	say "Glancing cautiously around to be sure no one is paying attention, you step back and then smash the door with your shoulder. The wood splinters and the door gives. Reaching inside, you slide open the lock and slip quickly inside.";
	now former location is location;
	move player to Apartment.

Instead of attacking buildings for at least the second time: say "Some black-suited police types are strolling nearby, keeping an eye on you. You'd better not.".

Apartment is a room in Rebelworld. The description of Apartment is "Colorless light filters through a single small paned window into this tiny apartment, odors of distant mildew and unwashed dishes hovering faintly in the air like ghosts.[paragraph break]A large wooden [o]cabinet[x] with dials and a pull cord is placed prominently in the room, in front of a faded, frayed [o]rug[x]. Tucked in a corner is a small [o]fireplace[x], a [o]pad[x] of paper hanging next to it on the wall. [exits].". The exits text of Apartment is "The only way out is [d]back[x] to the street". First Instead of exiting when location is Apartment: try retreating.

The radio is an undescribed device in Apartment. It is fixed in place. The printed name is "wooden cabinet". Understand "wood/wooden/cabinet/radio" as radio when location is Apartment. The description is "Almost as tall as you are, the imposing wooden cabinet is ornately stained and decorated. Three silver [o]dials[x] on the front are set to inscrutable numbers running around their edges, while a chain pull [o]cord[x] extends from the side.". First Report switching on the radio: say "You pull the chain until something plunks inside the wooden cabinet. A whir, a hum, and then pulsating static echo inside the cabinet, before finally resolving into recognizable sound." instead. First Report switching off the radio: say "You pull the chain again. The music fades slowly into muffled silence, a high-pitched whir from inside the cabinet winding down through subsonic tones and then away." instead. Instead of listening when location is Apartment: try waiting. The examine described devices rule is not listed in any rulebook.

Every turn when the radio is switched on and location is Apartment: say "[one of]The cabinet emits a strange tinny sound which finally resolves in your mind to a strange form of music. Frenetic, chaotic, it uses such a wide variety of instruments and contradictory tonal patterns that at first it is overwhelmingly incomprehensible.[or]Gradually, you begin to adapt to the strange music. You can start to pick out a melody line that, despite the chaos around it, is surprising in its simplicity.[or]The strange symphony continues, building in ululating runs and crescendos towards a climax.[or]The music reaches a cacophonous climax, holding an imbalanced chord before abruptly falling silent.[or]'Summer grass summer weed, within the summer sun,' a tinny voice from the cabinet says thrillingly. 'Teacher Frosthair. Once again, once again.'[or]Two discordant notes sound mutedly from the cabinet, twining gently around each other, sustaining.[or]The two notes are joined by others, one strange instrument at a time adding its voice to the musical palette.[or]The strange music continues to blare tinnily from the cabinet.[stopping]".

The three silver dials are part of the radio. They are minor. The description is "You are hesitant to adjust the dials without knowing what they are for.".

The chain pull cord is part of the radio. Instead of pulling chain pull cord when radio is switched off, try switching on the radio. Instead of pulling chain pull cord when radio is switched on, try switching off the radio.

A faded rug is a setpiece in Apartment. The description is "Though well-worn and threadbare, you can still faintly make out a stylized pattern on the rug, showing a foot pulling itself free from vicious entangling roots.".

The apartment-fireplace is a setpiece in Apartment. Understand "fire/fireplace" as apartment-fireplace when location is Apartment. The printed name is "small fireplace". The description is "The fireplace is built into the wall, but seems too small to be used for heat or cooking. On a hook next to it is a small [o]pad[x] of newsprint and a stubby pencil. You notice burnt [o]scraps[x] of paper scattered in the ashes of the fireplace". Understand "light [apartment-fireplace]" as a mistake ("Probably best not to make yourself too at home.").

Some burnt scraps of paper are a minor prop in Apartment. The description is "Kneeling to the ground, you peer at a few of the burnt scraps curiously. Most are completely incinerated, but you can catch a few scraps of writing here and there: '...tell me what to...' '...can't choose oh help...' '...mother were here she...' '...be strong I must be...' '...my mind. Who can I...'". 

A pad of newsprint is a minor prop in Apartment. Understand "stubby/pencil/paper/hook" as pad of newsprint. The description is "The small pad rests from the wall on a ceremonial hook; about half the pages are gone. The stubby pencil is attached to it by a looped piece of black string.".

Instead of retreating when location is Apartment: say "You slip back outside into the city streets."; move player to former location.

Breaking-And-Entering is a scene. Breaking-And-Entering begins when location is Apartment. Breaking-And-Entering ends when location is not Apartment.

BAE-fate is a number that varies. BAE-fate is -3.

Every turn during Breaking-And-Entering:
	increase BAE-fate by 1;
	if BAE-fate > 0 and a random chance of BAE-fate in 12 succeeds and Burglar-Busted has not happened begin;
		move angry renter to location;
		say "Suddenly the door swings open, and a middle-aged [o]man[x] wearing wire-rim spectacles and a furious frown barges in.";
	end if.

Burglar-Busted is a scene. Burglar-Busted begins when angry renter is in location. Burglar-Busted ends when location is not Apartment or angry renter is not in Apartment.

When Burglar-Busted begins: try greeting angry renter.

The angry renter is a man. "An angry [o]man[x] in a dull red sweater stands near the door, furiously staring you down." Report greeting angry renter: force discuss bbust-intro instead. Understand "man" as angry renter.

BBUST is a thread. bbust-intro is a beat in BBUST with reaction "'What are you doing, in Builder's sight?' he shouts in a reedy, high-pitched wail. 'Who do you think you are, coming in here? What...' He catches sight of your uniform and trails off. 'What is this?' he says, more weakly. 'I haven't done anything wrong. Am I-- are you with the Force?'". Instead of saying yes or saying maybe when last beat is bbust-intro: force discuss bbust_force. Instead of saying no when last beat is bbust-intro: force discuss bbust_noreply2. bbust-intro suggests bbust_noreply. bbust-intro summons bbust_force, bbust_noreply2. bbust-intro summons bbust_force, bbust_noreply2.

bbust_force is a beat in BBUST with keyword name "yes" and reaction "His eyes widen, and he takes a half-step back, putting a hand to his chest. 'I've done nothing!' he cries, 'nothing! What, is this because I went to hear that Greeneyes [t]sympathizer[x] speak last winter? I didn't like him, didn't want to go. Wrote a letter to the Spirit denouncing him afterwards. I'm not a sympathizer, not!'". bbust_force summons bbust_sympathizer. bbust_force suggests bbust_noreply. bbust_force cancels bbust_dontbelieve.

Understand "greeneye/greeneyes/sympathizer" as bbust_sympathizer when last beat is in BBUST. bbust_sympathizer is a beat in BBUST with keyword name "sympathizer" and reaction "'Abhorrent philosophy,' the man says, nodding vigorously, 'we can't survive without leaders. It's different, can't they see that? Not the leaders that are bad but that we weren't them; the Forest were leaders, not us. Now we lead ourselves. Don't they see? Greeneyes, bah,' he spits. 'Not for me! Not for me! Please, you believe me, don't you?'". The yes-beat of bbust_sympathizer is bbust_believe. The no-beat of bbust_sympathizer is bbust_dontbelieve. bbust_sympathizer suggests bbust_dontbelieve. bbust_sympathizer summons bbust_believe, bbust_dontbelieve.

bbust_dontbelieve is a beat in BBUST with keyword name "no" and reaction "He pales for a moment, then straightens a bit, thought not quite out of a cower. 'Then please, I need to see your [bbust_passcard],' he says. 'My rights.'". bbust_dontbelieve enqueues bbust_noreply. bbust_dontbelieve cancels bbust_force.

bbust_believe is a beat in BBUST with keyword name "yes" and reaction "He smiles, tension fading from his shoulders. 'Oh, yes, oh, of course yes. Thank you. Yes. Then you'll go, if you don't mind. Or if not I'll need to see your [bbust_passcard]. My rights.'". bbust_believe suggests bbust_noreply. bbust_believe summons bbust_passcard.

Instead of showing passcard to angry renter, force discuss bbust_passcard. Instead of giving passcard to angry renter, force discuss bbust_passcard. Understand "credentials" as bbust_passcard when last beat is in BBUST. bbust_passcard is a beat in BBUST with keyword name "credentials" and reaction "You hold out the passcard around your neck to the small man's squinting eyes. He studies it for a moment, then shoves his spectacles back up your nose with a sniff. 'Top scientist,' he says, 'no Force privileges. You can't be here, then. Not your right. I should report you. You'd best [bbust_leave] now, before, before I get angry.'". bbust_passcard suggests bbust_noreply2.

bbust_noreply is a beat in BBUST with reaction "'Now, now, answer me!' the man says, stepping forward [if radio is switched on]and switching off the radio[otherwise]timidly into the room[end if]. 'I'm entitled. Under Builder's Law I'm entitled if you're with the Force, to know your letters and see your [bbust_passcard]. I'm entitled, entitled!' He quivers indignantly before you.". bbust_noreply suggests bbust_noreply2. bbust_noreply2 replaces bbust_noreply. After discussing bbust_noreply: now radio is switched off. bbust_noreply summons bbust_passcard.

bbust_noreply2 is a beat in BBUST with keyword name "no" and reaction "'Now, well that's it,' the man says, his voice rising to a high-pitched squeal. 'I'm calling the Force. You can't do this, can't. I'm entitled.' He backs fearfully up to the door and calls 'Help! Help! Burglary, help!'". bbust_noreply3 replaces bbust_noreply2. bbust_noreply2 suggests bbust_noreply3.

bbust_noreply3 is a terminal beat in BBUST with reaction "'Help!' the man continues to cry. 'A burglary, burglary, help!'". After discussing bbust_noreply3: now the rap sheet of DrQuick is 10.

Instead of attacking angry renter: say "You tackle the man, who collapses feebly to the ground, crying 'Help, help!' He batters at you ineffectually, eyes rolling back in his head as he appears to go into some sort of panic attack."; now rap sheet of DrQuick is 10.

Instead of retreating when Burglar-Busted is happening and ( we have not discussed bbust_passcard and we have not discussed bbust_noreply2 and we have not discussed bbust_noreply3 ) : force discuss bbust_leaveearly. bbust_leaveearly is an ephemeral beat in BBUST with reaction "'Wait now just a slim there,' the man says, stepping in your path and holding out a hand. 'I have explanations to hear.". bbust_leaveearly2 replaces bbust_leaveearly. bbust_leaveearly2 is a terminal beat in BBUST. After discussing bbust_leaveearly2: force discuss bbust_leave; remove angry renter from play; try exiting. Before retreating when location is Apartment and we have not discussed bbust_leaveearly2: force discuss bbust_leave; continue the action.

bbust_leave is a terminal beat in BBUST with reaction "'Your superiors will be hearing about this!' the man cries weakly after you as you slip past him and out into the street.".




Section - The Oratorium

To say a sentence about a rebelcity room: say "[one of]A hot wind blows down the street, loose papers and flecks of debris swirling in its wake[or]Lines of laundry stretch from building to building across dim cramped alleyways[or]Chalk drawings run down the sidewalk[or]The buildings here are covered with inscrutable graffiti[or]Tiny well-tended flowerpots fill the windows of the endless row houses[in random order]".

Room1 is a rebelcity-room. The description of Room1 is "A large civic building adjoins the street here, fading letters inscribed above its high doorways: 'CITY ORATORIUM.' A printed [o]notice[x] stands near the doorway leading [d]in[x]. [paragraph break][exits].".

The printed notice is a setpiece in Room1. The description is "The notice is set in a heavy, official typeface. It reads as follows:

---------------------[line break]
Schedule of Discussions for the CITY ORATORIUM

TO-DAY[line break]
Closed for cleaning

TO-MORROW[line break]
Hour the 1st -- Builder Strongarm -- 'Is Beauty Definable?'[line break]
Hour the 2nd -- Planter Feathertouch -- 'Dealing with Authority Addiction'[line break]
Hour the 3rd -- Builder Longleg -- 'How should we better prepare for a greeneyes attack?'[line break]
Hour the 4th -- Farmer Grace -- 'An Idea for Safer Electric Streetlights'[line break]
Hour the 5th -- Thinker Blackhair -- 'Nature of Man v. Beast, part 3'[line break]
Hour the 6th -- Planter Thinblood -- 'Should we form a committee opposed to tree sympathizers?'[line break]
Hour the 7th -- CANCELLED -- Curfew[line break]
Hour the 8th -- CANCELLED -- Curfew[line break]
Hour the 9th -- CANCELLED -- Curfew

Orators will please yield the floor at the end of the assigned hour and move your discussions to the foyer. Requests for usage must be received at City Office by Hour the 3rd the day prior to your discussion.[line break]
---------------------".

Instead of going inside when location is Room1, say "The large doors are barred shut. Peering inside, you can see a large circular amphitheater, surrounded by empty benches, empty save for a few cleaners and their supplies.".

The Oratorium is a minor setpiece in Room1. Understand "building/large/civic/doorway/doorways/door" as the Oratorium. The description is "The building looks old, yet grand.". Instead of entering or opening Oratorium, try going inside. First instead of vague knocking when location is Room1: say "You knock on the heavy stone doors, but there is no response." instead. Does the player mean doing something to Oratorium: it is likely.


Section - The Library

[ {The library. Here, upon entering, the player is recognized as the famous scientist and given the books he had reserved. One is on the emerald crystals, and their fantastic property to communicate even over impossibly great distances. The Treeworld used up their entire supply. The book also mentions that the crystals are somewhat radioactive, and prolonged exposure to them produces identical symptoms to those suffered by Progue.} ]

Room2 is a rebelcity-room. The description of Room2 is "The avenue is well kept here, outside an old stone building lined with fluted columns. A short flight of [d]steps[x] leads up to its entrance, and a chiseled [o]inscription[x] runs along the top of the building.[paragraph break][exits].". Understand "steps" as library-room when location is Room2.

Report going from Room2 to library-room: say "You crest the worn stone steps and pass through a set of heavy wrought-iron doors into a dim, cool, airy interior.". Report going from library-room to Room2: say "You push the heavy doors open and emerge into the noise and chaos of the city.".

The library-facade is a setpiece in Room2. The printed name is "library". Understand "steps/library/building" as library-facade when location is Room2. Instead of doing anything to library-facade, try going inside.

The chiseled inscription is a setpiece in Room2. The description is "TO THOSE WHO NAMELESS FOUND NAMES, HOMELESS MADE HOMES, AND TREELESS, GREW.[paragraph break]BUILDER TALL[line break]COUNTER QUICK[line break]\/\/\/\/\/\/\/\/\[line break]MOTHER ROSEHAIR[line break]PLANTER LONGSTRIDE[line break]HUNTER KEENSIGHT[line break]TEACHER GRACE[line break]HEALER GOLD[line break]SPEAKER SWIFTTONGUE[line break]TENDER SHARPEARS[line break]AND TWO WHO DIED CHILDLESS AND NAMELESS[paragraph break]There is a gap in the list of names, as if one has been removed." Understand "gap/list/names/missing/name" as chiseled inscription.

Instead of going inside from Room2 when Islander Bombing is happening: say "The doors to the library are shut and barred.".

The Library-room is a room. The Library-room is inside from Room2. The printed name of Library-room is "Library". The description of Library-room is "Light filters in through high windows, illuminating shelves of books and rows of wood tables. The sounds of the city are muffled in this space.[paragraph break]An elderly [o]man[x] with spectacles sits reading behind a desk, next to a wooden table[if the number of things supported by wooden table > 0], on which rests [a list of things on wooden table][end if].[paragraph break][exits].". The exits text of library-room is "Dust motes dance in a beam of grey light pouring through the wrought-iron doors leading [d]back[x] outside".

A wooden table is an undescribed supporter in Library-room. Understand "tables" as wooden table. 

A reb-librarian is an undescribed man in the library-room. Understand "man/librarian/elderly" as reb-librarian. The printed name of reb-librarian is "elderly librarian". The description is "Perched on a high, straight-backed chair, he slowly scans through an enormous grey tome, squinting through spectacles on a long brass chain.". Understand "elderly" or "man" as the reb-librarian. After greeting a reb-librarian: say "[one of]The old librarian looks up at you. 'Oh, Doctor Quick,' he says, 'your books are ready.' He retrieves a stack of [o]books[x] and sets them on a wooden table, as well as a small green [o]slip[x]. The last he taps with a pained sigh. 'One of them was confiscated just this morning,' he says sadly, 'apologies.'[or]He looks up in distraction. 'Sorry, doctor,' he says, 'can't chat right now... I've got reams of paperwork to handle.'[stopping]"; post-conversation processing; move the crystal-book to the wooden table; move the green slip to the wooden table; move other-book to wooden table; move stack-of-books to location; now wooden table is described. 

A stack-of-books is a prop with printed name "stack of books". Understand "stack of books" or "stack/books" as stack-of-books. The description is "A large, well-bound [o]textbook[x], a bound [o]periodical[x], and a small green [o]slip[x] are stacked on the table.". Check taking stack-of-books: say "You're not sure if you're allowed to take them with you. Better read them here." instead. Instead of doing something other than examining or examining by name to stack-of-books: say "[as the parser]You'll need to specify what book to do that to[as normal].".

Instead of attacking reb-librarian: increase the rap sheet of DrQuick by 3; say "The librarian staggers back under your attack, gives out a cry, then darts from the room in a panic."; remove reb-librarian from play.

The green slip is a prop. The description is "The small green slip is a form, which indicates that a book called 'The Testimony of Weaver Greeneyes' was removed from the library on today's date for 'containing seditious and treasonable material aiding the enemy.'".

Instead of taking a book when location is Library-room, say "You're not sure where you'll be heading next, so you may as well read them here.".

A crystal-book is a book. The printed name is "large, well-bound textbook". Understand "textbook" or "large" as crystal-book. The description is "The book is titled 'A Scientific, Technical, and Medical Analysis of Somenium Carcerate Six, Based on Original Research and Data Stolen From the Great Forest Link, by Hunter Smoothfaced.'". The contents of crystal-book is Table of Crystal-book Contents.

An other-book is a book. The printed name is "bound periodical". Understand "bound" or "periodical" as other-book. The description is "This small volume is bound with a cardboard cover stenciled in black ink. The cover contains an ornately decorated title taking up half the page reading 'Spirit Of City' in a bold and elegant script, surrounded by curved fabric banners and stone columns and a noble woman in drapery peering off into the distance. Underneath the title in smaller print it says 'Year 21 Issue 4,' and beneath that, 'Why We Are Right: Tender Frosthair On The Folly Of The Greeneyes.'". The contents of other-book is Table of Art-Book Contents.

Table of Art-Book Contents
desc
"The interior of the magazine consists mostly of small, blurred type in narrow columns, with few illustrations. The title story is a massive essay which seems to be justifying the actions of City's government in some sort of open-ended war. A representative paragraph:[paragraph break]'But this is precisely where Leader Greeneyes and his deluded followers have always been wrong. They know as much as we how precious a commodity is land on our world; what a narrow strip of equatorial ground deigns to support life and crops here. The subcontinent they have claimed for their perverted society is not theirs by right, as their diplomats would claim, and nor is their occupation of it justified. For where are our grandchildren to live, once our lands are filled?'"
"A full-page message in an officious font runs below a bold heading reading 'Important Information About The Curfew':[paragraph break]Citizens-- In this time of warfare and uncertainty, there are certain sacrifices we all must make. As you are no doubt aware, I have recently signed a Will extending the temporary curfew beginning nightly at Hour the 7th indefinitely. This gives me no great pleasure, and were there any other method to secure the safety of our City, I would pursue it. But my intelligence officers inform me that Greeneye agents are at large in the city, holding secret meetings and plotting to overthrow our government and invade our territory. I cannot and will not allow this to happen. Please do your part and abide by the curfew. I have full confidence in our soldiers and Force, and know in my heart we will prevail in this struggle. Thank you.  ----Leader Tall."
"A series of articles under the banner 'Thought and Counter-Thought' argue two sides of various issues, including 'Are street games a Detriment to our Children's Education?', 'Should more be Spent on Greeneyes protection?', 'Should our Artists be Subsidized?' and 'Does Leader Tall deserve Another Term of Office?'"
"A section entitled 'Dramaturgical Review' contains passionate, long-winded reviews about a series of 'enactions' playing at City Theatre:[paragraph break]'The Long Night of Mother Rosehair' is a historical piece praised for its authentic costumes and realistic performance by 'one of Mother's most talented descendants.'[paragraph break]'Think' receives low marks from the reviewer, who says that 'audiences are beginning to tire of being asked to participate in every second-rate enaction in town,' but does admit the performers 'do a fine job at engaging the crowd in a rousing discussion of modern philosophical theory.'[paragraph break]'The Cold White Stars, Part One' is a 'rather implausible' story of bold future explorers on a mission to a strange and far-off planet, but the reviewer says it does manage to awaken 'a spirit of adventure,' and that he encourages readers to attend and 'fund the author to write the second installment.'[paragraph break]'Twirl the Window Wares,' making its 'triumphant return,' is apparently a more experimental enaction involving 'musicians, technicians, animals, and seven poets' that 'captures the heart and soul of this reviewer and the audience once again,' and is 'even more poignant and relevant today than upon its initial enaction.'"
"The back of the periodical is a jumble of ink-smudged ads, only their bolded title lines standing out: 'Seeking Boarders,' 'Used cookware: fine quality,' 'Learning School Accepting Students,' 'Serve Your City: Join The Force,' 'Quality Books and Papers,' 'City's Finest Meals,' 'War Bonds,' and more."

Table of Crystal-book Contents
desc
"The first page of the book begins a general introduction, identifying somenium carcerate six as the substance which enabled the windsigh (windsigh, though some part of your borrowed mind hints the original word is a great deal less poetic and flattering) to communicate over 'seemingly limitless' distances. 'The scientific reasons for this still, after much research, remain obscure,' the author writes. 'But it seems clear that somenium creates or amplifies some as-yet unmeasured bond between individuals, allowing thoughts and connections to be forged regardless of distance between the subjects.'"
"The next marked page contains a sketch showing columns of hexagonal material, turning to powder at their worn edges. The caption explains that it is a rendering of what the somenium crystal must look like in its natural state, and that in solid form it would have a rich, sea-blue hue."
"The next marked page is the end of a lengthy chapter on somenium's rarity, and concludes, 'The best data available indicate that, despite their ever-so-learned and wise nature, the Trees in the Heart of Forest did indeed use up every last atom of somenium carcerate hidden on their world. Perhaps they simply assumed the mineral was common throughout the galaxy; perhaps it was mere arboreal stupidity; but at any rate, the All-Forest has discovered no more on any world they've conquered, leaving their further plans for expansion-- and ours-- in tatters.'"
"After a long series of technical writing, including molecular diagrams, you come to a chapter on biology, which includes this marked passage: 'As the sixteen milligrams of somenium saved from the egg ship are at work now in an important government project, it seems likely that the work of Builder Wideeyes and Mother Rosehair will be the only medical studies done on somenium for the near future. Despite the problems with their research, the conclusions in general seem clear: when exposed to large quantities of somenium, subjects experience symptoms of dementia, susceptibility to suggestion, and memory loss-- but not of any memories connected to the somenium itself. It is as if their connections to everything except the somenium, including their own sense of self, begins to fade.'"


Instead of dropping a book when location is library-room: say "You set it on the wooden table."; move noun to wooden table.

After going from library-room: move the crystal-book to the wooden table; move the green slip to the wooden table; move other-book to wooden table; continue the action. 


Section - The Historian and the Market

Room3 is a rebelcity-room. The description of Room3 is "The buildings here are in poorer repair, the streets dirtier. Tiny shops cram the sidewalk here, [if Islander Bombing is happening]now suddenly shuttered and silent[otherwise]throngs of people going in and out[end if]. [A sentence about a rebelcity room].[paragraph break]A small dark [d]alley[x] cuts down a trash-strewn street. [exits].". Understand "alley" as inside when location is Room3.

The historian is a person in Room3. "[if histdone is true]Sitting[else]Standing[end if] on the street corner is [if Room3 is unvisited]a man you take for a [o]beggar[x][otherwise]a [o][historian][x][end if][if histdone is false], orating in a booming voice[end if].". Understand "beggar/begger" or "man" as historian. The printed name is "beggar". The description is "Dressed in a strange costume of fraying old clothes and patches of rag, the [historian] seems oblivious to the pedestrians passing by him[if histdone is false]: he orates in a loud, clear voice, gesturing dramatically into the air as he speaks[else if historian is attentive]: he gives you his full attention[end if].".

Before going when historian is attentive: post-conversation processing; if last beat is in HC, say "'May your thoughts be free,' he says as you leave.".

The cup is an open undescribed container in Room3. It is not openable. Check taking the cup: say "That belongs to [the historian]." instead. Check taking something enclosed by the cup: say "That belongs to [the historian]." instead. Instead of inserting something uncoinlike into the cup, say "Probably the only thing he wants in there is money.". Definition: a thing is uncoinlike if it is not a coin.

Instead of greeting historian when Historian Conversation is not happening and histdone is false: say "He smiles and nods to you, but continues speaking.". Instead of greeting historian when Historian Conversation is not happening and histdone is true: say "He smiles at you. 'Your historian's just taking a break for a moment, since business is slow,' he says in a friendly tone, stretching and somehow managing to discreetly draw your attention to his cup, filled with a handful of coins.". Instead of greeting historian: force discuss hc_who.

[6 / 4 / 4 / 7]

Every turn when location is Room3 and historian is idle and historian is enclosed by Room3: say "[one of]'But cried she not with tears, poor Widow Tall,' he says, 'poor Widow Tall through long nights['] storm and mourning, 
And Weaver's eyes were blind, put out by flame, put out by flame in Builder's last endeavor.'[or]The [historian] continues: 'So blinded was he shunned and cast away, and cast away by all those then remaining,
And cried at last the sky in ceaseless rain, in ceaseless rain did Greeneye's old ties sever.'[or]The [historian] continues: 'Alone he sailed away did Weaver Green, did Weaver Greeneyes vanish into Ocean,
But stayed he not alone in years to come, in years to come when cowards sought him ever.'[or]The [historian] continues: 'And Widow Tall was left alone to mourn, alone to mourning and her children's tending; The mourners in the town wept tears for her, wept tears for her, whose own eyes did not quiver.'[or]The [historian] continues: 'For from her grief great thoughts began to form, began to form like rainclouds all a'storming.
And so she called on one she trusted strong, she trusted strong her ally Quick the Counter.'[or]The [historian] continues: 'She asked him for a quill and precious ink, and precious ink and page to be inscribed on.
And Counter Quick said, [']But, my Widow Tall, my Widow Tall, the ink is frozen over.[']'[line break][or]The [historian] continues: 'And Widow Tall replied, [']Then make a flame, then make a flame, my Counter Quick, and quickly.
My Builder's words remain. I must write soon, I must write soon to save his words forever.[']'[line break][or][historydone]The [historian] bows to no one in particular, sits on the curb, and begins smoking a small pipe reflectively.[or][stopping]". histdone is a truth state that varies. To say historydone: now histdone is true.

Instead of giving a coin to historian: say trygivingcoin.

To say trygivingcoin: 
	if the player holds at least one coin:
		if the historian is visible:
			move a random coin held by player to cup;
			now historian is attentive;
			force discuss hc_intro;
		else if the hopper is visible:
			try inserting a random coin held by player into the hopper;
		else:[aar]
			let bob be a random visible other person;
			if bob is a person:
				try giving a random coin held by player to bob;
			else:
				say "You aren't sure how to spend your money here.";
	else:
		say "You don't have any coins left.".

Understand "toss coin" or "add coin" or "throw coin" or "throw coin to/in/at cup" as a mistake ("[trygivingcoin]").

Instead of exhausting when historian is enclosed by location: say "'We've done that one already, haven't we, friend?' he says.".

Historian Conversation is a recurring scene.

Historian Conversation begins when
	a coin is in the cup and historian is enclosed by location and historian is attentive.

Historian Conversation ends when
	historian is idle.

To historian cashes in:
	remove a random coin enclosed by cup from play.

[The historian has full conversations for Weaver Greeneyes and Builder Tall. There are two other conversations which can randomly be assigned to other colonists requested. (The number of stories is limited by the coins the player carries.) In the rare case a third non-key figure is requested, the historian can refuse the coin, saying he's packing up to go.]

HC is a thread.
hc_intro is a repeatable beat in HC with reaction "The old man nods to you. 'Many thanks for helping out a poor historian, sir,' he says.". hc_intro enqueues hc_who. After discussing hc_intro: change the printed name of historian to "historian"; continue the action.

hc_who is a repeatable beat in HC with reaction "[one of]He chuckles. 'You're a little old, aren't you? But no, one's never too old for history. Well then. [or]'Good to see you again,' he says. 'Now then. [stopping]Who would you like to [hc_who2]?'". hc_who suggests hc_who2. hc_who summons hc_builder1, hc_rosehair, hc_greeneyes.

Understand "meet" as hc_who2 when last beat is in HC. hc_who2 is a repeatable beat in HC with keyword name "meet" and reaction "'Builder [hc_builder1], maybe?' he suggests. 'Always a favorite. Or what about old Mother [hc_rosehair] and the river?'".

First carry out getting bored during Historian Conversation: say "'My pardon,' the historian says cordially, '[if histdone is true]I'm going to get back to my break, if you don't mind.' He sits back down, knees cracking noisily, and sighs.[otherwise]I need to get back to work.'[end if]" instead.

Understand "builder tall" or "builder/tall" as hc_builder1 when last beat is in HC. hc_builder1 is a beat in HC with keyword name "Tall" and fuse 6 and reaction "'Ah,' he says, 'an old favorite. Well, then, have patience. He'll be with you in just a moment.'[paragraph break]The historian bows his head and shifts from foot to foot for a moment, rubbing his hands together.[paragraph break]When he raises his head, he seems like a different person: taller, stronger, more confident. 'The [t]winter[x] has been long and hard, Planter,' he says wearily. 'Please say you bring me news of [t]spring[x].'". hc_builder1 cancels hc_rosehair, hc_greeneyes, hc_who2. hc_builder1 summons hc_bplanter. After discussing hc_builder1: historian cashes in; continue the action.

Understand "winter/spring" as hc_bplanter when last beat is in HC. hc_bplanter is a terminal beat in HC with keyword name "winter, spring" and reaction "Over the course of the next few minutes, you speak with 'Builder Tall'-- at least this historian's rendition of him. You learn a lot about the man who seems to have been the foundation of this society: a man who was willing to lead when none of his companions dared to, and through action and decision saved the life of the struggling, treeless survivors.[paragraph break]Finally, the historian makes one last eloquent pronouncement, then stops and smiles at you, doffing his cap. 'Thanks, friend,' he says.".

Understand "mother rosehair" or "mother/rosehair" as hc_rosehair when last beat is in HC. hc_rosehair is a beat in HC with keyword name "Rosehair" and fuse 6 and reaction "'Yes,' he says, smiling, 'an old favorite. Just a moment, then, let me wake up old Mother for you.'[paragraph break]He bows his head and flexes his fingers, breathing slowly for a long moment.[paragraph break]When he raises his head, he suddenly seems different: old and wiry, but with wits and eyes of steel, and his voice is the warbling alto line of an elderly woman. 'Good of you to visit an old widow, [t]Counter[x],' the historian says, a sparkle in his eye, 'but not often do visitors climb down the long hill to my house by the [t]river[x]. What is it you want?'". hc_rosehair summons hc_rosehair2. hc_rosehair cancels hc_builder1, hc_who2. After discussing hc_rosehair: historian cashes in; continue the action.

Understand "counter/river" as hc_rosehair2 when last beat is in HC. hc_rosehair2 is a terminal beat in HC with keyword name "Counter, river" and reaction "Over the course of a few minutes, you speak with 'Mother Rosehair'-- or at least the historian's rendition of her. You hear firsthand a tale which you gather has become a sort of bedtime story here: how the strong-willed old widow of Builder Tall refused to abandon her house by the river even as the river waters rose higher and higher and threatened to flood. She would stay in the house that Counter had built for her, and would let what happened happen. The river did not flood, and the story seems to have become a sort of parable for sticking to your principles.[paragraph break]Finally, the historian makes one wry point, stops, then smiles at you, himself again, and doffs his cap. 'Thanks, friend,' he says.".

Understand "greeneyes/greeneye/weaver" or "green eye" or "green eyes" as hc_greeneyes when last beat is in HC. hc_greeneyes is a repeatable beat in HC with keyword name "Greeneyes" and fuse 6 and reaction "The historian's smile fades a little. He glances quickly up and down the street. 'Not the best of times for that piece of history, friend,' he says quietly. 'But I believe all history should be told, even that which isn't popular. There are some who disagree.'[paragraph break]He looks are you sharply. 'Are you sure, then?'". hc_greeneyes suggests hc_greeneyesno. Instead of saying no or saying maybe when last beat is hc_greeneyes, force discuss hc_greeneyesno. Instead of saying yes when last beat is hc_greeneyes, force discuss hc_greeneyes1. hc_greeneyes summons hc_greeneyesno, hc_greeneyes1. After discussing hc_greeneyes: historian cashes in; continue the action. hc_greeneyes cancels hc_who2.

hc_greeneyesno is a beat in HC with keyword name "no" and reaction "He seems both relieved and a little disappointed. 'Probably for the best,' he says. 'Now, is there anyone else you want to meet?'". hc_greeneyesno cancels hc_greeneyes1. hc_greeneyesno summons hc_greeneyes, hc_builder1, hc_rosehair.

Instead of getting bored when last beat is hc_greeneyesno or last beat is hc_who or last beat is hc_who2, force discuss hc_credit.

hc_credit is a repeatable terminal beat in HC with reaction "'You just let me know when you've decided,' the historian says, tapping his cup. 'You've got credit now.'".

HGE is a thread.

hc_greeneyes1 is a beat in HGE with keyword name "yes" and reaction "He nods. Glancing again quickly up and down the street, he shakes his arms, then bows his head.[paragraph break]When he raises it, his face is changed: shrewder, eyes half-squints, voice smooth and sweet. But though it is a surprising change, you sense at once that it is not a simple villain, a caricature. There is depth, and, you sense, authenticity behind the performance.[paragraph break]'Builder,' he says, in a droning, sardonic voice, 'I've been expecting you. I know [hc_gewhy] you have come.'". hc_greeneyes1 summons hc_gewhy. hc_greeneyes1 suggests hc_gewhy. hc_greeneyes1 cancels hc_builder1, hc_rosehair.

Understand "why" as hc_gewhy when last beat is in HGE. hc_gewhy is a beat in HGE with keyword name "why" and reaction "'Yes,' he says sweetly, pacing. 'You come to accuse me of whispering against you in the fields. You come to accuse me of slandering your name in the Hall. You come to accuse; not to question, not to reason. You come to have your way. Do you deny it?'". hc_gewhy summons hc_whyyes, hc_whyno. The yes-beat of hc_gewhy is hc_whyyes. The no-beat of hc_gewhy is hc_whyno. hc_gewhy suggests hc_gehistory.

hc_whyyes is a beat in HGE with keyword name "yes" and reaction "'Then you are a liar,' the historian says simply, but there is no hate in the words.". hc_whyyes enqueues hc_gehistory. hc_whyyes cancels hc_whyno.

hc_whyno is a beat in HGE with keyword name "no" and reaction "'Good,' the historian says, nodding. 'Then we shall come straight to it.'". hc_whyno enqueues hc_gehistory. hc_whyno cancels hc_whyyes.

hc_gehistory is a beat in HGE with reaction "'You think I despise you,' he says, pacing. 'You think I am jealous. Again you are wrong. I merely wonder when. When, Builder, when your reign will end.'[paragraph break]'I have not forgotten,' he says before you can respond, 'our first winter. When we froze in those rude huts on the riverbank, [hc_leaderless] and afraid, paralyzed by our inability to act, to think for ourselves. We thought at first it had perhaps been [hc_bred] out of us. We thought without Forest we could not survive.'". hc_gehistory suggests hc_greeneyes3. hc_gehistory summons hc_leaderless, hc_bred. hc_greeneyes3 replaces hc_gehistory.

Understand "leaderless/leader" as hc_leaderless when last beat is hc_gehistory. hc_leaderless is a beat in HGE with keyword name "leaderless" and reaction "'How foolish we were,' the historian says bitterly, 'how naive. Do you remember, Builder? How for days we sat near the wreckage, starving and fearful, pitifully planting the burned seeds and waiting in vain for them to grow? How for weeks the thought did not even enter our heads that without them, we would have to make decisions for ourselves, shape our own destinies?'". hc_leaderless enqueues hc_greeneyes3.

Understand "bred/breed" as hc_bred when last beat is hc_gehistory. hc_bred is a beat in HGE with keyword name "bred" and reaction "'Yes, bred out,' he says bitterly, 'generation after generation selected not for their ability to think, but to follow orders; not to speak, but to hear. That is the history of our race, Builder, until that winter. Until us.'". hc_bred enqueues hc_greeneyes3

hc_greeneyes3 is a beat in HGE with reaction "'But then you, Builder, came to our rescue,' the historian continues, voice dripping with sarcasm. 'You volunteered to make our decisions, knowing that they must stand, unapproved, unvetted by any higher guidance, by any great minds whispering in your ear. That your rules and [hc_laws] would decide who would live and who would die. That all the blame should your plans fail would fall squarely on your shoulders. So noble you were, so heroic. And the [hc_others] stumbled over themselves in their haste to agree.'". hc_greeneyes3 suggests hc_greeneyes4. hc_greeneyes4 replaces hc_greeneyes3. hc_greeneyes3 summons hc_others, hc_laws.

Understand "law/laws" as hc_laws when last beat is hc_greeneyes3. hc_laws is a beat in HGE with keyword name "laws" and reaction "'So fair, so practical,' nods the historian, only a hint of irony in his voice. 'None could complain. [']None shall harm none,['] yes, very good, very good. [']All shall help all,['] very nice. [']All shall obey the Leader;['] now that's where it gets interesting, Builder. And nothing there about how one becomes a leader, is there? For another time such laws will be written, perhaps. A safer time. But when will that be?'". hc_laws enqueues hc_greeneyes4.

Understand "others" as hc_others when last beat is hc_greeneyes3. hc_others is a beat in HGE with keyword name "others" and reaction "He smiles wryly. 'Fools,' he says, 'panting like dogs, wagging their tails in glee that another would finally think for them. And no, Builder, I have not forgotten that the vote was unanimous. Already I sensed something wrong in your visage; something that wanted this new power too forcefully. But how could I speak otherwise? How could I, when all  faces were turned in slavish devotion to you? When your honeyed words sweetened the poison of your act for all the others, no choice was left for me at all.' He spits.". hc_others enqueues hc_greeneyes4.

hc_greeneyes4 is a beat in HGE with reaction "'Now thirteen babes have been born ere that dark winter,' the historian says. 'We have built strong houses, sown lusty crops. The danger is past. And yet still you lead us. The others are happy to let you, Builder, but not I. It is a return to the old ways. It is a betrayal of our Pact, to live as free people.'[paragraph break]He steps up to you, close, eyes searching yours intently. 'Would you plant yourself in a Hall of Rulers, Builder?' he asks quietly. 'The first great tree of this new world? Would you arch over your saplings forever?'". hc_greeneyes4 suggests hc_greeneyes5no. The yes-beat of hc_greeneyes4 is hc_greeneyes5yes The no-beat of hc_greeneyes4 is hc_greeneyes5no. hc_greeneyes4 summons hc_greeneyes5yes, hc_greeneyes5no.

Understand "never" as hc_greeneyes5no when last beat is in HGE. hc_greeneyes5no is a beat in HGE with keyword name "never" and reaction "He smiles, and shakes his head sadly. 'No,' he says, 'of course you do not think so. Just as Forest thinks nothing of its dominion over our kind. Just as even we did not realize what had been done to us until---'". hc_greeneyes5no enqueues hc_greeneyesend.

hc_greeneyes5yes is a beat in HGE with keyword name "yes" and reaction "The historian's eyes widen and he steps back. 'Then you've planned this all along,' he whispers, 'you knew, even from the beginning, that it would never be temporary-- that you would hold on to your power, always be leader, always---". hc_greeneyes5yes enqueues hc_greeneyesend.

hc_greeneyesend is a terminal beat in HGE with reaction "He breaks off, suddenly, and looks with alarm down the street. Several soldiers are ambling slowly in your direction, eyes on the historian.[paragraph break]He turns to you quickly. 'Sorry, friend,' he says, grabbing his cup, 'history will have to wait.' And he turns and walks quickly down the street in the opposite direction. The soldiers watch him for a moment, then turn and resume their patrol.". After discussing hc_greeneyesend: remove historian from play; remove cup from play.

Instead of attacking historian when last beat is in HGE, say "The historian leaps backwards, dropping character. 'Calm down,' he says, waving his arms, 'I'm just a historian! ".

Understand "builder/tall" as hc_tall. hc_tall is a beat in HC with reaction "The historian smiles, perhaps a little too broadly. 'Builder Tall,' he says, 'everyone's favorite. All right then, [if player is male]sir[otherwise]madam[end if], prepare to meet our illustrious founder.' The historian bows his head, then quickly raises it, slipping into a role you can tell he's played many times before.[paragraph break][as the parser]BETA: Unfortunately, this conversation has not yet been written.[as normal]". hc_already replaces hc_tall.

hc_already is a repeatable beat in HC with reaction "'Oh, but you've already heard that one,' the historian says. 'Come on, someone else.'".

Every turn when location is Room3 and historian is in Room3 and historian is idle and Historian Conversation is not happening and a random chance of 1 in 2 succeeds and histdone is false: say "[one of][moneygive][or][learnhistorianname][or][moneygive][stopping]". To say moneygive: say "[one of]A passer-by[or]An old woman[or]A well-dressed man[or]Someone[at random] [one of]tosses a coin in[or]drops a coin into[or]adds a coin to[or]puts in coin in[or]tosses a few coins in[at random] the [historian]'s cup.". To say learnhistorianname: say "'Look, matron, a historian!' cries out a little girl passing by in delight; the woman holding her hand shushes her and smiles at the beggar as they continue down the street."; change the printed name of the the historian to "historian".



Section - Alley

Report going from Room3 to Alley: say "You slip out of the bustle of the avenue into the quieter, darker side street.". Report going from Alley to Room3: say "You return to the broad streets of the avenue.".

Alley is inside from Room3. The description of Alley is "There is less traffic on this small, unclean street, and what there is is quick and furtive. Gaudy [o]signs[x] rise over lurid green [o]doors[x].[paragraph break][exits].". The exits text of Alley is "Other than the doors, the only way to go is back [d]out[x] to the street". First instead of exiting when location is Alley: try going outside instead.

The green doors are a minor setpiece in Alley. Understand "door" as green doors. The provoke message is "[if pimp is on-stage][forcediscusssrg_payfirst][otherwise]The doors are solid and locked.". To say forcediscusssrg_payfirst: force discuss srg_payfirst. Instead of going inside when location is Alley: force discuss srg_payfirst. The description of green doors is "The green is a particularly lurid shade. The doors are scrubbed clean against the general dirt and refuse of the alleyway.".

The gaudy signs are a setpiece in Alley. The description is "The signs are painted in such a manner that their subject matter is obviously considered lascivious or unsavory. They all say things like 'supervisor,' or 'commander.'".

The pimp is a man in Alley. "A [o]man[x] in a faded brown suit leans against a brick wall, [if srg_rejected is spoken]contemptuously ignoring you[else]eyeing you with a wide grin[end if]." Understand "man/suit" as pimp. The printed name is "grinning man". First Report greeting the pimp: say "You give him a cautious greeting." instead. The description of pimp is "He has the same look that is sinkingly common on every world you've been to: that of a man who knows he is selling something his customers can't help but want.".

Selling Rebel Girls is a scene. Selling Rebel Girls begins when the player is in Alley. When Selling Rebel Girls begins: pre-conversation processing; force discuss srg_1. Instead of exhausting during Selling Rebel Girls, say "'Walker, I don't have time to flap all day,' he says.". Selling Rebel Girls ends when player is not enclosed by Alley.


SRG is a thread. 

srg_1 is a beat in SRG with reaction "The grinning man accosts you. 'Hey government [if DrQuick is male]man[otherwise]lady[end if],' he says casually, 'looking for some time off? Escape all those big decisions, get away from that pressure? Why don't you come inside and meet one of my [srg_girls], eh? You won't have to worry about anything at all. They'll tell you exactly what to do.' He winks suggestively.". srg_1 suggests srg_girls. srg_1 summons srg_girls. 

Understand "supervisors" as srg_girls when last beat is in SRG. srg_girls is a beat in SRG with keyword name "supervisors" and reaction "'Come on, walker,' he grins, 'you know it's what you want. Someone to be in [srg_control]. They tell you what to do and you do it. A vacation from that rooting responsibility, clear your head. Reasonable, very reasonable rates: just [srg_clotheson] for an hour, too truth, my best supervisor just freed up, what do you say?'".  srg_girls summons srg_control, srg_clotheson, srg_rejected, srg_nomoney.  Understand "fifteen" as srg_clotheson. Instead of saying no when last beat is srg_girls or last beat is srg_clotheson or last beat is srg_barter, force discuss srg_rejected. srg_girls suggests srg_barter. 

srg_barter is a beat in SRG with reaction "'Hey, I forgot,' he says smoothly, 'special rate for uniforms, only twelve for an hour, best rate in the city. Come on, you in?'". srg_barter suggests srg_rejected. The yes-beat of srg_barter is srg_clotheson. The no-beat of srg_barter is srg_rejected.

srg_rejected is a terminal beat in SRG with keyword name "no" and reaction "He sneers at you. 'Oh yeah, so superior, you uniforms. I get more of you buttoned-up government types down here begging for it than anyone else. You need it worse than the rest of us. Uniforms.' He waves a hand dismissively and return to his post against the wall. 'You'll be back, walker, you'll be back.'". srg_rejected2 replaces srg_rejected.

Understand "control" as srg_control when last beat is in SRG. srg_control is a beat in SRG with keyword name "control" and reaction "'Oh yeah, it's a rush,' he says, eyes wide, hands spread, 'just turn off your brain, turn down your worries, and let one of my [srg_clotheson]'s sweet voices come into your head and give you orders. Most walkers like it so much they don't wanna leave,' he adds with a grin.". srg_control suggests srg_clotheson. srg_control summons srg_clotheson.

Understand "super/fifteen" as srg_clotheson when last beat is in SRG. srg_clotheson is a beat in SRG with keyword name "[if last beat is srg_girls]fifteen[else if last beat is srg_control]super[else]yes" and reaction "'Hey, it's maker nature, friend, we all want it,' he says smoothly. 'I got the perfect super for you. [if Rume is male]He'll have you do some chores, fill out some paperwork, organize some clothes for him... maybe even chat a bit, but on his terms, walker, his terms. He'll[otherwise]She'll have you do some chores, fill out some paperwork, organize some clothes for her... maybe even chat a bit, but on her terms, walker, her terms. She'll[end if] tell you exactly what to do, and you'll do it. Just what you need. Ten for an hour, last offer. You in?'". srg_clotheson summons srg_rejected. Instead of saying no when last beat is srg_girls, force discuss srg_rejected. srg_clotheson suggests srg_rejected.

Instead of saying yes when last beat is in SRG, force discuss srg_nomoney. Instead of giving a coin to the pimp, force discuss srg_nomoney. Understand "pay [pimp]" as a mistake ("[tryforcenomoney]"). To say tryforcenomoney: force discuss srg_nomoney.

srg_nomoney is a beat in SRG with reaction "You pull out your [if player holds at least two coins]coins[else if player holds at least one coin]coin[otherwise]pockets[end if] and the man's expression turns sour. 'Don't play me, uniform,' he says, 'I know you got way more than that buttoned up in that fancy jacket. I told you my final price. Now either pay up or get out.' He scowls at you.". srg_nomoney suggests srg_rejected. srg_rejected replaces srg_nomoney. srg_nomoney cancels srg_rejected.

Instead of greeting the pimp when we have discussed srg_rejected or we have discussed srg_nomoney: force discuss srg_rejected2. srg_rejected2 is a terminal beat in SRG with reaction "'Get out of here, walker,' he says, spitting, 'stop wasting my time.'". Instead of vague discussing when pimp is enclosed by location, say "You expect he's only interested in talking about one thing.".

Before exiting when pimp is attentive: force discuss srg_rejected; continue the action.

Instead of attacking the pimp: say "You move to attack the man but he suddenly pulls out a stubby chalk-white device from his jacket that looks suspiciously like a gun, and aims it at you.[paragraph break]'Beat it, walker,' he says calmly. 'Now. And I better not see you come back to my street again.' Nervously, you back out of the alley."; remove pimp from play; try retreating. Instead of going inside when location is Room3 and  pimp is off-stage: say "You better not risk going back down there alone.".

srg_payfirst is an ephemeral beat in SRG with reaction "'Hey walker,' the man says in anger. 'You pay me first before you go in there.'". 

Section - The Gallery

Room4 is a rebelcity-room. The description of Room4 is "The sidewalk widens here to encompass a long strip of land filled with [o]artwork[x]. [if Islander Bombing has happened]The art stands alone and unprotected on the empty street now, like archaeological remnants of some lost civilization[otherwise]Cars grumpily navigate the curved road, and while a few passers-by are examining the art, most are walking right by[end if]. [A sentence about a rebelcity room].[paragraph break][exits].".

Some chalk-drawings are a setpiece in Room4. The description is "Overlapped, smudged, and faded, they seem to evidence that the children of this squalid neighborhood, at least, are enjoying themselves.". The printed name is "chalk drawings". Understand "chalk/drawing/drawings" as chalk-drawings.

The rebel-artwork is a setpiece in Room4. The printed name is "street art". Understand "next" or "start" or "artwork" or "art" as rebel-artwork. The rebel-artwork has a number called current piece. The current piece of rebel-artwork is 0.

Before examining the rebel-artwork:
	increase current piece of rebel-artwork by 1;
	if current piece of rebel-artwork > number of rows in Table of RebelArtwork begin;
		now current piece of rebel-artwork is 1;
		say "You have looked through all the pieces of artwork, and come back to the first one.";
	otherwise if current piece of rebel-artwork is 1;
		say "You step into the sea of artwork and turn your attention to the first piece.";
	otherwise;
		say "You turn your attention to the next piece.";
	end if.

Instead of examining the rebel-artwork:
	let x be current piece of rebel-artwork;
	choose row x in Table of RebelArtwork;
	say "[desc entry][paragraph break]This piece is titled '[title entry].' A small [o]hopper[x] alongside [popularity entry]. [if current piece of rebel-artwork is number of rows in Table of RebelArtwork]This is the last piece of artwork, unless you go back to the [o]start[x][otherwise]The [o]next[x] piece of artwork is nearby[end if].".

Table of RebelArtwork
title		desc	popularity
"Free Will"	"This sculpture is about your height, made entirely from small squares of mirrored glass fastened in the rough shape of a woman standing with arms outstretched, face turned towards the sky. The glass catches and throws the light in sparkling patterns around, making the exact shape of the piece almost hard to discern amidst the radiant sparkling light."	"contains some coins"
"Greeneyes Advancing"	"This piece is a painting, quite good, showing dozens of crippled, deformed hands, interlocked and twisted together in some complex activity, slowly surrounding a lone city, reaching out as if to crush its proud and noble spires."	"is filled with coins"
"The Spirit of City Dreams Of The Future"	"This textured painting, showing a beautiful green and blue-grey planet, a star rising above its horizon. In the foreground is a stylized angelic form, with the recognizable features of these people smoothed and emboldened into an idealized symbolic form, of a woman with flowing tresses and billowing white gown, staring into the background, where thousands of jeweled stars, the arm of a galaxy, await."		"is nearly overflowing with coins"
"Alone Yet Together"	"A twisting mobius line of human forms with outstretched arms, sculpted in some textured clay. They are not quite touching." 	"contains a few scattered coins"
"Widow Tall Writes The Principles"	"A muted painting of a woman in black hunched over a desk with a quill, writing on parchment in dim firelight. Snow drifts the windows. A balding man stands near the desk, cupping the inkwell in his hand as if to keep the ink from freezing."	"contains a handful of coins"
"Tree"	"A bas-relief carving in stone, showing a figure screaming in agony as twisted, gnarled roots cover his face and burrow into his head."		"holds a smattering of coins"

The hopper is an undescribed open unopenable container in Room4. It is fixed in place. Understand "basket" as hopper. The description is "Just a small wire basket, which [coins bit].". To say coins bit: let x be current piece of rebel-artwork; choose row x in Table of RebelArtwork; say "[popularity entry]". Check taking hopper: say "There are people watching you." instead.

Instead of inserting something (called zeta) into the rebel-artwork, try inserting zeta into the hopper.

Instead of inserting something into the hopper when noun is not a coin, say "It looks like it's designed for coins." After inserting a coin into the hopper: say "You drop a coin into the hopper for "; let x be current piece of rebel-artwork; choose row x in Table of RebelArtwork; say "'[title entry].'".



Section - The Crime Scene (Room 5)

Room5 is a rebelcity-room. The description of Room5 is "[if unvisited]The street narrows here, entering a more residential area of high, narrow apartments with wrought-iron balconies and brown, dying bushes. [A sentence about a rebelcity room].[paragraph break][exits].[otherwise]A smoking crater in the center of the street is the epicenter of the chaos around you: broken glass, piles of blood-smeared rubble, sirens and screams. Progress further down [shortrebname of Room5] is blocked by the crater; the only sensible direction is back towards the [d]plaza[x].[end if]".

The smoking crater is a setpiece in Room5. The description is "Charred concrete and twisted shards of red-hot metal rise from the crater, and broken pipes of water and sewage mingle with sizzling electrical wire in the wreckage at the bottom.". Instead of entering or climbing the smoking crater, say "Far too dangerous.".

Some street debris is a minor backdrop. Understand "glass/rubble/blood" as street debris. The description is "Cleaning up the wreckage from the attack will take days.".



Section - The Bombing

Islander Bombing is a scene. Islander Bombing begins when the player is in Room5 for the first time.

The crime scene is a room that varies.


When Islander Bombing begins:[aar]
	[Announce the event, and adjust ambience and scenery items.]
	say "Suddenly a high pitched whine fills the air. Traffic around you stops and people look to the sky in fear. Before a moment passes, there is an explosion; you are knocked to the ground and half-deafened. Clods of dirt rain down around you. Screams pierce the air.[paragraph break]You stand again and brush yourself off-- no damage, it seems. But the street isn't so lucky.";
	now crime scene is the location;
	move street debris to Rebelworld;
	move barricades to Plaza;
	now the ambience table of Rebelworld-Outdoors is Table of Panic Plaza ambience;
	remove the historian from play;
	[ Determine which avenue ("direction") we should place the new rooms on. Ideally, it will be one the player has not yet explored from the plaza; failing that, it will be one at random that's not the one they're on. ]
	let dirlist be {north, east, south, west};
	if there is a dir of north in Table of Rebworld Map, remove north from dirlist;
	if there is a dir of east in Table of Rebworld Map, remove east from dirlist;
	if there is a dir of south in Table of Rebworld Map, remove south from dirlist;
	if there is a dir of west in Table of Rebworld Map, remove west from dirlist;
	if the number of entries in dirlist is 0: [If there's no entries, there will be at least one street we've only explored one room down; pick that one at random.]
		let tempway be rebstreet cardinality;
		while tempway is rebstreet cardinality:
			sort Table of Rebworld Map in random order;
			choose row with a depth of 1 in Table of Rebworld Map;
			let tempway be dir entry;
			let tempdepth be 2;
	else: [If we still have any entries in dirlist, there's an unexplored avenue; pick that one.]
		let tempway be entry ( a random number from 1 to the number of entries in dirlist ) of dirlist;
		let tempdepth be 1;
	[Now add the map connection for the new rooms to our chosen direction.]
	choose a blank row in Table of Rebworld Map;
	change dir entry to tempway;
	change depth entry to tempdepth;
	change room entry to Room6;
	choose row with a dir of tempway in Table of Cardinal Directions;
	now the printed name of Room6 is fullstreet entry;
	[Remove map connections related to the two streets that aren't the one we chose or the one we're on. ]
	let dirlist be {north, east, south, west};
	remove rebstreet cardinality from dirlist;
	remove tempway from dirlist, if present;
	repeat through Table of Rebworld Map:
		if dir entry is listed in dirlist:
			blank out the whole row;
	[Mark the other two avenues as being the ones that are still open.]
	repeat through Table of Cardinal Directions:
		if dir entry is not listed in dirlist:
			change flag entry to 1.

Room6 is a room. The description of Room6 is "Decaying elegance speaks to a neighborhood that was once wealthy and prosperous but now has sunk into abandonment and decline. Now fire rages in a building to one side of this street, while broken glass litters the other. The streets here are strangely quiet, as if already abandoned. [exits].". The exits text of Room6 is "The street runs towards the [d]plaza[x] or a curved [d]courtyard[x] opposite". Understand "courtyard" as northeast when location is Room6.

Room7 is northeast of Room6. The printed name is "Courtyard". Understand "courtyard" or "curved" as Room7. The description of Room7 is "The street ends here at a once well-manicured circle lined with blue-grey shrubs. One burns slowly, ignited by some piece of flying debris. The shouts and sirens from the rest of the city seem muffled here, subdued. [exits].". The exits text of Room7 is "The street stretches back towards the [d]plaza[x]. Light spills through a round window on a [d]door[x] half off its hinges, at the top of a few graceful curved steps". Understand "door" as inside when location is Room7. Understand "plaza" as southwest when location is Room7. Report going from Room6 to Room7: say "You hurry down the deserted street.".


Section - Holding-Cell

[ Antisocial behavior will wind the player up in here, where the scene with the rebel leader plays out in a somewhat different fashion. ]

DrQuick has a number called rap sheet. 

Getting Arrested is a scene. Getting Arrested begins when the rap sheet of DrQuick >= 5. When Getting Arrested begins: say "Suddenly you are surrounded by burly, uniformed guards, holding dangerous looking weapons and eyeing you warily.[paragraph break]'Get down on the ground, now,' one of them shouts. You have no choice but to comply."; print a section break; move DrQuick to Holding-Cell. Getting Arrested ends when location is Holding-Cell.

Life Behind Bars is a scene. Life Behind Bars begins when location is Holding-Cell. When Life Behind Bars begins: remove passcard from play; repeat with cn running through coins held by player begin; remove cn from play; end repeat. Life Behind Bars ends when location is not Holding-Cell.

Holding-Cell is a room in Rebelworld with printed name "Holding Cell". The description of Holding-Cell is "This small bare room is adorned only by a metal [o]slab[x] jutting from the wall, a simple washbasin, and a large steel door with a barred, glassed window. The silence is pressing.".

Instead of going when location is Holding-Cell, say "You can't see any way out of here.".

The metal slab is an enterable undescribed supporter. It is in Holding-Cell. The simple washbasin is a setpiece in Holding-Cell. The large steel door is a door. It is east of Holding-Cell. It is locked. A barred glassed window is part of large steel door. The description of barred glassed window is "All you can see is a well-lit, sterile white hallway beyond.". Understand "glass" as barred glassed window.


Section - Space Museum


Report going from Room7 to Space Museum: say "You crest the steps and push open the damaged door, which creaks reluctantly. Through it you pass into a large space, open and empty.".

Space Museum is inside from Room7. Space Museum is up from Room7. The printed name is "Abandoned Museum". The description of Space Museum is "Clouds of dust kicked up by the explosion are still dancing through the air of this high-ceilinged space. It looks as if exhibits once dominated the walls, but now empty placards and ghost rectangles of clean wall are all that remain.[paragraph break]In the center of the otherwise empty space is a white [o]rocket[x] ship, covered in dust[if StraightTalkWithRebelLeader has ended].[paragraph break][exits][end if].". The exits text of Space Museum is "The sounds of the [d]street[x] seem somehow muted in here". Understand "street" as outside when location is Space Museum.

The rocket ship model is a setpiece in Space Museum. The description is "As you move closer, you see it is only a model, but an inspiring sight, nonetheless. A great tapering cylinder, one side has been cut away to reveal half-sized glass cylinders with half-sized sleeping people inside. A [o]plaque[x] stands near the base of the model.". Check entering rocket ship model: say "It's only a model." instead.

The rocket-plaque is part of the rocket ship model. Understand "plaque" as the rocket-plaque. The printed name is "plaque". The description is "'Half scale model of a proposed colony ship to another star. The new colonists would sleep through the long journey. Construction waits only on the successful synthesis by scientists of somenium, a breakthrough expected to occur within the next few years.'".


StraightTalkWithRebelLeader is a scene. StraightTalkWithRebelLeader begins when the player has been in Space Museum for at least 3 turns or the player has been in Holding-Cell for at least 3 turns. 

leader is a man with printed name "Leader Tall". understand "man/tall/mayor/governor/general" as leader. 

When StraightTalkWithRebelLeader begins:
	move leader to location;
	now leader is attentive;
	say "[if location is Space Museum]A [o]shadow[x] cuts off the light coming into the room[otherwise]A small commotion rises from the hallway outside; you hear low murmurs of excitement, the snap of heels clicking to attention. Then the door to your cell slides open and a guard looks in on you suspiciously.[paragraph break]'Visitor,' he mutters. 'Damned important one, too.' And he steps back to admit a small, well-dressed [o]man[x] into the cell, closing the door behind him[end if].";
	now tempfuse of cl_intro is 5.

Check taking off when StraightTalkWithRebelLeader is happening and noun is cap (this is the can't escape during a key scene rule):
	say "With all the trouble he's done to bring you here, it would be tragic to leave in the middle of the conversation." instead.



Instead of saying farewell to or going during StraightTalkWithRebelLeader: follow the can't escape during a key scene rule. Instead of exhausting during StraightTalkWithRebelLeader: say "'I would love to tell you more,' he says, adjusting his glasses, 'but I'm afraid our time is short.'".

Leader is a man. Understand "shadow" or "Leader Tall" or "man" as leader. The description is "[if we have not discussed cl_intro]Standing in the doorway is a man. The daylight spilling in around him makes his features indistinct.[otherwise]Standing a half-dozen paces away is a short man with a rounded belly and large, wiry spectacles, dressed in finely tailored cloth. A faint, quiet smile seems a permanent fixture on his aged face, hovering below whorls of graying hair. There is a manner of weary resignation about him, but also one of quiet determination.[end if]". The initial appearance is "Leader Tall stands nearby, orating.".

CWRL is a thread. The escape clause of CWRL is cl_story1. [If we get off track, go back to the story.]


cl_intro is an exciting beat in CWRL with reaction "[if location is Space Museum]'[leaderintrobit],' the man says, taking a few steps into the room and letting the door swing closed again. Outside you can see the faint tableau of an armored vehicle and several burly guards. [paragraph break]He strolls slowly through the room, looking around at the closed exhibits sadly and running fingers along the hull of the model ship. 'Twenty years ago we built her,' he says, 'full size, mind, not this model. But all the somenium on this world was good for but one voyage. Where to send it? Hmm. Who can tell. And the scientists never did find a way to make more.' He smiles, sadly. 'They say now they never will.' [otherwise]'An inauspicious place,' the man says, eyeing the bars critically, 'for such a momentous meeting. I can't say I understand your actions; cultural differences, I suppose. And even I must sift through paperwork, or else...' He coughs. 'But here we are.'[paragraph break]He studies your face for a long moment, seeming to search for something there, then begins. 'There is a ship,' he says quietly, 'in a museum not far from here. Safe from the attack, thank us. We built it twenty years ago, without knowing where to send it. Your predecessor was unable to help us, so now we turn our hopes on you.' He smiles sadly.[end if][paragraph break]'I am Leader Tall,' he adds with a nod, almost as an afterthought, 'Governor General. [cl_goodtomeet].'". cl_intro summons cl_goodtomeet. Understand "welcome" as cl_goodtomeet. Instead of greeting Leader when last beat is cl_intro, force discuss cl_goodtomeet. cl_intro suggests cl_questions. Before discussing cl_intro: if we have examined green slip, now cl_intro summons cl_censorship; continue the action.

To say leaderintrobit: if we have examined rocket-plaque, say "But they never synthesized it"; otherwise say "She never flew".

Understand "Cloudeye" as cl_Cloudeye when last beat is in CWRL. cl_Cloudeye is an ephemeral beat in CWRL with reaction "Leader Tall looks vague. 'Yes,' he says, 'one of the scientists on your-- pardon-- Dr. Quick's team, I believe. I've not met him myself.'".

Understand "bombing" as cl_bombing. cl_bombing is a beat in CWRL with fuse 6 and keyword name "bombing" and reaction "An angry look crosses Leader Tall's face. 'The [cl_greeneyes],' he says, 'will not rest until they've destroyed our city and killed every soul in it. They are terrorists and murderers. It pains me that they struck again on the day of your arrival. But we will deal with them.'". cl_bombing suggests cl_transitiontopoint.

Understand "greeneyes/greeneye" as cl_greeneyes. cl_greeneyes is a beat in CWRL with fuse 6 and keyword name "greeneyes" and reaction "'They are descendants of Weaver Greeneyes and his followers,' Leader Tall says sourly, making a dismissive gesture with one hand, 'traitors against [cl_buildertall] Tall, the great leader who saved the Twelve from starvation and death in the first cold years after their arrival. They live on the islands, we on the land. But their day is drawing to an end.'". cl_greeneyes suggests cl_transitiontopoint. 

Understand "censorship" as cl_censorship. cl_censorship is a beat in CWRL with fuse 6 and keyword name "censorship" and reaction "Leader Tall's face grows troubled. 'It was never my intent to interfere with the free exchange of knowledge and ideas,' he says. 'But of late a growing group of greeneyes sympathizers has taken root in our youth. These hotheads want to destroy all government, cast out all leaders and let each family fend for itself. Surely you are wise enough to realize such anarchy is foolish.' He sighs. 'Even the staunchest patriot could not deny the persuasive power of Weaver [cl_greeneyes]['] words, even two centuries later. So the book has been removed from the public libraries. Only temporarily. I'm not proud of my action, but I believe it had to be done, for the good of City. Some say I am [cl_censoragree] and some [cl_censordisagree]; that is the way of things in a free society, but for now it is I who make the decisions.'". cl_censorship suggests cl_transitiontopoint. 

Understand "correct" as cl_censoragree when last beat is in CWRL. cl_censoragree is a beat in CWRL with keyword name "correct" and reaction "Leader Tall nods. 'I am glad you understand,' he says. 'And when this war is over, my first act will be to return all the books to the libraries. May the Greeneyes crumble soon and hasten that day's arrival.'". cl_censoragree suggests cl_transitiontopoint. cl_censoragree cancels cl_censordisagree.

Understand "wrong" as cl_censordisagree when last beat is in CWRL. cl_censordisagree is a beat in CWRL with keyword name "wrong" and reaction "Leader Tall shakes his head. 'You have not seen the suffering caused by the Greeneyes,' he says, 'the pallor of fear cast over our city for a generation by those animals. We cannot face any more division. Only by uniting against this threat can we hope to prevail.' He straightens his back a little, defiant. 'I stand behind my decision,' he says.". cl_censordisagree suggests cl_transitiontopoint. cl_censordisagree cancels cl_censoragree.

Understand "builder" as cl_buildertall when last beat is in CWRL. cl_buildertall is a beat in CWRL with keyword name "Builder" and reaction "'Builder Tall is the pillar of our society,' Leader Tall says seriously, 'hero to schoolchildren and model to the grown. He was the first of us to accept the terrible mantle of freedom and responsibility, to realize that the loss of the windsigh was in fact the dawn of independence for our species. We all are in his shadow, and ever in his debt.'". cl_buildertall suggests cl_transitiontopoint.

cl_goodtomeet is an ephemeral beat in CWRL with keyword name "Welcome" and reaction "Leader Tall inclines his head graciously to you. 'We have waited a long time for your return,' he says, and adds, with a small smile, 'your coming, rather. We had expected the return of another. But you are as welcome.'".

cl_questions is a beat in CWRL with reaction "Leader Tall taps the [if location is Space Museum]spaceship[otherwise]wall[end if] thoughtfully. 'Timing,' he says. 'Twenty years we've waited for your friend to return. You arrive and the [cl_greeneyes] launch another act of terrorist madness the same day.' He shakes his head. 'So despite all that I wish, I must meet you here, [if location is Space Museum]amongst ruins[otherwise]in a cell and not my private offices[end if], and only briefly.' He sighs. 'But I owe you explanations. Please, if you have questions, ask, and then I will come to the [cl_transitiontopoint].'". cl_questions suggests cl_transitiontopoint. cl_questions summons cl_directtransition, cl_cloudeye, cl_buildertall, cl_bombing, cl_censorship, cl_greeneyes. 

cl_transitiontopoint is a beat in CWRL with keyword name "point" and reaction "'Nothing more?' Leader Tall asks. 'Then very good. We come to it.'". cl_transitiontopoint enqueues cl_story1. cl_story1 replaces cl_transitiontopoint.

Understand "point" as cl_directtransition. cl_directtransition is a beat in CWRL with reaction "Leader Tall smiles. 'As impatient as I,' he says. 'Yes, let's come to it, then.'". cl_directtransition enqueues cl_story1.

cl_story1 is a beat in CWRL with reaction "The quiet little man turns to face you at last, folding his hands on his walking stick, regarding you seriously. 'Much of this you doubtless know already, so I will be brief. Our people are the descendants of the [cl_twelve] who [cl_crashlanded] on this planet two hundred years ago, the seeds of the Trees meant to use us and enslave us destroyed. For generations we were scared and alone, but have survived.'[paragraph break]'Some time ago one of our greatest scientists--' he gives you a strange little side look, and you realize he's talking about Quick-- 'made a [cl_breakthrough] in the study of that marvel of technology, Egg, which brought us here. The results were many, but chiefly two: it enabled us to secretly listen in on their intergalactic chatter-- and gave us the ability to repair and refurbish the ship.'". cl_story1 suggests cl_story2. cl_story2 replaces cl_story1.  cl_story1 cancels cl_questions, cl_buildertall, cl_censoragree, cl_censordisagree, cl_greeneyes, cl_bombing, cl_cloudeye.

Understand "twelve" as cl_twelve when last beat is in CWRL. cl_twelve is a beat in CWRL with keyword name "Twelve" and reaction "'Each Egg left its home, the Heart of the Forest, with twelve men and women aboard,' Tall says, 'determined by the calculations of the windsigh to be the optimum number of helpers to assist the new trees to grow, and then breed more helpers for newer generations. Our Twelve are our ancestors; you have doubtless seen their names reflected everywhere in our City.'". cl_twelve enqueues cl_story2.

Understand "crashlanded/crash" as cl_crashlanded when last beat is in CWRL. cl_crashlanded is a beat in CWRL with keyword name "crashlanded" and reaction "'Based on information our mindlisteners have uncovered,' he says, 'it would seem there was a fault in the reentry programming of the egg ships. Some small percentage of them failed when entering their target planet's atmosphere. But our world, and yours, are the only two we know of where there were any survivors.'". cl_crashlanded enqueues cl_story2.

Understand "breakthrough" as cl_breakthrough when last beat is in CWRL. cl_breakthrough is a beat in CWRL with keyword name "breakthrough" and reaction "'The taming of somenium,' Tall says, rubbing his face tiredly, 'will doubtless go down in our history as one of our greatest moments. Doctor Quick's work building the somenium crucible and the mindlink interface was instrumental.' He smiles. 'Your mind is in good company in there.'". cl_breakthrough enqueues cl_story2.

cl_story2 is a beat in CWRL with reaction "'But we had only that one ship's worth of somenium,' he continues, pacing the room slowly, 'that rare substance which lets the windsigh think together across the stars, and would keep us in contact with would-be colonists. Oh, we could send the ship off without it,' he adds bitterly, 'but those poor souls would be like blind mice crawling into a galaxy of snakes.'[paragraph break]'For [cl_trees] does not want us,' he says, stepping close to you, a fire in his eyes. 'Trust that, despite what they say. We are an abomination to them, a botched experiment that somehow lived and thrived. They do not want us to spread, to colonize, perhaps to tempt their [cl_slaves] with the promise of freedom. They mean for us to stay stranded here on this small world until we have [cl_destroy] ourselves.'". cl_story2 suggests cl_story3. cl_story3 replaces cl_story2. cl_story2 summons cl_trees, cl_slaves, cl_destroy.

Understand "Forest" as cl_trees when last beat is in CWRL. cl_trees is a beat in CWRL with keyword name "Forest" and reaction "'What place could we have in their grand design?' he asks simply. 'Their millennial plan to spread Forest across the stars, a forest as large as a galaxy, of thinkers and their subservient companions? Free peoples would muddy their perfect vision, and they would not tolerate it.'". cl_trees enqueues cl_story3.

Understand "slave/slaves/slavery" as cl_slaves when last beat is in CWRL. cl_slaves is a beat in CWRL with keyword name "[if last beat is cl_story4]slavery[else]slaves" and reaction "'Our ancestors gave up their destiny, their free will, their future to serve Forest,' Tall says, fixing you with a firm glance, 'who took it without a thought, and used their limbs and eyes and ears. And in turn kept them from using their minds. Yes; slavery is the word for it, without a doubt.'". cl_slaves enqueues cl_story3.

Understand "destroyed" as cl_destroy when last beat is in CWRL. cl_destroy is a beat in CWRL with keyword name "destroyed" and reaction "Tall pauses for a moment, as if regretting the word, then stares into the distance for a moment, considering.[paragraph break]'We are such a young people,' he says. 'We have grown up quickly in the generations since our sudden liberation, perhaps too quickly. We have not yet learned how to balance the need for authority with the need for freedom.' He shakes his head, clearing his thoughts.". cl_destroy enqueues cl_story3.

cl_story3 is a beat in CWRL with reaction "'But then,' he continues, 'twenty years ago, your friend arrived. Progue. From another lost world of Forest's expansion. He too had repaired an egg ship's [cl_seiver] and dove into the thought-strands of Forest. Through our mindlistener [cl_spies], we picked up news of their excitement, spreading in ripples throughout their galactic mind, and were able to communicate with him in dreams, much as we have with you. Finally we brought his mind here. And in telling us about his world, we learned something impossible.'[paragraph break]He fixes you with intense grey eyes, and speaks firmly. 'Those strange blue crystals on that distant island of Lacuna,' he says, 'are surely somenium. You have not seen our night sky, but it looks much as your friend described his. I do not think our worlds are so very far away.'[paragraph break]'I think our ship could reach your Lacuna,' he breathes, 'if we only knew [cl_where] it was.'". cl_story3 suggests cl_story4. cl_story4 replaces cl_story3. cl_story3 summons [cl_progue,] cl_seiver, cl_spies, cl_where.

[Understand "progue" as cl_progue when last beat is in CWRL. cl_progue is a beat in CWRL with reaction "'It was a ". cl_progue enqueues cl_story4.]

Understand "seiver" as cl_seiver when last beat is in CWRL. cl_seiver is a beat in CWRL with keyword name "seiver" and reaction "'Yes, the small glass egg containing the machinery that connects a mind to the the thought-strands of the galactic grove,' he says. 'A marvelous piece of technology, designed by trees, built by men, powered by somenium. There is only one on this world; thank Builder our side has it and not the Greeneyes.'". cl_seiver enqueues cl_story4.

Understand "spies" as cl_spies when last beat is in CWRL. cl_spies is a beat in CWRL with keyword name "spies" and reaction "'For twenty years now, they have worked tirelessly, around the clock,' he says, 'carefully stealing information from the glut of noise echoing through the thought-strands of Forest. It was never designed for security,' he adds with a smile, 'so though they have been aware of us for some years now, there is little they can do to shut us out, as long as we are careful. We have learned much about our former masters, over the years... and it has allowed us to find you.'". cl_spies enqueues cl_story4.

Understand "where" as cl_where when last beat is in CWRL. cl_where is a beat in CWRL with keyword name "where" and reaction "'You can help us find it,' he says. 'But first there is more to tell.'". cl_where enqueues cl_story4.

cl_story4 is a beat in CWRL with reaction "He steps closer and places a hand on your shoulder. 'It is our chance,' he says forcefully. 'Lacuna will be our stepping-stone to build the second great civilization of this galaxy... one built on free will, not [cl_slaves]. We can escape the violence and terrorism of the [cl_Greeneyes], and turn from war to science. In peace, and with the somenium there, we can prepare to expand outwards across the stars. And when we meet the empire of the windsigh...' he touches his fingers lightly together. 'We will come in peace, with but this as an offer: those humans who choose to leave their masters and join us will be welcomed. They will be welcome.'". cl_story4 suggests cl_story5. cl_story5 replaces cl_story4. 

cl_story5 is a beat in CWRL with reaction "A sad smile touches Leader Tall's lips. He turns away from you. 'But that dream vanished when Progue did,' he said. 'I do not pretend to know why, but though he agreed to help us, he never did, and cut off all communication with us. And things here have grown worse. The Greeneyes have developed new weapons; we have been forced to follow suit. Crowding has gotten worse. There is so little habitable space on this miserable planet.'[paragraph break]He takes a deep breath, staring into the shimmering motes of dust that light from a half-boarded window illuminates. 'But now, you have come. A second chance, as mysterious and unlooked for as the first. Now perhaps you see why you are so welcome, why my government has stretched its resources to the breaking point to reach you.'". cl_story5 suggests cl_story6. cl_story6 replaces cl_story5.

cl_story6 is a beat in CWRL with reaction "Leader Tall turns to face you, and speaks with the firm voice of a lifelong orator. 'Stranger, I make to you the same offer that my father made to Progue, those years ago. To help us, you must merely do one thing, one very simple thing.'[paragraph break]'Return to Lacuna,' he says. 'Leave your seiver encrypted and set to our password, so your message will come, out of all the nodes of Forest, only to our seiver here in City. Climb to the top of the tallest windsigh on your island, so you will be surrounded by its branches.'[paragraph break]He hobbles forward until you are face to face, and breathes, 'Then, just this. [italic type]Look at the stars[roman type]. What you see will travel unwillingly through the tree into the seiver and to the computers and machines in the labs of Doctor Quick. He will turn it over to our astronomers. Through triangulations and calculations, they will be able to tell us where your world of Lacuna lies, and we will be able to plot a course there. And at last our ship will fly, and carry with it the future of our people.'". cl_story6 suggests cl_story7. cl_story7 replaces cl_story6.

[The trees there, of course, will retain a dim memory of what you saw, but nowhere near a precise enough image to give the same data to their own astronomers. ]

cl_story7 is a terminal beat in CWRL with reaction "A guard steps discreetly forward and whispers something in Leader Tall's ear. He nods, and turns back to you.[paragraph break]'I do not know you, visitor,' Leader Tall says,  'so I cannot call you friend. But if you help us, you will be the savior of a people, of a world, of a galaxy.' He fixes you with a deep, serious look.[paragraph break]Finally he nods, breaks the gaze, and turns, a wry smile twitching his lips. 'Just like a debate,' he says, beginning a shuffle towards the door. 'I've made my case, and now it's in the hands of the voters. Well. I have a government to attend to. Plans must be made. The people will expect retaliation for the tragedy today. Three more lives, I've been informed. A waste. The Greeneyes must be punished.'[paragraph break]'Remember,' he says at the door, 'just take off the transmitter cap and you'll awaken back on Lacuna. Goodbye for now, and... may your thoughts be free.' With one last nod, he turns [if location is Space Museum]and steps through the door. As the marbled window swings shut, you see his armored car roll silently away[otherwise]and raps sharply on the metal door with his stick. A moment later it slides open, and Leader Tall steps outside to his armed retinue, giving you a final somber glance before the door swings shut again[end if].". After discussing cl_story7: remove Leader from play.

Instead of attacking Leader, force discuss cl_attack.

cl_attack is a beat in CWRL with reaction "You move to strike at him but instantly the shadowy figures at the door resolve into armored figures with guns pointed in your direction. Leader Tall regards you sadly. 'Such anger?' he says. 'Perhaps, then, things are not so different here. Perhaps violence is the way of all worlds.'[paragraph break]'You are upset,' he says. 'Will you allow me to [t]continue[x] my story, and perhaps explain? Or will you [t]reject[x] my offer before I have finished making it?'". cl_attack summons cl_attackresolve, cl_endpoorly. Understand "continue" as cl_attackresolve. Understand "reject" as cl_endpoorly. cl_attack suggests cl_attackresolve. cl_attack2 replaces cl_attack.

cl_attack2 is a beat in CWRL with reaction "Instantly one of the troopers leaps forward and pummels you savagely with the butt of his gun. Stars explode in your vision-- for a moment, you see the mountaintop on Lacuna-- and then you sink to your knees, gasping; the pain is very real.". cl_attack2 enqueues cl_endpoorly. 

cl_endpoorly is a terminal beat in CWRL with reaction "Leader Tall holds his stick in front of him, hands folded atop it, his face grim. 'Such a waste,' he mutters. 'Dreams shattered by madmen. Very well. Return to Lacuna by removing the transmitter cap, and leave the body of a man who devoted his life to bring you here in peace. I have a government to attend to. War to run. May your thoughts be free.'[paragraph break]He turns[if location is Space Museum], and strides wordlessly from the museum, the two soldiers following with guns trained on you. As the marbled door swings shut you see the armored car in the plaza outside pull quickly away[otherwise] and walks out the door, disappearing into his armed retinue who retreat slowly afterwords, guns trained on you, until the heavy steel door is slammed shut and locked again with an echoing slam[end if].". After discussing cl_endpoorly: remove Leader from play.

cl_attackresolve is a beat in CWRL with reaction "Leader Tall pauses, then nods. He motions to the guards, who retreat into the shadows again. 'Thank you,' he says. 'I will try to come to the point more quickly.'". cl_attackresolve enqueues cl_story1.

Instead of touching Leader, say "You reach out a hand and clasp Leader Tall's shoulder. He smiles and places his on yours. 'Thank you,' he says. 'It is good to know you are a [if player is female]wo[end if]man of character.'". 

Instead of going when location is Space Museum and StraightTalkWithRebelLeader has not happened: say "Something about the still finality of this place makes you pause.".


StraightTalkWithRebelLeader ends when Leader is off-stage.

Every turn when StraightTalkWithRebelLeader has ended and location is regionally in Rebelworld and a random chance of 1 in 10 succeeds: say "The heavy wires and machinery in your [o]cap[x] itch you. You remember what Tall said about taking it off to return.".


[  Only a narrow band of livable space on this world; 
]

[
cl_2 is a beat. The reaction is "{Here the Rebel leader explains himself to you. He apologizes for the attack by the Islanders, but uses it as an example: the free people, escaped from the trees, need more space.}". cl_2 suggests cl_request.

cl_request is a beat. The reaction is "{They say that they have repaired the ship that crashed here, generations ago, but don't know where to send it. They need more of the crystal on Lacuna, the only other planet where it has been found. They want to expand their civilization there, and then travel among the worlds, not as enemies, but gathering like-minded humans among them. You must leave the encryption set for the Rebels, then climb to the highest tree and look at the stars. They'll be able to pick up what you see and from that determine the location, and send a colony ship to make it a human world. To return to lacuna, just close your eyes.}". cl_request suggests cl_depart.

]


Section - Cafeteria

[This is a small tableau to cover the condition where the player returns to the Treeworld after the bombing. ]

Cafeteria is a room in Rebelworld. "Plain metal tables reflect the harsh glow of fluorescent lights sharply in this windowless room. A few [o]technicians[x] in lab coats are scattered around at various tables, talking quietly to each other in tense voices, and glancing surreptitiously at a guard standing near the double [d]door[x] leading out of the room.".

The double door is a setpiece in Cafeteria. The description is "Doctor Cloudeye grabs your arm as you move towards the door. 'We can't leave till lockdown is over,' he says.".

Some reb-scientists are undescribed people in Cafeteria with printed name "technicians". Understand "technicians" as reb-scientists. The description is "They look tired.". Instead of greeting some reb-scientists, say "A few of them nod wearily at you, but none seem interested in joining a conversation.".

Post Bombing Return is a scene. Post Bombing Return begins when location is Cafeteria. When Post Bombing Return begins: now Cloudeye is attentive; force discuss pbr-intro.

PBR is a thread. pbr-intro is a beat in PBR with reaction "Doctor Cloudeye, sitting at a table nearby, notices your confusion and grips your arm. 'You've returned,' he says. 'We're in the cafeteria at the lab; there's been a [pbr-lockdown] because of the [pbr-greeneyes] attack.'". pbr-intro summons pbr-lockdown, pbr-greeneyes.

Understand "lockdown" as pbr-lockdown when last beat is in PBR. pbr-lockdown is a beat in PBR with keyword name "lockdown" and reaction "'The lab here is one of the presumptive targets in any Greeneyes attack,' Cloudeye explains quickly, 'because of the somenium and the seiver. We've got it, not them, so of course they want it, you see. So everything is ultra tight security now until the Force has verified that the area is clear.'".

Understand "greeneye/greeneyes" as pbr-greeneyes when last beat is in PBR. pbr-greeneyes is a beat in PBR with keyword name "Greeneyes" and reaction "'It's one of the biggest ones so far,' Cloudeye explains, running a hand through his long straight hair nervously. 'Three separate bombs went off simultaneously at three points across City. There've been reports of more in the farms; maybe they're trying to cut off our supply lines.' He swallows weakly. 'But our technicians are standing by, if you're willing to help us,' he says. 'It will take more than that to knock us out.'[paragraph break]'Please,' he adds, 'return to Lacuna by taking off your cap, go to the tallest tree, and look at the stars. Don't let all our work be for nothing.'".

Instead of getting bored when location is Cafeteria: do nothing. Instead of greeting Cloudeye when location is Cafeteria: say "'Nothing to do but wait it out, doctor,' he says distractedly.".

[Chapter - Puzzles

After going in Rebelworld for the first time: now everything required by Contacting-All-The-Trees is met; continue the action.


Section - Reaching Rebelworld

Reaching-Rebelworld is a puzzle. Reaching-Rebelworld requires Getting To The Rebs.

After going in Rebelworld for the first time: now everything required by Reaching-Rebelworld is met; continue the action.


Section - Finishing Rebelworld

Finishing-Rebelworld is a puzzle. Finishing-Rebelworld requires Ditching The Rebs.

After taking off cap when StraightTalkWithRebelLeader has ended: now everything required by Finishing-Rebelworld is met; continue the action.]


Chapter - Fast Forwarding



A fast-forward rule for Finishing-The-Prologue:
	now DrQuick is male.

Rebelworld-Sequence is a puzzle. It requires Being-In-Rebelworld, Finishing-Rebelworld.

Being-In-Rebelworld is a puzzle. It requires Arriving-Rebworld.

Arriving-Rebworld is a task. Definition: Arriving-Rebworld is complete: if the player is DrQuick, yes.

A fast-forward rule for Being-In-Rebelworld:
	now yourself is on mind chair;
	change the machinery-password to the rebel-password;
	now the mind machinery is projecting;
	try looking.

Finishing-Rebelworld is a puzzle. It requires Concluding-Leader-Convo.

Concluding-Leader-Convo is a task. Definition: Concluding-Leader-Convo is complete: if cl_story7 is spoken, yes.

A fast-forward rule for Finishing-Rebelworld:
	now cl_story7 is spoken;
	now the time of day is 10:30 PM;
	try silently taking off cap.



Volume - The Epilogues (in Lacuna-Epilogue by Blue Lacuna)

[The Epilogue is a complex sequence which attempts to provide emotional closure based on the path the player has taken through the game. Though the complexities of the player's choices will be presented as much as possible, there are basically one of three endings, which happen in the following priority: A) the player likes Rume, B) the player likes Progue, C) the player dislikes both.

There are several possible states we might be in arriving at this sequence, which colors its presentation.

1. Progue is either 1) dead (killed by the player or suicide), 2) healed and happy, or 3) healed and sad. We cannot get ending B if 1.1 is true. (if progue is dead, if progue is healed and happy, if progue is healed and sad.)
2. Irregardless of this, he will be in one of the twelve archetypes. (if neurotic dad, if father knows best, if bitter dad, if disciplinarian, if lover, if twitterpated, if friend, if toady, if shattered lover, if bitter lover, if enemy, if slave)
3. The player chose to put the fate of Lacuna in the hands of the trees, the rebels, Progue, or no one (end-choice [end-trees or end-rebels], end-both, end-abstain, end-neither). The fate of Lacuna actually ended up in the hands of 1) the trees, 2) the rebels, or 3) up for grabs (either no password or the equipment is destroyed). (won-trees, won-rebels, won-neither.)

In all 3 endings, we begin with a dream mirroring the prologue. The player is again asked to choose between art and love, with dialogue differing based on their choice way back at the beginning of the game, and the various factors above. (For instance if Ending C has been chosen, the player is thwarted in their attempt to choose love.)

The dream resolves into a conversation-- with who and about what varies as detailed below, but the first part is about the player's choice, how it compares to their choice at the beginning of the game, and how it relates to their #3 decision.

If ENDING A, the conversation is with Rume about prodding the player to realize that somenium might allow them to return to Rume. Since it makes connections regardless of distance, and Rume's eyes are the exact shade of the crystal... maybe there's a chance.

If ENDING B, the conversation is with a grown Lethe, and about the loopholes in wayfaring, and designed to make the player realize Progue might still have a chance to be reunited with his daughters.

If ENDING C, the conversation is with Doctor Quick, and about how a wayfarer is eternally alone (like the Rebels). Similar themes to the end of the Preludes. To make art is to turn away from life. Is that what you really want?

The player awakens:

If ENDING A, they are in the studio on the beach. Progue (if alive and friendly) is bringing the last of the paints; otherwise they are already there. He gives the player a brush and asks you to choose a color. You choose; if blue, you begin a portrait of Rume; otherwise, you prepare to move on with your life.

If ENDING B, you are on the Rise, and Progue has just started to chisel at his statue. You fill him in on your dream; he carves a beautiful sculpture of Phoebe and Lethe, and vanishes.

If ENDING C, you are in the rain forest. You are hunting boar to make your canvas to leave. You kill one, and reflect on the fate of the island and on solitude as you prepare to depart.


]

To decide whether won-trees:
	if mind machinery is off-stage, no;
	if fc_choosenowno is spoken, no;
	if ending_1c is spoken, yes;
	if ending_1a is spoken or ending_1b is spoken, no;
	if end-trees, yes;
	no.

To decide whether won-rebels:
	if mind machinery is off-stage, no;
	if fc_choosenowno is spoken, no;
	if ending_1d is spoken, yes;
	if ending_1a is spoken or ending_1b is spoken, no;
	if end-rebels, yes;
	no.

To decide whether won-neither:
	if won-trees, no;
	if won-rebels, no;
	yes.
	

Part - Epilogue
 
Epilogue is a scene.

To decide whether ep_likeRume: if Rume-tracker >= 10, decide yes; decide no.

To decide whether ep_likeProgue: if affinity of Progue > 0 and Progue is not dead, decide yes; decide no.

Instead of sleeping when current chapter is 11: say "But you've just woken up.".

[Completing-Progue's-Character-Arc requires done-with-confrontation.]

First before getting bored when Completing-Progue's-Character-Arc is solved: do nothing instead.

Epilogue begins when ep-trigger is true. ep-trigger is a truth state that varies.

When Epilogue begins:       
	now Progue is idle;
	post-conversation processing;
	now the animus of Progue is resting;
[	now done-with-confrontation is met;]
	move the player to Epilogue-Dream, without printing a room description;
	say "[section break][description of Epilogue-Dream][line break]".
 
Chapter - Choice Redux

Epilogue-Dream is a room in Dreamlands with printed name "". The description is "[if ep-concept-art is on-stage]Waves.[paragraph break]Dream seas surge around you, slow, silent, and for a moment it's as if everything you've been through, all you've seen and done, has not yet happened, and again you feel you must make a choice, between [t]art[x] and [t]love[x][else]You float in infinite void[end if].".

ep-concept-art is an abstraction in Epilogue-Dream. Understand "art" as ep-concept-art when location is Epilogue-Dream. ep-concept-love is an abstraction in Epilogue-Dream. Understand "love" as ep-concept-love when location is Epilogue-Dream. 

Instead of doing anything other than examining or examining by name or discussing or exhausting or getting bored when location is Epilogue-Dream: say "[if ep2-door is enclosed by location]All you can seem to focus on is the [o]door[x].[else if an attentive other person is enclosed by location]You can only seem to focus on [a random attentive other person enclosed by the location].[else]There is only the choice: [t]art[x] or [t]love[x]?[end if]".[]

The description of ep-concept-art is "[if we chose art]Yes, and it feels as right as the first time. You are an artist, and nothing can change that.[otherwise if we chose both]{You have chosen. Whereas once you chose both, now you choose art.}[otherwise]It feels right now, where before it did not.[end if]". After examining ep-concept-art: now second-choice-art is true; prep-ep-convo; continue the action.

The description of ep-concept-love is "[if we chose love]Yes, and it feels as right as the first time. You cannot be human without loving, and you cannot be an artist without being human.[otherwise if we chose both]{You have chosen. Whereas once you chose both, now you choose love.}[otherwise]It feels right now, where before it did not.[end if]". After examining ep-concept-love: now second-choice-love is true; prep-ep-convo; continue the action.

second-choice-art is a truth state that varies. second-choice-art is false. second-choice-love is a truth state that varies. second-choice-love is false.

[both]

To prep-ep-convo:
	remove ep-concept-love from play;
	remove ep-concept-art from play;
	if ep_likeRume:
		now tempfuse of eplr_intro is 5;
		if Rume is male, now ep-rume is male;
		else now ep-rume is female;
		move ep-rume to location;
		now ep-rume is attentive;
	otherwise if ep_likeProgue and Progue is not dead:
		now tempfuse of eplp_intro is 5;
		move ep-lethe to location;
		now ep-lethe is attentive;
	otherwise:
		move ep-dr-quick to location;
		now tempfuse of epln_intro is 5;
		now ep-dr-quick is attentive;
	if ( we chose love and second-choice-art is true ) or ( we chose art and second-choice-love is true ) :
		now eplr_intro suggests eplr_diffchoice;
		now eplp_intro suggests eplp_diffchoice;
		now epln_intro2 enqueues epln_diffchoice;
	if end-neither:
		if second-choice-art is true, now eplr_junction enqueues eplr_neitherart;
		otherwise now eplr_junction enqueues eplr_neitherlove;
		now epln_junction enqueues epln_destroy;
	else if end-abstain:
		now eplr_junction enqueues eplr_abstain;
		now epln_junction enqueues epln_abstain;
	else if end-rebels:[aar]
		now eplr_junction enqueues eplr_rebels;
		now epln_junction enqueues epln_city.




Chapter - Epilogue A (Rume)

Section - Dream

ep-rume is a person with printed name "Rume". Understand "Rume" as ep-rume. The description is "Rume looks achingly familiar.".

EPLR is a thread [Epilogue - Like Rume] with escape clause eplr_escape. Instead of exhausting when last beat is in EPLR: force discuss eplr_escape. Instead of getting bored when last beat is in EPLR: force discuss eplr_escape. eplr_escape is a repeatable dogged ephemeral beat in EPLR with reaction "'Well,' [heshe] says, 'but there is more to say.'". eplr_escape enqueues eplr_intro.

eplr_intro is an exciting beat in EPLR with reaction "The moment you choose the dream-sea fades away, and you are left alone in a tenuous blackness-- no, not alone. A [if Rume is female]wo[end if]man is here, waiting for you. [o]Rume[x].". eplr_intro suggests eplr_samechoice. eplr_junction replaces eplr_intro.

eplr_diffchoice is a beat in EPLR with reaction "[CHeShe] smiles sadly. 'And now you choose [if second-choice-love is true]love,' [heshe] says, 'where before you chose your art[otherwise]art,' [heshe] says, 'where before you chose your love[end if]. Do you suppose that Lacuna has [eplr_changed] you? Or is it that the time for one has gone and the other [eplr_arrived]?' [CHeShe] pauses. 'Or has enough time [eplr_passed] that you no longer remember why you first chose the way you did, and there is nothing to be read into it at all?'".

eplr_samechoice is a beat in EPLR with reaction "[CHeShe] smiles sadly. 'And so a second time have you chosen [if second-choice-art is true]art[otherwise]love[end if],' [heshe] says, '[if second-choice-art is true]art over love[otherwise]love over art[end if]. Are your inner [eplr_convictions] strong enough that the choice is never a difficult one? Does it merely seem as [eplr_right] now as it did then?' [CHeShe] pauses. 'Or has enough time [eplr_passed] that you no longer remember why you first chose the way you did, and there is nothing to be read into it at all?'". eplr_samechoice suggests eplr_passed.

Understand "conviction/convictions" as eplr_convictions when last beat is in EPLR. eplr_convictions is a beat in EPLR with keyword name "convictions" and reaction "Rume nods as you respond, as if anticipating your answer. 'I think perhaps that is what drew me to you,' [heshe] says, 'the conviction, [if second-choice-love is true]the intensity of your love[otherwise]the dedication to your art[end if]. [if second-choice-love is true and The-Path-Of-Love has not happened]Perhaps that was why it hurt me so when you left[otherwise if second-choice-love is true]Perhaps that was why I knew I could convince you to stay, overcome the power of the Call[otherwise]Even though I knew from the moment we met that one day I would lose you to it[end if].'". eplr_convictions enqueues eplr_junction.

Understand "correct" as eplr_right when last beat is in EPLR. eplr_right is a beat in EPLR with keyword name "correct" and reaction "Rume breathes deeply of the non-air of the void, considering. 'You are alive for the moment,' [heshe] finally agrees, 'and take each decision as it comes to you. I think perhaps that is what drew me to you-- your spontaneity, your vivacity in whatever moment, whatever world you are in. [if The-Path-Of-Love has happened]Perhaps that is why I was so terrified that night in the Tumble, convinced I could never convince you to live for longer than the moment. To stay[otherwise]Perhaps that is why I knew I would lose you, that night in the Tumble, that nothing I could have said would have made you stay[end if].". eplr_right enqueues eplr_junction.

Understand "changed" as eplr_changed when last beat is in EPLR. eplr_changed is a beat in EPLR with keyword name "changed" and reaction "Rume brushes wrinkles from [hisher] robe, reflecting. 'You once told me it is impossible to be unchanged by The Call. It seems you were right.'". eplr_changed enqueues eplr_junction.

Understand "arrived" as eplr_arrived when last beat is in EPLR. eplr_arrived is a beat in EPLR with keyword name "arrived" and reaction "Rume rubs a hand absently against [hisher] shoulder, as if cold in the featureless void, and reflects. 'Some philosophers say that to live we must turn from art. Others say to make art we must turn from life.' Rume takes a breath. 'They are both wrong, my love.'". eplr_arrived enqueues eplr_junction.

Understand "passed" as eplr_passed when last beat is in EPLR. eplr_passed is a beat in EPLR with keyword name "passed" and reaction "A smile tickles the corner of Rume's mouth as [heshe] gazes at you across the void. 'There is a bedtime story for mountain children,' [heshe] says, 'about a pilgrim and the wisest man in the world. To every question asked about why the world was the way it was, the wise man would only reply, [']Because it is.['] Well. Perhaps the why is not important. Now you choose [if second-choice-art is true]art[otherwise]love[end if], and it is.'". eplr_passed enqueues eplr_junction.

eplr_junction is a beat. eplr_junction enqueues eplr_trees. eplr_somenium replaces eplr_junction.

eplr_trees is a beat in EPLR with reaction "'And tell me, wayfarer,' Rume continues. 'Was it [if second-choice-love is true][eplr_loveartcause] for the beautiful word of the Windsigh[otherwise]the living [eplr_loveartcause] that was the Heart[end if] that caused you to choose the windsigh's empire over the chaos and uncertainty of City? Were you swayed by the [eplr_logic] of the Philosopher's argument, the truth of that merged society? Was it just gut [eplr_instinct] that led you to decide? Or something [eplr_else] I haven't guessed at?'". eplr_trees suggests eplr_else.

eplr_rebels is a beat in EPLR with reaction "'And tell me, wayfarer,' Rume continues. 'Was it [if second-choice-love is true]your [eplr_loveartcause] for the brave spirit of City and its stumbling, struggling ideals[otherwise]that brave, stumbling, idealistic [eplr_loveartcause] by the people of City[end if] that caused you to choose them over the scripted order and stage-managed peace of the Forest? Were you convinced by the [eplr_logic] of Leader Tall's argument, the evidence of his streets? Was it simply gut [eplr_instinct] that led you to decide? Or something [eplr_else] I haven't guessed at?'". eplr_rebels suggests eplr_else.

eplr_abstain is a beat in EPLR with reaction "'And tell me, wayfarer,' Rume continues. 'Was it [if second-choice-love is true]your [eplr_lovecauseProgue] for [else]out of [eplr_lovecauseProgue] for [end if]Progue that led you to force the decision of which side to choose onto him? Did you feel that no choice should be made without proper time for [eplr_reflection]? Or did you [eplr_humility] the choice outright, out of humility or fear of choosing poorly?'". [aar]

Understand "thought" as eplr_reflection when last beat is in EPLR. eplr_reflection is a beat in EPLR with keyword name "thought" and reaction "'But there is never enough time,' Rume says sadly, 'never enough information to make a decision. In the end even the most well-researched decision comes down to a moment of choice.'". eplr_reflection enqueues eplr_somenium.

eplr_neitherlove is a beat in EPLR with reaction "'And tell me, wayfarer,' Rume continues. 'Did love drive you to destroy the seiver on the mountaintop, and if so, love for who?'". eplr_neitherlove summons eplr_lovecauseProgue, eplr_lovecauseRume, eplr_lovecauseTrees, eplr_lovecauseRebels, eplr_else. eplr_neitherlove cancels eplr_changed, eplr_arrived. eplr_neitherlove suggests eplr_else.

eplr_neitherart is a beat in EPLR with reaction "'And tell me, wayfarer,' Rume continues. 'Was it for some artistic point, some dramatic ideal that you destroyed the seiver on the mountaintop? Can you tell me what it was?'". eplr_neitherart summons eplr_justice, eplr_closure, eplr_humility. eplr_neitherart cancels eplr_changed, eplr_arrived. eplr_neitherart suggests eplr_else.

Understand "love/art" as eplr_loveartcause when last beat is in EPLR. eplr_loveartcause is a beat in EPLR with keyword name "[if second-choice-love is true]love[otherwise]art" and reaction "[CHeShe] nods. '[if eplr_diffchoice is spoken]You truly have changed, then,' [heshe] says. 'I do not think you would have reached that decision that night in the Lodge. You are not the same. Nothing is immobile[otherwise]Then you have remained unchanged,' [heshe] says. 'Across worlds and through lives, your heart alone remains constant. Perhaps each wayfarer is the center of a universe, the rock around which all else and all others whirl in chaos[end if].'". eplr_loveartcause enqueues eplr_somenium.

Understand "logic" as eplr_logic when last beat is in EPLR. eplr_logic is a beat in EPLR with keyword name "logic" and reaction "Rume nods. 'You are a complex [if player is female]wo[end if]man,' [heshe] says, 'there is not a single passion that drives you. In my village as a [if Rume is male]boy[otherwise]girl[end if] we had a word for those whose heart and mind were not at war, but united. We called them chieftains.'". eplr_logic enqueues eplr_somenium.

Understand "instinct" as eplr_instinct when last beat is in EPLR. eplr_instinct is a beat in EPLR with keyword name "instinct" and reaction "Rume nods. 'And I think it is the same choice I would have made,' [heshe] says. '[if end-rebels]Perhaps the Forest would be a better fate for life on Lacuna, but perhaps not a better fate for men and women. They are something greater than mere men, perhaps, but that simple fact means they are no longer men. Yes, I would have chosen City, too, my love. With all its flaws and faults, the people of City are us.[otherwise]To choose City would be to choose war over peace, destruction over construction. Perhaps people like them born free might have survived, but they were too dominated by their torn-away halves, the shadow of the Forest having as much influence over their lives in negative as it did to the symbionts in positive. Yes, I would have chosen the Forest, too, my love. They are two beautiful races, stronger because they are together, and lost apart.[end if]'". eplr_instinct enqueues eplr_somenium.

Understand "else/no" as eplr_else when last beat is in EPLR. eplr_else is a beat in EPLR with keyword name "[if last beat is eplr_trees or last beat is eplr_rebels]else[otherwise]no" and reaction "Rume smiles. 'Apologies, my love,' [heshe] says. 'Always unkind it is to put words in the mouth of another. Please, explain yourself and I will listen.'

As you answer Rume's question, [heshe] watches you closely, listening in the achingly familiar way [heshe] always used to, walking through pine-thick trails or holding each other under farm furs. When at last you have explained yourself, [heshe] thinks for a long while before nodding, and saying 'Thank you. Your reasons are sound, and I think I would have made the same choice.'". eplr_else enqueues eplr_somenium.

Understand "love/Progue/respect" as eplr_lovecauseProgue when last beat is in EPLR. eplr_lovecauseProgue is a beat in EPLR with keyword name "[if last beat is eplr_abstain and second-choice-love is true]love[else if last beat is eplr_abstain]respect[else]Progue" and reaction "Rume nods slowly. 'Then it was his story, after all,' [heshe] says, 'and you were the one called to help him finish it. Good. A hard lesson to learn, love. But to know when to be a hero and when to help the truly heroic... that is a real gift.'". eplr_lovecauseProgue enqueues eplr_somenium. [aar]

Understand "you" as eplr_lovecauseRume when last beat is in EPLR. eplr_lovecauseRume is a beat in EPLR with keyword name "you" and reaction "'[if last beat is eplr_humility]Rume nods slowly. 'It was too great a decision to be forced on anyone,' [heshe] says. 'By terrible accident one is often asked to decide the fate of millions, but it does not make it right[otherwise]Because it's what I would have told you to do,' [heshe] says, nodding even before you've finished, clearly moved. 'Because I would have warned you against pride and power, and false choices[end if].' [CHeShe] gently touches the side of [hisher] forefinger to each eye, breathing deeply. 'Because neither you nor Progue could have made that choice, love, between mastery of a galaxy for one and genocide for the other. They must decide for themselves, fight or talk or chance it out. You and Progue were both strangers to that universe. It was not yours. It was theirs, and theirs alone.'". eplr_lovecauseRume enqueues eplr_somenium.

Understand "forest" as eplr_lovecauseForest when last beat is in EPLR. eplr_lovecauseForest is a beat in EPLR with keyword name "Forest" and reaction "Rume looks puzzled at first, then nods in greater and greater understanding as you explain. 'Of course,' [heshe] says. ". eplr_lovecauseForest enqueues eplr_somenium.

Understand "city" as eplr_lovecauseCity when last beat is in EPLR. eplr_lovecauseCity is a beat in EPLR with keyword name "City" and reaction "Rume nods as you explain. 'Of course,' [heshe] says. 'the Greeneyes. If you had helped one side over the other it would only have perpetuated their inner conflict. You never met the Greeneyes; you knew nothing about whether they were a better or worse choice than those in City. And on a larger scale, you only saw what the Forest wanted you to see; how could you truly judge a whole civilization based on the tiny fragments you saw of each?' [CHeShe] smiles sadly. 'If City is to survive it will not be because another moralizing power arrived to help them,' [heshe] adds. 'They must solve their problems on their own.'". eplr_lovecauseCity enqueues eplr_somenium.

Understand "closure" as eplr_closure when last beat is in EPLR. eplr_closure is a beat in EPLR with keyword name "closure" and reaction "Rume nods. 'It was the decision that destroyed Progue,' [heshe] agrees. 'After all he'd been through, being asked to make that terrible choice, between mastery of a galaxy for one people and genocide for another, that finally drove him into madness, drove his children away from him, robbed him of his greatest gift. Destroying the choice was the only way you could think of to save him.' [CHeShe] rubs [hisher] shoulder, as if cold in that immense blackness. 'I understand,' [heshe] says finally.". eplr_closure enqueues eplr_somenium.

Understand "humility/reject" as eplr_humility when last beat is in EPLR. eplr_humility is a beat in EPLR with keyword name "[if last beat is eplr_neitherart]humility[else]reject" and reaction "'You felt such a choice was not yours to make,' Rume says, nodding. 'Yes, I remember that about you. Your choice is wise. Now it will be up to them to decide their fate, without an unexpected force giving either side an advantage. Yes. It is good.'". eplr_humility enqueues eplr_lovecauseRume.

Understand "justice" as eplr_justice when last beat is in EPLR. eplr_justice is a beat in EPLR with keyword name "justice" and reaction "Rume is puzzled at first, but then begins to nod as you explain. 'Perhaps it was what both sides deserved, at that,' [heshe] says. 'Each offering you a stark and impossible choice: mastery of the galaxy for us, and genocide for our enemies. Neither allowing you or Progue another alternative. But there are always other alternatives, my love. You taught me that, and I remember. And now the Forest and City know it too.'". eplr_justice enqueues eplr_somenium.

eplr_somenium is an insistent beat in EPLR with reaction "'Well,' [heshe] continues, after a long, pensive pause. 'You made your decision, and Progue made his, and soon I think it will be time for you to move on. But there is something important you should realize before you go.'

'Somenium. The bluerock.' Rume smiles. 'It was the key to so much. Progue's madness and the fate of two civilizations. Yet it seemed so unimportant at first, just a minor detail of the scenery. The Philosopher, on the Heart of Forest, said something important about it. Something about a link between wayfaring and somenium. Do you remember, remember what it is they have in common?'". eplr_somenium summons eplr_transportation, eplr_dreams, eplr_scarcity, eplr_connections. The no-beat of eplr_somenium is eplr-somno. eplr_somenium suggests eplr_connections. eplr_connections replaces eplr_somenium.

Understand "transportation" as eplr_transportation when last beat is in EPLR. eplr_transportation is a dogged beat in EPLR with fuse 9 and keyword name "transportation" and reaction "'Not exactly,' Rume says, shaking [hisher] head, 'since the bluerock moves nothing; it only allows minds to connect. But it was close to that.'".

Understand "dreams" as eplr_dreams when last beat is in EPLR. eplr_dreams is a dogged beat in EPLR with fuse 9 and keyword name "dreams" and reaction "'True,' Rume says, biting a lip, 'dreams allowed them to reach you through the somenium in the seiver, and perhaps the Call is a sort of waking dream. But no, that wasn't it.'".

Understand "scarcity" as eplr_scarcity when last beat is in EPLR. eplr_scarcity is a dogged beat in EPLR with fuse 9 and keyword name "scarcity" and reaction "'Interesting,' says Rume, 'both impossibly rare. That's not quite it, but it was related.'".

eplr-somno is a dogged beat in EPLR with fuse 9 and reaction "'Then think harder,' Rume says, the familiar look of exasperation when [heshe] expects better from you. 'It's important.'".

Understand "connection/connections" as eplr_connections when last beat is in EPLR. eplr_connections is a beat in EPLR with fuse 9 and keyword name "connections" and reaction "'Yes, that was it!' Rume says, 'both wayfaring and somenium make connections between people regardless of distances. What is it he said? All bluerock touches all bluerock, no matter how far. Like when you hear the Call...' [CHeShe] trails off and turns to stare at you, sea-blue eyes piercing yours. 'What do you think, my love,' [heshe] finally whispers. 'Is it [eplr_coincidence]? Or perhaps...' [heshe] swallows, afraid to breathe, afraid to break the suddenly huge stillness of the black void.[paragraph break]'Perhaps,' Rume whispers, 'there is an [eplr_another], a third choice we never saw, hidden yet there all along.'". eplr_another replaces eplr_connections. eplr_connections suggests eplr_another.

Understand "coincidence" as eplr_coincidence when last beat is in EPLR. eplr_coincidence is a terminal beat in EPLR with keyword name "coincidence" and reaction "Rume lowers [hisher] eyes. 'Yes,' [heshe] finally says, 'you must be right. It is you who understands the rules of wayfaring. And I am only a dream. One that perhaps will not come again.'[paragraph break]The void begins to fade, a dull red-orange dimness and the muffled sounds of seagulls seeping through, and Rume begins to dissolve with it. 'Wake now, wayfarer,' [heshe] says in a voice seeping into sleep. 'It is time to move on.'[paragraph break]And you are awake.".

Understand "alternative" as eplr_another when last beat is in EPLR. eplr_another is a terminal beat in EPLR with keyword name "alternative" and reaction "'What if I did have the power to Call you back to me, wayfarer? What if these dreams we share have not been yours alone?' A red-orange dullness and the muffled sound of seagulls begin to seep into the void, and Rume begins to fade, but you clutch [himher] tightly. 'What if my alpine world has bluerock, too,' [heshe] says quickly, 'in the dust, in the air, in each living thing? In the sweat of my body, the moisture of my lips...'

[CHeShe] steps forward, touching a hand to your cheek even as [heshe] fades nearly to invisibility behind the onrushing intrusion of waking reality, searching you with sea-blue eyes that alone remain real and visible, deep as oceans, indigo flecks and imperfections sparkling in their depths...

'In my eyes,' [heshe] whispers, and you are awake.".

Section - Coda

Epilogue-Ending-A is a scene. Epilogue-Ending-A begins when eplr_another is spoken or eplr_coincidence is spoken.

ep-timer is a number that varies.

When Epilogue-Ending-A begins:
	begin chapter 11;
	change the time of day to 7:08 AM; 
	change the time factor to 1;
	repeat with thepot running through paintpots begin;
		move thepot to Studio;
	end repeat;
	if Progue is not dead begin;
		remove pot of blue paint from play;
		change the initial appearance of ep-Progue to "Progue stands nearby[if eea_takebrush is unspoken], holding out your [o]paintbrush[x] expectantly[else], awaiting your response[end if].";
		change the description of ep-Progue to "He's been doing much better. You hope soon he'll be ready to leave this world as well.";
	otherwise;
		move ep-paintbrush to yourself;
	end if;
	remove artisan tools from play;
	now the ep-canvas is in Studio;     
	move yourself to Studio;
	say "You rise slowly to your feet, stretching out aches and pains. You remember now: staring at your blank canvas for hours long into the darkness.".

The ep-canvas is a fixed in place described thing with printed name "canvas". Understand "canvas" or "painting" or "hide" as ep-canvas. The description is "Dried and taut, boar-hide still exuding faint smells of animal, the canvas awaits your paint.". 

ep-Progue is a man with printed name "Progue". "Progue is here." Understand "Progue" as ep-Progue. The description is "Progue is here.".

Every turn when location is Studio and current chapter is 11 and ep-timer is not -1:
	increase ep-timer by 1;
	if ep-timer > 3 and Progue is not dead and Progue is not enclosed by location:
		now ep-timer is -1;
		remove Progue from play;
		move ep-paintbrush to Studio;
		move ep-Progue to Studio;
		now ep-Progue is attentive;
		move pot of blue paint to Studio;
		now tempfuse of eea_intro is 5;
		force discuss eea_intro;
	if ep-timer > 2 and Progue is dead:
		say "[one of][eea-noprogue-choice][or][stopping]".

To say eea-noprogue-choice: say "Your brush tingles in your hand, and the paints await you on the workbench: [t]red[x], [t]yellow[x], [t]green[x], [t]black[x], [t]white[x], and [t]blue[x]. To begin you must only choose one to start with.".

EEA is a thread. eea_intro is an exciting beat in eea with reaction "Progue steps in through the open doorway, carrying a wooden pot.[paragraph break]'At last, finished,' Progue says, putting the pot of blue paint down on the counter. 'Voices from the stars would be horrified that we're using their precious somenium for this, but one can't paint anything without blue,' he adds cheerfully.[paragraph break]'Oh,' he says, 'and your [o]paintbrush[x], too.' He pulls the brush out and holds it out to you.". Instead of vague discussing when last beat is in EEA, say "There's so much else to talk about, but, at the same time-- perhaps everything that needs to be said is said.".

The ep-paintbrush is a prop with printed name "paintbrush". Understand "paintbrush" or "paint brush" or "brush" as ep-paintbrush. Instead of examining ep-paintbrush: try taking ep-paintbrush.

Instead of painting or vague painting when ep-canvas is enclosed by location:
	if Progue is dead:
		say eea-noprogue-choice;
	else if eea_intro is unspoken:
		say "You can't seem to find your paintbrush.";
	else:
		force discuss eea_takebrush.

Instead of taking a paintpot when location is Studio and ep-canvas is enclosed by location: say "They are easily accessible where they are.".

Check vague discussing when location is Studio and ep-canvas is enclosed by location: say "You can't think of what to say." instead.

Instead of taking ep-paintbrush when location is Studio: force discuss eea_takebrush. eea_takebrush is a beat in EEA with reaction "The brush tingles your hand with something almost or barely electric. It seems to connect you and Progue along the length of the wooden handle; he holds on for a fraction of a second as your eyes meet, and something ionic passes between you.[paragraph break]Then he lets go. The brush is in your hand, and something in you changes. Or remembers.[paragraph break]'I'll leave and leave you to it, then,' Progue says quietly. 'Seas of canvas need filling, and for me, well, quotas of rock. No need to linger over parting.' He half-turns, on the brink of leaving.". eea_takebrush suggests eea_saynothing. eea_whattopaint replaces eea_takebrush.

[The player is the protagonist; Progue and the trees/rebels has been your antagonist by causing you to realize love is the most important choice. (??)]
Instead of hugging ep-Progue when last beat is eea_takebrush: say "You hug Progue and he hugs back, his weatherworn cheek pressed against your neck, and [weatherwornbit]. You step back and know now you are ready to leave this place."; force discuss eea_whattopaint.
Instead of kissing ep-Progue when last beat is eea_takebrush: say "You kiss Progue [if romance of Progue > 3]gently and tenderly, raising one hand to his weatherworn face[else]on each weatherworn cheek, an old custom from past worlds that seems somehow appropriate[end if], and [weatherwornbit]. You step back and know now you are ready to leave this place."; force discuss eea_whattopaint.
Instead of pushing or attacking ep-Progue when last beat is eea_takebrush: say "Here, at this final moment, all the anger and violence has drained from you; you cannot bring yourself to. You turn wearily from Progue back to your canvas."; force discuss eea_whattopaint.
Instead of saying farewell to or thanking ep-Progue when last beat is eea_takebrush: say "He clutches your outstretched hand warmly for a long moment.[paragraph break][cookiemetaphor].' He smiles and you smile back, then release him and turn to your canvas."; force discuss eea_whattopaint.
Instead of giving something to ep-Progue when last beat is eea_takebrush: say "You hand [the noun] to Progue. Wordlessly he accepts it, holds it delicately and studies it in the light of the setting sun. Then he clutches your hand for a long moment.[paragraph break][cookiemetaphor].'[paragraph break]Finally he releases his grip, and you turn to your canvas."; force discuss eea_whattopaint.
eea_saynothing is a beat in EEA with reaction "You can think of nothing to say or do or think in this moment, suspended somehow from relentless gravities of time. And it seems that neither can Progue. He stares back, also wordless, for long moments.[paragraph break]But finally something passes between you, perhaps without either of you willing it, and you nod, and breathe, and turn to your canvas.". eea_saynothing enqueues eea_whattopaint.

[{Progue hands you a brush.[otherwise]The blue paint, which you pounded all yesterday from mud and somenium crystals, rests atop the counter, the last of the paints to be gathered and prepared.[end if] The canvas is ready. ]

eea_whattopaint is a beat in EEA with reaction "'And do you know, wayfarer,' Progue says quietly, as your eyes ride smoothly over the taut, textured surface of the hide, 'do you know what it is you will paint today?'". The yes-beat of eea_whattopaint is eea_yes. The no-beat of eea_whattopaint is eea_no. eea_whattopaint summons eea_yes, eea_no. eea_whattopaint suggests eea_no. eea_whichcolor replaces eea_whattopaint.

eea_yes is a beat in EEA with keyword name "yes" and reaction "He nods. 'Yes. Yes, I thought you did.'". eea_yes enqueues eea_whichcolor.

eea_no is a beat in EEA with keyword name "no" and reaction "He nods. 'Good,' he says, 'then you will not be disappointed, whatever you find.'". eea_no enqueues eea_whichcolor.

eea_whichcolor is a beat in EEA with reaction "'Well. Your paints await you: [t]red[x], [t]yellow[x], [t]green[x], [t]black[x], [t]white[x], and [t]blue[x]. To begin you must only dip your brush in one.'[paragraph break]He rests his hand on the workbench for a moment, looking searchingly into its grain, then abruptly turns to the open doorway. He pauses one last moment, turning back to watch.[paragraph break]'Go on, then,' he says, 'which will it be?'". eea_whichcolor summons eea-blue, eea-other. eea_whichcolor suggests eea_proguewaits. Instead of examining a paintpot when eea_whichcolor is spoken: if noun is pot of blue paint, force discuss eea-blue; else force discuss eea-other.

eea_proguewaits is a repeatable beat in EEA with reaction "Progue [one of]waits silently for you to make the choice[or]stands quietly, waiting for you to choose[at random].". eea_proguewaits suggests eea_proguewaits.

Understand "blue" as eea-blue when last beat is in EEA. eea-blue is a terminal beat in eea with keyword name "blue" and fuse 99 and reaction "Trembling, you reach your brush towards the blue paint. The swirls of powdered crystal sparkle brilliantly in the morning sun, slanting through the window, and as bristles join its surface, vague whispered ripples disturb some rare medium of thought, memory, longing[unless Progue is dead].[paragraph break]Progue nods once, gives you one last smile, and then is gone[end unless].[paragraph break]You lift the blue-tipped brush to the canvas, eyes closed, and picture Rume. But not just with your mind. You picture [if Rume is male]him[else]her[end if] with each cell in your lone and travelworn body. You picture [if Rume is male]him[else]her[end if] with the hair you once touched and skin once shared. You picture Rume with hand, palm, knuckles, fingers, with every bristle of the blue-stained brush to the potent atoms at its tip, crushed molecules of an impossible substance that dreams with you an impossible dream, and slowly begin to paint.[paragraph break]The bristles touch canvas, and the sound they make is a delicate sigh, clung to the near edge of silence.".

Understand "red/green/yellow/white/black" as eea-other when last beat is in EEA. eea-other is a terminal beat in eea with keyword name "red, green, yellow, white and black" and fuse 99 and reaction "[nonbluecolending]".

To say nonbluecolending:
	let tcol be 1;
	if the player's command includes "red":
		let tcol be 1;
	else if the player's command includes "green":
		let tcol be 2;
	else if the player's command includes "yellow":
		let tcol be 3;
	else if the player's command includes "white":
		let tcol be 4;
	else if the player's command includes "black":
		let tcol be 5;
	say "You reach your brush out and submerge it in the thick [if tcol is 1]red[else if tcol is 2]green[else if tcol is 3]yellow[else if tcol is 4]white[else]black[end if] paint. Soon you will blend it with other colors, but it feels right that your first touch to the canvas should be pure, unmixed[unless Progue is dead].[paragraph break]Progue nods once, gives you one last smile, and then is gone[end unless].[paragraph break]You touch the brush to the hide, tentative, caressing. ";
	say "[if tcol is 1]The red smears its surface like blood, rich heart-blood that flows deep inside[else if tcol is 2]The green streaks across its surface, a shock of forest and emerald and spring[else if tcol is 3]A shock of yellow brightens its surface, the lemon-yellow hue that brought you here years or hours ago[else if tcol is 4]Pure white soaks into the hide, snow and clouds and fog-wrapped air[else]Ink black seeps into the hide, midnight and dream[end if]";
	say ", and in that instant, with prickles of nerve memory, at last you know the way forward.".
		
After discussing eea-blue: end the game in victory. After discussing eea-other: end the game in victory.

Instead of landmark-going or going or exiting or retreating during Epilogue-Ending-A: say "You have unfinished business with your canvas.". First check landmark-going during Epilogue-Ending-A: say "You have unfinished business with your canvas.".



After reading a command when Epilogue-Ending-A is happening and Progue is dead: if the player's command matches the text "blue", force discuss eea-blue; if the player's command matches the text "red" or the player's command matches the text "yellow" or the player's command matches the text "black" or the player's command matches the text "white" or the player's command matches the text "green", force discuss eea-other.






Chapter - Ending B (Progue-centric)

Section - Dream

[If ENDING B, the conversation is with a grown Lethe, and about the loopholes in wayfaring, and designed to make the player realize Progue might still have a chance to be reunited with his daughters. ]

EPLP is a thread with escape clause eplp_escape. [Epilogue - Like Progue] Instead of exhausting when last beat is in EPLP: force discuss eplp_escape. Instead of getting bored when last beat is in EPLP: force discuss eplp_escape. eplp_escape is a repeatable dogged ephemeral beat in EPLP with reaction "'Well,' she says, 'but there is more to say.'". eplp_escape enqueues eplp_intro.

eplp_intro is an exciting beat in EPLP with reaction "Before you stands a beautiful [o]woman[x], slowly running a comb with a carved dolphin for a handle through her long black hair. Her features are strangely familiar, and you finally realize you have seen her before. In dreams.". eplp_intro suggests eplp_samechoice. eplp_lessons replaces eplp_intro.

ep-lethe is a woman with printed name "Lethe". Understand "Lethe/girl/woman/daughter" as ep-lethe. The description is "Lethe. How she must look now, as a grown woman-- but some part of you realizes this is not really her-- just a dream. No tricks, no messages, but dream, just and only.".


To say eplp_intro2: say "'How strange are meetings that come too late,' she says quietly, running the brush smoothly through her hair and not quite meeting your gaze. 'For you have already been me in dreams, seen my most intimate drawings from childhood to my first masterpiece, loved me through the eyes of my father, and through his hands and words and memories as well.' She nods, as if to herself. 'Yes, introductions now would be quite redundant. Especially since somehow I feel I know you equally well.'[paragraph break]'For instance,' she says quietly, looking into your eyes for the first time, '".

eplp_diffchoice is a beat in EPLP with reaction "[eplp_intro2]I know of a moment, worlds and time ago, when you also made this choice between art and love, and chose differently. In Rume's bed you chose [if we chose art]art, and now, now, you choose love[else]love, and now, now, you choose art[end if]. So what changed, then? Did something of my [eplp_father] seep within you to alter your priorities? Or maybe something in those two great [eplp_societies] vying for control of that island? Or,' she says with a wry smile, 'perhaps this was so long ago you no longer [eplp_remember] why you once chose the way you did?'". eplp_diffchoice suggests eplp_choicenoans.

eplp_samechoice is a beat in EPLP with reaction "[eplp_intro2]we have met many wayfarers now, my sister and I. And they are mercurial, many perhaps schizophrenic; the only way they stay sane in lives defined by change is to change themselves. Yet on a cold night worlds and time ago, when you also made this choice between love and art, you chose the same way. How can you remain yourself? Through strength of [eplp_conviction], mayhaps, or something simpler: it merely felt [eplp_right] to you then as it does now? Or,' she adds with a wry smile, 'perhaps this was so long ago you no longer [eplp_remember] why you once chose the way you did?'". eplp_samechoice suggests eplp_choicenoans. 

eplp_choicenoans is a beat in EPLP with reaction "'Well, no matter,' she says, the brush moving rhythmically through her long hair. 'None of my business, I suppose.'". eplp_choicenoans enqueues eplp_whenyoumet.

Understand "father" as eplp_father when last beat is in EPLP. eplp_father is a beat in EPLP with keyword name "father" and reaction "She looks away, touches of sadness hardening the smoothness of her face, the brush moving rhythmically through her long hair. 'My father changes all who meet him,' she says finally, 'for better or for worse.' She closes her eyes for a moment, then opens them again, stronger. 'No,' she says, 'My anger at him has long since melted away, though he has not yet burned his guilt. [if second-choice-love is true]Love is the right choice, friend. It burns most brightly of all[else]Art can burn them both away, my friend, but so many other things as well. Take care what you set aflame[end if].'". eplp_father enqueues eplp_whenyoumet.

Understand "society/societies" as eplp_societies when last beat is in EPLP. eplp_societies is a beat in EPLP with keyword name "societies" and reaction "She stares into the void intently, the brush moving smoothly now through her hair. 'I dreamed with you through those two worlds,' she says. 'And I kept wondering who it was who had Called you. My father? That quiet, sad leader of a struggling, violent people? The whisper of windsigh trees across a milky spiral of stars[if The-Path-Of-Love has happened]? Even my sister, or I, all those years ago[end if]?' She shakes her head. 'Or all or none of them,' she says. 'The Call defies understanding. But it always changes you; I've learned that, and my sister too. Always is change.'". eplp_societies enqueues eplp_whenyoumet.

Understand "conviction" as eplp_conviction when last beat is in EPLP. eplp_conviction is a beat in EPLP with keyword name "conviction" and reaction "She considers, the brush moving smoothly now through her hair. 'I'm not sure I believe in conviction,' she says. 'Certainly not in absolute moralities or universal truths; I've moved through enough worlds to be disabused of such comforting notions. Phoebe would disagree. But. Now inner conviction, consistency of self-- hmm.' She smiles to herself. 'It's a rare quality in we who wayfare,' she adds finally. 'Treasure it, friend.'". eplp_conviction enqueues eplp_whenyoumet.

Understand "correct" as eplp_right when last beat is in EPLP. eplp_right is a beat in EPLP with keyword name "correct" and reaction "She smiles knowingly, the brush moving smoothly now through her hair. 'How strange it is,' she murmurs, 'to look back into the dusty corners of our lives, and find some past self who utterly and completely agrees with us. Or mayhaps it's not strange at all for most people, but for me, I find change the only constant. It's always something shocking to discover I was once the same person.' She laughs, but softly, quietly, and the lilting sound soon dies away.". eplp_right enqueues eplp_whenyoumet.

Understand "remember" as eplp_remember when last beat is in EPLP. eplp_remember is a beat in EPLP with keyword name "remember" and reaction "She laughs aloud; not spitefully, a kind, simple laugh alive with lilting echoes and harmonies. 'I think Phoebe would like you,' she says. 'You both prefer to go clothed in plain and simple truths rather than over-thought justifications and rationalizations. I like you too, I suppose, even if only because you remind me of her.'". eplp_remember enqueues eplp_whenyoumet.

eplp_whenyoumet is a beat in EPLP with reaction "She turns serious, staring down at the brush in her hands and running an idle finger over its intricate details. 'When you met my father he was only half a man. Or--' she smiles a little, not looking up, '--two thirds of one, as he put it. He had lost so much.'".

After discussing eplp_whenyoumet:
	if neurotic dad begin; force discuss eplp_neuroticdad;
	else if father knows best; force discuss eplp_fatherknowsbest;
	else if bitter dad; force discuss eplp_bitterdad;
	else if disciplinarian; force discuss eplp_disciplinarian;
	else if friend; force discuss eplp_friend;
	else if toady; force discuss eplp_toady;
	else if lover or twitterpated; force discuss eplp_lover;
	else if enemy; force discuss eplp_enemy;
	else if slave; force discuss eplp_slave;
	else if bitter lover or shattered lover; force discuss eplp_bitterlover;
	else; force discuss eplp_friend;
	end if;
	continue the action.

eplp_neuroticdad is a beat in EPLP with reaction "'Yet somehow he came to think of you like a [if player is male]son[else]daughter[end if],' she says, 'although he didn't quite remember how to be a father again. ". eplp_neuroticdad enqueues eplp_intended.

eplp_fatherknowsbest is a beat in EPLP with reaction "'Yet somehow he came to think of you like a [if player is male]son[else]daughter[end if],' she says, 'and he remembered the best and worst parts of his fatherhood.". eplp_fatherknowsbest enqueues eplp_intended.

eplp_bitterdad is a beat in EPLP with reaction "'Yet somehow he came to think of you like a [if player is male]son[else]daughter[end if],' she says, 'though a disrespectful one, mayhaps. You frustrated him, I think, because he thought he knew what was best, even though you didn't always get along and he didn't always have the courage to tell you.'". eplp_bitterdad enqueues eplp_intended.

eplp_disciplinarian is a beat in EPLP with reaction "'Yet somehow he came to think of you like a [if player is male]son[else]daughter[end if],' she says, 'though a disobedient one. Like my sister and I; you awoke old frustrations in him, I think, though at least the two of us could sometimes get along with him.'". eplp_disciplinarian enqueues eplp_intended.

eplp_friend is a beat in EPLP with reaction "'Yet you became a friend to him, when he needed a friend,' she says, 'and I thank you for that.'". eplp_friend enqueues eplp_intended.

eplp_toady is a beat in EPLP with reaction "Yet you became a friend to him, of a sort, when he needed a friend,' she says. 'No, more than need; he was so desperate for companionship that he was perhaps too quick to let you have your way.'". eplp_toady enqueues eplp_intended.

eplp_lover is a beat in EPLP with reaction "She smiles quietly at you. 'He saw something in you,' she says, 'that reminded him of... [if player is female]my mother, perhaps, or maybe you're nothing like her at all[else]himself, perhaps, or maybe his first love, lost worlds ago[end if]. I'm not sure; I don't know you.' She takes a deep breath. 'But whatever it was, I thank you for showing it to him. After our mother died, his grief was a weight that crushed us all, and he had no sense of how to take any of the weight off his daughters. Maybe no parents in such circumstances do, maybe...' She bites her lip and trails off. 'I don't know,' she finally says. 'All I can offer, again, is my thanks. For making him happy again.'". eplp_lover enqueues eplp_intended.

eplp_enemy is a beat in EPLP with reaction "'But you did not see eye to eye, you two,' she says sadly, 'and I think that has always been his curse. He is so headstrong that he cannot let other people in; cannot understand them or believe in them. Even my sister and I...' She bites her lip. 'A difficult man,' she finally concludes.". eplp_enemy enqueues eplp_intended.

eplp_slave is a beat in EPLP with reaction "'But you did not see eye to eye, you two,' she says sadly, 'and he became almost like a slave to you, didn't he? So eager and desperate to please you, even though he feared and distrusted you. Mayhaps he was too far gone to be a friend to anyone.'". eplp_slave enqueues eplp_intended.

eplp_bitterlover is a beat in EPLP with reaction "She smiles quietly at you. 'He saw something in you,' she says, 'that reminded him of... [if player is female]my mother, perhaps, or maybe you're nothing like her at all[else]himself, perhaps, or maybe his first love, lost worlds ago[end if]. I'm not sure; I don't know you.' She takes a deep breath. 'But it didn't last. No, of course it couldn't; it was only a dream. And he ended more hurt than when he began. It was hard for him. I'm not sure whether I should hate you or whether he deserved it.'". eplp_bitterlover enqueues eplp_intended.

eplp_intended is an insistent beat in EPLP with reaction "'Now he is-- perhaps not whole, not yet, but at least he is refilling. Scabs have been torn off but the flow has reversed, and the world once again flows through his tender wounds to mingle with his blood.'[paragraph break]'Is that how you thought it would work out,' she asks, turning her head to the side, 'when you first saw him, standing on that boulder and shouting at the sea?'". The yes-beat of eplp_intended is eplp_intyes. The no-beat of eplp_intended is eplp_intno. eplp_intended summons eplp_intyes, eplp_intno.

Instead of getting bored when last beat is eplp_intended or last beat is eplp_pleased, force discuss eplp_lessons.

eplp_intyes is a beat in EPLP with keyword name "yes". eplp_intyes enqueues eplp_pleased.

eplp_intno is a beat in EPLP with keyword name "no". eplp_intno enqueues eplp_pleased.

eplp_pleased is an insistent beat in EPLP with reaction "'[if eplp_intyes is spoken]And[else]But then[end if] are you happy with the way things turned out[if eplp_intno is spoken], anyway[end if]?' she asks.". The yes-beat of eplp_pleased is eplp_plyes. The no-beat of eplp_pleased is eplp_plno. eplp_pleased summons eplp_plyes, eplp_plno.

eplp_plyes is a beat in EPLP with keyword name "yes" and reaction "She smiles, touching a fingertip delicately to each bristle of the brush, one by one. 'I'm glad,' she says. 'He has been so alone these long years, choosing to forget there were those who remembered him, rather than wonder if they still did.'". eplp_plyes enqueues eplp_lessons.

eplp_plno is a beat in EPLP with keyword name "no" and reaction "She nods somberly, touching a fingertip delicately to each bristle of the brush, one by one. '[if eplp_intyes is spoken]And that in a flash is humanity,' she says, 'always expecting what it does not get. How strange. One would think we'd know ourselves better, by now[else]He was not much of a friend to you, I suppose. And he was not much of a father to Phoebe and me. I think perhaps he gave everything he was and had to my mother. And when she died, he no longer knew how to love anyone but her[end if].'". eplp_plno enqueues eplp_lessons.

eplp_lessons is a beat in EPLP with reaction "With a sudden flick of her wrist, she releases the comb, which twirls away and is swallowed by the void. She looks after it for one wistful moment, then turns to you, taking a step closer.[paragraph break]'There is something about [eplp_wayfaring],' she says, 'which my [eplp_sister] and I learned, but Progue never did, and you may or may not have: there are [eplp_loopholes].' A corner of her mouth rises in a smile.". eplp_lessons suggests eplp_loopholes. eplp_loopholes replaces eplp_lessons.

Understand "wayfaring" as eplp_wayfaring when last beat is in EPLP. eplp_wayfaring is a beat in EPLP with keyword name "wayfaring" and reaction "'We call it The Magic,' she says with a smile, 'Phoebe and I. But I like your word better.'". eplp_wayfaring suggests eplp_loopholes.

Understand "sister" as eplp_sister when last beat is in EPLP. eplp_sister is a beat in EPLP with keyword name "sister" and reaction "'Phoebe takes credit for it, I suppose,' she says, grinning, 'but it was my idea, my theory, to start with.'". eplp_sister suggests eplp_loopholes.

Understand "loophole/loopholes" as eplp_loopholes when last beat is in EPLP. eplp_loopholes is a beat in EPLP with fuse 8 and keyword name "loopholes" and reaction "'At least three,' she says, 'some more obvious than others but all inherent in its nature.'[paragraph break][if player is female]She puts a hand on your forearm and squeezes it briefly[else]She puts a hand to your face and drinks deeply from your eyes for a long moment[end if], then turns away, looking at a simple wooden [o]door[x] which has suddenly appeared in the void.[paragraph break]'One,' she says briskly, 'parents can bring children with them when they wayfare, since the children are their creations. You most likely know this: it's how Phoebe and I came with our father when he sculpted the windsigh tree and we came to Lacuna.'[paragraph break]'Two,' she continues, moving slow but strained towards the door, as if reluctant, 'the Call itself. Saying goodbye to a fellow wayfarer never has to be forever; there is always the chance you will be called to her again, or she to you. And it may not be as random and mysterious as we think. Phoebe and I cannot quite do it at will-- but many times now have we found each other, when we are in need.'[paragraph break]She takes a deep breath, and opens the door; behind it is only more void. 'Three,' she says, carefully. 'You can never go back. But nothing prevents you and another from going the same forward.' She winks, then slips through the door and shuts it behind her.".

After discussing eplp_loopholes: post-conversation processing; move ep2-door to location; continue the action.

An ep2-door is a container. It is closed and fixed in place. The printed name is "simple wooden door". Understand "simple/wooden/door/brass/knob" as ep2-door. The description is "The door is made from unadorned wood, unpainted and unsanded, with a simple brass knob.". Instead of turning ep2-door, try opening ep2-door. Instead of opening ep2-door for the first time: say "You reach forward to open the door, only to discover you are holding [o]something[x]."; move ep2-brush to player. Instead of opening ep2-door: try examining ep2-brush. Check turning ep2-door: try opening ep2-door. 

An ep2-brush is a thing. The printed name is "carved brush". Understand "brush/dolphins/lethe's/lethes/handle/something/holding" as ep2-brush. The description is "You open your hand to find it gripping Lethe's brush, the carved dolphins along its handle swimming against the lines and swirls of your hand.[paragraph break]'Tell him,' Lethe's voice comes from somewhere, distant and muffled. 'Tell him we wait for him. Tell him to go forward. Tell him we may yet find each other again.'[paragraph break]The dream fades, and your solid grip on the brush becomes your grip on the waking world.". 

A brush-echo is a minor prop with description "You look down into your hand, but the brush is gone-- just a dream.".

Section - Coda

[Opening - look / interact etc.
Then important decisions only: do we tell Progue about the dream? (if not he sculpts anyway, text slightly different). How do we say farewell to Progue.]

After examining ep2-brush: 
	say "You open your eyes.";
	begin chapter 11;
	change the time of day to 7:25 AM; 
	change the time factor to 1;
	remove Progue from play;
	move ep-Progue to Stumps;
	now ep-Progue is attentive;
	pre-conversation processing;
	now tempfuse of eeb_intro is 5;
	remove ep2-brush from play;
	move brush-echo to Stumps;
	change the initial appearance of ep-Progue to "[o]Progue[x] stands quietly nearby, hands folded before him, staring at the rough-hewn block of stone intently.";
	change the description of ep-Progue to "Some immense calm exudes from his skin, a focus and clarity of being you have never seen from him. He hardly seems to breathe and yet it is as if the whole world is flowing into him.";
	move player to Stumps; 
	now tempfuse of eeb_intro is 5.

Epilogue-Ending-B is a scene. Epilogue-Ending-B begins when eplp_intro is spoken.

Instead of greeting ep-Progue when Epilogue-Ending-B is happening, force discuss eeb_intro. Instead of getting bored when Epilogue-Ending-B is happening and location is Stumps: pre-conversation processing; force discuss eeb_intro. Instead of saying farewell to when Epilogue-Ending-B is happening: force discuss eeb_intro.

EEB is a thread. eeb_intro is a beat in eeb with keyword name "hello" and fuse 25 and reaction "He stirs, slow and almost imperceptible at first, then turns to you, movements gathering speed and vim. As his languorous eyes reach yours, he smiles.[paragraph break]'And good morning and good morning,' he says, 'and good morning as well. There really is something good about it, can't you feel? Some supple magnetism in the air.' He takes a deep breath, and turns back to the block of stone. 'I think,' he says, 'I think, I think... this is the Day. Last Lacuna morning. The fade of [t]dream[x] and the rise of wake.'". eeb_intro summons eeb_dream, eeb_nodream. eeb_intro suggests eeb_nodream. eeb_dream replaces ddb_intro.

Understand "dream" as eeb_dream when last beat is in EEB. eeb_dream is a beat in EEB with keyword name "dream" and reaction "[noteeebdream]He listens quietly as you tell him your dream, his expression guarded and tense, as if poised for flight.[paragraph break]When you are finished, he closes his eyes, and takes a long, deep breath.[paragraph break]'[if romance of Progue >= 0]Dear one[else if paternalism of Progue >= 3]My child[else]My friend[end if],' he says quietly, 'I have always known this. Fragments of I, ratherly. And no, I don't think it was ever even forgotten... just hiding in shadows of grief, waiting. Waiting to be thought again.'[paragraph break]He [if romance of Progue >= 4]kisses you, long and soft[else if paternalism of Progue >= 3]puts a hand on your shoulder and squeezes[else]claps a hand to your back[end if], then steps away. 'Once again our dreams show the way,' he says. 'Do we wayfarers live in dreams? Or do universes live in ours?'". eeb_dream enqueues eeb_sculptsequence. To say noteeebdream: now eebdreamspoken is true. eebdreamspoken is a truth state that varies. eeb_sculptsequence replaces eeb_dream.

eeb_nodream is a beat in EEB with keyword name "listen" and reaction "He takes a long breath, staring past you into blue distances. 'I've given long and long hours of thought to the what,' he says, 'the subject of my sculpture. Most times it was animals, in eons past; sometimes some bony peak or-- or tree.' He pauses. 'Not today, I think. Today there is a she. I think or think I think her voice, in my head, in my hands. I think mayhaps she calls for me. Not... not Calls,' he amends carefully, 'not near that strong. But I think she will be glad to see me.'". eeb_nodream enqueues eeb_sculptsequence.

eeb_sculptsequence is a beat in EEB with reaction "He kneels, running delicate hands over the hammer and chisel at his feet, then slowly, carefully hefts them, turning back to the block of stone.[paragraph break]The sun moves through the sky.[paragraph break]Slowly, dimpled curve by softened angle, hair by breast by thigh by mouth, a woman unmelts from the cold hard rock. She is beautiful and austere. [if eebdreamspoken is true]But she is not Lethe, and not Phoebe. [end if]As her face takes shape you see it is a troubled face, twisted by sadness, but something she sees brings a small spark of joy or comfort to it. A protruding lump of stone becomes an outstretched hand, stretching forward in greeting, desperate almost for a kind touch, the warmth of simple skin.[paragraph break]The sun is setting over the waves when Progue steps back, only one eye left for the sculpture to be complete. You should be tired or hungry or sore or bored, but you are none of them. Progue truly is a master, perhaps one of the best you've ever seen.[paragraph break]He turns to you and you know he is moments from gone.". eeb_dream suggests eeb_saynothing. After discussing eeb_sculptsequence: now the time of day is 7:01 PM; continue the action. eeb_sculptsequence cancels eeb_dream.

Instead of hugging ep-Progue when last beat is eeb_sculptsequence: say "You hug Progue and he hugs back, his weatherworn cheek pressed against your neck, and [weatherwornbit]. You step back and he smiles at you, complete. And you know he is ready to leave. He turns to the statue woman."; force discuss eeb_outtro.
Instead of kissing ep-Progue when last beat is eeb_sculptsequence: say "You kiss Progue [if romance of Progue > 3]gently and tenderly, raising one hand to his weatherworn face[else]on each weatherworn cheek, an old custom from past worlds that seems somehow appropriate[end if], and [weatherwornbit]. You step back and he smiles at you, complete. And you know he is ready to leave. He turns to the statue woman."; force discuss eeb_outtro.
Instead of pushing or attacking ep-Progue when last beat is eeb_sculptsequence: say "Here, at this final moment, all the anger and violence has drained from you; you cannot bring yourself to. Progue meets your weary gaze levelly, holds it for a long moment, then turns back to the statue woman."; force discuss eeb_outtro.
Instead of saying farewell to or thanking ep-Progue when last beat is eeb_sculptsequence: say "He clutches your outstretched hand warmly for a long moment.[paragraph break]'I have no words to thank you for all you have given me,' he says, 'but well and here I'm saying some anyway. Moisty hells.' He squeezes temples of eyes suddenly reddening, and laughs in embarrassment, turning it into a sniffle. [cookiemetaphor].' And he turns to the statue woman."; force discuss eeb_outtro.
Instead of giving something to ep-Progue when last beat is eeb_sculptsequence: say "You hand [the noun] to Progue. Wordlessly he accepts it, holds it delicately and studies it in the light of the setting sun. Then he clutches your hand for a long moment.[paragraph break][cookiemetaphor].' And he turns to the statue woman."; force discuss eeb_outtro.
eeb_saynothing is a beat in EEB with reaction "You can think of nothing to say or do or think in this moment, suspended somehow from relentless gravities of time. And it seems that neither can Progue. He stares back, also wordless, for long moments.[paragraph break]But finally something passes between you, perhaps without either of you willing it, and he nods, and breathes, and turns back to the statue woman.". eeb_saynothing enqueues eeb_outtro.
Instead of examining distant ocean when last beat is eeb_sculptsequence: say "You raise a hand in farewell, but Progue grasps it and shakes it vigorously instead.[paragraph break]'I have no words to thank you for all you have given me,' he says, 'but well and here I'm saying some anyway. Moisty hells.' He squeezes temples of eyes suddenly reddening, and laughs in embarrassment, turning it into a sniffle. [cookiemetaphor].' And he turns to the statue woman."; force discuss eeb_outtro. 


To say weatherwornbit: say "it occurs to you that both of you are so worn: by weather, time, and chance: the abrading force of life". To say cookiemetaphor: say "'Friendships are like cookies, someone somewhere said, though,' he sighs, 'I can't remember quite why. Ah well-oh. Goodbye then, wayfarer"

eeb_outtro is a beat in EEB with reaction "The last eye is finished as the sun slips beneath the waves. As twilight grows, the statue seems to gather shadow and suppleness, like dew settling on flowers, as if melding with the indistinct edge of night gives her some animus of life.[paragraph break]Finally in the failing dimness Progue drops his hammer and chisel, staring at her, and takes her hand.[paragraph break]For a sliver of instants you think the stone hand grips his in warm return, pulls him forward...[paragraph break]He is gone.[paragraph break]The stone woman smiles at you, but she is only stone. You are alone now on Lacuna.[paragraph break]But a current runs faintly through your fingertips. The Call has been answered.[paragraph break]And at last you begin to wonder what and where you will paint next."

After discussing eeb_outtro: end the game in victory.

Instead of landmark-going or going or exiting during Epilogue-Ending-B: say "You have unfinished business here.".


Chapter - Epilogue C (Player-centric)

Section - Dream

ep-dr-quick is a person with printed name "Dr. Quick". Understand "dr" or "doctor" or "quick" or "man" or "scientist" as ep-dr-quick. The description is "Finally, you see [if DrQuick is male]him[otherwise]her[end if] with your own eyes.".

EPLN is a thread [Epilogue - Like nobody.] with escape clause epln_escape. Instead of exhausting when ep-dr-quick is enclosed by location: force discuss epln_escape. Instead of getting bored when last beat is in EPLN: force discuss epln_escape. epln_escape is a repeatable dogged ephemeral beat in EPLN with reaction "'Well,' he says, 'but there is more to say.'". epln_escape enqueues epln_intro2.

To say drheshe: say "[if DrQuick is female]s[end if]he". To say drhisher: say "[if DrQuick is female]her[else]his". To say CDrHeShe: say "[if DrQuick is male]He[else]She".

epln_intro is an exciting beat in EPLN with reaction "As you choose the dream sea fades, or rather condenses, resolving into a figure standing before you in the void-- a [if DrQuick is female]wo[end if]man with a shock of white hair, dressed in thick round glasses and a lab coat, and a wry, knowing smile. Dr. [o]Quick[x].". epln_intro suggests epln_intro2. 

epln_intro2 is a beat in EPLN with reaction "'So at last we meet face to face,' [drheshe] says, 'rather than face to dream or face to mind. Although to be quite exact, which I do prefer, I should say this isn't a real meeting either.' Smiling, [drheshe] adjusts [drhisher] glasses. 'No, there's no long distance communication here, no sub-cranial trickery. This is, at long last, just and only a dream.' The doctor raises an eyebrow. 'But nice all the same, don't you think?'". epln_intro2 enqueues epln_samechoice. epln_noanswer replaces epln_intro2.

To say loveorartintro: say "'Psychology is a new field on my world,' the doctor says, scratching [drhisher] white head delicately, 'one I can't particularly be bothered with, to be honest. But I find it curious all the same your reaction to this question which seems to keep cropping up in your life. Love, or art".

epln_samechoice is a beat in EPLN with reaction "[loveorartintro]? Just now again you chose [if second-choice-love is true]that seductive muse, love[else]the lonely path of the artist[end if], just as you did in another dream on another world, quite some subjective time ago.' [CDrHeShe] peers at you critically through the thick round glasses. 'Forgive my forwardness, but I'm curious. Is this a life philosophy you decided on long [epln_ago], or do you simply live in the [epln_moment] and each answer merely felt right at the time? Or,' [drheshe] adds, smiling wryly, 'am I reading too much into this and you no longer [epln_remember] why you made the first choice?'". epln_samechoice suggests epln_noanswer.

Understand "ago" as epln_ago when last beat is in EPLN. epln_ago is a beat in EPLN with keyword name "ago" and reaction "Dr. Quick shakes [drhisher] head. 'You'd made a curious case study for some overeager student in this new psychiatry,' [drheshe] says with a droll smile. 'Constancy in the face of change. Absolute morality in a life divorced from absolutes. Yes, [if player is female]my dear[else]good sir[end if], you are the stuff of which theses are made.'". epln_ago enqueues epln_junction. epln_ago cancels epln_remember, epln_moment.

Understand "moment" as epln_moment when last beat is in EPLN. epln_moment is a beat in EPLN with keyword name "moment" and reaction "'And the theoretically fascinating thing about that,' the doctor says, scratching [drhisher] cheek thoughtfully, 'is that living in the moment is all you're able to do, is built into your very nature. Perhaps there is a capacity in you for change, for reevaluating yourself even to your core beliefs, that we normal folk think we have but most often, in fact, do not.'[paragraph break][CDrHeShe] flashes a droll smile. 'Forgive the waxing,' [drheshe] adds, 'it's just, [if player is female]my dear[else]good sir[end if], that you are the stuff of which theses are made.'". epln_moment enqueues epln_junction. epln_moment cancels epln_remember, epln_ago. 

Understand "remember" as epln_remember when last beat is in EPLN. epln_remember is a beat in EPLN with keyword name "remember" and reaction "Doctor Quick smirks. 'For a scientist,' [drheshe] says, 'I spent inordinate amounts of time worrying about our quest for meaning. We are beings designed to make patterns out of noise. It is immaterial whether the patterns are really there.' [CDrHeShe] adjusts [drhisher] glasses. 'I am a scientist because I was a scientist yesterday. Whatever meaning one attempts to ascribe to that is lost in unreal, untestable, unfalsifiable pasts. We haven't yet invented nihilism in City, but oh, will it hit us hard when we do.'". epln_remember enqueues epln_junction. epln_remember cancels epln_moment, epln_ago. 

epln_diffchoice is a beat in EPLN with reaction "[loveorartintro]? In another dream, on another world, you once chose [if we chose art]art[else]love[end if], but tonight you've instead chosen [if second-choice-love is true]that seductive muse, love[else]the lonely path of the artist[end if]. Forgive my forwardness, but I'm curious. Did something in your [epln_experiences] with my people, or Forest, or Progue, alter your perspectives? Do you simply live in the [epln_moment] and each answer merely felt right at the time? Or,' [drheshe] adds, smiling wryly, 'am I reading too much into this and you no longer [epln_remember] why you once chose differently?". epln_diffchoice suggests epln_noanswer.

epln_noanswer is a beat in EPLN with reaction "'Well, no matter,' [drheshe] says.". epln_noanswer enqueues epln_experiences. epln_experiences replaces epln_noanswer.

Understand "experience/experiences" as epln_experiences when last beat is in EPLN. epln_experiences is a beat in epln with keyword name "experiences" and reaction "'And if I might press farther,' [drheshe] asks, 'was it one of those? [epln_city], [epln_forest], [epln_progue], or something [epln_else]?'". epln_experiences cancels epln_remember, epln_moment. epln_function replaces epln_experiences. epln_experiences suggests epln_else.

Understand "city" as epln_city when last beat is in epln. epln_city is a beat in epln with keyword name "City" and reaction "'I'm not sure whether to be flattered or disturbed,' Doctor Quick says, brushing something distractedly from [drhisher] lab coat. '[if second-choice-love is true]Something about us inspired you to follow your passions, perhaps? Or our tenuousness made you realize what truly mattered to you?[else]Something about our passion for Ideals and Dreams and Capitalized Concepts inspired you, perhaps? Or something convinced you the transformative power of art was worth spending measures of happiness for?[end if] Interesting.'". epln_city enqueues epln_else.[aar]

Understand "forest" as epln_forest when last beat is in epln. epln_forest is a beat in epln with keyword name "Forest" and reaction "Doctor Quick frowns. '[if second-choice-love is true]Something about the soullessness of their sterile world pushed you further towards passion, perhaps?[else]Something about a world and people without art made you glimpse its importance, perhaps?[end if] The contrast with that of my own people brought clarity?'". epln_forest enqueues epln_else.

Understand "progue" as epln_progue when last beat is in epln. epln_progue is a beat in epln with keyword name "Progue" and reaction "The left side of the doctor's mouth twitches. '[if second-choice-love is true]He was a man who'd lost everything he loved, wasn't he?' [drheshe] muses. 'Maybe some things are more important[else]Maybe you needed to meet a man who'd lost his gift,' [drheshe] muses, 'before you could truly appreciate your own[end if].'". epln_progue enqueues epln_else.

Understand "else" as epln_else when last beat is in EPLN. epln_else is a beat in EPLN with keyword name "else" and reaction "[CDrHeShe] smiles quietly. 'Whatever your reasons,' [drheshe] adds, 'and indomitable cynicism aside, it's a good change. [if second-choice-love is true]Art makes mere reflections of life. Love lives it[else]Art makes the world worth loving in[end if].'". epln_else suggests epln_junction. epln_else cancels epln_mature, epln_trust, epln_forest, epln_progue, epln_city. [R4]epln_outtro replaces epln_else.[R4]

epln_junction is a beat. epln_junction enqueues epln_trees. epln_outtro replaces epln_junction.

epln_trees is a beat in EPLN with reaction "'But in the end,' [drheshe] continues delicately, 'you did not choose us. You chose Forest, and now their conjoined civilization will grow and flourish, while ours...'[paragraph break]'Did you think we were not [epln_mature] enough to have access to the somenium? Or did you not [epln_trust] us? Or something [epln_else] I can't guess?'". epln_trees suggests epln_else. epln_outtro replaces epln_trees.

Understand "mature" as epln_mature when last beat is in EPLN. epln_mature is a beat in EPLN with keyword name "mature" and reaction "The doctor pauses, drumming fingers against [drhisher] cheek, considering.[paragraph break]'Hmm,' [heshe] says finally, 'yes, perhaps we are too violent, destructive, unsteady to deserve survival. Perhaps our problems would not be solved by spreading our immature species throughout the galaxy. But perhaps they would. You've robbed us of the chance to find out.'". epln_mature suggests epln_outtro. epln_mature cancels epln_trust, epln_else.

Understand "trust" as epln_trust when last beat is in EPLN. epln_trust is a beat in EPLN with keyword name "trust" and reaction "[CHeShe] sighs. 'The censorship,' he says, 'the ever-growing power of Leader Tall. But it was necessary. If the Greeneyes had bombed the Beast, we'd never have been able to contact you. And even if they'd stolen our somenium, they're a generation away from developing their own technology to contact you. It was the one chance our planet had...' he stops, smiling slightly. 'But you've already made your choice, and I'm just a dream,' he appends. 'The time for convincing is long over.'". epln_trust suggests epln_outtro. epln_trust cancels epln_else, epln_mature. 

epln_rebels is a beat in EPLN with reaction "'And in the end,' [heshe] says levelly, 'you did choose us. You chose City, and now we may have a chance to take a stand against the creeping vines of Forest, to assert that it is possible for one person to both think and do. I thank you for that; our galaxy will be the richer for it.'". epln_rebels suggests epln_outtro.

epln_abstain is a beat in EPLN with reaction "'But in the end,' [heshe] says contemplatively, 'when faced with in the end a vastly more significant choice, you chose to abstain. You rejected the choice between our people and Forest, and left the decision to Fate instead.'[paragraph break]'I won't ask you to justify this decision,' [heshe] says, adjusting [hisher] spectacles, 'but I think I know why you made it. And maybe it's the right one. Time will tell.'". epln_abstain suggests epln_outtro. epln_outtro replaces epln_abstain.

epln_destroy is a beat in EPLN with reaction "'But in the end,' [heshe] says evenly, 'when faced with a vastly more significant choice, you rejected it, with violence. You destroyed the machinery that would have helped either our people or those of Forest, and now we're back where we started.'[paragraph break]'I'm not asking you to justify this decision,' [heshe] says, raising a hand, 'but I think I know why you made it. And maybe it's the right one. Time will tell.'". epln_destroy suggests epln_outtro. epln_outtro replaces epln_destroy.

epln_outtro is a beat in EPLN with reaction "'These are lonely choices,' [heshe] says, stepping backwards slowly into the dark of the void. '[if second-choice-love is true]You say you choose love, but you haven't loved the ones around you. [end if]You are too much like me, I fear; in the end, your life is only big enough for one, all-encompassing thing. My science, and your wayfaring.'[paragraph break][CHeShe] sighs, glasses glinting the last of a now dim and fading night as the shadows swallow him up. 'A lonely road, [heshe] says. 'I wish you the best.' [CHeShe] reaches out a hand to you and then that is all you can see, the rest of [himher] vanished into the dream-void, that one [o]hand[x] and the end of the lab coat's sleeve reaching out towards you.". epln_outtro suggests epln_outtro2.

Understand "hand" as epln_outtro2 when last beat is in EPLN. epln_outtro2 is a terminal beat in EPLN with keyword name "hand" and reaction "You reach out towards the hand, but it is already too late; it has vanished into the void, leaving you utterly alone...". Understand "hand" as ep-dr-quick. Instead of shaking or taking or touching or examining by name ep-dr-quick when last beat is epln_outtro: force discuss epln_outtro2 instead. 


Section - Coda

[some object used only for metaphorical purposes. Spider or something. A few moves to interact with it, various choices (destroy, help, etc.) before boar appears.]

Epilogue-Ending-C is a scene. Epilogue-Ending-C begins when epln_outtro2 is spoken.

When Epilogue-Ending-C begins:
	say "You snap your eyes open to bleary dawn light.";
	begin chapter 11;
	change the time of day to 6:30 AM; 
	change the time factor to 1;
	move yourself to Forest4; 
	now yourself holds e-spear;
	eec-boararrives in 2 turns from now;
	change the description of boar to "You have never seen these great red-brown creatures except alone, have never seen mates or children. It takes much of patience and a good deal of luck to see them at all. Rooting quietly in the mud at the roots of a tree, the boar is oblivious now to your presence. Your attack must be quick and firm if you hope to kill it.";
	say "You must have dozed off. You crept here to this spot in the black of too-early morning, where you've seen boars foraging in early dawn mist. The [o]spear[x] you've carefully crafted over the past week is held tight in your hands, and all the paints are mixed. Like Lethe and Phoebe before you, all you need now is a hide for canvas.".

At the time when eec-boararrives: move boar to location; say "Suddenly you spot movement from the corner of your eye and see the creature, a lumbering [o]boar[x], fat and sleepy. Perfect. You grip the spear tightly in your hand."; ep-dontkill in 6 turns from now.

An e-spear is a thing with printed name "spear". Understand "spear" as e-spear. The description is "Just bamboo, konokuk husk, and sharpened flint.".

Instead of attacking boar when player holds e-spear: try throwing e-spear at boar.

Instead of throwing e-spear at boar:
	say "Rising to your feet, heart beating tightly high in your chest, you hurl the spear forward with every ounce of strength left in you, fingertips numb with tingles. All the pain of the ones you've lost goes into that throw; all the things you wished you could have done differently. But you can never go back. Only forward.[paragraph break]The spear pierces the soft flank of the boar and sinks deeply into its flesh. The creature spasms with a jagged-edged cry that explodes through the rain forest, flinging birds into the dawn sky in panicked volleys, stilling the movements of every other creature for a mile, so that the echoes of the high, piercing animal shriek die out in utter silence.[paragraph break]Breathing heavy, sweat beading as if you had run a marathon, you step out from your hiding place into the silent forest. The boar struggles feebly but is already slipping towards the dark edge of life, grunting almost quietly to itself as pools of thick and spreading blood seep into the rich loam beneath, drunk by the soil in relish.[paragraph break]You step up to the animal warily and put a hand on its soft flank, as if through touch you can somehow convey that its death will serve a purpose, will have meaning. But moments later all movement stops, its eyes become black wet orbs, and you feel some cold chill shudder the warm mists of the forest and through your hand, as if it was the boar that sent a message to you: life ends with death in the mud, alone.[paragraph break]There is much to do now, and most of it will be tiresome and unpleasant. But it must be done, whether you have the stomach for it or not. And when all is finished you too will leave this world, knowing little more of where you go than the creature cooling before you. And like it, you will never come back.[paragraph break][i]How many worlds...[r][line break]The sun rises, peeking through the swaying arms of the rain forest with hesitant rays.";
	end the game in victory.

At the time when ep-dontkill:
	say "[epgiveup]?[paragraph break]Perhaps there are other ways to find canvas. Perhaps there is more to explore of Lacuna, the mysteries of distant islands and continents. Perhaps there is even another way to leave this world behind, without the need to create a new one...[paragraph break][i]How many worlds...[r][line break]The sun rises, peeking through the swaying arms of the rain forest with hesitant rays.";
	end the game in victory.

To say epgiveup: say "Finally, you lower the spear, and the boar sees or hears and spooks, crying out a single grunt of panic which flings birds into the dawn sky in panicked volleys. It crashes through the underbrush and moments later is gone.[paragraph break]You rub your cramped feet wearily as you stand in the now empty clearing, thoughts a tired clatter.[paragraph break]How many worlds have you moved through, Wayfarer?[paragraph break]Will you ever...?[paragraph break][if won-rebels]It will take a generation or more for the mothballed dreams of City to cross the light-years to Lacuna[else if won-trees]It will take a generation or more for another Egg from the Forest to cross the light-years to Lacuna[else]No one is coming to join you on this lonely island save the whispers of its sad, impotent trees[end if][if Progue is not dead]; Progue is already gone, an achingly smooth sculpture of some muse all he left behind[end if]. Even if you could wait, what would you be waiting for".

suicide-flag is a truth state that varies. Instead of attacking yourself during Epilogue-Ending-C:
	say "[epgiveup]?[paragraph break]It is easy to wedge the spear firmly into the ground, tip pointing upwards, and even easier to climb one of the great, mossy trees. Birds scatter in all directions, wet muddy droplets squeeze from the dew-soaked vines. And as you fall, you know at last the answer to your question.";
	now suicide-flag is true;
	end the game in victory.

Instead of landmark-going or going or exiting during Epilogue-Ending-C: say "You're sure this is the best spot. If you move now you'll blow your cover.".

Chapter - Final Question

[The new print the final question rule is listed instead of the print
the final question rule in before handling the final question.]

First before handling the final question rule when the game ended in victory:
	if topics-window is g-present, shut down topics-window; 
	say "Press any key...";
	wait for any key;
	if the psyche of Progue is ignorance, stop; [If we shot ourselves during the Path of Love]
	say "[one of][endsummary][or][stopping]".

To say endsummary: say "[paragraph break]Your ending, like your story, was defined by your choices:[paragraph break]";
	say " -- to put [if we chose love]love above art[else]art above love[end if] (out of 2 options)[line break]";
	say " -- [if The-Path-Of-Love has happened]to stay with Rume rather than answer the Call[else]to answer the Call rather than stay with Rume[end if] (out of 2 options)[line break]";
	say " -- [if story mode]story over puzzles[else]a story with puzzles and problem-solving[end if] (out of 2 options)[line break]";
	say " -- [if player is hale]to proceed with care rather than risk injury[else]to act boldly even though injury resulted[end if] (out of 2 options)[line break]";
	say " -- to develop a relationship with Progue based on (out of 12 options):[line break]";
	say "       [if affinity of Progue > 0]friendship, not enmity[else]enmity, not friendship[end if][line break]";
	say "       [if submission of Progue > 0]dominance, not deference[else]deference, not dominance[end if][line break]";
	if paternalism of Progue >= 2, say "       paternal feelings[line break]";
	if romance of Progue >= 3, say "       romantic feelings[line break]";
[	say "       all of which led Progue to nickname you [animal-nickname] (out of 15 options)[line break]";]
	say " -- [if end-rebels]to give Lacuna to the people of City, rather than Forest[else if end-trees]to give Lacuna to Forest, rather than the people of City[else]to reject the choice between City and Forest (out of 3 options)[end if][line break]";
	say " -- [if ending_2c1 is spoken]to kill to defend that choice[else if ending_1a is spoken or ending_1b is spoken or ending_1c is spoken or ending_1d is spoken]to force Progue to make the final choice[else if ending_2a1 is spoken]to force Progue to fight to defend his decision[else if ending_2b1 is spoken]to force Progue to accept that that choice was no longer his to make[else if ending_2b2 is spoken]to defend that choice even in the face of Progue's desperation[else]to defend that choice against Progue[end if] (out of 6 options)[line break]";
	say " -- [if ep_likeRume]to end your story with Rume[else if ep_likeProgue]to help Progue find his daughters[else]to continue your path alone[end if] (out of 3 options)[line break]";
	say " -- [if suicide-flag is true]to finally, in the end, choose annihilation[else if second-choice-art is true and we chose love]to finally, in the end, choose art[else if second-choice-art is true and we chose art]to reaffirm your choice of art[else if second-choice-love is true and we chose art]to finally, in the end, choose love[else]to reaffirm your choice of love[end if] (out of 4 or 5 options)[paragraph break]";
	say "In addition, the story you heard (out of the cloud of stories within Blue Lacuna) involved hearing [the number of spoken beats] out of [the number of beats] possible bits of dialogue, visiting [the number of visited rooms] out of [the number of rooms - 6] locations, and participating in [the number of completed episodes] out of [the number of episodes] scenes with Progue, over the course of [turn count] turns.[paragraph break]";
	say "If you choose to explore the story again, you can type BACKSTAGE at any prompt to have access to a number of tools that will show you more clearly the mechanics of the story, and allow you to customize things like Progue's feelings towards you and which ending you're aiming towards.[paragraph break]";
	say "Press any key...";
	wait for any key;
	say paragraph break.



Rule for amusing a victorious player:
	say "Have you tried:[line break]
	-- flirting with Progue till he invites you on a date? convincing him you're real by kissing? or slapping him? [line break]
	-- staying with Rume? Or finding a way to return?[line break]
	-- turning the ear on the clockwork head in the Treehouse dream sequence?[line break] 
	-- rescuing Progue in the tsunami? Being rescued yourself? Finding him but leaving him behind?[line break]
	-- switching from being Lethe to Phoebe and back again during the argument at the 'Overgrown Path' flashback?[line break]
	-- Trying to jump over the chasm or climb to the top of the mountain and breaking your leg? Before Progue's decided you're real? After?[line break]
	-- Looking at the sun as it's setting to see the blue flash? More than once?[line break]
	-- Seen the star-rain wit";
	say "h Progue? Been gifted a sweater? Built sand castles with him?[line break]
	-- Reading the moonlight version of the message in the prison cell on the secret island?[line break]
	-- Finding the beached shark by visiting the bottom of the ravine after the tsunami? Saving it?[line break]
	-- Pushing Progue's sculpture off the edge of the volcano (during or shortly after a rainstorm), then speaking to him?[line break]
	-- Taking off your clothes in front of Progue?[line break]
	-- Washing off your face paint and carrying around a garden spade when in the Heart of the Forest, to see how people treat you when they don't know you're the visitor?[line break]
	-- breaking and entering in City? getting arrested there?[line break]
	-- asking the City historian about Weaver Greeneyes?[line break]
	-- meeting the old woman in Forest who sings you a song?[line break]
	-- destroying the pyramid machinery after visiting both worlds? setting it for a password that's different than the one you gave either side? Lying to Progue about which side you chose?".


Volume - Drama Manager (in Drama Manager by Blue Lacuna)

Chapter - Rume Tracker

[ Throughout the game, we keep track of how the player feels about Rume. When we reach our epilogue, we make our best guess as to whether the player wants to return, and if so, trigger that epilogue.

At various moments throughout the game, the player has opportunities to take actions that reveal their feelings. Positive points indicate a desire for / wanting to return to Rume, and negative points indicate indifference or apathy. We can score minor or major points in either direction. 

If we reach the epilogue with 10 or more points, we get the Rume-centered ending.]

Rume-tracker is a number that varies. Rume-tracker is -10. 
 
To miss Rume:
	increase Rume-tracker by 5; 
	if drama manager is being debugged or stats mode is true, say "[as the parser](Missing Rume: score now [if Rume-tracker > 0]+[end if][Rume-tracker]).[as normal][line break]".
	
To miss Rume a lot: 
	increase Rume-tracker by 15;   
	if drama manager is being debugged or stats mode is true, say "[as the parser](Missing Rume a lot: score now [if Rume-tracker > 0]+[end if][Rume-tracker]).[as normal][line break]".
	
To dis Rume:
	decrease Rume-tracker by 5; 
	if drama manager is being debugged or stats mode is true, say "[as the parser](Letting Rume go: score now [if Rume-tracker > 0]+[end if][Rume-tracker]).[as normal][line break]".	

To dis Rume a lot:
	decrease Rume-tracker by 15;
	if drama manager is being debugged or stats mode is true, say "[as the parser](Forgetting Rume: score now [if Rume-tracker > 0]+[end if][Rume-tracker]).[as normal][line break]".
	
After remembering Rume for the first time: miss Rume; continue the action.

Report remembering Rume: try mourning instead.

Chapter - Story / Puzzle Mode

[ After the Homeworld sequence, we ask the player whether they'd prefer an emphasis on story or puzzles, using actions during that sequence to make a guess. ]

The drama manager is a thing. The drama manager can be storied or puzzled. The drama manager is puzzled. To decide whether story mode: if drama manager is storied, decide yes; decide no. To decide whether puzzle mode: if drama manager is puzzled, decide yes; decide no.

The boredom meter is a number that varies. 

[ A key narrative component that most interactive fiction lacks is the concept of pacing. If the player is stuck on a puzzle, even the most well-constructed game grinds to a halt. The longer the player goes without seeing something new, the more the artifice is exposed and the magic is lost.

Blue Lacuna attempts to deal with this problem by keeping track of how long it's been since something interesting happened, and, if we're past a certain point, introduce hints, new plot points, or even just random scenes for fun into the game. The result is that we make sure new things are always happening, even if it's not necessarily relevant to the plot.

Some time for excitement scenes just break the monotony, or draw the player towards unexplored accessible rooms, or add more Progue color. Others are more explicit hint-giving scenes. In these we should take care not to give hints to players who don't want them. The hint scenes should be sequential, slowly revealing more and more info.]

Understand "dmtrack" as dmtracking. dmtracking is an action out of world applying to nothing.

Carry out dmtracking:
	if dr-window is g-present, shut down dr-window;
	otherwise open up dr-window.

The dr-window is a g-window with type g-text-buffer. The main-window spawns the dr-window. The position of the dr-window is g-placeabove. The scale method of dr-window is g-fixed-size. The measurement of the dr-window is 3.

Before reading a command when dr-window is g-present: 
	move focus to dr-window, clearing the window;
	say "boredom meter: [boredom meter] [if time for excitement][d](time for excitement)[x] [end if][if desperate for excitement][o](desperate for excitement)[x] [end if]    - moves since: last chapter - [turn count - last chapter turn][line break]";
	say "curr ep: [current episode] - [the number of filled rows in episode schedule] possible episode[s] - [the number of filled rows in Table of Progue's Appointment Book] appointment[s]";
	return to main screen.

Section - Something Dramatic Is Up

[ We don't want to step on the toes of other systems or have events happen too fast, so we check and make sure not to trigger scenes at inappropriate times.]

To decide whether nothing dramatic is up:
	if player is on beehive, decide no;
	if we are examining an echo-keyword, decide no;
	if player is enclosed by mind chair, decide no;
	if location is regionally in Chairlift-Ride, decide no;
	if something dramatic is up with Progue, decide no;
	decide yes. To decide whether something dramatic is up: if nothing dramatic is up, decide no; decide yes.

To decide whether nothing dramatic is up with Progue:
	if ambience_on is 0, decide no;
	if we are landmark-going, decide no;
	if Progue is attentive, decide no;
	if current episode is not no-episode and ( Progue is enclosed by location or distant-Progue is enclosed by location ) , decide no;
[	if scene_underway is true, decide no;]
[	if the animus of Progue is acting, decide no;]
	decide yes.  To decide whether something dramatic is up with Progue: if nothing dramatic is up with Progue, decide no; decide yes.

To decide whether just had excitement:
	if boredom meter < 3, decide yes;
	decide no.

Section - Time For Excitement

The excitement level is a number that varies. The excitement level is 200.

To decide whether time for excitement, ignoring drama:
	if boredom meter > excitement level and ( ignoring drama or   nothing dramatic is up ) begin;
		if the drama manager is being debugged, say "// Drama manager: deciding that time for excitement ([boredom meter] > [excitement level]).";
		decide yes;
	otherwise;
		decide no; 
	end if. 

The desperation level is a number that varies. The desperation level is 400.

To decide whether desperate for excitement:
	if boredom meter > desperation level and nothing dramatic is up begin;
		if the drama manager is being debugged, say "// Drama manager: deciding that desperate for excitement ([boredom meter] > [desperation level]).";
		decide yes;
	otherwise;
		decide no; 
	end if. 	

Section - Triggering Progue

[ About once an hour (or when time for excitement) we check to see if we should trigger a Progue scene. (The triggering code is in Episodes.)]
	
Scene-daemon is a truth state that varies. Scene-daemon is false. At the time when the daemon wakes: if the drama manager is being debugged, say "// Drama manager: scene-daemon awakes."; now scene-daemon is true. 


Chapter - When Interesting Things Happen

[ Whenever something new or unusual happens, we reset the boredom meter.]

To reset the boredom meter with (msg - some text):
	if drama manager is being debugged, say "// Drama: resetting the boredom meter (because [msg]).";
	now boredom meter is 0.

To assuage boredom with (msg - some text):
	if drama manager is being debugged, say "// Drama: assuaging boredom (because [msg]).";
	decrease boredom meter by 25;
	if boredom meter < 0, now boredom meter is 0.

Section - Going to an unvisited room

After going to an unvisited room: reset the boredom meter with "going to an unvisited room"; continue the action.

Section - Discussing something new

[ This covers the dreams too.]

Before discussing an unspoken beat (this is the Drama Manager reset boredom meter when saying something new rule): reset the boredom meter with "talking to somebody"; continue the action.

Section - Blue Flashes

[ This is defined in Homeworld.] 

Section - Examining something new

Definition: a thing is unexamined if we have not examined it and it is not set dressing and it is not minor.

After examining something unexamined: assuage boredom with "examining something new"; continue the action.

Section - New chapter

[ This is defined in Main.]

Section - The Endgame

Every turn when a random chance of 1 in 10 succeeds and ( Finishing-Treeworld is solved or Finishing-Rebelworld is solved ) : reset the boredom meter with "Endgame"; continue the action.



Chapter - When Uninteresting Things Happen

[ The boredom meter naturally rises over the course of time. However, certain actions indicating boredom or frustration cause it to rise faster.]

To be more bored with (msg - some text):
	increase boredom meter by 20;
	if story mode, increase boredom meter by 10;
	if drama manager is being debugged, say "// Drama: becoming more bored because [msg].".

Section - The dreadful march of time

Every turn when boredom meter >= 0 (this is the boredom increases over time rule): increase boredom meter by 1.

Section - Frustrated Behavior

Understand the commands "damnit" and "hell" and "bastard" and "bitch" and "fucker" and "shithead" and "asshole" as "damn".

Swearing obscenely is puzzle frustration. Swearing mildly is puzzle frustration. Attacking something is puzzle frustration. Displaying the hints text is puzzle frustration.

Before puzzle frustration: be more bored with "puzzle frustration"; continue the action. 

Section - Parser Messages

[ Parser messages are sometimes an indicator that the player is frustrated, because they are either trying things that aren't understood or they're pushing against the limits of the implementation.]

[ This is coded in the main code.]

Section - Repeating the same action

The last-action is a stored action that varies. The last-action-counter is a number that varies.

Every turn (this is the watch for repeated actions rule):
	if the action-name part of current action is the action-name part of last-action and we-are-landmark-going is false, increase last-action-counter by 1;
	otherwise now last-action-counter is 0;
	if last-action-counter >= 4 and current action is not going somewhere:
		be more bored with "repeated verb";
	now last-action is current action.

Section - Taking a Nap

[ See main code.]

Section - Repeating a conversation topic

Before discussing something spoken (this is the Drama Manager be more bored with repeated conversation rule): be more bored with "repeating conversation"; continue the action. [ Has to be before because with "after" everything is spoken.]



Chapter - Overall Time For Excitement Scenes

Section - Increase Liklihood of Progue Episodes

[ Code in the Episodes extension. If we've defined an episode as "common" or whatever the chance that it will not fire is overruled if time for excitement.]

Section - Prodding to Explore

[ Some players may not realize they haven't explored all the available areas. This scene can prod them to do so. Normally our time for excitement scenes are one-time only, but since this is an event that could conceivably happen more than once, we may as well let it.]

Prodding-To-Explore is a recurring scene. Prodding-To-Explore begins when time for excitement and nothing dramatic is up and PTE won't annoy player and location is regionally in Lacuna [ and final release mode is true] and the number of adjacent unvisited rooms > 0 and a random chance of 1 in ptectr succeeds. Prodding-To-Explore ends when 1 is 1. ptectr is a number that varies. ptectr is 1.

To decide whether PTE won't annoy player: [ Make sure this doesn't lure the player somewhere they can't go.]
	if ( location is North Marsh or location is Lawn ) and player is wounded, decide no;
	if location is Edge of Ravine, decide no;
	if location is Lower Beach and Inside-Manta is unvisited, decide no;
	if location is Forest3, decide no; [ So as not to spoil Egg puzzle.]
	decide yes.

When Prodding-To-Explore begins:
	increase ptectr by 1; [ make this scene increasingly unlikely to fire.]
	let candidate be a random adjacent unvisited room;
	reset the boredom meter with "hinted at unexplored room";
	unless candidate is not a room:
		let way be the best route from the location to candidate;
		unless way is not a direction:
			move small furry creature to location;
			now way-went of small furry creature is way;
			say "Out of the corner of your eye, you catch a hint of movement. Some small furry [o]creature[x] just darted [if candidate is indoorsy]inside[else]off to[end if] [the prose name of candidate][if way is up] above you[else if way is down] below you[else if dir] to the [way][end if]. It turns back and looks at you, whiskers twitching and little paws quivering, then darts off and vanishes.".

A small furry creature is seen minor set dressing. The description is "It's scampered off now, but you realize you've never explored off in that direction." Understand "critter/animal/something/whiskers/paws" as small furry creature when small furry creature is enclosed by location.

A small furry creature has a direction called way-went. Instead of following small furry creature, try going way-went of small furry creature.